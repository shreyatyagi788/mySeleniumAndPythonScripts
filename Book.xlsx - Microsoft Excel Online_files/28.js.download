(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[28],{546:function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"t",function(){return i});var r,i;(function(e){e[e.xSmall=0]="xSmall";e[e.small=1]="small";e[e.medium=2]="medium";e[e.large=3]="large"})(r||(r={}));(function(e){e[e.normal=0]="normal";e[e.large=1]="large"})(i||(i={}))},548:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e.ScriptLoaded="share_scriptsLoaded";e.UIReady="share_uiReady";e.Ready="share_ready";e.Error="share_error";e.Resize="share_resize";e.GrantAccessCompleted="share_grantAccessCompleted";e.Dismiss="share_dismiss";e.ReadyForRecipients="share_readyForRecipients";e.OutlookClicked="share_outlookClicked";e.SendRecipients="atMention_defaultRecipients";e.ManageAccessClicked="share_manageAccessClicked";e.ShareCompleted="share_completed";e.MakeVisible="share_makeVisible";e.Destruct="share_destruct";e.ResetMakeVisible="share_resetMakeVisible";e.InstantLoadReady="share_instantLoadReady";e.ShareContextInformation="share_postContextInformation";e.Started="share_started";e.LinkSettingCompleted="share_linkSettingsCompleted";e.GetToken="share_getToken";e.DocumentInformation="share_documentInformation"})(r||(r={}))},574:function(e,t,n){"use strict";n.d(t,"e",function(){return g});var r=n(542),i=n(0),s=n(1),o=n(546),u=n(507),a=n(264),f=n(38),l=(function(e){Object(i.r)(t,e);function t(t){var n=e.call(this,t)||this;n.state={isRendered:void 0===Object(f.e)()};return n}t.prototype.componentDidMount=function(){var e=this,t=this.props.delay;this._timeoutId=window.setTimeout(function(){e.setState({isRendered:!0})},t)};t.prototype.componentWillUnmount=function(){this._timeoutId&&clearTimeout(this._timeoutId)};t.prototype.render=function(){return this.state.isRendered?s.Children.only(this.props.children):null};t.defaultProps={delay:0};return t})(s.Component),c=Object(u.e)(),h=(function(e){Object(i.r)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.type,n=e.size,r=e.ariaLabel,u=e.ariaLive,f=e.styles,h=e.label,p=e.theme,d=e.className,v=e.labelPosition,m=r,g=Object(a.r)(this.props,a.n,["size"]),y=n;void 0===y&&void 0!==t&&(y=t===o.t.large?o.e.large:o.e.medium);var b=c(f,{theme:p,size:y,className:d,labelPosition:v});return s.createElement("div",Object(i.e)({},g,{className:b.root}),s.createElement("div",{className:b.circle}),h&&s.createElement("div",{className:b.label},h),m&&s.createElement("div",{role:"status","aria-live":u},s.createElement(l,null,s.createElement("div",{className:b.screenReaderText},m))))};t.defaultProps={size:o.e.medium,ariaLive:"polite",labelPosition:"bottom"};return t})(s.Component),p=n(13),d=n(46),v={root:"ms-Spinner",circle:"ms-Spinner-circle",label:"ms-Spinner-label"},m=Object(d.t)(function(){return Object(p.E)({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}})}),g=Object(r.e)(h,function(e){var t,n=e.theme,r=e.size,s=e.className,u=e.labelPosition,a=n.palette,f=Object(p.d)(v,n);return{root:[f.root,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},"top"===u&&{flexDirection:"column-reverse"},"right"===u&&{flexDirection:"row"},"left"===u&&{flexDirection:"row-reverse"},s],circle:[f.circle,{boxSizing:"border-box",borderRadius:"50%",border:"1.5px solid "+a.themeLight,borderTopColor:a.themePrimary,animationName:m(),animationDuration:"1.3s",animationIterationCount:"infinite",animationTimingFunction:"cubic-bezier(.53,.21,.29,.67)",selectors:(t={},t[p.r]=Object(i.e)({borderTopColor:"Highlight"},Object(p.v)()),t)},r===o.e.xSmall&&["ms-Spinner--xSmall",{width:12,height:12}],r===o.e.small&&["ms-Spinner--small",{width:16,height:16}],r===o.e.medium&&["ms-Spinner--medium",{width:20,height:20}],r===o.e.large&&["ms-Spinner--large",{width:28,height:28}]],label:[f.label,n.fonts.small,{color:a.themePrimary,margin:"8px 0 0",textAlign:"center"},"top"===u&&{margin:"0 0 8px"},"right"===u&&{margin:"0 0 0 8px"},"left"===u&&{margin:"0 8px 0 0"}],screenReaderText:p.w}},void 0,{scope:"Spinner"})},611:function(e,t,n){"use strict";n.r(t);n.d(t,"SharingIFrame",function(){return _});n.d(t,"ShareDialog",function(){return D});n.d(t,"WacGrantAccessDialog",function(){return P});n.d(t,"WacShareDialog",function(){return B});var r,i=n(0),s=n(1),o=n(548);(function(e){e[e.Success=0]="Success";e[e.CannotGrantPermission=1]="CannotGrantPermission";e[e.UserDoesNotExist=2]="UserDoesNotExist";e[e.Failed=3]="Failed"})(r||(r={}));var u=n(530),a=n(45),f=n(26),l=n(19),c=n(101),h=n(128),p=n(163),d=n(241),v=n(574),m=n(546),g=n(307);Object(g.e)([{rawString:".wacShareDialog{position:relative}.wacShareDialog iframe{border:none}.spinner{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.wacShareDialogReady .spinner{display:none}.wacShareDialogLoading iframe{visibility:hidden}"}]);var y,b=n(84),w=n(49),E=n(58),S=n(17),x=n(540);(function(e){e[e.share=1]="share";e[e.copyLink=2]="copyLink";e[e.manageAccess=5]="manageAccess";e[e.addPeople=7]="addPeople"})(y||(y={}));var T,N,C=n(5),k=n(3),L=[{flightStringId:"FamilySharing",flightEnabled:Object(k.se)(C.x)},{flightStringId:"FamilySharingWacKS",flightEnabled:Object(k.se)(C.T)},{flightStringId:"ManageAccessRevampConsumer",flightEnabled:Object(k.se)(C.L)},{flightStringId:"ODCHideNonPremiumLinkFeatures",flightEnabled:Object(k.se)(C.D)},{flightStringId:"ODCSharingOwnerUpdateKS",flightEnabled:Object(k.se)(C.H)},{flightStringId:"ODCRequestAccess",flightEnabled:Object(k.se)(C.P)},{flightStringId:"SharingTooltipCalloutKS",flightEnabled:Object(k.se)(C.z)},{flightStringId:"Enable3SonWacWord",flightEnabled:Object(k.se)(C.o)}];(function(e){e.Msa="msa_auth:";e.Graph="graph_auth:";e.MsaStrongAuth="msa_strong_auth:";e.PhoneLink="phone_link:";e.Substrate="substrate_auth:"})(T||(T={}));(function(e){e[e.STI=1]="STI";e[e.Default=2]="Default"})(N||(N={}));var A=1,O=S.e.isActivated("E1C27267-F996-4735-833A-AC42431C3886","11/25/2022","ODC WACShare Fullscreen"),M=S.e.isActivated("8B1E6850-95D2-11ED-87CD-0800200C9A66","1/16/2023","ODC WAC word 3s enabled");function _(e){var t=this,n=e.origin,r=e.dialogUrl,u=e.itemName,a=e.listItemId,f=e.correlationId,l=e.mode,c=e.navId,h=e.clickTime,g=e.accessChecked,y=e.recipients,b=e.ageGroup,w=e.onShareDismiss,E=e.onShareReady,S=e.onShareError,x=e.onShareTimeout,T=e.onGrantPermissionCompleted,C=Object(s.useRef)(null),k=Object(s.useRef)(null),L=Object(s.useRef)(null),O=Object(s.useState)(!1),_=O[0],D=O[1],P=Object(s.useCallback)(function(e){var t;if(e.origin===n&&e.source===(null===(t=k.current)||void 0===t?void 0:t.contentWindow)){var r=JSON.parse(e.data);switch(r.name){case o.e.Ready:D(!0);if(L.current){clearTimeout(L.current);L.current=null}null==E||E();break;case o.e.Error:if(L.current){clearTimeout(L.current);L.current=null}var i=r,s=i.error,u=i.errorMessage,a=i.debugErrorMessage;if(a)try{s=JSON.parse(a).error.name}catch(e){}null==S||S(s,u);break;case o.e.Resize:if(k.current){k.current.width="".concat(r.width);k.current.height="".concat(r.height)}break;case o.e.OutlookClicked:case o.e.Dismiss:null==w||w();break;case o.e.GrantAccessCompleted:null==T||T(r);break;case o.e.ReadyForRecipients:if(k.current){var f={name:"atMention_defaultRecipients",recipientIds:y.map(function(e){return e.Id})};k.current.contentWindow.postMessage(JSON.stringify(f),n)}break;default:window.console.log("Unknown message: "+r.name)}}},[D,n,y,w,E,S,T]),H=Object(p.t)();Object(s.useEffect)(function(){var e=C.current;if(e){(function(e){Object(i.t)(t,void 0,void 0,function(){var t,n,s,o,p,v,m,w,E,T,C,O,_;return Object(i.i)(this,function(i){switch(i.label){case 0:i.trys.push([0,5,,6]);t=H.consume(d.e);n=y?y.map(function(e){return e.Id}):[];s=void 0;return M?[3,2]:[4,Promise.all([t.getGraphToken({forceRefresh:!0}),t.getSubstrateToken(N.Default,!0)])];case 1:o=i.sent(),p=o[0],v=o[1];s={authToken:p.accessToken,additionalTokens:{substrateToken:v.accessToken},itemName:u,listItemId:a,clientId:"odcWac",correlationId:f,mode:l,navId:c,clickTime:h,accessChecked:g,defaultRecipients:n,ageGroup:b,emailAddress:null===(_=window.$Config)||void 0===_?void 0:_.email};return[3,4];case 2:return[4,t.getGraphToken({forceRefresh:!0})];case 3:m=i.sent();s={authToken:m.accessToken,itemName:u,listItemId:a,clientId:"odcWac",correlationId:f,mode:l,navId:c,clickTime:h,accessChecked:g,defaultRecipients:n,ageGroup:b};i.label=4;case 4:w="".concat("shareFrame","-").concat(A++);(E=document.createElement("iframe")).name=w;k.current=E;e.appendChild(E);(T=document.createElement("form")).target=w;T.action=r;T.method="POST";e.appendChild(T);(C=document.createElement("input")).type="hidden";C.name="context";C.value=JSON.stringify(s);T.appendChild(C);window.addEventListener("message",P);T.submit();L.current=window.setTimeout(x,3e4);return[3,6];case 5:O=i.sent();null==S||S("FailedToInitialize",null==O?void 0:O.message);return[3,6];case 6:return[2]}})})})(e);return function(){if(L.current){clearTimeout(L.current);L.current=null}window.removeEventListener("message",P)}}},[u,a,f,l,c,h,g,y,b,x,S,H]);return s.createElement("div",{ref:C,className:"\n        wacShareDialog\n        ".concat(_?"wacShareDialogReady":"wacShareDialogLoading","\n      ")},_?null:s.createElement(v.e,{className:"spinner",size:m.e.large}))}function D(e){var t=e.origin,n=e.devHost,r=e.onShareReady,o=e.onShareDismiss,l=e.onShareError,c=e.onShareTimeout,h="".concat(t,"/share?consumer=true&smkt=").concat(encodeURIComponent(w.e.language),"&origin=").concat(encodeURIComponent(window.location.origin))+(n?"&devhost=".concat(encodeURIComponent(n)):""),p=new a.e({name:"WacHost.ShareDialog"});return s.createElement(u.e,{isOpen:!0,styles:{main:{minWidth:480,minHeight:155}}},s.createElement(_,Object(i.e)({},e,{dialogUrl:h,onShareReady:function(){p.end({resultType:f.e.Success,resultCode:"Share dialog ready"});null==r||r()},onShareError:function(e,t){p.end({resultType:f.e.Failure,resultCode:"Share dialog error",extraData:{error:e,errorMessage:t}});null==l||l(e,t)},onShareTimeout:function(){p.end({resultType:f.e.Failure,resultCode:"Share dialog timeout"});null==c||c()},onShareDismiss:function(){p.end({resultType:f.e.Success,resultCode:"Share dialog dismissed"});null==o||o()}})))}function P(e){var t=Object(c.t)().dispatcher,n=Object(h.t)(),o=n.cache,u=n.clear,a=Object(s.useState)(!1),f=a[0],p=a[1];if(!o||!u)return null;var d=o.message,v=o.signal;return s.createElement(D,Object(i.e)({},e,{mode:y.addPeople,correlationId:d.ShareCorrelation,accessChecked:d.UserPermissionsVerified,onGrantPermissionCompleted:function(e){var t=e.successful;p(!0);v.resolve({MessageId:l.t.CheckUserAccessAndGrantPermissions_Result,Values:{Id:d.Id,DialogCanceled:!1,Persons:d.Persons.map(function(e){return{Id:e.Id,Provider:e.Provider,Status:t?r.Success:r.Failed}})},CorrelationId:b.e.generate()})},onShareReady:function(){t.respond(Object(l.n)())},onShareDismiss:function(){f||v.resolve({MessageId:l.t.CheckUserAccessAndGrantPermissions_Result,Values:{Id:d.Id,DialogCanceled:!0,Persons:d.Persons.map(function(e){return{Id:e.Id,Provider:e.Provider,Status:r.Failed}})},CorrelationId:b.e.generate()});t.respond(Object(l.r)());u()}}))}function H(e){var t=this,r=Object(x.e)(function(){return Object(i.t)(t,void 0,void 0,function(){return Object(i.i)(this,function(e){switch(e.label){case 0:return[4,n.ee([23,"ondemand.resx-ondemand"],614)];case 1:return[2,e.sent().ShareDialog]}})})});return s.createElement(r,Object(i.e)({},e))}function B(e){var t,r=this,o=Object(p.t)(),u=Object(h.t)(),a=u.cache,f=u.clear,v=Object(c.t)().dispatcher,m=Object(s.useCallback)(function(){v.respond(Object(l.n)())},[v]),g=Object(s.useCallback)(function(){v.respond(Object(l.r)());null==a||a.signal.resolve(void 0);f()},[v,null==a?void 0:a.signal,f]);if(!a||!f)return null;if(O){return s.createElement(D,Object(i.e)({},e,{mode:(t=null==a?void 0:a.message.mode,y[t]||y.share),correlationId:null==a?void 0:a.message.ShareCorrelation,navId:null==a?void 0:a.message.nav,clickTime:null==a?void 0:a.message.clickTime,onShareReady:m,onShareDismiss:g}))}var b=S.e.isActivated("FBB80417-B626-42B0-9DF6-872E93DD94F6","11/11/2022","ODC Share Fullscreen"),x=S.e.isActivated("1CA4EBCD-F7E0-42C0-B5D7-BA07ECB8BCDC","11/30/2022","ODC Max Height Based on Window.innerHeight"),T={initializeShareFrame:function(t){var s=t.parentElement,o=t.calloutProps,u=t.sharingInformation,a=t.onError,f=u.authToken,l=u.webAbsoluteUrl,c=u.additionalTokens;Object(i.t)(r,void 0,void 0,function(){var t,r,u;return Object(i.i)(this,function(i){switch(i.label){case 0:return[4,n.ee([22],606)];case 1:t=i.sent().SharePrefetch;r={authToken:f||"",additionalTokens:c,webAbsoluteUrl:l||"",listItemId:e.listItemId,itemName:o.itemName,itemCount:1,multiShareIds:[e.listItemId],mode:Number(o.mode),defaultRecipients:o.defaultRecipients,theme:o.theme,hostOptions:{hideShareDialogOverflowButton:!0},clientId:"odcWac",consumerFlightContexts:L,fullScreenIframe:!b,emailAddress:M?null:null===(u=window.$Config)||void 0===u?void 0:u.email};if(!x)try{r.maxHeight=window.innerHeight}catch(e){}return[4,new t({element:s,environment:E.e.prod,locale:o.locale,disableIframeDomainCheck:!0,isConsumer:!0,context:r,options:{onError:a,openManageAccess:o.openManageAccess}}).initializeUI()];case 2:i.sent();return[2]}})})},getSharingInformation:function(){return Object(i.t)(r,void 0,void 0,function(){var t,n,r,s,u;return Object(i.i)(this,function(i){switch(i.label){case 0:t=o.consume(d.e);return M?[3,2]:[4,Promise.all([t.getGraphToken({forceRefresh:!0}),t.getSubstrateToken(N.Default,!0)])];case 1:n=i.sent(),r=n[0],s=n[1];return[2,Promise.resolve({authToken:r.accessToken,itemId:e.listItemId,additionalTokens:{substrateToken:s.accessToken}})];case 2:return[4,t.getGraphToken({forceRefresh:!0})];case 3:u=i.sent();return[2,Promise.resolve({authToken:u.accessToken,itemId:e.listItemId})]}})})},getClientId:function(){return"WAC"},mode:(function(e){return"copy"===e?y.copyLink:y[e]||y.share})(null==a?void 0:a.message.mode),resolve:function(){console.log("ShareDialog loaded")},reject:function(){console.log("ShareDialog error")},locale:w.e.language||"en-US",itemName:e.itemName,iFrameFullScreenOverride:!0};return s.createElement(H,Object(i.e)({},T))}}}]);
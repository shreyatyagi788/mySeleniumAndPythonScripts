'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[15],{1001:function(r,F,a){a.d(F,"a",function(){return c});r=a(0);class c{}c.sAi="literal";c.operator="operator";c.func="function";c.namedRange="namedRange";c.range="range";c.hqf="letName";c.all="*";c.dXd="structRefRange";Object(r.a)(c,"TraverseFormulaInterestTypes",null,[])},1002:function(r,F,a){a.d(F,"a",function(){return c});r=a(0);class c{}c.cell="cell";c.range="range";c.row="row";c.column="col";Object(r.a)(c,
"TraverseFormulaRefTypes",null,[])},1184:function(r,F,a){r={};a.r(r);a.d(r,"CalcManager",function(){return ka});var c=a(0),b=a(15),e=a(226),f=a(161),d=a(8),h=a(111);a(175);var l=a(192),k=a(84),t=a(179),n=a(204),z=a(65);class w{}w.local="Local";w.fSj="Thread";Object(c.a)(w,"RecalcServiceCreateMode",null,[]);var m=a(167);class u{constructor(X){this.D6d=null;this.init(X)}get x$(){return this.D6d}init(X){this.D6d=new t.a;if(void 0!==X&&null!==X&&void 0!==X.HeadersList&&null!==X.HeadersList&&0<X.HeadersList.length)for(const R of X.HeadersList)this.x$.ia(R.Index,
R.Name)}}Object(c.a)(u,"ColHeadersListData",null,[]);var y=a(1),v=a(33),C=a(101),x=a(22),B=a(21),H=a(177);class I{constructor(X,R){this.qze=X;this.sheetName=R;this.Fxc=!1}}Object(c.a)(I,"CalcBlockInformation",null,[]);class U{constructor(X,R,wa,na,Ba){this.type=X;this.fullName=R;this.range=wa;this.sheetId=na;this.attributes=Ba;this.xE=null}}Object(c.a)(U,"CalcNamedObject",null,[]);class S{get lk(){return this.Uje}constructor(X){this.ylg=X;this.Uje=[];this.Mig=[];this.R_a={};this.lTd=new Map}t6f(X,
R){this.Uje[X]=R;this.ylg&&R.j7&&this.lTd.set(R.j7.sheetName,X)}getSheetIndex(X){if(this.ylg){if(this.lTd.has(X))return this.lTd.get(X)}else for(let R=1;R<this.lk.length;R++)if(x.a.equals(this.lk[R].j7.sheetName,X,!1))return R;return-1}}Object(c.a)(S,"GridCache",null,[]);var G=a(697),D=a(553);class E{constructor(X){this.j7=X;this.P5=new G.a(D.a.Oi());this.Knc=!1}}Object(c.a)(E,"SheetInformation",null,[]);var N=a(955),M;(function(X){X[X.initialization=0]="initialization";X[X.contentReady=1]="contentReady";
X[X.cellEdit=2]="cellEdit"})(M||(M={}));Object(c.b)("UpdateDataTrigger",M);class L{constructor(X){this.UJd=null;this.rwd=this.TJd=this.kEd=!1;this.NHd=0;this.FHd=this.HHd=this.IHd=this.GHd=-1;this.trueName="TRUE";this.falseName="FALSE";this.instantaneousSupportInformationManager=this.Nq=this.errorTypeNames=null;this.xt=this.currentStateId=-1;this.tta="";this.U$=null;this.getNameLoc=(R,wa)=>this.Iic()?this.af.ma(this.currentStateId).lk[0].P5.hb(wa)?(R=excelOnlineCalc.location.nameLoc(R,wa),excelOnlineCalc.util.success(R)):
excelOnlineCalc.util.success(null):(R=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(R));this.getContainingTable=R=>{if(!this.Iic())return R=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(R);const wa=R.range.col,na=R.range.row;var Ba=this.af.ma(this.currentStateId).lk[0].P5,Ra=null;for(let qa of Ba)if(Ba=qa.value,2===Ba.type&&x.a.equals(R.sheet.index.toString(),Ba.sheetId,!0)){const La=Ba.range;wa>=La.left-1&&wa<=La.right-1&&na<=La.bottom-1&&na>=La.top-1&&(Ra=
excelOnlineCalc.location.nameScope(this.documentLoc,Ba.sheetId),Ra=excelOnlineCalc.location.nameLoc(Ra,Ba.fullName))}return Ra?excelOnlineCalc.util.success(Ra):excelOnlineCalc.util.success(null)};this.getStructRefColumn=(R,wa)=>{if(!this.Iic()){var na=excelOnlineCalc.util.unavailable([2]);return excelOnlineCalc.util.failure(na)}na=R.name;var Ba=this.af.ma(this.currentStateId).lk[0].P5;if(Ba.hb(na)){Ba=Ba.ma(na);const qa=Ba.range;if(2!==Ba.type)return excelOnlineCalc.util.failure(this.c6c(5));const La=
Ba.xE?Ba.xE.x$:null;if(!La)return excelOnlineCalc.util.success(null);for(var Ra of La)if(x.a.equals(Ra.value,wa,!0))return R=excelOnlineCalc.location.documentLoc(R.scope.document.path,R.scope.document.name),R=excelOnlineCalc.location.sheetIndex(R,Ba.sheetId),Ra=excelOnlineCalc.location.gridRange(qa.top-1,Ra.key,qa.bottom-qa.top+1,1),Ra=excelOnlineCalc.location.sheetGridRange(R,Ra),na=excelOnlineCalc.location.structRefColumnLoc(na,Ra,!!(Ba.attributes&16),!!(Ba.attributes&8)),excelOnlineCalc.util.success(na);
return qa.right-qa.left+1!==La.count?(na=excelOnlineCalc.util.unavailable([17,R,wa]),excelOnlineCalc.util.failure(na)):excelOnlineCalc.util.failure(this.c6c(0))}return excelOnlineCalc.util.success(null)};this.getStructRefSpecialRef=(R,wa)=>{if(!this.Iic())return wa=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(wa);var na=this.af.ma(this.currentStateId).lk[0].P5;if(na.hb(R.name)){var Ba=na.ma(R.name);if(2!==Ba.type)return excelOnlineCalc.util.failure(this.c6c(5));na=!!(Ba.attributes&
16);const Ra=!!(Ba.attributes&8),qa=na?1:0,La=Ra?1:0;R=excelOnlineCalc.location.documentLoc(R.scope.document.path,R.scope.document.name);R=excelOnlineCalc.location.sheetIndex(R,Ba.sheetId);Ba=Ba.range;let Yb={};if(1===wa)Yb=excelOnlineCalc.location.gridRange(Ba.top-qa-1,Ba.left-1,Ba.bottom+La-Ba.top+qa+1,Ba.right-Ba.left+1);else if(2===wa)Yb=excelOnlineCalc.location.gridRange(Ba.top-1,Ba.left-1,Ba.bottom-Ba.top+1,Ba.right-Ba.left+1);else if(3===wa)if(na)Yb=excelOnlineCalc.location.gridRange(Ba.top-
2,Ba.left-1,1,Ba.right-Ba.left+1);else return excelOnlineCalc.util.success(null);else if(4===wa)if(Ra)Yb=excelOnlineCalc.location.gridRange(Ba.bottom,Ba.left-1,1,Ba.right-Ba.left+1);else return excelOnlineCalc.util.success(null);wa=excelOnlineCalc.location.sheetGridRange(R,Yb);return excelOnlineCalc.util.success(wa)}return excelOnlineCalc.util.success(null)};this.getDocumentLoc=(R,wa)=>{if((x.a.equals(R,this.documentLoc.path,!0)||!R)&&x.a.equals(wa,this.documentLoc.name,!0))return excelOnlineCalc.util.success(this.documentLoc);
R=excelOnlineCalc.util.unavailable([0,excelOnlineCalc.location.documentLoc(R,wa)]);return excelOnlineCalc.util.failure(R)};this.getSheetIndex=(R,wa)=>{if(!this.af.hb(this.currentStateId)||!this.af.ma(this.currentStateId).lk)return wa=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(wa);R=this.af.ma(this.currentStateId).lk;for(let na=1;na<R.length;na++)if(x.a.equals(R[na].j7.sheetName,wa,!0))return excelOnlineCalc.util.success(R[na].j7.sheetId);return excelOnlineCalc.util.success(null)};
this.getSheetName=(R,wa)=>{if(!this.af.hb(this.currentStateId)||!this.af.ma(this.currentStateId).lk)return wa=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(wa);R=this.af.ma(this.currentStateId).lk;for(let na=1;na<R.length;na++)if(x.a.equals(R[na].j7.sheetId,wa,!0))return excelOnlineCalc.util.success(R[na].j7.sheetName);return excelOnlineCalc.util.success(null)};this.getUserDefinedFuncLoc=()=>excelOnlineCalc.util.notImplemented(["ParseGlobals.GetUserDefinedFuncLoc not implemented in main thread"]);
this.getSheetRangeIndexes=()=>excelOnlineCalc.util.notImplemented(["ParseGlobals.GetSheetRangeIndexes not implemented in main thread"]);this.dGf=()=>{this.setNumberFormats()};this.dd=()=>{b.ULS.sendTraceTag(537170081,0,50,"CalcAsyncEngine.OnWorkbookOpened() called");this.af=new t.a;this.currentStateId=this.xt=-1;this.tta="";this.ctb=null;this.TJd=!1;this.Nq&&this.clearCache()};this.Pc=X;this.af=new t.a;this.ctb=null;this.documentLoc=excelOnlineCalc.location.documentLoc("",this.Pc.workbookContext.FullDocumentInfo.BreadcrumbDocName);
this.Hoa();this.Rqd=v.a.Rqd();this.wIh=y.EwaSettings.isChangeGateEnabled("OfficeVSO:7403363_fixTextWithWhitespaces")}dispose(){this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.fMd(this.dGf);this.Pc&&this.Pc.pl(this.dd);this.close()}VPb(X){if(!this.Nq)return!1;if(!this.instantaneousSupportInformationManager&&(this.instantaneousSupportInformationManager=this.Pc.da.Aa(268),!this.instantaneousSupportInformationManager))return b.ULS.sendTraceTag(537170198,0,50,"CalcAsyncEngine.UpdateData Failed to get instantaneousSupportInformationManager"),
!1;2!==X&&(this.currentStateId=this.Pc.ea.kDb,this.currentStateId===d.a.oe&&(this.currentStateId=this.Pc.ea.se));if(1===X&&this.currentStateId<this.xt)return b.ULS.sendTraceTag(537170197,0,50,`CalcAsyncEngine::UpdateData() currentStateId:${this.currentStateId} < lastUpdatedStateId:${this.xt} - ignoring update`),!1;this.kyj();0!==X&&this.TJd||(this.FCj(),this.Kzj(),this.wAj(),this.setNumberFormats(),this.instantaneousSupportInformationManager.ire(this.dGf),this.Pc.Lk(this.dd),this.TJd=!0);this.Wdj();
let R=!1;0===X&&(R=this.yhi());if(0!==X||R)this.SBj()?(this.tCj(X),this.sCj(),this.xt=this.currentStateId,this.G4g()):b.ULS.sendTraceTag(537170196,0,15,`CalcAsyncEngine::UpdateData() for StateId:${this.currentStateId} failed - no Sheets information`);2!==X&&this.resumeRecalc();return!0}evalFormula(X,R,wa,na){if(!this.Nq)return b.ULS.sendTraceTag(537170195,0,15,"CalcAsyncEngine.EvalFormula: recalc engine is null"),Promise.resolve({});R=excelOnlineCalc.calc.sheetCellLocation(null!==wa&&void 0!==wa?
wa:z.d(this.Pc.va.na),R.top-1,R.left-1);X=this.Nq.evalFormula(this.Pc.ea.se,X,R,na);this.resumeRecalc();return X}q0g(X,R,wa,na=null){const Ba=z.d(this.Pc.va.na);let Ra=X.cell.CQ-1,qa=X.cell.BQ-1;var La=Ra,Yb=qa;let mc=null;na&&(mc=excelOnlineCalc.calc.cellLocation(Ra,qa),Ra=na.top-1,qa=na.left-1,La=na.bottom-1,Yb=na.right-1);wa=this.z1d(X,wa,"SetCell");0>wa||(Yb=L.Q$("CalculateFormula.cell",Ba,Ra,qa,La,Yb),La=[],na=this.Qjd(Ba),R=excelOnlineCalc.calc.inferredRangeFormulaEdit(Yb,R,mc,na),La.push(R),
X=(R=this.Z8e())?String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",Ba,Ra,qa,x.a.pte(X.cell.text),wa,R.top-1,R.left-1,R.bottom-1,R.right-1):String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",Ba,Ra,qa,x.a.pte(X.cell.text),wa,"","","",""),b.ULS.sendTraceTag(537170180,0,50,X),this.Nq.editRangeFormulas(wa,La),this.resumeRecalc())}Lub(X,R,wa,
na){if(!this.Nq)return b.ULS.sendTraceTag(537170179,0,15,"CalcAsyncEngine::EvalFormulaRangeOnClone recalc engine is null"),Promise.reject("RecalcService is null");if(!wa||!R)return b.ULS.sendTraceTag(524120779,0,15,`CalcAsyncEngine::EvalFormulaRangeOnClone inputs are null. originCell null: ${!wa}, outputColumnRange null: ${!R}`),Promise.reject("CalcAsyncEngine::EvalFormulaRangeOnClone: null inputs");b.ULS.shipAssertTag(537170178,0,wa.isSingle,"CalcAsyncEngine::EvalFormulaRangeOnClone originCell must be a single cell.");
const Ba=z.d(this.Pc.va.na),Ra=this.Qjd(Ba);var qa=null;if(X){qa=[];for(const Yb of X)if(Yb.column!==wa.left){X=Yb.row-1;var La=Yb.column-1;X=L.Q$("EvalFormulaRangeOnClone.cell",Ba,X,La,X,La);La=y.EwaSettings.isChangeGateEnabled("OfficeVSO:7459428_TypedValueInCloneWrite")?aa(Yb.Gr,Yb.formulaBarText,Yb.hj):excelOnlineCalc.calc.valueCellData(Yb.text,Yb.text,Yb.hj,null);qa.push(excelOnlineCalc.calc.rangeWrite(X,La))}}wa=excelOnlineCalc.calc.cellLocation(wa.top-1,wa.left-1);R=L.Q$("EvalFormulaRangeOnClone.outputColumnRange",
Ba,R.top-1,R.left-1,R.bottom-1,R.right-1);na=[excelOnlineCalc.calc.cellFormulaRangeFormulaEdit(R,na,wa,Ra)];qa=this.Nq.evalOnClonedModel(qa,na);this.resumeRecalc();return qa}uJe(X){let R=null;try{if(X)if(this.tta=B.h(this.Pc).Ca.$ua(X),this.currentStateId=X.mTa,this.currentStateId<this.xt||this.currentStateId===d.a.oe)b.ULS.sendTraceTag(537170176,0,50,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() hash:${this.tta} blockRevision:${this.currentStateId} < lastUpdatedStateId:${this.xt}`);else{if(this.Ehi(),
!this.wWg())if(R=this.Pc.Jb.Gc("ModelUpdate",`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() Block Hash:${this.tta} StateId:${this.currentStateId}`),this.ctb=this.Yxb(X.na.sheetName),!this.ctb){const Ra=!!(this.Pc.qd&32),qa=this.af.hb(this.currentStateId)&&this.af.ma(this.currentStateId).lk?this.af.ma(this.currentStateId).lk.length:0;b.ULS.sendTraceTag(537170147,0,15,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel SheetName not found. Number of existing sheets ${qa}, scratchPad:${Ra}, sheetNameLength:${X.na.sheetName?
X.na.sheetName.length:-1} Hash:${X.na.hash}`)}else if(B.h(this.Pc).Ca.Am.b2a(X.Zc)){var wa=X.lf;if(wa){var na=wa.getCalcBlockModel();if(!na)b.ULS.sendTraceTag(537170145,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model for block");else if(this.oWg(na)){this.af.ma(this.currentStateId).R_a[this.tta]=new I(na,X.na.sheetName);var Ba=X.Wd;Ba?this.MJg(Ba.NamedObjects):b.ULS.sendTraceTag(537170144,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel GetGridBlockContentResponse is null")}}else b.ULS.sendTraceTag(537170146,
0,15,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model accessor for block:${this.tta}`)}}else b.ULS.shipAssertTag(537170177,0,!1,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() blockCacheItem is null")}finally{R&&R.stop()}}byb(X){var R;if(!this.af.hb(this.currentStateId))return b.ULS.sendTraceTag(509646790,0,15,`CalcAsyncEngine.getTableHeaders: stateId ${this.currentStateId} not found in gridCache`),null;const wa=null===(R=this.af.ma(this.currentStateId))||void 0===R?void 0:R.lk;
if(!wa||!wa[0])return null;R=wa[0].P5;if(!R||!R.hb(X.name))return b.ULS.sendTraceTag(509646789,0,15,`CalcAsyncEngine.getTableHeaders: table key found wasn't found in cached named objects list. cached named objects is null: ${null==R}`),null;X=R.ma(X.name);if(!X||!X.xE)return null;R=new l.a;for(let na of X.xE.x$)R.add(na.value);return R}r0g(X,R,wa){var na=B.h(this.Pc),Ba=na.Pb(R);Ba=this.z1d(Ba,null,"CopyPaste");wa=this.z1d(na.Pb(X),wa,"CopyPaste");if(0>Ba||0>wa||Ba!==wa)b.ULS.sendTraceTag(537170143,
0,15,`CalcAsyncEngine::CalculateFormulaForCopyPaste(). Revision not valid. sourceRevision:${wa}, targetRevision:${Ba}.`);else{wa=[];na=z.d(this.Pc.va.na);var Ra=this.Qjd(na);X=L.Q$("CalculateFormulaForCopyPaste.srcRange",na,X.top-1,X.left-1,X.bottom-1,X.right-1);R=L.Q$("CalculateFormulaForCopyPaste.targetRange",na,R.top-1,R.left-1,R.bottom-1,R.right-1);R=excelOnlineCalc.calc.copyPasteRangePasteEdit(R,X,Ra);wa.push(R);R=Ra?String.format("CalcAsyncEngine::CalculateFormulaForCopyPaste() for sheet:{0}, stateId:{1} viewport:(({2},{3})-({4},{5}))",
na,Ba,Ra.row,Ra.column,Ra.lastRow,Ra.lastColumn):String.format("CalcAsyncEngine::CalculateFormulaForCopyPaste() for sheet:{0}, stateId:{1} viewport:(({2},{3})-({4},{5}))",na,Ba,"","","","");b.ULS.sendTraceTag(537170142,0,50,R);this.Nq.editRangePaste(Ba,wa);this.resumeRecalc()}}Qjd(X){const R=this.Z8e();let wa=null;R?wa=L.Q$("GetViewport.viewport",X,R.top-1,R.left-1,R.bottom-1,R.right-1):b.ULS.sendTraceTag(537170141,0,50,"CalcAsyncEngine::GetViewport() viewportRange is null, calc will use entire sheet...");
return wa}Z8e(){const X=B.h(this.Pc);let R=X.hi;if(B.h(this.Pc).ib.fj){R=X.Rf(1).hi;if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:5497152_JSCrash_At_CalcAsyncEngine_GetViewportRange")&&!R)return b.ULS.sendTraceTag(537170140,0,15,"CalcAsyncEngine::GetViewportRange viewportRange is null."),null;R.Sda(1,1);R.Sda(3,1)}return R}z1d(X,R,wa){let na;if(!this.Nq||!X)return b.ULS.sendTraceTag(537170139,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() recalc engine is null:${!this.Nq}, modifiedCell is null:${!X}, operation:${wa}`),
-1;const Ba=X.cell.CQ-1,Ra=X.cell.BQ-1;if(X.cell.Xx){if(na=X.cell.Xx.zxe,na===d.a.oe)return b.ULS.sendTraceTag(537170138,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() BlockRevision unknown for block:${X.cell.Xx.Zc}, operation:${wa}`),-1}else return b.ULS.sendTraceTag(537170137,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() GridBlockModelProxy is null cell:(${X.cell.CQ},${X.cell.BQ}), operation:${wa}`),-1;if(na<this.xt)return b.ULS.sendTraceTag(537170136,0,50,`CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:(${Ba},${Ra}) - blockRevision:${na} < lastUpdatedStateId:${this.xt}, operation:${wa}`),
-1;if(na<this.currentStateId)return b.ULS.sendTraceTag(537170135,0,50,`CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:(${Ba},${Ra}) - blockRevision:${na} < currentStateId:${this.currentStateId}, operation:${wa}`),-1;R&&!this.kEd&&(this.Nq.setOnRecalcResults(R),this.kEd=!0);return this.iZj()&&!this.VPb(2)?(b.ULS.sendTraceTag(537170134,0,15,`CalcAsyncEngine.ValidateCalculateFormulaInit: UpdateData failed. operation:${wa}`),-1):na}getFormulaBarText(X,R,wa){return R&&R.startsWith("'")?
R:X.cell.formulaBarText||wa.toString()}dgh(X,R,wa){let na=null;if(this.cAe()&&this.af.ma(this.xt).R_a){const Ba=this.af.ma(this.xt).R_a[X];if(null===Ba||void 0===Ba?0:Ba.Fxc)na=Ba.qze}wa=this.omi(na,R,wa);R=this.Y7g(na,R,wa);b.ULS.sendTraceTag(50671754,0,50,`CalcAsyncEngine::CreateRangeUpdateCommands() completed for Block Hash:${X} StateId:${this.currentStateId} number of formulas ${R}`)}omi(X,R,wa){let na=!1;const Ba=L.T0e(R);if(X){const Ra=L.T0e(X);x.a.equals(Ra,Ba,!1)&&(na=!0)}na?this.mKg(X,this.xt,
wa):this.oKg(R,wa);return na}cAe(){let X=!1;this.Nq&&-1!==this.xt&&(X=this.Nq.stateIdAvailable(this.xt));return X&&this.af.hb(this.xt)&&this.xt<this.currentStateId}Y7g(X,R,wa){let na;na=0;let Ba,Ra;for(R.reset();Ba=R.getNextCell();)H.f(Ba.formula)&&na++,(Ra=wa?X.getCell(Ba.row,Ba.col):null)?this.U7g(R,Ba,Ra):this.nKg(R,Ba);if(wa)for(X.reset();Ra=X.getNextCell();)(Ba=R.getCell(Ra.row,Ra.col))||this.upe(X,Ra);return na}wAj(){this.Nq.setOnUpdateRequest(()=>{})}vAj(){this.Nq.setOnUnresponsive((X,R,wa,
na)=>{this.R0i(X,R,wa,na)})}R0i(X,R,wa,na){b.ULS.sendTraceTag(537170126,0,15,`CalcAsyncEngine.onUnresponsive: worker thread was unresponsive. timeout:${X}, waitTime:${R}, timeoutCount:${wa}, hasBeenClosed:${na}.`);na&&(this.hpj(),this.Hoa())}hpj(){this.dd(null,null);this.rwd=this.kEd=!1;this.NHd=0;this.FHd=this.HHd=this.IHd=this.GHd=-1}close(){this.Nq.close()}clearCache(){this.Nq.clearCache()}resumeRecalc(){this.Nq.resumeRecalc()}Kzj(){this.Nq.setA1ReferenceStyle(!0)}Wdj(){if(this.instantaneousSupportInformationManager){var X=
this.instantaneousSupportInformationManager.Eji;const wa=this.instantaneousSupportInformationManager.Hji,na=this.instantaneousSupportInformationManager.Gji,Ba=this.instantaneousSupportInformationManager.Fji;var R=!1;X!==this.GHd&&(R=!0,this.GHd=X);wa!==this.IHd&&(R=!0,this.IHd=wa);na!==this.HHd&&(R=!0,this.HHd=na);Ba!==this.FHd&&(R=!0,this.FHd=Ba);const Ra=[];y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSExceLintExperimentIsEnabled",!1)&&(R=excelOnlineCalc.calc.runExperiment("ExceLintExperiment",
null),Ra.push(R),R=!0);y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnitExperiment",!1)&&(R=excelOnlineCalc.calc.runExperiment("UnitExperiment",null),Ra.push(R),R=!0);y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",!1)&&(R=excelOnlineCalc.calc.runExperiment("AutocompleteExperiment",null),Ra.push(R),R=!0);R&&(X=excelOnlineCalc.calc.recalcServiceConfig(null,X,null,wa,null,null,null,na,Ra,Ba),this.Nq.reconfigure(X))}}tCj(X){let R=null;
if(this.af.hb(this.currentStateId))try{this.U$=[],R=this.Pc.Jb.Gc("ModelUpdate",`CalcAsyncEngine::SetUpdatedRanges() StateId:${this.currentStateId} UpdateTriggerData:${M[X]}`),h.a.forEach(this.af.ma(this.currentStateId).R_a,(wa,na)=>{na.Fxc||(this.dgh(wa,na.qze,na.sheetName),na.Fxc=!0)},null),this.Nq.updateRanges(this.currentStateId,this.U$)}finally{R&&R.stop()}else b.ULS.sendTraceTag(537170122,0,15,`CalcAsyncEngine::SetUpdatedRanges StateId:${this.currentStateId} does not exist in GridCache`)}sCj(){const X=
[],R=this.cAe();var wa=R&&this.af.ma(this.xt).lk&&this.af.ma(this.xt).lk[0]&&this.af.ma(this.xt).lk[0].Knc?this.af.ma(this.xt).lk[0].P5:null;this.eFe(wa,this.af.ma(this.currentStateId).lk[0].P5,null,this.xt,X);this.af.ma(this.currentStateId).lk[0].Knc=!0;for(let na=1;na<this.af.ma(this.currentStateId).lk.length;na++)wa=-1,R&&this.af.ma(this.xt).lk&&(wa=this.Xid(this.af.ma(this.currentStateId).lk[na].j7.sheetName,this.xt)),wa=-1!==wa&&this.af.ma(this.xt).lk[wa].Knc?this.af.ma(this.xt).lk[wa].P5:null,
this.eFe(wa,this.af.ma(this.currentStateId).lk[na].P5,this.af.ma(this.currentStateId).lk[na].j7.sheetId,this.xt,X),this.af.ma(this.currentStateId).lk[na].Knc=!0;this.Nq.updateNamedObjects(this.currentStateId,X)}eFe(X,R,wa,na,Ba){if(void 0!==wa&&null!==wa){var Ra=excelOnlineCalc.calc.undefinedNamesWrite(wa);Ba.push(Ra)}if(X){var qa=!1;Ra=[];var La=[];if(R)for(let mc of R){const Zb=mc.value;if(X.hb(mc.key)){var Yb=X.ma(mc.key);L.qLi(Yb,Zb)?qa=!0:(Yb=excelOnlineCalc.calc.namedObject(mc.key,null),Ra.push(Yb),
L.MWc(mc.key,Zb,La))}else L.MWc(mc.key,Zb,La)}for(let mc of X)R&&R.hb(mc.key)||(X=excelOnlineCalc.calc.namedObject(mc.key,null),Ra.push(X));qa&&(R=excelOnlineCalc.calc.namedObjectsPromote(wa,na),Ba.push(R));0<Ra.length&&(R=excelOnlineCalc.calc.namedObjectsWrite(wa,Ra),Ba.push(R));0<La.length&&(wa=excelOnlineCalc.calc.namedObjectsWrite(wa,La),Ba.push(wa))}else if(R){na=[];for(La of R)L.MWc(La.key,La.value,na);0<na.length&&(wa=excelOnlineCalc.calc.namedObjectsWrite(wa,na),Ba.push(wa))}}wWg(){return this.af.ma(this.currentStateId).R_a[this.tta]?
(b.ULS.sendTraceTag(537170121,0,50,`CalcAsyncEngine::BlockPreviouslyHandled Block Hash:${this.tta} StateId:${this.currentStateId} previously handled`),!0):!1}oWg(X){return 1===X.getColumnNumbers().length&&X.getColumnNumbers()[0]===L.Uyd+1?!1:!0}yhi(){let X=!1;B.h(this.Pc).Ca.Pvb(R=>{R.state&1&&this.Pc.ea.se===R.ae.Revision&&(this.uJe(R),X=!0)});return X}oHe(X,R){var wa=X.getRowNumbers(),na=X.getColumnNumbers();X=wa[0]-1;wa=wa[wa.length-1]-1;const Ba=na[0]-1;na=na[na.length-1]-1;R=this.Yxb(R);if(!R){const Ra=
this.af.hb(this.currentStateId)&&this.af.ma(this.currentStateId).lk?this.af.ma(this.currentStateId).lk.length:0;b.ULS.sendTraceTag(537170120,0,15,`CalcAsyncEngine::CreateBlockRangeLocation SheetName not found. Number of existing sheets ${Ra}`)}return L.Q$("CreateBlockRangeLocation",R,X,Ba,wa,na)}mKg(X,R,wa){if(wa=this.oHe(X,wa)){var na=L.W5b(X.getRowNumbers());X=L.W5b(X.getColumnNumbers());R=excelOnlineCalc.calc.rangePromote(wa,R,na,X);this.U$[this.U$.length]=R}}oKg(X,R){if(R=this.oHe(X,R)){var wa=
L.W5b(X.getRowNumbers());X=L.W5b(X.getColumnNumbers());X=excelOnlineCalc.calc.rangeWrite(R,null,wa,X);this.U$[this.U$.length]=X}}U7g(X,R,wa){let na=null,Ba=0,Ra=0;switch(R.valueType){case 2:na=this.Njd(R);var qa=this.Njd(wa);qa=x.a.equals(qa,na,!1);break;case 1:null===R.value&&null===wa.value?qa=!0:(Ba=parseFloat(R.value),qa=parseFloat(wa.value)===Ba);break;default:null===R.value&&null===wa.value?qa=!0:(Ra=parseFloat(R.value),qa=Ra===parseFloat(wa.value))}qa&&R.valueType===wa.valueType&&R.ifmt===
wa.ifmt&&R.formulaType===wa.formulaType&&x.a.equals(wa.formula,R.formula,!1)||(void 0!==R.formula&&null!==R.formula||void 0!==R.value&&null!==R.value||void 0!==R.text&&null!==R.text||this.wIh&&0!==R.valueType?this.u_b(X,R,na,Ba,Ra):this.upe(X,R))}MJg(X){if(this.Pc.yb&&this.Pc.yb.items)for(let Ra=0;Ra<this.Pc.yb.count;Ra++){var R=this.Pc.yb.items[Ra];if(2!==R.type&&3!==R.type)continue;var wa=0,na=R.name,Ba=na.lastIndexOf("!");if(0<Ba){wa=na.substr(0,Ba);"'"===wa.charAt(0)&&(wa=wa.substr(1,wa.length-
2));wa=this.Xid(wa,this.currentStateId);if(-1===wa){R=this.af.hb(this.currentStateId)&&this.af.ma(this.currentStateId).lk?this.af.ma(this.currentStateId).lk.length:0;b.ULS.sendTraceTag(595096334,0,50,`CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets ${R}`);continue}na=na.substr(Ba+1)}wa=this.af.ma(this.currentStateId).lk[wa].P5;let qa=R.usedRange;2===R.type&&(qa=m.a(R));if(wa.hb(na)){if(Ba=wa.ma(na),Ba.range=qa,Ba.attributes=R.attributes,2===Ba.type&&(na=L.XXe(R.name,
X),R=(wa=y.EwaSettings.isChangeGateEnabled("OfficeVSO:6053425_loadHeadersForAllTablesCalc"))?R.pO:null===na||void 0===na?void 0:na.ColHeadersList,na||wa))if(!Ba.xE)Ba.xE=new u(R);else if(R)for(const La of R.HeadersList)Ba.xE.x$.ia(La.Index,La.Name)}else if(Ba=this.Yxb(R.sheetName)){Ba=new U(R.type,R.name,qa,Ba,R.attributes);if(2===Ba.type)if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:6053425_loadHeadersForAllTablesCalc")&&R.pO)Ba.xE=new u(R.pO);else if(R=L.XXe(R.name,X))Ba.xE=new u(R.ColHeadersList);
wa.ia(na,Ba)}else R=this.af.hb(this.currentStateId)&&this.af.ma(this.currentStateId).lk?this.af.ma(this.currentStateId).lk.length:0,b.ULS.sendTraceTag(537170117,0,50,`CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets ${R}`)}}u_b(X,R,wa,na,Ba){var Ra=X.getRowNumbers()[R.row]-1;X=X.getColumnNumbers()[R.col]-1;Ra=L.Q$("AddRangeUpdateCommand",this.ctb,Ra,X,Ra,X);X=null;let qa=R.formula||R.text;const La=excelOnlineCalc.calc.blankValue;let Yb=null;void 0!==R.text&&null!==
R.text||void 0!==R.value&&null!==R.value||(wa="",Yb="This cell contains blanks only",0===R.formulaType&&(qa=""));switch(R.valueType){case 2:null!==wa&&(0===R.formulaType&&(X=excelOnlineCalc.calc.valueCellData(qa,wa,R.ifmt,Yb)),1===R.formulaType&&(X=excelOnlineCalc.calc.cellFormulaCellData(qa,wa,R.ifmt,Yb)),2===R.formulaType&&(X=excelOnlineCalc.calc.valueCellData("",La,0,"This cell is a part of an array")));break;case 1:isNaN(na)?b.ULS.sendTraceTag(537170116,0,50,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${R.row},${R.col}) invalid numeric value`):
(0===R.formulaType&&(X=excelOnlineCalc.calc.valueCellData(qa,na,R.ifmt,null)),1===R.formulaType&&(X=excelOnlineCalc.calc.cellFormulaCellData(qa,na,R.ifmt,null)),2===R.formulaType&&(X=excelOnlineCalc.calc.valueCellData("",La,0,"This cell is a part of an array")));break;case 3:isNaN(Ba)?b.ULS.sendTraceTag(537170115,0,15,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${R.row},${R.col}) invalid boolean value`):(wa=1===Ba?!0:!1,0===R.formulaType&&(X=excelOnlineCalc.calc.valueCellData(qa,wa,R.ifmt,null)),
1===R.formulaType&&(X=excelOnlineCalc.calc.cellFormulaCellData(qa,wa,R.ifmt,null)),2===R.formulaType&&(X=excelOnlineCalc.calc.valueCellData("",La,0,"This cell is a part of an array")));break;case 4:isNaN(Ba)?b.ULS.sendTraceTag(537170114,0,15,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${R.row},${R.col}) invalid error value`):(wa=excelOnlineCalc.calc.errorValue(Ba),0===R.formulaType&&(X=excelOnlineCalc.calc.valueCellData(qa,wa,R.ifmt,null)),1===R.formulaType&&(X=excelOnlineCalc.calc.cellFormulaCellData(qa,
wa,R.ifmt,null)),2===R.formulaType&&(X=excelOnlineCalc.calc.valueCellData("",La,0,"This cell is a part of an array")));break;default:X=excelOnlineCalc.calc.valueCellData("",La,R.ifmt,null)}X&&(R=excelOnlineCalc.calc.rangeWrite(Ra,X,null,null),this.U$[this.U$.length]=R)}nKg(X,R){switch(R.valueType){case 2:this.u_b(X,R,this.Njd(R),null,0);break;case 1:this.u_b(X,R,null,parseFloat(R.value),0);break;default:this.u_b(X,R,null,null,parseFloat(R.value))}}upe(X,R){var wa=X.getRowNumbers()[R.row]-1;X=X.getColumnNumbers()[R.col]-
1;wa=L.Q$("AddRangeUpdateCommandEmptyCell",this.ctb,wa,X,wa,X);R=excelOnlineCalc.calc.valueCellData("",excelOnlineCalc.calc.blankValue,R.ifmt,null);R=excelOnlineCalc.calc.rangeWrite(wa,R,null,null);this.U$[this.U$.length]=R}Yxb(X){X=this.Xid(X,this.currentStateId);return 0<X?this.af.ma(this.currentStateId).lk[X].j7.sheetId:null}Xid(X,R){if(!this.af.hb(R))return b.ULS.sendTraceTag(537170113,0,15,`CalcAsyncEngine.GetSheetInternalIndex StateId:${R} does not exist in GridCache`),-1;const wa=this.af.ma(R);
return wa.lk?wa.getSheetIndex(X):(b.ULS.sendTraceTag(537170112,0,15,`CalcAsyncEngine.GetSheetInternalIndex sheetsInformation == null for StateId:${R}`),-1)}SBj(){if(!this.af.hb(this.currentStateId)||!this.af.ma(this.currentStateId).lk.length)return b.ULS.sendTraceTag(537170083,0,15,`CalcAsyncEngine::SetSheetNamesAndUsedRanges() No sheets information for StateId:${this.currentStateId} or StateId does not exist in GridCache`),!1;const X=[];for(let R=1;R<this.af.ma(this.currentStateId).lk.length;R++){const wa=
this.af.ma(this.currentStateId).lk[R];wa&&X.push(wa.j7)}this.Nq.updateSheetNames(this.currentStateId,X);this.Nq.updateUnusedCells(this.currentStateId,this.af.ma(this.currentStateId).Mig);return!0}setNumberFormats(){if(this.instantaneousSupportInformationManager){var X=[];for(const R of this.instantaneousSupportInformationManager.rya){const wa=excelOnlineCalc.calc.numberFormat(R.IfmtIndex,R.FormatString,R.Builtin);X.push(wa)}this.Nq.setNumberFormats(X,!0)}}kyj(){if(this.instantaneousSupportInformationManager&&
this.instantaneousSupportInformationManager.Ie){var X=this.Chi();if(!this.rwd||X)this.V5b(),this.instantaneousSupportInformationManager.Ie.TrueValueString&&(this.trueName=this.instantaneousSupportInformationManager.Ie.TrueValueString),this.instantaneousSupportInformationManager.Ie.FalseValueString&&(this.falseName=this.instantaneousSupportInformationManager.Ie.FalseValueString),X=N.CalcHelper.jIe(this.instantaneousSupportInformationManager,X),this.Nq.setLocale(X),this.rwd=!0}}FCj(){var X=null;if(void 0!==
this.Pc.workbookContext.TimeZoneInformation&&null!==this.Pc.workbookContext.TimeZoneInformation){X=null;this.Pc.workbookContext.TimeZoneInformation.StandardDate.Month&&(X=excelOnlineCalc.date.dateTime(this.Pc.workbookContext.TimeZoneInformation.StandardDate.Year,this.Pc.workbookContext.TimeZoneInformation.StandardDate.Month,this.Pc.workbookContext.TimeZoneInformation.StandardDate.Day,this.Pc.workbookContext.TimeZoneInformation.StandardDate.Hour,this.Pc.workbookContext.TimeZoneInformation.StandardDate.Minute,
this.Pc.workbookContext.TimeZoneInformation.StandardDate.Second,this.Pc.workbookContext.TimeZoneInformation.StandardDate.DayOfWeek+1,this.Pc.workbookContext.TimeZoneInformation.StandardDate.Milliseconds,3));let R=null;this.Pc.workbookContext.TimeZoneInformation.DaylightDate.Month&&(R=excelOnlineCalc.date.dateTime(this.Pc.workbookContext.TimeZoneInformation.DaylightDate.Year,this.Pc.workbookContext.TimeZoneInformation.DaylightDate.Month,this.Pc.workbookContext.TimeZoneInformation.DaylightDate.Day,
this.Pc.workbookContext.TimeZoneInformation.DaylightDate.Hour,this.Pc.workbookContext.TimeZoneInformation.DaylightDate.Minute,this.Pc.workbookContext.TimeZoneInformation.DaylightDate.Second,this.Pc.workbookContext.TimeZoneInformation.DaylightDate.DayOfWeek+1,this.Pc.workbookContext.TimeZoneInformation.DaylightDate.Milliseconds,3));X=excelOnlineCalc.date.tzData(this.Pc.workbookContext.TimeZoneInformation.Bias,X,this.Pc.workbookContext.TimeZoneInformation.StandardBias,R,this.Pc.workbookContext.TimeZoneInformation.DaylightBias)}else b.ULS.sendTraceTag(537170082,
0,15,"CalcAsyncEngine.SetWorkbookProperties: TimeZoneInformation is null");X=excelOnlineCalc.calc.workbookProps(this.Pc.workbookContext.F1904,this.Pc.workbookContext.FDateCompatibility,X);this.Nq.setWorkbookProps(X)}Hoa(){const X=y.EwaSettings.ra(570)?w.local:w.fSj,[R,wa]=v.a.gV(this.Pc)?[excelOnlineCalc.x10.PluginSchedulerSingleton.instance(),excelOnlineCalc.x10.GridImportManagerSingleton.instance()]:[void 0,void 0];this.UJd=n.c(excelOnlineCalc.calc.createRecalcService(X,R,wa));this.UJd.continueWith(na=>
{na.exception?b.ULS.sendTraceTag(537170075,0,50,`CalcAsyncEngine.TryInitialize: Calc web worker failed: ${na.exception.toString()}`):(b.ULS.sendTraceTag(537170078,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker is working as expected"),(this.Nq=this.UJd.result)?this.VPb(0)?this.vAj():b.ULS.sendTraceTag(537170077,0,15,"CalcAsyncEngine.TryInitialize: UpdateData failed to initialize"):b.ULS.sendTraceTag(537170076,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker result is null"))})}Chi(){const X=
this.instantaneousSupportInformationManager.nja;if(!X||this.NHd===X.length)return null;this.NHd=X.length;return N.CalcHelper.WHe(X)}V5b(){this.errorTypeNames=N.CalcHelper.V5b()}Ehi(){if(!(this.af.hb(this.currentStateId)&&0<this.af.ma(this.currentStateId).lk.length)){this.af.ia(this.currentStateId,new S(this.Rqd));this.af.ma(this.currentStateId).t6f(0,new E(null));var X=this.Pc.va;for(let na=0;na<X.count;na++){var R=Object(k.a)(C.a,X.getItem(na));if(R){void 0!==R.sheetId&&null!==R.sheetId&&void 0!==
R.name&&null!==R.name&&R.sheetId.length&&R.sheetName.length||b.ULS.sendTraceTag(537170074,0,15,`CalcAsyncEngine::InitializeGridForStateId() invalid sheet - index:${na} Id:${R.sheetId} Hash:${R.hash} NameLength:${R.name?R.name.length:-1}`);var wa=void 0;wa=excelOnlineCalc.calc.sheetName(R.sheetId,R.name);this.af.ma(this.currentStateId).t6f(na+1,new E(wa));wa=R.usedRange.eS();wa=excelOnlineCalc.calc.rangeLocation(0,0,wa.LastRow,wa.LastColumn);R=excelOnlineCalc.calc.unusedCellsUpdate(R.sheetId,wa);this.af.ma(this.currentStateId).Mig.push(R)}else b.ULS.sendTraceTag(537170073,
0,15,`CalcAsyncEngine.InitializeGridForStateId(): not sheet item for StateId:${this.currentStateId} sheet-index:${na}`)}}}G4g(){for(let X of this.af)X.key<this.xt&&this.af.remove(X.key)}Njd(X){X=X.value||X.text;if(void 0===X||null===X)X="";return X}iZj(){if(!this.af.hb(this.currentStateId))return!1;let X=!1;h.a.forEach(this.af.ma(this.currentStateId).R_a,(R,wa)=>{wa.Fxc||(X=!0)},null);return X}c6c(X){const R={};R.reason=X;R.kind=1;return R}Iic(){return this.af.hb(this.currentStateId)&&this.af.ma(this.currentStateId).lk&&
this.af.ma(this.currentStateId).lk[0]&&this.af.ma(this.currentStateId).lk[0].P5?!0:!1}static fch(X){const R=[];if(null===X||void 0===X?0:X.x$)for(let wa of X.x$)X=excelOnlineCalc.calc.columnData(wa.key,wa.value),R.push(X);return R}static qLi(X,R){if(X.type!==R.type||X.attributes!==R.attributes||!x.a.equals(X.fullName,R.fullName,!1)||!X.range.equals(R.range))return!1;if(!X.xE&&!R.xE)return!0;if(!X.xE||!R.xE||X.xE.x$.count!==R.xE.x$.count)return!1;for(let wa of X.xE.x$){let na;if(!(wa.value&&({value:na}=
R.xE.x$.Fc(wa.key)).returnValue&&na&&x.a.equals(wa.value,na,!1)))return!1}return!0}static MWc(X,R,wa){var na=L.Q$("NamedObject",R.sheetId,R.range.top-1,R.range.left-1,R.range.bottom-1,R.range.right-1);if(2===R.type){const Ba=!!(R.attributes&16),Ra=!!(R.attributes&8);R=L.fch(R.xE);na=excelOnlineCalc.calc.namedTableData(na,Ba,Ra,R);X=excelOnlineCalc.calc.namedObject(X,na)}else na=excelOnlineCalc.calc.namedRangeData(na),X=excelOnlineCalc.calc.namedObject(X,na);wa.push(X)}static T0e(X){const R=Sys.Serialization.JavaScriptSerializer.serialize(X.getRowNumbers());
X=Sys.Serialization.JavaScriptSerializer.serialize(X.getColumnNumbers());return R+X}static W5b(X){let R=null;if(1<X.length)for(let wa=1;wa<X.length;wa++){let na=0;for(;X[wa-1]+1+na<X[wa];)R=R||[],R.push(X[wa-1]+na),na++}return R}static XXe(X,R){if(!R)return null;for(let wa=0,na=R.length;wa<na;++wa)if(x.a.equals(X,R[wa].Name,!1))return R[wa];return null}static Q$(X,R,wa,na,Ba,Ra){const qa=(La,Yb,mc,Zb)=>{(0>mc||mc>=Zb)&&b.ULS.sendTraceTag(537170072,0,15,`CalcAsyncEngine::CreateSheetRangeLocation() callerId:${La} invalid ${Yb}:${mc}`)};
void 0!==R&&null!==R||b.ULS.sendTraceTag(537170071,0,15,`CalcAsyncEngine::CreateSheetRangeLocation() callerId:${X} sheetId is null`);qa(X,"top",wa,L.rvf);qa(X,"left",na,L.Uyd);qa(X,"bottom",Ba,L.rvf);qa(X,"right",Ra,L.Uyd);return excelOnlineCalc.calc.sheetRangeLocation(R,wa,na,Ba,Ra)}}L.rvf=1048576;L.Uyd=16384;Object(c.a)(L,"CalcAsyncEngine",null,[2]);const aa=(X,R,wa)=>{switch(X.type){case 2:return excelOnlineCalc.calc.valueCellData(R,X.value,wa,null);case 1:return excelOnlineCalc.calc.valueCellData(R,
parseFloat(X.value),wa,null);case 3:return excelOnlineCalc.calc.valueCellData(R,1===parseFloat(X.value),wa,null);case 4:return excelOnlineCalc.calc.valueCellData(R,excelOnlineCalc.calc.errorValue(parseFloat(X.value)),wa,null);default:return excelOnlineCalc.calc.valueCellData("",excelOnlineCalc.calc.blankValue,wa,null)}};class V{constructor(){this.$J=this.aK=this.dF=this.eF=this.TZ=!1}}Object(c.a)(V,"AbsoluteRelativeReferenceInfo",null,[]);var P=a(1E3),ba=a(24);class Y{}Y.KNf="#";Object(c.a)(Y,"Operators",
null,[]);var Z=a(1001);class ea{}ea.sheet="Sheet";ea.sheetRange="SheetRange";ea.document="Document";ea.iei="Ident";Object(c.a)(ea,"TraverseFormulaQualifierTypes",null,[]);var ra=a(1002),O=a(890),da=a(803),xa=a(41),ia=a(55),Ma=a(71),Ta=a(292),Da=a(38);class fa extends Sys.EventArgs{constructor(X){super();this.Yj=X}}Object(c.a)(fa,"EditedCellRecalcCompleteEventArgs",Sys.EventArgs,[]);var ua=a(187),Fa=a(105),ca;let ka=ca=class extends Da.a{constructor(X){super();this.cu=null;this.qng=!1;this.lOd=this.instantaneousSupportInformationManager=
this.IHb=null;this.DBd=new Map;this.ofe=null;this.Kpc=R=>{b.ULS.sendTraceTag(537170005,0,50,"CalcManager.OnLocaleInformationAvailable() called");R.fMd(this.Kpc);R.nja.length?this.ppc(R,Sys.EventArgs.Empty):(b.ULS.sendTraceTag(537170004,0,50,"CalcManager.OnLocaleInformationAvailable() - waiting for functions information"),R.Nqe(this.ppc))};this.ppc=R=>{b.ULS.sendTraceTag(537170003,0,50,"CalcManager.OnFunctionsInfoReady called");R.WLd(this.ppc);this.QWj(R)};this.onContentReady=()=>{this.cu&&(this.instantaneousSupportInformationManager&&
this.instantaneousSupportInformationManager.zod||ia.Task.delay(0).continueWith(()=>{this.cu.VPb(1)},0,null,Ma.a.current))};this.iAf=(R,wa)=>{this.cu&&(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.zod||this.cu.uJe(wa.Xc.block))};b.ULS.sendTraceTag(537170067,0,50,"Creating CalcManager");this.khc=!1;this.jb=X;this.Wt=B.h(X);this.oIc=null;this.gridView.Uu(this.onContentReady);this.gridView.Ca.kXc(this.iAf);this.$.da.gb(268,R=>{R.Ie?(b.ULS.sendTraceTag(537170066,
0,50,"CalcManager.ctor: LocaleInformation already available..."),this.Kpc(R,Sys.EventArgs.Empty)):(b.ULS.sendTraceTag(537170065,0,50,"CalcManager.ctor: waiting for LocaleInformation..."),R.ire(this.Kpc))})}CMg(X){this.addHandler(ca.AOe,X)}Zxf(X){this.raiseEvent(ca.AOe,new fa(X))}get Nr(){return this.oIc}get gridView(){return this.Wt}get $(){return this.jb}get jB(){return this.ofe}get localeInfo(){return this.Nr?this.Nr.config.localeInfo:null}get config(){return this.Nr.config}dispose(){b.ULS.sendTraceTag(537170064,
0,50,"CalcManager.Dispose called");this.$.da.gb(268,X=>{X.fMd(this.Kpc);X.WLd(this.ppc)});this.gridView&&(this.gridView.my(this.onContentReady),this.gridView.Ca&&this.gridView.Ca.VVf(this.iAf),this.Wt=null);this.oIc=null;y.EwaSettings.isChangeGateEnabled("OfficeVSO:7108565_CalcNotInitializedAfterDisposed")&&(this.khc=!1)}s0g(X,R,wa,na=null){this.cu&&this.cu.q0g(X,R,wa,na)}evalFormula(X,R,wa,na){return this.cu?this.cu.evalFormula(X,R,wa,na):Promise.reject("calc engine not initialized")}Lub(X,R,wa,
na){return this.cu?this.cu.Lub(X,R,wa,na):Promise.reject("CalcEngine is null")}byb(X){if(!X)return b.ULS.sendTraceTag(509649312,0,10,"CalcManager.GetTableHeaders: table is null"),null;if(!this.cu)return null;b.ULS.shipAssertTag(537170059,0,2===X.type,"CalcManager.GetTableHeaders() - ActiveItem is not a table");return this.cu.byb(X)}Nse(X,R){if(!R||2!==X.type)return!1;X=m.a(X);return X.right-X.left+1===R.count}MWe(X,R){if(!this.IHb)return this.qng||b.ULS.sendTraceTag(537170057,0,15,"CalcManager.ExtractReferenceWrappers - parser not initialized"),
null;var wa=this.gta(ba.Range.Mc(1,1));wa=this.IHb.parseFormula(excelOnlineCalc.parse.parseLocals(1,wa.range),X);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(wa))return b.ULS.sendTraceTag(537170056,0,10,"CalcManager.ExtractReferenceWrappers - ParseFormula failed"),null;try{let na;if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:6518739_FlightRemovalStructuredReferencesHighlighting")){const Ba=null!==R&&void 0!==R?R:this.gridView.ha.qa.activeCell,Ra=excelOnlineCalc.location.gridCell(Ba.top-
1,Ba.left-1),qa=excelOnlineCalc.location.documentLoc("",this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),La=excelOnlineCalc.location.sheetIndex(qa,this.$.va.na.sheetId),Yb=this.Agh(Ra,La);this.lOd||(this.lOd=excelOnlineCalc.util.createResolver(this.zgh()));na=excelOnlineCalc.parse.parseResultHelper.extractReferences(wa,this.Nr.config.localeInfo,y.EwaSettings.ra(512),Yb,this.lOd)}else na=excelOnlineCalc.parse.parseResultHelper.extractReferences(wa,this.Nr.config.localeInfo,y.EwaSettings.ra(512));
y.EwaSettings.ra(101)&&this.F1j(na,X);return na}catch(na){return b.ULS.sendTraceTag(537170055,0,10,`CalcManager.ExtractReferenceWrappers - exception: ${na.message}`),null}}extractLetVariables(X,R){if(!this.IHb)return this.qng||b.ULS.sendTraceTag(537170054,0,15,"CalcManager.ExtractLetVariables - parser not initialized"),null;const wa=this.gta(ba.Range.Mc(1,1));X=this.IHb.parseFormula(excelOnlineCalc.parse.parseLocals(1,wa.range),X);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(X))return b.ULS.sendTraceTag(537170053,
0,10,"CalcManager.ExtractLetVariables - ParseFormula failed"),null;try{return excelOnlineCalc.parse.parseResultHelper.extractLetVariables(X,R,this.Nr.config.localeInfo)}catch(na){return b.ULS.sendTraceTag(537170052,0,10,`CalcManager.ExtractLetVariables - exception: ${na.message}`),null}}extractReferences(X,R,wa,na,Ba){if(!R)return b.ULS.sendTraceTag(537170051,0,10,"CalcManager.ExtractReferences - sheetName is null"),null;if(!wa)return b.ULS.sendTraceTag(537170050,0,10,"CalcManager.ExtractReferences - documentName is null"),
null;Ba=this.MWe(X,Ba);if(!Ba)return b.ULS.sendTraceTag(537170049,0,15,"CalcManager.ExtractReferences - ExtractReferenceWrappers returned null"),null;try{return this.xfh(Ba,R,wa,X,na)}catch(Ra){return b.ULS.sendTraceTag(537170048,0,10,`CalcManager.ExtractReferences - exception: ${Ra.message}`),null}}s4h(X,R,wa,na){if(!X)return b.ULS.sendTraceTag(537170019,0,10,"CalcManager.GetSubExpressionSpanForContextualFormulaPreview - range is null"),null;if(!R||0>=R.length)return b.ULS.sendTraceTag(537170018,
0,10,"CalcManager.GetSubExpressionSpanForContextualFormulaPreview - formula is null/empty"),null;X=this.gta(X);if(!this.Nr||!X)return null;const Ba=this.Bwb(X).returnValue;if(!Ba||Ba.Q6a)return null;wa=excelOnline.utils.getCharIndexInTextFromPoint(wa,na,y.EwaSettings.ra(512));return 0>wa?null:excelOnlineCalc.runtime.getSubExpressionFromFormulaCharacterIndex(this.Nr.config,wa,R,X)}g0g(X,R,wa,na){if(!X)return b.ULS.sendTraceTag(537170017,0,10,"CalcManager.CalcPartialResultsForFormula - range is null"),
null;let Ba=null;return this.evalFormula(R,X,void 0,excelOnlineCalc.calc.evalFormulaFormatOrigin()).then(Ra=>{let qa;const La=({kind:qa}=this.Nr.Xth(Ra,wa)).returnValue;8!==qa||La.length&&La!==N.CalcHelper.unknownError?Ra=0:(b.ULS.sendTraceTag(537170016,0,50,"EvalSession.GetPartialResultValueForFormula - EvalResultToString error"),Ra=excelOnlineCalc.calc.getEvalFailureReason(Ra),void 0!==Ra&&null!==Ra||b.ULS.shipAssertTag(537170015,0,!1,"CalcHelper.GetEvalFailureReason() - result is not a failure, function should not be called"),
Ra=1);return Ba=na?new P.a(La,na.start,na.end,Ra):new P.a(La,-1,-1,Ra)},Ra=>{b.ULS.sendTraceTag(537170014,0,10,`EvalSession.GetPartialResultValueForFormula - exception: ${Ra}`);return Promise.resolve(Ba)})}getSubExpressionSpan(X){return this.Nr&&X?excelOnlineCalc.runtime.getSubExpressionSpan(X):null}getFormulaSubExpressionObject(X,R,wa){return this.Nr&&X&&R&&wa?excelOnlineCalc.runtime.getFormulaSubExpressionObject(this.Nr.config,R,wa,this.gta(X)):null}v4h(X,R,wa){return this.Nr&&X&&R?excelOnlineCalc.runtime.getSubstitutedSubExpressionString(this.Nr.config,
R,wa,this.gta(X)):null}t4h(X,R,wa){return this.Nr&&X&&R?excelOnlineCalc.runtime.getSubExpressionSubspans(this.Nr.config.localeInfo,R,wa):null}rYh(){return this.Nr?this.Nr.config.localeInfo.listSeparator:null}isFormulaSubExpressionVolatile(X){return this.Nr?excelOnlineCalc.runtime.isFormulaSubExpressionVolatile(this.Nr.config.localeInfo,X):!1}gta(X,R=!0){return X&&this.Nr?this.Nr.Xgh(this.Nr.Kih(),X.top-1,X.left-1,R):null}Yif(X,R){if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:7173486_IsFormulaCellRefactor")){X=
this.J4a(X);if(!Object(Ta.c)(X))return null;R=this.jB.parseEdit(R,X.value);return excelOnlineCalc.util.isSuccess(R)?R.value.kind===O.a.formula:null}X=this.$cc(X);if(void 0===X||null===X)return null;X=this.jB.createFormat(X.FormatString,X.Builtin);if(!excelOnlineCalc.util.isSuccess(X))return null;R=this.jB.parseEdit(R,X.value);return excelOnlineCalc.util.isSuccess(R)?R.value.kind===O.a.formula:null}Hvi(X){X=this.J4a(X);return Object(Ta.c)(X)?"Text"===X.value.valueType:null}J4a(X){if(null==this.jB)return Object(Ta.a)("Number formatter is null");
if(null==this.instantaneousSupportInformationManager)return Object(Ta.a)("Instantaneous manager is null");if(this.DBd.has(X))return Object(Ta.d)(this.DBd.get(X));if("number"===typeof X){var R=this.$cc(X);if(null==R)return Object(Ta.a)(`Invalid ifmt=${X}`);var wa=R.FormatString;R=R.Builtin}else wa=X,R=!1;wa=this.jB.createFormat(wa,R);return excelOnlineCalc.util.isSuccess(wa)?(this.DBd.set(X,wa.value),Object(Ta.d)(wa.value)):Object(Ta.a)("Could not create number format")}getWorksheetFuncId(X){return this.localeInfo.getWorksheetFuncId(X)}xfh(X,
R,wa,na,Ba){const Ra={Items:[]};for(let mc=0;mc<X.length;mc++){var qa=X[mc];const Zb={};Zb.Start=qa.span.start;Zb.End=qa.span.end;if(Ba||qa.kind!==Z.a.func)if(Ba||qa.kind!==Z.a.sAi){if(!this.jph(qa,R,wa))continue;var La=new V;const qb=this.j1h(qa,R,La,na);if(y.EwaSettings.ra(512)){var Yb=this.iYh(qa);const Ha=this.hYh(qa);if(qb||Ha&&0<=Yb){let Ya={};Ya.Span=Zb;Ya.LetNumber=Yb;Ya.LetName=Ha;Ya.Range=qb;Ya.IsRangeRef=La.TZ;Ya.IsAbsoluteFirstRow=La.eF;Ya.IsAbsoluteFirstColumn=La.dF;Ya.IsAbsoluteSecondRow=
La.aK;Ya.IsAbsoluteSecondColumn=La.$J;Ya.IsStructRef=qa.kind===Z.a.dXd;Ra.Items.push(Ya)}}else qb&&(Yb={},Yb.Span=Zb,Yb.Range=qb,Yb.IsRangeRef=La.TZ,Yb.IsAbsoluteFirstRow=La.eF,Yb.IsAbsoluteFirstColumn=La.dF,Yb.IsAbsoluteSecondRow=La.aK,Yb.IsAbsoluteSecondColumn=La.$J,Yb.IsStructRef=qa.kind===Z.a.dXd,Ra.Items.push(Yb))}else qa=qa.ref.value.oper.kind,La={},La.Span=Zb,La.IsString=2===qa,La.IsBoolean=4===qa,La.IsNumber=1===qa,Ra.Items.push(La);else Zb.End=qa.span.start+qa.ref.name.length,qa={},qa.Span=
Zb,qa.IsFunction=!0,qa.FunctionId=this.getWorksheetFuncId(na.substring(Zb.Start,Zb.End)),Ra.Items.push(qa)}Ra.Items.sort((mc,Zb)=>mc.Span.Start-Zb.Span.Start);return Ra}iYh(X){return X.kind===Z.a.hqf?X.ref.number:-1}hYh(X){return X.kind===Z.a.hqf?X.ref.name:null}j1h(X,R,wa,na){if(X.kind===Z.a.range)return wa.TZ=!0,this.oGe(X,R,wa,na);if(X.kind===Z.a.namedRange){wa=X.ref;(X=this.$.yb.getItemByName(wa.name))||(X=this.$.yb.getItemByName(R+"!"+wa.name));if(!(X&&X.sheetName&&X.usedRange&&x.a.equals(X.sheetName,
R,!0)))return null;R=2===X.type?m.a(X):X.usedRange;return xa.m(R,X)}if(X.kind===Z.a.dXd){let Ba=X.ref,Ra;Ba.name?(Ra=this.$.yb.getItemByName(Ba.name))||(Ra=this.$.yb.getItemByName(R+"!"+Ba.name)):Ra=this.gridView.tb.Dh(this.gridView.ha.qa.activeCell);if(!(Ra&&Ra.sheetName&&Ra.usedRange&&x.a.equals(Ra.sheetName,R,!0)))return null;wa.TZ=!1;return this.oGe(X,R,wa,na)}return null}oGe(X,R,wa,na){X=X.ref;if(X.type){if(X.type===ra.a.column){var Ba=X.startIndex;X=X.endIndex;wa.dF=Ba.kind===da.a.abs;wa.$J=
X.kind===da.a.abs;return this.createRange(0,Ba.index,d.a.Vg,X.index,R)}if(X.type===ra.a.row)return Ba=X.endIndex,wa.eF=X.startIndex.kind===da.a.abs,wa.aK=Ba.kind===da.a.abs,this.createRange(X.startIndex.index,0,X.endIndex.index,d.a.Ug,R);if(X.type===ra.a.cell){Ba=X.row;var Ra=X.col;wa.eF=wa.aK=Ba.kind===da.a.abs;wa.dF=wa.$J=Ra.kind===da.a.abs;return this.r3b(X.span.end,na)&&(wa=ba.Range.Mc(Ba.index+1,Ra.index+1),wa=this.gridView.tb.N7e(wa))?xa.n(wa,R):this.createRange(Ba.index,Ra.index,Ba.index,Ra.index,
R)}if(X.type===ra.a.range){Ba=X.top;Ra=X.left;na=X.bottom;X=X.right;const qa=Math.min(Ba.index,na.index),La=Math.min(Ra.index,X.index),Yb=Math.max(Ba.index,na.index),mc=Math.max(Ra.index,X.index);wa.eF=Ba.kind===da.a.abs;wa.aK=na.kind===da.a.abs;wa.dF=Ra.kind===da.a.abs;wa.$J=X.kind===da.a.abs;return this.createRange(qa,La,Yb,mc,R)}b.ULS.sendTraceTag(537170010,0,10,`CalcManager.CovertFormulaRefToRange: Unsupported formula ref type '${X.type}'`);return null}b.ULS.sendTraceTag(537170011,0,15,"CalcManager.CovertFormulaRefToRange: traverseFormulaRef.Type is null");
return null}r3b(X,R){return R.length>=X&&0<X&&R.charAt(X-1)===Y.KNf}m0g(X,R,wa){this.cu&&this.cu.r0g(X,R,wa)}$cc(X){return this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.rya&&this.instantaneousSupportInformationManager.rya[X]&&this.jB?this.instantaneousSupportInformationManager.rya[X]:null}toXLNumber(X){if(!this.jB)return null;X=excelOnlineCalc.numfmt.toXLNumber(this.config.mathpack,this.jB,X);return excelOnlineCalc.util.isSuccess(X)?X.value:null}F1j(X,R){if(X)for(const wa of X)wa.ref.type&&
wa.ref.type===ra.a.cell&&(X=wa.ref,ca.G7i(X,R)&&(X.span.end+=1,wa.span.end+=1))}createRange(X,R,wa,na,Ba){const Ra={};Ra.FirstRow=X;Ra.FirstColumn=R;Ra.LastRow=wa;Ra.LastColumn=na;Ra.SheetName=Ba;return Ra}jph(X,R,wa){var na=X.ref.qualifier;if(!na)return!0;switch(X.ref.qualifier.type){case ea.sheet:return X=na.document,x.a.equals(na.sheet,R,!0)&&(!X||x.a.equals(X.document,wa,!0));case ea.sheetRange:return R=this.$.va.getItemByName(R),wa=this.$.va.getItemByName(na.sheet1),na=this.$.va.getItemByName(na.sheet2),
!!R&&!!wa&&!!na&&(wa.index<=R.index&&R.index<=na.index||na.index<=R.index&&R.index<=wa.index);case ea.document:return x.a.equals(na.document,wa,!0);case ea.iei:return na=na.name,x.a.equals(na,R,!0)||x.a.equals(na,wa,!0);default:return b.ULS.sendTraceTag(537170009,0,10,`CalcManager.GetQualifierData: Unsupported formula qualifier type '${na.type}'`),!1}}QWj(X){this.instantaneousSupportInformationManager=X;X.rya.length&&X.nja.length?(this.oIc=new N.CalcHelper(this.gridView.$),this.IHb=this.Nr.createParser(),
this.ofe=this.Nr.createNumberFormatter(),this.khc=!0,b.ULS.sendTraceTag(537170007,0,50,"CalcManager.TryInitializeInternal: calc initialized"),this.cu||(b.ULS.sendTraceTag(537170006,0,50,"CalcManager creating calc engine"),this.cu=new L(this.$))):b.ULS.sendTraceTag(537170008,0,15,`CalcManager.TryInitializeInternal: IInstantaneousSupportInformationManager locale information missing, cannot initialize calc. number formats count = ${X.rya.length}, functions info count = ${X.nja.length}`)}Bwb(X){if(!X)return{returnValue:null,
emptyCell:!1};var R=this.getSheetName(X.sheet.index);if(!R)return b.ULS.sendTraceTag(537169998,0,50,`CalcManager.GetCellFromBlockCache: No sheet index ${X.sheet.index}`),{returnValue:null,emptyCell:!1};const wa=ca.convertToRange(X);R=this.gridView.Bwb(R,wa.top,wa.left);return R?R.fph?{returnValue:R,emptyCell:!1}:(b.ULS.sendTraceTag(537169996,0,50,`CalcManager.GetCellFromBlockCache: cell ${X.range.row} ${X.range.col} is empty`),{returnValue:null,emptyCell:!0}):(b.ULS.sendTraceTag(537169997,0,50,`CalcManager.GetCellFromBlockCache: cellProxy is null for cell ${X.range.row} ${X.range.col}`),
{returnValue:null,emptyCell:!1})}getSheetName(X){const R=this.gridView.$.va.getItem(X);return R?R.sheetName:(b.ULS.sendTraceTag(537169995,0,50,`CalcManager.GetSheetName - no sheet in index ${X}`),null)}Agh(X,R){const wa={allowUnqualifiedCell:!0,wrapCellReferences:!0};wa.config=this.Nr.config;wa.originGridCell=excelOnlineCalc.util.success(X);wa.originSheet=excelOnlineCalc.util.success(R);return wa}zgh(){const X={};X.config=this.Nr.config;X.getNameLoc=this.cu.getNameLoc;X.getContainingTable=this.cu.getContainingTable;
X.getStructRefColumn=this.cu.getStructRefColumn;X.getStructRefSpecialRef=this.cu.getStructRefSpecialRef;X.getDocumentLoc=this.cu.getDocumentLoc;X.getSheetIndex=this.cu.getSheetIndex;X.getSheetName=this.cu.getSheetName;X.getUserDefinedFuncLoc=this.cu.getUserDefinedFuncLoc;X.getSheetRangeIndexes=this.cu.getSheetRangeIndexes;return X}static G7i(X,R){return R.length>X.span.end&&R.charAt(X.span.end)===Y.KNf}static convertToRange(X){return ba.Range.Mc(X.range.row+1,X.range.col+1)}};ka.AOe="ECRC";ka=ca=
Object(f.b)([Object(ua.d)(Fa.b),Object(f.c)(0,Object(Fa.f)()),Object(f.c)(1,Object(Fa.g)())],ka);Object(c.a)(ka,"CalcManager",Da.a,[367,2]);var Ca=a(37),fb=a(51);class yb extends e.a{constructor(X){super();this.$=X;this.Db()}create(){if(this.$){b.ULS.sendTraceTag(537169993,0,50,"CalcManagerFactory.Create: Start loading script");if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:5543503_loadCalcCurrentVersion")){var X=76;var R="Current"}else X=79,R="Stable";b.ULS.sendTraceTag(537169992,0,50,`CalcManagerFactory.Create: Calc ${R} JS was loaded`);
Ca.TaskExtensions.za(fb.a.loadScript(X,4,this.Xa,void 0,void 0,265),()=>{b.ULS.sendTraceTag(537169991,0,50,"CalcManagerFactory.Create: Raised create service event");let wa=this.$.da.Aa(266,!1);wa||(b.ULS.sendTraceTag(537169990,0,50,"CalcManagerFactory.Create: CalcManager is not registered, creating new CalcManager"),wa=new ka(this.$),this.$.da.Ha(266,wa));this.nb(wa)},this.la,3)}else b.ULS.sendTraceTag(537169994,0,50,"CalcManagerFactory.Create: ewaControl is null, cann't create the service")}static ka(X){X&&
X.da&&X.da.Ha(265,new yb(X))}}Object(c.a)(yb,"CalcManagerFactory",e.a,[]);var mb=a(9);a.d(F,"a",function(){return nb});const nb=()=>{mb.a.Fa(X=>{y.EwaSettings.dK()||yb.ka(X)})};String(r);window.___1676210802141_closurehack=r},1231:function(r,F,a){var c=a(9);r=a(0);var b=a(15),e=a(226),f=a(89),d=a(4),h=a(192),l=a(8),k=a(38),t=a(889),n=a(229),z=a(60),w=a(888);class m extends Sys.EventArgs{constructor(){super()}}Object(r.a)(m,"NumberFormatsUpdatedEventArgs",Sys.EventArgs,[]);var u=a(48),y=a(44);a(35);
var v=a(29),C=a(1),x=a(618);a(22);var B=a(282),H=a(21);a(177);class I{constructor(N){this.data=N}}Object(r.a)(I,"NumberFormatDataHolder",null,[]);var U=a(179);class S extends k.a{constructor(N,M){super();this.jvd=l.a.oe;this.K0c=null;this.Xgb=this.Skc=!1;this.mzf=(L,aa)=>{var V;(L=H.h(this.$))&&(aa=null!==(V=null===aa||void 0===aa?void 0:aa.cell)&&void 0!==V?V:L.Pb(null))&&this.NBa(aa.cell.hj,!0)};this.dTi=L=>{this.isActive()&&(v.a.qq(L.Errors)||!L.Result?(L=L.Errors?L.Errors.map(aa=>JSON.stringify(aa)).join(","):
"None",b.ULS.sendTraceTag(537155726,0,50,`GetCategoryFromServer failed, ignoring - server errors: ${L}`)):(L=L.Result,b.ULS.sendTraceTag(537155725,0,50,`Updating number format category cache, format index = ${L.Index}, category = ${L.Category}`),this.rAj(L.Index,L.Category),this.raiseEvent(S.E1c,new t.a(L.Index,L.Category),this)))};this.refresh=()=>{b.ULS.sendTraceTag(537155722,0,50,"InstantaneousSupportInformationManager.Refresh: start refresh");this.c3b();this.isActive()&&this.ea.$b.allowEdits&&
(this.Xgb||this.vn&&!(this.ea.kDb>this.jvd)?this.zFc():(b.ULS.sendTraceTag(537155721,0,50,"InstantaneousSupportInformationManager.Refresh: getting instantaneous support information."),this.phd=w.a(this.$.oa.xa,this.vn?this.vn.Digest:"",this.MTi,this.LTi,null,null)),b.ULS.sendTraceTag(537155720,0,50,"InstantaneousSupportInformationManager.Refresh: getting functions info."),this.s3e())};this.EDf=L=>{b.ULS.sendTraceTag(537155716,0,50,`InstantaneousSupportInformationManager.OnGetFunctionListFailed failed, status = ${L.data.status}, HTTP status = ${L.data.httpStatus}.`);
this.BKa=null};this.z_=()=>{this.Xgb=!1;this.ea.uB(this.z_);this.wRa(this.Skc?S.vTd:S.$Ad)};this.Rc=(L,aa)=>{b.ULS.sendTraceTag(537155715,0,50,"InstantaneousSupportInformationManager.OnSessionIdChanged called");n.a(aa)&&this.wRa(S.vTd)};this.tf=()=>{b.ULS.sendTraceTag(537155714,0,50,"InstantaneousSupportInformationManager.OnWorkbookMetadataChanged called");3!==this.$.workbookContext.CalcMode&&this.mBd(0===this.$.workbookContext.CalcMode)};this.dd=()=>{b.ULS.sendTraceTag(537155713,0,50,"InstantaneousSupportInformationManager.OnWorkbookOpened called");
this.wRa(S.vTd);C.EwaSettings.ra(269)&&3!==this.$.workbookContext.CalcMode&&this.mBd(0===this.$.workbookContext.CalcMode)};this.ETi=(L,aa,V)=>{b.ULS.sendTraceTag(537155712,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess called.");this.BKa=null;this.isActive()?L.StateId===l.a.oe?(b.ULS.sendTraceTag(537155682,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: no session, waiting for session."),this.zFc()):!L.Result||this.zX&&this.zX.length?this.wRa(S.$Ad):this.iHf(L,
aa,V):b.ULS.sendTraceTag(537155683,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: manager is inactive, skipping.")};this.iHf=L=>{this.zX=L.Result;b.ULS.sendTraceTag(537155681,0,50,`InstantaneousSupportInformationManager.OnGetFunctionListSuccess refreshing functions info list, returned ${this.zX?this.zX.length:-1} functions.`);L=!1;if(this.zX){for(const aa of this.zX)aa&&(this.$Ze[aa.NameUI.toLocaleUpperCase()]=aa.FunctionIndex.toString(),aa.NameUI!==aa.NameDataStrings&&(this.$Ze[aa.NameDataStrings.toLocaleUpperCase()]=
aa.FunctionIndex.toString(),L=!0),this.iLh.ia(aa.FunctionIndex,aa.NameUI));this.raiseEvent(S.oed,Sys.EventArgs.Empty,this)}L&&b.ULS.sendTraceTag(537155680,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess NameDataStrings functions names were used.")};this.MTi=L=>{if(this.isActive())if(b.ULS.shipAssertTag(537155679,0,!!this.$,"null ewaControl"),this.Skc=!1,this.jvd=L.StateId,this.jvd===l.a.oe)this.Skc=!0,this.zFc();else{if(L.Result){var aa=this.vn;this.vn=L.Result;b.ULS.sendTraceTag(537155678,
0,50,`InstantaneousSupportInformation updated, new result digest: ${this.vn.Digest}.`);L=[];if(aa)L=S.YYh(aa.NumberFormats,this.vn.NumberFormats);else for(aa=0;aa<this.vn.NumberFormats.length;aa++)this.joc.ia(aa,this.vn.NumberFormats[aa].NumberFormatCategory);for(const V of L)this.joc.ia(V,this.vn.NumberFormats[V].NumberFormatCategory);this.raiseEvent(S.IBd,new m(L),this);C.EwaSettings.isChangeGateEnabled("OfficeVSO:7299165_StructuredReferencesInRangePicker")&&this.raiseEvent(S.hrf)}this.wRa(S.$Ad)}};
this.LTi=L=>{this.isActive()&&(10===L.data.status?b.ULS.sendTraceTag(537155677,0,50,"Instantaneous support information request cancelled."):(b.ULS.sendTraceTag(21311555,0,10,`Failed to update instantaneous support information, status = ${L.data.status}, HTTP status = ${L.data.httpStatus}.`),this.Skc=!0,this.zFc()))};b.ULS.sendTraceTag(537155737,0,50,"InstantaneousSupportInformationManager ctor start");this.ea=N;this.$=M;this.vn=this.BKa=this.phd=this.iJb=null;this.joc=new U.a;this.Awb=new U.a;this.zX=
[];this.iLh=new U.a;this.$Ze={};this.ea.Jj(this.Rc);this.$.Lk(this.dd);H.h(this.$).ha.Mga(this.mzf);C.EwaSettings.ra(269)&&this.ea.$t(this.tf);this.wRa(S.Qdf);b.ULS.sendTraceTag(537155736,0,50,"InstantaneousSupportInformationManager ctor end")}ire(N){this.addHandler(S.IBd,N)}fMd(N){this.removeHandler(S.IBd,N)}aMg(N){this.addHandler(S.E1c,N)}ojj(N){this.removeHandler(S.E1c,N)}Nqe(N){this.addHandler(S.oed,N)}WLd(N){this.removeHandler(S.oed,N)}ENg(N){this.addHandler(S.hrf,N)}get Ie(){return this.vn?
this.vn.LocaleInformation:null}get rya(){return this.vn?this.vn.NumberFormats:[]}get nja(){this.zX&&this.zX.length||this.s3e();return this.zX}get Eji(){return this.vn&&void 0!==this.vn.InstantaneousCalcWebWorkerPrecisionSamplingRate&&null!==this.vn.InstantaneousCalcWebWorkerPrecisionSamplingRate?this.vn.InstantaneousCalcWebWorkerPrecisionSamplingRate:S.kkh}get Hji(){return this.vn&&void 0!==this.vn.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate&&null!==this.vn.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate?
this.vn.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate:S.okh}get Gji(){return this.vn&&void 0!==this.vn.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate&&null!==this.vn.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate?this.vn.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate:S.nkh}get Fji(){return this.vn&&void 0!==this.vn.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate&&null!==this.vn.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate?this.vn.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate:
S.mkh}get Cff(){return this.vn?this.vn.InstantaneousCalcWebWorkerRenderingTimeLimitInMs:S.lkh}get zod(){return null!==this.K0c?this.K0c:this.vn?this.vn.InstantaneousCalcManualMode:!1}HWj(N){let M;if(!N)return{returnValue:!0,category:"General"};M="";if(!({category:N}=this.NBa(N,!1)).returnValue)return{returnValue:!1,category:M};M=this.J$g(N);return{returnValue:!0,category:M}}J$g(N){let M="";switch(N){case 0:M="General";break;case 1:M="Number";break;case 2:M="Currency";break;case 3:M="Accounting";break;
case 4:M="Date";break;case 5:M="Time";break;case 6:M="Percentage";break;case 7:M="Fraction";break;case 8:M="Scientific";break;case 9:M="Text";break;case 10:M="Special";break;case 11:M="Custom"}return M}NBa(N,M){let L,aa=({value:L}=this.joc.Fc(N,0)).returnValue;!aa&&0<N&&this.$&&(b.ULS.sendTraceTag(537155735,0,50,`InstantaneousSupportInformationManager.TryGetNumberFormatCategory: failed to get category from numberFormatIndexToCategoryCache ${N}`),this.OQh(N),M&&(L=this.NQh(N),aa=!0),x.a(N,this.$.WF)&&
(L=6));return{returnValue:aa,category:L}}spi(N){let M=0;if(({category:M}=this.NBa(N,!0)).returnValue)return 6===M;b.ULS.sendTraceTag(537155733,0,50,`InstantaneousSupportInformationManager.IsFormatInPercentageCategory: failed to get category from format index ${N}`);return!1}IJh(N){b.ULS.sendTraceTag(537155730,0,50,"InstantaneousSupportInformationManager.ForceRefreshFunctionInfo: Forcing refresh of functions");this.BKa=z.o(this.$.oa.xa,{FilterType:0},B.b(this.iHf,N),this.EDf,null,null,null)}vZe(){this.wRa(S.Qdf)}mBd(N){this.K0c=
N}OQh(N){if(this.Awb&&this.$){var M;if(!({value:M}=this.Awb.Fc(N)).returnValue||M.isCompleted)b.ULS.sendTraceTag(537155728,0,50,`Getting number format category for format index: ${N}`),(M=w.c(this.$.oa.xa,N,this.dTi,null,null,null))&&this.Awb.ia(N,M)}else b.ULS.sendTraceTag(537155729,0,15,"GetCategoryFromServerAsync called on disposed InstantaneousSupportInformationManager instance, skipping")}NQh(N){return 1<=N&&8>=N?1:9<=N&&12>=N?2:13===N||14===N?6:15===N?8:17===N|18===N?7:19===N?4:16===N||20<=
N&&29>=N||31===N?11:30===N?9:32<=N&&35>=N?3:0}isActive(){const N=void 0===this.ea||null===this.ea,M=!N&&this.ea.Xb;b.ULS.sendTraceTag(537155727,0,50,`InstantaneousSupportInformationManager.IsActive: instantaneous support information manager active:${M} - sessionStateManager IsNullOrUndefined: ${N}`);return M}rAj(N,M){this.joc.ia(N,M)}dispose(){f.a.Ja(this.iJb);this.iJb=null;this.c3b();for(let N of this.Awb){const M=N.value;M&&!M.isCompleted&&d.AFrameworkApplication.Bd.Nt(M.Rs)}this.Awb=null;this.ea&&
(this.ea.ik(this.Rc),this.Xgb&&this.ea.uB(this.z_),this.Xgb=!1,this.ea.Av(this.tf));this.ea=null;this.$&&H.h(this.$)&&H.h(this.$).ha&&(H.h(this.$).ha.Zma(this.mzf),this.$.pl(this.dd));this.$=null;super.dispose()}isFeatureEnabled(N){try{switch(N){case "LocaleLongDateFormat":return C.EwaSettings.ra(184);case "GetLocaleDayNames":return C.EwaSettings.ra(185);case "CalculateTextWidthIgnoreLetterSpacing":return C.EwaSettings.ra(255);case "OfficeVSO:3657744_CalcFixForDateFormat":return C.EwaSettings.isChangeGateEnabled("OfficeVSO:3657744_CalcFixForDateFormat");
case "OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero":return C.EwaSettings.isChangeGateEnabled("OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero");case "CalcAutocompleteExperiment":return C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",!1);case "CalcWebWorker":return!0;case "CalcPreventSpillingHack":return C.EwaSettings.isChangeGateEnabled("OfficeVSO:7504597_calcPreventSpillingHack");case "CalcDynamicArrayOperators":return C.EwaSettings.ra(101);
default:return N.startsWith("OfficeVSO:")?C.EwaSettings.isChangeGateEnabled(N):!1}}catch(M){return b.ULS.sendTraceTag(537155724,0,15,`InstantaneousSupportInformation.IsFeatureEnabled(${N}): feature parsing failed, returning false. Exception: ${M.toString()}.`),!1}}wRa(N){this.isActive()&&this.ea.$b.allowEdits?(f.a.Ja(this.iJb),this.iJb=null,this.iJb=u.a.instance.create(this.refresh,N,y.a.Iji)):b.ULS.sendTraceTag(537155723,0,50,`InstantaneousSupportInformationManager.ScheduleRefresh: won't schedule refresh. Edit permission: AllowEdits ${void 0!==
this.ea&&null!==this.ea&&void 0!==this.ea.$b&&null!==this.ea.$b?this.ea.$b.allowEdits:!1}, IsEditMode ${void 0===this.ea||null===this.ea?!1:this.$.ea.isEditMode}`)}s3e(){b.ULS.sendTraceTag(537155719,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync called.");this.BKa?b.ULS.sendTraceTag(537155718,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync already running, skipping."):this.isActive()?this.zX&&this.zX.length||(this.BKa=z.o(this.$.oa.xa,{FilterType:0},this.ETi,
this.EDf,null,null,null)):b.ULS.sendTraceTag(537155717,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync session is not yet active, skipping.")}zFc(){this.Xgb||(this.Xgb=!0,this.ea.oA(this.z_))}c3b(){this.Nt(this.phd);this.Nt(this.BKa);this.BKa=this.phd=null}Nt(N){N&&!N.isCompleted&&this.$.oa.xa.Zfb(N.Rs)}static YYh(N,M){if(!N||!N.length)return[];if(!M||!M.length){M=Array(N.length);for(var L=0;L<N.length;++L)M[L]=N[L].IfmtIndex;return M}L=new U.a;for(const aa of N)L.ia(aa.IfmtIndex,
new I(aa));N=new h.a;for(const aa of M){let V;({value:V}=L.Fc(aa.IfmtIndex)).returnValue&&V.data.FormatString===aa.FormatString||N.add(aa.IfmtIndex)}return N.toArray()}}S.IBd="isim0";S.E1c="isim1";S.oed="isim2";S.hrf="isim3";S.Qdf=100;S.vTd=1E3;S.$Ad=3E5;S.kkh=.001;S.okh=.1;S.nkh=.2;S.mkh=.001;S.lkh=50;Object(r.a)(S,"InstantaneousSupportInformationManager",k.a,[277,2]);var G=a(712);class D extends e.a{constructor(N){super();this.$=N;this.Db()}create(){if(this.$){b.ULS.sendTraceTag(537155672,0,50,
"InstantaneousSupportInformationManagerFactory.Create: Start loading script");var N=Object(G.a)(this.$.da,268,()=>new S(this.$.ea,this.$));this.nb(N)}}static ka(N){if(!N)throw Error.argumentNull("ewaControl");N.da.Ha(246,new D(N))}}Object(r.a)(D,"InstantaneousSupportInformationManagerFactory",e.a,[]);a.d(F,"a",function(){return E});const E=()=>{c.a.Fa(D.ka)}},1247:function(r,F,a){function c(V){if(V){var P=new t(V.IsRangeRef);P.eF=V.IsAbsoluteFirstRow;P.dF=V.IsAbsoluteFirstColumn;P.aK=V.IsAbsoluteSecondRow;
P.$J=V.IsAbsoluteSecondColumn;return P}}function b(V){var P;if(V){var ba=new t(0===V.kind);V=null===(P=null===V||void 0===V?void 0:V.rangeInfo)||void 0===P?void 0:P.positionKindInfo;if(!V)return ba;ba.eF=0===V.firstRow;ba.dF=0===V.firstColumn;ba.aK=0===V.secondRow;ba.$J=0===V.secondColumn;return ba}}r=a(0);var e=a(226),f=a(7),d=a(15),h=a(84),l=a(5),k=a(323);class t{constructor(V){this.$J=this.aK=this.dF=this.eF=!1;this.TZ=V}}Object(r.a)(t,"MarqueeRangeData",null,[]);class n{constructor(V,P,ba,Y=!1){this.qYd=
V;this.WOb=P;this.C7a=Y;ba?(this.TZ=ba.TZ,this.eF=ba.eF,this.dF=ba.dF,this.aK=ba.aK,this.$J=ba.$J):d.ULS.shipAssertTag(524039642,0,!1,"MarqueeMetadata.Ctor: rangeData is null")}}Object(r.a)(n,"MarqueeMetadata",null,[]);var z=a(41),w=a(141),m=a(35),u=a(1),y=a(22),v=a(580),C=a(21),x=a(177),B=a(345),H=a(33),I=a(740),U=a(891);const S="rgba(95, 140, 237, {0});rgba(235, 94, 96, {0});rgba(141, 97, 194, {0});rgba(45, 150, 57, {0});rgba(191, 76, 145, {0});rgba(227, 130, 34, {0});rgba(55, 127, 158, {0})".split(";");
class G{constructor(V,P){this.ZJ=this.ifb=this.Osf=!1;this.y8=null;this.XMa=u.EwaSettings.XMa();this.xya=()=>{this.ZJ=!1};this.Pc=V;this.gridView=C.h(V);this.calcManager=P;this.xgf=u.EwaSettings.ra(595);this.tH=H.a.tH(V);this.gridView.Vb.Km(this.xya)}get formulaAssistanceManager(){this.y8||(this.y8=this.Pc.da.Aa(464));return this.y8}get formulaAssistanceTelemetryManager(){this.MDa||(this.MDa=this.Pc.da.Aa(491));return this.MDa}KD(V,P){V.textBox.addEventLogRecord("ColoredReferencesManager.TryUpdateColoredReferences");
if(this.ifb||V.fF)return!1;const ba=void 0===P||null===P?V.text:P;if(this.calcManager&&1<ba.length&&x.f(ba)){var Y=this.Jja(),Z=this.I5e(),ea=this.Pc.workbookContext.WorkbookFileName;let ra=!1;const O=.01>Math.random()?Object(h.a)(w.a,this.Pc.Jb.Gc("LoadingUIShown","ColoredReferencesManager")):null;try{const da=this.calcManager.extractReferences(ba,Z,ea,!this.xgf);if(!da)return d.ULS.sendTraceTag(524039689,0,50,"ColoredReferencesManager.UpdateColoredReferences: extractReferences is null (might be an invalid formula)"),
!1;Z=[];ea=[];const xa=[],ia=[];let Ma=0,Ta=0;const Da=new m.a(!1);let fa="";for(const Fa of da.Items)if(ra=Fa.IsStructRef||ra,Fa.IsBoolean||Fa.IsNumber||Fa.IsString){const ca=Fa.IsBoolean?"rgba(0, 0, 255, 1)":Fa.IsNumber?"rgba(9, 134, 88, 1)":"rgba(163, 21, 21, 1)";this.hE(ea,ba,Ma,Fa.Span.Start,null);this.hE(ea,ba,Fa.Span.Start,Fa.Span.End,ca);Ma=Fa.Span.End}else if(u.EwaSettings.ra(512)){if(Fa.Range||Fa.LetName&&0<=Fa.LetNumber){let ca=null;if(Fa.Range){let Ca=z.D(Fa.Range);ca=this.nZ(Ca,Da,1);
Z.push(new B.a(Ca,Y))}else Fa.LetName&&0<=Fa.LetNumber&&(ca=fa=this.BRh(Fa.LetName,Fa.LetNumber,Da,fa),Ta!==Da.count&&V.colors.add(Fa.Span.Start+"-"+Fa.Span.End,S[(Da.count-1)%S.length]));this.hE(ea,ba,Ma,Fa.Span.Start,null);this.hE(ea,ba,Fa.Span.Start,Fa.Span.End,ca);Ma=Fa.Span.End;xa.push(Fa.Span);let ka=ea.length-1;ia.push(new n(ka,ea[ka].text,c(Fa)));Ta=Da.count}}else if(Fa.Range){let ca=z.D(Fa.Range),ka=this.nZ(ca,Da,1);this.hE(ea,ba,Ma,Fa.Span.Start,null);this.hE(ea,ba,Fa.Span.Start,Fa.Span.End,
ka);Z.push(new B.a(ca,Y));Ma=Fa.Span.End;xa.push(Fa.Span);let Ca=ea.length-1;ia.push(new n(Ca,ea[Ca].text,c(Fa)))}this.formulaAssistanceTelemetryManager?0<da.Items.length&&this.formulaAssistanceTelemetryManager.Xac.formulaHighlightsCounter++:this.fmc("ColoredReferencesManager.tryUpdateColoredReferences: FormulaAssistanceTelemetryManager unavailable");this.hE(ea,ba,Ma,ba.length,null);this.Iyc(V,ea,!!P);const ua=V.textBox.text;if(!y.a.equals(ua,ba,!1)){d.ULS.shipAssertTag(38114182,0,!1,`ColoredReferencesManager.UpdateColoredReferences: The text we created is different from the original text. Setting the original text back. currentTextLength [${ua.length}], originalTextLength [${ba.length}]`);
let Fa=V.textBox.caretPosition;V.textBox.text=ba;V.textBox.caretPosition=Fa;return!0}this.cz(Z,Da,ia);u.EwaSettings.ra(512)&&0<Z.length&&d.ULS.sendTraceTag(524039688,0,50,"ColoredReferencesManager.UpdateColoredReferences: Cell reference(s) colored");u.EwaSettings.ra(512)&&0<V.colors.count&&d.ULS.sendTraceTag(524039687,0,50,"ColoredReferencesManager.UpdateColoredReferences: Let name(s) colored");return this.ZJ=!0}finally{O&&O.gBa(()=>{ra&&d.ULS.sendTraceTag(524039686,0,50,`ColoredReferencesManager.UpdateColoredReferences: Formula with structured reference is highlighted in ${O.Bc} ms`)})}}else return this.cz(null,
null),this.ZJ&&(this.ZJ=!1,this.XMa||(Y=V.textBox.caretPosition,V.textBox.setPlainText(ba),V.textBox.caretPosition=Math.min(Y,ba.length)),P)?!0:!1}bgb(V,P,ba){if(this.ifb||V.fF)return!1;const Y=isNullOrUndefined(P)?V.text:P;var Z=[];const ea=new m.a(!1);if(1<Y.length&&Object(I.b)(ba)){const O=[],da=[],xa=[];var ra=0;const ia=this.Jja();for(const Ma of ba.formulaHighlights){this.hE(O,Y,ra,Ma.span.start,null);switch(Ma.kind){case 0:case 1:case 2:ba=z.B(Ma.rangeInfo.sharedRange);if(isNullOrUndefined(ba)){d.ULS.sendTraceTag(521211937,
0,10,`ColoredReferencesManager.tryUpdateFormulaHighlights: Received formula highlight with undefined range, HighlightKind:${Ma.kind.toString()},`);this.hE(O,Y,Ma.span.start,Ma.span.end,null);break}ra=this.nZ(ba,ea,1);this.hE(O,Y,Ma.span.start,Ma.span.end,ra);Z.push(new B.a(ba,ia));da.push({Start:Ma.span.start,End:Ma.span.end});ba=O.length-1;xa.push(new n(ba,O[ba].text,b(Ma)));break;case 3:this.hE(O,Y,Ma.span.start,Ma.span.end,null,"rgba(229, 229, 229, 1)")}ra=Ma.span.end}this.hE(O,Y,ra,Y.length);
this.Iyc(V,O,!!P);P=V.textBox.text;if(!y.a.equals(P,Y,!1))return d.ULS.shipAssertTag(521211936,0,!1,`ColoredReferencesManager.UpdateFormulaHighlights: The text we created is different from the original text. Setting the original text back. currentTextLength [${P.length}], originalTextLength [${Y.length}]`),P=V.textBox.caretPosition,V.textBox.text=Y,V.textBox.caretPosition=P,!0;this.cz(Z,ea,xa);return this.ZJ=!0}this.cz(null,null);return this.ZJ&&(this.ZJ=!1,this.XMa||(Z=V.textBox.caretPosition,V.textBox.setPlainText(Y),
V.textBox.caretPosition=Math.min(Z,Y.length)),P)?!0:!1}PEb(V,P,ba){if(!V||!P||!ba)return d.ULS.shipAssertTag(524039685,0,!!V,"ColoredReferencesManager.MoveMarqueeRange: cellContentEditor is null"),d.ULS.shipAssertTag(524039684,0,!!P,"ColoredReferencesManager.MoveMarqueeRange: highlightState is null"),d.ULS.shipAssertTag(524039683,0,!!ba,"ColoredReferencesManager.MoveMarqueeRange: newRange is null"),!1;const Y=Object(h.a)(n,P.metadata);if(!Y)return d.ULS.shipAssertTag(524039682,0,!1,"ColoredReferencesManager.MoveMarqueeRange: marqueeMetadata is null"),
!1;var Z=Y.qYd,ea=Y.WOb,ra=this.gridView.tb.oqd(ba)?ba.Twb(Y.dF,Y.eF):ba.LKa(Y.dF,Y.eF,Y.$J,Y.aK);if(!ra)return d.ULS.shipAssertTag(524039681,0,!1,"ColoredReferencesManager.MoveMarqueeRange: newText is null"),!1;const O=ea.indexOf("!");-1!==O&&(ra=ea.substring(0,O+1)+ra);if(!V.textBox.changeTextInExistingTextPart(Z,ea,ra))return d.ULS.shipAssertTag(38926105,0,!1,"ColoredReferencesManager.MoveMarqueeRange: failed to change the text part"),!1;Y.WOb=ra;Z=!0;for(ea=1;4>=ea;ea++)(ra=C.h(this.Pc).Cb.NC(3,
ea,P.QT))?(ra.range=ba,ra.metadata=Y):(d.ULS.shipAssertTag(524039680,0,!1,"ColoredReferencesManager.MoveMarqueeRange: highlightStateInPane is null"),Z=!1);this.gridView.Cb.update(!1,!1);this.gridView.Ql&&(this.gridView.mc.textBox.text=V.text);this.gridView.mc.cQa(new k.a({IAb:!0}));return Z}$qi(V){if(3!==V.Aq)return d.ULS.shipAssertTag(524039651,0,!1,"ColoredReferencesManager.IsMarqueeHighlightDragable: not HighlightDivIndex.Marquee."),!1;V=Object(h.a)(n,V.metadata);return V?V.TZ&&!V.C7a:(d.ULS.shipAssertTag(524039650,
0,!1,"ColoredReferencesManager.IsMarqueeHighlightDragable: marqueeMetadata is null."),!1)}lBa(V,P){d.ULS.sendTraceTag(524039649,0,50,"ColoredReferencesManager.SuspendResumeColoredReferences: "+(P?"suspending":"resuming")+" colored references");P&&this.ZJ&&(this.ZJ=!1,this.cz(null,null),V.textBox.LCe());this.ifb=P}dispose(){this.gridView&&this.gridView.Vb&&this.gridView.Vb.$l(this.xya)}izb(V){const P=this.formulaAssistanceTelemetryManager;P||this.fmc("ColoredReferencesManager.highlightPreviewRanges: Failed to log highlightPreviewRanges measurement, FormulaAssistanceTelemetryManager unavailable");
null===P||void 0===P?void 0:P.ED(["highlightPreviewRanges"]);this.tH?this.idi(V):this.hdi(V);null===P||void 0===P?void 0:P.gw(["highlightPreviewRanges"],!0)}idi(V){var P=this.formulaAssistanceManager.A4a(V,U.a);if(isNullOrUndefined(P))this.cz(null,null);else{var ba=this.Jja(),Y=[],Z=new m.a(!1),ea=[];P=P.formulaHighlights;for(const ra of P)if(P=ra.kind,0===P||2===P||1===P)P=z.B(ra.rangeInfo.sharedRange),Object(I.b)(P)&&(Y.push(new B.a(P,ba)),this.nZ(P,Z,1),ea.push(new n(ra.span.start,V.substring(ra.span.start,
ra.span.end),b(ra),!0)));this.cz(Y,Z,ea)}}hdi(V){const P=this.Jja();var ba=this.I5e();const Y=this.Pc.workbookContext.WorkbookFileName,Z=[],ea=new m.a(!1),ra=[];if(ba=this.calcManager.extractReferences(V,ba,Y,!this.xgf)){for(const O of ba.Items)O.Range&&(ba=z.D(O.Range),Z.push(new B.a(ba,P)),this.nZ(ba,ea,1),ra.push(new n(O.Span.Start,V.substring(O.Span.Start,O.Span.End),c(O),!0)));this.cz(Z,ea,ra)}else this.cz(null,null)}nZ(V,P,ba){let Y=P.getItem(V.toString());Y||(Y=S[P.count%S.length],P.add(V.toString(),
Y));return String.format(Y,ba)}BRh(V,P,ba,Y){V="["+V+", "+P+"]";P=ba.getItem(V);P||(P=ba.count%S.length,P=S[P],Y===String.format(P,1)&&(ba.add("skip-"+V,P),P=ba.count%S.length,P=S[P]),ba.add(V,P));return String.format(P,1)}hE(V,P,ba,Y,Z=null,ea=null){d.ULS.shipAssertTag(524039648,0,ba<=Y,"ColoredReferencesManager.AddTextPart: startIndex cannot be larger than endIndex");ba<Y&&(P=P.substring(ba,Y),V.push(Object(f.a)(new v.a,{text:P,color:Z,backgroundColor:ea})))}cz(V,P,ba=null){V&&V.length?(d.ULS.sendTraceTag(524039647,
0,50,"ColoredReferencesManager.HighlightRanges: number of ranges to highlight: "+V.length),V.reverse(),ba.reverse(),this.gridView.Cb.zB(V,[3],!0,(Y,Z)=>{if(Y&&Y.range&&Z){d.ULS.shipAssertTag(524039643,0,P.hb(Y.range.toString()),`ColoredReferencesManager.HighlightRanges: The range '${Y.range.toString()}' doesn't exist in the range to color dictionary`);var ea=this.nZ(Y.range,P,.1),ra=this.nZ(Y.range,P,1);this.Pc.frame&&this.Pc.frame.WC&&this.Pc.frame.WC.VM||(Z.style.background=ea);Z.style.borderColor=
ra;ba&&(Z.setAttribute(l.a.c6a,Y.QT.toString()),Y.metadata=ba[Y.QT])}else d.ULS.shipAssertTag(524039646,0,!!Y,"ColoredReferencesManager.HighlightRanges: state is null"),d.ULS.shipAssertTag(524039645,0,!!Y.range,"ColoredReferencesManager.HighlightRanges: state.Range is null"),d.ULS.shipAssertTag(524039644,0,!!Z,"ColoredReferencesManager.HighlightRanges: div is null")})):(V=this.Pc.Jb.Gc("UserAction","HideRangesHighlightsStopwatch"),this.gridView.Cb.Nj([3]),this.gridView.Cb.$Ra(new B.a(null,this.Jja()),
[3]),V.stop())}Iyc(V,P,ba){const Y=V.textBox;Y.ZE=!0;var Z=Y.selection;const ea=Z.index;Z=ea+Z.length;Y.setTextFromTextParts(P);P=Y.text.length;Y.selectRange(Math.min(ea,P),Math.min(Z,P));ba&&V.cQa(new k.a);Y.ZE=!1}fmc(V){this.Osf||(d.ULS.sendTraceTag(521211935,0,50,V),this.Osf=!0)}Jja(){return this.ddc().sheetId}I5e(){return this.ddc().sheetName}ddc(){return this.gridView.Jq&&this.gridView.Jq.sF?this.gridView.Jq.sF:this.Pc.na}}Object(r.a)(G,"ColoredReferencesManager",null,[373,2]);var D=a(187),E=
a(105),N=a(712);class M extends e.a{constructor(V){super();this.$=V;this.Db()}create(){u.EwaSettings.dK()?void D.a.resolve(E.b,{Tl:this.Xa}).then(V=>{const P=Object(N.a)(this.$.da,281,()=>new G(this.$,V));this.nb(P)}):this.$.da.gb(266,V=>{V=u.EwaSettings.cl()||u.EwaSettings.isChangeGateEnabled("OfficeVSO:6143820_MoveServiceRegistrationFromFAM_V2")?this.$.da.Aa(281)||this.$.da.Ha(281,new G(this.$,V)):new G(this.$,V);this.nb(V)})}static ka(V){V.da.Ha(282,new M(V))}}Object(r.a)(M,"ColoredReferencesManagerFactory",
e.a,[]);var L=a(9);a.d(F,"a",function(){return aa});const aa=()=>{L.a.Fa(M.ka)}},1294:function(r,F,a){r=a(0);var c=a(226),b=a(823),e=a(1),f=a(187),d=a(105);class h extends c.a{constructor(t){super();this.$=t;this.Db()}create(){(e.EwaSettings.dK()?t=>f.a.resolve(d.b).then(n=>setTimeout(()=>t(n),0)):t=>this.$.da.gb(266,t))(t=>{t=this.$.da.Aa(294)||this.$.da.Ha(294,new b.RelativeAndAbsoluteReferencesManager(t));this.nb(t)})}static ka(t){t.da.Ha(295,new h(t))}}Object(r.a)(h,"RelativeAndAbsoluteReferencesManagerFactory",
c.a,[]);var l=a(9);a.d(F,"a",function(){return k});const k=()=>{l.a.Fa(h.ka)}},1421:function(r,F,a){a.r(F);r=a(1231);F=a(1184);var c=a(1247);a=a(1294);Type.registerNamespace("_Ewa");Object(r.a)();Object(F.a)();Object(c.a)();Object(a.a)()},803:function(r,F,a){a.d(F,"a",function(){return c});r=a(0);class c{}c.abs="Abs";c.rel="Rel";Object(r.a)(c,"PositionBaseType",null,[])},823:function(r,F,a){a.r(F);r=a(0);var c=a(7),b=a(15);class e{}Object(r.a)(e,"Reference",null,[]);class f extends e{constructor(){super();
this.column=this.row=null}}Object(r.a)(f,"CellReference",e,[]);class d{constructor(){this.end=this.start=0;this.xr=null}uSg(B,H){for(let I=0;I<this.xr.length;I++){const U=this.a1b(B,this.xr[I]);H+=U;I<this.xr.length-1&&(H+=":")}return H}}Object(r.a)(d,"IReferenceSequence",null,[]);var h=a(24),l=a(803);class k extends d{constructor(){super();this.fjc=!1}Xcc(){const {RelativeAndAbsoluteReferencesManager:B}=a(823),H=this.xr[0];return B.Cxf(H.row.kind===l.a.abs,H.column.kind===l.a.abs)}a1b(B,H){H=h.Range.Mc(H.row.index+
1,H.column.index+1);return this.fjc?H.Twb(1===B||3===B,1===B||2===B):H.LKa(1===B||3===B,1===B||2===B,!0,!0)}}Object(r.a)(k,"CellReferenceSequence",d,[]);class t extends e{constructor(){super();this.secondColumn=this.firstColumn=null}}Object(r.a)(t,"ColumnReference",e,[]);class n extends d{constructor(){super()}Xcc(){const B=this.xr[0];return a(823).RelativeAndAbsoluteReferencesManager.bwf(B.firstColumn,B.secondColumn).kind===l.a.abs?2:3}a1b(B,H){return h.Range.Yvb(H.firstColumn.index+1,H.secondColumn.index+
1).LKa(1===B||3===B,!0,1===B||3===B,!0)}}Object(r.a)(n,"ColumnReferenceSequence",d,[]);class z extends e{constructor(){super();this.right=this.left=this.bottom=this.top=null}}Object(r.a)(z,"RangeReference",e,[]);class w extends d{constructor(){super()}Xcc(){const {RelativeAndAbsoluteReferencesManager:B}=a(823),H=this.xr[0];return B.Cxf(H.top.kind===l.a.abs,H.left.kind===l.a.abs)}a1b(B,H){H=new h.Range(H.top.index+1,H.left.index+1,H.bottom.index+1,H.right.index+1,!1,!1);const I=1===B||3===B;B=1===
B||2===B;return H.LKa(I,B,I,B)}}Object(r.a)(w,"RangeReferenceSequence",d,[]);class m extends e{constructor(){super();this.secondRow=this.firstRow=null}}Object(r.a)(m,"RowReference",e,[]);class u extends d{constructor(){super()}Xcc(){const B=this.xr[0];return a(823).RelativeAndAbsoluteReferencesManager.bwf(B.firstRow,B.secondRow).kind===l.a.abs?0:1}a1b(B,H){return h.Range.abc(H.firstRow.index+1,H.secondRow.index+1).LKa(!0,1===B||2===B,!0,1===B||2===B)}}Object(r.a)(u,"RowReferenceSequence",d,[]);var y=
a(1001),v=a(1002),C=a(177);a.d(F,"RelativeAndAbsoluteReferencesManager",function(){return x});class x{constructor(B){this.calcManager=B}B1a(B,H,I){let U,S;U=H;S=I;if(!B||!C.f(B))return{returnValue:B,MAd:U,LAd:S};var G=this.calcManager.MWe(B);if(!G)return b.ULS.sendTraceTag(524039641,0,15,"RelativeAndAbsoluteReferencesManager.CycleThroughRelativeAndAbsoluteReferences: Couldn't extract references (might be invalid formula)"),{returnValue:null,MAd:U,LAd:S};G=this.d3h(G,B,H,I);let D=0,E="",N=0,M=0;for(;M<
G.length;M++)if(this.xNe(G[M],H,I)){D=G[M].Xcc();U=G[M].start;break}for(;M<G.length&&this.xNe(G[M],H,I);M++)E+=B.substring(N,G[M].start),E=G[M].uSg(D,E),N=G[M].end;N&&(S=E.length);E+=B.substring(N,B.length);return{returnValue:E,MAd:U,LAd:S}}d3h(B,H,I,U){const S=[];for(let N=0;N<B.length;N++){var G=B[N];if(G.kind===y.a.range)if(G=G.ref,G.type===v.a.cell){var D=G;G=Object(c.a)(new k,{start:G.span.start,end:G.span.end,xr:[Object(c.a)(new f,{column:D.col,row:D.row})],fjc:this.calcManager.r3b(G.span.end,
H)});S.push(G)}else if(G.type===v.a.range)this.yNe(G.topLeftSpan,I,U)&&this.yNe(G.bottomRightSpan,I,U)?(D=new z,G.top.index<=G.bottom.index?(D.top=G.top,D.bottom=G.bottom):(D.bottom=G.top,D.top=G.bottom),G.left.index<=G.right.index?(D.left=G.left,D.right=G.right):(D.right=G.left,D.left=G.right),G=Object(c.a)(new w,{start:G.topLeftSpan.start,end:G.bottomRightSpan.end,xr:[D]}),S.push(G)):(D=Object(c.a)(new k,{start:G.topLeftSpan.start,end:G.topLeftSpan.end,xr:[Object(c.a)(new f,{column:G.left,row:G.top})],
fjc:this.calcManager.r3b(G.topLeftSpan.end,H)}),G=Object(c.a)(new k,{start:G.bottomRightSpan.start,end:G.bottomRightSpan.end,xr:[Object(c.a)(new f,{column:G.right,row:G.bottom})],fjc:this.calcManager.r3b(G.topLeftSpan.end,H)}),S.push(D),S.push(G));else if(G.type===v.a.column){D=G;for(G=Object(c.a)(new n,{start:G.span.start,end:G.span.end,xr:[Object(c.a)(new t,{firstColumn:D.startIndex,secondColumn:D.endIndex})]});G.end<H.length-1&&":"===H.charAt(G.end)&&N<B.length-1;)if(D=B[N+1].ref,D.type===v.a.column&&
D.span.start===G.end+1){var E=D;G.xr.push(Object(c.a)(new t,{firstColumn:E.startIndex,secondColumn:E.endIndex}));G.end=D.span.end;N++}else break;S.push(G)}else if(G.type===v.a.row){D=G;for(G=Object(c.a)(new u,{start:G.span.start,end:G.span.end,xr:[Object(c.a)(new m,{firstRow:D.startIndex,secondRow:D.endIndex})]});G.end<H.length-1&&":"===H.charAt(G.end)&&N<B.length-1;)if(D=B[N+1].ref,D.type===v.a.row&&D.span.start===G.end+1)E=D,G.xr.push(Object(c.a)(new m,{firstRow:E.startIndex,secondRow:E.endIndex})),
G.end=D.span.end,N++;else break;S.push(G)}}return S}xNe(B,H,I){return!(B.start>I||H>B.end)}yNe(B,H,I){return!(B.start>I||H>B.end)}static bwf(B,H){return B.index<=H.index?B:H}static Cxf(B,H){return H||B?H&&B?2:!H&&B?3:0:1}}Object(r.a)(x,"RelativeAndAbsoluteReferencesManager",null,[285])},955:function(r,F,a){a.r(F);r=a(0);var c=a(15),b=a(268),e;(function(u){u[u.paren=0]="paren";u[u.lead=1]="lead";u[u.intern=2]="intern";u[u.trail=3]="trail";u[u.undefined=4]="undefined"})(e||(e={}));Object(r.b)("CurrencyFormatOption",
e);var f;(function(u){u[u.none=-1]="none";u[u.mdy=0]="mdy";u[u.dmy=1]="dmy";u[u.ymd=2]="ymd";u[u.myd=3]="myd";u[u.dym=4]="dym";u[u.ydm=5]="ydm"})(f||(f={}));Object(r.b)("DateOrderOption",f);var d=a(8);class h{constructor(u,y){({CalcHelper:u}=a(955));y&&(y.Ie||c.ULS.shipAssertTag(537169942,0,!1,"LocaleHolder constructor - locale information is not available"));this.gAg=u.jIe(y,u.WHe(y.nja));this.hAg=excelOnlineCalc.calc.localeInfoFromData(this.localeData)}get localeInfo(){return this.hAg}get localeData(){return this.gAg}formatNumber(u){return this.localeInfo.formatNumber(u)}}
Object(r.a)(h,"LocaleHolder",null,[]);var l=a(999),k=a(51),t=a(1),n=a(22),z=a(13),w=a(175);a.d(F,"CalcHelper",function(){return m});class m{constructor(u){this.$=u;(this.$x=this.$.da.Aa(268))||c.ULS.shipAssertTag(537170070,0,!1,"CalcHelper constructor - IInstantaneousSupportInformationManager is not available");let y;y=t.EwaSettings.isChangeGateEnabled("OfficeVSO:5543503_loadCalcCurrentVersion")?k.a.current.qo(76):k.a.current.qo(79);this.logger=new l.a;this.documentLoc=excelOnlineCalc.location.documentLoc("",
this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.aca=new h(u,this.$x);excelOnlineCalc.config.initCalc(this.logger,this.$x?v=>this.$x.isFeatureEnabled(v):()=>!1,y);this.Oug=excelOnlineCalc.config.calcConfig(this.aca.localeInfo)}get config(){return this.Oug}Kih(){if(t.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")){if(!this.$.va)return c.ULS.shipAssertTag(537170069,0,!1,"CalcHelper.CurrentSheetIndex() - this.ewaControl.Sheets is null"),0;const u=this.$.va.na;
return u?u.index:(c.ULS.shipAssertTag(537170068,0,!1,"CalcHelper.CurrentSheetIndex() - sheet is null"),0)}return this.$.va.na.index}createParser(){const u={};u.config=this.config;return excelOnlineCalc.parse.createParser(u)}createNumberFormatter(){const u=excelOnlineCalc.numfmt.createFormatGlobals(this.config,(y,v)=>excelOnlineCalc.calc.getTime(this.config,y,v,"Estimation"));return excelOnlineCalc.numfmt.createNumberFormatter(u)}Xgh(u,y,v,C){if(!C)return{range:{row:y,col:v},sheet:{document:this.documentLoc,
index:u}};y=excelOnlineCalc.location.gridCell(y,v);u=excelOnlineCalc.location.sheetIndex(this.documentLoc,u);return excelOnlineCalc.location.sheetGridCell(u,y)}Xth(u,y){let v;v=excelOnlineCalc.calc.getEvalResultKind(u);switch(v){case 4:return{returnValue:u?this.aca.localeInfo.trueName:this.aca.localeInfo.falseName,kind:v};case 1:return{returnValue:t.EwaSettings.isChangeGateEnabled("OfficeVSO:3594728_SupportEvaluatingArrayOpersToString")?this.RCc(this.aca.formatNumber(u),y):this.aca.formatNumber(u),
kind:v};case 2:return{returnValue:t.EwaSettings.isChangeGateEnabled("OfficeVSO:3594728_SupportEvaluatingArrayOpersToString")?this.RCc(u.toString(),y):u.toString(),kind:v};case 128:return{returnValue:"",kind:v};case 8:switch(u.type){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:return{returnValue:this.aca.localeInfo.errorNames[u.type],kind:v};default:return{returnValue:m.unknownError,kind:v}}case 32:return{returnValue:t.EwaSettings.isChangeGateEnabled("OfficeVSO:3594728_SupportEvaluatingArrayOpersToString")?
this.RCc(this.mhh(u,y),y):"##UNSUPPORTED: ARRAY",kind:v};default:return{returnValue:z.a.instance.ga(2219),kind:v}}}RCc(u,y){return u.length<=y?u:u.substring(0,y-3)+"..."}mhh(u,y){let v=this.aca.localeInfo.leftBrace;for(let C=0;C<u.rows;++C){for(let x=0;x<u.cols;++x)v+=u.opers[C][x],x<u.cols-1&&(v+=this.aca.localeInfo.columnSeparator);C<u.rows-1&&(v+=this.aca.localeInfo.rowSeparator)}return this.RCc(v,y-1)+this.aca.localeInfo.rightBrace}static jIe(u,y=null){const v=m.V5b(),C=u.Ie.TrueValueString,x=
u.Ie.FalseValueString,B=u.Ie.DecimalSeparator.toString(),H=u.Ie.ListSeparator.toString(),I=u.Ie.ColumnSeparator.toString(),U=u.Ie.RowSeparator.toString(),S=u.Ie.ThousandsDataArray,G=u.Ie.ThousandSeparator.toString(),D=u.Ie.Lcid,E=u.Ie.Country,N=u.Ie.DigitsNumber,M=u.Ie.ExpSeparatedBySpace,L=u.Ie.FractionSeparator.toString(),aa=u.Ie.PercentSeparatedBySpace,V=n.a.Z1g(Enum.toString(e,u.Ie.CurrencyFormat)),P=u.Ie.CurrencySymbolLead,ba=u.Ie.CurrencySeparatedBySpace,Y=u.Ie.CurrencySymbolString,Z=u.Ie.DigitsCurrency,
ea=-1===u.Ie.DateOrder?"MDY":w.e(Enum.toString(f,u.Ie.DateOrder)),ra=u.Ie.DateSeparator.toString(),O=u.Ie.DateAlternativeSeparator.toString(),da=u.Ie.Year4Digits,xa=u.Ie.Month2Digits,ia=u.Ie.Day2Digits,Ma=u.Ie.LongDateFormat,Ta=u.Ie.TimeSeparator.toString(),Da=u.Ie.TimeAltSeparator,fa=u.Ie.Hour2Digits,ua=u.Ie.Use24HourClock,Fa=u.Ie.AmPmSeparatedBySpace,ca=[u.Ie.AmString,u.Ie.PmString],ka=u.Ie.DayNameShortArray,Ca=u.Ie.DayNameLongArray,fb=u.Ie.MonthNameShortArray,yb=u.Ie.MonthNameLongArray,mb=u.Ie.PictureSpecialArray,
nb=b.a.map(("\x00"+u.Ie.PictureSingleString).split(""),mc=>"\x00"===mc?null:mc),X=u.Ie.PictureColorArray,R=u.Ie.PictureDbnumArray,wa=u.Ie.RowLetter.toString(),na=u.Ie.ColumnLetter.toString(),Ba=u.Ie.LeftBrace.toString(),Ra=u.Ie.RightBrace.toString(),qa=u.Ie.LeftBracket.toString(),La=u.Ie.RightBracket.toString(),Yb=m.W3h(u.Ie);return excelOnlineCalc.calc.localeData(y,v,C,x,wa,na,Ba,Ra,qa,La,B,H,I,U,S,G,D,E,N,M,L,aa,V,P,ba,Y,Z,ea,ra,O,da,xa,ia,Ma,Ta,Da,fa,ua,Fa,ca,ka,Ca,fb,yb,mb,nb,X,R,Yb,u.Ie.SysDateFormatString,
u.Ie.SysTimeFormatString)}static WHe(u){const y=[];if(!u)return y;for(const v of u)u=null,v.IsDynamicUdf||(u=excelOnlineCalc.calc.worksheetFunctionName(v.FunctionIndexInServer,v.NameUI)),u&&y.push(u);return y}static V5b(){const u=[],y=Object.keys(d.a.errorNames);for(let v=0;v<y.length;v++){const C=excelOnlineCalc.calc.errorTypeName(v+1,y[v]);C&&u.push(C)}return u}static W3h(u){const y=Array(6);y[1]="#"+u.AllStructRefString;y[3]="#"+u.HeadersStructRefString;y[2]="#"+u.DataStructRefString;y[4]="#"+
u.TotalsStructRefString;y[5]="#"+u.ThisRowStructRefString;return y}}m.unknownError="##ERR##";Object(r.a)(m,"CalcHelper",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.calc.js.map/c997b07ca09b0d0ec27017bfea201d8d/EwaDSEsNext.calc.js.map
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[62],{1472:function(r,F,a){a.r(F);var c=a(0),b=a(512),e=a(47),f=a(9),d=a(51),h=a(89),l=a(55),k=a(84),t=a(226),n=a(422),z=a(37),w=a(7),m=a(15),u=a(86),y=a(83),v=a(227),C=a(14),x=a(110),B=a(4),H=a(88),I=a(151),U=a(122),S=a(429),G=a(96),D=a(747),E=a(5),N=a(127),M=a(376),L=a(193),aa=a(284),V=a(33),P=a(250),ba=a(569),Y=a(12),Z=a(1),ea=a(11),ra=a(13),O=a(21),da=a(128),xa=a(156),ia=a(346),Ma=a(697),Ta=a(553),Da=a(19),fa=
a(555),ua=a(68),Fa;(function(ic){ic[ic.NavigateToPane=24]="NavigateToPane"})(Fa||(Fa={}));Object(c.b)("InsightsActionType",Fa);var ca;(function(ic){ic[ic.Feedback=0]="Feedback"})(ca||(ca={}));Object(c.b)("TargetPane",ca);var ka;(function(ic){ic[ic.Error=0]="Error"})(ka||(ka={}));Object(c.b)("InsightsResponseType",ka);class Ca{constructor(ic){this.$=ic}ngj(){window.addEventListener("message",this.onMessage.bind(this))}sig(){window.removeEventListener("message",this.onMessage.bind(this))}onMessage(ic){if(Ca.Xli(ic.origin)){var cd;
try{(cd=ic.data)&&"string"===typeof cd&&(cd=JSON.parse(cd)),ic.source!==window&&cd&&void 0!==cd.actionType&&this.actionHandler(cd)}catch(Hd){ic.source.postMessage(JSON.stringify({responseType:ka.Error,errorMessage:Hd?Hd.message:void 0}),ic.origin)}}}actionHandler(ic){if(ic)switch(ic.actionType){case Fa.NavigateToPane:this.navigateToPane(ic.data);break;default:throw Error(`unknow action type: ${ic.actionType}`);}}navigateToPane(ic){switch(ic){case ca.Feedback:this.$.Yc(802602464,ua.a.zb,12,{[E.a.wM]:"AnalyzeDataPane"});
break;default:throw Error(`unknow navigate pane: ${ic}`);}}static Xli(ic){return ic&&ic.endsWith("insights.microsoft.com")?!0:!1}}Object(c.a)(Ca,"InsightsTaskPaneListener",null,[]);const fb=Da.a.Bad;class yb extends G.a{constructor(ic,cd,Hd,he){super(ic);this.Ise='<div id="AgaveTaskPaneHeaderId"><span class="{0}" id="{1}"></span></div><div id="{2}"></div>';this.y0b=null;this.Smd=this.ffg=!1;this.X$d=this.lj=this.$e=null;this.Hv=0;this.button=null;this.WPf=!1;this.aec="Help.GiveFeedback.Url";this.onCloseButtonTabKeyDown=
Lb=>{if(void 0!==Lb.Ea&&null!==Lb.Ea&&Lb.Ea.keyCode===u.a.By)if(Lb.Ea.shiftKey){if(!V.a.Ad(this.$)){Lb=this.$.da.Aa(183);if(!Lb)return!1;Lb.BRd()}}else this.ag(!0,!1),Lb.Ea.preventDefault(),Lb.Ea.stopPropagation();return!0};this.aqc=(Lb,Ic)=>{Object.getType(Ic)===String&&Ic.toString()===this.$e.InstanceId&&(Lb=!!this.title,Ic=!this.Smd,Lb&&this.rPe(),this.whg(),V.a.Ad(this.$)&&(Lb&&this.ffg||Ic&&this.Smd)&&this.y7.updateTaskPane(this.E0,this.FB))};this.dma=()=>{var Lb;Z.EwaSettings.isChangeGateEnabled("OfficeVSO:4961099_RangePickerOnOSF")&&
this.lj.ELd(this.$e.InstanceId);this.qwa&&(this.qwa.sig(),this.qwa=void 0);const Ic=ba.a(this.$e);if(Ic)if(this.$e.TaskpaneTitle===ra.a.instance.ga(983))m.ULS.sendTraceTag(537151139,9,50,"Chart task pane closed");else if(this.$e.PrimaryMarketplace)if("FA000000005"===this.$e.PrimaryMarketplace.SolutionId){m.ULS.sendTraceTag(537151138,397,50,"Ideas task pane closed");let Ob="Unknown",Kc="Unknown",Ac="Unknown";null===(Lb=this.$e.OsfPropertyBag)||void 0===Lb?void 0:Lb.forEach(Yc=>{2===Yc.length&&("LaunchMode"===
Yc[0]?Ob=Yc[1]:"CorrelationId"===Yc[0]?Kc=Yc[1]:"LaunchSelectionMode"===Yc[0]&&(Ac=Yc[1]))});Lb={["LaunchMode"]:Ob,["CorrelationId"]:Kc,["LaunchSelectionMode"]:Ac,["Location"]:"taskPane"};da.b(this.$).rd(N.a.d6g,Lb,void 0,!0);'"Default"'===Ob?y.a.instance.Tb("Common.ISystemInitiatedFeedback").execute(Yc=>{Yc.logActivity("Office_Excel_Ideas_InitializeClosePaneFloodgate",null)}):'"RecommendedCharts"'===Ob?y.a.instance.Tb("Common.ISystemInitiatedFeedback").execute(Yc=>{Yc.logActivity("Office_Excel_RecommendedCharts_InitializeClosePaneFloodgate",
null)}):'"RecommendedPivotTables"'===Ob&&Z.EwaSettings.isChangeGateEnabled("OfficeVSO:4724516_AddSurveyForRecommendedPivotTables")?y.a.instance.Tb("Common.ISystemInitiatedFeedback").execute(Yc=>{Yc.logActivity("Office_Excel_RecommendedPivotTable_InitializeClosePaneFloodgate",null)}):'"ChartDesigner"'===Ob&&Z.EwaSettings.isChangeGateEnabled("OfficeVSO:5202022_AddSurveyForChartDesigner")&&y.a.instance.Tb("Common.ISystemInitiatedFeedback").execute(Yc=>{Yc.logActivity("Office_Excel_ChartDesigner_InitializeClosePaneFloodgate",
null)})}else V.a.mli()&&"FA000000043"===this.$e.PrimaryMarketplace.SolutionId?"Record Actions"===this.$e.TaskpaneTitle&&(this.$.zba=!1,m.ULS.sendTraceTag(537151137,0,50,"OnCloseButtonClick: set recording state to false since the recorder task pane is closed.")):this.$e.PrimaryMarketplace.SolutionId===S.b?this.ksf(!1):"FA000000075"===this.$e.PrimaryMarketplace.SolutionId&&(Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerEnableTaskPaneFeedback",!1)||Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerEnableClosePaneFeedback",
!1))&&(Lb=this.$.da.Aa(465))&&(Lb.Qii(),Lb.$Me());ea.HelperMethods.ow(this.$e)?this.Kg(!1):(V.a.Ad(this.$)?this.y7.hideTaskPane(this.E0):this.raiseEvent("AgavePaneRemovedEventKey"),this.lj.DQa(this.$e.InstanceId),V.a.Ad(this.$)||this.y7.HB());O.h(this.$).setFocus();if(1===this.$e.WebExtensionOsfControlType&&!Ic){this.$e.TaskpaneVisible=!1;const Ob=this.$.oa.xa.Wb();M.a(this.$.userOperationManager,(Kc,Ac,Yc)=>aa.c(this.$.oa.xa,this.$e.InstanceId,!1,Kc,Ac,Yc,Ob),Kc=>new L.a(547,0,Kc,64),null)}return!0};
this.jGf=(Lb,Ic)=>{Object.getType(Ic)===String&&Ic.toString()===this.$e.InstanceId&&(V.a.Ad(this.$)?this.y7.hideTaskPane(this.E0):this.raiseEvent("AgavePaneRemovedEventKey"))};this.iGf=(Lb,Ic)=>{Object.getType(Ic)===String&&Ic.toString()===this.$e.InstanceId&&(this.MZd(),V.a.Ad(this.$)?this.q6():this.y7.hI(this,!0))};this.onResize=()=>{this.D$c()};this.$=cd;this.y7=Hd;Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7117293_ReduceInnerHTMLUsageForAgaveTaskPane")&&
he?he.Rh(this.domElement,String.format(this.Ise,fb,this.$.Bb+E.a.xYc,this.$.Bb+E.a.wYc)):this.domElement.innerHTML=String.format(this.Ise,fb,this.$.Bb+E.a.xYc,this.$.Bb+E.a.wYc);this.Esg=Y.DOMElementExtensions.getElementById(this.domElement,this.$.Bb+E.a.wYc);this.bsa=Y.DOMElementExtensions.getElementById(this.domElement,this.$.Bb+E.a.xYc);this.y0b=Y.DOMElementExtensions.getElementById(this.domElement,"AgaveTaskPaneHeaderId");ic=Y.DOMElementExtensions.getElementById(this.domElement,"AgaveTaskPaneHeaderId");
this.toa=this.cch();ic.appendChild(this.toa);v.a.instance.ta(C.a.click,this.toa,this.dma);this.Bkc=x.KeyInputManager.instance.Dt(this.toa,this.dma,u.a.Lh);V.a.Ad(this.$)||x.KeyInputManager.instance.ta(C.a.Sb,this.toa,this.onCloseButtonTabKeyDown);Y.DOMElementExtensions.setVisible(this.bsa,!1);this.domElement.style.height="100%";this.domElement.style.width="100%";this.domElement.style.overflowY="hidden";this.D$c();this.$&&Z.EwaSettings.isChangeGateEnabled("OfficeVSO:4658493_AgaveTaskPaneFlexLayoutMac")&&
this.domElement.classList.add(D.a.MSe);this.$.dC(this.onResize)}qT(ic){this.addHandler("AgavePaneRemovedEventKey",ic)}mW(ic){this.removeHandler("AgavePaneRemovedEventKey",ic)}JLg(ic){this.addHandler("AgavePaneReadyKey",ic)}cjj(ic){this.removeHandler("AgavePaneReadyKey",ic)}get qGa(){return this.Esg}get Jh(){return 6}get ek(){return this.$e.TaskpaneIconCssClass||""}get AQ(){return this.$e.TaskpaneButtonTooltip||this.$e.WebExtensionToolTip+" "+this.title}get iconUrl(){return this.X$d}get Vp(){return this.$e.TaskpaneWidth}get isResizable(){const ic=
cd=>{var Hd,he;return(null===(he=null===(Hd=this.$e)||void 0===Hd?void 0:Hd.PrimaryMarketplace)||void 0===he?void 0:he.SolutionId)===cd};return!OSF.OsfControl.isFirstPartyStoreString(this.$e.PrimaryMarketplace.MarketplaceType)&&Z.EwaSettings.isChangeGateEnabled("OfficeVSO:4470694_LegacyTaskpaneResizeForThirdParty")||ic("FA000000043")||ic("FA000000054")||Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6545419_ExcelIdeasResize")&&ic("FA000000005")||Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6197879_DataFromPictureResize")&&
ic("FA000000050")?!0:!1}get Xd(){return P.a.tQg}get jc(){return this.domElement}get Ff(){return!!this.$e}get title(){return this.lj.qTh(this.$e.InstanceId)}get titleText(){return this.title}get tZa(){return OSF.OsfControlTarget.TaskPane}get instanceId(){return this.$e.InstanceId}get E0(){return"AgaveTaskPane-"+this.instanceId.replace(RegExp("[{}]","g"),"")}get FB(){const ic=this.y7.Vua(this.jc,this.titleText,this.Vp,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=
!0},()=>{this.isVisible=!1},this.Vp,void 0,this.iconUrl,this.$e.TaskpaneIconId,ea.HelperMethods.ow(this.$e));if(Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OcvFeedbackvNextEnabled",!1)&&this.$e.SrcLocationOverrideResourceId===this.aec){ic.contentProps.type="OcvFeedbackTaskPaneProps";ic.hideHeader=!1;let cd=JSON.parse(this.$e.OsfPropertyBag[0][1]);cd.IsProd=!0;ic.contentProps.feedbackTaskPaneProps={customerUiWrapperFeedbackData:cd,taskPaneLocation:ic.location,taskPaneIdToClose:this.E0}}return ic}startEdit(){return!0}YAc(){return!0}Hof(){this.lj.Ng.notifyAgave(this.$e.InstanceId,
OSF.AgaveHostAction.TabIn)}Iof(){this.lj.Ng.notifyAgave(this.$e.InstanceId,OSF.AgaveHostAction.TabInShift)}ADd(){this.lj.xqe(this.jGf);this.lj.qMg(this.iGf);let ic=this.lj.Wfd(this.$e.InstanceId);this.title&&ic||this.lj.tMg(this.aqc);this.title&&this.rPe();this.raiseEvent("AgavePaneReadyKey");V.a.Ad(this.$)&&(""!==this.ek?d.a.qe(10):d.a.current.qo(101),this.tjg(),Z.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&V.a.Ad(this.$)&&ea.HelperMethods.ow(this.$e)&&this.$e.Preload&&
!this.$e.TaskpaneVisible?this.j6b():this.q6())}j6b(){this.y7.j6b(this.E0,this.FB)}q6(){"FA000000005"!==this.$e.PrimaryMarketplace.SolutionId||this.qwa||(this.qwa=new Ca(this.$),this.qwa.ngj());this.y7.q6(this.E0,this.FB)}dispose(){var ic,cd;this.WPf||(null===(cd=null===(ic=this.$e)||void 0===ic?void 0:ic.PrimaryMarketplace)||void 0===cd?void 0:cd.SolutionId)!==S.b||this.ksf(!0);this.qwa&&(this.qwa.sig(),this.qwa=void 0);v.a.instance.Ba(C.a.click,this.toa,this.dma);x.KeyInputManager.instance.Xw(this.toa,
this.Bkc);V.a.Ad(this.$)||x.KeyInputManager.instance.Ba(C.a.Sb,this.toa,this.onCloseButtonTabKeyDown);this.lj&&(this.lj.Hjj(this.aqc),this.lj.Fjj(this.jGf),this.lj.Ejj(this.iGf),this.$&&(this.$.zF(this.onResize),this.$=null));this.$=this.$e=null;super.dispose()}tjg(){this.$e&&this.whg()}IV(ic){ic||this.MZd()}Kg(ic){if(this.$e){const cd=this.$e.TaskpaneVisible!==ic;this.$e.TaskpaneVisible=ic;V.a.Ad(this.$)?ic||this.y7.hideTaskPane(this.E0):this.y7.HB();ea.HelperMethods.ow(this.$e)&&cd&&this.lj.WHh(this.instanceId,
ic)}}Cq(){let ic=!1;this.$e&&this.$.qd&8388608&&(ic=this.$e.TaskpaneVisible);return ic}wt(){return!this.$e||OSF.OsfControl.isFirstPartyStoreString(this.$e.PrimaryMarketplace.MarketplaceType)||this.$.lP?ea.HelperMethods.ow(this.$e)?this.$e.TaskpaneVisible:!!this.$e:!1}ag(ic,cd){return cd?!1:(this.MZd(),this.lj.Ng.notifyAgave(this.$e.InstanceId,ic?OSF.AgaveHostAction.TabIn:OSF.AgaveHostAction.TabInShift),!0)}sh(ic){return Y.DOMElementExtensions.Af(this.jc,ic)}rj(){}dk(){}TU(ic,cd){var Hd=cd.querySelectorAll(Y.DOMElementExtensions.nr);
cd=Y.DOMElementExtensions.rm(Hd);Hd=Y.DOMElementExtensions.PA(Hd);let he=!1;cd===ic.Mb&&ic.Ea.shiftKey?((ic=document.getElementById(this.$.Bb+E.a.eoc))&&Y.DOMElementExtensions.isVisible(ic)?Y.DOMElementExtensions.setFocus(ic):this.ag(!1,!1),he=!0):Hd!==ic.Mb||ic.Ea.shiftKey||(this.T4f(),he=!0);return he}T4f(){this.toa&&Y.DOMElementExtensions.setFocus(this.toa)}cch(){const ic=document.createElement("a");ic.tabIndex=0;ic.id="AgaveTaskpaneCloseButtonId";ic.className=E.a.KOb+(B.AFrameworkApplication.isRtl?
E.a.Xia:E.a.Yia);ic.title=ra.a.instance.ga(10);ic.setAttribute(H.a.Cd,H.a.Qs);ic.style.borderColor="transparent";Z.EwaSettings.isChangeGateEnabled("OfficeVSO:4186654_RemoveAgaveTaskpaneCloseBottomMargin")?ic.style.margin="6px 6px 0px 6px":ic.style.margin="6px";ic.style.zIndex="2";ic.style.position="relative";const cd=document.createElement("span");cd.className="StandardButtonImage clip16x16 StandardButtonImageNoText";cd.id=ic.id+"-close";const Hd=xa.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32",
"",!0,ra.a.instance.ga(792));cd.appendChild(Hd);ic.appendChild(cd);return ic}rPe(){this.bsa.innerText=this.title;this.bsa.style.textOverflow="ellipsis";this.bsa.style.whiteSpace="nowrap";this.bsa.style.overflowX="hidden";this.$e.TaskpaneTitleCssClass&&(this.bsa.className=this.bsa.className+" "+this.$e.TaskpaneTitleCssClass);this.y0b.className=this.y0b.className+" "+this.$e.TaskpaneHeaderCssClass;Y.DOMElementExtensions.setVisible(this.bsa,!0);this.button&&(this.button.I_a.title=this.title);this.D$c();
this.ffg=!0}whg(){if(Z.EwaSettings.isChangeGateEnabled("OfficeVSO:5617870_SdxTaskpaneIconUrlOverride")){if(this.ek&&!V.a.Ad(this.$)){if(this.button){var ic=d.a.qe(10),cd=this.button.Bl;cd.setAttribute("src",ic);cd.setAttribute("class",this.ek)}return}}else if(this.ek){this.button&&(ic=d.a.qe(10),cd=this.button.Bl,cd.setAttribute("src",ic),cd.setAttribute("class",this.ek));return}if(cd=Z.EwaSettings.isChangeGateEnabled("OfficeVSO:5617870_SdxTaskpaneIconUrlOverride")?this.$e.TaskpaneIconUrl?this.$e.TaskpaneIconUrl:
this.lj.Wfd(this.$e.InstanceId):this.lj.Wfd(this.$e.InstanceId))this.$.Vka&&this.$e.PrimaryMarketplace&&this.$e.PrimaryMarketplace.SolutionId===fa.a.solutionId&&(cd=this.ZWh(cd)),V.a.Ad(this.$)?this.X$d=cd:(ic=this.button.Bl,ic.setAttribute("src",cd),cd=d.a.current.qo(101),ic.setAttribute("onerror","this.onerror = null;this.src = '"+cd+"';")),this.Smd=!0}ZWh(ic){const cd=fa.a.z6e(this.$),Hd=fa.a.Uwb(this.$),he=fa.a.Lxb(this.$),Lb=fa.a.f6e(this.$),Ic=this.$e.SrcLocationOverrideResourceId,Ob=V.a.Ad(this.$);
return Ic===cd?Ob?ic.replace("/icon-32.png","/record-tp-20.png"):ic.replace("/icon-32.png","/record-tp-32.png"):Ic===Hd?Ob?ic.replace("/icon-32.png","/code-tp-20.png"):ic.replace("/icon-32.png","/code-tp-32.png"):Ic===he?Ob?ic.replace("/icon-32.png","/rfb-tp-20.png"):ic.replace("/icon-32.png","/rfb-tp-32.png"):Ic===Lb?Ob?ic.replace("/icon-32.png","/flowconnector-tp-20.png"):ic.replace("/icon-32.png","/flowconnector-tp-32.png"):ic}D$c(){this.$&&!Z.EwaSettings.isChangeGateEnabled("OfficeVSO:4658493_AgaveTaskPaneFlexLayoutMac")&&
(this.qGa.style.height=ea.HelperMethods.sc(this.y7.rO.offsetHeight-this.y0b.offsetHeight))}MZd(){this.lj.oBd(this)}ksf(ic){ic={["PaneClosedTime"]:Date.now(),["IsSessionEnded"]:ic.toString()};const cd=new Ma.a(Ta.a.Oi());cd.add("PaneClosedTime",3);cd.add("IsSessionEnded",1);I.a.sendTelemetryEvent(Object(w.a)(new ia.a,{name:"Office.Excel.Online.Protection.TaskPaneClosed",dataFields:U.a.Mi(ic,cd)}));this.WPf=!0}}Object(c.a)(yb,"AgaveTaskPane",G.a,[54,231,262,263]);var mb=a(50);class nb extends t.a{constructor(ic){super();
this.JFd=[];this.vKf=null;this.Bzf=cd=>{this.nb(Object(k.a)(231,cd))};this.$=ic;this.Db()}create(){const ic=Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7117293_ReduceInnerHTMLUsageForAgaveTaskPane")?mb.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Xa):l.Task.Sa(null),cd=n.a(this.$);z.TaskExtensions.za(z.TaskExtensions.Fd([cd,ic],this.$.la),()=>{const Hd=new yb(document.createElement("div"),this.$,cd.result,ic.result);
this.JFd.push(Hd);Hd.JLg(this.Bzf);this.Pa.raiseEvent(t.a.u_c,null,Hd)},this.la,3)}dispose(){for(const ic of this.JFd)ic.cjj(this.Bzf);h.a.pc(this.JFd);h.a.Ja(this.vKf);this.$=this.vKf=null;super.dispose()}}Object(c.a)(nb,"AgaveTaskPaneFactory",t.a,[]);var X=a(30),R=a(239),wa=a(195),na=a(263),Ba=a(60),Ra=a(48),qa=a(44),La=a(325),Yb=a(74),mc=a(22),Zb=a(286),qb=a(282);const Ha=Da.a.QAh,Ya=`<div class="${Da.a.Bad}"><div title="{0}" class="${Da.a.Zxh}">{0}</div></div><div><div class="${Da.a.Sxh}">{1}</div><div class="${Da.a.Wxh} ${Da.a.jo}" id="parametersSection">&nbsp;</div><div align="bottom" class="${Da.a.Rxh}"><button class="${Da.a.KSe} ${Da.a.Qxh}" id="applyButton" type="submit">{2}</button><button class="${Da.a.KSe}" id="resetButton" type="button">{3}</button></div></div>`,
Gb=`<div><div class="${Da.a.Xxh}"><label for="{2}" title="{1}">{0}</label></div><div class="${Da.a.Yxh}"><input type="text" maxlength="255" id="{2}"/></div></div>`;class Ja extends R.a{constructor(ic,cd,Hd,he){super(ic);this.ZRd=this.LVa=this.G0=null;this.Hv=0;this.htmlSanitizationHelper=null;this.uIf=()=>{this.LVa=null};this.DAj=()=>{h.a.Ja(this.ZRd);this.ZRd=null;this.isVisible!==this.FTd&&this.raiseEvent("parameterTaskPaneVilibilityChanged")};this.Z7g=(Lb,Ic)=>mc.a.compare(Lb.Name,Ic.Name,!0);
this.Kzf=Lb=>{Yb.g(Lb);if(!this.jsa.domElement.classList.contains(Da.a.Q9b)){O.h(this.$).Fo(!0);var Ic=[];for(Lb=0;Lb<this.G0.length;Lb++){const Kc=this.LVa[Lb],Ac=this.G0[Lb].text;Kc.Values=[Ac];Ac&&Ic.push(Kc)}if(Ic.length){var Ob=this.$.oa.xa.Wb();this.jsa.addCssClass(Da.a.Q9b);this.$.userOperationManager.Jc(new L.a(142,0,(Kc,Ac,Yc)=>Ba.F(this.$.oa.xa,Ic,!1,0,!1,qb.b(Kc,this.e_i),qb.a(Ac,this.d_i),Yc,null,Ob)),null)}}};this.QYi=Lb=>{Yb.g(Lb);Lb=this.G0;for(let Ic=0,Ob=Lb.length;Ic<Ob;Ic++)Lb[Ic].text=
""};this.e_i=()=>{this.jsa.removeCssClass(Da.a.Q9b)};this.d_i=()=>{this.jsa.removeCssClass(Da.a.Q9b)};this.WGb=(Lb,Ic)=>{13===Ic.charCode&&this.Kzf(Ic)};this.$=cd;this.taskPaneManager=Hd;this.htmlSanitizationHelper=he;cd=String.format(Ya,this.titleText,ra.a.instance.ga(1328),ra.a.instance.ga(1329),ra.a.instance.ga(1330));this.htmlSanitizationHelper&&Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7153383_ReduceInnerHTMLUsageForParametersTaskPane")?
this.htmlSanitizationHelper.Rh(ic,cd):ic.innerHTML=cd;this.uab=this.getElementById("parametersSection");this.jsa=new La.a(this.getElementById("applyButton"));this.jsa.Cc.ka("click",this.Kzf);this.KNd=new La.a(this.getElementById("resetButton"));this.KNd.Cc.ka("click",this.QYi);this.$.ea.Jj(this.uIf);na.a(this.$).Yh(this)}qT(ic){this.get_events().addHandler("RemoveParamTpEventKey",ic)}mW(ic){this.get_events().removeHandler("RemoveParamTpEventKey",ic)}kE(ic){this.addHandler("parameterTaskPaneVilibilityChanged",
ic)}BF(ic){this.removeHandler("parameterTaskPaneVilibilityChanged",ic)}get i8b(){this.Mef();return this.LVa}get jc(){return this.domElement}get Vp(){return 250}get isResizable(){return!1}get Ff(){return this.isVisible}get Xd(){return P.a.N3i}get Jh(){return 2}get ek(){return Ha}get AQ(){return ra.a.instance.ga(1069)}get FTd(){return!!this.i8b&&0<this.i8b.length&&!this.$.isEditMode}get titleText(){return ra.a.instance.ga(1327)}get FB(){return this.taskPaneManager.Vua(this.jc,this.titleText,this.Vp,
this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1})}Kg(ic){V.a.Ad(this.$)&&(ic?(this.Mef(),this.taskPaneManager.q6("ParametersTaskPane",this.FB)):this.taskPaneManager.hideTaskPane("ParametersTaskPane"))}Cq(){return this.FTd}wt(){return this.FTd}IV(){}dispose(){this.$&&this.$.ea.ik(this.uIf);this.HVf();h.a.pc([this.jsa,this.KNd]);this.LVa=this.uab=this.$=this.jsa=this.KNd=null;super.dispose()}ag(ic,cd){cd||(this.G0&&0<this.G0.length?this.G0[0]:
this.jsa).focus();return!cd}sh(ic){return Y.DOMElementExtensions.Af(this.jc,ic)}rj(){}dk(){}TU(){return!1}Mef(){!this.LVa&&this.$.qd&2048&&this.mUg(this.$.workbookContext.TaskPaneParameters,this.$.ya.SlicerParameters)}mUg(ic,cd){var Hd=[];this.HVf();if(!this.$.isEditMode&&ic&&0<ic.length){var he=this.Z7g;if(cd&&0<cd.length){var Lb=new wa.a([...cd]);Lb.V9.sort(he)}else Lb=null;for(let Ob=0,Kc=ic.length;Ob<Kc;Ob++){var Ic=ic[Ob];cd&&!(0>ea.HelperMethods.Xu(Lb,0,Lb.Gja(),Ic,he))||Ic.IsPivotPageField||
Ic.IsSlicer||Hd.push(Ic)}}this.LVa=Hd;if(this.uab&&(this.isVisible!==0<Hd.length&&(this.ZRd=Ra.a.instance.create(this.DAj,500,qa.a.O3i,!0,!0)),this.htmlSanitizationHelper&&Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7153383_ReduceInnerHTMLUsageForParametersTaskPane")?this.htmlSanitizationHelper.KG(this.uab):this.uab.innerHTML="",Hd.length)){cd="";ic=[];for(let Ob=0,Kc=Hd.length;Ob<Kc;Ob++)he=this.$.Bb+"param"+Ob,ic.push(he),
Ic=Hd[Ob],Lb=Ic.Name?X.a.yg(Ic.Name):"",Ic=Ic.Comment?X.a.YJ(Ic.Comment):"",cd+=String.format(Gb,Lb,Ic,he);this.htmlSanitizationHelper&&Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7153383_ReduceInnerHTMLUsageForParametersTaskPane")?this.htmlSanitizationHelper.Rh(this.uab,cd):this.uab.innerHTML=cd;cd=[];for(let Ob=0,Kc=Hd.length;Ob<Kc;Ob++)Hd=new Zb.a(document.getElementById(ic[Ob])),cd.push(Hd),Hd.uNg(this.WGb);this.G0=
cd}}HVf(){if(this.G0){for(let ic=0,cd=this.G0.length;ic<cd;ic++)this.G0[ic].ukj(this.WGb);h.a.pc(this.G0);this.G0=null}}static nUg(ic,cd,Hd){const he=ic.da;let Lb=he.Aa(17);if(!Lb){const Ic=document.getElementById(ic.Bb+E.a.P3i);Ic&&(Lb=he.Ha(17,new Ja(Ic,ic,cd,Hd)))}return Lb}}Object(c.a)(Ja,"ParametersTaskPane",R.a,[153,262,54,2]);class Na extends t.a{constructor(ic){super();this.$=ic;this.Db()}create(){const ic=Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7153383_ReduceInnerHTMLUsageForParametersTaskPane")?
mb.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Xa):l.Task.Sa(null),cd=n.a(this.$);z.TaskExtensions.za(z.TaskExtensions.Fd([cd,ic],this.$.la),()=>{this.nb(Ja.nUg(this.$,cd.result,ic.result))},this.la,3)}}Object(c.a)(Na,"ParametersTaskPaneFactory",t.a,[]);var Qa=a(709),Oa=a(189);class bb{Hc(){return!1}executeCommand(ic,cd){ic=cd.command;switch(ic){case 329273335:case 1962240939:case 296943390:case -625072140:return l.Task.Sa(!0);default:return Oa.a(ic)}}wc(ic,cd,Hd,he){if(ic=!!he&&2===he.zx)switch(cd.command){case 329273335:case 1962240939:case 296943390:case -625072140:break;
default:ic=!1}return ic}Nc(){return!1}}Object(c.a)(bb,"TaskPaneCommandHandler",null,[222]);class Ga extends Qa.a{constructor(ic){super(ic)}hd(){this.$c([new bb])}static ka(ic){Qa.a.Md(115,new Ga(ic))}}Object(c.a)(Ga,"TaskPaneCommandHandlerFactory",Qa.a,[]);var tb=a(1346),wb=a(176);class lb{constructor(){this.onResizeMiddleContainer=this.onTabStripFocus=this.onResizeEnd=this.onResizeStart=this.onOverflowMenuClose=this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=this.onClose=this.onOpen=
this.middleContainer=null}}Object(c.a)(lb,"TaskPaneGroupAppProps",null,[]);var db=a(27),Pa=a(38),ja=a(217);class Ka{constructor(){this.type="ExcelLegacyTaskPaneWacInfraProps";this.isSharedRuntime=!1;this.feedbackTaskPaneProps=this.getContent=null}}Object(c.a)(Ka,"ExcelLegacyTaskPaneWacInfraProps",null,[]);var ub=a(294),Kb=a(18),W=a(16),za=a(131);class Sa{constructor(ic){this.width=ic}}Object(c.a)(Sa,"ActiveTaskPaneData",null,[]);class Wa extends Pa.a{constructor(ic,cd){super();this.isVisible=!1;this.$Xd=
this.kea=-1;this.hLe=40;this.Ch=this.iL=this.animationManager=this.zJc=null;this.gDd=()=>{this.pZf()};this.SBc=new Set;this.SBc.add("FieldListTaskPane");this.SBc.add("PivotTableSettingsTaskPane");this.SBc.add("SlicerSettingsTaskPane");this.jb=cd;na.a(this.$).Yh(this);this.Pz=ic;this.E9a=this.NYg();V.a.gj(cd)||B.AFrameworkApplication.sa.Qa.df||(this.Pz.style.bottom=this.$.qd&4?ea.HelperMethods.sc(this.$.gea):"0");this.F$b={};this.MOb={};this.s4d={};this.XXd=za.a.instance.ie(this.jc);this.XXd.ka("focusin",
this.gDd);this.Gii()}get $(){return this.jb}get Cga(){return this.s4d}get qM(){return this.zJc}get isCollapsed(){return!this.qM}dispose(){na.a(this.$).Ez(this);const ic=this.F$b;for(let cd in ic)({key:cd,value:ic[cd]}).value();this.MOb=this.s4d=this.F$b=null;this.XXd.DC();this.E9a=this.Pz=this.XXd=null;super.dispose()}Vua(ic,cd,Hd,he,Lb,Ic,Ob,Kc,Ac=Wa.Rzi,Yc=Wa.Qzi,td=null,$d=null,be=!1){const ke=Object(w.a)(new Ka,{getContent:()=>ic});ke.isSharedRuntime=be;return Object(w.a)(new tb.a,{hideHeader:!0,
contentProps:ke,title:cd,width:Hd,location:2,onOpen:Lb,onClose:Ic,onShow:Ob,onHide:Kc,iconUrl:td,iconId:$d,enableResize:he,minResizeWidth:Ac,maxResizeWidth:Yc})}q6(ic,cd){wb.UISurfaces.dj().then(Hd=>{ic in this.Cga?Hd.setSelectedTaskPane(ic):Hd.showTaskPane(ic,cd);return null})}j6b(ic,cd){wb.UISurfaces.dj().then(Hd=>{Hd.initializeHiddenSharedRuntimeTaskPane(ic,cd);const he=this.$.domElement;he.addEventListener("scroll",function Ic(){0!=he.scrollLeft&&(he.scrollLeft=0,he.removeEventListener("scroll",
Ic))})})}updateTaskPane(ic,cd){wb.UISurfaces.dj().then(Hd=>{Hd.updateTaskPane(ic,cd);return null})}setSelectedTaskPane(ic){wb.UISurfaces.dj().then(cd=>{cd.setSelectedTaskPane(ic);return null})}hideTaskPane(ic){wb.UISurfaces.dj().then(cd=>{cd.hideTaskPane(ic,Wa.mRj);return null})}get jc(){return this.Pz}get Ff(){return this.isVisible}get Xd(){return P.a.QBc}ag(ic,cd){return cd?!1:(this.v2f(),!0)}sh(ic){return Y.DOMElementExtensions.Af(this.jc,ic)}rj(){this.$.frame.Le.kk(this.Xd)}dk(){}NYg(){const ic=
document.createElement(ja.a.div);ic.style.height="0px";ic.style.width="0px";ic.tabIndex=-1;return ic}YNh(){var ic=Y.DOMElementExtensions.getElementById(this.Pz,"tabStripFocusZone");if(ic){ic=ic.getElementsByTagName("button");for(let cd=0;cd<ic.length;cd++)if(Boolean.parse(ic[cd].getAttribute("aria-selected")))return ic[cd].getAttribute("aria-controls")}return null}A8g(ic){return(ic=window.getComputedStyle(ic,null).getPropertyValue("transition-duration"))?parseInt(ic.endsWith("ms")?parseFloat(ic):
1E3*parseFloat(ic),10):0}Ofj(){const ic=document.getElementById("tabbedTaskPaneContainer");ic&&ic.addEventListener("transitionend",()=>this.eHa(-1))}Gii(){wb.UISurfaces.dj().then(ic=>{let cd;ic.renderTaskPaneGroups(null,this.Pz,(cd=new lb,cd.middleContainer=this.E9a,cd.onOpen=(Hd,he)=>{this.isVisible=!0;-1===this.kea&&(this.kea=this.A8g(he));V.a.gj(this.$)||(this.Cga[Hd]=new Sa(Y.DOMElementExtensions.zP(Y.DOMElementExtensions.getElementById(he,Wa.Qdg))))},cd.onClose=Hd=>{this.isVisible=0<ic.selectors.getTabbedTaskPaneCount();
m.ULS.sendTraceTag(537014371,0,50,`Closing of ${Hd} TaskPane`);if(!this.isVisible)this.hZe(),V.a.gj(this.$)||B.AFrameworkApplication.sa.Qa.df||window.requestAnimationFrame(()=>{this.r0b(this.E9a)});else if(!V.a.gj(this.$)&&this.qM&&this.qM!==Hd){const he=1<ic.selectors.getTabbedTaskPaneCount()?this.Cdc():0,Lb=1===ic.selectors.getTabbedTaskPaneCount()?-1*this.Cdc():0;this.mse(Hd,this.qM,he,Lb)}V.a.gj(this.$)?this.eHa(this.kea):(B.AFrameworkApplication.sa.Qa.df&&0>=this.kea&&this.eHa(this.kea),delete this.Cga[Hd]);
delete this.MOb[Hd]},cd.onShow=(Hd,he)=>{null!=this.Sh&&(this.Sh.stop(),this.Sh=null);this.zJc=Hd;this.pZf();1!==he&&window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.Nrj()},0)});V.a.gj(this.$)?window.requestAnimationFrame(()=>{this.eHa(this.kea)}):B.AFrameworkApplication.sa.Qa.df&&0>=this.kea?window.requestAnimationFrame(()=>{this.eHa(this.kea)}):window.requestAnimationFrame(()=>{this.htj(this.E9a,this.kea)})},cd.onHide=(Hd,he,Lb)=>{const Ic=this.YNh();Ic!==Hd&&(this.Sh=this.$.Jb.Gc("UserAction",
"TaskPaneToggle"),m.ULS.sendTraceTag(537014370,0,50,`Toggling Pane from ${Hd} to ${Ic}`));Lb?V.a.gj(this.$)||this.r0b(this.E9a):!V.a.gj(this.$)&&Ic&&(Hd=1===Object.keys(this.Cga).length?this.Cdc():0,this.mse(this.qM,Ic,this.Cdc(),Hd));this.zJc=null;Lb&&1!==he&&this.hZe();V.a.gj(this.$)&&window.requestAnimationFrame(()=>{this.eHa(this.kea)})},cd.setFocusCallback=(Hd,he)=>{he&&(this.MOb[Hd]=he)},cd.onResizeStart=()=>{V.a.gj(this.$)||this.lYc(ea.HelperMethods.sc(0))},cd.onResizeEnd=()=>{V.a.gj(this.$)?
this.eHa():(this.r0b(this.E9a),this.Cga[this.qM]=this.rjd(this.qM));m.ULS.sendTraceTag(537014369,0,50,`Resizing of ${this.qM} TaskPane`)},cd));B.AFrameworkApplication.sa.Qa.df&&!V.a.gj(this.$)&&this.Ofj();return null})}r0b(ic){this.lYc(this.$.isChromeRtl?ic.style.left:ic.style.right)}lYc(ic){m.ULS.sendTraceTag(537014368,0,50,`Grid adjust is triggered for taskPane ${this.qM}`);this.$.Doj(ic)}eHa(ic=0){-1<ic?l.Task.delay(ic+this.hLe).continueWith(()=>{this.$.Aza(ub.a.qZ("ResetContentAreaMargin"))}):
this.$.Aza(ub.a.qZ("ResetContentAreaMargin"))}mse(ic,cd,Hd,he){cd=cd.endsWith(Wa.YXd)?cd.substring(0,cd.length-Wa.YXd.length):cd;cd=this.g9e(cd);he=cd+he;ic=this.g9e(ic);he<ic&&this.lYc(ea.HelperMethods.sc(cd+Hd))}htj(ic,cd){window.setTimeout(()=>{this.r0b(ic)},cd+this.hLe)}Cdc(){return-1!==this.$Xd?this.$Xd:this.$Xd=Y.DOMElementExtensions.zP(Y.DOMElementExtensions.getElementById(this.Pz,"tabStripFocusZone"))}rjd(ic){return Y.DOMElementExtensions.zP(Y.DOMElementExtensions.getElementById(Y.DOMElementExtensions.getElementById(this.Pz,
ic+Wa.YXd),Wa.Qdg))}g9e(ic){if(ic in this.Cga){const cd=this.Cga[ic].width;return 0<cd?cd:this.rjd(ic)}return ic?this.rjd(ic):0}hZe(){O.h(this.$).setFocus()}Nrj(){if(this.MOb[this.qM]){const ic=this.MOb[this.qM];ic&&ic(null,null)}else this.SBc.has(this.qM)||this.v2f()}v2f(){wb.UISurfaces.dj().then(ic=>{1<ic.selectors.getTabbedTaskPaneCount()?ic.focusTabbedTaskPaneArea():(ic=Y.DOMElementExtensions.getElementById(this.jc,"AgaveTaskpaneCloseButtonId"))?ic.focus():(ic=Y.DOMElementExtensions.rm(this.jc.querySelectorAll("button")))&&
ic.focus();return null})}pZf(){this.$.domElement.scrollLeft=0;db.a.ZMa&&window.requestAnimationFrame(()=>{this.$.domElement.scrollLeft=0;window.setTimeout(()=>{this.$.domElement.scrollLeft=0},0)})}kE(ic){this.addHandler(Wa.Ugb,ic)}BF(ic){this.removeHandler(Wa.Ugb,ic)}get rO(){return this.Pz}get GD(){m.ULS.shipAssertTag(537151112,11,!1,"ReactTaskPaneManager.TaskPaneButtons should not be used with the WAC infra");return null}Dsb(ic,cd,Hd,he,Lb){let Ic=ic.Aa(cd);Ic||(Ic=W.a(Kb.a,Hd,ic,cd),Ic.SetScriptLoadFlavor(Lb));
he&&Ic.jXc(he);const Ob=""+cd;let Kc=null;const Ac=()=>{Ic.create();Kc()};this.F$b[Ob]=Kc=()=>{Ic.Iuc(Ac);delete this.F$b[Ob]};Ic.I_b(Ac)}initialize(){m.ULS.shipAssertTag(537151111,11,!1,"ReactTaskPaneManager.Initialize should not be used with the WAC infra")}$9f(){}GQ(){m.ULS.shipAssertTag(537151110,11,!1,"ReactTaskPaneManager.InsertPane should not be used with the WAC infra")}hI(){m.ULS.shipAssertTag(537151109,11,!1,"ReactTaskPaneManager.SelectPane should not be used with the WAC infra")}Qpe(){m.ULS.shipAssertTag(537151108,
11,!1,"ReactTaskPaneManager.AddTaskPane should not be used with the WAC infra")}PYf(){m.ULS.shipAssertTag(537151107,11,!1,"ReactTaskPaneManager.RepositionTaskpaneForCurrentMode should not be used with the WAC infra")}Z4a(){m.ULS.shipAssertTag(537151106,11,!1,"ReactTaskPaneManager.GetTaskPane should not be used with the WAC infra");return null}nfd(){m.ULS.shipAssertTag(537151105,11,!1,"ReactTaskPaneManager.GetButtonsByTaskPaneType should not be used with the WAC infra");return null}Jia(){m.ULS.shipAssertTag(537151104,
11,!1,"ReactTaskPaneManager.ExpandOrCollapsePane should not be used with the WAC infra")}HB(){m.ULS.shipAssertTag(537151075,11,!1,"ReactTaskPaneManager.UpdateAvailablePanes should not be used with the WAC infra")}setFocusOnToolbarFirstElement(){m.ULS.shipAssertTag(537151070,11,!1,"ReactTaskPaneManager.SetFocusOnToolbarFirstElement should not be used with the WAC infra")}BRd(){m.ULS.shipAssertTag(537151069,11,!1,"ReactTaskPaneManager.SetFocusOnToolbarLastElement should not be used with the WAC infra")}static ka(ic){const cd=
Wa.KZg(ic.Bb,ic.isChromeRtl,ic);Wa.sUg(ic,cd);return new Wa(cd,ic)}static KZg(ic,cd,Hd){const he=document.createElement("div");he.id=ic+E.a.RBc;V.a.gj(Hd)?he.classList.add(Da.a.f6j):(he.classList.add(cd?Da.a.h6j:Da.a.g6j),B.AFrameworkApplication.sa.Qa.df&&he.classList.add(Da.a.Mza));return he}static sUg(ic,cd){ic.isMobileMode&&cd.setAttribute("aria-hidden","true");B.AFrameworkApplication.sa.Qa.df?document.getElementById("FarPaneRegion").appendChild(cd):(Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7497951_GridLayoutCleanup")||
V.a.gj(ic)&&cd.classList.add(Da.a.Iuh),document.getElementById(ic.Bb+E.a.u0a).insertBefore(cd,ic.fBa))}}Wa.Rzi=300;Wa.Qzi=950;Wa.mRj=2;Wa.YXd="-panel";Wa.Qdg="ExcelTaskPaneContentWrapper";Wa.pag="rtpSizeChanged";Wa.mEe="rtpCollapsed";Wa.CLf="rtpAdded";Wa.Ugb="rtpVisibility";Object(c.a)(Wa,"ReactTaskPaneManager",Pa.a,[264,54,2]);var ab=a(97),ma=a(159),ha=a(240),eb=a(421),ta=a(85),ya=a(557);class sb extends Sys.EventArgs{constructor(){super()}}Object(c.a)(sb,"TaskPaneVisibilityChangedEventArgs",Sys.EventArgs,
[]);var Qb=a(46);const oc=D.a.sxh,kb=D.a.uxh,jb=`<span class='${Da.a.yrb} ${D.a.vxh} {3}'><img class='{1}' alt='{0}' src='{2}' {4}/></span>`;class Wb extends R.a{constructor(ic){super(document.createElement("a"));this.Pa=new Pa.a;this.htmlSanitizationHelper=this.lle=null;this.fd=()=>{this.enabled&&this.Pa.raiseEvent("tpButtonClicked",null,this);return!0};this.htmlSanitizationHelper=ic}XLg(ic){this.Pa.addHandler("tpButtonClicked",ic)}XVf(ic){this.Pa.removeHandler("tpButtonClicked",ic)}get I_a(){return this.domElement}get taskPane(){return this.lle}get enabled(){return super.enabled}set enabled(ic){ic!==
super.enabled&&(this.domElement.classList.toggle(D.a.$T),this.domElement.classList.toggle(kb),this.domElement.tabIndex=ic?0:-1,super.enabled=ic)}get Bl(){return this.domElement.firstChild.firstChild}dispose(){h.a.pc([this.Pa]);this.Pa=null;this.domElement&&Qb.a.Wma(this.domElement);super.dispose()}Fii(ic){const cd=6===ic.Jh;var Hd=cd&&!ic.ek;Hd=String.format(jb,ic.AQ,ic.ek,Hd?d.a.current.qo(101):d.a.qe(10),D.a.cia,Hd?String.format('style="width:24px;{0}:0px"',"left"):"");Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&
Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7153231_ReduceInnerHTMLUsageTaskPane")?this.htmlSanitizationHelper.Rh(this.domElement,Hd):this.domElement.innerHTML=Hd;this.domElement.classList.add(oc);this.domElement.classList.add(kb);this.domElement.title=ic.AQ;this.domElement.tabIndex=0;Y.DOMElementExtensions.It(this.domElement,E.a.Qs,null,null);this.lle=ic;cd&&(ic=this.taskPane,null===ic||void 0===ic?void 0:ic.tjg());v.a.instance.ta(C.a.click,this.domElement,this.fd);x.KeyInputManager.instance.Dt(this.domElement,
this.fd,u.a.Lh)}}Object(c.a)(Wb,"TaskPaneButton",R.a,[332]);class wc extends G.a{constructor(ic,cd,Hd,he){super(ic);this.animationManager=this.s5=this.Ne=null;this.JI=this.mVa=!1;this.t7d=0;this.jb=null;this.wNc=!1;this.htmlSanitizationHelper=null;this.xz=()=>{this.Ypi||(this.HB(),this.$.qf())};this.tCd=(Lb,Ic)=>{this.onButtonClick(Lb,Ic)};this.X5=()=>{this.LDc()};this.$=cd;this.htmlSanitizationHelper=he;na.a(this.$).Yh(this);this.$.yb.Vf(this.X5);this.configuration=Hd;this.baseName=ea.HelperMethods.tva(this.domElement,
this.configuration.Tdg||this.configuration.E0);this.E$b={};this.mfb=[];this.Yt=[];this.yqb={};this.mle=document.getElementById(this.baseName+this.configuration.WXd);this.rO||m.ULS.sendTraceTag(512291722,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+this.configuration.WXd} not found`);this.fFg=document.getElementById(this.baseName+this.configuration.E0);this.Pz||m.ULS.sendTraceTag(512291721,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+this.configuration.E0} not found`);
this.gFg=document.getElementById(this.baseName+this.configuration.bZd);this.iL||m.ULS.sendTraceTag(512291720,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+this.configuration.bZd} not found`);ic=String.format(wc.nRj,this.baseName+this.configuration.Hfg,this.baseName+wc.LOb);Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7153231_ReduceInnerHTMLUsageTaskPane")?this.htmlSanitizationHelper.Rh(this.iL,ic):this.iL.innerHTML=
ic;this.I5d=document.getElementById(this.baseName+wc.LOb);this.Tye||m.ULS.sendTraceTag(512291719,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+wc.LOb} not found`);(this.xqb=document.getElementById(this.baseName+wc.LOb))||m.ULS.sendTraceTag(512291718,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+wc.LOb} not found`);this.wug=this.dIe(this.configuration.kEe,this.hEe);this.vug=this.uHe(this.configuration.iEe,ra.a.instance.ga(1296),this.Q7h,this.B0a,!0);this.swg=
this.dIe(this.configuration.uWe,this.rEh);this.rwg=this.uHe(this.configuration.sWe,ra.a.instance.ga(1295),this.R7h,this.yJa,!1);Y.DOMElementExtensions.setVisible(this.yJa,!1);v.a.instance.ta(C.a.click,this.A0a,Object(ta.a)(this,this.Toc,"onCollapseIconClicked"));v.a.instance.ta(C.a.click,this.xJa,Object(ta.a)(this,this.ipc,"onExpandIconClicked"));v.a.instance.ta(C.a.click,this.B0a,Object(ta.a)(this,this.Toc,"onCollapseIconClicked"));v.a.instance.ta(C.a.click,this.yJa,Object(ta.a)(this,this.ipc,"onExpandIconClicked"));
x.KeyInputManager.instance.ta(C.a.Sb,this.A0a,Object(ta.a)(this,this.$Af,"onCollapseIconKeyDown"));x.KeyInputManager.instance.ta(C.a.Sb,this.xJa,Object(ta.a)(this,this.FCf,"onExpandIconKeyDown"))}kE(ic){this.addHandler(wc.Ugb,ic);ic(this,new sb(this.isVisible,Y.DOMElementExtensions.isVisible(this.iL)))}BF(ic){this.removeHandler(wc.Ugb,ic)}get iL(){return this.gFg}get jc(){return this.iL}get Ff(){return this.mVa}set Ff(ic){this.mVa=ic}get Pz(){return this.fFg}get Xd(){return P.a.vMi}get rO(){return this.mle}get GD(){return this.Yt}get Ch(){return this.Ne}get qM(){return null}get Cga(){return null}get isCollapsed(){return this.JI}get i7c(){return this.t7d}get $(){return this.jb}set $(ic){this.jb=
ic}get Tye(){return this.I5d}get A0a(){return this.vug}get xJa(){return this.rwg}get B0a(){return this.wug}get yJa(){return this.swg}get Ypi(){return this.wNc}get R7h(){return this.configuration.jEe}get Q7h(){return this.configuration.tWe}Dsb(ic,cd,Hd,he,Lb){let Ic=ic.Aa(cd);Ic||(Ic=W.a(Kb.a,Hd,ic,cd),Ic.SetScriptLoadFlavor(Lb));he&&Ic.jXc(he);const Ob=""+cd;Ob in this.E$b||Ic.d0b((Yc,td)=>{this.g6(td)});let Kc=null;const Ac=()=>{Ic.create();Kc()};this.E$b[Ob]=Kc=()=>{Ic.Iuc(Ac);delete this.E$b[Ob]};
Ic.I_b(Ac)}dispose(){if(this.Yt)for(let cd=0,Hd=this.Yt.length;cd<Hd;cd++)this.Yt[cd].XVf(this.tCd),this.Yt[cd].dispose();const ic=this.E$b;for(let cd in ic)({key:cd,value:ic[cd]}).value();this.$.ea&&this.$.yb&&this.$.yb.sg(this.X5);this.xqb=this.I5d=this.mle=this.Ne=this.yqb=this.mfb=this.Yt=null;v.a.instance.Ba(C.a.click,this.A0a,Object(ta.a)(this,this.Toc,"onCollapseIconClicked"));v.a.instance.Ba(C.a.click,this.xJa,Object(ta.a)(this,this.ipc,"onExpandIconClicked"));v.a.instance.Ba(C.a.click,this.B0a,
Object(ta.a)(this,this.Toc,"onCollapseIconClicked"));v.a.instance.Ba(C.a.click,this.yJa,Object(ta.a)(this,this.ipc,"onExpandIconClicked"));x.KeyInputManager.instance.Ba(C.a.Sb,this.A0a,Object(ta.a)(this,this.$Af,"onCollapseIconKeyDown"));x.KeyInputManager.instance.Ba(C.a.Sb,this.xJa,Object(ta.a)(this,this.FCf,"onExpandIconKeyDown"));super.dispose()}ag(ic,cd){if(cd)return!1;this.Ne&&!this.isCollapsed?(ic=this.Ch.taskPane,ic.Ff&&ic.ag(!0,!1)||Y.DOMElementExtensions.setFocus(this.Ch.I_a)):Y.DOMElementExtensions.setFocus(this.xJa);
return!0}sh(ic){return this.isVisible?Y.DOMElementExtensions.Af(this.domElement,ic)||Y.DOMElementExtensions.Af(this.domElement,Y.DOMElementExtensions.jxb(ic)):!1}rj(){}dk(){this.Ne&&this.Ne.taskPane.dk()}setFocusOnToolbarFirstElement(){this.isCollapsed?Y.DOMElementExtensions.setFocus(this.xJa):Y.DOMElementExtensions.setFocus(this.A0a)}BRd(){for(let ic=this.Yt.length-1;0<=ic;ic--)if(this.Yt[ic].isVisible){Y.DOMElementExtensions.setFocus(this.Yt[ic].I_a);return}this.setFocusOnToolbarFirstElement()}Z4a(ic){const cd=
[];for(let Hd=this.Yt.length-1;0<=Hd;Hd--)this.Yt[Hd].taskPane.Jh===ic&&cd.push(this.Yt[Hd].taskPane);return cd}nfd(ic){const cd=[];for(let Hd=0;Hd<this.Yt.length;Hd++)this.Yt[Hd].taskPane.Jh===ic&&cd.push(this.Yt[Hd]);return cd}Qpe(ic){if(ic){let cd;const Hd=Object(k.a)(231,ic);Hd?(cd=new Wb(this.htmlSanitizationHelper),cd.domElement.id=this.baseName+"bt_"+ic.Jh.toString()+"_"+ic.$e.InstanceId,this.xqb.appendChild(cd.domElement),this.yqb["6"]=cd,Hd.button=cd):cd=this.yqb[ic.Jh.toString()];cd.Fii(ic);
cd.XLg(this.tCd);cd.isVisible=ic.Cq();cd.enabled=ic.wt();this.mfb.push(ic);this.Yt.push(cd);wc.IJi(ic,this.rO);this.Tsh(cd);this.LDc()}}hI(ic,cd){let Hd;for(const he of this.Yt)Hd=he.taskPane,Hd.Jh===ic.Jh&&Hd==ic&&this.B3b(he,cd)}Vua(){m.ULS.shipAssertTag(512291714,11,!1,"TaskPaneControl.GenerateTaskPaneData: should only be used with WAC infra.");return null}q6(){m.ULS.shipAssertTag(512291713,11,!1,"TaskPaneControl.ShowTaskPane: should only be used with WAC infra.")}j6b(){m.ULS.shipAssertTag(512291712,
11,!1,"TaskPaneControl.createTaskPaneInHidden: should only be used with WAC infra.")}updateTaskPane(){m.ULS.shipAssertTag(512291683,11,!1,"TaskPaneControl.UpdateTaskPane: should only be used with WAC infra.")}setSelectedTaskPane(){m.ULS.shipAssertTag(512291682,11,!1,"TaskPaneControl.SetSelectedTaskPane: should only be used with WAC infra.")}hideTaskPane(){m.ULS.shipAssertTag(512291681,11,!1,"TaskPaneControl.HideTaskPane: should only be used with WAC infra.")}$9f(ic,cd){ic?(this.wNc=!0,this.rSd(!1)):
(this.wNc=!1,this.rSd(!0),cd&&(this.HB(),this.$.qf()))}GQ(ic){if(!this.mfb.includes(ic)){let Hd=null;Hd=()=>{this.Nij(ic);ic.mW(Hd)};ic.qT(Hd);this.Qpe(ic);var cd=Object(k.a)(320,ic);cd&&(cd.kE(this.xz),this.xz(cd,Sys.EventArgs.Empty));if(cd=Object(k.a)(154,ic))cd.kE(this.xz),this.xz(cd,Sys.EventArgs.Empty);if(cd=Object(k.a)(265,ic))cd.kE(this.xz),this.xz(cd,Sys.EventArgs.Empty);this.raiseEvent(wc.CLf,null,ic);this.HB()}}B3b(ic,cd){if(ic.taskPane.wt()&&ic.taskPane.Cq()){if(this.Ne){this.Ne.domElement.classList.remove(wc.Bnb);
this.Ne.taskPane.isVisible=!1;if(Z.EwaSettings.isChangeGateEnabled("OfficeVSO:4961099_RangePickerOnOSF")){const Hd=Object(k.a)(231,this.Ne.taskPane);Hd&&Hd.lj.ELd(Hd.$e.InstanceId)}this.s5=this.Ne}this.Ne=ic;this.Ne.taskPane.isVisible=!0;this.Ne.domElement.classList.add(wc.Bnb);cd&&this.Jia(!1,!1);this.Cgb()}}onButtonClick(ic){let cd=!1;if(this.Ne!==ic){cd=!0;const Hd=ic.taskPane.jc;this.animationManager.y8i(Hd);if(this.Ne){if(Z.EwaSettings.isChangeGateEnabled("OfficeVSO:4961099_RangePickerOnOSF")){const he=
Object(k.a)(231,this.Ne.taskPane);he&&he.lj.ELd(he.$e.InstanceId)}this.Ne.taskPane.isVisible=!1;this.Ne.domElement.classList.remove(wc.Bnb)}this.s5=this.Ne;this.Ne=ic;this.Ne.domElement.classList.add(wc.Bnb);this.Ne.taskPane.isVisible=!0;this.Cgb();this.animationManager.kEh(Hd)}this.Jia(!(this.isCollapsed||cd),!1)}Cgb(){const ic=this.i7c;let cd=0;this.Ne&&(cd=this.Ne.taskPane.Hv?this.Ne.taskPane.Hv:this.Ne.taskPane.Vp);cd!==ic&&(this.t7d=cd,this.isCollapsed||(this.animationManager&&this.Ne?this.animationManager.L0b(this.Pz,
ic,cd,this.Ch.taskPane):this.Pz.style.width=ea.HelperMethods.sc(cd)),this.RQa(),this.raiseEvent(wc.pag,null,this))}oM(ic){const cd=new Wb(this.htmlSanitizationHelper);cd.isVisible=!1;cd.domElement.id=this.baseName+"bt_"+ic.toString();this.xqb.appendChild(cd.domElement);this.yqb[ic.toString()]=cd}LDc(){if(void 0!==this.Yt&&null!==this.Yt){void 0===this.Ne||null===this.Ne||this.Ne.taskPane.wt()||(this.Ne.domElement.classList.remove(wc.Bnb),this.Ne.taskPane.isVisible=!1,this.Ne.taskPane.Cq()&&(this.s5=
this.Ne),this.Ne=null);var ic=null;for(let cd=0;cd<this.Yt.length;cd++)if(this.mfb[cd].Cq()){const Hd=this.mfb[cd].wt();(this.Yt[cd].enabled=Hd)&&!ic&&(ic=this.Yt[cd])}void 0!==this.Ne&&null!==this.Ne||!ic||(void 0!==this.s5&&null!==this.s5&&this.s5.taskPane.wt()&&this.s5.taskPane.Cq()?this.B3b(this.s5,!1):this.B3b(ic,!1));void 0!==ya.a(this.$)&&null!==ya.a(this.$)&&ya.a(this.$).isVisible&&void 0!==this.Ne&&null!==this.Ne&&1!==this.Ne.taskPane.Jh&&(ya.a(this.$).isVisible=!1);void 0!==this.Ne&&null!==
this.Ne&&7!==this.Ne.taskPane.Jh&&(ic=this.$.da.Aa(52),null===ic||void 0===ic?0:ic.isVisible)&&(ic.isVisible=!1);void 0!==this.Ne&&null!==this.Ne&&8!==this.Ne.taskPane.Jh&&(ic=this.$.da.Aa(233))&&(ic.isVisible=!1);void 0!==this.Ne&&null!==this.Ne&&9!==this.Ne.taskPane.Jh&&(ic=this.$.da.Aa(248))&&(ic.isVisible=!1);Z.EwaSettings.ra(264)&&void 0!==this.Ne&&null!==this.Ne&&12!==this.Ne.taskPane.Jh&&(ic=this.$.da.Aa(302))&&(ic.isVisible=!1);Z.EwaSettings.ra(418)&&void 0!==this.Ne&&null!==this.Ne&&15!==
this.Ne.taskPane.Jh&&(ic=this.$.da.Aa(365))&&(ic.isVisible=!1);V.a.hud(this.$)&&void 0!==this.Ne&&null!==this.Ne&&13!==this.Ne.taskPane.Jh&&(ic=this.$.da.Aa(334))&&(ic.isVisible=!1);void 0!==this.Ne&&null!==this.Ne&&14!==this.Ne.taskPane.Jh&&(ic=this.$.da.Aa(346))&&(ic.isVisible=!1);void 0!==this.Ne&&null!==this.Ne&&16!==this.Ne.taskPane.Jh&&(ic=this.$.da.Aa(371))&&(ic.isVisible=!1);Z.EwaSettings.gjc()&&void 0!==this.Ne&&null!==this.Ne&&17!==this.Ne.taskPane.Jh&&(ic=this.$.da.Aa(408))&&(ic.isVisible=
!1);this.Cgb()}}QGh(ic,cd){Y.DOMElementExtensions.setVisible(this.B0a,!ic);Y.DOMElementExtensions.setVisible(this.yJa,ic);ic&&this.raiseEvent(wc.mEe,null,this);this.Cgb();cd&&Y.DOMElementExtensions.setFocus(ic?this.xJa:this.A0a)}wec(ic,cd){this.$.Yc(ic,cd,26,null)}g6(ic){ic.dO&&this.GQ(ic.dO)}Nij(ic){if(ic){const cd=this.Yt.length;let Hd=!1;for(let he=0;he<cd;he++){const Lb=this.Yt[he];if(Lb.taskPane===ic){this.xqb.removeChild(Lb.I_a);delete this.yqb[ic.Jh.toString()];Array.remove(this.mfb,ic);Array.remove(this.Yt,
Lb);Lb.XVf(this.tCd);Lb.taskPane.jc.parentNode.removeChild(Lb.taskPane.jc);this.Ne&&this.Ne.taskPane===Lb.taskPane&&(this.Ne=null);this.s5&&this.s5.taskPane===Lb.taskPane&&(this.s5=null);Hd=!0;break}}Hd&&this.LDc()}}Tsh(ic){const cd=ic.taskPane.Jh,Hd=!!this.Ne&&1===this.Ne.taskPane.Jh;(1===cd||!Hd&&2===cd)&&this.B3b(ic,!1)}static IJi(ic,cd){const Hd=ic.jc;Hd.parentNode&&Hd.parentNode.removeChild(Hd);cd.appendChild(Hd);ic.isVisible=!1}uHe(ic,cd,Hd,he,Lb){const Ic=document.createElement("a");Ic.setAttribute(E.a.xT,
Lb?E.a.Uj:E.a.rq);Ic.setAttribute(E.a.Cd,E.a.Qs);Ic.tabIndex=0;Ic.classList.add(Da.a.Or);Ic.classList.add(ic);Ic.classList.add(D.a.rxh);ic=String.format(wc.r4g,cd,Hd,d.a.qe(10));Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7153231_ReduceInnerHTMLUsageTaskPane")?this.htmlSanitizationHelper.Rh(Ic,ic):Ic.innerHTML=ic;he.appendChild(Ic);return Ic}}wc.Ugb="tpVisibility";wc.nRj=`<div id='{0}' class='${D.a.xxh}'><div id='{1}' class='${D.a.wxh}'></div></div>`;
wc.r4g="<img title='{0}' class='{1}' alt='{0}' src='{2}'/>";wc.LOb="novTaskpaneButtonGroup";wc.Bnb=D.a.txh;wc.pag="tpSizeChanged";wc.mEe="tpCollapsed";wc.CLf="tpAdded";Object(c.a)(wc,"TaskPaneControl",G.a,[264,54,2]);var Jc=a(49),zc=a(372),gd=a(724);class Va{constructor(){this.tWe=this.jEe=this.sWe=this.iEe=this.uWe=this.kEe=this.Hfg=this.bZd=this.WXd=this.E0=this.Tdg=null}}Object(c.a)(Va,"Configuration",null,[]);a(436);var Eb=a(297);class hc extends Eb.a{constructor(ic){super(5,ic)}}Object(c.a)(hc,
"ResizeAnimationEvent",Eb.a,[]);var Ab=a(474),Bb=a(590),ec=a(102);class Qd{constructor(ic,cd){this.Udg=null;this.$=cd;this.taskPane=ic}cEh(){this.Udg=Y.DOMElementExtensions.getElementById(this.taskPane.parentNode,this.$.Bb+E.a.xBd);const ic=Qd.H6c(this.taskPane),cd=Qd.H6c(this.Udg),Hd=Bb.a(ec.a.Pl);Hd.animate(ic,E.a.Vyc);Hd.animate(cd,E.a.Vyc)}y8i(ic){ic.style.opacity="0"}kEh(ic){Bb.a(ec.a.Pl).animate(Qd.H6c(ic),E.a.Vyc)}L0b(ic,cd,Hd,he){cd||(he.isVisible=!0);this.$.RQa(Hd);Bb.a(ec.a.Pl).animate(Qd.xgh(ic,
cd,Hd),E.a.Vyc,null,null,()=>{this.$.dAa();Hd||1===he.Jh||(he.isVisible=!1);he.IV(Hd<cd)})}static xgh(ic,cd,Hd){ic=new hc(ic);ic.qRg(cd,Hd);return ic}static H6c(ic){ic=new Ab.a(ic);ic.bJ(0,1);return ic}}Object(c.a)(Qd,"TaskPaneAnimationManager",null,[292]);const dc=`<div id="{0}" class="${D.a.Bxh}" runat="server"></div></div><div id="{1}" class="${D.a.Axh} ${D.a.jo}" runat="server"></div>`,dd=`<button type="button" id="{0}" class="${D.a.yxh}"></button><span><div id="{1}" class="${D.a.zxh}"></div></span>`,
jd=D.a.lxh;class md extends wc{constructor(ic,cd,Hd,he){super(ic,Hd,md.och(),he);this.trc=null;this.Ctd=!1;this.aS=null;this.MXi=Lb=>{var Ic=!1;if(9===Lb.Ea.keyCode){Ic=this.Ch.taskPane.TU(Lb,this.iL);if(!Ic){Ic=this.$.da.Aa(52);var Ob=this.domElement.querySelectorAll(this.Ch.taskPane===Ic?Ic.nr:zc.a.F3i);Ic=Y.DOMElementExtensions.rm(Ob);Ob=Y.DOMElementExtensions.PA(Ob);Ic=Y.DOMElementExtensions.FAa(Lb.Ea,Ic,Ob)}return Ic}Ob=ab.FocusManager.instance().Uh;if(null===Ob||void 0===Ob?0:Ob.gN)return Ic;
27===Lb.Ea.keyCode&&this.Ch.taskPane.Kg(!1);return Ic};this.dd=()=>{this.iL.style.bottom=this.Pz.style.bottom=this.$.qd&4&&!B.AFrameworkApplication.sa.Qa.df?ea.HelperMethods.sc(this.$.gea):"0";this.HB()};this.pHf=Lb=>{Object(eb.a)(231,this.Ch.taskPane)&&(this.Ch.taskPane.qGa.firstChild.style[E.a.pointerEvents]="none");this.Ctd=!0;this.aS=this.uxb(Lb.clientPoint);ma.a.instance.ta(C.a.Tf,this.domElement.ownerDocument.body,this.mqc);ma.a.instance.ta(C.a.ve,this.domElement.ownerDocument.body,this.nqc);
ha.a.instance.ta(C.a.yj,this.domElement.ownerDocument.body,this.mqc);ha.a.instance.ta(C.a.Kf,this.domElement.ownerDocument.body,this.nqc);return!0};this.nqc=()=>{Object(eb.a)(231,this.Ch.taskPane)&&(this.Ch.taskPane.qGa.firstChild.style[E.a.pointerEvents]="");this.Ctd=!1;ma.a.instance.Ba(C.a.Tf,this.domElement.ownerDocument.body,this.mqc);ma.a.instance.Ba(C.a.ve,this.domElement.ownerDocument.body,this.nqc);ha.a.instance.Ba(C.a.yj,this.domElement.ownerDocument.body,this.mqc);ha.a.instance.Ba(C.a.Kf,
this.domElement.ownerDocument.body,this.nqc);return!0};this.mqc=Lb=>{this.Ctd&&(Lb=this.uxb(Lb.clientPoint),Lb=gd.a.FD(Lb,this.aS),this.nte(Lb.x));return!0};this.RYi=Lb=>{void 0!==Lb.Ea&&null!==Lb.Ea&&(9===Lb.Ea.keyCode?Lb.Ea.shiftKey?(Lb=Object(eb.a)(54,this.Ch.taskPane)?this.Ch.taskPane:null)&&Lb.ag(!1,!1):this.setFocusOnToolbarFirstElement():37!==Lb.Ea.keyCode&&39!==Lb.Ea.keyCode||this.nte(37===Lb.Ea.keyCode?-20:20));return!0};this.$.domElement.classList.add(jd);this.Rdg=cd;this.initialize();x.KeyInputManager.instance.ta(C.a.Sb,
this.domElement,this.MXi);this.NOb=Y.DOMElementExtensions.getElementById(cd.parentNode,this.$.Bb+E.a.eoc);this.VBc=Y.DOMElementExtensions.getElementById(cd.parentNode,this.$.Bb+E.a.jyf);this.NOb.title=ra.a.instance.ga(2232);ma.a.instance.ta(C.a.pf,this.VBc,this.pHf);ha.a.instance.ta(C.a.pointerDown,this.VBc,this.pHf);x.KeyInputManager.instance.ta(C.a.Sb,this.NOb,this.RYi)}get Xd(){return P.a.QBc}get hEe(){return this.iL}get rEh(){return this.hEe}Cgb(){super.Cgb();this.NOb&&(this.Ch&&this.Ch.taskPane.isResizable?
(this.NOb.style.display="block",this.VBc.style.display="block"):(this.NOb.style.display="none",this.VBc.style.display="none"))}get GCc(){const ic=this.iL;return ic&&Y.DOMElementExtensions.isVisible(ic)?zc.a.GCc:0}PYf(ic){ic&&(this.animationManager=ic);this.Znj();this.animationManager=ic||new Qd(this.Pz,this.$);this.animationManager.cEh()}dispose(){this.trc&&this.trc.BF(this.xz);ya.a(this.$)&&ya.a(this.$).BF(this.xz);const ic=this.$.da.Aa(52);ic&&ic.BF(this.xz);this.$.pl(this.dd);h.a.pc([this.trc]);
this.trc=null;super.dispose()}initialize(){this.PYf(null);this.oM(0);this.oM(1);this.oM(2);this.oM(7);this.oM(8);this.oM(9);this.oM(10);Z.EwaSettings.ra(264)&&this.oM(12);Z.EwaSettings.ra(418)&&this.oM(15);Z.EwaSettings.isChangeGateEnabled("OfficeVSO:4458651_ExternalLinksEnableDisableRibbonButtonDuringSession")?this.oM(13):V.a.hud(this.$)&&this.oM(13);this.oM(14);this.oM(16);Z.EwaSettings.gjc()&&this.oM(17);Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPane",!1)&&this.oM(18);
this.HB()}HB(){var ic=0;let cd=0;for(let Hd=this.GD.length-1;0<=Hd;Hd--){const he=this.GD[Hd].taskPane.Cq(),Lb=this.GD[Hd].taskPane;if(this.GD[Hd].isVisible=he)cd++,(1!==Lb.Jh&&(Z.EwaSettings.isChangeGateEnabled("OfficeVSO:4465901_HideCommentsTaskPaneButtonOnClosePane")||7!==Lb.Jh)&&14!==Lb.Jh&&16!==Lb.Jh||Lb.wt())&&ic++}ic=0<ic;Y.DOMElementExtensions.setVisible(this.iL,ic);this.rSd(ic);Y.DOMElementExtensions.setVisible(this.yJa,ic&&this.isCollapsed);Y.DOMElementExtensions.setVisible(this.B0a,ic&&
!this.isCollapsed);Y.DOMElementExtensions.setVisible(this.Tye,1<cd);this.LDc()}Jia(ic,cd){if(this.isCollapsed!==ic){ic||(this.Rdg.style.display=B.AFrameworkApplication.sa.Qa.df?"flex":"block");var Hd=this.i7c;this.JI=!this.isCollapsed;var he=ic?Hd:0;Hd=ic?0:Hd;this.Ch&&(this.animationManager.L0b(this.Pz,he,Hd,this.Ch.taskPane),this.RQa());ic&&(this.Rdg.style.display="none");this.QGh(ic,cd)}}rSd(ic){const cd=this.isVisible!==ic;this.Ff=ic;Y.DOMElementExtensions.setVisible(this.domElement,ic);cd&&(B.AFrameworkApplication.sa.Qa.df&&
Y.DOMElementExtensions.toggleCssClass(this.domElement,D.a.axh,ic),this.RQa(),this.raiseEvent(wc.Ugb,new sb(ic,ic),this))}Toc(ic){if(ic.Mb===this.B0a&&3!==ic.vb)return!1;this.wec(296943390,ic.vb);this.Jia(!0,!0);return!0}ipc(ic){if(ic.Mb===this.yJa&&3!==ic.vb)return!1;this.wec(-625072140,ic.vb);this.Jia(!1,!0);return!0}$Af(ic){return 13===ic.Ea.keyCode?(this.wec(296943390,ic.vb),this.Jia(!0,!0),!0):!1}FCf(ic){return 13===ic.Ea.keyCode?(this.wec(-625072140,ic.vb),this.Jia(!1,!0),!0):!1}RQa(){let ic=
0;this.$.qd&262144&&(ic+=this.GCc,Y.DOMElementExtensions.isVisible(this.Pz)&&!this.isCollapsed&&(ic+=this.i7c));this.$.RQa(ic)}dIe(ic,cd){const Hd=document.createElement("div");Hd.classList.add(ic);cd.insertBefore(Hd,cd.firstChild);return Hd}Znj(){const ic=this.domElement;let cd=document.getElementById(this.$.Bb+E.a.u0a);B.AFrameworkApplication.sa.Qa.df&&(cd=document.getElementById("FarPaneRegion"));ic.parentNode&&ic.parentNode!==cd&&ic.parentNode.removeChild(ic);cd.appendChild(ic);this.Eai()}Eai(){const ic=
this.Pz,cd=this.iL,Hd=this.$.ea;ic.style.right="0";B.AFrameworkApplication.sa.Qa.df||(ic.style.marginRight=ea.HelperMethods.sc(zc.a.GCc));ic.style.bottom=this.$.qd&4&&!B.AFrameworkApplication.sa.Qa.df?ea.HelperMethods.sc(this.$.gea):"0";this.rO.style.bottom="0";cd.style.right="0";this.$.Lk(this.dd);Hd.zH&&this.dd(null,null)}uxb(ic){const cd=new Jc.a(0,0);return gd.a.Gu(cd,this.Pz,ic,!1)}nte(ic){const cd=this.Pz.offsetWidth;ic=cd-ic;ic<this.Ch.taskPane.Vp?ic=this.Ch.taskPane.Vp:950<ic&&(ic=950);this.Ch.taskPane.Hv=
ic;const Hd=new Qd(this.Pz,this.$);Hd.L0b(this.Pz,cd,ic,this.Ch.taskPane);Object(eb.a)(231,this.Ch.taskPane)||Hd.L0b(this.Ch.taskPane.jc,cd,ic,this.Ch.taskPane);this.$.RQa(this.iL.offsetWidth+ic);this.$.Aza(ub.a.qZ("AnimateTaskpaneResize"))}static ka(ic,cd){let Hd=null;ic.Jb&&(Hd=ic.Jb.zg("ComponentAttach","AttachTaskPanePickerControl"),Hd.start());const he=md.MZg(ic.Bb),Lb=md.LZg(ic.Bb,cd),Ic=md.NZg(ic.Bb);he.appendChild(Ic);he.appendChild(Lb);md.tUg(ic,he);ic=new md(he,Lb,ic,cd);Hd&&Hd.stop();return ic}static MZg(ic){const cd=
document.createElement("div");cd.id=ic+E.a.RBc;return cd}static LZg(ic,cd){const Hd=document.createElement("div");Hd.id=ic+E.a.iyf;Hd.className=D.a.mxh;let he=String.format(dc,ic+E.a.tMi,ic+E.a.AV);he+=String.format(dd,ic+E.a.eoc,ic+E.a.jyf);Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7153231_ReduceInnerHTMLUsageTaskPane")?cd.Rh(Hd,he):Hd.innerHTML=he;B.AFrameworkApplication.sa.Qa.df&&Y.DOMElementExtensions.toggleCssClass(Hd,
D.a.Mza,!0);return Hd}static NZg(ic){const cd=document.createElement("div");cd.id=ic+E.a.xBd;cd.className=D.a.kzh;cd.style.zIndex="100";B.AFrameworkApplication.sa.Qa.df&&Y.DOMElementExtensions.toggleCssClass(cd,D.a.Mza,!0);return cd}static tUg(ic,cd){(B.AFrameworkApplication.sa.Qa.df?document.getElementById("FarPaneRegion"):document.getElementById(ic.Bb+E.a.u0a)).appendChild(cd)}static och(){const ic=new Va;ic.Tdg=E.a.RBc;ic.E0=E.a.iyf;ic.WXd=E.a.AV;ic.bZd=E.a.xBd;ic.Hfg=E.a.uMi;ic.kEe=D.a.oxh;ic.uWe=
D.a.qxh;ic.iEe=D.a.nxh;ic.sWe=D.a.pxh;ic.jEe=D.a.bVe;ic.tWe=D.a.cVe;return ic}}Object(c.a)(md,"TaskPanePickerControl",wc,[]);var vd=a(712);class wd extends t.a{constructor(ic){super();this.$=ic;this.Db()}create(){if(V.a.Ad(this.$))this.AKd(()=>Wa.ka(this.$));else if(Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7153231_ReduceInnerHTMLUsageTaskPane")){const ic=mb.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Xa);z.TaskExtensions.za(ic,
()=>{this.AKd(()=>md.ka(this.$,ic.result))},this.la,3)}else this.AKd(()=>md.ka(this.$,null))}static ka(ic){ic.da.Ha(50,new wd(ic))}AKd(ic){Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7377510_InitializingTPSlicePI")?(ic=Object(vd.a)(this.$.da,183,ic),this.nb(ic)):this.nb(ic())}}Object(c.a)(wd,"TaskPaneManagerFactory",t.a,[]);class Pd extends e.a{constructor(ic){super(ic);this.yt=()=>{this.$.ea.RN(this.yt);this.lJe()};this.$=ic}lJe(){const ic=this.$.da;ic.Ha(72,new Na(this.$));ic.Ha(77,new nb(this.$));
wd.ka(this.$);Ga.ka(this.$)}static main(){f.a.Fa(ic=>{b.a.Sdf(ic.domElement.ownerDocument,d.a.current.qo(96),()=>{ic.bI()});const cd=new Pd(ic);ic.ea.rv?cd.lJe():ic.ea.hP(cd.yt)})}}Object(c.a)(Pd,"TaskPaneSliceBootstrapper",e.a,[]);Type.registerNamespace("_Ewa");Pd.main();Type.registerNamespace("CommandUI.TaskPane")}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.tp.js.map/e25d17a18e08b013d87443cb6424d3a4/EwaDSEsNext.tp.js.map
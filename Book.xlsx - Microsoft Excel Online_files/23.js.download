(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[23],{547:function(e,t,n){"use strict";n.d(t,"e",function(){return y});var r=n(108),i=(function(){function e(e){this._scope=new r.e;this._targetMap=new WeakMap;this._disposableMap=new WeakMap}e.prototype.on=function(e,t,n){var r;if(s(e))r=e;else{var i=this._targetMap.get(e);if(i)r=i;else{r=new EventTarget;this._targetMap.set(e,r)}}r.addEventListener(t,n);var o=this._disposableMap.get(e);if(!o){o=new Map;this._disposableMap.set(e,o)}var u=this._scope.attach({dispose:function(){r.removeEventListener(t,n)}});o.set(t,u)};e.prototype.off=function(e,t,n){var r;if(s(e))r=e;else{var i=this._targetMap.get(e);i&&(r=i)}var o=this._disposableMap.get(e);if(o){var u=o.get(t);if(u){u.dispose();o.delete(t)}0===o.size&&this._disposableMap.delete(e)}r&&r.removeEventListener(t,n)};e.prototype.dispose=function(){this._scope.dispose()};return e})();function s(e){return!!e.addEventListener}var o=(function(){function e(e){this._scope=new r.e;this._timeoutMap=new Map}e.prototype.setTimeout=function(e,t){var n=this,r=setTimeout(function(){n._timeoutMap.delete(r);e()},t),i=this._scope.attach({dispose:function(){clearTimeout(r)}});this._timeoutMap.set(r,i);return r};e.prototype.clearTimeout=function(e){var t=this._timeoutMap.get(e);if(t){this._timeoutMap.delete(e);t.dispose()}};e.prototype.dispose=function(){this._scope.dispose()};return e})(),u="unsupportedCommand",a="handlerError",f="handlerRejection",l="acknowledgeTimeout",c="resultTimeout",h="setupTimeout",p="canceled",d="disposed",v=0,m=(function(){function e(e,t){void 0===t&&(t={});var n=this,s=new Map,l={onCommand:e.onCommand,onNotification:e.onNotification},c=e.initResources,d=e.initTimeoutMs,v=void 0===d?1e4:d,m=e.ackTimeoutMs,g=void 0===m?1e3:m,y=e.resultTimeoutMs,b=void 0===y?1e4:y,w=t.asyncType,E=void 0===w?o:w,S=t.eventGroupType,x=void 0===S?i:S,T=this._scope=new r.e;T.attach(c);var N,C=this._async=T.attach(new E(this)),k=T.attach(new x(this));this._ackTimeoutMs=g;this._resultTimeoutMs=b;this._invokeCommandHandler=function(e){try{var t=l.onCommand&&l.onCommand(e);return t?Promise.resolve(t).catch(function(e){return{result:"error",error:{code:(e=e||{name:f,isExpected:!1,message:"Unknown error"}).code||e.name||f,message:e.message||"".concat(e)},isExpected:!!e.isExpected}}):Promise.resolve({result:"error",error:{code:u,message:e.command},isExpected:!0})}catch(e){return Promise.resolve({result:"error",isExpected:!1,error:{code:a,message:e&&"Name: ".concat(e.name,"; Message: ").concat(e.message||e)}})}};this._invokeNotificationHandler=function(e){try{l.onNotification&&l.onNotification(e)}catch(e){}};var L=this._port=new Promise(function(t,r){T.attach({dispose:function(){var e=new Error("Initialization canceled.");e.code=p;r(e)}});N=C.setTimeout(function(){var e=new Error("Initialization timed out after ".concat(v,"ms"));e.code=h;r(e)},v);e.init(function(e){C.clearTimeout(N);T.attach({dispose:function(){e.close()}});k.on(e,"message",function(t){var r=t.data;if(r&&"object"==typeof r)return"acknowledge"===r.type?n._onAcknowledge(r):"command"===r.type?n._onCommand(e,r):"notification"===r.type?n._onNotification(r):"result"===r.type?n._onResult(r):void 0});e.start();t(e)},r)});this.ready=L.then(function(){},function(e){n.dispose();return Promise.reject(e)});this._signals=s}e.prototype.dispose=function(){this._scope.dispose();this._signals.forEach(function(e){e.resolve({result:"error",isExpected:!0,error:{code:p,message:"Messenger disposed"}})});this._signals.clear()};e.prototype.sendCommand=function(e,t){var n=this;void 0===t&&(t={});if(this._scope.isDisposed)return Promise.resolve({result:"error",isExpected:!1,error:{code:d,message:"disposed"}});var r=++v,i=t.timeoutDelayMs,s=void 0===i?this._resultTimeoutMs:i,o=t.acknowledgeTimeoutMs,u=void 0===o?this._ackTimeoutMs:o;return this._port.then(function(t){var i=n._async,o=new Promise(function(e){n._signals.set(r,{acknowledgeTimeout:i.setTimeout(function(){n._onResult(g(r,l))},u),resultTimeout:i.setTimeout(function(){n._onResult(g(r,c))},s),resolve:e})});t.postMessage({type:"command",id:r,data:e});return o})};e.prototype.sendNotification=function(e){this._scope.isDisposed||this._port.then(function(t){t.postMessage({type:"notification",data:e})})};e.prototype._onAcknowledge=function(e){var t=this._signals.get(e.id);t&&this._async.clearTimeout(t.acknowledgeTimeout)};e.prototype._onCommand=function(e,t){var n=t.id;e.postMessage({type:"acknowledge",id:n});this._invokeCommandHandler(t.data).then(function(t){e.postMessage({type:"result",data:t,id:n})}).catch(function(e){})};e.prototype._onNotification=function(e){this._invokeNotificationHandler(e.data)};e.prototype._onResult=function(e){var t=e.id,n=this._async,r=this._signals,i=r.get(t);if(i){n.clearTimeout(i.acknowledgeTimeout);n.clearTimeout(i.resultTimeout);i.resolve(e.data)}r.delete(t)};return e})();function g(e,t){return{id:e,data:{result:"error",error:{code:t,message:"Timed out"},isExpected:!1}}}function y(e,t){void 0===t&&(t={});var n=e.channelId,s=e.onReinitialize,o=e.origin,u=e.receiver,a=void 0===u?window:u,f=e.source,l=e.identifyParent,c=t.eventGroupType,h=void 0===c?i:c,p=t.messengerType,d=void 0===p?m:p,v=new r.e,g=v.attach(new h(null));return new d({onCommand:e.onCommand,onNotification:e.onNotification,init:function(e,t){var r;if(l&&f){var i=setInterval(function(){var e={type:"identify-parent",channelId:n};f.postMessage(e,o)},100);r=v.attach({dispose:function(){clearInterval(i)}})}var u=!1;g.on(a,"message",function(t){var i=t.data;if(t.origin===o&&(!f||t.source===f)&&i&&"object"==typeof i&&"initialize"===i.type&&i.channelId===n){r&&r.dispose();if(s){if(u){s();g.dispose();return}u=!0}else g.dispose();var a=i.replyTo;a.postMessage({type:"activate"});e(a)}})},initResources:v,initTimeoutMs:e.initTimeoutMs,ackTimeoutMs:e.ackTimeoutMs,resultTimeoutMs:e.resultTimeoutMs})}},552:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n(547),s=n(26),o=(function(){function e(){this._commandHandlers=[];this._notificationHandlers=[]}Object.defineProperty(e.prototype,"ready",{get:function(){return this._messenger.ready},enumerable:!1,configurable:!0});e.prototype.sendCommand=function(e,t){return this._messenger.sendCommand(e,t)};e.prototype.sendNotification=function(e){return this._messenger.sendNotification(e)};e.prototype.addCommandHandler=function(e){var t=this;this._commandHandlers.push(e);return{dispose:function(){var n=t._commandHandlers.indexOf(e);n>-1&&t._commandHandlers.splice(n,1)}}};e.prototype.addNotificationHandler=function(e){var t=this;this._notificationHandlers.push(e);return{dispose:function(){var n=t._notificationHandlers.indexOf(e);n>-1&&t._notificationHandlers.splice(n,1)}}};e.prototype.dispose=function(){this._messenger.dispose()};e.prototype._onCommand=function(e){for(var t=0,n=this._commandHandlers;t<n.length;t++){var r=(0,n[t])(e);if(r)return r}};e.prototype._onNotificiation=function(e){for(var t=0,n=this._notificationHandlers;t<n.length;t++){(0,n[t])(e)}};return e})(),u=(function(e){Object(r.r)(t,e);function t(t){var n=this,s=t.initTimeoutMs,o=void 0===s?4e4:s,u=Object(r.s)(t,["initTimeoutMs"]);(n=e.call(this)||this)._customerPromiseLogger=u.customerPromiseLogger;n._messenger=Object(i.e)(Object(r.e)(Object(r.e)({},u),{initTimeoutMs:o,identifyParent:!0,onCommand:n._onCommand.bind(n),onNotification:n._onNotificiation.bind(n)}));return n}t.prototype.sendShareDestruct=function(){var e={command:"shareCommand",name:"share_destruct"};return this._send(e)};t.prototype.sendShareRevisible=function(e){e.command="shareCommand";return this._send(e)};t.prototype.sendSharingContextInformation=function(e){var t={command:"shareCommand",name:"share_postContextInformation",data:e};return this._send(t)};t.prototype.sendNewToken=function(e,t,n){var r={command:"shareCommand",name:"share_newToken"};if(e)r.token=e;else if(t){r.error=t;r.errorDetails=n}return this._send(r)};t.prototype.sendDocumentInformation=function(e){var t={command:"shareCommand",name:"share_documentInformation",data:{documentInformation:e}};return this._send(t)};t.prototype._send=function(e){var t=this;0;return this._messenger.sendCommand(e).then(function(e){return!!e}).catch(function(n){var r;null===(r=t._customerPromiseLogger)||void 0===r||r.end({resultType:s.e.Failure,errorCode:"SharingHostMessenger - send ".concat(e.name," failed"),extraData:{errorMessage:n.toString()}});return!1})};return t})(o)},614:function(e,t,n){"use strict";n.r(t);n.d(t,"ShareDialog",function(){return O});var r=n(0),i=n(1),s=n(530),o=n(574),u=n(546),a=n(62),f=n(548),l=n(307);Object(l.e)([{rawString:".sharingContents_0e69564b{display:flex;min-height:130px;min-width:320px;justify-content:center;align-items:center}.sharingContents_0e69564b.fullScreen_0e69564b{width:100%!important;height:100%!important}.sharingContents_0e69564b iframe{border:none;width:0}.errorContainer_0e69564b{padding:20px;max-width:280px;font-size:14px}.errorCode_0e69564b{margin-top:30px;font-size:12px;color:#605e5c;display:block}.spinner_0e69564b{position:absolute;top:50%;left:50%}"}]);var c=n(572),h=n(199),p=n(84),d=n(552),v=n(144),m=n(17),g=n(361),y=n(26),b=m.t.isActivated("45a2c5f9-21b8-4775-9e30-4e61d1f67106","02/02/2022","use new share Messenger for cross window communication")||v.e.isFeatureEnabled({ECS:1000619}),w=m.e.isActivated("FBB80417-B626-42B0-9DF6-872E93DD94F6","11/11/2022","ODC Share Fullscreen"),E={sharingInformation:void 0,isSharingDialogLoaded:!1,didSharingHappen:!1,iframeSource:"#",iframeHeight:0,error:void 0,isWindowEventReceived:!1},S=(function(e){Object(r.r)(t,e);function t(t){var n=e.call(this,t)||this;n._channelId=p.e.generate();n._setElementRef=function(e){n._iframeRef=e;if(!b&&(null==e?void 0:e.contentWindow)&&!n._sharingHostMessenger&&!n.state.isWindowEventReceived){n._sharingHostMessenger=n._createSharingHostMessenger(e.contentWindow);n.props.setSharingHostMessenger&&n.props.setSharingHostMessenger(n._sharingHostMessenger)}n.props.setElementRef&&n.props.setElementRef(e)};n._onClose=function(){var e=n.state.error;n.state.didSharingHappen?n.props.resolve():e?n.props.reject(e):n.props.reject(new a.e);n.setState({error:void 0,isSharingDialogLoaded:!1})};n._listenForMessages=function(e){var t;try{t=JSON.parse(e.data)}catch(e){return}var r=t.name;if(r===f.e.ScriptLoaded)n.setState({isWindowEventReceived:!0});else if(r===f.e.Resize&&t.height)n.setState({iframeHeight:t.height});else if(r===f.e.Ready){n.setState({isSharingDialogLoaded:!0});n.props.onShareReady()}else if(r===f.e.Error)t.error?n.setState({error:t.error}):n.setState({error:{name:"ShareError",message:c.t}});else if(r===f.e.ShareCompleted)n.setState({didSharingHappen:!0});else if(r===f.e.Dismiss){if(n._sharePrefetchRef&&n._sharePrefetchRef.current){n._sharePrefetchRef.current.tabIndex=1;n._sharePrefetchRef.current.focus()}n._onClose();n.props.onModalClose()}else if(r===f.e.ManageAccessClicked){var i=n.props.openManageAccess;if(i){i();n._onClose()}}else if(r===f.e.GrantAccessCompleted)n.props.onGrantAccessCompleted(t);else if(r===f.e.ReadyForRecipients)n.props.onReadyForRecipients();else if(r===f.e.InstantLoadReady){n.setState({isSharingDialogLoaded:!0});n.props.onShareReady()}};n._getSharingInformation=function(){return Object(r.t)(n,void 0,void 0,function(){var e,t;return Object(r.i)(this,function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);return[4,this.props.getSharingInformation()];case 1:if(!(e=n.sent()))throw new Error("Failed to get sharing information");this.setState({sharingInformation:e});return[3,3];case 2:t=n.sent();this.props.reject(t);return[3,3];case 3:return[2]}})})};n._update=function(e){var t,r,i=n.state.sharingInformation;if(i&&!e.sharingInformation){var s=i.authToken,o=i.webAbsoluteUrl,u=i.serverRelativeItemUrl,a=i.listUrl,f=i.cookieAuthIframeUrl,l=i.uniqueId,c=i.listId,p=i.cookieAuthIframeUrlForCrossDomain,d=n.props,v=d.initializeShareFrame,m=d.defaultRecipients,g=d.openManageAccess,y=void 0;switch(n.props.mode){case 2:y="&mode=copy";break;case 5:y="&mode=manageAccess";break;case 7:y="&mode=addPeople";break;case 3:y="&mode=atMention";break;default:y=""}var b="";n.props.fullScreenMode&&(b+="&fullScreenMode=true");n.props.itemName&&(b+="&itemName=".concat(encodeURIComponent(n.props.itemName)));var E=null===(r=(t=n.props).getNav)||void 0===r?void 0:r.call(t);E&&(b+="&nav=".concat(encodeURIComponent(E)));var S=w?o&&u&&a||l&&c:o&&u&&a||l&&c||i.itemId;if(s&&S&&v){p&&(i.cookieAuthIframeUrlForCrossDomain="".concat(p).concat(y).concat(b));var x=n.props;v({parentElement:n._sharePrefetchRef.current,sharingInformation:i,calloutProps:x,onReady:function(){n.setState({isSharingDialogLoaded:!0})},onDismiss:n.props.onModalClose,onError:function(e){n.setState({error:e})}})}else if(f){var T="".concat(f).concat(y).concat(m&&m.length>0?"&defaultRecipients=".concat(encodeURI(m.join(","))):"","&ma=").concat(g?1:0).concat(b,"&channelId=").concat(n._channelId,"&origin=").concat(encodeURIComponent(new h.e(f).authority));0;n.setState({iframeSource:T})}else n.props.reject(new Error("Missing sharing information"))}};n.state=Object(r.e)(Object(r.e)({},E),{iframeHeight:n.props.iframeInitialHeight||0});n._sharePrefetchRef=i.createRef();n._shareCustomerPromiseLogger=new g.e({scenario:"SharingIframe.load",perfGoalInMs:3e4});return n}t.prototype.UNSAFE_componentWillMount=function(){this._getSharingInformation()};t.prototype.componentDidMount=function(){window.addEventListener("message",this._listenForMessages,!1);try{this._update(E)}catch(e){this._shareCustomerPromiseLogger.end({resultType:y.e.Failure,errorCode:"sharingIframeUpdateError",extraData:{clientId:this.props.getClientId(),mode:this.props.mode,errorDetail:e.toString()}})}};t.prototype.componentDidCatch=function(e,t){this._shareCustomerPromiseLogger.end({resultType:y.e.Failure,errorCode:"sharingIframeUpdateError",extraData:{clientId:this.props.getClientId(),mode:this.props.mode,errorInfo:t,errorDetail:e.toString()}})};t.prototype.componentWillUnmount=function(){this._onClose();window.removeEventListener("message",this._listenForMessages,!1)};t.prototype.componentDidUpdate=function(e,t){this._update(t)};t.prototype.render=function(){var e,t,n,r=this.state,s=r.isSharingDialogLoaded,a=r.iframeSource,f=r.iframeHeight,l=r.error,h=l,p=h&&h.resultCode&&h.resultCode.indexOf("ShareDomainNotReachable")>=0?i.createElement("div",{className:"".concat("errorContainer_0e69564b")},i.createElement("span",null,c.t),i.createElement("span",{className:"".concat("errorCode_0e69564b")},"(",h.resultCode,")")):null,d=2===this.props.mode?120:475,v=null===(t=null===(e=this._sharePrefetchRef.current)||void 0===e?void 0:e.parentElement)||void 0===t?void 0:t.style.maxHeight,m=v?parseInt(v,10):0;n=f?m?m>f?f:m:f:d;return i.createElement("div",{className:"".concat("sharingContents_0e69564b","\n        ").concat(this.props.fullScreenMode?"fullScreen_0e69564b":""),ref:this._sharePrefetchRef,style:{height:"".concat(n,"px")}},!s&&!l&&i.createElement(o.e,{className:"spinner_0e69564b",size:u.e.large}),p,"#"===a?null:i.createElement("iframe",{id:"shareFrame",name:"shareFrame",title:c.e,src:a,style:{visibility:s?"visible":"hidden",width:"100%",height:"100%"},ref:this._setElementRef}))};t.prototype._createSharingHostMessenger=function(e){var t=this;this._clientOrigin=new h.e(this.state.iframeSource).authority;var n=new d.e({origin:this._clientOrigin,channelId:this._channelId,source:e,customerPromiseLogger:this._shareCustomerPromiseLogger});n.addCommandHandler(function(e){try{0;switch(e.name){case f.e.ScriptLoaded:break;case f.e.Ready:t.setState({isSharingDialogLoaded:!0});t._shareCustomerPromiseLogger.end({resultType:y.e.Success});t.props.onShareReady();break;case f.e.Error:e.error?t.setState({error:e.error}):t.setState({error:{name:"ShareError",message:c.t}});break;case f.e.ShareCompleted:t.setState({didSharingHappen:!0});break;case f.e.Dismiss:if(t._sharePrefetchRef&&t._sharePrefetchRef.current){t._sharePrefetchRef.current.tabIndex=1;t._sharePrefetchRef.current.focus()}t._onClose();t.props.onModalClose();break;case f.e.ManageAccessClicked:if(t.props.openManageAccess){t.props.openManageAccess();t._onClose()}break;case f.e.GrantAccessCompleted:t.props.onGrantAccessCompleted(e);break;case f.e.ReadyForRecipients:t.props.onReadyForRecipients();break;case f.e.InstantLoadReady:t.setState({isSharingDialogLoaded:!0});t.props.onShareReady()}return{result:"success"}}catch(e){t._shareCustomerPromiseLogger.end({resultType:y.e.Failure,errorCode:"sharingIframeUpdateError",extraData:{clientId:t.props.getClientId(),mode:t.props.mode,error:e.toString()}})}});return n};return t})(i.PureComponent),x=n(45),T=n(379),N=(n(207),T.e.isFeatureEnabled({ODB:60149})),C=null;function k(){C=null}var L={isOpen:!0,isVisible:!0},A=v.e.isFeatureEnabled({ODB:60577}),O=(function(e){Object(r.r)(t,e);function t(t){var n=e.call(this,t)||this;n.makeVisibleAgain=function(e){n.setState({isVisible:!0});e?n._sharingHostMessenger?n._sharingHostMessenger.sendShareRevisible(e):n._target&&n._target.postMessage(JSON.stringify(e),"*"):k()};n._setSharingHostMessenger=function(e){n._sharingHostMessenger=e||null;n.props.setSharingHostMessenger&&n.props.setSharingHostMessenger(e)};n._setTopElementRef=function(e){if(e){n._iframe=e;n._target=n._iframe.contentWindow}else{n._target=null;n._iframe=e}n.props.setElementRef&&n.props.setElementRef(e)};n._onClose=function(){if(N){n.setState({isVisible:!1});var e={name:f.e.Destruct};n._sharingHostMessenger?n._sharingHostMessenger.sendShareDestruct():n._target&&n._target.postMessage(JSON.stringify(e),"*")}else n.setState({isOpen:!1});n._setQosResult(y.e.ExpectedFailure,"Dialog Canceled")};n._onShareReady=function(){n.props.onShareReady&&n.props.onShareReady();n._setQosResult(y.e.Success,"ShareDialogLoaded")};n._renderFullScreenShareIframe=function(){var e=n.props,t=e.sharingIFrameAs,o=void 0===t?S:t,u=Object(r.s)(e,["sharingIFrameAs"]);u.fullScreenMode=!0;return i.createElement(s.e,{className:"sharingModal",onDismiss:n._onClose,isOpen:!!n.state.isOpen,styles:{root:{display:N&&!n.state.isVisible?"none":"unset"},main:{backgroundColor:"transparent",boxShadow:"none",position:"absolute",top:0,left:0,height:"100% !important",width:"100% !important",maxHeight:"unset",maxWidth:"unset",overflow:"hidden"},scrollableContent:{width:"100% !important",height:"100% !important",maxHeight:"unset",maxWidth:"unset",overflow:"hidden"}}},i.createElement(o,Object(r.e)({},u,{onModalClose:n._onClose.bind(n),onShareReady:n._onShareReady.bind(n),setElementRef:n._setTopElementRef,setSharingHostMessenger:n._setSharingHostMessenger})))};n.state=L;n._initQos();return n}t.prototype.componentDidMount=function(){e=this.makeVisibleAgain,N&&!C&&(C=e);var e};t.prototype.componentWillUnmount=function(){k()};t.prototype.render=function(){var e;if(A||this.props.iFrameFullScreenOverride)return this._renderFullScreenShareIframe();if(null===(e=this.state)||void 0===e?void 0:e.isOpen){var t=this.props,n=t.sharingIFrameAs,o=void 0===n?S:n,u=Object(r.s)(t,["sharingIFrameAs"]);return i.createElement(s.e,{onDismiss:this._onClose,isOpen:!!this.state.isOpen,styles:{main:{maxWidth:"unset",maxHeight:"unset",minHeight:"unset"},scrollableContent:{overflow:"hidden"}}},i.createElement(o,Object(r.e)({},u,{onModalClose:this._onClose.bind(this),onShareReady:this._onShareReady.bind(this),setElementRef:this._setTopElementRef,setSharingHostMessenger:this._setSharingHostMessenger})))}return null};t.prototype._initQos=function(){this._qos=new x.e({name:"LoadShareDialog",extraData:{clientId:this.props.getClientId()}});var e={name:"LoadShareDialog",resultType:y.e.Failure,resultCode:"Dialog not loaded in time"};this._qos.setTimeout(1e4,e)};t.prototype._setQosResult=function(e,t,n){if(this._qos){this._qos.end({resultType:e,resultCode:t,error:n});this._qos=null}};return t})(i.PureComponent)}}]);
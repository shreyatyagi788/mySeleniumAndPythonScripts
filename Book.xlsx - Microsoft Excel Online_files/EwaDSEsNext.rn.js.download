'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[29],{1168:function(r,F,a){r=a(0);var c=a(85),b=a(552),e=a(15),f=a(135);class d{constructor(Ba,Ra,qa){this.TUd=this.UUd=this.VUd=!1;this.jVd=!Ba&&!Ra;this.kVd=!Ba&&!qa;this.jVd||this.kVd||(this.VUd=!Ba,this.UUd=!Ra,this.TUd=!qa)}}Object(r.a)(d,"RenameDisabledDialogInfo",null,[]);class h extends f.StandardDialog{constructor(Ba,Ra,qa,La,Yb){super();this.mYd=[];this.x1=new d(Ba,Ra,qa);this.Era=La;this.wqa=Yb;this.pe=
"RenameDisabledDialog";this.Ob=0;this.tc(1,CommonUIStrings.l_DialogClose);this.lCj();this.mmj()}lCj(){this.x1.jVd?this.ENb(this.Era?this.wqa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.x1.kVd?this.ENb(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.AJg();this.Pra(this.mYd)}ENb(Ba){Array.add(this.mYd,Ba)}AJg(){const Ba=[];this.x1.VUd||Array.add(Ba,CommonUIStrings.l_RenameFileRenameDisabledSignIn);
this.x1.UUd||Array.add(Ba,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.x1.TUd||Array.add(Ba,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<Ba.length&&Array.add(this.mYd,Ba)}}Object(r.a)(h,"ReactRenameDisabledDialogBase",f.StandardDialog,[]);class l extends h{constructor(Ba,Ra,qa,La,Yb){super(Ba,Ra,qa,La,Yb)}mmj(){this.EEb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}Object(r.a)(l,"ReactRenameDisabledDialog",h,[]);var k=a(150);class t{static get og(){return k.a.zq(t.Ll,
CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}t.Ll="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(r.a)(t,"RenameDisabledDialogHtml",null,[]);class n extends k.a{constructor(Ba,Ra,qa,La,Yb){super();this.x1=new d(Ba,Ra,qa);this.Era=La;this.wqa=Yb;this.pe="RenameDisabledDialog";this.Ob=0;this.tc(1,CommonUIStrings.l_DialogClose);this.og=t.og;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.EW("RenameRow")}z$a(){if(this.x1.jVd){let Ba;Ba=this.Era?this.wqa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;n.ENb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),Ba)}else this.x1.kVd?n.ENb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.Yci()}Yci(){this.x1.VUd&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.x1.UUd&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.x1.TUd&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static ENb(Ba,Ra,qa){Ba.style.display="none";Ra.innerText=qa}}Object(r.a)(n,"RenameDisabledDialog",k.a,[]);var z=a(4),w=a(30),m=a(108),u=a(25);class y{constructor(Ba,Ra){this.tEa=0;this.Ma=Ba;this.q8=Ra}initialize(Ba){if(!this.Ma||!this.q8)return!1;this.tEa=Ba;this.Ag();return!0}Ag(){this.Ma.Nb(u.a.Mha,m.a.frame,Object(c.a)(this,this.Mha,"commitNewDocumentTitle"))}Mha(Ba,Ra,qa,La,Yb){if(1===qa)return this.Ma.processAction(u.a.renameFile,
1);Ba=w.a.Lp(this.q8.fn);Yb=(0,Yb.getNewDocumentTitle)();Yb.length>this.tEa&&(Yb=Yb.substr(0,this.tEa));if(32!==this.Ma.Vd(u.a.renameFile,2,Yb))return this.ZW(Ba),8;this.ZW(Yb);return 32}ZW(Ba){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(Ba))}static ohd(){return new y(z.AFrameworkApplication.rb,z.AFrameworkApplication.om)}}Object(r.a)(y,"ReactRenameUIHandler",null,[312]);var v=a(91),C=a(521),x=a(554),B=a(14),H=a(110),I=a(240),U=a(88),S=a(40),G=a(27),D=a(83);class E{constructor(Ba,
Ra,qa,La,Yb,mc,Zb,qb,Ha,Ya,Gb,Ja){this._initialized=!1;this._element=null;this.tEa=0;this.TSc=this.uMc=!1;this.Ma=Ba;this.NHc=Ra;this.Yd=qa;this.gA=La;this.q8=Yb;this.Zie=mc;this.DXb=Zb;this.HIc=qb;this.D8=Ha;this.Dbe=Ya;this.zWa=Gb;this.pNc=Ja}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(Ba,Ra,qa){if(!(this.Ma&&this.q8&&this.Zie&&this.DXb&&this.HIc&&Ra)||0>=Ba)return!1;this._element=Ra;this._element.title=qa;this._element.setAttribute(U.a.Cd,U.a.Qs);this._element.setAttribute("Unselectable",
"on");this.tEa=Ba;this.Et();return this._initialized=!0}Et(){this.NHc&&(this.NHc.ta(B.a.blur,this._element,Object(c.a)(this,this.onBlur,"onBlur")),this.NHc.ta(B.a.paste,this._element,Object(c.a)(this,this.onPaste,"onPaste")));this.Yd.ta(B.a.Sb,this._element,Object(c.a)(this,this.onKeyDown,"onKeyDown"));this.gA.ta(B.a.pointerDown,this._element,Object(c.a)(this,this.onPointerDown,"onPointerDown"));this.gA.ta(B.a.Kf,this._element,Object(c.a)(this,this.Wg,"onPointerUp"))}onBlur(){this.isActive&&!this.uMc&&
(this.Dbe||this.HIc(this._element),this.UEe(),this.R7c(!1));return this.uMc=!1}onPaste(){e.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(Ba){return this.isActive?this.aWi(Ba):this.bWi(Ba)}aWi(Ba){let Ra=!1;switch(Ba.Ea.keyCode){case Sys.UI.Key.enter:this.UEe();this.R7c(this.zWa||this.pNc);Ra=!0;break;case Sys.UI.Key.tab:this.Dbe&&this.HIc(this._element);break;case Sys.UI.Key.esc:this.pOd(),this.R7c(this.zWa||this.pNc),Ra=!0}return Ra}bWi(Ba){let Ra=
!1;switch(Ba.Ea.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.Dgg(this.pNc),this.isActive&&this.DXb(this._element),Ra=!0}return Ra}onPointerDown(){this.isActive||(this.Dgg(!1),this.isActive&&(this._element.focus(),this.DXb(this._element),this.TSc=!0));return!1}Wg(){return this.TSc?(this.DXb(this._element),this.TSc=!1,!0):!1}F7a(){return 32===this.Ma.processAction(u.a.renameFile,1)}UEe(){const Ba=w.a.Lp(this.q8.fn);let Ra=this._element.innerText.trim();Ra.length>this.tEa&&(Ra=Ra.substr(0,
this.tEa));Ra!==Ba&&""!==Ra?32!==this.Ma.Vd(u.a.renameFile,2,Ra)?this.pOd():this.ZW(Ra):this.pOd()}pOd(){this.ZW(w.a.Lp(this.q8.fn))}ZW(Ba){this._initialized&&(this._element.innerText=Ba,this.Zie())}Dgg(Ba){this.F7a()?this.isActive||(Ba&&(this.uMc=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(U.a.Cd,U.a.xZc),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,v.CuiHelper.zOe),
this.D8&&this.D8.execute(Ra=>{Ra.bRf(!0)}),Ba&&this._element.focus(),e.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.Ma.processAction(u.a.Deb,2)}R7c(Ba){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(U.a.Cd,U.a.Qs);Sys.UI.DomElement.removeCssClass(this._element,v.CuiHelper.zOe);this.D8&&this.D8.execute(Ra=>{Ra.bRf(!1)});Ba&&(this._element.blur(),this._element.focus())}static Jz(){C.a.Jz(z.AFrameworkApplication.isRtl)}static ohd(){return new E(z.AFrameworkApplication.rb,
x.a.instance,H.KeyInputManager.instance,I.a.instance,z.AFrameworkApplication.om,E.Jz,S.a.yuj,S.a.o5g,D.a.instance.Tb("Common.App.Header.HeaderEventSource"),G.a.Uka,G.a.Hg,G.a.Cf)}}Object(r.a)(E,"RenameUIHandler",null,[312]);class N{static get instance(){return z.AFrameworkApplication.sa.Qa.gs?N.La||(N.La=y.ohd()):N.La||(N.La=E.ohd())}}N.La=null;Object(r.a)(N,"RenameUIHandlerFactory",null,[]);var M=a(99),L=a(137);class aa{constructor(){this.dLi=this.$Ki=this.Fih=null}}Object(r.a)(aa,"RenameMruEntryProperties",
null,[]);var V=a(378),P=a(168),ba=a(652),Y;(function(Ba){Ba[Ba.unknown=-1]="unknown";Ba[Ba.success=0]="success";Ba[Ba.renameInvalidFileName=1]="renameInvalidFileName";Ba[Ba.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";Ba[Ba.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";Ba[Ba.permissionDenied=4]="permissionDenied";Ba[Ba.serverCommunicationFailure=5]="serverCommunicationFailure";Ba[Ba.fileNameTooLong=6]="fileNameTooLong"})(Y||(Y={}));Object(r.b)("CommonOperationResult",
Y);class Z{constructor(Ba,Ra,qa,La,Yb,mc,Zb,qb,Ha,Ya,Gb,Ja){this.Qbe=Ba;this.Ma=Ra;this.RIc=qa;this.Nv=La;this.nEa=Yb;this.kGg=mc;this.Era=Zb;this.$le=qb;this.ICg=Ha;this.wqa=Ya;this.mb=Gb;this.HCg=Ja}Ag(){z.AFrameworkApplication.sa&&z.AFrameworkApplication.sa.Qa.gs||this.hh.Nb(u.a.Szb,m.a.frame,Object(c.a)(this,this.Szb,"initializeRenameUIHandler"));this.hh.Nb(u.a.Deb,m.a.frame,Object(c.a)(this,this.Deb,"showRenameDisabledDialog"));this.hh.Nb(u.a.renameFile,m.a.frame,Object(c.a)(this,this.renameFile,
"renameFile"));this.hh.Oe(u.a.fileNameUpdate,m.a.frame,Object(c.a)(this,this.Xej,"refreshFilename"),64);this.hh.Oe(u.a.Bnc,m.a.frame,Object(c.a)(this,this.Bnc,"moveToFolderCompleteByHost"),64);this.hh.Nb(u.a.wOa,m.a.frame,Object(c.a)(this,this.wOa,"moveToFolder"));(z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||z.AFrameworkApplication.sa&&(z.AFrameworkApplication.fa.pa("PostMessageEmbedded")||z.AFrameworkApplication.fa.pa("IsJsApi"))&&
z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",!0))&&z.AFrameworkApplication.uQ().execute(Ba=>{Ba.$n(P.a.ywf);Ba.Dl(P.a.ywf,Z.Odj);Ba.$n(P.a.qcd);Ba.Dl(P.a.qcd,Z.Mdj)})}F7a(){return 0===this.HCg.E6e()?32:8}s3j(){return this.Ty?this.Era?this.Ty.uNe:this.Ty.pwb:!0}Szb(){return N.instance.initialize(z.AFrameworkApplication.V$b,z.AFrameworkApplication.a2a,z.AFrameworkApplication.FMd||CommonUIStrings.l_RenameFileTooltip)?32:8}Deb(){const Ba=this.s3j(),
Ra=this.kGg();e.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",this.nEa,Ra,Ba,this.Era);z.AFrameworkApplication.sa&&z.AFrameworkApplication.sa.Qa.tv&&z.AFrameworkApplication.fa.pa("ReactRenameDisabledDialogIsEnabled")?new l(this.nEa,!Ra,!Ba,this.Era,this.wqa()):new n(this.nEa,!Ra,!Ba,this.Era,this.wqa());return 32}renameFile(Ba,Ra,qa,La,Yb){if(1===
qa)return this.F7a();if(!z.AFrameworkApplication.s$b)return 8;if(8===this.F7a())return this.hh.processAction(u.a.Deb,2),8;e.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");z.AFrameworkApplication.s$b(Yb,Object(c.a)(this,this.KGb,"onRenameFileSuccess"),Object(c.a)(this,this.IYi,"onRenameFileFailure"));return 32}KGb(Ba,Ra){Ba?0!==Ba.OperationResult?this.x$e(Ba.OperationResult):(this.Mvj(Ra,Ba.NewName),this.LZj(Ba,Object(c.a)(z.AFrameworkApplication.sa.Qa,z.AFrameworkApplication.sa.Qa.kkg,"updateOpenInClientDocumentUrl")),
z.AFrameworkApplication.fa.pa("DocumentNameInJewelInfoMenuIsEnabled")&&z.AFrameworkApplication.sa.updateCommandUI(),this.ICg.Nig()):this.x$e(5)}Mvj(Ba,Ra){const qa={};qa[V.a.eGh]=Ra;Ba.jj(P.a.qcd,qa)}LZj(Ba,Ra){this.ZZj(Ba);z.AFrameworkApplication.U7b=Ba.DirectInvokeDavUrl;Ra=Ra(Ba.EditDocInClientUrl);const qa=new aa;qa.dLi=this.Nv.fn;qa.Fih=Ra;qa.$Ki=Ba.EditDocInClientUrl;this.hh.Vd(u.a.renameMostRecentlyUsedFileEntry,2,qa)}x$e(Ba){switch(Ba){case 1:Ba=new f.StandardDialog,Ba.Ob=0,Ba.YR(CommonUIStrings.l_RenameFileInvalidNameTitle,
CommonUIStrings.l_RenameFileInvalidName,null),this.ZZf()}}ZZj(Ba){this.Nv.fn=Z.VRg(this.Nv.fn,Ba.NewName);Ba.BreadcrumbFolderName&&(this.Nv.breadcrumbFolderName=Ba.BreadcrumbFolderName);Ba.BreadcrumbFolderUrl&&(this.Nv.breadcrumbFolderUrl=Ba.BreadcrumbFolderUrl);this.$le(Ba.NewName)}IYi(Ba){const Ra=new f.StandardDialog;Ra.Ob=0;switch(Ba){case 1:e.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");Ra.Zna(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,
null);break;case 6:e.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");Ra.Zna(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,null);break;default:e.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:Ba}),Ra.Zna(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}z.AFrameworkApplication.uQ().execute(qa=>{qa.jj(P.a.dGh,{["FailureMessage"]:Y[Ba]})});this.ZZf()}Xej(Ba,Ra,qa){if(1===
qa)return this.F7a();if(!z.AFrameworkApplication.vJa)return 8;z.AFrameworkApplication.vJa(Object(c.a)(this,this.jqc,"onRefreshFilenameSuccess"),Object(c.a)(this,this.iqc,"onRefreshFilenameFailure"),!1);return 32}wOa(Ba,Ra,qa,La,Yb){if(1===qa)return z.AFrameworkApplication.fa.pa("UiHostSupportsMoveToFolder")?32:8;if(2===qa){const mc={};Ba=z.AFrameworkApplication.Lba;Ra=z.AFrameworkApplication.fa.pa("UiHostSupportsDocRebootFeatures");Ba=(!Ba||Ba&&Ra)&&z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",
!1);mc[V.a.TPj]=Ba;Yb&&Yb.MoveButtonClickedTime&&(mc[V.a.zJi]=Yb.MoveButtonClickedTime.getTime());z.AFrameworkApplication.uQ().execute(Zb=>{Zb.jj(P.a.wOa,mc)});if(Yb&&Yb.MoveButtonClickedTime){if(Ba=L.a.Pr())Yb=(new Date).getTime()-Yb.MoveButtonClickedTime.getTime(),Ba.set("MovePostDuration",Yb.toString());M.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",Ba)}return 32}return 8}Bnc(Ba,Ra,qa,La,Yb){if(1===qa)return z.AFrameworkApplication.fa.pa("UiHostSupportsMoveToFolder")?this.F7a():8;
if(2===qa){if(!z.AFrameworkApplication.S2f)return M.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),8;if(!Yb)return M.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(Yb[V.a.Ini])if(Yb[V.a.klg])if(Ba=Yb[V.a.klg].toLowerCase(),Ra=z.AFrameworkApplication.fa.pa("UiHostSupportsDocRebootFeatures"),qa=z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),Ra&&z.AFrameworkApplication.Lba&&
qa){const mc={};mc[V.a.jQa]="1";mc[V.a.documentUrl]=Ba;mc[V.a.reason]=ba.a.saveAs;M.Health.instance.recordKpiSuccess("MoveToFolder",null);z.AFrameworkApplication.uQ().execute(Zb=>{Zb.jj(P.a.SY,mc)})}else if(!z.AFrameworkApplication.Lba&&qa)M.Health.instance.recordKpiSuccess("MoveToFolder",null),S.a.gf(Ba,S.a.bX(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return M.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else M.Health.instance.recordKpiFailure("MoveToFolder",
"Null newDocUrl",!1,!1,null);else z.AFrameworkApplication.vJa(Object(c.a)(this,this.jqc,"onRefreshFilenameSuccess"),Object(c.a)(this,this.iqc,"onRefreshFilenameFailure"),!1),z.AFrameworkApplication.S2f(),M.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32}JHj(Ba,Ra){return Ba&&Ra?Ba!==this.Nv.breadcrumbFolderName||Ra!==this.Nv.breadcrumbFolderUrl:!1}jqc(Ba,Ra){Ba&&(Ba.NewName!==w.a.Lp(this.Nv.fn)||this.JHj(Ba.BreadcrumbFolderName,Ba.BreadcrumbFolderUrl))&&this.KGb(Ba,Ra)}iqc(){}ZZf(){this.$le(w.a.Lp(this.Nv.fn))}get hh(){return this.Ma.value}get Ty(){return this.RIc.value}static get instance(){return Z.La||
(Z.La=Z.qwb())}static qwb(){return new Z(z.AFrameworkApplication.G7a,new b.a(()=>z.AFrameworkApplication.rb),new b.a(()=>z.AFrameworkApplication.Ty),z.AFrameworkApplication.om,z.AFrameworkApplication.limitedEdit,()=>z.AFrameworkApplication.userCanRename,z.AFrameworkApplication.hvc,Object(c.a)(N.instance,N.instance.ZW,"updateTitle"),D.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>z.AFrameworkApplication.isReadOnlyRecommended,z.AFrameworkApplication.fa,D.a.instance.resolve("Common.IRenameProps"))}static VRg(Ba,
Ra){Ba=w.a.Z3(Ba);return Ra+Ba}static Odj(Ba){const Ra=Ba.Values[V.a.xri];e.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",Ra);Ra?z.AFrameworkApplication.rb.Vd(u.a.Bnc,2,Ba.Values):M.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static Mdj(Ba){z.AFrameworkApplication.rb.Vd(u.a.renameFile,2,Ba.Values.NewName)}}Z.La=null;Object(r.a)(Z,"RenameActor",null,[]);a(570);class ea{}Object(r.a)(ea,"ActivityEventName",null,[]);class ra{}
ra.compatMode="CompatMode";ra.noSelection="NoSelection";Object(r.a)(ra,"ActivityEventReason",null,[]);var O=a(650);class da{constructor(Ba,Ra){this.Ma=Ba;this.HVa=Ra}Ag(){this.Ma.Nb(u.a.D$f,m.a.frame,Object(c.a)(this,this.pKj,"showRenameDialogAction"))}pKj(Ba,Ra,qa){Ba=32;if(1===qa)return O.SessionStatusManager.instance.v5a||z.AFrameworkApplication.W4?8:32;2===qa&&(32!==this.Ma.processAction(u.a.renameFile,1)?(this.Ma.processAction(u.a.Deb,2),Ba=8):32===this.Ma.processAction(u.a.DNb,1)?this.Ma.processAction(u.a.DNb,
2):this.HVa.value.create().Kzc());return Ba}}Object(r.a)(da,"RenameDialogActor",null,[303]);class xa{constructor(Ba,Ra,qa){this.dialog=null;this.Ma=Ba;this.Nv=Ra;this.iqa=qa}L1h(){const Ba={};Ba.nameInputProps={["type"]:"AppInputProps",["id"]:xa.$1a,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:w.a.Lp(this.Nv.fn),["maxLength"]:this.iqa};return Ba}Kzc(){const Ba={["id"]:"RenameDialog",["bodyControls"]:this.L1h()};this.dialog=new k.a(!1,!1,!0);this.dialog.Ob=1;this.dialog.pe="RenameDialog";
this.dialog.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,Object(c.a)(this,this.DMd,"renameDialogHandler"),Ba)}DMd(Ba,Ra){Ra&&1===Ba&&Ra[xa.$1a]&&(Ba=w.a.Lp(this.Nv.fn),Ra=(Ra[xa.$1a]||"").trim(),Ra!==Ba&&""!==Ra&&this.Ma.Vd(u.a.renameFile,2,Ra))}}xa.$1a="txtDocumentName";Object(r.a)(xa,"ReactRenameDialog",null,[313]);class ia{static get og(){return k.a.zq(ia.Ll,CommonUIStrings.l_RenameDialogLabel)}}ia.Ll="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(r.a)(ia,"RenameDialogHtml",null,[]);class Ma extends k.a{constructor(Ba,Ra,qa){super();this.Ma=Ba;this.Nv=Ra;this.iqa=qa;this.pe="RenameDialog";this.og=ia.og}Kzc(){var Ba={["txtDocumentName"]:w.a.Lp(this.Nv.fn)};this.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,Object(c.a)(this,this.DMd,"renameDialogHandler"),Ba);Ba=document.getElementById(Ma.$1a);0<this.iqa&&(Ba.maxLength=this.iqa);Ba.focus()}DMd(Ba,Ra){1===Ba&&(Ba=w.a.Lp(this.Nv.fn),Ra=(Ra[Ma.$1a]||"").trim(),Ra!==Ba&&""!==Ra&&this.Ma.Vd(u.a.renameFile,
2,Ra))}}Ma.$1a="txtDocumentName";Object(r.a)(Ma,"RenameDialog",k.a,[313]);class Ta{constructor(Ba){this.q8=null;this.iqa=0;this.Ma=Ba;this._initialized=!1}initialize(Ba,Ra){this.q8=Ba;this.iqa=Ra;this._initialized=!0}create(){return this._initialized?z.AFrameworkApplication.sa&&z.AFrameworkApplication.sa.Qa.tv&&z.AFrameworkApplication.fa.pa("ReactRenameDialogIsEnabled")?new xa(this.Ma,this.q8,this.iqa):new Ma(this.Ma,this.q8,this.iqa):null}}Object(r.a)(Ta,"RenameDialogFactory",null,[301]);var Da=
a(264),fa=a(145),ua=a(146),Fa=a(109),ca=a(104);class ka{constructor(Ba,Ra){this.Ma=Ba;this.Zb=Ra}Ag(){this.Ma.Nb(u.a.DNb,m.a.frame,Object(c.a)(this,this.qKj,"showRenameFlyoutAction"))}s1g(){return ua.d("setDocumentTitleFlyoutOpened")&&z.AFrameworkApplication.sa.Qa.gs}qKj(Ba,Ra,qa){if(1===qa)return this.s1g()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}IKg(){ka.Bui&&z.AFrameworkApplication.t7a&&ca.a.instance.fg(new Fa.a(5,1,5E3,()=>{32===this.Ma.processAction(u.a.DNb,
1)&&this.Zb&&this.Zb.Uh.name===Da.AFrame.gaa&&(fa.a("RenameFloatieShownOnNewDocumentLoad",!0),this.Ma.processAction(u.a.DNb,2))}))}static get Bui(){ka.aVb&&null!=ka.aVb||(z.AFrameworkApplication.ula("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),ka.aVb=z.AFrameworkApplication.fa?z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return ka.aVb}}ka.aVb=null;Object(r.a)(ka,"RenameFlyoutActor",null,
[300]);class Ca{constructor(Ba,Ra,qa,La,Yb){this.RIc=Yb;this.Rbe=qa;this.Qbe=La;this.oGg=Ba;this.wqa=Ra}get Ty(){return this.RIc.value}E6e(){if(!this.Qbe())return 5;if(this.wqa())return 1;if(this.Ty){if(this.Rbe&&!this.Ty.uNe)return 3;if(!this.Rbe&&!this.Ty.pwb)return 4}return this.oGg()?0:2}}Object(r.a)(Ca,"RenameProps",null,[299]);a(192);var fb=a(100);class yb{constructor(Ba,Ra,qa,La,Yb,mc){this.cx=!1;this.LOc=new fb.a;this.NVa=Ra;this.zL=qa;this.sug=La;this.mb=Yb;this.Hke=mc}enable(){this.cx||
(this.Nig(),this.HWd(),this.cx=!0)}generateKey(Ba,Ra,qa){return String.format("{0}/{1}/{2}",qa,Ba,Ra)}KXh(){const Ba=w.a.Lp(this.NVa().fn);return this.generateKey(this.NVa().breadcrumbFolderName,this.NVa().breadcrumbFolderUrl,Ba)}LXh(Ba,Ra,qa){return Ba&&Ra?this.generateKey(Ba,Ra,qa):qa}Tmh(Ba,Ra,qa){return Ba&&Ba!==this.NVa().breadcrumbFolderName||Ra&&Ra!==this.NVa().breadcrumbFolderUrl?!0:qa!==w.a.Lp(this.NVa().fn)}Nig(){const Ba=this.KXh();this.LOc.ia(Ba,new Date)}lGd(Ba){this.hGj(Ba)&&this.ine(Ba)}hGj(Ba){const Ra=
this.sug();return Ra?this.Hke&&this.Hke.lBb||!Ra.Bif||!z.AFrameworkApplication.vJa?(this.dcg(Ba),this.cx=!1):!0:!1}aJf(Ba,Ra,qa,La){const Yb=this.Tmh(Ba,Ra,qa);Ba=this.LXh(Ba,Ra,qa);Ra=this.LOc.Fc(Ba).returnValue;Yb&&!Ra&&(this.y$e(La),e.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.Uwd));Yb||this.LOc.ia(Ba,this.zL())}}Object(r.a)(yb,"ARenamedFileChecker",null,[269]);class mb extends yb{constructor(Ba,Ra,qa,La,Yb,mc,Zb,qb){super(Ba,Ra,qa,La,Yb,mc);this.Qhe=Yb;this.GCg=Zb;this.cyg=
qb}get Uwd(){return"RenamedFileCheckerUsingSettingsRefresh"}HWd(){this.Qhe.EXc(Object(c.a)(this,this.iaf,"handleSettingsRefresh"))}iaf(Ba,Ra){Ra&&Ra.iFb&&Ra.BNi&&(Ra.Q7a("BreadcrumbDocName")||Ra.Q7a("BreadcrumbFolderName")||Ra.Q7a("BreadcrumbFolderUrl")||Ra.Q7a("DirectInvokeDAVUrl")||Ra.Q7a("EditDocInClientUrl"))&&(e.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.Uwd),this.lGd(Ra))}dcg(){this.Qhe.Ykj(Object(c.a)(this,this.iaf,"handleSettingsRefresh"))}ine(Ba){if(Ba&&Ba.iFb){const Ra=
Ba.iFb;this.aJf(Ra.Wa("BreadcrumbFolderName"),Ra.Wa("BreadcrumbFolderUrl"),Ra.Wa("BreadcrumbDocName"),Ba)}}y$e(Ba){const Ra={OperationResult:0,classId:1};Ba=Ba.iFb;Ra.BreadcrumbFolderName=Ba.Wa("BreadcrumbFolderName");Ra.BreadcrumbFolderUrl=Ba.Wa("BreadcrumbFolderUrl");Ra.DirectInvokeDavUrl=Ba.Wa("DirectInvokeDAVUrl");Ra.EditDocInClientUrl=Ba.Wa("EditDocInClientUrl");Ba=Ba.Wa("BreadcrumbDocName");Ra.NewName=z.AFrameworkApplication.Sta?Ba:w.a.Lp(Ba);this.cyg.execute(qa=>{this.Yki(Ra,qa)})}Yki(Ba,Ra){this.GCg().KGb(Ba,
Ra)}}Object(r.a)(mb,"RenamedFileCheckerUsingSettingsRefresh",yb,[]);class nb extends yb{constructor(Ba,Ra,qa,La,Yb,mc,Zb,qb,Ha,Ya){super(Ba,qa,La,Yb,mc,Ha);this.amb=this.hZb=null;this.PBg=Ra;this.Ma=Zb;this.he=qb;Ya&&Ya.execute(Gb=>{this.mhj(Gb)})}get Uwd(){return"RenamedFileCheckerUsingTask"}mhj(Ba){this.hZb=Ba;this.hZb.vre(Object(c.a)(this,this.wyb,"handleVisibilityChange"))}wyb(Ba,Ra){!this.cx||0!==Ra.newState&&1!==Ra.newState||this.amb||(this.HWd(),this.lGd(this.amb))}HWd(){this.amb=new Fa.a(3,
2,this.PBg(),Object(c.a)(this,this.lGd,"performRenameFileCheckTick"),89);this.he.fg(this.amb)}dcg(Ba){this.he.Uo(Ba)}ine(Ba){this.hZb&&2===this.hZb.V8j?this.mij(Ba):z.AFrameworkApplication.vJa(Object(c.a)(this,this.jqc,"onRefreshFilenameSuccess"),Object(c.a)(this,this.iqc,"onRefreshFilenameFailure"),!0)}mij(Ba){this.he.Uo(Ba);this.amb=null}jqc(Ba){Ba&&this.aJf(Ba.BreadcrumbFolderName,Ba.BreadcrumbFolderUrl,Ba.NewName,null)}y$e(){this.Ma.processAction(u.a.fileNameUpdate,2)}iqc(){}}Object(r.a)(nb,"RenamedFileCheckerUsingTask",
yb,[]);var X=a(97);class R{constructor(){this.mb=this.$a=null}get name(){return"Common.App.RenameFile"}Bh(Ba){this.$a=Ba;this.mb=z.AFrameworkApplication.fa;this.$a.register(da,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").yc(()=>new da(z.AFrameworkApplication.rb,this.$a.jOd("Common.App.Rename.IRenameDialogFactory"))).qc();this.$a.register(Ta,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").yc(()=>new Ta(z.AFrameworkApplication.rb)).qc();
this.$a.register(269,"Common.App.Rename.IRenamedFileChecker").yc(()=>this.qgh()).qc();this.$a.register(ka,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").yc(()=>new ka(z.AFrameworkApplication.rb,X.FocusManager.instance())).qc()}qgh(){if(this.mb.pa("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const Ba=this.$a.mg("Common.IRefreshableAppSettings");if(Ba&&Ba.usd)return new mb(()=>Ba.vd("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>z.AFrameworkApplication.om,()=>
new Date,()=>z.AFrameworkApplication.Ty,Ba,this.$a.mg("Common.ISessionStatus"),()=>Z.instance,this.$a.Tb("Postmessage.IHostPostmessenger"))}return new nb(()=>this.mb.vd("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.mb.vd("RenamedFileCheckerPingIntervalInMs",12E4),()=>z.AFrameworkApplication.om,()=>new Date,()=>z.AFrameworkApplication.Ty,z.AFrameworkApplication.fa,z.AFrameworkApplication.rb,z.AFrameworkApplication.ji,this.$a.mg("Common.ISessionStatus"),this.$a.Tb("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.mb.ru(Object(c.a)(this,
this.lB,"onFullAppSettingsReady"))}lB(){const Ba=z.AFrameworkApplication.sa.Qa.gs;z.AFrameworkApplication.G7a()&&N.instance.initialize(z.AFrameworkApplication.V$b,Ba?null:z.AFrameworkApplication.a2a,Ba?null:z.AFrameworkApplication.FMd||CommonUIStrings.l_RenameFileTooltip)&&(this.$a.register(Ca,"Common.App.Rename.RenameProps").as("Common.IRenameProps").yc(()=>new Ca(()=>z.AFrameworkApplication.userCanRename,()=>z.AFrameworkApplication.isReadOnlyRecommended,z.AFrameworkApplication.hvc,z.AFrameworkApplication.G7a,
new b.a(()=>z.AFrameworkApplication.Ty))).qc(),Z.instance.Ag(),this.mb.pa("RenameDialogIsEnabled")&&(this.$a.resolve("Common.App.Rename.RenameDialogFactory").initialize(z.AFrameworkApplication.om,z.AFrameworkApplication.V$b),this.$a.resolve("Common.App.Rename.IRenameDialogActor").Ag()),this.$a.resolve("Common.App.Rename.IRenameFlyoutActor").Ag(),z.AFrameworkApplication.hvc&&this.$a.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.$a.resolve("Common.App.Rename.IRenameFlyoutActor").IKg())}dispose(){}}
Object(r.a)(R,"PackageManager",null,[3,4]);var wa=a(251);a.d(F,"a",function(){return na});const na=()=>{Type.registerNamespace("Common.App.Rename");wa.a.instance.ii(new R,7)}},1476:function(r,F,a){a.r(F);r=a(1168);var c=a(9);F=a(0);var b=a(709),e=a(50),f=a(37),d=a(4),h=a(56),l=a(189),k=a(25),t=a(55);class n{constructor(Z){this.renameFileManager=Z}executeCommand(Z,ea,ra){switch(ea.command){case k.a.Mha:return h.a.pg.gs?2!==d.AFrameworkApplication.rb.Vd(k.a.Mha,2,ra)?t.Task.Sa(!0):l.a(ea.command):l.a(ea.command);
case 1897077126:return this.renameFileManager.renameFile(ra,ea),t.Task.Sa(!0);default:return l.a(ea.command)}}wc(Z,ea,ra,O){switch(ea.command){case k.a.Mha:return h.a.pg.gs;case 1897077126:return!!O&&2===O.zx}return!1}Nc(){return!1}Hc(){return!1}dispose(){this.renameFileManager=null}}Object(F.a)(n,"RenameFileCommandHandler",null,[222,2]);class z extends b.a{constructor(Z){super(Z)}hd(){const Z=e.GetServiceTaskFactory.create(this.$.da,119,this.la,this.Xa);f.TaskExtensions.za(Z,()=>{this.$c([new n(Z.result)])},
this.la,3)}static ka(Z){b.a.Md(118,new z(Z))}}Object(F.a)(z,"RenameFileCommandHandlerFactory",b.a,[]);var w=a(89),m=a(226),u=a(230),y=a(15),v=a(30),C=a(81),x=a(384),B=a(68),H=a(376),I=a(193),U=a(94),S=a(249),G=a(1),D=a(22),E=a(282);class N{constructor(Z){this.$=Z}get Bif(){return this.$.workbookContext.FileCoauthorable}get lBb(){return!1}get pwb(){return this.$.ea.amIAlone}get uNe(){if(this.pwb)return!0;for(const Z of this.$.ea.uo)if(!Z.SupportsRename)return!1;return!0}}Object(F.a)(N,"EwaCoauthManager",
null,[623]);var M=a(60),L=a(73);class aa extends C.a{constructor(Z,ea){super();this.mda=this.EMd=this.jXf=this.Y7c=null;this.aka=()=>{var ra=this.$.ea.Qn;if(ra&&ra.WorkbookFileName){var O=v.a.Lp(ra.WorkbookFileName),da=!!D.a.compare(this.$.workbookContext.WorkbookFileName,ra.WorkbookFileName,!1),xa=G.EwaSettings.ra(465)&&!!ra.BreadcrumbFolderUrl&&!!D.a.compare(this.$.workbookContext.FullDocumentInfo.BreadcrumbFolderUrl,ra.BreadcrumbFolderUrl,!1);if(da||xa)this.mda={},this.mda.NewFileName=O,this.mda.EditDocInClientUrl=
ra.EditDocInClientUrl,this.mda.DirectInvokeDAVUrl=ra.DirectInvokeDAVUrl,this.mda.DownloadACopyUrl=ra.DownloadACopyUrl,G.EwaSettings.ra(465)&&ra.BreadcrumbFolderUrl&&(this.mda.BreadcrumbFolderName=ra.BreadcrumbFolderName,this.mda.BreadcrumbFolderUrl=ra.BreadcrumbFolderUrl),ra=d.AFrameworkApplication.rb.Vd(k.a.fileNameUpdate,2,O),this.mda=null,y.ULS.shipAssertTag(537154064,0,32===ra,"RenameFileManager.HandleWorkbookMetadataChanged - Workbook Name Update Failed")}};this.WRi=(ra,O,da)=>{this.jXf=O;this.EMd=
da;this.$.Ia.Hb(new U.a(1897077126,B.a.zb,2,3,null),{["newFileName"]:ra})};this.VRi=ra=>{this.mda&&ra(this.F6e(this.mda),this.ds)};this.KGb=ra=>{S.a(ra)||!ra.Result?(ra=aa.dNh(ra),L.a(this.$).gd.RL([-414480287,650565124,-782844485,1223808266,-62451516,1636785843]),this.EMd(ra)):this.jXf(this.F6e(ra.Result),this.ds)};this.HYi=()=>{this.EMd(5)};this.$=Z;this.ds=ea;this.$.ea.$t(this.aka)}initialize(){d.AFrameworkApplication.s$b=this.WRi;d.AFrameworkApplication.vJa=this.VRi;this.Y7c=d.AFrameworkApplication.Ty;
d.AFrameworkApplication.Ty=new N(this.$)}dispose(){d.AFrameworkApplication.s$b=null;d.AFrameworkApplication.vJa=null;this.$.ea.Av(this.aka);d.AFrameworkApplication.Ty=this.Y7c;this.$=this.Y7c=null;super.dispose()}renameFile(Z,ea){const ra=Z.newFileName;if(ra&&(Z=v.a.Lp(this.$.workbookContext.WorkbookFileName),!G.EwaSettings.isChangeGateEnabled("OfficeVSO:7439298_CompareNewFileNameForRenameOperation")||D.a.compare(Z,ra,!1))){const O=this.$.oa.xa.Wb();H.a(this.$.userOperationManager,(da,xa,ia)=>{var Ma=
this.$.oa.xa;da=E.b(da,this.KGb);xa=E.a(xa,this.HYi);const Ta=Ma.Na(9,O);Ta.newFileName=ra;return M.g(Ma,"RenameFile",Ta,da,xa,ia,null,0)},da=>new I.a(134,0,da),ea)}}sni(){return 32===d.AFrameworkApplication.rb.processAction(k.a.Mha,1)}F6e(Z){var ea=this.$.workbookContext;d.AFrameworkApplication.UY=Z.DownloadACopyUrl;const ra=G.EwaSettings.ra(465)&&!!Z.BreadcrumbFolderUrl;ra&&(d.AFrameworkApplication.om.breadcrumbFolderName=Z.BreadcrumbFolderName,d.AFrameworkApplication.om.breadcrumbFolderUrl=Z.BreadcrumbFolderUrl,
ea.FullDocumentInfo.BreadcrumbFolderUrl=Z.BreadcrumbFolderUrl,ea.FullDocumentInfo.BreadcrumbFolderName=Z.BreadcrumbFolderName);ea.FullDocumentInfo.BreadcrumbDocName=Z.NewFileName;x.d(ea,Z.NewFileName);ea={};ea.NewName=Z.NewFileName;ea.DirectInvokeDavUrl=Z.DirectInvokeDAVUrl;ea.EditDocInClientUrl=Z.EditDocInClientUrl;ra&&(ea.BreadcrumbFolderName=Z.BreadcrumbFolderName,ea.BreadcrumbFolderUrl=Z.BreadcrumbFolderUrl);ea.OperationResult=0;return ea}static dNh(Z){switch(Z.Errors[0].MessageId){case -414480287:Z=
2;break;case 650565124:Z=1;break;case 1636785843:Z=6;break;case -782844485:Z=4;break;default:Z=5}return Z}}Object(F.a)(aa,"RenameFileManager",C.a,[609,2]);var V=a(52);class P extends m.a{constructor(Z){super();this.GY=this.renameFileManager=null;this.$=Z;this.Db()}create(){if(!this.GY){const Z=u.a.m1a(V.b(),this.la,"Task","IRenameFileManager");this.GY=Z.task;const ea=e.GetServiceTaskFactory.create(this.$.da,137,this.la,this.Xa),ra=e.GetServiceTaskFactory.create(this.$.da,155,this.la,this.Xa);f.TaskExtensions.za(f.TaskExtensions.Fd([ra,
ea],this.la),()=>{const O=new aa(this.$,ea.result);this.$.da.Ha(120,O);Z.setResult(O)},this.la,3)}this.GY.continueWith(Z=>{this.nb(Z.result)})}dispose(){w.a.Ja(this.renameFileManager);this.$=this.renameFileManager=null;super.dispose()}static ka(Z){Z.da.Ha(119,new P(Z))}}Object(F.a)(P,"RenameFileManagerServiceFactory",m.a,[]);class ba{constructor(Z){this.hh=Z}Hc(){return!1}executeCommand(Z,ea,ra){return 2!==this.hh.Vd(k.a.D$f,2,ra)?t.Task.Sa(!0):l.a(ea.command)}wc(Z,ea){return 1204860550===ea.command}Nc(){return!1}}
Object(F.a)(ba,"RenameFileDialogCommandHandler",null,[222]);class Y extends b.a{constructor(Z){super(Z)}hd(){f.TaskExtensions.za(e.GetServiceTaskFactory.create(this.$.da,155,this.la,this.Xa),()=>{this.$c([new ba(d.AFrameworkApplication.rb)])},this.la,3)}static ka(Z){b.a.Md(131,new Y(Z))}}Object(F.a)(Y,"RenameFileDialogCommandHandlerFactory",b.a,[]);Type.registerNamespace("_Ewa");Object(r.a)();(()=>{c.a.Fa(Z=>{P.ka(Z);z.ka(Z)})})();c.a.Fa(Y.ka)}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.rn.js.map/8f18f366d344d8fc3c861edd1b9d6528/EwaDSEsNext.rn.js.map
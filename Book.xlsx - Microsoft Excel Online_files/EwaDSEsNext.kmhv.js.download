'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1070:function(r,F,a){a.d(F,"a",function(){return b});var c=a(512);const b=()=>{c.a.Bi(".ewa-bb{padding:0;display:block;background-color:#fcf7b6;color:#444;position:relative;overflow:hidden;cursor:default}.ewa-bb-entry{position:relative;height:auto;border-bottom:1px solid #d7d889;overflow:hidden}.ewa-bb.ewa-bb-react{background-color:#f5f5f5}.ewa-bb-entry:first-child{border-top:1px solid #d7d889}.ewa-bb-entry-body{min-height:24px;position:relative}.ewa-bb-icon{vertical-align:middle;display:inline-block}.ewa-bb-entry-icon{margin:2px 6px 0;display:inline-block}.ewa-bb-entry-title{font-weight:bold}.ewa-bb-entry-message{padding:0 8px}.ewa-bb-entry-button{background-color:#fff;border:1px solid #ababab;color:#444;text-align:center;cursor:default;margin-bottom:1px;padding:3px 10px 4px}.ewa-bb-entry-button:hover{background:#f0f0f0}.ewa-bb-entry-button:active{background:#c6c6c6}.ewa-bb-entry-link{color:#369}.ewa-bb-entry-close{position:absolute;top:50%;margin-top:-8px;cursor:pointer}.ewa-bb-entry-close .clip16x16{display:inline-block}.ewa-bb-entry-title,.ewa-bb-entry-message,.ewa-bb-entry-button-holder,.ewa-bb-entry-link{vertical-align:middle}.ewa-root-ltr .ewa-bb-entry-close,.ewa-nov2-ltr .ewa-bb-entry-close{right:2px}.ewa-root-ltr .ewa-bb-content,.ewa-nov2-ltr .ewa-bb-content{margin-right:26px}.ewa-root-ltr .ewa-bb-entry-button-holder,.ewa-nov2-ltr .ewa-bb-button-holder,.ewa-root-ltr .ewa-bb-entry-link,.ewa-nov2-ltr .ewa-bb-entry-link{margin-left:8px}.ewa-root-rtl .ewa-bb-entry-close,.ewa-nov2-rtl .ewa-bb-entry-close{left:2px}.ewa-root-rtl .ewa-bb-content,.ewa-nov2-rtl .ewa-bb-content{margin-left:26px}.ewa-root-rtl .ewa-bb-entry-button-holder,.ewa-nov2-rtl .ewa-bb-button-holder,.ewa-root-rtl .ewa-bb-entry-link,.ewa-nov2-rtl .ewa-bb-entry-link{margin-right:8px}")}},
1071:function(r,F,a){a.d(F,"a",function(){return h});r=a(0);var c=a(15),b=a(85);F=a(150);var e=a(4),f=a(46),d=a(30);class h extends F.a{constructor(l,k,t,n,z,w,m=null){super();this.FI=null;this.Ma=k;this.kX=n;this.uga=w;this.mb=l;this.Es=z;this.Ye=t;this.djb=this.mb.pa("SaveToHostWithExtraCharsInFileName");this.Ah=m;this.tc(1,CommonUIStrings.l_SaveButtonLabel)}get sa(){return this.Ye}vMe(l,k){this.YK(1,!!l&&l!==k);this.FI=document.getElementById(h.pXe);f.a.addHandler(this.FI,"change",Object(b.a)(this,
this.kpc,"onFileNameChange"));f.a.addHandler(this.FI,"input",Object(b.a)(this,this.kpc,"onFileNameChange"));this.FI.focus()}U$b(l){return this.djb?(new RegExp("["+this.A9b('\\/:*?"<>|')+"]")).test(l):(new RegExp("["+this.A9b('\\/:*?"<>|#{}%~&')+"]")).test(l)}A9b(l){return l.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")}Ckd(){const l=d.a.Lp(e.AFrameworkApplication.om.fn);this.YK(1,!!this.FI&&""!==this.FI.value&&this.FI.value!==l)}kpc(){this.FI&&window.setTimeout(()=>{this.Ckd()},0)}T$b(l,k){if(1!==
l)c.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{l=k[h.pXe];k=h.oLf in k?k[h.oLf]:!1;c.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",d.a.Itc(l),k);const t=d.a.Z3(e.AFrameworkApplication.fileName);(l=l?l.trim():null)&&""!==l&&""!==t||1===this.sa.state?this.U$b(l)?this.Es.create().displayError(1,l,k):this.uga.hoa(l+t,k,this.Ah):this.Es.create().displayError(2,l,k)}}dispose(){this.FI&&
(f.a.removeHandler(this.FI,"change",Object(b.a)(this,this.kpc,"onFileNameChange")),f.a.removeHandler(this.FI,"input",Object(b.a)(this,this.kpc,"onFileNameChange")),this.FI=null);super.dispose()}}h.pXe="txtFileName";h.oLf="chkOverwrite";Object(r.a)(h,"FileNameDialogBase",F.a,[])},1072:function(r,F,a){a.d(F,"a",function(){return n});r=a(0);var c=a(15),b=a(160),e=a(85),f=a(4),d=a(650),h=a(852),l=a(380),k=a(108),t=a(25);class n{constructor(z,w,m,u){this.pXb=null;this.rDg=z;this.mb=m;this.Tfe=w;this.xde=
new b.a;this.rh=u}e8a(){return this.mb.pa("SaveToCloudStorageUIIsEnabled")}X_e(){return t.a.saveToCloudStorage}R2b(){l.a.EKd(Object(e.a)(this,this.j1f,"saveToCloudActionDispatcher"));l.a.q$c([new h.a(t.a.saveToCloudStorage,k.a.frame,0)],this.Tfe.K4a())}Ag(){const z=this.Tfe.K4a();z?(z.x9(()=>{this.xde.setResult(!0)}),this.R2b()):c.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}bTf(){c.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")}j1f(z,
w,m,u,y){return w.contextId!==k.a.frame||z!==this.X_e()?2:this.e8a()?1===m?d.SessionStatusManager.instance.v5a||f.AFrameworkApplication.W4?8:32:2===m?(this.bTf(),y&&y.FileDownloadUrl&&c.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.rh&&(this.pXb=this.rh.Gc("DialogShown","SaveToOneDriveReponseTime")),this.xde.task.continueWith(()=>{this.pXb&&(this.pXb.stop(),this.pXb=null);this.rDg.start(y)}),32):8:8}}Object(r.a)(n,"SaveToCloudStorageActor",null,[657])},
1073:function(r,F,a){a.d(F,"a",function(){return z});r=a(0);var c=a(15),b=a(85),e=a(1074),f=a(4),d=a(39),h=a(40),l=a(241),k=a(378),t=a(168),n=a(777);class z{constructor(w,m,u,y,v){this.x8=this.Hm=this.XCa=null;this.GDa=!1;this.Ah=this.tga=null;this.TUc=w;this.Plb=m;this.Es=u;this.Ye=y;this.rh=v}INb(){this.Ye&&1===this.Ye.state||(this.Hm=this.Plb(),this.Hm.message=CommonUIStrings.l_CommentProgressTooltip,this.Hm.Ob=5,this.Hm.pt=!1,this.Hm.ZAa(CommonUIStrings.l_DefaultDialogTitle,null,null))}PIa(){this.Hm&&
(this.Hm.close(),this.Hm=null)}XR(){1!==f.AFrameworkApplication.sa.state&&this.Es().displayError(e.a.default)}qQa(){c.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");h.a.gf(this.x8,h.a.bX(3),void 0,"UploadToCloudManager.RedirectToFolder")}pQa(w){let m=!1,u=!1;f.AFrameworkApplication.fa&&(m=f.AFrameworkApplication.fa.pa("SaveACopyIsEnabledForUiHost"),u=f.AFrameworkApplication.fa.pa("UiHostSupportsDocRebootFeatures"));c.ULS.sendTraceTag(6654163,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",
w,m);if(m&&u){c.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const y={};y[k.a.jQa]="1";y[k.a.documentUrl]=w;f.AFrameworkApplication.uQ().execute(v=>{v.jj(t.a.SY,y)})}else h.a.gf(w,h.a.bX(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}hoa(w,m,u=null,y=null){c.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.rh&&(this.tga=this.rh.Gc("DialogShown","SaveToOneDriveUploadTime"));this.INb();this.x8=m;this.XCa=this.TUc.create(w,
u,y);this.Ah=y;this.aQ()}aQ(){c.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.XCa.execute(Object(b.a)(this,this.uZi,"onSaveToCloudUploadFinished"),Object(b.a)(this,this.tZi,"onSaveToCloudUploadFailed"))}uZi(w){this.PIa();this.GDa=!1;if(w&&w.data&&w.data.de){var m;if(({ht:m}=d.d(w.data.de)).returnValue)if(w=m,w.StatusCode!==l.a.IO&&w.StatusCode!==l.a.Ssb)c.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.XR();else{c.ULS.sendTraceTag(6590603,
216,50,"UploadToCloudManager upload success.");try{w.NewDocumentUrl&&""!==w.NewDocumentUrl?this.pQa(w.NewDocumentUrl):this.qQa()}catch(u){c.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",u.toString())}this.UHb()}else c.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",{["ResponseData"]:n.a.Yfb(w.data.de)}),this.XR()}else c.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.XR()}tZi(w){5!==w.data.status&&12!==w.data.status||
this.GDa?(c.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",w.data.status),this.PIa(),this.XR(),this.UHb()):(c.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.GDa=!0,this.aQ())}UHb(){this.tga&&(this.tga.stop(),this.tga=null)}}Object(r.a)(z,"UploadToCloudManager",null,[539])},1074:function(r,F,a){a.d(F,"a",function(){return c});r=a(0);class c{}c.default=0;Object(r.a)(c,"SaveToCloudErrorCodes",null,[])},1075:function(r,F,a){a.d(F,"a",
function(){return d});r=a(0);var c=a(15),b=a(85),e=a(1074),f=a(83);class d{constructor(h,l,k,t,n,z){this.Ah=null;this.kEg=h;this.P1=l;this.inb=k;this.mb=t;this.RRb=n;this.Es=z}start(h){this.Ah=h;if("SharePointOnlineConsumer"===this.mb.Wa("FileSource")){const l=f.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(l){l.start(null,h);return}}this.P1.hMa?(c.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),this.R0g()):(c.ULS.sendTraceTag(6590560,
216,50,"User is not signed in. We will show sign in dialog."),this.showSignInDialog())}showSignInDialog(){this.kEg.create().UP()}kj(){this.Es().displayError(e.a.default)}R0g(){try{c.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let h={["client_id"]:this.mb.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.RRb||2===this.RRb)h={["client_id"]:this.mb.appSettings.UploadToSkyDriveClientId};WL.init(h);c.ULS.sendTraceTag(6590562,216,50,"OneDrive API is initialized. Launching file dialogue");
WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(b.a)(this,this.onSuccess,"onSuccess"),Object(b.a)(this,this.d6,"onFailure"))}catch(h){c.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",h,h.stack),this.kj()}}onSuccess(h){c.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");h&&h.data&&h.data.folders&&this.inb.hoa(h.data.folders[0].id,h.data.folders[0].urls.viewInBrowser,null,this.Ah)}d6(h){if(h&&
h.error){if("user_canceled"===h.error.code){c.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}c.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",h.error.code,h.error.message)}else c.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.kj()}}Object(r.a)(d,"SaveToCloudManager",null,[658])},1076:function(r,F,a){a.d(F,"a",function(){return f});r=a(0);var c=a(15),b=a(40),e=a(79);a=a(722);class f extends a.a{constructor(d,
h){super(d,h);c.ULS.sendTraceTag(537170201,0,50,"WacGdprNoticeBusinessBarEntry.WacGdprNoticeBusinessBarEntry: Called");this.title="";this.message=f.Qxa;this.Xva=!0}get linkText(){return f.auf}lma(d){super.lma(d);b.a.openWindow(4,e.a.gH(f.$tf))}iD(d){super.iD(d);f.Qxd&&f.Qxd(null)}static initialize(d,h,l,k){c.ULS.sendTraceTag(537170200,0,50,"WacGdprNoticeBusinessBarEntry.Initialize: Called");f.Qxa=d;f.auf=h;f.$tf=l;f.Qxd=k}}f.Qxa=null;f.auf=null;f.$tf=null;f.Qxd=null;Object(r.a)(f,"WacGdprNoticeBusinessBarEntry",
a.a,[])},1077:function(r,F,a){a.d(F,"a",function(){return c});r=a(0);class c{}c.ouh="ewa-bb";c.puh="ewa-bb-entry";c.quh="ewa-bb-react";c.dRe="ewa-bb-entry-body";c.jRe="ewa-bb-icon";c.fRe="ewa-bb-entry-icon";c.iRe="ewa-bb-entry-title";c.hRe="ewa-bb-entry-message";c.H9b="ewa-bb-entry-button";c.gRe="ewa-bb-entry-link";c.eRe="ewa-bb-entry-close";c.I9b="ewa-bb-entry-button-holder";c.cRe="ewa-bb-content";Object(r.a)(c,"CssClassNames",null,[])},1078:function(r,F,a){a.d(F,"a",function(){return c});r=a(0);
a=a(722);class c extends a.a{constructor(b,e){super(b,e);this.Yr=!0;this.title=c.lpa;this.message=c.jpa}get actionButton(){return c.ipa}Sm(b){super.Sm(b);(b=c.kpa)&&b(null)}static initialize(b,e,f,d){c.lpa=b;c.jpa=e;c.ipa=f;c.kpa=d}}c.lpa=null;c.jpa=null;c.ipa=null;c.kpa=null;Object(r.a)(c,"AutomaticSensitivityLabelBusinessBarEntry",a.a,[])},1079:function(r,F,a){a.d(F,"a",function(){return c});r=a(0);a=a(722);class c extends a.a{constructor(b,e){super(b,e);this.Yr=!0;this.title=c.lpa;this.message=
c.jpa}get actionButton(){return c.ipa}Sm(b){super.Sm(b);(b=c.kpa)&&b(null)}static initialize(b,e,f,d){c.lpa=b;c.jpa=e;c.ipa=f;c.kpa=d}}c.lpa=null;c.jpa=null;c.ipa=null;c.kpa=null;Object(r.a)(c,"RecommendedSensitivityLabelBusinessBarEntry",a.a,[])},1080:function(r,F,a){a.d(F,"a",function(){return c});r=a(0);a=a(722);class c extends a.a{constructor(b,e){super(b,e);this.Yr=!0;this.title=c.lpa;this.message=c.jpa}get actionButton(){return c.ipa}Sm(b){super.Sm(b);(b=c.kpa)&&b(null)}static initialize(b,
e,f,d){c.lpa=b;c.jpa=e;c.ipa=f;c.kpa=d}}c.lpa=null;c.jpa=null;c.ipa=null;c.kpa=null;Object(r.a)(c,"MandatorySensitivityLabelBusinessBarEntry",a.a,[])},1081:function(r,F,a){a.d(F,"a",function(){return c});r=a(0);a=a(722);class c extends a.a{constructor(b,e){super(b,e);this.Yr=!0;this.title=c.nEb;this.message=c.Qxa}get actionButton(){return c.l9a}Sm(b){super.Sm(b);c.Sxa&&c.Sxa(null)}static initialize(b,e,f,d){c.nEb=b;c.Qxa=e;c.l9a=f;c.Sxa=d}}c.nEb=null;c.Qxa=null;c.l9a=null;c.Sxa=null;Object(r.a)(c,
"SensitivityLabelMinorVersionLimitReachedBusinessBarEntry",a.a,[])},1082:function(r,F,a){a.d(F,"a",function(){return c});r=a(0);a=a(722);class c extends a.a{constructor(b,e){super(b,e);c.l9a&&c.Sxa&&(this.Yr=!0);this.title=c.nEb;this.message=c.Qxa}get actionButton(){return c.l9a}Sm(b){super.Sm(b);c.Sxa&&c.Sxa(null)}static initialize(b,e,f,d){c.nEb=b;c.Qxa=e;c.l9a=f;c.Sxa=d}}c.nEb=null;c.Qxa=null;c.l9a=null;c.Sxa=null;Object(r.a)(c,"SensitivityApplicationSetLabelErrorBusinessBarEntry",a.a,[])},1084:function(r,
F,a){a.d(F,"a",function(){return c});var c;"undefined"==typeof c&&(c={});window.MSOJS=c;c.fhb=function(){function b(){return k()&&(v()||3<=(m()?C("version/"):0))}function e(){return 0<=window.navigator.userAgent.indexOf("Windows")}function f(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function d(){Ja||(Ja=!0,Na=h("Windows Phone"))}function h(wb){wb=(new RegExp(wb+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var lb=-1;return null!=wb&&2<=wb.length&&(lb=parseFloat(wb[1]),
isNaN(lb)&&(lb=-1)),lb}function l(){return"function"==typeof navigator.msLaunchUri&&!f()&&!y()&&!t()}function k(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function t(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function n(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function z(){return n()?8==window.document.documentMode:!1}function w(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function m(){return 0<=
window.navigator.userAgent.indexOf(" AppleWebKit/")}function u(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function y(){var wb=window.navigator.userAgent.toLowerCase();return 0<=wb.indexOf("android")&&0<=wb.indexOf("chrome")}function v(){return 3<=(w()?C("firefox/"):0)}function C(wb){var lb=window.navigator.userAgent.toLowerCase(),db=lb.indexOf(wb),Pa,ja;return 0<=db?(Pa=db+wb.length,ja=lb.length,parseInt(lb.substring(Pa,ja))):0}function x(wb,lb,db,Pa,ja){if(Pa&&null!=lb)lb();
else if(l())navigator.msLaunchUri(wb,lb,db);else if(!(u()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&k())||t())H(wb,lb,db);else if(u()&&ja)a:{try{window.open(wb,"_self")}catch(Ka){null!=db&&db();break a}null!=lb&&lb()}else B(wb,lb,db)}function B(wb,lb,db){var Pa=document.getElementById("OICLinkTag"),ja;null==Pa&&(Pa=document.createElement("a"),Pa.id="OICLinkTag",Pa.style.visibility="hidden",Pa.href="",Pa.target=0==(Ha.Options&
Oa.SupportsTopTargetNavigation)||Ha.NoBrowserModalDialogs?"_blank":"_top",document.body.appendChild(Pa),null!=Pa.addEventListener&&Pa.addEventListener("click",function(Ka){null!=Ka.stopPropagation&&Ka.stopPropagation()},!1));try{"undefined"==typeof MouseEvent&&(ja=function(Ka){var ub=document.createEvent("MouseEvent");return ub.initMouseEvent(Ka,!1,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),ub},ja.prototype=Event.prototype,window.MouseEvent=ja),Pa.href=wb,Pa.dispatchEvent(new MouseEvent("click"))}catch(Ka){null!=
db&&db();return}null!=lb&&lb()}function H(wb,lb,db){var Pa=document.getElementById("OICFrame");null==Pa&&(Pa=document.createElement("iframe"),Pa.className="ObjectInDialog",Pa.style.visibility="hidden",Pa.src="about:blank",document.body.appendChild(Pa),Pa.id="OICFrame");try{Pa.contentWindow.location.href=wb}catch(ja){null!=db&&db();return}null!=lb&&lb()}function I(wb){return 0!=(wb.Options&Oa.SkipProtocolHandler)||z()}function U(wb){return wb===Qa.ReadOnly||wb===Qa.ReadWrite}function S(wb,lb,db,Pa){var ja,
Ka;try{if(ja=new ActiveXObject(Ta),ja)return Ka=ja.ViewDocument3(window.self,wb,lb,Pa),Ka?(O(Ga.O14ActiveX),bb.None):bb.Failed}catch(ub){}if(Oa.O14Only===(db&Oa.O14Only))return Ha.DescriptiveUnattemptedEnums?bb.O14AttemptFailure:bb.Unattempted;try{if(ja=new ActiveXObject(Da),ja)return Ka=ja.ViewDocument3(window.self,wb,lb,Pa),Ka?(O(Ga.O12ActiveX),bb.None):bb.Failed}catch(ub){}if(Oa.O12UpOnly===(db&Oa.O12UpOnly))return Ha.DescriptiveUnattemptedEnums?bb.O12UpOnlyFail:bb.Unattempted;try{if(ja=new ActiveXObject(fa),
ja)return Ka=U(lb)?ja.ViewDocument2(window.self,wb,Pa):ja.EditDocument2(window.self,wb,Pa),Ka?(O(Ga.O11ActiveX),bb.None):bb.Failed}catch(ub){}return Ha.DescriptiveUnattemptedEnums?bb.ActiveXUnattempted:bb.Unattempted}function G(wb,lb,db,Pa,ja){var Ka,ub,Kb;wb==tb.Visio&&db==Qa.ReadWrite&&(db=Qa.WriteOnly);wb=ja;(Pa=Pa||f()&&!(d(),8<=Na))||(Ka="",Ka+=U(db)?nb+X:R,Ka+=wa,wb+=E(Ka));wb+=E(lb);Ha.NewTelemetryDataIsEnabled&&(ub=Ha.SessionOrigin?"|or|"+Ha.SessionOrigin:"",ub+=Ha.ClickTime?"|ct|"+Ha.ClickTime:
"",ub+=Ha.CorrelationId?"|cid|"+Ha.CorrelationId:"",wb+=E(ub),Ha.CorrelationIdForWinClient&&(wb+=E(Ha.CorrelationIdForWinClient)));lb=window.location.href;db=Ba;Pa=lb.toLowerCase().indexOf("&"+db+"=");var W;db=-1==Pa?void 0:(Kb=Pa+(db.length+2),W=lb.indexOf("&",Kb),-1==W)?lb.substr(Kb):lb.substring(Kb,W);if(null!=db&&"undefined"!=typeof db){Kb="";try{Kb=decodeURIComponent(db)}catch(za){}0<Kb.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(Kb)&&(wb+=na,wb+=Kb)}return wb}function D(wb,
lb,db,Pa,ja,Ka){var ub=Z(wb),Kb;return null==ub?(da(Ha.DescriptiveUnattemptedEnums?bb.ProtocolHandlerIsNull:bb.Unattempted,Ha.Application),!1):(Kb=G(wb,lb,db,Pa,ub),x(Kb,N,M,ja,Ka),!0)}function E(wb){if(k()&&u()){var lb="";try{lb=decodeURI(wb)}catch(db){}if(lb==wb)return encodeURI(wb)}return wb}function N(){O(Ga.ProtocolHandler)}function M(){Ha.Options|=Oa.SkipProtocolHandler;ra(Ha,Yb,mc)}function L(){null!=Zb&&Zb(Ga.RoamingProtocolHandler)}function aa(){null!=qb&&qb(bb.ControlNeeded)}function V(){var wb=
document.getElementById(fb),lb;if(null==wb){if(lb=ua,k()&&3<=(m()?C("version/"):0)&&P(Fa,!0)&&(lb=Fa),!P(lb,!0))if(k()&&P(Ca,!0))lb=Ca;else return null;wb=document.createElement("object");wb.id=fb;wb.type=lb;wb.style.width="0px";wb.style.height="0px";wb.style.setProperty("visibility","hidden","");document.body.appendChild(wb);wb=document.getElementById(fb)}return wb}function P(wb,lb){var db=window.navigator.mimeTypes,Pa;return null==db?!1:(Pa=db[wb],Pa)?lb&&!Pa.enabledPlugin?!1:!0:!1}function ba(wb){try{if(null!=
new ActiveXObject(wb))return!0}catch(lb){}return!1}function Y(wb){switch(wb){case tb.OneNote:return mb;default:return""}}function Z(wb){if(wb!=tb.OneNote&&f()&&!(d(),8<=Na))return"office:";switch(wb){case tb.Excel:return"ms-excel:";case tb.OneNote:return"onenote:";case tb.PowerPoint:return"ms-powerpoint:";case tb.Visio:return"ms-visio:";case tb.Word:return"ms-word:";case tb.Project:return"ms-project:";case tb.Publisher:return"ms-publisher:";case tb.Infopath:return"ms-infopath:";case tb.Access:return"ms-access:";
default:return""}}function ea(wb){switch(wb){case tb.Excel:return"root\\office15\\excel.exe";case tb.PowerPoint:return"root\\office15\\powerpnt.exe";case tb.Visio:return"root\\office15\\visio.exe";case tb.Word:return"root\\office15\\winword.exe";case tb.Project:return"root\\office15\\winproj.exe";case tb.Publisher:return"root\\office15\\mspub.exe";case tb.Infopath:return"root\\office15\\infopath.exe";case tb.Access:return"root\\office15\\msaccess.exe";default:return null}}function ra(wb,lb,db){if(Ha=
wb,Yb=lb,mc=db,wb.DocumentUrl){var Pa=db=lb=wb.DocumentUrl;try{Pa=decodeURIComponent(wb.DocumentUrl)}catch(za){}try{db=encodeURI(wb.DocumentUrl)}catch(za){}Ha.NewTelemetryDataIsEnabled||(lb=lb+""+wb.CorrelationIdForWinClient,Pa+=wb.CorrelationIdForWinClient,db+=wb.CorrelationIdForWinClient);wb.Mode===Qa.ReadWrite&&Oa.CheckoutRequired===(wb.Options&Oa.CheckoutRequired)&&(wb.Mode=Qa.ForceCheckout);Oa.HostIsEditOnly===(wb.Options&Oa.HostIsEditOnly)&&(wb.Mode=Qa.WriteOnly);if(I(wb)?0:k()&&(wb.Application==
tb.OneNote||P(ca,!1)||P(ka,!1))||l()||y()||!(b()||v()||"ActiveXObject"in window&&!f()||u())||15<=xa())D(wb.Application,wb.EncodeUrl?db:lb,wb.Mode,wb.Application==tb.OneNote,wb.SilentExternalHandler,wb.NavigateUsingWindowOpen);else{var ja;if(ja=z())a:{var Ka=wb.EncodeUrl?lb:Pa,ub=wb.Mode,Kb=Y(wb.Application);try{ja=(new ActiveXObject(Ma)).ViewDocument3(window.self,Ka,ub,Kb);break a}catch(za){}ja=!1}if(ja)O(Ga.O15ActiveX);else{if(b()||v()){var W=wb.EncodeUrl?lb:Pa;Pa=wb.Mode;ja=Y(wb.Application);Ka=
V();if(null==Ka)W=Ha.DescriptiveUnattemptedEnums?bb.PluginIsNull:bb.Unattempted;else{ub=!1;try{ub=Ka.ViewDocument3(window.self,W,Pa,ja)}catch(za){}if(!ub)try{ub=U(Pa)?Ka.ViewDocument2(window.self,W,ja):Ka.EditDocument2(window.self,W,ja)}catch(za){}W=ub?(O(Ga.NpapiPlugin),bb.None):bb.Failed}}else{try{W=new ActiveXObject(yb),null!=W&&W.SaveSSOCreds()}catch(za){}W=S(wb.EncodeUrl?lb:Pa,wb.Mode,wb.Options,Y(wb.Application))}if(W!=bb.None){if(Pa=wb.CouldUseRoamingApps)Ya||(Ya=!0,Gb=h("Windows NT")),Pa=
6.1<=Gb&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(n()||v()||u());if(Pa&&wb.Application!=tb.OneNote){if(!c.fhb.g8j()){da(bb.ControlNeeded,Ha.Application);return}if(wb.RoamingAppsLauncher){"undefined"==typeof wb.RoamingAppsLauncher||null==wb.RoamingAppsLauncher?da(Ha.DescriptiveUnattemptedEnums?bb.RoamingLauncherIsNull:bb.Unattempted,Ha.Application):"undefined"==typeof wb.RoamingBitsUrl||null==wb.RoamingBitsUrl?c.fhb.r8j(wb.DocumentUrl,wb.RoamingAppsLauncher,wb.Application,wb.ApplicationParameters,
Yb,mc):c.fhb.jqg(wb.DocumentUrl,wb.RoamingAppsLauncher,wb.RoamingApplicationExe,wb.ApplicationParameters,wb.RoamingPlatform,wb.RoamingBitsUrl,Yb,mc);return}if(!wb.ContinueIfLauncherIsNull){da(bb.LauncherNeeded,Ha.Application);return}}Oa.NoProtocolHandlerFallback==(wb.Options&Oa.NoProtocolHandlerFallback)||I(wb)||n()||k()&&!(Ha.DescriptiveUnattemptedEnums?W>=bb.O14Unattempted&&W<=bb.DocumentUrlIsNull:W==bb.Unattempted)?da(W,Ha.Application):D(wb.Application,wb.EncodeUrl?db:lb,wb.Mode,wb.Application==
tb.OneNote,wb.SilentExternalHandler,wb.NavigateUsingWindowOpen)}}}}else da(Ha.DescriptiveUnattemptedEnums?bb.DocumentUrlIsNull:bb.Unattempted,Ha.Application)}function O(wb){null!=Yb&&Yb(wb)}function da(wb,lb){"undefined"==typeof lb&&(lb=null);null!=mc&&mc(wb,lb)}function xa(){var wb=0;if(b()||v()||u()){var lb=V();try{null!=lb&&(wb=lb.GetOfficeVersion())}catch(db){}}else ba(Ma)?wb=15:ba(Ta)?wb=14:ba(Da)?wb=12:ba(fa)&&(wb=11);return wb}function ia(){return k()&&(P(ua,!0)||P(Fa,!0))}var Ma="SharePoint.OpenDocuments.5",
Ta="SharePoint.OpenDocuments.4",Da="SharePoint.OpenDocuments.3",fa="SharePoint.OpenDocuments.2",ua="application/x-sharepoint",Fa="application/x-sharepoint-webkit",ca="application/x-sharepoint-protocolhandler",ka="application/x-sharepoint-webkit-protocolhandler",Ca="application/officelive",fb="npSharePointPlugin",yb="IDBHO.IDBHOCtrl",mb="OneNote.Notebook",nb="ofv|",X="ofc|",R="ofe|",wa="u|",na="|f|",Ba="wdlor",Ra="",qa="",La="",Yb,mc,Zb,qb,Ha,Ya,Gb,Ja,Na,Qa={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,
WriteLocalCopy:4,OpenInBrowser:5},Oa={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},bb={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},Ga={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,
O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},tb={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:Qa,OpenDocumentOptions:Oa,OpenDocumentFailureType:bb,OpenDocumentControl:Ga,OfficeApplication:tb,EditDocumentInClient:ra,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=0;this.Application=tb.Unknown;this.CouldUseRoamingApps=
!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:xa,IsO14MacPluginInstalled:ia,OfferOfficeInDialog:function(){return e()&&
11>=xa()},OfferOfficeNoIntrusive:function(){return e()&&15>xa()},OfferMacOffice:function(){return k()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!ia()},InstallRoamingControl:function(){w()?window.InstallTrigger.install({Office:{URL:qa}}):H(La,null,null)},CanUseRoamingControl:function(){var wb,lb,db;if(l())return!0;if(u())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];if(w())return wb=document.createElement("RoamingExtensionElement"),
document.documentElement.appendChild(wb),lb=document.createEvent("Events"),lb.initEvent("RoamingOfficeInstalled",!0,!1),wb.dispatchEvent(lb),!!wb.getAttribute("installed");if(n())try{return db=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),db.HrExists()}catch(Pa){}return!1},InitUrls:function(wb,lb,db){Ra=wb;qa=db;La=lb},LaunchRoamingApps:function(wb,lb,db,Pa,ja,Ka){c.fhb.jqg(wb,lb,ea(db),Pa,"x86",Ra,ja,Ka)},LaunchRoamingApps2:function(wb,lb,db,Pa,ja,Ka,ub,Kb){var W="",za;if(null!=Pa&&(W+=
" "+Pa),null!=wb&&(W+=' "'+wb+'"'),l()||u())Zb=ub,qb=Kb,ub='office: "'+(Ka+'" "')+(db+'" "ROAMING"'),ub+=' "'+lb+'"',ub+=' "'+ja+'"',ub+=" "+W,x(ub,L,aa,!1,!1);else if(w())wb=document.createElement("RoamingExtensionElement"),wb.setAttribute("cabUrl",Ka),wb.setAttribute("app",db),wb.setAttribute("licensingEntitlements",lb),wb.setAttribute("platform",ja),wb.setAttribute("args",W),document.documentElement.appendChild(wb),lb=document.createEvent("Events"),lb.initEvent("RoamingOfficeLaunch",!0,!1),wb.dispatchEvent(lb),
null!=ub&&ub(Ga.RoamingFFExtension);else if(n()){if(za=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=za)try{za.HrConfigureSingle(Ka,db,lb,ja,W),null!=ub&&ub(Ga.RoamingActiveX)}catch(Sa){}}else null!=Kb&&Kb(bb.Failed)},ShouldShowDialog:function(){return!f()},NavigateToUrlUsingClickingOnATag:B,OpenDocumentWithProtocolHandler:D,OpenDocumentWithProtocolHandlerNoCallBack:function(wb,lb,db,Pa){var ja=Z(wb),Ka;return null==ja?(da(Ha.DescriptiveUnattemptedEnums?bb.ProtocolHandlerNoCallbackIsNull:
bb.Unattempted,Ha.Application),!1):(Ka=G(wb,lb,db,Pa,ja),x(Ka,null,null,!1,!1),!0)}}}();c.ClientUtils=c.fhb},1085:function(r,F,a){a.d(F,"a",function(){return b});r=a(0);var c=a(40);class b{constructor(e,f){this._url=e;this.qBg=f}bwe(){}Z8c(){this.qBg?c.a.downloadFile(this._url):c.a.gf(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(r.a)(b,"OpenUrlInTabDialogDownloadBehavior",null,[148,2])},1086:function(r,F,a){a.d(F,"a",function(){return b});var c=a(512);
const b=()=>{c.a.Bi('.HyperlinkDialog .ewa-dlg-body-sectionlabel{margin-bottom:5px}.HyperlinkDialog .disabledInput{background-color:#ebebe4;border:solid 1px #b5b5b5}.HyperlinkDialog .ewa-dlg-body-fullLine{width:inherit;min-width:318px;padding-right:5px;padding-left:25px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-fullLine{padding-right:25px;padding-left:5px}.HyperlinkDialog input[type="text"]{width:100%;outline:none;padding-left:3px;border:solid 1px #ccc}.HyperlinkDialog .ewa-dlg-body-sectionbreak{height:50px;position:relative}.HyperlinkDialog input[type="radio"]{position:absolute;left:0}.ewa-dlg-elements-container-rtl .HyperlinkDialog input[type="radio"]{left:auto;right:0}.HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-left:24px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-right:24px;margin-left:auto}.ValidationLabel{position:relative;display:block}.ValidationLabelWarning{color:#cc4200}.ValidationLabelError{color:#d90000}.ValidationWarningGlowColor,.ValidationErrorGlowColor,.ValidationLableGlow{border-style:solid;border-width:1px;transition:all .2s ease-in-out}.HyperlinkDialog div .ValidationErrorGlowColor{box-shadow:0 0 2px #d90000;border-color:#d90000}.HyperlinkDialog div .ValidationWarningGlowColor{box-shadow:0 0 2px #cc4200;border-color:#cc4200}')}},
1087:function(r,F,a){a.d(F,"a",function(){return d});r=a(0);var c=a(1217),b=a(4),e=a(54),f=a(83);class d{constructor(h,l,k,t,n,z){this.JX=h;this.KX=l;this.mMc=k;this.PD=t;this.jTb=n;this.fVa=z}get Z9f(){return!this.KX&&!this.mMc}get Jyf(){return 2===this.fVa?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get DQe(){return CommonUIStrings.l_OICErrorMessageNoOffice}get ndf(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get cwa(){return CommonUIStrings.l_OICErrorHelpLink}get Qbf(){return"OICFailure"}get icon(){return 3}get uZb(){return 2===
this.fVa?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}get el(){return CommonUIStrings.l_DefaultDialogTitle}Tcj(h){this.fzf(h)}Pzi(h){this.fzf(h)}fzf(h){let l=10;1===h?(f.a.instance.resolve("Common.IOfficeTrialExperience").slc(this.fVa),l=3):2===h&&((!this.mMc||this.mMc(this.PD))&&this.KX&&c.a.instance.hfh(this.KX,this.JX,this.PD),l=5);(0===h||1===h)&&this.JX&&this.JX(this.PD);b.AFrameworkApplication.xvc(e.a.MKf,this.jTb,l);this.dispose()}dispose(){this.PD=
this.KX=this.JX=null}}Object(r.a)(d,"AOICErrorDialogWithTrial",null,[2])},1088:function(r,F,a){a.d(F,"a",function(){return d});r=a(0);var c=a(1384),b=a(4),e=a(39),f=a(79);class d{constructor(){this.BaseDocQuerySignature=null;this.RoamingApp=0}EQd(){return e.c([this.Maa(),this])}execute(h,l,k){let t="RoamingAppsHandler.ashx";c.a.instance.roamingAppsAreEnabled&&0<document.URL.toUpperCase().indexOf("WDENABLEROAMING=1")&&(t=f.a.wl(t,"wdEnableRoaming","1"));b.AFrameworkApplication.Bd.Jm(t,2,this.EQd(),
{"Content-Type":"application/json; charset=utf-8"},!1,this.Kxb(),h,l,k,void 0,void 0,void 0,void 0,"6")}}Object(r.a)(d,"ARoamingAppsRequest",null,[])},1089:function(r,F,a){a.d(F,"a",function(){return b});var c=a(512);const b=()=>{c.a.Bi(".ewa-presentMode-overlay{pointer-events:none}.ewa-presentMode-panel-container{z-index:1054;position:absolute;bottom:32px;visibility:hidden}.ewr-presentMode-on .ewa-presentMode-panel-container{visibility:visible}.ewa-presentMode-rowHdrParent-container{position:relative;z-index:1055}.ewa-presentMode-right-frame{position:absolute;bottom:32px;top:0;right:0;width:0;opacity:0;background-color:#f5f5f5}.ewr-presentMode-on .ewa-presentMode-right-frame{width:32px;opacity:1;background-color:#323130}.ewr-presentMode-on-rtl .ewa-presentMode-right-frame{width:0;opacity:0}.ewr-presentMode-on-headers-off .ewa-presentMode-right-frame{width:12px !important;opacity:1}.ewr-namedsheetview .ewa-presentMode-right-frame{background-color:#000 !important}.ewr-presentMode-transition .ewa-presentMode-right-frame{transition:background-color .4s linear}.ewr-presentMode-on #dialogHost{z-index:1056 !important}")}},
1090:function(r,F,a){a.d(F,"a",function(){return b});var c=a(512);const b=()=>{c.a.Bi('.PrintDialogBody{height:260px;width:516px;margin-top:17px}.PrintDialogTitle{font-size:21px;margin-top:14px;margin-left:18px;font-family:"Segoe UI Light"}.ewa-dlg-elements-container-rtl .PrintDialogTitle{margin-left:auto;margin-right:18px}.PrintDialogLeftContainer{float:left;width:240px;height:100%;font-size:14px;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogLeftContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRightContainer{float:left;font-size:14px;width:240px;height:inherit;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogRightContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRadioButtonContainer{width:224px;height:32px;display:flex;align-items:center}.PrintRadioButtonElementInnerDiv{vertical-align:middle;display:table-cell}.PrintRadioButtonElementOuterDiv{position:absolute;top:0;left:64px;height:32px;width:140px;vertical-align:middle;display:table}.ewa-dlg-elements-container-rtl .PrintRadioButtonElementOuterDiv{left:auto;right:64px}.PrintDialogTitleSection{width:224px;height:19px}.PrintDialogComboBoxContainer{width:224px;height:32px;margin-top:12px}.PrintRadioButtonIcon{margin:0 16px;vertical-align:middle}.PrintButtonArea{margin-right:32px}.ewa-dlg-elements-container-rtl .PrintButtonArea{margin-right:auto;margin-left:32px}.PrintPreviewerContainer{height:100%;width:100%;z-index:998;position:absolute;background:#edebe9}.ewa-hide-print-elements-siblings{display:none}')}},
1091:function(r,F,a){a.d(F,"a",function(){return b});var c=a(512);const b=()=>{c.a.Bi(".ewa-resizehdr-row-hidden{width:inherit;height:0}.ewa-resizehdr-col-hidden{width:0;height:inherit}")}},1097:function(r,F,a){a.d(F,"a",function(){return b});r=a(0);var c=a(15);class b{constructor(e){this.isEnabled=Boolean.parse(e.DirectPrintIsEnabled||"false");Boolean.parse(e.DirectPrintProbeIsEnabled||"false");this.Bqi=Boolean.parse(e.DirectPrintEnabledForInternetExplorer||"false");this.pTa=(e.DirectPrintSupportedMimeTypes||
"").split(b.E8c);this.qTa=(e.DirectPrintSupportedPlugins||"").split(b.E8c);this.Gei=(e.DirectPrintImmersivePreviewPlugins||"").split(b.E8c);this.gif=Boolean.parse(e.DirectPrintEnabledForEdge||"false");this.ani=Boolean.parse(e.ChromePrintLayoutFixIsEnabled||"false");this.v4g=parseInt(e.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.vzd=14;this.cwf=14394;if(e=e.DirectPrintMinimalSupportedEdgeVersion){const f=e.split(".");2===f.length?(this.vzd=parseInt(f[0]),this.cwf=parseInt(f[1])):c.ULS.sendTraceTag(20734112,
208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",e)}else c.ULS.sendTraceTag(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}b.E8c=",";Object(r.a)(b,"DirectPrintBrsSettings",null,[])},1098:function(r,F,a){a.d(F,"a",function(){return c});r=a(0);class c{constructor(){this.isExportPdfMode=this.printOperationCallbacks=this.universalPrintAppSettings=this.setAdditionalHeaderText=this.disableBackToSheetButton=this.disableTellMeControl=
this.logger=this.printPreviewPaneCallbacks=this.backActionButtonText=null}}Object(r.a)(c,"PrintPreviewPaneProps",null,[])},1167:function(r,F,a){var c=a(9),b=a(0),e=a(15),f=a(4),d=a(1367),h=a(709),l=a(50),k=a(37),t=a(1),n=a(920),z=a(65),w=a(41),m=a(189),u=a(21),y=a(377),v=a(575);class C{constructor(jb,Wb){this.YHd=0;this.bae=!1;this.Vz=jb;this.ignorePrintArea=Wb}get Vz(){return this.YHd}set Vz(jb){0<=jb&&2>=jb?this.YHd=jb:(e.ULS.sendTraceTag(537154308,0,10,"Attempt to set invalid state. Setting ActiveSheets instead."),
this.YHd=1)}get ignorePrintArea(){return this.bae}set ignorePrintArea(jb){jb||!jb?this.bae=jb:e.ULS.sendTraceTag(537154307,0,10,"Attempt to set invalid ignorePrintArea")}}Object(b.a)(C,"PdfPrintDialogBrowserSessionState",null,[]);var x=a(7),B=a(135),H=a(174),I=a(99),U=a(1422);class S{constructor(jb,Wb){this.multiRange=null;this.addToPrintArea=!1;this.multiRange=jb;this.addToPrintArea=Wb}}Object(b.a)(S,"MacroRecorderPrintAreaSetPayload",null,[162]);var G=a(376),D=a(193),E=a(11),N=a(13),M=a(282),L=
a(66);class aa{constructor(jb){this.sharedSheetCell=null;this.sharedSheetCell=jb}}Object(b.a)(aa,"MacroRecorderPageBreakInsertedPayload",null,[162]);class V{constructor(jb){this.sharedSheetCell=null;this.sharedSheetCell=jb}}Object(b.a)(V,"MacroRecorderPageBreakRemovedPayload",null,[162]);class P{constructor(jb){this.sheetName=null;this.sheetName=jb}getSheetName(){return this.sheetName}}Object(b.a)(P,"MacroRecorderPageBreaksAllResetPayload",null,[162]);class ba{constructor(jb){this.sheetName=null;
this.sheetName=jb}getSheetName(){return this.sheetName}}Object(b.a)(ba,"MacroRecorderPrintAreaClearedPayload",null,[162]);var Y=a(60);const Z=(jb,Wb,wc,Jc,zc,gd,Va,Eb=null)=>{Eb=jb.Na(9,Eb);Eb.sheetName=Wb;Eb.printSettings=wc;return Y.g(jb,"SetSheetPrintSettings",Eb,Jc,zc,gd,Va,0)},ea=(jb,Wb,wc,Jc,zc,gd,Va=null)=>{Va=jb.Na(1,Va);Va.ConvertInParameters=Wb;return Y.g(jb,"ConvertWorkbookToPrintPdf",Va,wc,Jc,zc,gd,4)},ra=(jb,Wb,wc,Jc,zc,gd,Va,Eb=null)=>{Eb=jb.Na(1,Eb);Eb.sheetName=Wb;Eb.printOptions=
wc;return Y.g(jb,"SetPrintOptions",Eb,Jc,zc,gd,Va,0)},O=(jb,Wb,wc,Jc,zc,gd,Va,Eb=null)=>{Eb=jb.Na(1,Eb);Eb.sheetName=Wb;Eb.locale=wc;return Y.g(jb,"GetPrintSettings",Eb,Jc,zc,gd,Va,4)},da=(jb,Wb,wc,Jc,zc,gd,Va,Eb=null)=>{Eb=jb.Na(1,Eb);Eb.selectedRanges=Wb;Eb.addToPrintArea=wc;return Y.g(jb,"SetPrintArea",Eb,Jc,zc,gd,Va,0)},xa=(jb,Wb,wc,Jc,zc,gd,Va=null)=>{Va=jb.Na(1,Va);Va.sheetName=Wb;return Y.g(jb,"ClearPrintArea",Va,wc,Jc,zc,gd,0)},ia=(jb,Wb,wc,Jc,zc,gd,Va=null)=>{Va=jb.Na(9,Va);Va.sheetCell=
Wb;return Y.g(jb,"InsertPageBreak",Va,wc,Jc,zc,gd,0)},Ma=(jb,Wb,wc,Jc,zc,gd,Va=null)=>{Va=jb.Na(9,Va);Va.sheetCell=Wb;return Y.g(jb,"RemovePageBreak",Va,wc,Jc,zc,gd,0)},Ta=(jb,Wb,wc,Jc,zc,gd,Va=null)=>{Va=jb.Na(9,Va);Va.sheetName=Wb;return Y.g(jb,"ResetAllPageBreaks",Va,wc,Jc,zc,gd,0)};var Da=a(129),fa=a(115),ua=a(52),Fa=a(194);class ca{constructor(){this.Col=this.Row=null}}Object(b.a)(ca,"PageBreaksInformation",null,[]);class ka{constructor(){this.Max=this.Min=this.Index=0}}Object(b.a)(ka,"RowColBreak",
null,[]);class Ca{constructor(){this.LastColumn=this.LastRow=this.FirstColumn=this.FirstRow=0}}Object(b.a)(Ca,"SharedRange",null,[]);var fb=a(179),yb=a(55);class mb{constructor(jb){this.ribbonCommandInfo=this.lHb=null;this.tVj=(Wb,wc,Jc)=>{wc=!!Wb&&!!Wb.RequestTelemetryData;u.h(this.$).wh&&u.h(this.$).wh.Fla(this.eLa.ma(this.ribbonCommandInfo.command),Wb.StateId,wc?Wb.RequestTelemetryData.EcsOperationDuration:0,wc?Wb.RequestTelemetryData.EcsRequestDuration:0,wc?Wb.RequestTelemetryData.WfeRequestDuration:
0);E.HelperMethods.RZ&&this.x3g(Jc)};this.$=jb;this.eLa=new fb.a;this.Ova=new fb.a;this.Ova.add(78661008,12);this.Ova.add(275604654,13);this.Ova.add(-13332329,14);this.Ova.add(-837651977,9);this.Ova.add(-1778266776,10);this.Ova.add(845325699,11)}executeCommand(jb,Wb,wc,Jc,zc=null,gd=null,Va=null){this.ribbonCommandInfo=Wb;this.rNj(Wb.command);jb=M.b(zc,this.tVj);e.ULS.sendTraceTag(543794888,0,50,`PrintCommandHandler.ExecuteCommand: ${Wb.command} command execution started`);switch(Wb.command){case 78661008:return this.haf(Wb,
jb,gd,Va,!1);case 275604654:return this.haf(Wb,jb,gd,Va,!0);case -13332329:return this.f$e(Wb,jb,gd,Va);case -837651977:return this.X9h(Wb,jb,gd,Va);case -1778266776:return this.Z$h(Wb,jb,gd,Va);case 845325699:return this.caf(Wb,jb,gd,Va)}return m.a(Wb.command)}wc(jb,Wb){switch(Wb.command){case 78661008:case 275604654:case -837651977:case -1778266776:return 1===jb;case 845325699:case -13332329:return!0}return!1}f6f(jb,Wb,wc){const Jc=u.h(this.$);var zc=Jc.Ca;const gd=w.r(Jc.ha.qa.selectedRanges,this.$);
if((zc=zc.MA())&&zc.length){for(const Va of zc){zc=Va;const Eb=zc.lf;if(!Eb)continue;const hc=w.j(zc.De),Ab=[];for(const Bb of gd.Ranges){if(Bb.FirstRow>hc.LastRow+1||Bb.LastRow<hc.FirstRow||Bb.FirstColumn>hc.LastColumn+1||Bb.LastColumn<hc.FirstColumn)continue;const ec=this.B0h(hc,Bb,Eb),Qd=this.A0h(hc,Bb,Eb);Ab.push(Object(x.a)(new Ca,{FirstRow:ec.FirstRow,FirstColumn:Qd.FirstColumn,LastRow:ec.LastRow,LastColumn:Qd.LastColumn}))}0<Ab.length&&!wc?Eb.setPrintArea(Ab):0<Ab.length&&wc?Eb.addToPrintArea(Ab):
!wc&&Eb.hasPrintArea()&&Eb.clearPrintArea();!Eb.isDirty()&&Eb.hasPageLayout()&&Eb.setDirty("PrintAreaBreakManager::SetPrintAreaInstantaneous, hash: "+zc.Zc,4)}this.CPb(Jc,jb,Wb)}}l5g(jb,Wb){const wc=u.h(this.$);var Jc=u.h(this.$).Ca.MA();if(Jc&&Jc.length){for(const zc of Jc){Jc=zc;const gd=Jc.lf;gd&&(gd.clearPrintArea(),!gd.isDirty()&&gd.hasPageLayout()&&gd.setDirty("PrintAreaBreakManager::ClearPrintAreaInstantaneous, hash: "+Jc.Zc,4))}this.CPb(wc,jb,Wb)}}rji(jb,Wb){const wc=u.h(this.$);var Jc=wc.Ca;
const zc=w.o(wc.ha.qa.activeCell,this.$);if(zc){var gd=Jc.MA();if(gd&&gd.length){Jc=null;for(var Va of gd){let Eb=Va,hc=Eb.lf;if(!hc)continue;let Ab=w.j(Eb.De);if(!(zc.FirstRow>Ab.LastRow||zc.FirstRow<Ab.FirstRow||zc.FirstColumn>Ab.LastColumn||zc.FirstColumn<Ab.FirstColumn)&&(Jc=this.tfh(hc,Ab,zc),hc.insertPageBreak(Jc),!hc.isDirty()&&hc.hasPageLayout()&&hc.setDirty("PrintAreaBreakManager::InsertPageBreakInstantaneous, hash: "+Eb.Zc,4),Jc))break}if(!Jc)for(const Eb of gd)if(Jc=Eb,Va=Jc.lf)Jc=w.j(Jc.De),
Jc=this.HIe(Va,Jc,zc),Va.insertPageBreak(Jc);this.CPb(wc,jb,Wb)}}}Fij(jb,Wb){const wc=u.h(this.$);var Jc=wc.Ca;const zc=w.o(wc.ha.qa.activeCell,this.$);if(zc&&(Jc=Jc.MA())&&Jc.length){for(const Va of Jc){Jc=Va;const Eb=Jc.lf;if(Eb){var gd=w.j(Jc.De);(gd=this.HIe(Eb,gd,zc))&&Eb.removePageBreak(gd);!Eb.isDirty()&&Eb.hasPageLayout()&&Eb.setDirty("PrintAreaBreakManager::RemovePageBreakInstantaneous, hash: "+Jc.Zc,4)}}this.CPb(wc,jb,Wb)}}uoj(jb,Wb){const wc=u.h(this.$);var Jc=wc.Ca.MA();if(Jc&&Jc.length){for(const zc of Jc){Jc=
zc;const gd=Jc.lf;gd&&(gd.resetAllPageBreak(),!gd.isDirty()&&gd.hasPageLayout()&&gd.setDirty("PrintAreaBreakManager::ResetAllPageBreakInstantaneous, hash: "+Jc.Zc,4))}this.CPb(wc,jb,Wb)}}haf(jb,Wb,wc,Jc,zc){if(!zc){var gd=this.$.yb.getItemByName("PRINT_AREA");if(gd&&(e.ULS.sendTraceTag(537154306,0,15,`PrintCommandHandler.HandleSetPrintAreaCommand: Print_Area already present as NamedObject of type : ${gd.type}`),2===gd.type))return this.Vki(),yb.Task.Sa(!0)}gd=u.h(this.$).ha.qa;const Va=w.r(gd.selectedRanges,
this.$);if(1===Va.Ranges.length&&!zc){if(gd.Hba())return this.pai(jb,Va,Wb,wc,Jc,zc),yb.Task.Sa(!0);if(w.R(Va.Ranges[0]))return this.$.va.na.hasPrintArea?this.f$e(jb,Wb,wc,Jc):yb.Task.Sa(!0)}this.f6f(jb.command,Jc,zc);return this.mgf(jb,Wb,wc,Va,zc)}f$e(jb,Wb,wc,Jc){this.l5g(jb.command,Jc);return this.Hki(jb,Wb,wc)}X9h(jb,Wb,wc,Jc){this.rji(jb.command,Jc);return this.Ski(jb,Wb,wc)}Z$h(jb,Wb,wc,Jc){const zc=w.r(u.h(this.$).ha.qa.selectedRanges,this.$);if(w.R(zc.Ranges[0]))return this.caf(jb,Wb,wc,
Jc);this.Fij(jb.command,Jc);return this.Xki(jb,Wb,wc)}caf(jb,Wb,wc,Jc){this.uoj(jb.command,Jc);return this.$ki(jb,Wb,wc)}mgf(jb,Wb,wc,Jc,zc){const gd=this.$.oa.xa,Va=()=>new S(Jc,zc);return G.a(this.$.userOperationManager,(Eb,hc,Ab)=>da(gd,Jc,zc,M.b(Eb,Wb),M.a(hc,wc),Ab,null),Eb=>new D.a(241,0,Eb,64,Va),jb)}Hki(jb,Wb,wc){const Jc=this.$.va.na.name,zc=this.$.oa.xa,gd=()=>new ba(Jc);return G.a(this.$.userOperationManager,(Va,Eb,hc)=>xa(zc,Jc,M.b(Va,Wb),M.a(Eb,wc),hc,null),Va=>new D.a(243,0,Va,64,gd),
jb)}Ski(jb,Wb,wc){const Jc=u.h(this.$),zc=w.o(Jc.ha.qa.activeCell,this.$),gd=()=>new aa(zc);return G.a(this.$.userOperationManager,(Va,Eb,hc)=>ia(this.$.oa.xa,zc,M.b(Va,Wb),M.a(Eb,wc),hc,null),Va=>new D.a(244,0,Va,64,gd),jb)}Xki(jb,Wb,wc){const Jc=u.h(this.$),zc=w.o(Jc.ha.qa.activeCell,this.$),gd=()=>new V(zc);return G.a(this.$.userOperationManager,(Va,Eb,hc)=>Ma(this.$.oa.xa,zc,M.b(Va,Wb),M.a(Eb,wc),hc,null),Va=>new D.a(245,0,Va,64,gd),jb)}$ki(jb,Wb,wc){const Jc=this.$.va.na.name,zc=()=>new P(Jc);
return G.a(this.$.userOperationManager,(gd,Va,Eb)=>Ta(this.$.oa.xa,Jc,M.b(gd,Wb),M.a(Va,wc),Eb,null),gd=>new D.a(246,0,gd,64,zc),jb)}B0h(jb,Wb,wc){if(!jb||!Wb||!wc)return null;const Jc=new Ca;Jc.FirstRow=Wb.FirstRow===jb.LastRow+1?wc.getRowIndex(jb.LastRow+1)+1:Wb.FirstRow<jb.FirstRow?0:wc.getRowIndex(Wb.FirstRow+1);Jc.LastRow=Wb.FirstRow===jb.LastRow+1||Wb.LastRow>jb.LastRow?wc.getRowIndex(jb.LastRow+1)+1:wc.getRowIndex(Wb.LastRow+1);return Jc}A0h(jb,Wb,wc){if(!jb||!Wb||!wc)return null;const Jc=
new Ca;Jc.FirstColumn=Wb.FirstColumn===jb.LastColumn+1?wc.getColumnIndex(jb.LastColumn+1)+1:Wb.FirstColumn<jb.FirstColumn?0:wc.getColumnIndex(Wb.FirstColumn+1);Jc.LastColumn=Wb.FirstColumn===jb.LastColumn+1||Wb.LastColumn>jb.LastColumn?wc.getColumnIndex(jb.LastColumn+1)+1:wc.getColumnIndex(Wb.LastColumn+1);return Jc}tfh(jb,Wb,wc){if(!Wb||!wc||!jb)return null;const Jc=jb.getPrintArea();if(!Jc||!Jc.length)return null;const zc=jb.getRowIndex(wc.FirstRow+1),gd=jb.getColumnIndex(wc.FirstColumn+1);let Va=
null,Eb=null;for(const hc of Jc)if(zc>=hc.FirstRow&&zc<=hc.LastRow&&gd>=hc.FirstColumn&&gd<=hc.LastColumn){if(wc.FirstRow===hc.FirstRow&&wc.FirstColumn===hc.FirstColumn)return new ca;zc>hc.FirstRow&&(Va=Object(x.a)(new ka,{Index:zc-1,Min:hc.FirstColumn-1,Max:Math.min(hc.LastColumn,jb.getColumnIndex(Wb.LastColumn+1))}));gd>hc.FirstColumn&&(Eb=Object(x.a)(new ka,{Index:gd-1,Min:hc.FirstRow-1,Max:Math.min(hc.LastRow,jb.getRowIndex(Wb.LastRow+1))}));break}return Va||Eb?Object(x.a)(new ca,{Row:Va?[Va]:
null,Col:Eb?[Eb]:null}):null}Jgh(jb,Wb,wc){if(!Wb||!wc||!jb)return null;let Jc=null;wc.FirstRow>Wb.FirstRow&&wc.FirstRow<=Wb.LastRow?Jc=Object(x.a)(new ka,{Index:jb.getRowIndex(wc.FirstRow+1)-1,Min:-1,Max:-1}):wc.FirstRow===Wb.LastRow+1&&(Jc=Object(x.a)(new ka,{Index:jb.getRowIndex(Wb.LastRow+1),Min:-1,Max:-1}));return Jc}dch(jb,Wb,wc){if(!Wb||!wc||!jb)return null;let Jc=null;wc.FirstColumn>Wb.FirstColumn&&wc.FirstColumn<=Wb.LastColumn?Jc=Object(x.a)(new ka,{Index:jb.getColumnIndex(wc.FirstColumn+
1)-1,Min:-1,Max:-1}):wc.FirstColumn===Wb.LastColumn+1&&(Jc=Object(x.a)(new ka,{Index:jb.getColumnIndex(Wb.LastColumn+1),Min:-1,Max:-1}));return Jc}HIe(jb,Wb,wc){if(!wc||!jb||!Wb)return null;const Jc=this.Jgh(jb,Wb,wc);jb=this.dch(jb,Wb,wc);return Jc||jb?Object(x.a)(new ca,{Row:Jc?[Jc]:null,Col:jb?[jb]:null}):null}Vki(){const jb=new B.StandardDialog;jb.Ob=0;jb.tc(1,N.a.instance.ga(4));jb.Wl(N.a.instance.ga(568),N.a.instance.ga(569),1,null)}rNj(jb){if(this.Ova.hb(jb)&&(E.HelperMethods.RZ&&(this.lHb=
this.$.Jb.Gc("UserAction","PrintAreaPageBreaksTimeStopwatch")),this.eLa.hb(jb)&&this.eLa.remove(jb),this.eLa.add(jb,H.a.create().toString()),u.h(this.$).wh)){const Wb=ua.b()?ua.b().Cj(jb):"";u.h(this.$).wh.z0(this.Ova.ma(jb),this.eLa.ma(jb),Wb)}}x3g(jb){if(this.lHb&&jb){const Wb=this.lHb.Bc;this.lHb.stop();this.lHb=null;switch(jb){case "SetPrintArea":this.grb(Wb,1700,jb);break;case "ClearPrintArea":this.grb(Wb,1500,jb);break;case "InsertPageBreak":this.grb(Wb,1500,jb);break;case "RemovePageBreak":this.grb(Wb,
1600,jb);break;case "ResetAllPageBreaks":this.grb(Wb,1700,jb)}}}grb(jb,Wb,wc){jb>Wb&&(Wb=Object(x.a)(new Fa.a,{extendedProperties:new Map}),Wb.extendedProperties.set("OperationName",wc),Wb.extendedProperties.set("OperationExecutionTime",jb.toString()),I.Health.instance.recordQosError(Da.a.dMj,[fa.a.ZLj],!1,!0,!0,!1,Wb))}pai(jb,Wb,wc,Jc,zc,gd){const Va=new B.StandardDialog,Eb=new U.a(N.a.instance.ga(566),N.a.instance.ga(567),N.a.instance.ga(6),N.a.instance.ga(5));Va.Ob=1;Va.tc(1,Eb.confirmButton);
Va.tc(0,Eb.cancelButton);Va.Wl(Eb.title,Eb.body,3,hc=>{1===hc&&(this.f6f(jb.command,zc,gd),this.mgf(jb,wc,Jc,Wb,gd))})}CPb(jb,Wb,wc){wc();this.eLa.hb(Wb)&&jb.wh.$R(this.eLa.ma(Wb),L.BasicTelemetryCalculator.HQ)}}Object(b.a)(mb,"PrintAreaBreakManager",null,[502]);var nb=a(389),X=a(89),R=a(27);class wa{constructor(){this.margin=this.d0=this.Oca=this.orientation=this.Vz=0;this.ignorePrintArea=!1;this.sheetPrintOptions=null;this.g2a=!1;this.NoColor=null}equals(jb){return jb?this.orientation===jb.orientation&&
this.Oca===jb.Oca&&this.d0===jb.d0&&this.margin===jb.margin&&this.sheetPrintOptions===jb.sheetPrintOptions&&this.g2a===jb.g2a&&this.NoColor===jb.NoColor:!1}static GGe(jb,Wb){jb&&Wb&&(Wb.Vz=jb.Vz,Wb.orientation=jb.orientation,Wb.Oca=jb.Oca,Wb.d0=jb.d0,Wb.margin=jb.margin,Wb.ignorePrintArea=jb.ignorePrintArea,Wb.sheetPrintOptions=jb.sheetPrintOptions,Wb.g2a=jb.g2a,Wb.NoColor=jb.NoColor)}}Object(b.a)(wa,"PrintSettingsContainer",null,[]);var na=a(8),Ba=a(59),Ra=a(300),qa=a(987),La=a(213),Yb=a(113),mc=
a(157),Zb=a(347),qb=a(38),Ha=a(29),Ya=a(22),Gb=a(854),Ja=a(793),Na=a(192),Qa=a(648),Oa=a(553);class bb{constructor(){this.marginValue=this.printSettingOption=null}}Object(b.a)(bb,"PrintSettingMarginOption",null,[]);class Ga{constructor(){this.footer=this.header=this.bottom=this.top=this.right=this.left=0}}Object(b.a)(Ga,"PrintSettingMarginValue",null,[]);class tb{constructor(){this.printSettingOptionKey=0;this.printSettingOptionText=null}}Object(b.a)(tb,"PrintSettingOption",null,[]);class wb{constructor(jb){this.CLi=
[.75,.75,.7,.7,.3,.3];this.uKi=[.75,.75,.25,.25,.3,.3];this.L6j=[1,1,1,1,.5,.5];this.Zde=this.$ie=this.sge=this.bge=this.Jme=this.x6=this.narrow=this.wide=this.normal=null;this.sheetPrintOptions={};this.cm=jb;this.bii();this.hii()}get whatToPrintOptions(){return this.Jme}get orientationOptions(){return this.bge}get paperSizeOptions(){return this.sge}get scalingOptions(){return this.$ie}get marginDetailedOptions(){return this.Zde}dispose(){}Jxb(jb){if(!jb)return null;const Wb=new Ga;Wb.left=jb.Left;
Wb.right=jb.Right;Wb.top=jb.Top;Wb.bottom=jb.Bottom;Wb.header=jb.Header;Wb.footer=jb.Footer;return Wb}q6c(jb){e.ULS.shipAssertTag(537154186,0,6===jb.length,"PrintPreviewManager.CreatePageMargin: marginValue array passed in, doesn't contain 6 margin values");const Wb={};Wb.Top=jb[0];Wb.Bottom=jb[1];Wb.Left=jb[2];Wb.Right=jb[3];Wb.Header=jb[4];Wb.Footer=jb[5];return Wb}hii(){this.Jme=[Object(x.a)(new tb,{printSettingOptionKey:1,printSettingOptionText:this.cm.ga(1229)}),Object(x.a)(new tb,{printSettingOptionKey:2,
printSettingOptionText:this.cm.ga(1222)}),Object(x.a)(new tb,{printSettingOptionKey:0,printSettingOptionText:this.cm.ga(1221)})];this.bge=[Object(x.a)(new tb,{printSettingOptionKey:1,printSettingOptionText:this.cm.ga(1232)}),Object(x.a)(new tb,{printSettingOptionKey:2,printSettingOptionText:this.cm.ga(1231)})];this.sge=[Object(x.a)(new tb,{printSettingOptionKey:1,printSettingOptionText:this.cm.ga(1234)}),Object(x.a)(new tb,{printSettingOptionKey:5,printSettingOptionText:this.cm.ga(1235)}),Object(x.a)(new tb,
{printSettingOptionKey:6,printSettingOptionText:this.cm.ga(1242)}),Object(x.a)(new tb,{printSettingOptionKey:7,printSettingOptionText:this.cm.ga(1236)}),Object(x.a)(new tb,{printSettingOptionKey:8,printSettingOptionText:this.cm.ga(1237)}),Object(x.a)(new tb,{printSettingOptionKey:9,printSettingOptionText:this.cm.ga(1238)}),Object(x.a)(new tb,{printSettingOptionKey:11,printSettingOptionText:this.cm.ga(1239)}),Object(x.a)(new tb,{printSettingOptionKey:12,printSettingOptionText:this.cm.ga(1240)}),Object(x.a)(new tb,
{printSettingOptionKey:13,printSettingOptionText:this.cm.ga(1241)}),Object(x.a)(new tb,{printSettingOptionKey:3,printSettingOptionText:this.cm.ga(1233)})];this.$ie=[Object(x.a)(new tb,{printSettingOptionKey:0,printSettingOptionText:this.cm.ga(1250)}),Object(x.a)(new tb,{printSettingOptionKey:1,printSettingOptionText:this.cm.ga(1251)}),Object(x.a)(new tb,{printSettingOptionKey:2,printSettingOptionText:this.cm.ga(1252)}),Object(x.a)(new tb,{printSettingOptionKey:3,printSettingOptionText:this.cm.ga(1253)})];
this.Zde=[Object(x.a)(new bb,{printSettingOption:Object(x.a)(new tb,{printSettingOptionKey:0,printSettingOptionText:this.cm.ga(1256)}),marginValue:this.Jxb(this.normal)}),Object(x.a)(new bb,{printSettingOption:Object(x.a)(new tb,{printSettingOptionKey:1,printSettingOptionText:this.cm.ga(1257)}),marginValue:this.Jxb(this.wide)}),Object(x.a)(new bb,{printSettingOption:Object(x.a)(new tb,{printSettingOptionKey:2,printSettingOptionText:this.cm.ga(1258)}),marginValue:this.Jxb(this.narrow)}),Object(x.a)(new bb,
{printSettingOption:Object(x.a)(new tb,{printSettingOptionKey:3,printSettingOptionText:this.cm.ga(1259)}),marginValue:this.Jxb(this.x6)})]}bii(){this.normal=this.q6c(this.CLi);this.narrow=this.q6c(this.uKi);this.wide=this.q6c(this.L6j)}}wb.Hkh=1;wb.skh=1;wb.f8c=9;wb.xkh=2;wb.qkh=0;wb.jkh=!1;wb.ekh=!1;wb.AIa={PrintGrid:!1,HorizontalCenter:!1,VerticalCenter:!1,PrintHeaders:!1};Object(b.a)(wb,"PrintSettingsManagerBase",null,[2]);var lb=a(123),db=a(249);class Pa{constructor(jb,Wb){this.sheetPrintOptions=
this.sheetName=null;this.sheetName=jb;this.sheetPrintOptions=Wb}getSheetName(){return this.sheetName}}Object(b.a)(Pa,"MacroRecorderSheetPrintOptionsSavedPayload",null,[162]);class ja{constructor(jb,Wb){this.printSettings=this.sheetName=null;this.sheetName=jb;this.printSettings=Wb}getSheetName(){return this.sheetName}getPrintSettings(){return this.printSettings}}Object(b.a)(ja,"MacroRecorderSheetPrintSettingsSavedPayload",null,[162]);class Ka extends wb{constructor(jb,Wb,wc,Jc,zc,gd){super(zc);this.zag=
this.Ed=!1;this.hEd=Va=>{this.uD.hEd(Va)};this.qEd=Va=>{this.uD.qEd(Va)};this.sZi=()=>{e.ULS.sendTraceTag(537154190,0,50,"PrintSettingsManager.OnSavePrintSettingsToFileSuccess: Saving print settings to file successful.")};this.rZi=Va=>{Va=Yb.a.Pe(Va.data);e.ULS.sendTraceTag(537154189,0,10,`PrintSettingsManager.OnSavePrintSettingsToFileFailure: Save print settings to file failed. Errors: ${Ha.a.nc(Va)}.`)};this.yz=(Va,Eb)=>{2===Eb.Iq?this.yv.clear():1===Eb.Iq&&this.yv&&this.yv.contains(Eb.Lf)&&(e.ULS.sendTraceTag(537154188,
0,50,`PrintSettingsManager.OnQueueChanged: web method ${lb.a(Eb.Lf.operation.operationName)} returned, it took ${Eb.Lf.dequeueUtcTime.getTime()-Eb.Lf.enqueueUtcTime.getTime()} milliseconds to complete.`),this.yv.remove(Eb.Lf))};this.uD=jb;this.zab=wc;this.$=Wb;this.sheetName=Jc;this.locale=window.navigator.browserLanguage||window.navigator.language||this.$.ya.UICultureTag;this.J3i=this.K$g();this.$.userOperationManager.Zq(this.yz);this.yv=new Na.a;this.gF=gd}Mki(jb){this.Nki(Wb=>{jb&&(Wb=this.G0h(Wb),
jb(Wb))})}qPd(jb,Wb){if(jb){var wc=new C(jb.Vz,jb.ignorePrintArea);this.zsj(wc);!Wb||this.zag?e.ULS.sendTraceTag(593294034,0,50,`PrintSettingsManager.SavePrintSettings: Saving of print settings skipped because ${Wb?"skipSaveToFile is true":"shouldFilePersistedPrintSettingsBeSaved is false"}`):(Wb=this.I0h(jb.d0),Wb.IsLandscape=2===jb.orientation,Wb.PaperSize=jb.Oca,this.gF&&(Wb.NoColor=jb.NoColor),Wb.PageMargin=this.kid(jb.margin),Wb.SheetPrintOptions=wb.AIa,Wb.SheetPrintOptions.PrintGrid=jb.sheetPrintOptions.PrintGrid,
Wb.SheetPrintOptions.HorizontalCenter=jb.sheetPrintOptions.HorizontalCenter,Wb.SheetPrintOptions.VerticalCenter=jb.sheetPrintOptions.VerticalCenter,Wb.SheetPrintOptions.PrintHeaders=jb.sheetPrintOptions.PrintHeaders,this.ysj(Wb))}else e.ULS.sendTraceTag(593294035,0,10,"PrintSettingsManager.SavePrintSettings: printSettingsContainer passed as parameter is null")}kid(jb){let Wb={};0===jb?Wb=this.normal:1===jb?Wb=this.wide:2===jb?Wb=this.narrow:3===jb&&(Wb=this.x6);return Wb}dli(jb){if(jb){e.ULS.sendTraceTag(537154197,
0,50,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: Make server call to save print options to file");var Wb=this.$.oa.xa,wc=this.$.oa.xa.Wb(),Jc=new D.a(598,0,(zc,gd,Va)=>ra(Wb,this.$.va.na.name,jb,M.b(this.hEd,zc),M.a(this.qEd,gd),Va,wc),64,()=>new Pa(this.$.va.na.name,jb));this.$.userOperationManager.Jc(Jc,null)}else e.ULS.sendTraceTag(537154198,0,10,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: sheetPrintOptions passed as parameter is null")}dispose(){this.Ed||(this.Ed=!0,this.$.userOperationManager.Un(this.yz),
this.WX())}zsj(jb){this.zab.Vz=jb.Vz;this.zab.ignorePrintArea=jb.ignorePrintArea}Nki(jb){const Wb=gd=>{db.a(gd)?e.ULS.sendTraceTag(537154196,0,15,`PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: ${Ha.a.nc(gd.Errors)}.`):(e.ULS.sendTraceTag(537154195,0,50,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings succeeded."),jb(gd.Result))},wc=gd=>{gd=Yb.a.Pe(gd.data);e.ULS.sendTraceTag(537154194,0,10,`PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: ${Ha.a.nc(gd)}.`);
jb(null)},Jc=this.$.oa.xa.Wb();var zc=new D.a(247,0,(gd,Va,Eb)=>O(this.$.oa.xa,this.sheetName,this.locale,M.b(gd,Wb),M.a(Va,wc),Eb,Jc),80);zc=this.$.userOperationManager.Jc(zc,null);this.yv.add(zc)}ysj(jb){e.ULS.sendTraceTag(593294031,0,50,"PrintSettingsManager.SavePrintSettingsPersistedInFile: Make server call to save print settings to file");const Wb=this.$.oa.xa.Wb();this.$.userOperationManager.Jc(new D.a(226,0,(wc,Jc,zc)=>Z(this.$.oa.xa,this.sheetName,jb,M.b(wc,this.sZi),M.a(Jc,this.rZi),zc,Wb),
void 0,()=>new ja(this.sheetName,jb)),null)}Bsi(jb){return this.Khf(jb)||!this.Zkf(jb.PaperSize)}vIh(jb){this.Khf(jb)&&(e.ULS.sendTraceTag(537154192,0,50,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Custom scaling present in file."),jb.ScalingWidth=Ka.zkh,jb.ScalingHeight=Ka.ykh,jb.ScalingPercent=Ka.SKe,jb.FitToPage=Ka.fkh);this.Zkf(jb.PaperSize)||(e.ULS.sendTraceTag(537154191,0,15,`PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Paper size ${jb.PaperSize.toString()} present in file which is unsupported by XLO.`),
jb.PaperSize=Ka.f8c);return jb}E0h(jb){if(jb.FitToPage){if(1===jb.ScalingWidth&&1===jb.ScalingHeight)return 1;if(!jb.ScalingWidth&&1===jb.ScalingHeight)return 3}else return 0;return 2}D0h(jb){return this.Prd(jb,this.normal)?0:this.Prd(jb,this.wide)?1:this.Prd(jb,this.narrow)?2:3}Prd(jb,Wb){return jb.Left===Wb.Left&&jb.Right===Wb.Right&&jb.Top===Wb.Top&&jb.Bottom===Wb.Bottom&&jb.Header===Wb.Header&&jb.Footer===Wb.Footer}I0h(jb){const Wb={};Wb.ScalingPercent=Ka.SKe;Wb.FitToPage=0!==jb;2===jb?(Wb.ScalingWidth=
1,Wb.ScalingHeight=0):3===jb?(Wb.ScalingWidth=0,Wb.ScalingHeight=1):1===jb&&(Wb.ScalingWidth=1,Wb.ScalingHeight=1);return Wb}Zkf(jb){return this.J3i.contains(jb.toString())}Khf(jb){return 100!==jb.ScalingPercent||jb.FitToPage&&(1<jb.ScalingWidth||1<jb.ScalingHeight)}K$g(){const jb=new Qa.a(Oa.a.Oi());for(let Wb=0;Wb<this.paperSizeOptions.length;Wb++)jb.add(this.paperSizeOptions[Wb].printSettingOptionKey.toString());return jb}G0h(jb){let Wb=null;if(jb){const wc=this.zab.Vz,Jc=this.zab.ignorePrintArea;
this.Bsi(jb)&&(this.zag=!0,jb=this.vIh(jb));Wb=new wa;Wb.Vz=wc;Wb.ignorePrintArea=Jc;Wb.orientation=jb.IsLandscape?2:1;Wb.Oca=jb.PaperSize;Wb.d0=this.E0h(jb);Wb.sheetPrintOptions=wb.AIa;Wb.sheetPrintOptions.PrintGrid=jb.SheetPrintOptions.PrintGrid;Wb.g2a=jb.Draft;this.gF&&(Wb.NoColor=jb.NoColor);Wb.sheetPrintOptions.HorizontalCenter=jb.SheetPrintOptions.HorizontalCenter;Wb.sheetPrintOptions.VerticalCenter=jb.SheetPrintOptions.VerticalCenter;Wb.sheetPrintOptions.PrintHeaders=jb.SheetPrintOptions.PrintHeaders;
Wb.margin=this.D0h(jb.PageMargin);e.ULS.sendTraceTag(553965398,0,50,`PageMargin received : ${Wb.margin}`);3===Wb.margin&&(this.x6={},this.x6.Left=jb.PageMargin.Left,this.x6.Right=jb.PageMargin.Right,this.x6.Top=jb.PageMargin.Top,this.x6.Bottom=jb.PageMargin.Bottom,this.x6.Header=jb.PageMargin.Header,this.x6.Footer=jb.PageMargin.Footer)}return Wb}WX(){if(this.yv){for(let jb of this.yv)this.$&&this.$.userOperationManager&&(jb.operation&&e.ULS.sendTraceTag(537154187,0,50,`PrintSettingsManager.AbortOutstandingUserOperation: Trying to abort pending operation ${lb.a(jb.operation.operationName)}.`),
this.$.userOperationManager.Jta(jb)),this.yv.remove(jb);this.yv=null}}}Ka.zkh=1;Ka.ykh=0;Ka.SKe=100;Ka.f8c=9;Ka.fkh=!0;Object(b.a)(Ka,"PrintSettingsManager",wb,[]);var ub=a(73);class Kb{constructor(){this.onDropdownSettingsFocus=this.onPrint=this.onSettingChange=null}}Object(b.a)(Kb,"PrintSettingsTaskPaneCallbacks",null,[]);class W{constructor(){this.selectedColor=this.selectedMargin=this.selectedScaling=this.selectedPaperSize=this.selectedOrientation=this.selectedWhatToPrint=0;this.selectedPrintGridlines=
this.selectedIgnorePrintArea=!1;this.selectedRowAndColumnHeadings=this.selectedVerticalCenter=this.selectedHorizontalCenter=this.selectedDraft=this.selectedPageEnd=this.selectedPageStart=null}}Object(b.a)(W,"SelectedPrintSettings",null,[]);class za{constructor(){this.onNotifyPrintJobStatus=this.onClosePreviewer=this.getGraphServiceAuthorizationToken=this.onLocalPrint=null}}Object(b.a)(za,"PrintOperationCallbacks",null,[]);class Sa{constructor(){this.onBackToSheet=null}}Object(b.a)(Sa,"PrintPreviewPaneCallbacks",
null,[]);var Wa=a(1098);class ab{constructor(){this.appName=this.disabledChangeGates=this.isUniversalPrintFlowEnabled=this.graphServiceEndpointVersion=this.graphServiceEndpoint=null}}Object(b.a)(ab,"UniversalPrintAppSettings",null,[]);var ma=a(425),ha=a(33);class eb{constructor(jb,Wb,wc,Jc){this.activeCell=this.selectedRange=this.jg=this.graphServiceEndpoint=null;this.BIb=0;this.cda=this.zv=null;this.mH=new wa;this.Fk=new wa;this.Vba=0;this.B8a=null;this.yOb=!1;this.J3a=this.CHb=null;this.jsd=!1;
this.x7a=this.ABb=!0;this.yma=this.$ya=this.I8a=null;this.yAb=!1;this.y8a=null;this.M6a=this.LNc=!1;this.iSi=zc=>{if(!(zc&&zc.data&&zc.data.de&&zc.data.responseHeaders&&zc.data.de.length)){var gd=zc?zc.data?zc.data.de?zc.data.responseHeaders?zc.data.de.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":"requestSucceededEventArgs.Data.ResponseHeaders":"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs";this.jg&&(zc=this.rRa(N.a.instance.ga(1210)),
this.YAa(zc,0));e.ULS.sendTraceTag(593266765,0,10,`PrintPreviewManager:OnFileHandlerSuccessCallback - Invalid Parameter : ${gd}`);this.hNd&&(zc=Object(x.a)(new Fa.a,{extendedProperties:new Map}),zc.extendedProperties.set("InvalidParameterName",gd),I.Health.instance.recordQosError(Da.a.SOf,[fa.a.TOf],!1,!0,!0,!1,zc))}else if(0<this.Vba&&zc.data.id===this.Vba){if(zc.data.responseHeaders["Content-Type"]&&(Ya.a.contains(zc.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)||Ya.a.contains(zc.data.responseHeaders["Content-Type"].toString(),
"text/plain",!0))){e.ULS.sendTraceTag(593266764,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - pdf converted successfully");var Va=null;Ya.a.contains(zc.data.responseHeaders["Content-Type"].toString(),"text/plain",!0)&&(Va=this.Qbh(zc));gd={};this.CBf(Va);zc.data.responseHeaders["Total-Pdf-PageCount"]?(Va=parseInt(zc.data.responseHeaders["Total-Pdf-PageCount"].toString(),10),this.yAb||(this.aId>=Va?this.yma=Va:this.yAb=!0),this.x7a&&this.jg&&this.jg.setPageRangeSettings(Va,this.aId,this.yAb,
this.$ya,this.yma)):e.ULS.sendTraceTag(537154257,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - did not receive the TotalPdfPageCount header.")}else gd=Ba.a.Xh(zc.data.de),Ha.a.S9(gd.Errors)||ub.a(this.$).gd.RL(gd.Errors[0].MessageId),this.vej(gd.Errors),this.jg&&(Va=this.rRa(gd.Errors[0].Description),-1831476778===gd.Errors[0].MessageId?(e.ULS.sendTraceTag(537154256,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - showing pdf print timeout error message"),this.YAa(Va,0,N.a.instance.ga(1213))):
this.YAa(Va,0)),297284985===gd.Errors[0].MessageId?e.ULS.sendTraceTag(570716892,0,50,`PrintPreviewManager:OnFileHandlerSuccessCallback - Nothing to print. Message Id: ${gd.Errors[0].MessageId}`):e.ULS.sendTraceTag(593266763,0,15,`PrintPreviewManager:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: ${gd.Errors[0].MessageId}`);zc=zc.data.state;zc.RSe(gd,zc.userContext,zc.methodName)}};this.hSi=zc=>{if(0<this.Vba&&zc.data.id===this.Vba){var gd=Yb.a.Pe(zc.data);this.jg&&this.YAa(this.rRa(gd[0].Description),
1);e.ULS.sendTraceTag(593266762,0,15,`PrintPreviewManager:OnFileHandlerFailureCallback has failed - Errors: [${Ha.a.nc(gd)}]`);gd=zc.data.state;gd.Lia(zc,gd.userContext,gd.methodName);this.$.userOperationManager.kla.operation.HAa(()=>this.yOb)}};this.IQi=zc=>{zc.Errors&&0<zc.Errors.length&&this.jg?(Ha.a.S9(zc.Errors)||ub.a(this.$).gd.RL(zc.Errors[0].MessageId),this.YAa(this.rRa(zc.Errors[0].Description),0),e.ULS.sendTraceTag(537154254,0,50,`PrintPreviewManager: Failed to convert workbook. Error message Id: ${zc.Errors[0].MessageId}`)):
(e.ULS.sendTraceTag(537154253,0,50,"PrintPreviewManager:OnConvertWorkbookToPdfSucceededInWebParts - Pdf conversion succeeded"),this.CBf(null))};this.HQi=zc=>{zc=Yb.a.Pe(zc.data);this.jg&&this.YAa(this.rRa(zc[0].Description),1);e.ULS.sendTraceTag(537154252,0,15,`PrintPreviewManager:OnConvertWorkbookToPdfFailed invoked - Errors: [${Ha.a.nc(zc)}]`);this.$.userOperationManager.kla.operation.HAa(()=>this.yOb)};this.aGf=(zc,gd)=>{if(gd)switch(gd.g9i){case 1:if(this.Fk&&this.J3a)switch(zc=this.J3a.Bc,this.J3a.stop(),
this.J3a=null,this.Fk.Vz){case 1:this.a2c(zc,4800,"ActiveSheet");break;case 0:this.a2c(zc,6100,"CurrentSelection");break;case 2:this.a2c(zc,7500,"EntireWorkbook")}break;case 0:this.CHb&&(zc=this.CHb.Bc,this.CHb.stop(),2400<zc&&(gd=Object(x.a)(new Fa.a,{extendedProperties:new Map}),gd.extendedProperties.set("PaneLoadTime",zc.toString()),I.Health.instance.recordQosError(Da.a.cMj,[fa.a.Hag],!1,!0,!0,!1,gd)),this.zv.Mki(Va=>{this.cKj(Va)}))}};this.yz=(zc,gd)=>{(1===gd.Iq&&this.I8a===gd.Lf||2===gd.Iq)&&
this.XNd()};this.$=jb;this.V7b=Wb;this.S2=wc;this.BFb=Jc;this.hNd=E.HelperMethods.RZ;this.Pa=new qb.a;this.aId=this.$.ya.PrintPreviewerPaginationRange;this.useMSPdfViewer=this.OHj();this.Khi();this.kmi=this.B3g();this.gF=t.EwaSettings.isChangeGateEnabled("OfficeVSO:7497739_UniversalPrintCG");this.Zvi=t.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebUniversalPrintFloodgateSurvey",!1)&&this.gF&&t.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableLicenseCheckForUniversalPrint",
!1);if(this.isUniversalPrintEnabled=!!Jc&&Jc.v6a()&&t.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableLicenseCheckForUniversalPrint",!1)&&this.$.$d.get(116))this.graphServiceEndpoint=this.$.ya.GraphServiceEndpoint;this.isExportPdfMode=!1}get Asi(){return this.LNc}wOg(jb){this.Pa.addHandler("ppocek",jb)}llj(jb){this.Pa.removeHandler("ppocek",jb)}bKj(jb,Wb,wc){this.Qoj();this.$.userOperationManager.Zq(this.yz);this.cda=jb;this.Pa.raiseEvent("ppocek");this.isExportPdfMode=wc;this.cda.SelectedRanges&&
this.cda.SelectedRanges.Ranges&&0<this.cda.SelectedRanges.Ranges.length&&this.cda.SelectedRanges.Ranges[0]&&(this.selectedRange=w.B(this.cda.SelectedRanges.Ranges[0]).toString());e.ULS.shipAssertTag(537154268,0,!this.zv,"PrintPreviewManager.ShowPrintPreviewer: printSettingsManager should be null.");this.zv=new Ka(this,this.$,Wb,this.$.va.na.name,N.a.instance,this.gF);e.ULS.shipAssertTag(537154267,0,!this.jg,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should be null.");this.jg=new Ja.PrintPreviewPane(this.$,
this,this.useMSPdfViewer,this.isUniversalPrintEnabled);this.jg.goh();this.jg.dKj(this.isExportPdfMode);this.jg.RNg(this.aGf)}IYh(){this.zv.x6&&4<=this.zv.marginDetailedOptions.length&&(this.zv.marginDetailedOptions[3].marginValue=this.zv.Jxb(this.zv.x6));return this.zv.marginDetailedOptions}e8f(){return!!this.cda&&!!this.cda.ObjectId||!u.h(this.$).ha.qa.Tg}J0h(){const jb=Object(x.a)(new W,{selectedWhatToPrint:wb.Hkh,selectedOrientation:wb.skh,selectedPaperSize:wb.f8c,selectedScaling:wb.xkh,selectedMargin:wb.qkh,
selectedIgnorePrintArea:wb.jkh,selectedPrintGridlines:wb.AIa.PrintGrid,selectedDraft:wb.ekh,selectedHorizontalCenter:wb.AIa.HorizontalCenter,selectedVerticalCenter:wb.AIa.VerticalCenter,selectedRowAndColumnHeadings:wb.AIa.PrintHeaders});this.mH?(jb.selectedWhatToPrint=this.mH.Vz,jb.selectedOrientation=this.mH.orientation,jb.selectedPaperSize=this.mH.Oca,jb.selectedScaling=this.mH.d0,jb.selectedMargin=this.mH.margin,jb.selectedIgnorePrintArea=this.mH.ignorePrintArea,jb.selectedPrintGridlines=this.mH.sheetPrintOptions.PrintGrid,
jb.selectedDraft=this.mH.g2a,this.gF&&(jb.selectedColor=this.mH.NoColor?0:1),jb.selectedHorizontalCenter=this.mH.sheetPrintOptions.HorizontalCenter,jb.selectedVerticalCenter=this.mH.sheetPrintOptions.VerticalCenter,jb.selectedRowAndColumnHeadings=this.mH.sheetPrintOptions.PrintHeaders):e.ULS.sendTraceTag(593294038,0,10,"PrintPreviewManager.GetPrintSettingsSelectedOnPaneOpen: initialPrintSettings is null.");return jb}k6e(){return Object(x.a)(new Sa,{onBackToSheet:()=>{this.dma()}})}F0h(){return Object(x.a)(new Wa.a,
{backActionButtonText:N.a.instance.ga(1209),printPreviewPaneCallbacks:this.k6e(),logger:new nb.a,disableTellMeControl:!0,isExportPdfMode:this.isExportPdfMode,printOperationCallbacks:Object(x.a)(new za,{onClosePreviewer:()=>{this.dma()},getGraphServiceAuthorizationToken:this.zbc(),onLocalPrint:()=>{this.MGf()},onNotifyPrintJobStatus:(jb,Wb)=>{this.onNotifyPrintJobStatus(jb,Wb)}}),universalPrintAppSettings:Object(x.a)(new ab,{graphServiceEndpoint:this.graphServiceEndpoint,graphServiceEndpointVersion:this.rmi()?
"testppebeta-print":"v1.0",isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled,appName:"Excel"})})}H0h(){return Object(x.a)(new Kb,{onSettingChange:jb=>{this.fYi(jb)},onPrint:()=>{this.MGf()}})}fYi(jb){this.BIb++;jb?(this.jg&&this.jg.TKj(),this.Fk.Vz=jb.selectedWhatToPrint,this.Fk.d0=jb.selectedScaling,this.Fk.orientation=jb.selectedOrientation,this.Fk.Oca=jb.selectedPaperSize,this.Fk.margin=jb.selectedMargin,this.gF&&(this.Fk.NoColor=!jb.selectedColor),this.Fk.ignorePrintArea=jb.selectedIgnorePrintArea,
this.CAj(jb.selectedPageStart,jb.selectedPageEnd),this.zv&&this.Dbi(this.Fk,jb)?(this.Fk.sheetPrintOptions=wb.AIa,this.Fk.sheetPrintOptions.PrintGrid=jb.selectedPrintGridlines,this.Fk.sheetPrintOptions.HorizontalCenter=jb.selectedHorizontalCenter,this.Fk.sheetPrintOptions.VerticalCenter=jb.selectedVerticalCenter,this.Fk.sheetPrintOptions.PrintHeaders=jb.selectedRowAndColumnHeadings,this.zv.dli(this.Fk.sheetPrintOptions)):this.Qod()):e.ULS.sendTraceTag(593294037,0,10,"PrintPreviewManager.OnPrintSettingsChange: changedPrintSettings passed as input is null.")}dma(){this.M6a&&
(this.yOb=!0);e.ULS.sendTraceTag(591196513,0,50,`PrintPreviewManager.OnCloseButtonClick: User changed printSettings ${this.BIb} times before clicking on backToWorkbook icon`);this.LGf();this.wCe()}MGf(){e.ULS.sendTraceTag(591196512,0,50,`PrintPreviewManager.OnPrintButtonClick: User changed printSettings ${this.BIb} times before clicking on print button.`);e.ULS.sendTraceTag(543024129,0,50,`PrintPreviewManager.OnPrintButtonClick: Current margin value : ${this.Fk.margin}, Initial margin value : ${this.mH.margin}`);
if(this.useMSPdfViewer)this.UOf();else if(this.x7a)try{this.jg.printPdf(),this.h3c()}catch(jb){e.ULS.sendTraceTag(574482433,0,15,"PrintPreviewManager.OnPrintButtonClick: Unable to print. Opening the window."),this.UOf()}else this.V7b.aKj(this.X5b(!0)),this.h3c()}UOf(){const jb=this.X5b(!0);this.h3c();E.HelperMethods.gf(jb,void 0,void 0,"PrintPreviewManager.CreateFileCopyFileHandlerURL")}dispose(){X.a.Ja(this.Pa)}Qod(){if(this.$.H6a)this.Jki();else{this.WX();this.m_f();var jb=null;this.Ahi();e.ULS.sendTraceTag(593266766,
0,50,"PrintPreviewManager:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");this.I8a=this.$.userOperationManager.Jc(new D.a(223,0,(Wb,wc,Jc)=>{Wb=new Ra.a(Wb,null,wc,Jc,null,!0,!1,"GetFileCopyFileHandler","");Wb.correlationID=H.a.create().toString();jb=Wb;this.Vba=this.S2.Jga(this.X5b(this.x7a?!1:!0,this.kmi?"Base64":"Pdf"),1,null,null,eb.VFh,!1,2,this.iSi,this.hSi,jb,void 0,void 0,void 0,12E4);Wb.requestId=this.Vba;e.ULS.sendTraceTag(537154264,0,50,`PrintPreviewManager.InvokeGetFileCopyFileHandler: Creating request with id: ${this.Vba}.`);
return yb.Task.Sa(!0)},80),null)}}h3c(){this.LGf();this.wCe()}hEd(jb){Ha.a.qq(jb.Errors)?this.jg.showErrorMessageForPrintOptions(N.a.instance.ga(1260)):(e.ULS.sendTraceTag(537154263,0,50,"PrintPreviewManager.OnPrintOptionsUpdationSuccess: SetPrintOptions server call is successful."),this.Qod(),this.jg&&this.jg.hideErrorMessageForPrintOptions())}qEd(jb){this.jg&&this.jg.showErrorMessageForPrintOptions(N.a.instance.ga(1260));jb=Yb.a.Pe(jb.data);e.ULS.sendTraceTag(537154262,0,10,`PrintPreviewManager.OnSavePrintOptionsToFileFailure: Save print options to file failed. Errors: ${Ha.a.nc(jb)}.`)}Jki(){e.ULS.sendTraceTag(553649883,
0,50,"PrintPreviewManager:InvokeConvertWorkbookToPrintPdf - Invoking ConvertWorkbookToPrintPdf");this.WX();const jb=this.$.oa.xa.Wb();this.I8a=this.$.userOperationManager.Jc(new D.a(133,0,(Wb,wc,Jc)=>{const zc={};zc.WhatToPrint=this.Fk.Vz;zc.UseNamedAction=this.V7b.l9f();zc.SelectedSheetName=this.$.va.na.name;zc.ActiveCell=this.activeCell;zc.SelectedRanges=[this.selectedRange];zc.IsPdfDocumentRequired=!1;zc.Orientation=this.Fk.orientation;zc.PaperSize=this.Fk.Oca;zc.Scaling=this.Fk.d0;zc.RichValuesEnabled=
!0;zc.IgnorePrintArea=this.Fk.ignorePrintArea;zc.Preview=!0;this.gF&&(zc.NoColor=this.Fk.NoColor);this.Y7f()&&(zc.PaginationStartPage=this.$ya,zc.PaginationEndPage=this.yma,zc.OutputTotalPdfPageCount=!0);const gd=this.zv.kid(this.Fk.margin);gd&&(zc.PageMargin={},zc.PageMargin.Top=gd.Top,zc.PageMargin.Bottom=gd.Bottom,zc.PageMargin.Left=gd.Left,zc.PageMargin.Right=gd.Right,zc.PageMargin.Header=gd.Header,zc.PageMargin.Footer=gd.Footer);return this.B8a=ea(this.$.oa.xa,zc,M.b(this.IQi,Wb),M.a(this.HQi,
wc),Jc,jb)},80),null)}wCe(){this.$.userOperationManager.Un(this.yz);this.WX();this.m_f();e.ULS.shipAssertTag(537154261,0,!!this.jg,"PrintPreviewManager.cleanUpPrintPreviewPanes: printPreviewPane should not be null");this.isExportPdfMode=!1;this.jg&&(this.jg.Pkj(this.aGf),this.jg.poh(),this.jg=null);this.cda=null;this.zv&&(this.zv.dispose(),this.zv=null);this.J3a=this.CHb=null;this.LNc=!1;this.Pa&&this.Pa.raiseEvent("ppocek")}DFj(){return this.$.isEditMode&&!!this.mH&&!!this.Fk&&2!==this.Fk.Vz&&this.Ebi()}qPd(){e.ULS.shipAssertTag(537154260,
0,!!this.zv,"PrintPreviewManager.SavePrintSettings: printSettingsManager should not be null");this.zv&&this.zv.qPd(this.Fk,this.DFj())}X5b(jb,Wb="Pdf"){const wc=new Sys.StringBuilder;wc.append(qa.a(this.$,Wb,!0));La.a.Mk(wc,na.a.kQf,""+this.Fk.Vz);jb&&this.V7b.l9f()&&La.a.Mk(wc,na.a.g3j,"1");La.a.Mk(wc,na.a.naj,this.$.va.na.name);0===this.Fk.Vz&&(La.a.Mk(wc,na.a.maj,this.selectedRange),La.a.Mk(wc,na.a.eaj,this.activeCell));La.a.Mk(wc,na.a.haj,""+this.Fk.orientation);La.a.Mk(wc,na.a.iaj,""+this.Fk.Oca);
La.a.Mk(wc,na.a.laj,""+this.Fk.d0);La.a.Mk(wc,na.a.kaj,"1");La.a.Mk(wc,na.a.daj,this.Fk.ignorePrintArea?"1":"0");La.a.Mk(wc,na.a.jaj,"1");this.fSg(wc);this.gF&&La.a.Mk(wc,na.a.gaj,this.Fk.NoColor?"1":"0");this.eSg(wc);Ya.a.equals(Wb,"Pdf",!0)&&(wc.append("&#toolbar=0"),wc.append("&zoom=100"));jb=wc.toString().replace("GetFileCopyFileHandler.aspx?","GetFileCopyFileHandler.aspx/?");e.ULS.sendTraceTag(537154259,0,50,`PrintPreviewManager: Print Pdf Url ${jb}`);return jb}CAj(jb,Wb){jb||Wb?(this.yAb=!0,
this.$ya=jb,this.yma=Wb):this.xZf()}fSg(jb){this.Y7f()&&(La.a.Mk(jb,na.a.paj,""+this.$ya),La.a.Mk(jb,na.a.oaj,""+this.yma),La.a.Mk(jb,na.a.qaj,"1"),e.ULS.sendTraceTag(537154258,0,50,`PrintPreviewManager: AppendPaginationQueryParameter Print Pdf page range from ${this.$ya} to ${this.yma}`))}Y7f(){return null!=this.$ya&&0<this.$ya&&null!=this.yma&&0<this.yma}eSg(jb){if(this.zv&&this.Fk){const Wb=this.zv.kid(this.Fk.margin);Wb&&La.a.Mk(jb,na.a.faj,""+Wb.Top+" "+Wb.Bottom+" "+Wb.Left+" "+Wb.Right+" "+
Wb.Header+" "+Wb.Footer)}}CBf(jb){this.jg&&(e.ULS.shipAssertTag(537154255,0,!!this.$.va.na,"PrintPreviewManager.OnConvertWorkbookToPdfSucceeded: ewaControl.Sheets.ActiveItem should not be null"),this.$.va.na&&(this.x7a?(jb||(jb=this.X5b(!1)),this.jg.TAi(jb)):this.WJj()))}Ebi(){return!this.mH.equals(this.Fk)}LGf(){!this.yOb&&0<this.BIb&&(this.jsd?this.qPd():e.ULS.sendTraceTag(537154251,0,50,"PrintPreviewManager:OnPreviewerClose - Previewer is being closed without settings pane being loaded."));e.ULS.shipAssertTag(537154250,
0,!!this.jg,"PrintPreviewManager.OnPreviewerClose: printPreviewPane should not be null");this.jg&&this.jg.Pci()}kj(){e.ULS.sendTraceTag(593294036,0,50,"PrintPreviewManager.ShowErrorDialog: Error Dialog displayed.");if(this.jg){var jb=this.rRa(N.a.instance.ga(1));this.YAa(jb,1)}else jb=Ha.a.ed(1,0,26,0,1,-1100324317,"GetPrintSettingsFailedError"),t.EwaSettings.mz()?new Zb.a(this.$,jb):(new mc.ErrorDialog(this.$,jb)).kg()}cKj(jb){jb?(0===jb.Vz&&this.e8f()&&(e.ULS.sendTraceTag(537154249,0,50,`PrintPreviewManager.ShowPrintPreviewer: Falling back to ActiveSheet because current selection is a $${this.cda.ObjectId?
"floatingObject":"discontinuousRange"}.`),jb.Vz=1),wa.GGe(jb,this.mH),wa.GGe(jb,this.Fk),e.ULS.shipAssertTag(537154248,0,!!this.jg,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should not be null"),this.jg&&(this.jsd=!0,this.jg.eKj(),this.Qod())):(e.ULS.sendTraceTag(537154247,0,10,"PrintPreviewManager.ShowPrintPreviewer: printSettings fetched from server is null."),this.kj())}a2c(jb,Wb,wc){jb>Wb&&(Wb=Object(x.a)(new Fa.a,{extendedProperties:new Map}),Wb.extendedProperties.set("WtpSelectedValue",
wc),Wb.extendedProperties.set("FullyRenderedPdfLoadTime",jb.toString()),I.Health.instance.recordQosError(Da.a.bMj,[fa.a.Hag],!1,!0,!0,!1,Wb))}WX(){this.I8a&&(0<this.Vba||this.B8a)&&(e.ULS.sendTraceTag(537154246,0,50,`PrintPreviewManager.AbortOutstandingUserOperation: Cancelling request with id: ${this.Vba}.`),this.$.userOperationManager.Jta(this.I8a),this.B8a?Yb.a.Nt(this.B8a.Rs):this.S2.Nt(this.Vba),this.XNd())}XNd(){this.B8a=this.I8a=null}Ahi(){this.hNd&&this.Fk&&(this.J3a=this.$.Jb.Gc("UserAction",
(1===this.Fk.Vz?"ActiveSheet":0===this.Fk.Vz?"CurrentSelection":"EntireWorkbook")+"FullyRenderedPdfLoadTimeStopwatch"))}xZf(){this.yAb=!1;this.$ya=1;this.yma=this.aId}rRa(jb){if(jb)return jb.replace("&#39;","'");e.ULS.sendTraceTag(537154245,0,15,"PrintPreviewManager.SanitizeErrorMessage: error message is null");return jb}WJj(){e.ULS.sendTraceTag(537154244,0,50,"PrintPreviewManager.ShowPdfRenderingError invoked");if(this.ABb)e.ULS.sendTraceTag(537154243,0,10,"PrintPreviewManager.ShowPdfRenderingError: Called when preview was supported in both host & browser");
else{let jb=this.rRa(N.a.instance.ga(1215));this.YAa(jb,3)}}YAa(jb,Wb,wc=null){this.jg.Nz(jb,Wb,wc)}Khi(){this.x7a=this.ABb=!0;e.ULS.sendTraceTag(557061534,0,50,`PrintPreviewManager.InitializeIsPdfPreviewSupportedVars: isPdfPreviewSupportedInCurrentHost: ${this.ABb}, isPdfPreviewSupportedInPreviewer: ${this.x7a}`)}Qoj(){this.y8a=null;this.XNd();this.xZf();this.CHb=this.$.Jb.Gc("UserAction","paneLoadTimeStopwatch");this.activeCell=this.$.na.activeCell.toString();this.BIb=0;this.jsd=this.M6a=this.yOb=
!1;this.LNc=!0}OHj(){const jb=this.yvi()||this.Nvi();e.ULS.sendTraceTag(537154242,0,50,`PrintPreviewManager.ShouldUseMSPdfViewer : ${jb}`);return jb}B3g(){let jb=15;R.a.uH&&R.a.jub&&(jb=parseFloat(R.a.jub));return 14<jb&&this.ABb}yvi(){var jb;const Wb="teams"===(null===(jb=f.AFrameworkApplication.fa.appSettings[f.AFrameworkApplication.J7])||void 0===jb?void 0:jb.toLowerCase());e.ULS.sendTraceTag(512350017,0,50,`PrintPreviewManager:isTeamsHost - isElectron: ${R.a.ZA} isTeamsUIHost: ${Wb} isUnifiedHostMode: ${f.AFrameworkApplication.isUnifiedHostMode}`);
return R.a.ZA||Wb}Nvi(){return!this.$.$d.get(111)}m_f(){this.y8a&&(URL.revokeObjectURL(this.y8a),this.y8a=null)}Qbh(jb){var Wb=jb.data.de;jb=this.$.Jb.Gc("UserAction","PrintPreviewBlobFileCreation");var wc=window.self.atob(Wb);Wb=new Uint8Array(Wb.length);for(let Jc=0;Jc<wc.length;Jc++)Wb[Jc]=wc.charCodeAt(Jc)&255;wc=new Blob([Wb],{type:"application/pdf"});this.y8a=URL.createObjectURL(wc);e.ULS.sendTraceTag(537154241,0,50,`PrintPreviewManager:OnFileHandlerSuccessCallback - Blob created. Total time to create : ${jb.Bc} ms. Blob size: ${wc.size}`);
jb.stop();return this.y8a+"#toolbar=0&zoom=100"}vej(jb){if(this.hNd&&Ha.a.dh(jb,eb.V4i)){const Wb=Object(x.a)(new Fa.a,{extendedProperties:new Map});Wb.extendedProperties.set("ErrorMessageIdName",jb[0].MessageIdName);I.Health.instance.recordQosError(Da.a.SOf,[fa.a.TOf],!1,!0,!0,!1,Wb)}}Dbi(jb,Wb){return jb.sheetPrintOptions.PrintGrid!==Wb.selectedPrintGridlines||jb.sheetPrintOptions.HorizontalCenter!==Wb.selectedHorizontalCenter||jb.sheetPrintOptions.VerticalCenter!==Wb.selectedVerticalCenter||jb.sheetPrintOptions.PrintHeaders!==
Wb.selectedRowAndColumnHeadings}UVj(){this.Zvi&&this.$.Yc(1936706533,-1,0,null)}rmi(){return!!this.$.ya&&!!this.$.ya.DocumentHostInfo&&"TestHost"===this.$.ya.DocumentHostInfo.HostTier}getToken(){e.ULS.sendTraceTag(522314589,0,50,"PrintPreviewManager:GetToken: Token requested for universal print graph service");return this.BFb.AO("Print",this.graphServiceEndpoint).then(jb=>jb?(jb.IsSuccess?e.ULS.sendTraceTag(522314588,0,50,"PrintPreviewManager:GetToken: successfully acquired token for universal print graph service"):
e.ULS.sendTraceTag(537154240,0,15,`PrintPreviewManager:GetToken: failed to get token. Error code: ${jb.ErrorCode}, Error message : ${jb.ErrorMessage}`),jb):Object(x.a)(new Gb.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"})).catch(jb=>{let Wb=new Gb.a;Object.getType(jb)===Object.getType(Wb)?Wb=jb:(Wb.ErrorMessage=jb.toString(),Wb.ErrorCode="exception");return Promise.resolve(Wb)})}zbc(){return()=>{const jb=Promise.resolve("");try{if(this.BFb&&this.BFb.v6a())return this.getToken().then(Wb=>
Wb.IsSuccess?Promise.resolve(Wb.Token):jb,()=>jb)}catch(Wb){e.ULS.sendTraceTag(537154211,0,10,"PrintPreviewManager:GetAuthTokenDelegate - Exception thrown while fetching token")}return jb}}onNotifyPrintJobStatus(jb,Wb){jb=ma.a.WI.notificationBar.M$(jb,!1);"pending"==Wb&&(jb.displayTimeoutSeconds=3,this.UVj());if(ha.a.JBb())switch(Wb){case "failure":jb.image=1;break;case "success":jb.image=3;break;default:jb.image=0}else jb.image=0;ma.a.WI.notificationBar.gE(jb)}}eb.V4i=[-953554093,1773721536,-1104435974,
-1243918982,1205917367,1931972532,1294226134,1239184329,1207537900,-1053855722,-2077518688,1348242499,2030854436,-1831476778];eb.VFh=["Content-Type","Total-Pdf-PageCount"];Object(b.a)(eb,"PrintPreviewManager",null,[500,2,501]);class ta{constructor(jb,Wb,wc){this.ignorePrintArea=!1;this.nVj=()=>{const Jc=u.h(this.$).Ca;this.mTc=!0;Jc.uBd()};this.KXi=()=>{this.Mkd()};this.JXi=(Jc,zc,gd)=>{e.ULS.sendTraceTag(537154272,0,10,`PrintCommandHandler:OnPageLayoutCommandFailure Method : ${gd} failed to execute`);
this.Mkd()};this.$=jb;this.ea=jb.ea;this.V7b=Wb;this.zab=new C(1,this.ignorePrintArea);this.uD=Wb=new eb(jb,Wb,f.AFrameworkApplication.Bd,wc);this.$.da.Ha(418,Wb);this.QOf=new mb(jb);this.$.da.Ha(384,this);this.mTc=!1;this.f8a=t.EwaSettings.isChangeGateEnabled("OfficeVSO:7497739_UniversalPrintCG")}get h8f(){return this.mTc}Hc(){return!1}executeCommand(jb,Wb,wc,Jc){const zc=Wb.command;return 1588554917===zc||1531172830===zc||-2050819419===zc?(Wb.KAb=!0,y.a(this.$)&&this.$.da.Aa(423).Zzc(!1),this.Roh(Wb)?
yb.Task.Sa(!0):m.a(zc)):this.QOf.executeCommand(jb,Wb,wc,Jc,this.KXi,this.JXi,this.nVj)}wc(jb,Wb){switch(Wb.command){case 1588554917:return e.ULS.shipAssertTag(537154305,0,this.$.Gka,"Command execute requested for Print operation when data duplication is disallowed."),!0;case 1531172830:return t.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExportToPdf",!1)&&this.f8a;case -2050819419:return t.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SaveAsPDF",!1)&&this.f8a;default:return this.QOf.wc(jb,
Wb)}}Nc(){return!1}Roh(jb){return this.$.ea.Xb?this.Soh(jb):!1}Soh(jb){e.ULS.sendTraceTag(21099871,0,50,"PrintCommandHandler:DoPrintHtml");const Wb=this.$.Jb.Gc("UserAction","DoPrintHtml");var wc=this.$;wc=this.C0h(wc,this.ea.isNamedObjectViewMode?wc.yb.na.sheetName:wc.va.na.name);if(v.a(this.$))e.ULS.sendTraceTag(537154304,0,50,"PrintCommandHandler:DoPrintHtml - Print previewer is already opened.");else{const Jc=1531172830===jb.command||-2050819419===jb.command;this.uD.bKj(wc,this.zab,Jc);e.ULS.sendTraceTag(591196515,
0,50,`PrintCommandHandler:DoPrintHtml Print previewer opened. isExportPdfMode: ${Jc} Command: ${n.a[jb.command]}`)}Wb.stop();this.Mkd();return!0}C0h(jb,Wb){const wc={};wc.SessionId=this.ea.sessionId;wc.UsedRangeTooBig=!1;var Jc=u.h(jb),zc=Jc.ha;const gd=zc.Ke;if(z.e(jb.na))wc.Type=0,wc.ObjectId=jb.na.name,wc.UseSelection=!1;else if(z.g(jb.na))wc.Type=1,wc.ObjectId=jb.na.imageId,wc.UseSelection=!0;else if(2===gd||4===gd||64===gd)Jc=zc.Ra.dc.floatingObject,wc.Type=1,wc.SheetName=Wb,wc.ObjectId=Jc.id,
wc.UseSelection=!0;else if(gd&470)wc.ObjectId=zc.Ra.dc.floatingObject.id,wc.SheetName=Wb;else if(z.i(jb.na)){wc.Type=2;wc.SheetName=Wb;if(zc.qa.Tg)if(zc=zc.qa.ld,wc.SelectedRanges=w.q(zc,jb),20<zc.Oy)wc.UseSelection=!0;else{Wb=0;Jc=Jc.Wj("PrintCommandHandler.DoPrintHtml",zc);try{for(Jc.$$rst();Jc.$$mn()&&2>Wb;)Jc.$$cu().text&&Wb++;wc.UseSelection=2<=Wb}finally{Jc&&Jc.dispose()}}else wc.UseSelection=!1,wc.SelectedRanges=w.q(zc.qa.activeRange,jb);this.ea.isNamedObjectViewMode&&(wc.UsedRange=w.v(jb.na.usedRange,
jb))}wc.Title=jb.workbookContext.WorkbookFileName;return wc}Mkd(){u.h(this.$);if(!this.h8f){this.mTc=!0;const jb=this.$.Jb.Gc("UserAction","HandlePageLayoutRendering");this.DVj();e.ULS.sendTraceTag(537154274,0,50,`PrintCommandHandler:HandlePageLayoutRendering rendering is done in ${jb.Bc} ms.`);jb.stop()}}DVj(){const jb=u.h(this.$).Ca,Wb=jb.MA();let wc=!1,Jc=0;for(let zc=0;zc<Wb.length;zc++){const gd=Wb[zc],Va=gd.lf;Va&&Va.hasPageLayout()&&(wc=!0,Va.setDirty("PrintCommandHandler::TriggerPageLayoutRendering, hash: "+
gd.Zc,4),Jc++)}wc&&(e.ULS.sendTraceTag(537154273,0,50,`PrintCommandHandler:TriggerPageLayoutRendering number of total cached blocks is ${Wb.length}, number of blocks that require re-rendering is ${Jc}`),jb.uBd())}}Object(b.a)(ta,"PrintCommandHandler",null,[222,473]);var ya=a(1097),sb=a(1311),Qb=a(1312);class oc extends h.a{constructor(jb){super(jb)}hd(){var jb=f.AFrameworkApplication.fa.appSettings,Wb=this.$.ya.DirectPrintSetting;jb.DirectPrintIsEnabled=Wb.DirectPrintIsEnabled.toString();jb.DirectPrintProbeIsEnabled=
Wb.DirectPrintProbeIsEnabled.toString();jb.DirectPrintEnabledForInternetExplorer=Wb.DirectPrintEnabledForInternetExplorer.toString();jb.DirectPrintSupportedMimeTypes=Wb.DirectPrintSupportedMimeTypes;jb.DirectPrintSupportedPlugins=Wb.DirectPrintSupportedPlugins;jb.DirectPrintImmersivePreviewPlugins=Wb.DirectPrintImmersivePreviewPlugins;jb.DirectPrintMinimalSupportedEdgeVersion=Wb.DirectPrintMinimalSupportedEdgeVersion;jb.DirectPrintEnabledForEdge=Wb.DirectPrintEnabledForEdge.toString();jb=new ya.a(jb);
let wc=null;Wb=null;try{Wb=window.navigator.mimeTypes}catch(zc){e.ULS.sendTraceTag(537154270,0,15,"Failed to get Window.Navigator.mimeTypes")}let Jc=null;try{Jc=window.navigator.plugins}catch(zc){e.ULS.sendTraceTag(537154269,0,15,"Failed to get Window.Navigator.plugins")}wc=new Qb.a(jb,Wb,Jc,Qb.a.hif,Qb.a.Lmf,new sb.a(f.AFrameworkApplication.sa.RW),f.AFrameworkApplication.sa.HD,Qb.a.Mmf,(zc,gd)=>new d.a(zc,!1,gd),!1);if(t.EwaSettings.isChangeGateEnabled("OfficeVSO:7497739_UniversalPrintCG")&&t.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableLicenseCheckForUniversalPrint",
!1)&&this.$.$d.get(116)){const zc=l.GetServiceTaskFactory.Oa(this.$.da,349,350,this.Xa);k.TaskExtensions.za(zc,()=>{const gd=new ta(this.$,wc,zc.result);this.$c([gd])},this.$.la)}else this.$c([new ta(this.$,wc,null)])}static ka(jb){h.a.Md(73,new oc(jb))}}Object(b.a)(oc,"PrintCommandHandlerFactory",h.a,[]);a.d(F,"a",function(){return kb});const kb=()=>{c.a.Fa(oc.ka)}},1170:function(r,F,a){var c=a(9),b=a(0),e=a(226),f=a(50),d=a(37),h=a(15),l=a(89),k=a(84),t=a(244),n=a(627),z=a(213),w=a(113),m=a(35),
u=a(40),y=a(239),v=a(45),C=a(6),x=a(36),B=a(73),H=a(594);class I extends y.a{constructor(kb,jb){super(kb);this.b3j=["id","sessionId","workbookType","workbookFileType","dataloss"];this.command=0;this.lGb=()=>{const Wb=this.FUh();if(Wb){this.$.YH(!0);if(-2028960985!==this.command&&1461300262!==this.command){const wc=B.a(this.$).gd.activityState;wc[x.a.HYa]=C.a.download;wc[H.a.iWc]=this.command}v.a(this.$).Jt(Wb.Errors)}};this.iframe=kb;this.$=jb;this.Cc.ka("load",this.lGb)}get kei(){return"loading"!=
this.iframe.contentDocument.readyState&&"uninitialized"!=this.iframe.contentDocument.readyState}downloadFile(kb,jb){const Wb={};(kb=this.XEh(kb,Wb))&&u.a.nsc("dlfr",kb,Wb);this.command=jb}XEh(kb,jb){var Wb=kb.split("?");if(2!==Wb.length)return kb=null,h.ULS.sendTraceTag(537154816,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (missing '?')"),kb;Wb=Wb[1].split("&");for(const Jc of Wb){var wc=Jc.split("=",2);if(2!==wc.length){kb=null;h.ULS.sendTraceTag(537154787,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (key value pair has no '=' sign)");
break}Wb=wc[0];this.b3j.includes(Wb)&&(wc=decodeURIComponent(wc[1]),jb[Wb]=wc,kb=z.a.NJb(kb,Wb))}return kb}reset(){this.iframe&&(this.iframe.src="about:blank");this.command=1461300262}FUh(){try{return this.iframe.contentWindow.ewaResult}catch(kb){if(!this.$.ea.$b.isDivSyndicated){const jb=window.document.referrer.match(RegExp("://(.[^/]+)/"));h.ULS.sendTraceTag(537154785,0,50,`FileLoader.OnFrameLoad: parent domain: ${1<jb.length?jb[1]:""}, current domain: ${escape(window.location.host)}, iframe domain: ${escape(this.iframe.contentWindow.location.host)}. ewaControl IsCrossDomain: ${this.$.H6a}`);
throw kb;}return null}}static ewe(kb){let jb=document.createElement("iframe");jb.id="ewaFileLoader";jb.style.cssText="height:0;width:0;display:none";jb.src="about:blank";jb.setAttribute("name","dlfr");jb=kb.domElement.appendChild(jb);return new I(jb,kb)}}Object(b.a)(I,"FileLoader",y.a,[]);var U=a(147),S=a(55);class G{constructor(kb,jb){this.Rc=()=>{m.a.lg(B.a(this.$).gd.activityState,U.a.VBd)||this.Dua.reset()};this.$=jb;this.umc=kb;this.ea=jb.ea;this.ea.Jj(this.Rc);this.Dua=I.ewe(this.$)}xph(){const kb=
this.b_g(this.$),jb=this.$.userOperationManager.operationCount;0<jb&&h.ULS.sendTraceTag(537154822,0,15,`flushing queue in downloadcopy. Queue is ${jb}`);this.$.userOperationManager.T3("DownloadACopyOperation.DownloadForkedFile");this.umc&&h.ULS.sendTraceTag(537154821,0,50,"DownloadACopyOperation - Dataloss scenario");this.Dua.downloadFile(kb,-21742208);d.TaskExtensions.za(S.Task.delay(1),()=>{this.Ddf()},this.Dua.la,3)}dispose(){this.ea&&this.ea.ik(this.Rc);this.$=this.ea=null}Ddf(kb=null){kb||(kb=
this.$.Jb.Gc("LoadResource","DownloadACopyOperation"));!this.Dua.kei&&kb.Bc<G.Yuf?window.setTimeout(()=>{this.Ddf(kb)},G.yph):(kb.Bc>=G.Yuf&&h.ULS.sendTraceTag(537154820,0,15,"Download did not complete after 10 seconds."),B.a(this.$).gd.lM())}b_g(kb){const jb=new Sys.StringBuilder,Wb=kb.workbookContext,wc=kb.ya;jb.append(kb.yna);jb.append(wc.FileHandlerRelativeUri);jb.append("?id=");jb.append(encodeURIComponent(z.a.NJb(Wb.WorkbookUri,"sc")));kb.ea.Xb&&(jb.append("&sessionId="),jb.append(encodeURIComponent(kb.ea.sessionId)));
jb.append("&workbookType=FullForkedWorkbook");jb.append("&dataloss=");jb.append(this.umc?"true":"false");w.a.$ob(jb,wc);return jb.toString()}}G.Yuf=1E5;G.yph=100;Object(b.a)(G,"DownloadACopyOperation",null,[2]);class D extends t.a{constructor(kb,jb,Wb=!1){super(kb,jb);this.dEb=null;this.iEd=wc=>{this.unsubscribe(Jc=>{wc.remove_disposing(Jc)});this.gh(C.a.Kj);this.kp()};this.umc=Wb}execute(kb){const jb=Object(k.a)(7,kb.Ee);if(!jb.Gka)return h.ULS.sendTraceTag(537154818,0,50,"DownloadAForkedCopyActivity.Execute: blocking Download action as the workbook is protected"),
this.Tod(kb),this.gh(C.a.idle),1;this.dEb||(this.dEb=new G(this.umc,jb));this.dEb.xph();h.ULS.shipAssertTag(537154817,0,3!==B.a(jb).Th.nu,"The current activity should not be closed.");return 1}Tod(kb){const jb=Object(k.a)(7,kb.Ee),Wb=new n.a(jb);this.subscribe(kb,this.iEd,wc=>{Wb.add_disposing(wc)});h.ULS.sendTraceTag(50954707,0,50,"DownloadAForkedCopyActivity.ProtectedFileDataLeakErrorDialog: showing alert dialog to user");Wb.initialize();Wb.kg()}dispose(){l.a.Ja(this.dEb);this.dEb=null;super.dispose()}}
Object(b.a)(D,"DownloadAForkedCopyActivity",t.a,[]);class E extends e.a{constructor(kb){super();this.$=kb;this.Db()}create(){d.TaskExtensions.za(f.GetServiceTaskFactory.create(this.$.da,155,this.la,this.Xa),()=>{this.nb(new D(C.a.f2a,C.a.Kj,!0))},this.la)}}Object(b.a)(E,"DownloadACopyPreDatalossActivityFactory",e.a,[]);class N extends e.a{constructor(kb){super();this.$=kb;this.Db()}create(){d.TaskExtensions.za(f.GetServiceTaskFactory.create(this.$.da,155,this.la,this.Xa),()=>{this.nb(new D(C.a.unmergeableDownloadCopy,
C.a.Koa))},this.la)}}Object(b.a)(N,"DownloadAForkedCopyActivityFactory",e.a,[]);var M=a(85),L=a(4),aa=a(79),V=a(27),P=a(108),ba=a(25);class Y{constructor(kb,jb,Wb){this.Ma=kb;this.fzg=jb;this.z1=Wb}Ag(){this.Ma.Nb(ba.a.tryMacOffice,P.a.frame,Object(M.a)(this,this.P0i,"onTryMacOffice"));this.Ma.Nb(ba.a.ghg,P.a.frame,Object(M.a)(this,this.MJf,"onTryMacOfficeFromViewer"));this.Ma.Nb(ba.a.fhg,P.a.frame,Object(M.a)(this,this.MJf,"onTryMacOfficeFromViewer"))}P0i(kb,jb,Wb,wc,Jc){if(1===Wb)return 32;Jc?(kb=
Jc.SourceControlId,"btnjTryMacOfficeForWordEditor"===kb?u.a.gf(aa.a.pZ(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===kb&&u.a.gf(aa.a.pZ(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.Wpf();return 32}MJf(kb,jb,Wb){if(1===Wb)return 32;switch(kb){case ba.a.ghg:u.a.gf(aa.a.pZ(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case ba.a.fhg:u.a.gf(aa.a.pZ(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32}Wpf(){u.a.gf(Y.MFi,
"_blank",void 0,"LaunchMacTrialWindow")}get tzc(){return this.fzg&&V.a.isMac&&!V.a.tsi&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get dGj(){return this.tzc}static get MFi(){return aa.a.gH("522401")}}Object(b.a)(Y,"MacOfficeOffer",null,[625]);var Z=a(83);class ea{constructor(kb,jb,Wb){this.Ma=kb;this.jzg=jb;this.wHc=null;(this.ZYb=L.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&Z.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(wc=>
{this.wHc=wc});this.z1=Wb}Ag(){this.Ma.Nb(ba.a.tryOffice,P.a.frame,Object(M.a)(this,this.Q0i,"onTryOffice"));this.Ma.Nb(ba.a.tryOfficeThroughTellMe,P.a.frame,Object(M.a)(this,this.tryOfficeThroughTellMe,"tryOfficeThroughTellMe"));this.Ma.Nb(ba.a.jhg,P.a.frame,Object(M.a)(this,this.khg,"tryOfficeThroughViewer"));this.Ma.Nb(ba.a.ihg,P.a.frame,Object(M.a)(this,this.khg,"tryOfficeThroughViewer"))}Q0i(kb,jb,Wb,wc,Jc){if(this.ZYb&&1===Wb)return this.isFreemiumUpsellEnabled&&this.fNb?32:8;2===Wb&&(Jc?(kb=
Jc.SourceControlId,"btnjTryOfficeForWordEditor"===kb?u.a.gf(aa.a.pZ(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===kb?u.a.gf(aa.a.pZ(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.slc()):this.slc());return 32}tryOfficeThroughTellMe(kb,jb,Wb,wc,Jc){if(this.ZYb&&1===Wb)return this.isFreemiumUpsellEnabled&&this.fNb?32:8;2===Wb&&(Jc?(kb=Jc.SourceControlId,u.a.gf(aa.a.gH("862405")+this.H_h(kb),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):
u.a.gf(aa.a.gH("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32}khg(kb,jb,Wb){if(this.ZYb&&1===Wb)return this.isFreemiumUpsellEnabled&&this.fNb?32:8;if(2===Wb)switch(kb){case ba.a.jhg:u.a.gf(aa.a.pZ(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case ba.a.ihg:u.a.gf(aa.a.pZ(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32}get Iyf(){return this.fNb}get eNi(){return this.fNb&&MSOJS.ClientUtils.OfferOfficeInDialog()}get fNb(){return this.jzg&&!V.a.isMac}get isFreemiumUpsellEnabled(){let kb=
!1;this.wHc&&(kb=this.wHc.isFreemiumUpsellEnabled());return kb}slc(kb=null){let jb=0;kb&&(jb=kb);u.a.gf(ea.oYh(jb),"_blank",void 0,"LaunchOfficeOffer")}H_h(kb){let jb=0;switch(kb){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":jb=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":jb=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":jb=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":jb=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":jb=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":jb=
6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":jb=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":jb=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":jb=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":jb=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":jb=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":jb=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":jb=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":jb=19;
break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":jb=20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":jb=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":jb=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":jb=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":jb=29}return 0===jb?"":String.format("&pc={0:D}",jb)}static oYh(kb){if(V.a.Hg)switch(kb){case 1:return aa.a.gH("393806");case 2:return aa.a.gH("393810");case 3:return aa.a.gH("393809");case 5:return aa.a.gH("393805")}else if(V.a.ap)switch(kb){case 1:return aa.a.gH("521979");
case 3:return aa.a.gH("521980");case 5:return aa.a.gH("521978");case 2:return aa.a.gH("522490")}else{if(2===kb)return aa.a.gH("517778");if(1===kb)return aa.a.pZ(30)}return aa.a.gH("522402")}}Object(b.a)(ea,"OfficeTrialExperience",null,[624]);class ra{Bh(kb){kb.register(ea,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").qc().yc(()=>new ea(L.AFrameworkApplication.rb,L.AFrameworkApplication.vBb,L.AFrameworkApplication.lcid));kb.register(Y,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").qc().yc(()=>
new Y(L.AFrameworkApplication.rb,L.AFrameworkApplication.zic,L.AFrameworkApplication.lcid))}}Object(b.a)(ra,"OpenInClientConfiguration",null,[4]);var O=a(552),da=a(1384),xa=a(38),ia=a(1217),Ma=a(150),Ta=a(156),Da=a(227),fa=a(14),ua=a(86),Fa=a(110),ca=a(88);const ka=kb=>{for(let jb=0;jb<kb.children.length;jb++){const Wb=kb.children[jb];Wb.style.position="relative";Wb.style.top=(Wb.parentNode.offsetHeight-Wb.offsetHeight)/2+"px"}},Ca=kb=>kb.Ea.keyCode===ua.a.Lh||kb.Ea.keyCode===ua.a.Kea?(kb.Mb.click(),
!0):!1,fb=(kb,jb,Wb,wc,Jc,zc,gd)=>{const Va=document.createElement("a");Va.className="ProtocolLaunchingDialogButtonAnchor";Va.className+=" OICDialog";Va.id=kb;Va.setAttribute(ca.a.Cd,ca.a.Qs);Va.style.padding="0";Va.style.margin="0";wc&&yb(Jc,jb,Wb,wc,Va);kb=document.createElement("span");kb.className="ProtocolLaunchingDialogButtonLabel";kb.innerText=Jc;Va.appendChild(kb);Va.tabIndex=0;zc&&Da.a.instance.ta(fa.a.click,Va,zc);gd&&Fa.KeyInputManager.instance.ta(fa.a.Ld,Va,gd);return Va},yb=(kb,jb,Wb,
wc,Jc)=>{var zc=document.createElement("img");zc.alt=kb;zc.className=Ta.getImageClassWithCluster(Wb,wc);zc.src=jb;zc.setAttribute(ca.a.Cd,ca.a.sq);kb=document.createElement("span");kb.className="ProtocolLaunchingDialogImg32Container";kb.appendChild(zc);zc=document.createElement("span");zc.className="ProtocolLaunchingDialogIconContainer";zc.appendChild(kb);Jc.appendChild(zc)};class mb{static get og(){return Ma.a.zq(mb.Ll,CommonUIStrings.l_OICLaunchDialogTitle)}}mb.Ll="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(b.a)(mb,"OICLaunchDialogHtml",null,[]);class nb extends Ma.a{constructor(kb){super();this.kVa=this.TCa=null;this.Ypa=!1;this.iq=kb;this.og=mb.og;this.Ob=5;this.pe="OICLaunchDialog";this.showDialog("",Object(M.a)(this,this.xNi,"oicLaunchDialogResultHandler"));this.z5f();this.EW("ProtocolLaunchingDialogTitle");4!==L.AFrameworkApplication.sa.Qa.editMode&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.lI(this.TCa);h.ULS.sendTraceTag(22140865,
211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}z$a(){this.TCa=fb("BtnRichClient",this.iq.Rtb,this.iq.xzb,this.iq.jnd,CommonUIStrings.l_OICLaunchRichClient,Object(M.a)(this,this.DHf,"onRichClientButtonClick"),Ca);document.getElementById("OICLaunchRichClient").appendChild(this.TCa);ka(this.TCa);this.kVa=fb("BtnReturn",this.iq.Rtb,this.iq.xzb,this.iq.Odf,CommonUIStrings.l_OICReturnToOnlineClient,Object(M.a)(this,this.AHf,"onReturnButtonClick"),
Ca);document.getElementById("OICReturnToApp").appendChild(this.kVa);ka(this.kVa)}AHf(){this.hide();this.iq.Wcb();return!0}DHf(){h.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();L.AFrameworkApplication.rb.processAction(ba.a.cRa,2);return!0}xNi(){this.iq.Wcb()}dispose(){this.Ypa||(this.TCa&&(Da.a.instance.Ba(fa.a.click,this.TCa,Object(M.a)(this,this.DHf,"onRichClientButtonClick")),Fa.KeyInputManager.instance.Ba(fa.a.Ld,this.TCa,Ca)),this.kVa&&(Da.a.instance.Ba(fa.a.click,
this.kVa,Object(M.a)(this,this.AHf,"onReturnButtonClick")),Fa.KeyInputManager.instance.Ba(fa.a.Ld,this.kVa,Ca)),super.dispose(),this.Ypa=!0)}}Object(b.a)(nb,"OICLaunchDialog",Ma.a,[]);class X{static get og(){return Ma.a.zq(X.Ll,CommonUIStrings.l_OICDialogTitle)}}X.Ll="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(b.a)(X,"ProtocolLaunchingDialogV2Html",null,[]);a(423);var R=a(109);class wa extends Ma.a{constructor(kb){super();this.jVa=this.Xea=null;this.Ypa=!1;this.Dpa=null;this.iq=kb;this.og=X.og;this.Ob=5;this.pe="ProtocolLaunchingDialog";this.CJc="OICRetryDialog";L.AFrameworkApplication.ji.A5a&&L.AFrameworkApplication.ji.Xvc();L.AFrameworkApplication.ji.fg(new R.a(2,1,5E3,()=>{this.switchToBackupMode()},101));this.showDialog("",Object(M.a)(this,this.EId,"protocolLaunchingDialogResultHandler"));this.z5f();
this.EW("Issues");this.gZe();h.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}z$a(){const kb=document.getElementById("Issues");if(kb){yb("",this.iq.Rtb,this.iq.xzb,this.iq.jnd,kb);const jb=document.createElement("span");jb.className="WACDialogSectionTitle";jb.innerText=5===this.iq.GKf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;kb.appendChild(jb);ka(kb);kb.style.display="none"}L.AFrameworkApplication.sa.Qa.dkd?
(this.jVa=fb("GiveFeedback",this.iq.Rtb,this.iq.xzb,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(M.a)(this,this.rpc,"onGiveFeedbackClick"),Object(M.a)(this,this.PDf,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.jVa),ka(this.jVa)):document.getElementById("ButtonGiveFeedback").style.display="none";0===L.AFrameworkApplication.sa.Qa.editMode||L.AFrameworkApplication.inh?document.getElementById("ButtonEdit").style.display="none":
(this.Xea=fb("Edit",this.iq.Rtb,this.iq.xzb,"",2===L.AFrameworkApplication.sa.Qa.Oj?4===L.AFrameworkApplication.sa.Qa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===L.AFrameworkApplication.sa.Qa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(M.a)(this,this.qCf,"onEditClick"),Object(M.a)(this,this.uCf,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.Xea),ka(this.Xea));0===
L.AFrameworkApplication.sa.Qa.editMode&&!L.AFrameworkApplication.vBb&&kb&&(kb.style.display="none")}iZe(){return this.Dpa?(this.lI(this.Dpa),!0):!1}gZe(){return this.Xea?(this.lI(this.Xea),!0):!1}uCf(kb){return this.sCd(kb,0)}PDf(kb){return this.sCd(kb,2)}zHf(kb){return this.sCd(kb,1)}sCd(kb,jb){let Wb=!1;if(kb.Ea.keyCode===ua.a.Lh||kb.Ea.keyCode===ua.a.Kea)kb.Mb.click(),Wb=!0;else if(kb.Ea.keyCode===Sys.UI.Key.down||kb.Ea.keyCode===Sys.UI.Key.up)switch(jb){case 1:Wb=this.gZe();break;case 0:Wb=this.iZe()}return Wb}qCf(){this.hide();
4===L.AFrameworkApplication.sa.Qa.editMode?(h.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.iq.Wcb()):(h.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.iq.zkd());return!0}rpc(){h.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");this.iq.H$e();return!0}pqc(){h.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";L.AFrameworkApplication.rb.processAction(ba.a.cRa,2);return!0}EId(){this.iq.Wcb()}switchToBackupMode(){var kb=
document.getElementById("ProtocolLaunchingDialogTitle");if(kb){kb.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(kb=document.getElementById("Issues"))kb.style.display="block";(kb=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!kb.children.length&&(this.Dpa=fb("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(M.a)(this,this.pqc,"onRetryOICClick"),Object(M.a)(this,this.zHf,"onRetryOICKeyUp")),kb.appendChild(this.Dpa),ka(this.Dpa),this.Xea||this.iZe())}}dispose(){this.Ypa||(this.Xea&&
(Da.a.instance.Ba(fa.a.click,this.Xea,Object(M.a)(this,this.qCf,"onEditClick")),Fa.KeyInputManager.instance.Ba(fa.a.Ld,this.Xea,Object(M.a)(this,this.uCf,"onEditKeyUp"))),this.jVa&&(Da.a.instance.Ba(fa.a.click,this.jVa,Object(M.a)(this,this.rpc,"onGiveFeedbackClick")),Fa.KeyInputManager.instance.Ba(fa.a.Ld,this.jVa,Object(M.a)(this,this.PDf,"onGiveFeedbackKeyUp"))),this.Dpa&&(Da.a.instance.Ba(fa.a.click,this.Dpa,Object(M.a)(this,this.pqc,"onRetryOICClick")),Fa.KeyInputManager.instance.Ba(fa.a.Ld,
this.Dpa,Object(M.a)(this,this.zHf,"onRetryOICKeyUp"))),super.dispose(),this.Ypa=!0)}}Object(b.a)(wa,"ProtocolLaunchingDialog",Ma.a,[]);var na=a(135),Ba=a(430);class Ra extends na.StandardDialog{constructor(kb){super();this.iq=kb;this.pe="ProtocolLaunchingDialog";L.AFrameworkApplication.ji.A5a&&L.AFrameworkApplication.ji.Xvc();L.AFrameworkApplication.sa.Qa.dkd&&this.Ooe(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(M.a)(this,this.rpc,"onGiveFeedbackClick"));Ra.Gaf?(this.Ob=12,this.tc(1,
CommonUIStrings.l_CloseFile),this.tc(2,CommonUIStrings.l_OICDialogContinueHere),this.tc(3,CommonUIStrings.l_OICDialogLaunchAgain)):(this.Ob=4,this.tc(1,CommonUIStrings.l_OICDialogContinueHere),this.tc(2,CommonUIStrings.l_OICDialogLaunchAgain));this.EEb(CommonUIStrings.l_OICDialog2ndTitle,5===this.iq.GKf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(M.a)(this,this.EId,"protocolLaunchingDialogResultHandler"),null)}rpc(kb){h.ULS.sendTraceTag(595342858,
211,50,"Open give feedback dialog");this.MCf(kb)}pqc(){h.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");L.AFrameworkApplication.rb.processAction(ba.a.cRa,2)}EId(kb){Ra.Gaf?3===kb?this.e_f():2===kb||0===kb?this.continueEditing():1===kb&&this.b6g():2===kb?this.e_f():(1===kb||0===kb)&&this.continueEditing()}b6g(){h.ULS.sendTraceTag(577783557,211,50,"Closing the document");L.AFrameworkApplication.rb.Vd(ba.a.close,2,Ba.a)}e_f(){h.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(M.a)(this,
this.pqc,"onRetryOICClick"),0)}continueEditing(){4===L.AFrameworkApplication.sa.Qa.editMode||L.AFrameworkApplication.fa.pa("WordConsumptionViewToEditRedirectIsEnabled")&&1===L.AFrameworkApplication.sa.mode?(h.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.iq.Wcb()):(h.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.iq.zkd())}static get Gaf(){return L.AFrameworkApplication.fa.pa("OICDialogThreeActions")&&32===L.AFrameworkApplication.rb.processAction(ba.a.close,
1)}}Object(b.a)(Ra,"StandardProtocolLaunchingDialog",na.StandardDialog,[]);var qa=a(1263);class La{}Object(b.a)(La,"EditDocumentInClientParams",null,[]);class Yb{static J9c(kb,jb,Wb,wc,Jc,zc,gd=!1,Va=!1,Eb="",hc=!1,Ab=!1,Bb=!1,ec="",Qd="",dc="",dd=!1){const jd=new La;jd.DocumentUrl=kb;jd.Mode=jb;jd.Options=Wb;jd.Application=wc;jd.SilentExternalHandler=gd;jd.EncodeUrl=Va;jd.CorrelationIdForWinClient=Eb;jd.NavigateUsingWindowOpen=hc;jd.DescriptiveUnattemptedEnums=Ab;jd.NoBrowserModalDialogs=Bb;jd.SessionOrigin=
ec;jd.CorrelationId=Qd;jd.ClickTime=dc;jd.NewTelemetryDataIsEnabled=dd;MSOJS.ClientUtils.EditDocumentInClient(jd,Jc,zc)}}Object(b.a)(Yb,"ClientUtils",null,[]);var mc=a(99),Zb=a(145),qb=a(473),Ha=a(174),Ya=a(838),Gb=a(378),Ja=a(168),Na=a(70),Qa=a(194);class Oa{constructor(kb){this.Ofa=this.v8d=this.qVa=null;this.ujb=!1;this.rPc=this.Dfe=null;this.vSb=this.RD=this.OXb="";this.application=this.TB=0;this.hQj=this.yXd=!1;this.f3j=kb&&L.AFrameworkApplication.fa.pa("OICLaunchDialogIsEnabled");L.AFrameworkApplication.rb.Y3(ba.a.cRa)||
L.AFrameworkApplication.rb.Nb(ba.a.cRa,P.a.frame,Object(M.a)(this,this.sqj,"retryOpenInClientAction"));this.jag=!!L.AFrameworkApplication.fa&&L.AFrameworkApplication.fa.pa("SilentExternalHandler")}get GKf(){return this.TB}Gyc(kb,jb="",Wb=""){this.RD=Wb||Ha.a.create().toString();this.OXb=jb||qb.a.m5e();this.vSb=kb}sqj(kb,jb,Wb){return jb.contextId!==P.a.frame?2:1===Wb?32:this.cRa()}get options(){let kb=0;L.AFrameworkApplication.roj&&(kb|=1);L.AFrameworkApplication.openInClientEditOnly&&(kb|=4);this.dQj()&&
(kb|=64);return kb}dQj(){return!(2===this.application&&L.AFrameworkApplication.fa.pa("IsEmbeddedScenario"))}get Rtb(){return L.AFrameworkApplication.UA}get xzb(){return L.AFrameworkApplication.Y5a}get Odf(){return""}get jnd(){return""}get kdg(){return L.AFrameworkApplication.fa.pa("OneNoteMobileViewerIsEnabled")}get jCc(){return this.Dfe||(this.Dfe=Z.a.instance.resolve("Common.IOfficeTrialExperience"))}closeApplication(){this.yXd||this.SDh()}Wcb(){this.hQj||this.jEh()}ESf(kb){this.f3j&&V.a.Hg?new nb(this):
this.J4b(kb)}J4b(kb){const jb=({JBa:kb}=this.Pyi(kb)).returnValue;h.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===jb,kb);return jb}LGa(kb,jb,Wb,wc,Jc,zc){this.qVa=kb;this.v8d=jb;this.Ofa=zc;this.application=Wb;this.TB=wc;L.AFrameworkApplication.downloadCopyOnOpenInClient?this.Spf():L.AFrameworkApplication.limitedEdit&&!L.AFrameworkApplication.hostAuthenticatesUsersDuringOpenInClient?L.AFrameworkApplication.E$f():this.KVg(Jc)}get wNi(){return!!L.AFrameworkApplication.fa&&L.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",
!1)}cRa(){this.wNi&&this.MBi();return this.J4b(this.ujb)}Z2f(){const kb=new Ya.a(Ja.a.openInClient);kb.Values["ui-language"]=L.AFrameworkApplication.lcid.toString();kb.Values[qa.a.d7c]=L.AFrameworkApplication.userSessionId;return this.Ofa.value.send(kb)?32:8}MBi(){mc.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new Qa.a,{inStaging:!0}))}Yvj(kb){const jb=new Ya.a(Ja.a.c6j);jb.Values["ui-language"]=L.AFrameworkApplication.lcid.toString();
jb.Values[qa.a.d7c]=L.AFrameworkApplication.userSessionId;jb.Values[Gb.a.b6j]=kb;this.Ofa.value.send(jb)}Pyi(kb){this.ujb=kb;this.Yvj(5===this.TB?Oa.m2i:Oa.o2i);return 5===this.TB?this.Oyi():this.Tyi()}Oyi(){this.$pf();return{returnValue:32,JBa:"HostEditUrl,"}}Tyi(){let kb;var jb=kb="";L.AFrameworkApplication.Hpe&&(jb="|f|"+L.AFrameworkApplication.userSessionId);const Wb=L.AFrameworkApplication.fa.pa("IsAssignmentMode")&&L.AFrameworkApplication.fa.pa("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||
L.AFrameworkApplication.isUnifiedHostMode||V.a.kxa,wc=L.AFrameworkApplication.fa.pa("UnattemptedEnumIsEnabled"),Jc=L.AFrameworkApplication.fa.pa("NoBrowserModalDialogs");if(L.AFrameworkApplication.rb.Tnc){var zc=L.AFrameworkApplication.rb.wZ(3588168074);zc&&this.Gyc(zc.epochClickTime,zc.sessionOrigin,zc.correlationId);this.fsf()}if(L.AFrameworkApplication.QNf){kb+="NewOrder,";zc=8;this.Ofa&&this.Ofa.value&&this.Ofa.value.isEnabled()&&L.AFrameworkApplication.c1d&&(kb+="Post,",zc=this.Z2f());if(32===
zc)return{returnValue:zc,JBa:kb};h.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return L.AFrameworkApplication.om.aab?(h.ULS.shipAssertTag(5566816,211,!!L.AFrameworkApplication.om.aab),kb+="HostUrl,",{returnValue:L.AFrameworkApplication.sa.O9a(L.AFrameworkApplication.om.aab),JBa:kb}):this.qVa?(h.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",L.AFrameworkApplication.userSessionId),kb+="DocUrl,",Yb.J9c(this.qVa,this.TB,
this.options,this.application,Object(M.a)(this,this.tCf,"onEditInClientSuccess"),Object(M.a)(this,this.sCf,"onEditInClientFailure"),this.jag,L.AFrameworkApplication.fa.pa("OICEncodeUrlIsEnabled"),jb,Wb,wc,Jc,this.OXb,this.RD,this.vSb,L.AFrameworkApplication.rb.Tnc),{returnValue:32,JBa:kb}):{returnValue:8,JBa:kb}}kb+="OldOrder,";if(!this.qVa&&L.AFrameworkApplication.om.aab)return this.Ofa&&this.Ofa.value&&this.Ofa.value.isEnabled()&&L.AFrameworkApplication.c1d?(kb+="Post,",jb=this.Z2f()):(h.ULS.sendTraceTag(22595483,
211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),jb=8),32!==jb?(h.ULS.shipAssertTag(22595484,211,!!L.AFrameworkApplication.om.aab),kb+="HostUrl,",{returnValue:L.AFrameworkApplication.sa.O9a(L.AFrameworkApplication.om.aab),JBa:kb}):{returnValue:jb,JBa:kb};h.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",L.AFrameworkApplication.userSessionId);kb+="DocUrl,";Yb.J9c(this.qVa,this.TB,this.options,this.application,Object(M.a)(this,this.tCf,"onEditInClientSuccess"),
Object(M.a)(this,this.sCf,"onEditInClientFailure"),this.jag,L.AFrameworkApplication.fa.pa("OICEncodeUrlIsEnabled"),jb,Wb,wc,Jc,this.OXb,this.RD,this.vSb,L.AFrameworkApplication.rb.Tnc);return{returnValue:32,JBa:kb}}$Xf(kb){L.AFrameworkApplication.Gn.setDw(8981,kb)}tCf(kb){this.$Xf(kb);h.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===kb&&MSOJS.ClientUtils.ShouldShowDialog()?(this.kdg||this.$pf(),this.fsf()):this.yXd||this.closeApplication()}sCf(kb,jb=0){h.ULS.sendTraceTag(18715407,
211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",kb,jb);if(5===kb)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const Wb=!!this.v8d&&!this.ujb;let wc=0;1===kb&&(wc=2);6<=kb&&13>=kb&&(wc=1,1===jb&&(this.yXd=!0));this.jCc.eNi?(h.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",wc),ia.a.instance.ifh(this.ujb?Object(M.a)(this,this.dzf,"oicErrorDialogHandlerCloseForced"):Object(M.a)(this,this.ezf,"oicErrorDialogHandlerNoCloseForced"),
Wb?Object(M.a)(this,this.VEf,"onLaunchDownload"):null,this.jMe(!1)?Object(M.a)(this,this.Tdi,"iHaveOfficeButtonHandler"):null,wc,jb)):(h.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",wc),ia.a.instance.gfh(this.ujb?Object(M.a)(this,this.dzf,"oicErrorDialogHandlerCloseForced"):Object(M.a)(this,this.ezf,"oicErrorDialogHandlerNoCloseForced"),Wb?Object(M.a)(this,this.VEf,"onLaunchDownload"):null,wc))}}fsf(){try{const kb=[Object.assign(new Na.a,{name:"CorrelationId",string:this.RD}),
Object.assign(new Na.a,{name:"SessionOrigin",string:this.OXb}),Object.assign(new Na.a,{name:"ClickTime",string:this.vSb}),Object.assign(new Na.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];Zb.a("OpenInClientCompleted",!0,0,kb)}catch(kb){h.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+kb.toString())}}$pf(){L.AFrameworkApplication.sa&&L.AFrameworkApplication.sa.Qa.tv&&L.AFrameworkApplication.fa.pa("StandardProtocolDialogIsEnabled")?new Ra(this):new wa(this)}dzf(){this.closeApplication()}ezf(){this.Wcb()}VEf(){this.Spf()}Tdi(){return this.jMe(!0)}jMe(kb){const jb=
(V.a.Ijf||V.a.uH)&&!!L.AFrameworkApplication.U7b;jb&&kb&&(u.a.gf(L.AFrameworkApplication.U7b,"_blank",void 0,"OpenInClient"),this.closeApplication());return jb}}Oa.o2i="OpenInDesktop";Oa.m2i="OpenInBrowser";Object(b.a)(Oa,"AOpenInClientOperation",null,[]);var bb=a(5),Ga=a(208),tb=a(68),wb=a(56),lb=a(327),db=a(48),Pa=a(44),ja=a(196),Ka=a(94),ub=a(29),Kb=a(11),W=a(21),za=a(477),Sa=a(253),Wa=a(256),ab=a(154),ma=a(593);class ha extends Oa{constructor(kb,jb,Wb){super(!0);this.Pa=new xa.a;this.j9c=this.tZe=
!1;this.K4b=this.Lm=this.NDe=null;this.Rc=()=>{m.a.lg(B.a(this.$).gd.activityState,U.a.VBd)||this.Dua.reset()};this.HRi=wc=>{this.$Xf(wc)};this.GRi=()=>{this.LIj()};this.$=kb;this.ea=kb.ea;this.PJ=jb;this.businessBar=Wb;this.ea.Jj(this.Rc);this.Dua=I.ewe(this.$);this.R8g();kb.da.Ha(55,this);this.hga=Z.a.instance.Tb("Common.ISystemInitiatedFeedback")}get Odf(){return"EditInExcelWebApp_32x32x32"}get la(){this.Lm=this.Lm||new ja.a;return this.Lm.token}get jnd(){return"excel32"}get kdg(){return this.ea.$b.inWebPart}j8g(){this.ESf(this.tZe)}k$g(){const kb=
this.$;d.TaskExtensions.za(this.PJ.value,jb=>{this.LGa(kb.workbookContext.ClientUrl,L.AFrameworkApplication.UY,1,kb.isEditMode?2:0,!0,new O.a(()=>jb.result))},this.la,3)}zkd(){0!==wb.a.pg.editMode&&(this.$.qb.uv=!1)}H$e(){const kb={};kb[bb.a.N$b]=!1;kb[bb.a.wM]="OpenInExcel";this.$.Yc(802602464,tb.a.zb,8,kb)}F4c(){if(this.ea.Xb){var kb=this.$;kb.isEditMode&&d.TaskExtensions.za(this.PJ.value,jb=>{this.LGa(kb.workbookContext.ClientUrl,L.AFrameworkApplication.UY,1,2,!1,new O.a(()=>jb.result))},this.la,
3)}}dGe(){this.ea.Xb&&d.TaskExtensions.za(this.PJ.value,kb=>{this.LGa(this.$.workbookContext.ClientUrl,L.AFrameworkApplication.UY,1,this.$.isEditMode?2:0,!1,new O.a(()=>kb.result))},this.la,3)}Gyc(kb){super.Gyc(kb)}openInExcelClient(){this.ea.Xb&&(this.$.isEditMode||d.TaskExtensions.za(this.PJ.value,kb=>{this.LGa(this.$.workbookContext.ClientUrl,L.AFrameworkApplication.UY,1,0,!1,new O.a(()=>kb.result))},this.la,3))}openInBrowser(){this.ea.Xb&&d.TaskExtensions.za(this.PJ.value,kb=>{this.LGa(this.$.workbookContext.ClientUrl,
L.AFrameworkApplication.UY,1,5,!1,new O.a(()=>kb.result))},this.la,3)}downloadFile(kb){const jb=this.Jye(kb);this.Dua.downloadFile(jb,kb);this.oCi()}oCi(){L.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",!1)&&null!=this.hga&&this.hga.execute(kb=>kb.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled"))}CKf(kb,jb=0){if(this.ea.Xb){var Wb=this.$;B.a(Wb).iMa?this.DKf(kb,Wb):0<jb?this.VNj(kb,
Wb,jb):this.s9f(Wb)}}LGa(kb,jb,Wb,wc,Jc,zc){this.$.qb.uv=!this.$.$b.inWebPart;this.tZe=Jc;this.K4b=null;this.j9c=!1;this.PVg(kb,jb,wc,Jc,zc)}J4b(kb){const jb=this.$.$b;h.ULS.sendTraceTag(537154775,0,50,`OpenInExcelOperation.CompleteClientLaunch: IsEmbedded:${jb.inEmbedView}, InWebPart:${jb.inWebPart}, DivSyndicated:${jb.isDivSyndicated}, Mode:${this.$.isEditMode?Ga.a.edit:Ga.a.view}`);return ha.vkf()?(this.l4b(),Yb.J9c(this.qVa,this.TB,this.options,1,this.HRi,this.GRi,!1,L.AFrameworkApplication.fa.pa("OICEncodeUrlIsEnabled")),
32):super.J4b(kb)}SDh(){this.fZf();const kb=this.$;if(!this.ea.$b.inWebPart&&this.ea.Xb&&!kb.isEditMode){const jb=new Ka.a(2145659238,tb.a.zb,this.$.xc,0,null);this.NDe=db.a.instance.create(()=>{kb.Ia.Hb(jb)},0,Pa.a.p2i)}}dispose(){this.ea&&this.ea.ik(this.Rc);l.a.pc([this.Pa,this.NDe,this.Lm]);this.$=this.ea=null}jEh(){this.fZf()}Spf(){db.a.instance.create(()=>{this.$.Ia.Hb(new Ka.a(-2028960985,tb.a.zb,0,30,null))},0,Pa.a.q2i,!0,!0)}KVg(kb){const jb=this.$,Wb=B.a(this.$).gd.activityState;Wb[za.a.Sne]=
!0;jb.isEditMode&&this.ea.Xb?(this.l4b(),v.a(jb).vr(new Sa.a(C.a.hw,5,()=>{jb.YH(!1);Wb[Wa.a.Dp]=C.a.n4b;Wb[za.a.OHg]=kb;Wb[U.a.Zcd]=!0;jb.isEditMode&&(Wb[U.a.jT]=1,Wb[U.a.aY]=!0,Wb[ab.a.c_b]=!0,Wb[ab.a.oWc]=!0);Wb[za.a.Vne]=1455037301}))):this.ESf(kb)}hbg(){const kb=L.AFrameworkApplication.UY;if(this.$.downloadCopyOnOpenInClient){if(8===this.$.frame.O9a(kb,!0)){const jb=this.$.ea.$b;h.ULS.sendTraceTag(537154773,0,50,`Url:[${kb}] IsEmbedded:[${jb.inEmbedView}] InWebPart:[${jb.inWebPart}] DivSyndicated:[${jb.isDivSyndicated}], Mode:[${this.$.isEditMode?
Ga.a.edit:Ga.a.view}]`)}}else this.Dua.downloadFile(kb,-2028960985);this.j9c=!0;this.l4b()}nzi(){this.jCc.Iyf&&this.jCc.slc(1)}ozi(){this.jCc.Iyf&&Kb.HelperMethods.gf(aa.a.pZ(33),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryOffice")}vzi(){Kb.HelperMethods.gf(aa.a.pZ(31),"_blank",void 0,"OpenExcelOperation.XLSBackstageUnknownTryMacOffice")}wzi(){Kb.HelperMethods.gf(aa.a.pZ(34),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryMacOffice")}Jye(kb){const jb=new Sys.StringBuilder,Wb=this.$.workbookContext,
wc=this.$.ya;jb.append(this.$.yna);jb.append(wc.FileHandlerRelativeUri);jb.append("?id=");jb.append(encodeURIComponent(z.a.NJb(Wb.WorkbookUri,"sc")));this.$.ea.Xb&&(jb.append("&sessionId="),jb.append(encodeURIComponent(this.$.ea.sessionId)));switch(kb){case -974518828:jb.append("&workbookType=PublishedItemsSnapshot");break;case -1804063550:jb.append("&workbookType=FullWorkbook");break;case -1059172980:jb.append("&workbookType=FullWorkbook&workbookFileType=Odf");break;default:jb.clear()}kb=!(this.$.isChangeGateEnabled("OfficeVSO:7396073_ShortenUrlToPreventOdsFailure")&&
-1059172980===kb);w.a.$ob(jb,wc,kb);return jb.toString()}R8g(){da.a.instance.i4g();const kb=this.$.ya;MSOJS.ClientUtils.InitUrls(kb.RoamingAppsX86RootUrl,kb.RoamingAppsControlInstallerUrl,kb.RoamingAppsFirefoxExtensionUrl)}fZf(){const kb=this.$;this.ea.Xb||lb.a.JId(kb,B.a(kb).gd);this.l4b();this.K4b&&this.K4b(this,this.j9c);kb.frame.Lt.nm(this.$.frame.Paa());kb.frame.RW.nm(this.$.frame.Paa());kb.qb.uv=!1;W.h(kb).focus()}PVg(kb,jb,Wb,wc,Jc){const zc=this.$;L.AFrameworkApplication.sa&&!ha.vkf()&&(zc.frame.Lt.rn(zc.frame.Paa()),
zc.frame.RW.rn(zc.frame.Paa()));super.LGa(kb,jb,1,Wb,wc,Jc)}l4b(){const kb=this.$;B.a(kb).Th.activityName===C.a.openInExcelClient&&B.a(kb).gd.lM()}LIj(){const kb=ub.a.ed(1,0,680,681,0,1341525452,"OpenInExcelActiveXError");v.a(this.$).Jt([kb])}VNj(kb,jb,Wb){let wc=null;const Jc=window.setTimeout(()=>{B.a(jb).Guc(wc);this.s9f(jb)},Wb);wc=()=>{B.a(jb).iMa&&(B.a(jb).Guc(wc),window.clearTimeout(Jc),this.DKf(kb,jb))};B.a(jb).nXc(wc)}s9f(kb){const jb=ub.a.ed(1,1,0,695,0,-1753121099,"ProcessingUserChangesFileDownloadIgnored");
v.a(kb).Jt([jb])}DKf(kb,jb){v.a(jb).vr(new Sa.a(C.a.hw,5,()=>{jb.YH(!1);const Wb=B.a(jb).gd,wc=Wb.activityState;wc[Wa.a.Dp]=C.a.JNe;wc[ma.a.e_b]=jb.ea.$b.hasUnsupportedFeaturesForEdit;wc[H.a.iWc]=kb;Wb.Yq(ub.a.L3(this.businessBar.V9c,[1437034227]))}))}static vkf(){return 1<wb.a.getRegisteredEwaInstances().length}}Object(b.a)(ha,"OpenInExcelOperation",Oa,[593,2]);class eb extends e.a{constructor(kb){super();this.$=kb;this.Db();eb.Q8g()}create(){if(this.$.da.Aa(55))this.nb(this.$.da.Aa(55));else{var kb=
f.GetServiceTaskFactory.create(this.$.da,155,this.la,this.Xa),jb=f.GetServiceTaskFactory.Oa(this.$.da,5,4,this.Xa);d.TaskExtensions.za(S.Task.aG(kb,jb),()=>{this.nb(new ha(this.$,new O.a(()=>f.GetServiceTaskFactory.create(this.$.da,137,this.la,this.Xa)),jb.result))},this.la,3)}}static Q8g(){eb.gzf||(eb.gzf=!0,(new ra).Bh(Z.a.instance),Z.a.instance.resolve("Common.IOfficeTrialExperience").Ag(),Z.a.instance.resolve("Common.IMacOfficeOffer").Ag())}}eb.gzf=!1;Object(b.a)(eb,"OpenInClientFactory",e.a,
[]);var ta=a(118),ya=a(393);class sb extends ta.a{constructor(kb,jb){super(kb,jb)}execute(kb){const jb=Object(k.a)(7,kb.Ee);d.TaskExtensions.za(f.GetServiceTaskFactory.create(jb.da,56,jb.la,0),Wb=>{jb.downloadCopyOnOpenInClient?(kb.activityState[ya.a.Tne]=!0,Wb.result.hbg()):Wb.result.k$g()},jb.la,3);return 1}}Object(b.a)(sb,"OpenInExcelClientActivity",ta.a,[]);class Qb extends e.a{constructor(kb){super();this.$=kb;kb.da.Ha(56,new eb(kb));this.Db()}create(){d.TaskExtensions.za(f.GetServiceTaskFactory.create(this.$.da,
155,this.la,this.Xa),()=>{this.nb(new sb(C.a.openInExcelClient,C.a.idle))},this.la)}}Object(b.a)(Qb,"OpenInExcelClientActivityFactory",e.a,[]);a.d(F,"a",function(){return oc});const oc=()=>{c.a.Fa(kb=>{kb.da.Ha(57,new Qb(kb));kb.da.Ha(60,new N(kb));kb.da.Ha(63,new E(kb))})}},1171:function(r,F,a){a.r(F);r=a(0);var c=a(15),b=a(86),e=a(4),f=a(110),d=a(14),h=a(89),l=a(54),k=a(30),t=a(27),n=a(12),z=a(239),w=a(1077),m=a(5),u=a(263),y=a(1078),v=a(722),C=a(1286),x=a(94);class B extends v.a{constructor(Ha,
Ya,Gb){super(Ha,Ya);this.Yr=!0;this.command=Gb}Sm(Ha){super.Sm(Ha);this.businessBar.$.Ia.Hb(new x.a(this.command,Ha,this.businessBar.$.xc,10,null))}}Object(r.a)(B,"CommandActionBusinessBarEntry",v.a,[]);class H extends B{constructor(Ha,Ya,Gb){super(Ha,Ya,Gb)}iD(Ha){super.iD(Ha)}}Object(r.a)(H,"EditAttemptReadOnlyBusinessBarEntry",B,[]);var I=a(45);class U extends v.a{constructor(Ha,Ya,Gb,Ja){super(Ha,Ya);this.error=Gb;this.options=Ja;this.error&&this.options&2&&(this.message=this.error.Description);
this.error&&this.options&1&&(this.title=this.error.Caption);this.Yr=!(Ja&4)}Sm(Ha){super.Sm(Ha);this.error.Appearance&=-33;I.a(this.businessBar.$).Jt([this.error])}}Object(r.a)(U,"ErrorBusinessBarEntry",v.a,[]);class S extends U{constructor(Ha,Ya,Gb,Ja,Na){super(Ha,Ya,Gb,Ja);this.command=Na;this.VU=!0}BV(Ha){super.BV(Ha);this.businessBar.$.Ia.Hb(new x.a(this.command,Ha,this.businessBar.$.xc,10,null))}}Object(r.a)(S,"ErrorAndCommandBusinessBarEntry",U,[]);var G=a(13);class D{constructor(Ha,Ya,Gb,Ja,
Na,Qa,Oa,bb,Ga,tb){this.KI=this.Y7=this.KO=0;this.Stg=Ha;this.pTj=Ya;this.LI=Gb;this.eyg=Oa;this.Hjb=k.a.Yu(Ga);this.iwg=Ga;this.G5d=bb;this.fyg=tb;0!==Ja&&(this.KO=Ja);0!==Na&&(this.Y7=Na);0!==Qa&&(this.KI=Qa)}get title(){return D.ga(this.pTj)}get message(){return D.ga(this.LI)}get messageId(){return this.LI}get iconName(){return this.fyg}get G_a(){return this.Stg}get actionButton(){return D.ga(this.KO)}get esa(){return D.ga(this.Y7)}get link(){return D.ga(this.KI)}get ek(){return this.eyg}get businessBarType(){return this.G5d}get hash(){return this.Hjb}get alt(){const {BusinessBarControl:Ha}=
a(1171);switch(this.ek){case Ha.Bia:return D.ga(26);case Ha.Tz:return D.ga(25);case Ha.ri:return D.ga(24);default:return D.ga(0)}}get hJa(){return this.iwg}set businessBarType(Ha){this.G5d=Ha}static ga(Ha){return G.a.instance.ga(Ha)}}Object(r.a)(D,"EwaBusinessBarEntry",null,[]);class E extends D{constructor(Ha,Ya,Gb,Ja,Na,Qa,Oa,bb){super(Ha,0,Ya,Gb,Ja,Na,Qa,Oa,bb)}get title(){return""}}Object(r.a)(E,"EwaNoTitleBusinessBarEntry",D,[]);var N=a(74);class M extends v.a{constructor(Ha,Ya){super(Ha,Ya);
this.VU=this.Yr=!0}Sm(Ha){super.Sm(Ha);this.set_visible(!1);this.businessBar.$.bI();this.businessBar.$.Ia.Hb(new x.a(1038998010,Ha,this.businessBar.$.xc,10,null))}BV(Ha){super.BV(Ha);this.businessBar.$.Ia.Hb(new x.a(-722953877,Ha,this.businessBar.$.xc,10,null))}iD(Ha){this.businessBar.removeEntry(55);N.g(Ha)}}Object(r.a)(M,"ExternalLinksEnableContentBusinessBarEntry",v.a,[]);class L extends v.a{constructor(Ha,Ya){super(Ha,Ya);this.Yr=!0;this.VU=!1}Sm(Ha){super.Sm(Ha);this.businessBar.$.Ia.Hb(new x.a(-722953877,
Ha,this.businessBar.$.xc,10,null))}iD(Ha){this.businessBar.removeEntry(5);N.g(Ha)}}Object(r.a)(L,"ExternalLinksShowErrorBusinessBarEntry",v.a,[]);var aa=a(11);class V extends v.a{constructor(Ha,Ya,Gb){super(Ha,Ya);this.Zyb=Gb;this.Yr=!0}Sm(Ha){super.Sm(Ha);aa.HelperMethods.LV(this.businessBar.$.WF,this.Zyb,this.businessBar.$.mS)}}Object(r.a)(V,"HelpButtonBusinessBarEntry",v.a,[]);class P extends v.a{constructor(Ha,Ya,Gb){super(Ha,Ya);this.Zyb=Gb;this.Xva=!0}lma(Ha){super.lma(Ha);aa.HelperMethods.LV(this.businessBar.$.WF,
this.Zyb,this.businessBar.$.mS)}}Object(r.a)(P,"HelpTextBusinessBarEntry",v.a,[]);var ba=a(68);class Y extends v.a{constructor(Ha,Ya,Gb,Ja){super(Ha,Ya);this.Zyb=Gb;this.command=Ja;this.Xva=!0;this.Yr=1461300262!==Ja}Sm(Ha){super.Sm(Ha);this.businessBar.$.Ia.Hb(new x.a(this.command,Ha,this.businessBar.$.xc,10,null))}lma(Ha){super.lma(Ha);const Ya=new x.a(-859308420,Ha,this.businessBar.$.xc,12,null);this.businessBar.$.Ia.Hb(Ya,{[ba.a.Pf]:"HelpID="+this.Zyb,["InputMethod"]:Ha,[ba.a.Kc]:m.a.WU,[m.a.soa]:!0})}}
Object(r.a)(Y,"HelpTextTaskPaneAndCommandBusinessBarEntry",v.a,[]);class Z extends v.a{constructor(Ha,Ya){super(Ha,Ya);this.VU=this.Yr=!0}Sm(Ha){super.Sm(Ha);this.set_visible(!1);this.businessBar.$.bI();this.businessBar.$.Ia.Hb(new x.a(-1081442996,Ha,this.businessBar.$.xc,10,null))}BV(Ha){super.BV(Ha);this.businessBar.$.Ia.Hb(new x.a(1702917262,Ha,this.businessBar.$.xc,10,null))}iD(Ha){this.businessBar.removeEntry(59);N.g(Ha)}}Object(r.a)(Z,"LinkedEntitiesEnableUntrustedImagesBusinessBarEntry",v.a,
[]);var ea=a(1080);class ra extends v.a{constructor(Ha,Ya){super(Ha,Ya);(this.policyManager=Ha.$.da.Aa(274))?(this.message=this.policyManager.bsc,this.title=this.policyManager.title,this.Xva=!0):c.ULS.sendTraceTag(537170202,306,50,"Tried creating PolicyBusinessBarEntry but policyManager service has not been registered.")}get linkText(){return this.policyManager.linkText}lma(Ha){super.lma(Ha);(Ha=this.policyManager.rWi)&&Ha(null)}}Object(r.a)(ra,"PolicyBusinessBarEntry",v.a,[]);var O=a(1079),da=a(1082),
xa=a(1081);a(423);var ia=a(145),Ma=a(25);class Ta extends v.a{constructor(Ha,Ya){super(Ha,Ya);this.Yr=!0;this.title=""}Sm(Ha){super.Sm(Ha);ia.c(Ma.a.XKi);window.open("https://www.microsoft.com/edge?form=MI13FQ&OCID=MI13FQ","_blank")}}Object(r.a)(Ta,"UnsupportedBrowserBusinessBarEntry",v.a,[]);var Da=a(1076),fa=a(1310);class ua extends v.a{constructor(Ha,Ya){super(Ha,Ya);this.rCa=fa.a.n6b();this.Yr=!0;this.VU=this.rCa.m3j;this.title=this.rCa.title;this.message=this.rCa.message}get actionButton(){return this.rCa.Zye}get esa(){return this.rCa.aze}Sm(Ha){super.Sm(Ha);
this.rCa.oAf(null)}BV(Ha){super.BV(Ha);this.rCa.rAf(null)}iD(Ha){super.iD(Ha);this.rCa.CMe(null)}}Object(r.a)(ua,"WildFireMobileAppBusinessBarEntry",v.a,[]);var Fa=a(250),ca=a(22),ka=a(199),Ca=a(165),fb=a(42),yb=a(7),mb=a(174),nb=a(1083),X=a(70),R=a(127);class wa extends v.a{constructor(Ha,Ya,Gb,Ja){super(Ha,Ya);this.officeScriptsCommandManager=Gb.da.Aa(519);c.ULS.shipAssertTag(512276321,0,!!this.officeScriptsCommandManager);this.id=mb.a.create();this.$=Gb;this.title=G.a.instance.ga(2281);this.message=
"";this.QWd=G.a.instance.ga(2277);this.Rmg=G.a.instance.ga(2278);this.Pmg=G.a.instance.ga(2279);this.NFe=G.a.instance.ga(2280);this.update(Ja)}update(Ha){this.scriptLink=Ha.scriptLink;this.runStatus=Ha.runStatus;this.buttonText=Ha.buttonText||"";this.OBi(Ha.clickId);this.zoj();"preparing"===this.runStatus?(this.Ena(0),this.message=String.format(G.a.instance.ob(208),this.buttonText),this.Yr=!0,this.Kra=this.QWd,this.Drb=this.yga=this.T$a):"running"===this.runStatus?(this.Ena(0),this.message=String.format(G.a.instance.ob(207),
this.buttonText),this.Yr=!0,this.Kra=this.QWd,this.Drb=this.yga=this.T$a):"succeeded"===this.runStatus?(this.Ena(0),this.message=String.format(G.a.instance.ob(210),this.buttonText),"true"===Ha.hasLogs?(this.Yr=!0,this.Kra=this.Pmg,this.yga=this.$Jf,this.VU=!0,this.CYc=this.Rmg,this.DYc=this.aKf):(this.Yr=!0,this.Kra=this.Rmg,this.yga=this.aKf)):"runFailed"===this.runStatus?(this.Ena(1),this.message=String.format(G.a.instance.ob(209),this.buttonText),this.Q5a=qb.Bia,"true"===Ha.hasLogs?(this.Yr=!0,
this.Kra=this.Pmg,this.yga=this.$Jf,"false"===Ha.isOwner&&(this.VU=!0,this.CYc=this.NFe,this.DYc=this.uBf)):"false"===Ha.isOwner&&(this.Yr=!0,this.Kra=this.NFe,this.yga=this.uBf)):"fetchFailed"===this.runStatus?(this.Ena(1),this.Q5a=qb.Bia,this.message=G.a.instance.ga(2283)):"canceled"===this.runStatus?(this.Ena(0),this.Q5a=qb.Tz,this.message=String.format(G.a.instance.ob(212),this.buttonText)):"alreadyRunning"===this.runStatus?(this.Ena(5),this.Q5a=qb.Tz,this.message=String.format(G.a.instance.ob(211),
this.buttonText),this.Yr=!0,this.Kra=this.QWd,this.Drb=this.yga=this.T$a):"initializing"===this.runStatus&&(this.Ena(0),this.Q5a=qb.ri,this.message=G.a.instance.ga(2282))}get ek(){return this.Q5a}get actionButton(){return this.Kra}get esa(){return this.CYc}Sm(Ha){super.Sm(Ha);this.yga&&this.yga()}BV(Ha){super.BV(Ha);this.esa&&this.DYc()}iD(Ha){super.iD(Ha);this.Drb&&this.Drb()}zoj(){this.message="";this.Q5a=qb.ri;this.Yr=!1;this.Kra="";this.yga=void 0;this.VU=!1;this.CYc="";this.DYc=void 0;this.hideCloseButton=
!1;this.Drb=void 0}T$a(){const Ha=mb.a.create().toString();this.officeScriptsCommandManager.O8h(Ha);this.Tlc(-2186799,Ha)}$Jf(){const Ha=mb.a.create().toString();this.officeScriptsCommandManager.N8h(Ha);this.Tlc(1036446140,Ha)}aKf(){const Ha=mb.a.create();if(this.scriptLink){const Ya=new nb.b(this.scriptLink);this.officeScriptsCommandManager.jaf(this.id.toString(),JSON.stringify(Ya),Ha)}this.Tlc(-585097204,Ha.toString())}uBf(){const Ha=mb.a.create().toString();this.officeScriptsCommandManager.M8h(Ha);
this.Tlc(-639858579,Ha)}OBi(Ha){const Ya=[];Ya.push(Object(yb.a)(new X.a,{name:"id",string:this.id.toString()}));Ya.push(Object(yb.a)(new X.a,{name:"hasScriptLink",bool:!!this.scriptLink}));Ya.push(Object(yb.a)(new X.a,{name:"runStatus",string:this.runStatus}));Ya.push(Object(yb.a)(new X.a,{name:"clickId",string:Ha}));Ya.push(Object(yb.a)(new X.a,{name:"hasButtonText",bool:!!this.buttonText&&""!==this.buttonText}));ia.a(R.a.jNi,void 0,void 0,Ya)}Tlc(Ha,Ya){const Gb=[];Gb.push(Object(yb.a)(new X.a,
{name:"id",string:this.id.toString()}));Gb.push(Object(yb.a)(new X.a,{name:"hasScriptLink",bool:!!this.scriptLink}));Gb.push(Object(yb.a)(new X.a,{name:"runStatus",string:this.runStatus}));Gb.push(Object(yb.a)(new X.a,{name:"clickId",string:Ya}));ia.d(Ha,void 0,void 0,void 0,void 0,void 0,Gb)}}Object(r.a)(wa,"OfficeScriptsRunStatusBusinessBarEntry",v.a,[]);var na=a(48),Ba=a(1);class Ra extends B{constructor(Ha,Ya,Gb,Ja,Na,Qa){super(Ha,Ya,Gb);na.a.instance.create(()=>{this.showCallout(Ya,Ja)},Na,Qa,
!0,!0)}showCallout(Ha,Ya){if(this.businessBar&&this.businessBar.Jka(Ha.G_a)&&this.Qse()){Ha=new x.a(-847286761,0,this.businessBar.$.xc,0,null);var Gb={};Gb.CalloutName=Ya;Ba.EwaSettings.isChangeGateEnabled("OfficeVSO:6947554_RetrieveBusinessBarButtonElementChange")?Gb.Target=this.KJ():Gb.Target=Ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.domElement.getElementsByTagName("button")[0]:this.KO.domElement;this.businessBar.$.Ia.Hb(Ha,Gb)}}Qse(){return!0}}Object(r.a)(Ra,
"CalloutBusinessBarEntry",B,[]);class qa extends Ra{constructor(Ha,Ya,Gb,Ja,Na,Qa){super(Ha,Ya,Gb,Ja,Na,Qa)}Qse(){if(!Ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1))return!0;if(!this.businessBar)return!1;const Ha=this.businessBar.$.da.Aa(465);return Ha&&Ha.Pwc?!1:!0}}Object(r.a)(qa,"OptimizeWorkbookCalloutBusinessBarEntry",Ra,[]);var La=a(19);class Yb extends v.a{constructor(Ha,Ya,Gb){super(Ha,Ya);this.update(Gb)}update(Ha){this.title=
Ha.title?Ha.title:"";this.message=Ha.message?Ha.message:"";this.Ena(this.Z$g(Ha.businessBarType));this.hideCloseButton=!!Ha.hideCloseButton}Z$g(Ha){switch(Ha){case "error":return 1;case "blocked":return 2;case "severeWarning":return 3;case "success":return 4;case "warning":return 5;default:return 0}}}Object(r.a)(Yb,"MsFormsDataSyncStatusBusinessBarEntry",v.a,[]);class mc extends v.a{constructor(Ha,Ya,Gb,Ja){super(Ha,Ya);this.VU=this.Yr=!0;this.c9i=Gb;this.bRg=Ja}Sm(Ha){super.Sm(Ha);this.businessBar.$.Ia.Hb(new x.a(this.c9i,
Ha,this.businessBar.$.xc,10,null))}BV(Ha){super.Sm(Ha);this.businessBar.$.Ia.Hb(new x.a(this.bRg,Ha,this.businessBar.$.xc,10,null))}}Object(r.a)(mc,"DualCommandActionsBusinessBarEntry",v.a,[]);class Zb extends v.a{constructor(Ha,Ya,Gb,Ja){super(Ha,Ya);this.host=Gb.ya.HostName;this.vdi="OneDriveWOPI"===this.host||"Open From URL"===this.host;(this.Xti=Ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SaveACopyToOneDrive",!1)||Ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SaveACopyToOneDriveB",
!1)||Ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SaveACopyToOneDriveC",!1))&&this.vdi&&appChrome.renderSaveACopyToOneDriveCallout(Ja)}}Object(r.a)(Zb,"EditAttemptReadOnlyNoEditPermissionsBusinessBarEntry",v.a,[]);a.d(F,"BusinessBarControl",function(){return qb});class qb extends z.a{constructor(Ha,Ya){super(Ya);this.BJh=n.DOMElementExtensions.nr+",div";this.aU=Array(70);this.Gm=!1;this.HV=Gb=>{if(Gb.Ea.keyCode===b.a.By){var Ja=this.jc.querySelectorAll(this.BJh);const Na=n.DOMElementExtensions.rm(Ja);
Ja=n.DOMElementExtensions.PA(Ja);return n.DOMElementExtensions.FAa(Gb.Ea,Na,Ja)}return!1};this.jb=Ha;this.set_visible(!1);this.addCssClass(w.a.ouh);Ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)&&e.AFrameworkApplication.fa.pa("Fluent2StyleIsEnabled")&&this.addCssClass(w.a.quh);f.KeyInputManager.instance.ta(d.a.Sb,this.jc,this.HV);u.a(Ha).Yh(this)}get Xd(){return Fa.a.o0c}get jc(){return this.domElement}get Ff(){return this.get_visible()}get $(){return this.jb}ag(Ha,
Ya){Ya||n.DOMElementExtensions.setFocus(this.domElement.firstChild);return!Ya}sh(Ha){return n.DOMElementExtensions.Af(this.jc,Ha)}rj(){}dk(){}dispose(){this.Gm||(f.KeyInputManager.instance.Ba(d.a.Sb,this.jc,this.HV),h.a.pc(this.aU),this.aU=Array(70),this.jb=null,super.dispose(),this.Gm=!0)}Jka(Ha){if(!this.get_visible())return!1;Ha=this.aU[Ha];return!!Ha&&Ha.isVisible}mfd(Ha){return this.Jka(Ha)?this.aU[Ha].KJ():null}JG(Ha){return!!this.aU[Ha]}XPb(Ha,Ya){if(Ha=this.aU[Ha])Ha.update(Ya),Ha.$Zj()}gE(Ha,
Ya,Gb=null,Ja=null){let Na=!1;if(this.JG(Ha))Gb=this.aU[Ha].get_visible();else{this.set_visible(!0);const Qa=qb.n9e()[Ha];this.aU[Ha]=this.M$(Ha,Ya,Gb,Ja);Gb=!1;Na=!0;Ja="";let Oa=0;Ya&&(Ja=Ya.MessageIdName,Oa=Ya.MessageId);const bb=Qa.hJa,Ga=fb.PageLoadTrackingInfo.instance.Cva(new Date);c.ULS.sendTraceTag(537170258,0,50,`BusinessBarControl.AddEntry of type: ${Ha}, time from app interactive: ${Ga}`);Ba.EwaSettings.isChangeGateEnabled("OfficeVSO:7232357_AvoidBsqmReportingForSuccessBizBars")&&4===
Qa.businessBarType||Ca.a(this.$).ZMd(Qa.hash,Ja,Oa,l.a.nDc,!0,1,Ya,bb)}Gb||!C.a.Sdc().includes(Ha)&&!Na||(this.aU[Ha].set_visible(!0),this.$.bI())}removeEntry(Ha){return this.dij(Ha)}eLd(){h.a.pc(this.aU);this.aU=Array(70);this.set_visible(!1)}dij(Ha){if(!this.JG(Ha))return!1;h.a.Ja(this.aU[Ha]);this.aU[Ha]=null;this.domElement.hasChildNodes()||this.set_visible(!1);this.$.bI();return!0}M$(Ha,Ya,Gb=null,Ja=null){const Na=qb.n9e()[Ha],Qa=!!(this.$.qd&64);switch(Ha){case 23:Ha=new Zb(this,Na,this.jb,
this.jc);break;case 2:case 4:case 25:case 26:case 36:case 35:Ha=new v.a(this,Na);break;case 12:case 29:case 30:case 31:case 32:case 57:Ha=Qa?new B(this,Na,-8805455):new v.a(this,Na);break;case 34:Ha=Qa?new mc(this,Na,-8805455,-104572626):new v.a(this,Na);break;case 22:Ha=new H(this,Na,-8805455);break;case 46:case 45:Ha=Qa?new S(this,Na,Ya,0,-8805455):new U(this,Na,Ya,0);break;case 11:case 43:case 7:case 0:case 1:case 3:case 33:Ha=new U(this,Na,Ya,0);break;case 19:Ha=new v.a(this,Na);break;case 47:Ha=
new U(this,Na,Ya,0);break;case 6:case 14:Ha=new V(this,Na,Ya.HelpTopicId);break;case 67:case 65:Ha=new P(this,Na,Ya.HelpTopicId);break;case 37:Ha=new P(this,Na,m.a.ljh);break;case 38:Ha=new v.a(this,Na);break;case 68:Ha=new H(this,Na,924877417);break;case 16:Ha=new v.a(this,Na);Ha.title=k.a.yg(this.$.workbookContext.FullDocumentInfo.IrmPolicyTitle);Ha.message=k.a.yg(this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription);break;case 18:Ha=new B(this,Na,-1762562205);Ha.hideCloseButton=!0;break;
case 20:Ha=new ua(this,Na);break;case 21:case 56:Ha=new v.a(this,Na);break;case 28:Ha=new v.a(this,Na);break;case 24:Ha=new Ta(this,Na);break;case 27:Ha=new ra(this,Na);break;case 39:Ha=new Da.a(this,Na);break;case 40:Ha=new y.a(this,Na);break;case 41:Ha=new O.a(this,Na);break;case 42:Ha=new ea.a(this,Na);break;case 48:Ha=new v.a(this,Na);break;case 49:Ha=new v.a(this,Na);break;case 50:Ha=new v.a(this,Na);break;case 51:Ha=new v.a(this,Na);break;case 52:Ha=new v.a(this,Na);break;case 53:Ha=new xa.a(this,
Na);break;case 54:Ha=new da.a(this,Na);break;case 55:Ha=new M(this,Na);break;case 5:Ha=new L(this,Na);break;case 58:Ha=new B(this,Na,-1753056834);Ya?(Ya=Ya.Directive,ca.a.Dq(Ya)||"&nbsp;"===Ya||(Ha.message=Ya)):Gb&&(Ha.message=Gb);break;case 59:Ha=new Z(this,Na);break;case 60:Ha=new v.a(this,Na);break;case 63:Ha=new P(this,Na,m.a.sMi);break;case 61:Ha=new Y(this,Na,m.a.AVg,-8805455);break;case 66:Ha=new Y(this,Na,m.a.wdj,1461300262);break;case 62:Ha=new qa(this,Na,515196233,13,3E5,"OptimizeWorkbookManager.ShowBusinessBarTeachingCallout");
Ha.message=Gb;break;case 64:Ha=new wa(this,Na,this.$,Ja);break;case 69:Ha=new Yb(this,Na,Ja);break;default:Ha=new U(this,Na,Ya,7)}Ha.x5c();return Ha}static n9e(){let Ha;Ha=ka.a.GMa()?260:259;return qb.Oye||(qb.Oye=[new D(0,275,276,277,0,0,qb.Bia,1,"BB_UnableToRefreshLock"),new D(1,275,276,277,0,0,qb.Bia,1,"BB_UnableToRefreshLockExpected"),new D(2,267,268,0,0,0,qb.Tz,5,"BB_WorkbookAlmostTooLarge"),new D(3,269,270,271,0,0,qb.Bia,1,"BB_WorkbookTooLarge"),new D(4,258,Ha,0,0,0,qb.Tz,5,"BB_ExternalWorkbookLinksDisabled"),
new D(5,262,261,263,0,0,qb.Bia,5,"BB_ExternalWorkbookLinksShowError","Warning_MessageBar_16"),new D(6,264,265,266,0,0,qb.ri,0,"BB_EditAndRefreshDisabledOnBIAHostedFiles"),new D(7,250,251,252,0,0,qb.ri,5,"BB_UnsupportedFeatures"),new D(8,0,0,0,0,0,qb.ri,0,"BB_CollabDataAndDataStringsLocaleMismatch"),new D(9,0,0,0,0,0,qb.ri,0,"BB_CollabDataStringsLocaleMismatch"),new D(10,0,0,0,0,0,qb.ri,0,"BB_CollabDataLocaleMismatch"),new D(11,278,279,280,0,0,qb.Bia,1,"BB_LastGenericStatusError"),new D(12,281,282,
283,0,0,qb.Tz,5,"BB_ScratchPadWarning"),new D(13,284,285,286,0,0,qb.Bia,1,"BB_AuthenticationLost"),new D(14,287,288,289,0,0,qb.Tz,5,"BB_OdfCompatibilityIssues"),new D(15,0,574,0,0,0,qb.Tz,5,"BB_PivotChartInteractivityMissingWarning"),new D(16,0,0,0,0,0,qb.ri,2,"BB_WorkbookIsIrmProtected"),new D(17,0,0,0,0,0,qb.ri,0,"BB_BIFeatureNotAvailable"),new D(18,290,291,286,0,0,qb.Tz,5,"BB_AnonymousCreateMode"),new D(19,253,254,0,0,0,qb.Tz,5,"BB_UnsupportedInteractiveReportEditing"),new D(20,0,0,0,0,0,qb.ri,
0,"BB_MobileAppCampaignBizBar"),new D(21,296,297,0,0,0,qb.ri,0,"BB_TransientServerCommunicationFailures"),new D(22,1642,1653,1654,0,0,qb.ri,5,"BB_EditAttemptInReadOnly"),new D(23,1642,1653,0,0,0,qb.ri,5,"BB_EditAttemptInReadOnlyNoEditPermissions"),new D(24,0,aa.HelperMethods.tZj(),1631,0,0,qb.ri,3,"BB_UnsupportedBrowser"),new D(25,299,300,0,0,0,qb.ri,2,"BB_ReadOnlyPermissions"),new D(26,301,302,0,0,0,qb.ri,2,"BB_DocumentIsIrmProtectedWarning"),new D(27,0,0,0,0,0,qb.Tz,5,"BB_PolicyWarningMessage"),
new D(28,1284,298,0,0,0,qb.ri,0,"BB_WorkingOnIt"),new D(29,1642,1640,1641,0,0,qb.ri,2,"BB_PasswordProtectedWorkbookLockedForEdit"),new D(30,1655,1656,1657,0,0,qb.ri,5,"BB_WorkbookIsReadOnlyRecommended"),new D(31,1642,1658,1659,0,0,qb.ri,5,"BB_WorkbookHasPasswordToModify"),new D(32,1642,1660,1663,0,0,qb.ri,3,"BB_LegacySharedWorkbookEditWarning"),new D(33,1650,1661,252,0,0,qb.ri,5,"BB_LegacyConnectionsWarning"),new D(34,1642,1959,1960,1961,0,qb.ri,0,"BB_TooManyLoadBlockingFloatingObjects"),new D(35,
1651,1652,0,0,0,qb.ri,2,"BB_GroupedSlicers"),new D(36,312,313,0,0,0,qb.Tz,5,"BB_ThirdPartyAddinDisabled"),new D(37,1788,1789,0,0,1790,qb.ri,5,"BB_FinanceLinkedEntityDisclaimerBar"),new D(38,1817,1818,0,0,0,qb.Tz,5,"BB_WolframDeprecationAlertBar"),new D(39,0,0,0,0,0,qb.ri,0,"BB_WacGdprNotice"),new D(40,0,0,0,0,0,qb.ri,0,"BB_AutomaticSensitivityLabel"),new D(41,0,0,0,0,0,qb.ri,0,"BB_RecommendedSensitivityLabel"),new D(42,0,0,0,0,0,qb.ri,0,"BB_MandatorySensitivityLabel"),new D(43,314,315,316,0,0,qb.ri,
0,"BB_LocalStorageDisabled"),new D(44,631,632,0,0,0,qb.ri,0,"BB_AutoRefreshDisabled"),new D(45,1013,1011,1015,1313,0,qb.ri,4,"BB_CorruptedFileRepaired"),new D(46,1014,1012,1015,1313,0,qb.ri,5,"CorruptedOdsFileRepaired"),new D(47,272,273,274,0,0,qb.Tz,5,"BB_MinorVersionLimitReached"),new D(48,303,304,0,0,0,qb.Tz,5,"BB_SensitivityApplicationGenericError"),new D(49,305,307,0,0,0,qb.Tz,5,"BB_SensitivityApplicationTooLargeFileError"),new D(50,306,307,0,0,0,qb.Tz,5,"BB_SensitivityApplicationLabelNotSupportedError"),
new D(51,308,309,0,0,0,qb.Tz,5,"BB_SensitivityApplicationLabelDisabledError"),new D(52,310,311,0,0,0,qb.Tz,5,"BB_SensitivityApplicationMandatoryConflictError"),new D(53,0,0,0,0,0,qb.Tz,5,"BB_SensitivityApplicationMinorVersionLimitReachedError"),new D(54,0,0,0,0,0,qb.Tz,5,"BB_SensitivityApplicationSetLabelError"),new D(55,2118,2119,2120,2123,0,qb.ri,5,"BB_ExternalWorkbookLinksPromptEnableContent","Warning_MessageBar_16"),new D(56,296,297,0,0,0,qb.ri,0,"BB_NetworkDown"),new D(57,317,318,319,0,0,qb.ri,
2,"BB_DefaultToViewDueToCogs"),new D(58,1814,1815,1816,0,0,qb.ri,1,"BB_RefreshLinkedEntityErrorBar"),new D(59,1791,1792,1793,1794,0,qb.ri,1,"BB_LinkedEntitiesUntrustedImagesDisabled"),new E(60,249,0,0,0,qb.ri,5,"BB_CanvasHealth"),new D(61,1016,1017,1313,0,1018,qb.ri,5,"BB_MismatchedFileFormatConverted"),new D(62,2237,0,2239,0,0,qb.ri,5,"BB_OptimizeWorkbook"),new D(63,320,321,0,0,322,qb.ri,0,"BB_NovModePostDepreciation"),new D(64,0,0,0,0,0,qb.ri,0,"BB_OfficeScriptsRunning"),new D(65,2213,2214,0,0,
2216,qb.ri,0,"BB_PowerQueryRefreshDataSourceNotSupported"),new D(66,323,324,0,0,325,qb.ri,5,"BB_ReadOnlyPivotTable"),new D(67,2213,2215,0,0,2216,qb.ri,0,"BB_PowerQueryRefreshHostNotSupported"),new D(68,1056,t.a.Sic?1058:1057,1055,0,0,qb.ri,4,"BB_RefreshPageAfterEnablingTheExtension"),new D(69,0,0,0,0,0,qb.ri,0,"BB_MsFormsDataSyncStatus")])}}qb.Bia=La.a.exh;qb.Tz=La.a.gxh;qb.ri=La.a.fxh;qb.Oye=null;Object(r.a)(qb,"BusinessBarControl",z.a,[54])},1176:function(r,F,a){var c=a(9);r=a(0);var b=a(709),e=
a(50),f=a(37),d=a(15),h=a(1092),l=a(152),k=a(24),t=a(68),n=a(59);class z{constructor(tb){this.options=null;this.options=tb}}Object(r.a)(z,"MacroRecorderRangeCustomSortedPayload",null,[162]);var w=a(975),m=a(976),u=a(41),y=a(376),v=a(193),C=a(284),x=a(140),B=a(29),H=a(249),I=a(1),U=a(189),S=a(22),G=a(282),D=a(21),E=a(814),N=a(763),M=a(266),L=a(214),aa=a(13),V=a(135);class P{constructor(tb){this.iu=wb=>{switch(wb){case 0:this.ZNa("Cancel");break;case 1:this.ZNa("Expand and sort");this.nWe(!0);break;
case 2:this.ZNa("Just sort"),this.nWe(!1)}};this.nWe=tb}show(){const tb=new V.StandardDialog;tb.Ob=11;tb.tc(1,aa.a.instance.ga(2125));tb.tc(2,aa.a.instance.ga(2126));tb.A$f(aa.a.instance.ga(2124),aa.a.instance.Ta(658),this.iu)}ZNa(tb){d.ULS.sendTraceTag(594125219,0,50,`ExpandSortSelectionDialog: user operation: ${tb}`)}}Object(r.a)(P,"ExpandSortSelectionDialog",null,[]);const ba=(tb,wb)=>{tb=tb.ColumnInfo;switch(wb){case 1:return tb.CellColors&&tb.CellColors.length?!0:(d.ULS.sendTraceTag(537151631,
0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on cell color result cell colors is null or there are no colors (must have at least 1)."),!1);case 2:return tb.TextColors&&tb.TextColors.length?!0:(d.ULS.sendTraceTag(537151630,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on font color result text colors is nullor there are no colors (must have at least 1)."),!1);case 3:return tb.Icons&&tb.Icons.length?!0:(d.ULS.sendTraceTag(537151629,0,10,
"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on icon result icons is nullor there are no icons (must have at least 1)."),!1);default:return d.ULS.sendTraceTag(537151628,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: illeagl sort condition type."),!1}},Y=(tb,wb,lb,db)=>{tb=tb.HeaderColumnInfo;return db||tb?2===wb&&lb?tb.CellColors&&1!==tb.CellColors.length?(d.ULS.sendTraceTag(537151626,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.CellColors should be null or have exactly 1 color."),
!1):tb.TextColors&&1!==tb.TextColors.length?(d.ULS.sendTraceTag(537151625,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.TextColors should be null or have exactly 1 color"),!1):tb.Icons&&1!==tb.Icons.length?(d.ULS.sendTraceTag(537151624,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.Icons should be null or have exactly 1 icon"),!1):!0:tb?(d.ULS.sendTraceTag(537151627,0,10,`SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo should be null when range type is not SheetRange, or when headerRowSize${lb} == 0.`),
!1):!0:!0};var Z=a(192);class ea{static isValid(tb){return ea.CEh.includes(tb.Position)?!0:(d.ULS.shipAssertTag(537159826,0,!1,`FillGradientStopExtension.IsValid: unexpected position value [${tb.Position}]`),!1)}}ea.CEh=[0,.5,1];Object(r.a)(ea,"FillGradientStopExtension",null,[]);class ra{constructor(tb,wb,lb,db){new Sys.UI.Point(tb,wb);new Sys.UI.Point(lb,db)}}Object(r.a)(ra,"GradientLine",null,[]);class O{static isValid(tb){if(!(tb.Degree.toString()in O.yEh))return d.ULS.shipAssertTag(537159829,
0,!1,`FillGradientExtension.IsValid: unexpected degree value [${tb.Degree}]`),!1;if(!tb.GradientStops)return d.ULS.shipAssertTag(537159828,0,!1,"FillGradientExtension.IsValid: no gradient stops"),!1;if(tb.GradientStops.length<O.IIi||tb.GradientStops.length>O.pHi)return d.ULS.shipAssertTag(537159827,0,!1,`FillGradientExtension.IsValid: unexpected number of gradient stops [${tb.GradientStops.length}]`),!1;for(const wb of tb.GradientStops)if(!ea.isValid(wb))return!1;return!0}}O.IIi=2;O.pHi=3;O.yEh={["0"]:new ra(0,
0,1,0),["180"]:new ra(1,0,0,0),["90"]:new ra(0,0,0,1),["270"]:new ra(0,1,0,0),["45"]:new ra(0,0,1,1),["225"]:new ra(1,1,0,0),["135"]:new ra(1,0,0,1),["315"]:new ra(0,1,1,0)};Object(r.a)(O,"FillGradientExtension",null,[]);const da=tb=>tb.SortRange?4===tb.SortRangeType?(d.ULS.sendTraceTag(537151622,0,10,`SharedSortInfoResultExtension.VerifySortRange: Unsupported sort range type: ${tb.SortRangeType}`),!1):2===tb.SortRangeType&&tb.SortTopToBottom&&(null==tb.HeaderRowSize||0>tb.HeaderRowSize)?(d.ULS.sendTraceTag(537151621,
0,10,"SharedSortInfoResultExtension.VerifySortRange: header row size must be equal or greater than 1, when range is sheetrange"),!1):!0:(d.ULS.sendTraceTag(537151623,0,10,"SharedSortInfoResultExtension.VerifySortRange: sort range is null"),!1),xa=tb=>{if(!tb.SortConditions)return!0;for(const wb of tb.SortConditions){if(!Ma(tb,wb.RowColOffset))return d.ULS.sendTraceTag(537151620,0,10,`SharedSortInfoResultExtension.VerifySortConditions: offset [${wb.RowColOffset}] is out of bounds. sort range: ${tb.SortRange}`),
!1;if(1===wb.SortConditionType&&wb.FillGradient&&!O.isValid(wb.FillGradient))return d.ULS.sendTraceTag(537151619,0,10,"SharedSortInfoResultExtension.VerifySortConditions: sortCondition contains invalid fillGradient"),!1}return!0},ia=tb=>{if(!tb.SortColumnInfoItems)return d.ULS.sendTraceTag(537151618,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: SortColumnInfoItems is null"),!1;var wb=new Z.a;for(var lb of tb.SortColumnInfoItems){if(!Ma(tb,lb.ColumnOffset))return d.ULS.sendTraceTag(537151617,
0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: offset [${lb.ColumnOffset}] is out of bounds. sort range: ${tb.SortRange}`),!1;if(!lb.Name)return d.ULS.sendTraceTag(537151616,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: invalid column name for offset [${lb.ColumnOffset}]`),!1;if(lb.CellColors&&!lb.CellColors.length)return d.ULS.sendTraceTag(537151587,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: cell colors are not null but length = [${lb.CellColors.length}]`),!1;if(lb.TextColors&&
!lb.TextColors.length)return d.ULS.sendTraceTag(537151586,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: text colors are not null but length = [${lb.TextColors.length}]`),!1;if(lb.Icons&&!lb.Icons.length)return d.ULS.sendTraceTag(537151585,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: icons are not null but length = [${lb.Icons.length}]`),!1;wb.add(lb.ColumnOffset)}if(tb.SortConditions)for(const db of tb.SortConditions)if(!wb.contains(db.RowColOffset))return d.ULS.shipAssertTag(537151584,
0,!1,`SharedSortInfoResultExtension.VerifyColumnInfo: missing column info item for sort condition [${db.RowColOffset}]`),!1;if(tb.HeaderColumnInfoItems){if(tb.HeaderColumnInfoItems.length!==tb.SortColumnInfoItems.length)return d.ULS.shipAssertTag(537151583,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo length doesn't match sort column info length"),!1;for(wb=0;wb<tb.HeaderColumnInfoItems.length;++wb){lb=tb.HeaderColumnInfoItems[wb];if(lb.ColumnOffset!==tb.SortColumnInfoItems[wb].ColumnOffset)return d.ULS.shipAssertTag(537151582,
0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo item offset doesn't match sort columnInfo item offset."),!1;if(lb.CellColors&&1<lb.CellColors.length)return d.ULS.sendTraceTag(537151581,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.CellColors is not null and has more than 1 background color"),!1;if(lb.TextColors&&1<lb.TextColors.length)return d.ULS.sendTraceTag(537151580,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.TextColors is not null and has more than 1 font color"),
!1;if(lb.Icons&&1<lb.Icons.length)return d.ULS.sendTraceTag(537151579,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.Icons is not null and has more than 1 icon"),!1}}return!0},Ma=(tb,wb)=>{const lb=tb.SortRange;tb=tb.SortTopToBottom?lb.LastColumn-lb.FirstColumn:lb.LastRow-lb.FirstRow;return 0<=wb&&wb<=tb};var Ta=a(386),Da=a(127),fa=a(90),ua=a(128);class Fa extends Ta.a{constructor(tb,wb){super(tb,wb);this.DEb=this.Ged();this.Ar()}get kc(){return"SortMergedCellsErrorDialog"}kO(tb,
wb){if(1===tb){var lb=u.v(this.DEb,this.$);D.h(this.$).qg(lb,null,null,null,0,"SortErrorDialog.MergeCellRangeSelected")}lb={["DialogButton"]:tb,["Location"]:"dialog"};ua.b(this.$).rd(Da.a.yMj,lb,null,!0);super.kO(tb,wb)}Ar(){super.Ar();const tb=this.vMj();this.Ob=1;this.tc(1,aa.a.instance.ga(2244));this.Wl(aa.a.instance.ga(2245),fa.a.kf(tb),1,this.s7)}vMj(){return String.format(aa.a.instance.ob(174),this.DEb.toString())}Ged(){const tb=this.error.Description.split("_");return new k.Range(Number.parseInvariant(tb[1])+
1,Number.parseInvariant(tb[2])+1,Number.parseInvariant(tb[3])+1,Number.parseInvariant(tb[4])+1,!0,!1)}}Object(r.a)(Fa,"SortMergedCellsErrorDialog",Ta.a,[]);var ca=a(73),ka=a(577),Ca=a(614);class fb extends E.a{constructor(tb,wb,lb,db){super(tb);this.Fhc=this.cUd=!1;this.t6=[];this.Pki=(Pa,ja)=>{const Ka=this.Hdh(Pa);this.YLa(214,(ub,Kb,W)=>C.p(this.$.oa.xa,Ka,this.h0a(ub,this.fMh(ja)),this.MT(Kb),W,null),16,!0)};this.Oki=(Pa,ja,Ka)=>{Pa=C.o(this.$.oa.xa,ja,this.RMh(ja,Ka),this.yUi,null,Pa);this.t6.push(Pa)};
this.yUi=()=>{d.ULS.sendTraceTag(529105632,0,10,"CustomSortDialog.OnGetSortConditionColorsOrIconsRequestFailure: GetSortConditionColorsOrIcons request failed.");this.e8b(fb.Bsb())};this.z8c=(Pa,ja)=>{if(1===Pa){Pa=ja.sortRangeType;const Ka={};Ka.SortOptions=ja.sortOptions;Ka.ShouldRestoreSelection=this.cUd;Ka.SelectedRange=this.selectedRange;Ka.OriginalActiveCell=this.Yqc;Ka.TopCellAddress=this.PTa;Ka.ShouldPromptNamedSheetViewTeachingDialog=0===Pa||3===Pa;fb.Bbj(this.$,Ka)}else this.cUd&&this.Qoa(this.selectedRange,
this.Yqc)};this.ldi=(Pa,ja)=>{this.cUd=!0;this.Qoa(Pa,ja)};this.getColorName=Pa=>N.a.HKa(L.a.aH(Pa));d.ULS.shipAssertTag(529105669,0,!!wb.ActiveCell);d.ULS.shipAssertTag(529105668,0,!!wb.SelectedRange);d.ULS.shipAssertTag(529105667,0,u.D(wb.SelectedRange).contains(u.C(wb.ActiveCell)));d.ULS.shipAssertTag(529105666,0,S.a.equals(wb.SelectedRange.SheetName,wb.ActiveCell.SheetName,!0));this.gdb=new Ca.a(tb,ka.a.Tih,()=>this.Fhc,1);this.selectedRange=wb.SelectedRange;this.Yqc=wb.ActiveCell;this.$0g=wb.ExpandSelection;
this.namedSheetViewPublic=lb;this.PTa=db;this.initializeAndShow(aa.a.instance.ga(180),this.z8c,this.lta(wb))}dispose(){this.Fhc||(this.Fhc=!0,this.c3b(),this.t6=null,this.gdb.dispose(),this.gdb=null);super.dispose()}get kc(){return"CustomSortDialog"}get ha(){return D.h(this.$).ha}fMh(tb){return wb=>{H.b(wb,-901005882)?(ca.a(this.$).gd.RL(-901005882),this.BId()):H.b(wb,-569193796)?(ca.a(this.$).gd.RL(-569193796),this.hide(),new Fa(this.$,wb.Errors[0])):H.a(wb)?(d.ULS.sendTraceTag(529105665,0,10,"CustomSortDialog.GenerateGetSortInfoSuccessCallback: GetSortInfo result contains non-status messages"),
this.hide()):(wb=wb.Result,this.$.ak(wb.SortRange),wb&&da(wb)&&xa(wb)&&ia(wb)?tb(wb):this.e8b(fb.Bsb()))}}RMh(tb,wb){return(lb,db)=>{if(this.Fhc)d.ULS.sendTraceTag(529105635,0,50,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: response was received after dialog is disposed");else if(!lb||H.a(lb))d.ULS.sendTraceTag(529105634,0,10,`CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: Unexpected error: ${B.a.nc(lb.Errors)}`),this.$.ea.Tn(lb.Errors),this.hide();
else{lb=lb.Result;var Pa=tb.RangeType,ja=tb.HeaderRowSize,Ka=tb.SortTopToBottom;lb&&ba(lb,tb.ConditionType)&&Y(lb,Pa,ja,Ka)?(lb.ColumnInfo.ColumnOffset=db,void 0!==lb.HeaderColumnInfo&&null!==lb.HeaderColumnInfo&&(lb.HeaderColumnInfo.ColumnOffset=db),wb(lb,tb.ConditionType,tb.SortTopToBottom)):(d.ULS.sendTraceTag(529105633,0,10,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: sortConditionColorsOrIconsResult is not valid"),this.e8b(fb.Bsb()))}}}Hdh(tb){const wb={};wb.SelectedRange=
this.selectedRange;wb.ActiveCell=this.Yqc;wb.SortInfoMode=tb;wb.ExpandSortSelection=this.$0g;wb.ExpandSortSelectionSupported=!0;return wb}lta(tb){const wb={};wb[M.a.it]=this.kc;wb.fromAutoFilter=tb.FromAutoFilter;wb.gridRTL=D.h(this.$).rtl;wb.activeCell=tb.ActiveCell;wb.selectedRange=tb.SelectedRange;wb.invokeGetSortInfo=this.Pki;wb.invokeGetSortConditionColorsOrIcons=this.Oki;wb.highlightSortRange=this.ldi;wb.getColorName=this.getColorName;return wb}Qoa(tb,wb){tb=u.D(tb);this.ha.qa.ld.equals(tb)||
this.ha.updateSelection(tb,u.C(wb),0,void 0,void 0,void 0,!0)}BId(){(new P(tb=>{const wb={};wb.ActiveCell=this.Yqc;wb.SelectedRange=this.selectedRange;wb.ExpandSelection=tb;wb.FromAutoFilter=!1;this.$.Yc(-207540907,t.a.zb,8,{["SortCommandData"]:wb})})).show()}c3b(){if(void 0!==this.t6&&null!==this.t6)for(const tb of this.t6)this.$.oa.xa.Zfb(tb.Rs)}static Bbj(tb,wb){tb.Yc(1659552324,t.a.zb,8,{["CustomSortCommandData"]:wb})}static Bsb(){return B.a.ed(1,0,26,0,1,-1517197771,"CustomSortValidationError")}}
Object(r.a)(fb,"CustomSortDialog",E.a,[]);var yb=a(1093);class mb{constructor(tb){this.selection=null;this.selection=tb}getSelection(){return this.selection}}Object(r.a)(mb,"MacroRecorderRangeAutoFilterClearedPayload",null,[162]);class nb{constructor(tb){this.filterRange=null;this.filterRange=tb}}Object(r.a)(nb,"MacroRecorderRangeFilterReappliedPayload",null,[162]);var X=a(60);const R=(tb,wb,lb,db,Pa,ja,Ka=null)=>{Ka=tb.Na(41,Ka);Ka.options=wb;return X.g(tb,"Sort",Ka,lb,db,Pa,ja,0)},wa=(tb,wb,lb,
db,Pa,ja,Ka=null)=>{Ka=tb.Na(41,Ka);Ka.selectedRange=wb;return X.g(tb,"ClearAutoFilter",Ka,lb,db,Pa,ja,0)},na=(tb,wb,lb,db,Pa,ja,Ka=null)=>{Ka=tb.Na(41,Ka);Ka.filterRange=wb;return X.g(tb,"ReapplyAutoFilter",Ka,lb,db,Pa,ja,0)};var Ba=a(782),Ra=a(783),qa=a(115),La=a(55),Yb=a(1094),mc=a(205),Zb=a(33),qb=a(345),Ha=a(65),Ya=a(4);class Gb{constructor(tb,wb){this.sortOptions=this.VSa=this.selectedRange=null;this.Ahf=!1;this.activeCell=this.ze=this.ub=this.fc=null;this.onContentReady=()=>{this.WTf(!1);const lb=
this.ha();lb.qa.Tg&&lb.qa.ld.equals(this.VSa)&&(I.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")?lb.updateSelection(this.selectedRange,u.C(this.activeCell),0,void 0,void 0,void 0,!0):lb.updateSelection(this.selectedRange,lb.qa.activeCell,0,void 0,void 0,void 0,!0))};this.iUi=(lb,db)=>{lb&&!B.a.Wf(lb.Errors)&&this.fc&&(this.fc.Qo=lb.Result,this.iMb(),this.applyPivotSort(db))};this.hUi=()=>{};this.H0i=(lb,db)=>{var Pa,ja;I.EwaSettings.isChangeGateEnabled("OfficeVSO:7480949_SVLogFlightUsage")?
((null===db||void 0===db?0:db.qfg)||(null===(Pa=this.$.na)||void 0===Pa?0:Pa.hasAutoFilter))&&db.selection&&(Ya.AFrameworkApplication.Tp("XLS-IntelligentMetadataTableProactiveSuggestions-Treatment;XLS-IntelligentMetadataTableProactiveSuggestions-Control"),Zb.a.mrd()&&(lb=Ha.d(this.$.va.na),this.rfg(new qb.a(u.D(db.selection),lb)))):((null===db||void 0===db?0:db.qfg)||(null===(ja=this.$.na)||void 0===ja?0:ja.hasAutoFilter))&&db.selection&&Zb.a.mrd()&&(lb=Ha.d(this.$.va.na),this.rfg(new qb.a(u.D(db.selection),
lb)))};this.$=tb;this.Fpf="";this.namedSheetViewPublic=wb;this.gridView=D.h(this.$);this.$.Jb.zg("LoadResource","LoadDialogControlsStopwatch")}K0(tb){if(I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1)){var wb=this.$.da.Aa(465);wb&&wb.K0(5,tb)}}Hc(tb,wb){return!this.Gsd(tb,wb)}executeCommand(tb,wb,lb){let db=null;tb=wb.command;switch(tb){case -864298118:db=this.Hoh(wb,lb);break;case -1010737776:db=this.d9c(!0,wb,lb);break;case 2123420468:db=
this.d9c(!1,wb,lb);break;case -1089513346:lb=this.d2e(lb);if(!this.dCb([u.D(lb.SortOptions.SelectedRange)]))return f.TaskExtensions.Tj();db=this.hNe(wb,lb);break;case -1032691499:case -764711886:case -2016161444:db=this.H$i(wb,lb);break;case -207540907:case -1677817820:db=this.gridView.tb.b5(this.ha().qa.activeCell)?this.u$i():this.r$i(wb,lb);break;case 1659552324:db=this.hNe(wb,this.d2e(lb));break;case 368460465:db=this.Yoh(wb,lb);break;case 529856798:db=this.Coh(wb);break;case 644342024:db=this.Toh(wb)}return db||
U.a(tb)}wc(tb,wb){if(tb=1===tb)switch(wb.command){case -864298118:case -1010737776:case 2123420468:case -1089513346:case -207540907:case -1677817820:case 1659552324:case 368460465:case 529856798:case 644342024:case -1032691499:case -764711886:case -2016161444:break;default:tb=!1}return tb}Nc(){return!1}ha(){return this.$&&this.gridView?this.gridView.ha:null}WTf(tb){tb?this.gridView.Uu(this.onContentReady):this.gridView.my(this.onContentReady);this.Ahf=tb}get qa(){return this.ha().qa}zHj(tb){return!!this.sortOptions&&
S.a.equals(this.Fpf,tb.fia,!0)}Gsd(tb,wb){const lb=D.h(this.$).ha.qa.selectedRanges;return(new x.a(this.$.va)).um(tb,wb,lb,this.gridView)}d9c(tb,wb,lb){const db=new h.a;this.Lef(db,lb,tb);return this.dCb([u.D(db.SelectedRange)])?this.gridView.tb.b5(u.D(db.SelectedRange))?this.Qoh(tb):this.Uod(db,wb):f.TaskExtensions.Tj()}Hoh(tb,wb){d.ULS.shipAssertTag(520901652,0,!1,"SortCommandHandler.doDefaultSort: using default sort");let lb=null;const db=this.ha();db&&(this.zHj(db)?this.dCb(db.qa.selectedRanges)&&
(this.sortOptions.IsAscending=!this.sortOptions.IsAscending,lb=this.Uod(this.sortOptions,tb)):lb=this.d9c(!0,tb,wb));return lb}dCb(tb){return this.$.isEditMode?this.$.Us(tb,!0,1):this.$.lZc(tb,!0,1)}Qoh(tb){this.X_h(tb);return La.Task.Sa(!0)}KYg(tb){if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:4112173_MacroRecorderTableSortOnRange")){const wb=this.gridView.tb.Dh(this.qa.ld,!1);if(wb)return new m.a(wb.name,this.qa.activeCell.left-wb.usedRange.left,tb.IsAscending)}return new w.a(tb)}Uod(tb,wb){this.gridView.Gg.iM(!1);
const lb=()=>this.KYg(tb);return this.r$c((db,Pa,ja)=>R(this.$.oa.xa,tb,G.b(db,this.SMh(wb)),Pa,ja,tb),db=>new v.a(141,0,db,void 0,lb),wb,this.nGj(tb))}nGj(tb){if(!this.namedSheetViewPublic)return!1;const wb=this.qa.ld,lb=u.v(this.qa.ld,this.$),db=this.gridView.tb.$M(wb,!0),Pa=this.qa.Hba()&&this.gridView.tb.tlf(lb),ja=this.gridView.tb.Nsi(lb);tb=(wb.i5||wb.XZ)&&!wb.isSingle&&(null==tb.ExpandSortSelection?!1:tb.ExpandSortSelection)&&this.gridView.tb.tlf(lb);return db||Pa||ja||tb}u$i(){return this.$.Yc(-1556797033,
t.a.zb,8,null)}r$i(tb,wb){tb=8===tb.Ve&&wb&&void 0!==wb[Gb.Reb]&&null!==wb[Gb.Reb]?wb[Gb.Reb]:19===tb.Ve&&wb&&void 0!==wb[t.a.Pf]&&null!==wb[t.a.Pf]?n.a.Xh(wb[t.a.Pf]):this.Lch();if(!this.dCb([u.D(tb.SelectedRange)]))return f.TaskExtensions.Tj();D.h(this.$).Gg.iM(!1);let lb=null;(wb=wb.TopCellAddress)&&(lb=u.o(wb,this.$));new fb(this.$,tb,this.namedSheetViewPublic,lb);return La.Task.Sa(!0)}d2e(tb){return tb[Gb.Sih]}hNe(tb,wb){const lb=ja=>{this.fbf(ja)?this.R$e(ja.Errors[0]):(wb.ShouldRestoreSelection&&
this.Qoa(wb.SelectedRange,wb.OriginalActiveCell),d.ULS.sendTraceTag(537151576,0,50,`SortCommandHandler.DoCustomSort.onSortSuccessCallback: Custom Sort succeeded. Called from: ${tb.Ve}`),this.GVj(wb),this.K0(ja))},db=()=>{wb.ShouldRestoreSelection&&this.Qoa(wb.SelectedRange,wb.OriginalActiveCell);d.ULS.sendTraceTag(537151575,0,10,`SortCommandHandler.DoCustomSort.onSortFailedCallback: Custom Sort failed. Called from: ${tb.Ve}`)},Pa=()=>new z(wb.SortOptions);return this.r$c((ja,Ka,ub)=>R(this.$.oa.xa,
wb.SortOptions,G.b(ja,lb),G.a(Ka,db),ub,this.sortOptions),ja=>new v.a(187,0,ja,void 0,Pa),null,wb.ShouldPromptNamedSheetViewTeachingDialog)}Qoa(tb,wb){tb=u.D(tb);D.h(this.$).ha.qa.ld.equals(tb)||D.h(this.$).ha.updateSelection(tb,u.C(wb),0,void 0,void 0,void 0,!0)}Lch(){const tb={};tb.ActiveCell=u.o(this.qa.activeCell,this.$);tb.SelectedRange=u.v(this.qa.ld,this.$);tb.FromAutoFilter=!1;tb.ExpandSelection=null;return tb}Yoh(tb,wb){const lb=this.Oaa();if(!lb)return La.Task.Sa(!1);const db=this.$.oa.xa.Wb(),
Pa=()=>new yb.a(lb);return y.a(this.$.userOperationManager,(ja,Ka,ub)=>C.B(this.$.oa.xa,lb,G.b(Ba.a.X4a(qa.a.Rpb,Ra.a.toggleAutoFilter,ja),this.H0i),Ka,ub,{selection:lb,qfg:wb.On},db),ja=>new v.a(516,0,ja,64,Pa),tb)}Coh(tb){const wb=this.Oaa();if(!wb)return La.Task.Sa(!1);const lb=this.gridView.tb.Dh(this.qa.ld,!0);lb&&d.ULS.sendTraceTag(537151574,0,50,`DoClearAutoFilter for namedObject: Type : ${lb.type.toString()}`);const db=this.$.oa.xa.Wb(),Pa=()=>new mb(wb);return this.r$c((ja,Ka,ub)=>wa(this.$.oa.xa,
wb,Ba.a.X4a(qa.a.JGa,Ra.a.clearAutoFilter,ja),Ka,ub,null,db),ja=>new v.a(517,0,ja,64,Pa),tb)}r$c(tb,wb,lb,db=!0){return this.namedSheetViewPublic&&db?this.namedSheetViewPublic.DSa().continueWith(Pa=>{Pa.result&&y.a(this.$.userOperationManager,tb,wb,lb)}):y.a(this.$.userOperationManager,tb,wb,lb)}Toh(tb){const wb=this.Oaa();if(!wb)return La.Task.Sa(!1);const lb=this.$.oa.xa.Wb(),db=()=>new nb(wb);return y.a(this.$.userOperationManager,(Pa,ja,Ka)=>na(this.$.oa.xa,wb,Ba.a.X4a(qa.a.JGa,Ra.a.vcj,Pa),ja,
Ka,null,lb),Pa=>new v.a(518,0,Pa,64,db),tb)}SMh(tb){return(wb,lb)=>{var db;H.b(wb,-901005882)?(ca.a(this.$).gd.RL(-901005882),this.BId(lb,tb.command)):this.fbf(wb)?this.R$e(wb.Errors[0]):!H.a(wb)&&wb.Result&&(this.sortOptions=lb,this.VSa=u.D(wb.Result.ActualSortRange),this.Fpf=this.ha().fia,this.Ahf||(this.selectedRange=this.qa.ld,this.selectedRange.equals(this.VSa)||(I.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")&&(this.activeCell=u.o(this.qa.activeCell,
this.$)),this.BKj())),(null===(db=this.sortOptions)||void 0===db?0:db.ActiveCell)&&this.i9f(this.sortOptions)&&(lb=this.sortOptions.ActiveCell,lb=new k.Range(lb.FirstRow+1,lb.FirstColumn+1,lb.FirstRow+1,lb.FirstColumn+1,!0,!1),this.gS(lb),this.LZd(lb)),this.K0(wb))}}fbf(tb){return H.b(tb,-569193796)}R$e(tb){ca.a(this.$).gd.RL(-569193796);new Fa(this.$,tb)}BId(tb,wb){(new P(lb=>{const db={};db.ActiveCell=tb.ActiveCell;db.SelectedRange=tb.SelectedRange;db.ExpandSelection=lb;this.$.Yc(wb,t.a.zb,8,{[Gb.Reb]:db})})).show()}BKj(){const tb=
this.ha();if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")){let wb=u.C(this.activeCell);this.VSa.we(wb)||(wb=this.VSa.topLeft);tb.updateSelection(this.VSa,wb,0,void 0,void 0,void 0,!0)}else tb.updateSelection(this.VSa,tb.qa.activeCell,0,void 0,void 0,void 0,!0);this.WTf(!0)}Oaa(){const tb=this.ha();if(!tb)return d.ULS.shipAssertTag(537151573,0,!!tb,"SelectionManger is null"),null;this.gridView.Gg.iM(!1);return u.v(tb.qa.ld,this.$)}iMb(){this.fc&&
this.fc.Qo&&(this.ze=this.fc.Qo,this.ub=this.fc.ccc())}X_h(tb){if(this.$.isEditMode&&(this.fc=this.gridView.tb.Yo(this.qa.activeCell))){this.activeCell=u.o(this.qa.activeCell,this.$);if(this.fc&&this.fc.Qo){var wb=this.fc.Qo.CurrentCol;if(this.fc.Qo.CurrentRow===this.activeCell.FirstRow&&wb===this.activeCell.FirstColumn){this.iMb();this.applyPivotSort(tb);return}}this.$.oa.xa.Wb();wb=new v.a(228,0,(lb,db,Pa)=>C.l(this.$.oa.xa,this.activeCell,G.b(lb,this.iUi),G.a(db,this.hUi),Pa,tb),16);this.$.userOperationManager.Jc(wb,
null)}}applyPivotSort(tb){if(this.fc&&this.ub&&this.activeCell&&this.ze){var wb=8===this.ze.CellArea,lb=1===this.ze.CellArea||2===this.ze.CellArea;(wb||lb)&&8!==this.ze.CellType&&4!==this.ze.CellType&&(wb?y.a(this.$.userOperationManager,(db,Pa,ja)=>C.b(this.$.oa.xa,this.activeCell,tb?1:2,this.ub.Caption,db,Pa,ja,null),db=>new v.a(1015,0,db,void 0,null),null):(wb=1===this.ze.CellArea?1:2,this.$.ra(600)?l.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.fc.externalSourceIndex,
this.ub.Index.toString(),this.ub.Caption,this.fc.isOlap?"":this.ub.Caption,wb,tb):l.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.fc.externalSourceIndex,this.ub.Index.toString(),tb)))}}GVj(tb){this.i9f(tb.SortOptions)&&(tb.TopCellAddress?tb=u.C(tb.TopCellAddress):(tb=tb.OriginalActiveCell,tb=new k.Range(tb.FirstRow+1,tb.FirstColumn+1,tb.FirstRow+1,tb.FirstColumn+1,!0,!1)),this.gS(tb))}gS(tb){Zb.a.Yka(this.$)&&f.TaskExtensions.za(e.GetServiceTaskFactory.Oa(this.$.da,
430,431,1),wb=>{wb.result.vea(tb);d.ULS.sendTraceTag(537151571,306,50,"SortCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.la,3)}LZd(tb){I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",!1)&&f.TaskExtensions.za(e.GetServiceTaskFactory.Oa(this.$.da,476,475,0),wb=>{wb.result.LZd(tb,0);d.ULS.sendTraceTag(537151570,0,50,"SortCommandHandler:TriggerProactiveSuggestion Trigger proactive suggestion from sort.")},this.$.la,
3)}H$i(tb,wb){if(!this.dCb(this.qa.selectedRanges))return f.TaskExtensions.Tj();const lb=new h.a;this.Lef(lb,wb);lb.SortConditions=[this.$fh(tb)];lb.OperationType=2;return this.Uod(lb,tb)}$fh(tb){const wb=this.gridView.Pb(this.qa.activeCell);let lb=new Yb.a;lb.IsAscending=!0;switch(tb.command){case -1032691499:wb.zyb?(tb=mc.a.Wo(wb.backgroundColor),lb.SortColor=tb.dS(!0)):lb.SortColor=Gb.NoColor;lb.SortConditionType=1;break;case -764711886:lb.SortColor=wb.s3c===Gb.NoColor?Gb.NoColor:mc.a.ixe(wb.s3c);
lb.SortConditionType=2;break;case -2016161444:wb.Fyb?(lb.SortIcon=wb.cell.Gkc,lb.SortIconSet=wb.Hkc):(lb.SortIcon=Gb.C3d,lb.SortIconSet=Gb.C3d);lb.SortConditionType=3;break;default:d.ULS.debugAssertTag(522723787,0,!1,"SortCommandHandler.createSortConditionsFromSelectedCell: ribbon command didn't match any of the case statements")}return lb}rfg(tb){f.TaskExtensions.za(e.GetServiceTaskFactory.Oa(this.$.da,426,427,1),wb=>{void wb.result.VCc(tb,"Filter")},this.$.la,3)}Lef(tb,wb,lb=!0){tb.OperationType=
0;tb.IsAscending=lb;tb.HasHeader=!0;tb.GuessHeader=!0;tb.SortTopToBottom=!0;tb.ExpandSortSelectionSupported=!0;wb&&wb[Gb.Reb]?(wb=wb[Gb.Reb],tb.ActiveCell=wb.ActiveCell,tb.SelectedRange=wb.SelectedRange,tb.ExpandSortSelection=wb.ExpandSelection):(tb.ActiveCell=u.o(this.qa.activeCell,this.$),tb.SelectedRange=u.v(this.qa.ld,this.$),tb.ExpandSortSelection=null)}i9f(tb){return!tb.SortConditions||tb.SortConditions.some(wb=>0===wb.SortConditionType)}}Gb.Sih="CustomSortCommandData";Gb.Reb="SortCommandData";
Gb.C3d=-1;Gb.NoColor=0;Object(r.a)(Gb,"SortCommandHandler",null,[222]);class Ja extends b.a{constructor(tb){super(tb)}hd(){f.TaskExtensions.za(e.GetServiceTaskFactory.Oa(this.$.da,309,310,this.Xa),tb=>{this.$c([new Gb(this.$,tb.result)])},this.$.la,3)}static ka(tb){b.a.Md(160,new Ja(tb))}}Object(r.a)(Ja,"SortCommandHandlerFactory",b.a,[]);E=a(226);Ta=a(161);var Na=a(187),Qa=a(105);let Oa=class{constructor(tb){I.EwaSettings.isChangeGateEnabled("OfficeVSO:7477297_MoveSortUtilToNewServices")||tb.da.Ha(446,
this)}gJe(tb,wb){new Fa(tb,wb)}};Oa=Object(Ta.b)([Object(Na.d)(Qa.n),Object(Ta.c)(0,Object(Qa.f)())],Oa);Object(r.a)(Oa,"SortUtil",null,[461]);class bb extends E.a{constructor(tb){super();this.$=tb;this.Db()}create(){let tb=this.$.da.Aa(446);tb||(tb=new Oa(this.$),this.$.da.Ha(446,tb));this.nb(tb)}static ka(tb){tb.da.Ha(447,new bb(tb))}}Object(r.a)(bb,"SortUtilFactory",E.a,[]);a.d(F,"a",function(){return Ga});const Ga=()=>{c.a.Fa(tb=>{Ja.ka(tb);I.EwaSettings.isChangeGateEnabled("OfficeVSO:7477297_MoveSortUtilToNewServices")||
bb.ka(tb)})}},1180:function(r,F,a){r=a(0);var c=a(552),b=a(15),e=a(135),f=a(54);class d extends e.StandardDialog{constructor(){super();this.Ob=0;this.tc(1,CommonUIStrings.l_DialogClose)}displayError(R,wa){this.NMe(R,wa,f.a.psj)}NMe(R,wa,na){b.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",na);this.Nz(na,R,wa,null)}T8c(R,wa){b.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.Nz(f.a.rsj,R,wa,null,!0)}}Object(r.a)(d,"ErrorDialog",
e.StandardDialog,[548]);var h=a(85);e=a(1071);var l=a(150);class k{static get og(){return l.a.zq(k.Ll,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}k.Ll="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(r.a)(k,"FileNameDialogHtml",null,[]);var t=a(4),n=a(14),z=a(46),w=a(86),m=a(88),u=a(30);class y extends e.a{constructor(R,wa,na,Ba,Ra,qa,La,Yb){super(R,wa,na,Ba,Ra,qa,Yb);this.pqa=this.ISc=this.Ky=null;this.t_g=CommonUIStrings.l_SaveToAnotherFolder;this.og=k.og;this.pe="FileNameDialog-SaveToSharePoint";this.omb=La;this.sBg=Yb}UP(R){const wa=u.a.Lp(t.AFrameworkApplication.om.fn),na=t.AFrameworkApplication.breadcrumbFolderName,Ba=t.AFrameworkApplication.breadcrumbBrandName,Ra={["txtFileName"]:R||
wa};let qa=CommonUIStrings.L_SaveAs;2===t.AFrameworkApplication.sa.Qa.Oj&&(qa=CommonUIStrings.L_SaveACopy);this.initializeAndShow(qa,Object(h.a)(this,this.T$b,"fileNameDialogHandler"),Ra);this.vMe(R,wa);this.IIa.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");t.AFrameworkApplication.fa.pa("HideSaveToAnotherFolderButtonforUIHost")||(this.Ky=document.getElementById("anotherFolder"),R=document.getElementById("folderLocation"),this.ISc=
m.a.aue(R,this.Ky,"anotherFolderDescribedBy"),this.Ky.className="WACButton WACDialogButtonNormal",R=!1,na&&na.length?(this.soe(this.Ky,this.ISc,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Ba,na)),R=this.qIg(Ba,na)):this.soe(this.Ky,this.ISc,CommonUIStrings.l_CurrentOnlineFolder),this.pJg(this.Ky),this.sIg(this.Ky),R?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.Ky,"SaveToAnotherLocationTwo"),b.ULS.sendTraceTag(24459297,216,50,
"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.Ky,"SaveToAnotherLocationOne"),z.a.addHandler(this.Ky,n.a.click,Object(h.a)(this,this.rEd,"onSaveToAnotherLocationClick")),z.a.addHandler(this.Ky,n.a.Sb,Object(h.a)(this,this.LHf,"onSaveToAnotherLocationKeyDown")))}qIg(R,wa){let na;na=!1;const Ba=document.getElementById("currentLocation");Ba.innerText="";const Ra=this.V4e(Ba,R),qa=this.V4e(Ba,wa);let La=255,Yb=255;255<Ra+qa&&(La=Math.max(238,408-Ra),Yb=Math.max(170,
408-qa),na=!0);this.LKg(Ba,R,Yb,wa,La);return na}V4e(R,wa){const na=document.createElement("div");na.innerText=wa;na.style.visibility="hidden";R.appendChild(na);wa=na.clientWidth;R.removeChild(na);return wa}LKg(R,wa,na,Ba,Ra){wa&&(this.qoe(R,wa,na),this.CKg(R));Ba&&this.qoe(R,Ba,Ra)}qoe(R,wa,na){const Ba=document.createElement("div");Ba.innerText=wa;Ba.title=wa;Ba.className="SaveToAnotherFolderBreadcrumb";Ba.style.maxWidth=na.toString()+"px";R.appendChild(Ba)}CKg(R){const wa=document.createElement("span");
wa.id="FolderSeparator";const na=document.createElementNS("http://www.w3.org/2000/svg","svg");na.setAttribute("class","SeparatorCaret");const Ba=document.createElementNS("http://www.w3.org/2000/svg","polygon");Ba.setAttribute("points","1 4 1 11 5 7.5");na.appendChild(Ba);wa.appendChild(na);R.appendChild(wa)}soe(R,wa,na){na=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,na);wa&&(wa.innerText=na);R.tabIndex=0;R.setAttribute(m.a.Cd,m.a.Qs)}sIg(R){const wa=document.createElement("span");
wa.id="anotherFolderText";wa.innerText=this.t_g;wa.className="AnotherFolderTextSpan";R.appendChild(wa)}pJg(R){const wa=document.createElement("span");wa.className="cui-img-cont-float cui-img-16by16 ";this.pqa=document.createElementNS("http://www.w3.org/2000/svg","svg");this.pqa.setAttribute("class","FolderIconSVG");const na=document.createElementNS("http://www.w3.org/2000/svg","path");na.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");
this.pqa.appendChild(na);wa.appendChild(this.pqa);R.appendChild(wa)}LHf(R){!R||R.keyCode!==w.a.Lh&&R.keyCode!==w.a.$W||this.rEd(R)}rEd(){if(this.FI){const R=u.a.Z3(t.AFrameworkApplication.fileName);let wa=this.FI.value;this.hide();wa&&""!==wa&&""!==R||1===this.sa.state?(""!==R&&(wa+=R),this.U$b(wa)?this.Es.create().displayError(1,wa,!1):this.omb.start(wa,this.sBg)):this.Es.create().displayError(2,wa,!1)}}f3g(R){this.Ky&&this.pqa&&(R?(this.Ky.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.Ky,"DisabledSaveAsButton"),
Sys.UI.DomElement.removeCssClass(this.pqa,"DisabledFolderIconSVG")):(this.Ky.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.Ky,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.pqa,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.Ky,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.pqa,"DisabledFolderIconSVG"))))}Ckd(){super.Ckd();this.f3g(!!this.FI&&""!==this.FI.value)}dispose(){this.Ky&&(z.a.removeHandler(this.Ky,n.a.click,Object(h.a)(this,this.rEd,"onSaveToAnotherLocationClick")),
z.a.removeHandler(this.Ky,n.a.Sb,Object(h.a)(this,this.LHf,"onSaveToAnotherLocationKeyDown")),this.Ky=null);super.dispose()}}Object(r.a)(y,"FileNameDialog",e.a,[595]);var v=a(697),C=a(553),x=a(192),B=a(826),H=a(925),I=a(99),U=a(137);class S{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(r.a)(S,"SaveAsDialogInput",null,[]);class G{constructor(){this.properties=this.friendlyPath=this.folderName=null}}Object(r.a)(G,"SaveLocation",
null,[]);var D=a(378),E=a(194);class N{constructor(R,wa,na,Ba,Ra,qa,La,Yb,mc){this.SOc=null;this.eA="";this.omb=R;this.Es=wa;this.Ah=mc;this.uga=na;this.Ye=Ra;this.Nv=Ba;this.xFa=La;this.TXa=Yb;qa&&(this.SOc=new c.a(()=>new B.a(qa.value,null)))}KSh(){const R=new v.a(C.a.Oi());R.ia("type","currentHost");return Object.assign(new G,{folderName:this.Nv.breadcrumbFolderName,friendlyPath:this.Nv.breadcrumbBrandName,properties:R})}xui(R){return!!R&&"ClassicMru"===R.type&&!!R.service_info&&!!R.service_info.service_id&&
-1!==R.service_info.service_id.indexOf("SHAREPOINT")}v3h(){if(!this.SOc||!this.xFa)return null;var R=this.SOc.value.vZ("SaveAsToSharePointDialog",!1);if(!R||3!==R.state||!R.Bwf)return null;R=R.Bwf;const wa=new x.a;let na=0,Ba=0;for(var Ra=0;Ra<R.length;Ra++){var qa=R[Ra];if(!this.xui(qa))continue;na++;if(!qa.sharepoint_info)continue;const La=qa.url,Yb=qa.sharepoint_info.site_url,mc=qa.title;qa=H.b(qa,t.AFrameworkApplication.isRtl);if(!(La&&Yb&&mc&&qa))continue;Ba++;const Zb=new v.a(C.a.Oi());Zb.ia("type",
"SharePoint");Zb.ia("siteUrl",Yb);Zb.ia("folderUrl",La);Ba++;wa.add(Object.assign(new G,{folderName:mc,friendlyPath:qa,properties:Zb}))}Ra=new Map;Ra.set("NumPlaces",R.length.toString());Ra.set("NumSharepointPlaces",na.toString());Ra.set("placesWithMetadata",Ba.toString());I.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",Ra);0<na&&(Ba?.5>1*Ba/na&&I.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):I.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru",
"AllPlacesMetadataMissing",!1,!1,null));return wa}ATh(){const R=new x.a;R.add(this.KSh());const wa=this.v3h();wa&&R.addRange(wa);return Object.assign(new S,{enableMoreLocations:!t.AFrameworkApplication.fa.pa("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.eA,extension:u.a.Z3(this.Nv.fn),saveLocations:R.toArray(),scenario:"SaveToSharePoint"})}fcc(){const R=Object(h.a)(this,this.ATh,"getDialogInput"),wa={};wa.inputPropsCallback=R;return wa}UP(R){this.eA=R;this.eA||(this.eA=String.format(CommonUIStrings.l_SaveACopy_Filename,
u.a.Lp(this.Nv.fn)));R={["id"]:"SaveAsDialog",["bodyControls"]:this.fcc()};let wa=CommonUIStrings.L_SaveAs;2===this.Ye.Qa.Oj&&(wa=CommonUIStrings.L_SaveACopy);const na=new l.a(!1,!1,!0);na.Ob=1;na.pe="SaveAsDialog";na.tc(1,CommonUIStrings.l_SaveButtonLabel);na.initializeAndShow(wa,Object(h.a)(this,this.lsj,"saveAsDialogHandler"),R)}EJj(R,wa){R&&""!==R&&""!==wa||1===this.Ye.state?this.wui()?this.bBi(R,wa):(""!==wa&&(R+=wa),this.omb.start(R,this.Ah)):(b.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),
this.Es.create().displayError(2,R,!1))}bBi(R,wa){I.Health.instance.recordKpiUsage("SaveACopySFP",0,"smartfio",null);const na=this.TXa.UHe(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,null,"SaveACopy",2);this.TXa.zgd(na).then(Ba=>{if(Ba&&0<Ba.length){const Ra=Ba[0][D.a.y5i];Ba=Ba[0][D.a.HMf];if(""!==Ra&&""!==Ba)this.xFa.hoa(Ba,R+wa,Ra,this.Ah),I.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.Es.create().displayError(0,R,!1);const qa=U.a.Pr();
qa&&(qa.set("SiteUrlAvailable",""===Ra?"false":"true"),qa.set("FolderUrlAvailable",""===Ba?"false":"true"));I.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new E.a,{extendedProperties:qa}))}}else this.Es.create().displayError(0,R,!1),I.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(Ba=>{"Canceled"===Ba?((Ba=U.a.Pr())&&Ba.set("IsCanceled","true"),I.Health.instance.recordKpiSuccess("SaveACopySFP",
Object.assign(new E.a,{extendedProperties:Ba}))):I.Health.instance.recordKpiFailure("SaveACopySFP",Ba,!1,!1,null)})}wui(){return this.TXa?this.TXa.btd():(b.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}lsj(R,wa){if(wa&&1===R){R=wa.fileName;var na=u.a.Z3(this.Nv.fn);wa.moreLocationsSelected&&this.EJj(R,na);if(wa.locationCallback){var Ba=wa.locationCallback();Ba?Ba.properties&&"currentHost"===Ba.properties.ma("type")?this.uga.hoa(R+na,!1,this.Ah):Ba.properties&&"SharePoint"===
Ba.properties.ma("type")?(wa=Ba.properties.ma("siteUrl"),Ba=Ba.properties.ma("folderUrl"),this.xFa.hoa(Ba,R+na,wa,this.Ah)):b.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):b.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else b.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}}}Object(r.a)(N,"ReactSaveAsDialog",null,[595]);class M{constructor(R,wa,na,Ba,Ra,qa,La,Yb=null,mc=null,Zb=null){this.Ma=wa;this.mb=R;this.kX=Ba;this.uga=qa;this.Es=Ra;this.Ye=
na;this.Xie=La;this.Zzg=Yb;this.xFa=mc;this.TXa=Zb}create(R){return this.Ye&&this.Ye.Qa.tv?new N(this.Xie,this.Es,this.uga,t.AFrameworkApplication.om,this.Ye,this.Zzg,this.xFa,this.TXa,R):new y(this.mb,this.Ma,this.Ye,this.kX,this.Es,this.uga,this.Xie,R)}}Object(r.a)(M,"FileNameDialogFactory",null,[551]);class L{constructor(R,wa,na,Ba){this.Io=this.olb=null;this.kjb=R;this.Ye=na;this.OBg=Ba;this.QDa=new c.a(()=>new B.a(wa.value,Object(h.a)(this,this.sxb,"getMoreInfoEventReceived")))}get tKf(){this.olb||
(this.QDa.value.vZ("Save As",!0),this.Io&&this.Io.pR&&this.Io.pR.length&&(this.olb=this.i_h(this.Io.pR)));return this.olb}start(R){if(!this.tKf)if(t.AFrameworkApplication.breadcrumbFolderUrl&&t.AFrameworkApplication.breadcrumbFolderUrl.length)this.olb=t.AFrameworkApplication.breadcrumbFolderUrl;else return b.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.Io),!1;const wa=
this.OBg();wa.YJj();const na=wa.R_h();if(!na)return b.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.kjb.start((Ba,Ra)=>{wa.hide();R(Ba,Ra)},()=>{this.uca(wa)},na,this.olb);return!0}uca(R){R.hide();b.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}i_h(R){R=R.toLowerCase();R.endsWith("/")||(R+="/");const wa=R.indexOf("/documents/");return-1!==wa?R.substring(0,wa+1)+"_layouts/15/onedrive.aspx":""}sxb(R){this.Io||3!==R.state||(this.Io=
R)}}Object(r.a)(L,"OneDriveFilePickerHelper",null,[547]);class aa extends l.a{constructor(){super()}YJj(){this.CJc="FilePickerDialog";this.og="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.pe="PickerDialog-MsoSp";this.showDialog("",null)}R_h(){return document.getElementById("FilePickerDiv")}CD(){}Pma(){}}Object(r.a)(aa,"PickerDialog",l.a,[543]);var V=a(650),P=a(852),ba=a(380),Y=a(27),Z=a(108),ea=a(25);class ra{constructor(R,wa,na,Ba,Ra,qa,La){this.mb=R;this.LKc=na;this.Ma=wa;this.omb=
Ba;this.kjb=Ra;this.BQc=qa;this.gug=La}Ag(){const R=this.kjb.K4a();R?Y.a.Pka||this.mb.pa("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.Ma.Oe(ea.a.saveToSharePoint,Z.a.frame,Object(h.a)(this,this.k1f,"saveToSharePointActionDispatcher"),64):(R.Y8a.continueWith(wa=>{wa.Hf&&this.kjb.HDd(wa)}),this.R2b()):b.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")}R2b(){ba.a.EKd(Object(h.a)(this,this.k1f,"saveToSharePointActionDispatcher"));ba.a.q$c([new P.a(ea.a.saveToSharePoint,
Z.a.frame,0)],this.kjb.K4a())}get e8a(){return this.mb.pa("SaveToAnotherFolderBrsIsEnabled")}get mAe(){return this.mb.pa("UserCanWriteRelative")}k1f(R,wa,na,Ba,Ra){return wa.contextId!==Z.a.frame||R!==ea.a.saveToSharePoint?2:this.e8a&&(this.BQc.tKf||this.mAe)?1===na?V.SessionStatusManager.instance.v5a||t.AFrameworkApplication.W4?8:this.gug()?32:8:2===na?(b.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(Ra&&Ra.SaveEntryPoint&&"VersionHistory"===Ra.SaveEntryPoint.toString()?
"version history.":"the backstage.")),this.mAe?(b.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.LKc.create(Ra).UP(null)):(b.ULS.sendTraceTag(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),this.omb.start(null,Ra)),32):8:8}}Object(r.a)(ra,"SaveToSharePointActor",null,[]);class O{constructor(R,wa,na,Ba){this.Ah=this.$ee=null;this.xFa=R;this.Es=wa;this.BQc=na;this.Ye=Ba}start(R,wa){b.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");
this.$ee=R;this.Ah=wa;this.BQc.start((na,Ba)=>{this.Z9i(na,Ba)})||this.ZUd()}Z9i(R,wa){if(R)this.onSuccess(wa);else this.d6(wa)}ZUd(){1!==this.Ye.state&&this.Es().T8c(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)}onSuccess(R){b.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(R&&R.data&&R.data.value&&R.data.value.length&&R.data.value[0].sharePoint){const wa=R.data.value[0].sharePoint.url;R=R.data.value[0].sharePoint.listUrl;
let na=null;if(wa&&(na=R?this.O3h(R):this.N3h(wa))){this.xFa.hoa(wa,this.$ee,na,this.Ah);return}b.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!wa,!na)}b.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.ZUd()}N3h(R){R.endsWith("/")||(R+="/");let wa=0;for(let na=0;na<R.length;na++)if("/"===R.charAt(na)&&5===++wa)return R.substr(0,na);return null}O3h(R){R.endsWith("/")&&(R=R.substring(0,
R.length-1));const wa=R.lastIndexOf("/");return-1!==wa?R.substring(0,wa):null}d6(R){b.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");R&&R.error?b.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",R.error.errorCode,R.error.message):b.ULS.sendTraceTag(23881890,216,10,"File Dialog returned empty error.");this.ZUd()}}Object(r.a)(O,"SaveToSharePointManager",null,[545]);var da=a(79);class xa{constructor(R,wa,na,Ba,Ra,qa,La,Yb){this.DFa=
R;this.eA=wa;this.YVa=Ba;this.zRc=qa;this.x8=na;this.rEg=Ra;this.tfa=La;this.Ah=Yb}execute(R,wa){if(!t.AFrameworkApplication.rg&&t.AFrameworkApplication.Bd){var na=this.DFa+this.tfa;na=da.a.wl(na,"fu",u.a.hf(this.x8));na=da.a.wl(na,"su",u.a.hf(this.rEg));na=da.a.wl(na,"fn",u.a.hf(this.eA));na=da.a.wl(na,"n",u.a.hf((new Date).getTime().toString()));this.Ah&&this.Ah.FileDownloadUrl&&(na=da.a.wl(na,"furl",u.a.hf(this.Ah.FileDownloadUrl)));na=na+"&"+this.zRc;this.YVa&&this.YVa.length?na=da.a.wl(na,"fnn",
u.a.hf(this.YVa)):b.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");b.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");t.AFrameworkApplication.Bd.Jm(na,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,R,wa,null,void 0,void 0,void 0,void 0,"9")}}}Object(r.a)(xa,"SharePointSaveAsCaller",null,[594]);class ia{constructor(R){this.EFa=R.appSettings.SaveAsToHostWebServiceBase;this.eA=R.appSettings.FileName;this.tfa=R.Wa("SharePointSaveAsHandler")||
"sharepointsaveashandler.ashx"}create(R,wa,na,Ba){return new xa(this.EFa,this.eA,R,wa,na,t.AFrameworkApplication.vi,this.tfa,Ba)}}Object(r.a)(ia,"SharePointUploadCallerFactory",null,[541]);var Ma=a(39),Ta=a(40),Da=a(241),fa=a(699),ua=a(168),Fa=a(652),ca=a(777);class ka{constructor(R,wa,na,Ba,Ra){this.Hm=this.XCa=null;this.gHc=!1;this.FSc=this.x8=null;this.TUc=wa;this.Plb=na;this.Es=Ba;this.Ye=Ra;this.Ma=R}hoa(R,wa,na,Ba){this.gHc=!1;b.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");
this.INb();this.x8=R;Ba&&Ba.SaveEntryPoint&&(this.FSc=Ba.SaveEntryPoint);this.XCa=this.TUc.create(R,wa,na,Ba);Ba&&"true"===Ba.SkipSaveToHost?this.aQ():this.KJh()}KJh(){const R=()=>{b.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.aQ()};32!==this.Ma.Vd(ea.a.uRa,2,[()=>{b.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");this.aQ()},R])&&R()}aQ(){b.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");
this.XCa.execute(Object(h.a)(this,this.wZi,"onSaveToSharePointUploadFinished"),Object(h.a)(this,this.vZi,"onSaveToSharePointUploadFailed"))}wZi(R){if(R&&R.data&&R.data.de){var wa;if(({ht:wa}=Ma.d(R.data.de)).returnValue)if(wa.StatusCode!==Da.a.IO&&wa.StatusCode!==Da.a.Ssb)b.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",R.data.status,wa.StatusCode),wa.StatusCode!==Da.a.SYf&&this.lNe(R.data.status)||(this.Ada(wa.StatusCode.toString()),
this.JIj(wa.StatusCode));else{b.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.pNd();try{wa.NewDocumentUrl?this.pQa(wa.NewDocumentUrl):this.qQa()}catch(na){b.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",na.toString())}}else b.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:ca.a.Yfb(R.data.de)}),this.v8b()||(this.Ada("Failed to deserialize response"),this.GNb())}else b.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),
this.v8b()||(this.Ada("Unknown"),this.GNb())}vZi(R){R&&R.data?this.lNe(R.data.status)||(b.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.Ada(fa.a[R.data.status]),this.GNb()):(b.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.v8b()||(this.Ada("Unknown"),this.GNb()))}v8b(){if(!this.gHc)return b.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.gHc=!0,this.aQ(),!0;b.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");
return!1}lNe(R){b.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",R);return this.v8b()}qQa(){b.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");Ta.a.gf(this.x8,Ta.a.bX(3),void 0,"UploadToSharePointManager.RedirectToFolder")}pQa(R){let wa=!1,na=!1;t.AFrameworkApplication.fa&&(wa=t.AFrameworkApplication.fa.pa("SaveACopyIsEnabledForUiHost"),na=t.AFrameworkApplication.fa.pa("UiHostSupportsDocRebootFeatures"));b.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",
R,wa);if(wa&&na){b.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Ba={};Ba[D.a.jQa]="1";Ba[D.a.documentUrl]=R;Ba[D.a.reason]=Fa.a.saveAs;t.AFrameworkApplication.uQ().execute(Ra=>{Ra.jj(ua.a.SY,Ba)})}else Ta.a.gf(R,Ta.a.bX(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}INb(){this.Ye&&1===this.Ye.state||(this.Hm=this.Plb(),this.Hm.message=CommonUIStrings.l_CommentProgressTooltip,this.Hm.Ob=5,this.Hm.pt=!1,this.Hm.ZAa(CommonUIStrings.l_DefaultDialogTitle,
null,null))}PIa(){this.Hm&&(this.Hm.close(),this.Hm=null)}GNb(){this.kj(CommonUIStrings.l_SaveFailedDialogTitle,CommonUIStrings.l_FailToSaveFile)}JJj(){this.kj(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)}RIj(){const R=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.kj(CommonUIStrings.l_SaveAsFileTooLargeTitle,R,f.a.msj)}kj(R,wa,na=f.a.qsj){b.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",R,wa);
this.PIa();1!==this.Ye.state&&this.Es().NMe(R,wa,na)}JIj(R){b.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",R);switch(R){case Da.a.Mhg:this.JJj();break;case Da.a.SYf:this.RIj();break;default:this.GNb()}}pNd(){"VersionHistory"===this.FSc&&this.Ma.processAction(ea.a.Gvc,2)}Ada(R){"VersionHistory"===this.FSc&&this.Ma.Vd(ea.a.rNd,2,{["FailureReason"]:R})}}Object(r.a)(ka,"UploadToSharePointManager",null,[540]);var Ca=a(251),fb=a(794),yb=a(519),mb=a(55);class nb{constructor(){this.ura=
this.VPc=this.QPc=this.$a=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}Bh(R){this.$a=R;this.QPc=yb.a.Rq(R.Tb("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.VPc=yb.a.Rq(R.Tb("Common.IEventEmitter<Common.IMruResult>"));this.ura=yb.a.Rq(R.Tb("Common.App.SharedFilePicker.ISharedFilePicker"));mb.Task.WAA.call(null,this.QPc,this.VPc,this.ura).continueWith(()=>{this.hfj()})}hfj(){this.$a.register(ia,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").yc(()=>
new ia(t.AFrameworkApplication.fa)).qc();this.$a.register(ka,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").yc(()=>new ka(t.AFrameworkApplication.rb,this.$a.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new fb.a).create(),()=>new d,t.AFrameworkApplication.sa)).qc();this.$a.register(O,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").yc(()=>
new O(this.$a.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new d,this.$a.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),t.AFrameworkApplication.sa)).qc();this.$a.register(L,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").yc(()=>new L(this.$a.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new c.a(()=>this.QPc.result),t.AFrameworkApplication.sa,()=>new aa)).qc();
this.$a.register(M,"Common.App.SaveToSharePoint.FileNameDialogFactory").yc(()=>new M(t.AFrameworkApplication.fa,t.AFrameworkApplication.rb,t.AFrameworkApplication.sa,t.AFrameworkApplication.sa.Qa,this.$a.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.$a.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.$a.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),new c.a(()=>this.VPc.result),this.$a.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),
this.ura?this.ura.result:null)).qc();this.$a.register(ra,"Common.App.SaveToSharePoint.SaveToSharePointActor").yc(()=>new ra(t.AFrameworkApplication.fa,t.AFrameworkApplication.rb,this.$a.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),this.$a.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.$a.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),this.$a.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>t.AFrameworkApplication.sa.x1g)).qc();
t.AFrameworkApplication.fa.pa("SaveToAnotherFolderBrsIsEnabled")&&this.$a.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Ag()}static main(){Ca.a.instance.ii(new nb)}}Object(r.a)(nb,"PackageManager",null,[3,4]);a.d(F,"a",function(){return X});const X=()=>{Type.registerNamespace("Common.App.SaveToSharePoint");nb.main()}},1190:function(r,F,a){var c=a(9);r=a(0);var b=a(709),e=a(50),f=a(37),d=a(1),h=a(189);class l{constructor(na,Ba){this.$=na;this.presentModeManager=Ba}Hc(){return!1}wc(na,
Ba){if(!d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PresentMode",!1))return!1;switch(Ba.command){case 642419866:return!0;case 588342182:return this.presentModeManager.lz;default:return!1}}executeCommand(na,Ba){na=f.TaskExtensions.Tj();Ba=Ba.command;switch(Ba){case 642419866:this.presentModeManager.Zzc(!this.presentModeManager.lz);this.presentModeManager.Zg("TogglePresentMode");break;case 588342182:this.presentModeManager.U7a=!this.presentModeManager.U7a;this.presentModeManager.s$f(this.presentModeManager.U7a,
"TogglePresentModeOverlay");this.presentModeManager.Zg("TogglePresentModeOverlay");break;default:na=h.a(Ba)}return na}Nc(){return!1}}Object(r.a)(l,"PresentModeCommandHandler",null,[222]);class k extends b.a{constructor(na){super(na)}hd(){f.TaskExtensions.za(e.GetServiceTaskFactory.Oa(this.$.da,423,424,this.Xa),na=>{this.$c([new l(this.$,na.result)])},this.la,3)}static ka(na){b.a.Md(420,new k(na))}}Object(r.a)(k,"PresentModeCommandHandlerFactory",b.a,[]);var t=a(161),n=a(226),z=a(15),w=a(133),m=a(4),
u=a(111),y=a(84);class v{}v.Nxh="ewa-presentMode-overlay";v.Oxh="ewa-presentMode-panel-container";v.Pxh="ewa-presentMode-rowHdrParent-container";Object(r.a)(v,"CssClassNames",null,[]);var C=a(19),x=a(5),B=a(153),H=a(294),I=a(127),U=a(376),S=a(193);a(56);var G=a(117),D=a(440),E=a(12),N=a(11),M=a(101),L=a(349),aa=a(21),V=a(128),P=a(426),ba=a(110),Y=a(14),Z=a(263),ea=a(250),ra=a(163),O=a(44);class da{constructor(na){this.Vve=this.RPa=this.uHd=this.vHd=this.Yca=this.ewaAccessibilityManager=null;this.isInitialized=
!1;this.gsc={};this.fsc={};this.MPa=null;this.cNf=0;this.onKeyDown=Ba=>{Ba=Ba.Ea;if(9===Ba.keyCode){var Ra=this.Yca.querySelectorAll(E.DOMElementExtensions.nr);const qa=E.DOMElementExtensions.rm(Ra);Ra=E.DOMElementExtensions.PA(Ra);E.DOMElementExtensions.FAa(Ba,qa,Ra);return!0}return!1};this.Yl=()=>{this.$.da.gb(337,Ba=>{this.RPa.getPresentModeFloatieControlsMap().then(Ra=>{const qa={};for(let La=0;La<Ra.length;La++)qa[Ra[La].controlId]=Ra[La].modelType;Ra=Ba.G6.$4a(qa);0<Ra.length&&appChrome.api.dispatch(Ra);
this.Isj()})})};this.$=na}dispose(){this.$=this.uHd=this.vHd=this.Yca=this.RPa=null}qhi(){window.requestAnimationFrame(()=>{this.Yca=document.createElement("div");this.$.eu.insertBefore(this.Yca,this.$.eu.lastChild);this.Yca.id=this.$.Bb+x.a.xac;this.Yca.classList.add(v.Oxh);this.vHd=document.getElementById(this.$.Bb+x.a.N7c);this.uHd=[this.$.wE];this.isInitialized=!0});this.RPa=presentMode.PresentModeControllerFactoryGlobal.createPresentModeFloatieController();this.RPa.initializePresentModeFloatie()}U4h(){const na=
{};na.PollingCountPerCaller=u.a.toJSON(this.fsc);na.PollingDurationPerCaller=u.a.toJSON(this.gsc);return na}YUd(na){this.isInitialized?na?(this.RPa.showPresentModeFloatie(this.Yca,this.vHd,this.uHd),this.Zg("ShowOrHideFloatiePanel"),this.kgj()):(this.RPa.hidePresentModeFloatie(),this.MYj()):z.ULS.sendTraceTag(537154326,0,15,"PresentModeFloatieManager.ShowOrHideFloatiePanel called before initialization complete")}Zg(na){this.cNf=N.HelperMethods.Kb();this.MPa=na;this.Vve=ra.AsyncMethodContext.vq(this.Yl,
100,O.a.I8i+na,this.Vve)}get jc(){return this.Yca}get Ff(){this.RPa.updatePresentModeFloatieShyState(2);return!!this.Yca}get Xd(){return ea.a.sOf}ag(na,Ba){if(Ba)return!1;na=E.DOMElementExtensions.rm(this.Yca.querySelectorAll(E.DOMElementExtensions.nr));if(!na)return z.ULS.sendTraceTag(537154325,0,10,"PresentModeFloatieManager.SetFocusOnSection: Could not find first focusable item in present mode toolbar"),!1;na.focus();return!0}sh(na){return E.DOMElementExtensions.Af(this.jc,na)}rj(){}dk(){}kgj(){Z.a(this.$).Yh(this);
this.$.da.gb(15,na=>{this.ewaAccessibilityManager=na;this.ewaAccessibilityManager.mode=5});ba.KeyInputManager.instance.ta(Y.a.Sb,this.jc,this.onKeyDown)}MYj(){Z.a(this.$).Ez(this);aa.h(this.$).q0();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0);ba.KeyInputManager.instance.Ba(Y.a.Sb,this.jc,this.onKeyDown)}Isj(){const na=N.HelperMethods.Kb()-this.cNf,Ba=this.gsc[this.MPa]?this.gsc[this.MPa]:0;this.gsc[this.MPa]=Ba>na?Ba:na;this.fsc[this.MPa]=this.fsc[this.MPa]?this.fsc[this.MPa]+
1:1}}Object(r.a)(da,"PresentModeFloatieManager",null,[496,54,2]);var xa=a(7),ia=a(63);class Ma{constructor(){this.angle=this.translateY=this.translateX=this.height=this.width=this.top=this.left=0}}Object(r.a)(Ma,"OverlayCavityInfo",null,[]);class Ta{constructor(){this.height=this.width=0}}Object(r.a)(Ta,"OverlayContainerInfo",null,[]);class Da{constructor(){this.overlayCavityInfos=this.overlayContainerInfo=this.containerId=null}}Object(r.a)(Da,"PresentModeOverlayProps",null,[]);class fa{constructor(na){this.O_a=
this.wHd=null;this.$=na;this.gridView=aa.h(this.$)}aii(){this.wHd=presentMode.PresentModeControllerFactoryGlobal.createPresentModeOverlayController();window.requestAnimationFrame(()=>{this.O_a=Array(5);let na,Ba;for(let Ra=1;4>=Ra;Ra++)na=document.createElement("div"),E.DOMElementExtensions.setVisible(na,!1),na.id=`${"PresentModeOverlay"}-${Ra}`,E.DOMElementExtensions.toggleCssClass(na,v.Nxh,!0),Ba=this.gridView.Rf(Ra).domElement,Ba.insertBefore(na,Ba.firstChild),this.O_a[Ra]=na})}r$f(na){na&&this.r1j();
for(let Ba=1;4>=Ba;Ba++)this.Ykf(Ba)&&E.DOMElementExtensions.setVisible(this.O_a[Ba],na);E.DOMElementExtensions.toggleCssClass(this.$.ar,"ewr-presentMode-overlay",na)}r1j(){const na=this.B0g();let Ba;for(let Ra=1;4>=Ra;Ra++)Ba=Ra,na[Ba]&&this.wHd.showOverlayWithCavity(this.O_a[Ba],na[Ba])}dispose(){this.wHd=this.O_a=this.gridView=this.$=null}B0g(){let na;const Ba=aa.h(this.$).rtl;let Ra;const qa=Array(5);for(let Yb=1;4>=Yb;Yb++)if(na=Yb,this.Ykf(Yb)){var La=this.gridView.Rf(Yb);Ra=this.gridView.ha.Ra.O4?
this.zVh(Yb,La,Ba):this.sWh(Yb,La,Ba);La=this.sfh(La);qa[na]=this.Nfh(this.O_a[na].id,La,Ra)}return qa}Ykf(na){return this.gridView.ib.xQ(na)}sfh(na){return Object(xa.a)(new Ta,{width:na.zn.width,height:na.zn.height})}Nfh(na,Ba,Ra){return Object(xa.a)(new Da,{containerId:na,overlayContainerInfo:Ba,overlayCavityInfos:Ra?[Ra]:null})}zVh(na,Ba,Ra){var qa=aa.h(this.$).ha.Ra.dc;if(!qa)return z.ULS.sendTraceTag(537154317,0,10,"PresentModeOverlayRenderer.GetFloatingObjectOverlayCavityInfo: Selected Floating Object is null."),
null;let La,Yb;if(({jCa:na,rotation:qa,translateX:La,translateY:Yb}=qa.extension.CVh(na)).returnValue){const mc=na.x-Ba.zn.x;return Object(xa.a)(new Ma,{left:(Ra?Ba.zn.width-(mc+na.width):mc)-3+1,top:na.y-Ba.zn.y-3+1,width:na.width+5,height:na.height+5,angle:qa,translateX:La,translateY:Yb})}return null}sWh(na,Ba,Ra){na=this.gridView.Cb.xwb(this.gridView.ha.qa.activeRange,na)||ia.a.z3;if(!na.we(Ba.zn))return null;const qa=na.x-Ba.zn.x;return Object(xa.a)(new Ma,{left:Ra?Ba.zn.width-(qa+na.width)-2:
qa-3,top:na.y-Ba.zn.y-3,width:na.width+5,height:na.height+5})}}Object(r.a)(fa,"PresentModeOverlayRenderer",null,[495,2]);var ua=a(60);const Fa=(na,Ba,Ra,qa,La,Yb,mc=null)=>{mc=na.Na(41,mc);mc.shouldEnablePresentMode=Ba;return ua.g(na,"SetPresentMode",mc,Ra,qa,La,Yb,0)};var ca=a(285);class ka extends ca.a{constructor(na,Ba){super(na);this.J8i=()=>{this.Zca.YUd(!0)};this.Zca=Ba;this.domElement.classList.add("ewr-presentMode-on");na={[ka.it]:this.kc};this.Ob=0;this.initializeAndShow("",this.J8i,na)}get kc(){return"PresentModeWelcomeDialog"}hide(){super.hide();
w.a.Cv(x.a.y$f,"false",this.$.ya.ShowPresentModeWelcomeDialogCookieExpirationDays)}}Object(r.a)(ka,"PresentModeWelcomeDialog",ca.a,[]);class Ca{static get WKh(){return document.webkitFullscreenEnabled?"webkitfullscreenchange":document.msFullscreenEnabled?"MSFullscreenChange":document.mozFullScreenEnabled?"mozfullscreenchange":document.fullscreenEnabled?"fullscreenchange":null}static get XKh(){return"undefined"!==typeof document.webkitFullscreenEnabled?"webkitfullscreenerror":"undefined"!==typeof document.msFullscreenEnabled?
"MSFullscreenError":"undefined"!==typeof document.mozFullScreenEnabled?"mozfullscreenerror":"undefined"!==typeof document.fullscreenEnabled?"fullscreenerror":null}static requestFullscreen(na){na.webkitRequestFullscreen?na.webkitRequestFullscreen():na.msRequestFullscreen?na.msRequestFullscreen():na.mozRequestFullScreen?na.mozRequestFullScreen():na.requestFullscreen?na.requestFullscreen():z.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")}static exitFullscreen(){document.webkitExitFullscreen?
document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.exitFullscreen?document.exitFullscreen():z.ULS.sendTraceTag(7145620,210,50,"ExitFullscreen got invoked in unknown browser")}static get Fpi(){return!!document.webkitFullscreenElement||!!document.msFullscreenElement||!!document.mozFullScreenElement||!!document.fullscreenElement}}Object(r.a)(Ca,"FullscreenUtils",null,[]);class fb{constructor(na){this.Eoa=
this.XZe=this.rIb=this.R2a=this.Dsc=this.Zca=this.TPa=null;this.Wsd=this.ZPb=this.FOd=!1;this.lNb=!0;this.Lhc=!1;this.bVd=!0;this.YPb=this.u1a=this.UFe=0;this.rxc={};this.krc={};this.jrc={};this.rOf=0;this.U7a=this.Lbe=!1;this.Qij=()=>{E.DOMElementExtensions.toggleCssClass(this.$.ar,"ewr-presentMode-transition",!1);$removeHandler(this.R2a,"transitionend",this.Eoa)};this.wj=()=>{parseInt(this.$.eu.style.right,10)!==this.UFe&&window.requestAnimationFrame(()=>{this.UDc(0);this.$.Aza(H.a.qZ("PresentModeManager.OnContentAreaResized"))})};
this.j6=()=>{var Ba=Object(y.a)(M.a,this.$.na);if(Ba&&this.lz){this.gridView.kic=!1;Ba=Ba.headersVisible;var Ra=aa.h(this.$).rtl;E.DOMElementExtensions.toggleCssClass(this.$.ar,"ewr-presentMode-on-headers-off",!Ba);E.DOMElementExtensions.toggleCssClass(this.$.ar,"ewr-presentMode-on-rtl",Ra);(12!==this.u1a&&!Ba||32!==this.u1a&&Ba&&!Ra||0!==this.u1a&&Ba&&Ra)&&window.requestAnimationFrame(()=>{this.UDc(2)})}};this.dd=()=>{this.kgf();this.Zg("OnWorkbookOpened");z.ULS.sendTraceTag(537154323,0,50,"PresentModeManager.OnWorkbookOpened: Silent reload happened during present mode")};
this.tr=()=>{this.Wsd=!0;this.Dea("OnSelectionStarted")};this.Xg=()=>{this.Wsd=!1;this.Dea("OnSelectionEnded");this.f1f()};this.Ri=()=>{this.Dea("OnEditStarted")};this.$f=()=>{this.Dea("OnEditEnded")};this.Ew=()=>{if(!this.Lhc){const Ba=d.EwaSettings.isChangeGateEnabled("OfficeVSO:5411756_FlickerFixForPresentModeOverlay");this.Dea("OnVisibleAreaChanged",!0,Ba)}};this.OFb=()=>{this.Lhc=!0};this.xn=()=>{this.Dea("OnCurrentSelectionModeChanged");this.f1f();this.Zg("OnCurrentSelectionModeChanged")};this.Tm=
()=>{this.Dea("OnBlockCacheItemEvicted")};this.nf=()=>{this.Dea("OnBlockCacheItemChanged")};this.nF=()=>{this.Lhc||this.Dea("OnActiveItemPanesChanged")};this.ij=()=>{this.Lhc=!1;this.Zca.Zg("ActiveSheetChanged");this.j6()};this.PGb=(Ba,Ra)=>{if(Ba=Object(y.a)(M.a,Ra.item))Ba.crb(16,!0),Ba.dZa(this.j6)};this.PSi=()=>{Ca.Fpi||(this.Dsc&&this.Dsc.Pn&&this.Dsc.hide(),aa.h(this.$).fb&&aa.h(this.$).Fo(!0),this.Zzc(!1),z.ULS.sendTraceTag(537154321,0,50,"PresentModeManager.OnFullScreenChangeEventHandler: Esc pressed to exit present mode"))};
this.QSi=()=>{z.ULS.sendTraceTag(537154320,0,10,"PresentModeManager.OnFullScreenErrorEventHandler: Error handling full screen mode")};this.$=na;this.gridView=aa.h(this.$);this.ttj=na.ya.PresentModeRenderUpdateTimeout;this.initialize(na)}get lz(){return this.Lbe}Zzc(na){this.lz!==na&&(this.Lbe=na,this.U7a=this.lz,this.kgf(),this.lNb=this.b9f(),window.requestAnimationFrame(()=>{E.DOMElementExtensions.toggleCssClass(this.$.ar,"ewr-presentMode-transition",!0);$addHandler(this.R2a,"transitionend",this.Eoa);
this.PJj(!na);this.o3i();E.DOMElementExtensions.toggleCssClass(this.$.ar,"ewr-presentMode-on",na);this.OJj(na);B.b(this.$).p$f(this.lz);B.c(this.$).p$f(this.lz);this.$.dAa();this.TPa.r$f(this.lNb);if(this.lz){this.XZa();w.a.get(x.a.y$f)?this.Zca.YUd(this.lz):this.Dsc=new ka(this.$,this.Zca);var Ba=P.b(this.$);Ba&&(this.FOd=Ba.b$c(!1));this.rOf=N.HelperMethods.Kb()}else this.Zca.YUd(na),this.FOd&&(Ba=P.b(this.$))&&(Ba.b$c(!0),this.FOd=!1),this.G7b(),this.MDi()}))}s$f(na,Ba){this.bVd=na;this.Dea(Ba)}Zg(na){this.Zca.Zg(na)}dispose(){this.G7b();
this.TPa&&(this.TPa.dispose(),this.TPa=null);this.gridView=this.$=null}PJj(na){const Ba=this.$.da.Aa(25);void 0===Ba||null===Ba?z.ULS.sendTraceTag(537154324,0,10,"PresentModeManager.ShowOrHideGridPresence: presenceView is null"):na?Ba.Uzc():Ba.gfc()}o3i(){E.DOMElementExtensions.toggleCssClass(document.getElementById(m.AFrameworkApplication.c3a),C.a.io,this.lz);E.DOMElementExtensions.toggleCssClass(this.$.ar,"ewr-presentMode-on",this.lz);this.RJj(this.lz);this.gridView.kic=!this.lz;this.H1j();this.$.da.gb(32,
na=>{na.c2j(this.lz)});G.b(this.$,na=>{na.Ljg(this.lz)})}RJj(na){if(this.rIb)if(na){if(na=Object(y.a)(M.a,this.$.na))E.DOMElementExtensions.toggleCssClass(this.$.ar,"ewr-presentMode-on-headers-off",!na.headersVisible),E.DOMElementExtensions.toggleCssClass(this.$.ar,"ewr-presentMode-on-rtl",aa.h(this.$).rtl);this.UDc(0)}else this.$.ar.classList.remove("ewr-presentMode-on-headers-off"),this.$.ar.classList.remove("ewr-presentMode-on-rtl"),this.UDc(1)}UDc(na){var Ba=Object(y.a)(M.a,this.$.na);if(Ba){var Ra=
parseInt(this.$.eu.style.right,10);if(1===na||2===na){if(isNaN(Ra)||Ra<this.u1a)return;Ra-=this.u1a}if(0===na||2===na)na=Ba.headersVisible,Ba=aa.h(this.$).rtl,na=na?Ba?0:32:12,Ra=isNaN(Ra)?na:Ra+na,this.u1a=na;this.$.eu.style.right=N.HelperMethods.sc(Ra);this.UFe=Ra}}H1j(){const na=document.getElementById(this.$.Bb+x.a.e7b).parentNode;E.DOMElementExtensions.toggleCssClass(na,v.Pxh,this.lz)}initialize(na){this.TPa=new fa(na);this.TPa.aii();this.Zca=new da(na);this.Zca.qhi();this.R2a=document.getElementById("MainApp");
this.XZe=this.PSi;$addHandler(this.R2a,Ca.WKh,this.XZe);$addHandler(this.R2a,Ca.XKh,this.QSi);this.rIb||(this.rIb=document.createElement("div"),this.rIb.className="ewa-presentMode-right-frame",this.$.wE.appendChild(this.rIb));this.Eoa=this.Qij}XZa(){this.gridView.ha.z9(this.tr);this.gridView.ha.q2(this.Xg);this.gridView.mc.xl(this.Ri);this.gridView.mc.Km(this.$f);this.gridView.jE(this.xn);this.gridView.view.Ps(this.Ew);this.gridView.iXc(this.OFb);this.gridView.Ca.zG(this.Tm);this.gridView.Ca.Ns(this.nf);
this.$.va.Vf(this.ij);this.$.va.Wra(this.nF);this.$.va.Nga(this.PGb);this.$.dC(this.wj);this.$.Lk(this.dd);const na=Object(y.a)(L.a,this.$.va);for(const Ba of na.items)Ba.dZa(this.j6)}G7b(){this.gridView&&(this.gridView.ha.xda(this.tr),this.gridView.ha.Y_(this.Xg),this.gridView.mc.nl(this.Ri),this.gridView.mc.$l(this.$f),this.gridView.AF(this.xn),this.gridView.view.Mq(this.Ew),this.gridView.NLd(this.OFb),this.gridView.Ca.aI(this.Tm),this.gridView.Ca.Kq(this.nf));if(this.$){this.$.va.sg(this.ij);this.$.va.Tza(this.nF);
this.$.va.bna(this.PGb);this.$.zF(this.wj);this.$.pl(this.dd);const na=Object(y.a)(L.a,this.$.va);for(const Ba of na.items)Ba.dvc(this.j6)}}b9f(){if(!this.lz||!this.U7a)return!1;if(1===this.gridView.ha.Ke){const na=this.$.na.activeRange.isSingle,Ba=1===this.$.na.selectedRanges.length&&!na,Ra=this.gridView.fb,qa=this.Wsd;Ba||z.ULS.sendTraceTag(537154322,0,50,`PresentModeManager.ShouldShowPresentModeOverlay: Not showing present mode overlay, single cell selection : ${na}`);return this.bVd&&Ba&&!Ra&&
!qa}return this.bVd}OJj(na){na?Ca.requestFullscreen(this.R2a):Ca.exitFullscreen()}Dea(na,Ba=!1,Ra=!1){Ba||(this.lNb=this.b9f());z.ULS.sendTraceTag(555356484,0,100,`PresentModeManager.UpdateLayout: UpdateLayout triggered by ${na}, visibility: ${this.lNb}, immediateUpdate: ${Ra}`);if(this.ZPb&&Ra)z.ULS.sendTraceTag(543023559,0,50,`PresentModeManager.UpdateLayout: Cancel update layout for ${this.YPb}`),window.cancelAnimationFrame(this.YPb),this.YPb=0;else if(this.ZPb){z.ULS.sendTraceTag(543023558,0,
50,`PresentModeManager.UpdateLayout: Skipping update layout for ${na}`);return}Ra?this.r0d(N.HelperMethods.Kb(),na):(this.YPb=window.requestAnimationFrame(qa=>{this.r0d(qa,na)}),this.ZPb=!0)}r0d(na,Ba){var Ra=N.HelperMethods.Kb();if(Ra-na>this.ttj)this.YPb=window.requestAnimationFrame(La=>{this.r0d(La,Ba)}),this.ZPb=!1,z.ULS.sendTraceTag(537154319,0,50,`PresentModeManager.UpdateLayoutCallback: Scheduling update for next frame,  ElapsedTime = ${Ra-na}ms.`);else{this.TPa.r$f(this.lNb);this.ZPb=!1;var qa=
N.HelperMethods.Kb();na=N.HelperMethods.Kb()-na;Ra=qa-Ra;this.wsj(na,Ba);z.ULS.sendTraceTag(537154318,0,50,`PresentModeManager.UpdateLayoutCallback: UpdateLayoutTotalDuration = ${Ra}ms. rafTotalDuration = ${na}ms`)}}kgf(){U.a(this.$.userOperationManager,(na,Ba,Ra)=>Fa(this.$.oa.xa,this.lz,na,Ba,Ra,null),na=>new S.a(252,0,na),null)}f1f(){let na=D.a(this.gridView.Ke);1!==this.gridView.Ke||this.$.na.activeRange.isSingle||(na="Range");this.rxc[na]=this.rxc[na]?this.rxc[na]+1:1}wsj(na,Ba){const Ra=this.krc[Ba]?
this.krc[Ba]:0;this.krc[Ba]=Ra>na?Ra:na;this.jrc[Ba]=this.jrc[Ba]?this.jrc[Ba]+1:1}MDi(){const na={};var Ba=N.HelperMethods.Kb()-this.rOf;na.PresentModeDuration=Ba;na.SelectionCountPerObject=u.a.toJSON(this.rxc);na.OverlayCountPerCaller=u.a.toJSON(this.jrc);na.OverlayDurationPerCaller=u.a.toJSON(this.krc);Ba=this.Zca.U4h();for(let Ra in Ba)na[Ra]=Ba[Ra];V.b(this.$).rd(I.a.H8i,na,void 0,!0)}}Object(r.a)(fb,"PresentModeManager",null,[463,2]);var yb=a(204),mb=a(187),nb=a(105),X=a(712);class R extends n.a{constructor(na){super();
this.$=na;this.Db()}create(){if(d.EwaSettings.isChangeGateEnabled("OfficeVSO:7457857_DynamicScriptLoaderNewService"))void(()=>Object(t.a)(this,void 0,void 0,function*(){yield(yield mb.a.resolve(nb.d,{Tl:this.Xa}))("presentMode");this.nb(Object(X.a)(this.$.da,423,()=>new fb(this.$)))}))();else{var na=e.GetServiceTaskFactory.Oa(this.$.da,283,284,1);f.TaskExtensions.za(na,()=>{f.TaskExtensions.za(yb.c(na.result.Hl.loadScript("presentMode")),()=>{let Ba=this.$.da.Aa(423);Ba||(Ba=new fb(this.$),this.$.da.Ha(423,
Ba));this.nb(Ba)},this.$.la,3)},this.$.la,3)}}static ka(na){na.da.Ha(424,new R(na))}}Object(r.a)(R,"PresentModeManagerFactory",n.a,[]);a.d(F,"a",function(){return wa});const wa=()=>{c.a.Fa(na=>{R.ka(na);k.ka(na)})}},1194:function(r,F,a){var c=a(9);r=a(0);var b=a(552),e=a(709),f=a(50),d=a(37),h=a(15),l=a(1263),k=a(4),t=a(168),n=a(767),z=a(99),w=a(268),m=a(652),u=a(27),y=a(160),v=a(182),C=a(288),x=a(5),B=a(152),H=a(103),I=a(68),U=a(77),S=a(376),G=a(193),D=a(56),E=a(60),N=a(327),M=a(592),L=a(1362),aa=
a(423),V=a(320),P=a(13);class ba extends L.a{constructor(Ka,ub){super(Ka,void 0,void 0,ub)}get qOa(){return P.a.instance.Ta(421)}get Dlc(){return P.a.instance.Ta(422)}get Clc(){return"DownloadOdsLink"}get rDb(){return"#"}get U8a(){return P.a.instance.Ta(423)}get Tvf(){return!0}Frf(){h.ULS.sendTraceTag(537162658,0,50,"DownloadACopyAsOdsDialog.LogDialogDisplayed - ODS download dialog displayed")}Hrf(){h.ULS.sendTraceTag(537162657,0,50,"DownloadACopyAsOdsDialog.LogDownloadLinkClicked - ODS download dialog link clicked")}wlc(){aa.Redirect.showHelp(V.a.cNi);
return!0}}Object(r.a)(ba,"DownloadACopyAsOdsDialog",L.a,[]);class Y{constructor(Ka,ub){this.dialog=null;this.ZBf=()=>{this.dialog&&this.dialog.hide()};this.yNi=Ka;this.qb=ub;this.qb.nob(this.ZBf)}bwe(Ka){this.dialog=Ka}Z8c(){this.yNi.CKf(-1059172980)}dispose(){this.qb.SJb(this.ZBf)}}Object(r.a)(Y,"DownloadACopyAsOdsDialogDownloadBehavior",null,[148,2]);const Z=(Ka,ub,Kb,W,za,Sa,Wa=null)=>{Wa=Ka.Na(9,Wa);Wa.isReadOnlyRecommended=ub;return E.g(Ka,"SetReadOnlyRecommended",Wa,Kb,W,za,Sa,0)},ea=(Ka,ub,
Kb,W,za,Sa,Wa=null)=>{Wa=Ka.Na(9,Wa);Wa.calc_type=ub;return E.g(Ka,"SetCalculationOptions",Wa,Kb,W,za,Sa,0)};class ra{constructor(Ka){this.calculationMode=0;this.calculationMode=Ka}}Object(r.a)(ra,"MacroRecorderWorkbookCalculationModeSetPayload",null,[162]);class O{constructor(Ka){this.calculateType=0;this.calculateType=Ka}}Object(r.a)(O,"MacroRecorderWorkbookRecalculatedPayload",null,[162]);var da=a(86),xa=a(150),ia=a(181),Ma=a(14),Ta=a(110),Da=a(1);L=a(266);class fa{static get i2i(){return fa.h2i}}
fa.h2i="<div class='\"\"' id='OpenInAppDialog'> <div class='PrivacyDialogTitle UIFontDialogTitle' id='OpenInAppTitle'> <label id='OpenInAppTitle' class='\"\"' style='font-size:16pt' >{0}</label> </div> <div class='WACDialogRow' id='InfoMessageArea'> <label id='InfoMessageAreaLine1' class='\"\"' style='font-size:12pt' >{1}</label> <br/> </div> <br/> <div class='AppInstallButton' id='LinkToInstall' role='button' tabIndex='0'> <div class='clip32x32' id='BottomInfoIconClip' unselectable='on' style='display: inline-block; pointer-events:none;' role='img'> <img id='BottomIconInfo' class='{3}' role='presentation' src={2} /> </div> <div class='\"\"' id='AppstoreLink' style='display:inline-block; padding-top:4px; vertical-align:top;'> <label id='AppstoreLinkTitle' class='PrivacyDialogTitle' unselectable='on' style='font-size: 14pt; margin-left:8px' >{4}</label> </div> </div>";
Object(r.a)(fa,"OpenInAppDialogCopyHtml",null,[]);var ua=a(156);class Fa extends L.a{constructor(Ka){super(Ka);this.IH=null;this.WFb=()=>{h.ULS.sendTraceTag(574993313,306,50,"MouseClick: Open with redirection timer");if(this.$.ya.IsMeetingLiveSession)return this.mGc(),!0;u.a.ap?(h.ULS.sendTraceTag(574993312,306,50,"Android intent scheme is being used to open android app from browser"),this.Bx&&this.Bx.length||h.ULS.sendTraceTag(537162595,306,15,"ClientUrl is null"),this.openUrl("intent:"+this.Bx+
"#Intent;scheme=ms-excel;action=android.intent.action.VIEW;S.browser_fallback_url="+this.Cm+";end","_top")):9<=u.a.Rmd?(h.ULS.sendTraceTag(537162594,306,50,"OpenInAppDialog.onClickHandler: Open in app directly if installed for iOS version 9 or above"),this.openUrl(this.$la,"_top"),window.setTimeout(()=>{this.openUrl(this.Cm,"_blank")},9E3)):(h.ULS.sendTraceTag(537162593,306,50,"OpenInAppDialog.onClickHandler: Open in app if installed, else redirection to appstore for iOS version below 9."),this.openUrl(this.$la,
"_top"),window.setTimeout(()=>{this.openUrl(this.Cm,"_blank")},500));return!0};this.XOa=ub=>ub.Ea.keyCode===da.a.Lh||ub.Ea.keyCode===da.a.Kea?(h.ULS.sendTraceTag(537162592,306,50,"KeyPress: Open with redirection timer"),ub.Mb.click(),!0):!1;1===k.AFrameworkApplication.sa.Qa.Oj&&(this.Bx=this.$.workbookContext.ClientUrl,this.$la="ms-excel:ofe|u|"+this.Bx,this.Cm=k.AFrameworkApplication.fa.Wa("AppUrl"),u.a.R4?this.Cm="itms-apps://"+k.AFrameworkApplication.fa.Wa("WildFireUrlExceliOS")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac":
u.a.ap&&(Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseAppAndroidMarketURL",!1)&&this.$.ya.IsMeetingLiveSession?(h.ULS.sendTraceTag(529397969,306,100,"Using app android market url"),this.Cm=k.AFrameworkApplication.fa.Wa("WildFireMarketUrlExcelAndroid")):u.a.mBb?this.Cm=k.AFrameworkApplication.fa.Wa("WildFireUrlChinaStoreAndroid"):4<u.a.IYc.mOa&&(this.Cm=k.AFrameworkApplication.fa.Wa("WildFireUrlExcelAndroid")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac")))}get kc(){return"OpenInAppDialogCopy"}openUrl(Ka,
ub){let Kb=document.getElementById("link");Kb||(Kb=document.createElement("a"),Kb.id="link",Kb.style.visibility="hidden",Kb.href="",document.body.appendChild(Kb));Kb.target=ub;Kb.href=Ka;Kb.click()}mGc(){h.ULS.sendTraceTag(529397968,306,50,"OpenInAppForLiveFiles API invoked");d.TaskExtensions.za(f.GetServiceTaskFactory.Oa(this.$.da,21,137,1),Ka=>{let ub={};ub.OpenInAppUrl=this.$la;ub.StoreUrl=this.Cm;Ka.result.jj("UI_OpenInMobileApp",ub)},this.$.la)}j2i(){h.ULS.sendTraceTag(529397967,306,100,"OpenInAppDialogHandler invoked")}ig(){this.og=
xa.a.zq(fa.i2i,P.a.instance.ga(661),P.a.instance.ga(662),k.AFrameworkApplication.UA,ua.getImageClass(k.AFrameworkApplication.fa.Wa("AppIcon")),P.a.instance.ga(663));this.pe="OpenInAppDialog";this.Ob=5;this.initializeAndShow("",this.j2i.bind(this),null);this.lI(this.IH)}ry(Ka){super.ry(Ka);document.getElementById("WACDialogBodyPanel").style.padding="0 4px 0 24px";this.IH=document.getElementById("LinkToInstall");ia.a.instance.ta(Ma.a.click,this.IH,this.WFb);Ta.KeyInputManager.instance.ta(Ma.a.Ld,this.IH,
this.XOa)}dispose(){this.IH&&(ia.a.instance.Ba(Ma.a.click,this.IH,this.WFb),Ta.KeyInputManager.instance.Ba(Ma.a.Ld,this.IH,this.XOa),this.IH=null);super.dispose()}}Object(r.a)(Fa,"OpenInAppDialogCopy",L.a,[]);var ca=a(135),ka=a(378);class Ca{constructor(Ka){this.Udi="itms-apps://";this.Vdi="apps.apple.com/app/apple-store/id586683407?mt=8&pt=80423&ct=miniWAC";this.xqg=ub=>{1==ub&&this.mGc()};this.$=Ka;this.Bx=k.AFrameworkApplication.sa.Qa.Bx;this.$la="ms-excel:ofe|u|"+this.Bx;this.Cm=k.AFrameworkApplication.fa.Wa("AppUrl");
u.a.R4||u.a.Hg?this.Cm=this.Udi+this.Vdi:u.a.ap&&(k.AFrameworkApplication.fa.pa("UseAppAndroidMarketURL")?(h.ULS.sendTraceTag(523534414,306,100,"OpenInAppDialogReact: Using app android market url"),this.Cm=k.AFrameworkApplication.fa.Wa("WildFireMarketUrlExcelAndroid")):u.a.mBb?this.Cm=k.AFrameworkApplication.fa.Wa("WildFireUrlChinaStoreAndroid"):4<u.a.IYc.mOa&&(this.Cm=k.AFrameworkApplication.fa.Wa("WildFireUrlExcelAndroid")))}mGc(){h.ULS.sendTraceTag(523534413,306,50,"OpenInAppDialogReact: OpenInAppForLiveFiles API invoked");
d.TaskExtensions.za(f.GetServiceTaskFactory.Oa(this.$.da,21,137,1),Ka=>{let ub={};ub[ka.a.IKf]=this.$la;ub[ka.a.Cm]=this.Cm;Ka.result.jj("UI_OpenInMobileApp",ub)},this.$.la)}ig(){h.ULS.sendTraceTag(523534412,0,50,"initializeAndShowDialog: React Edit in app dialog opened.");const Ka=new ca.StandardDialog;Ka.Ob=0;Ka.tc(1,P.a.instance.ga(667));Ka.Wl(P.a.instance.ga(665),P.a.instance.ga(666),0,this.xqg)}}Object(r.a)(Ca,"OpenInAppDialogReact",null,[]);L=a(285);class fb extends L.a{constructor(Ka){super(Ka);
this.sessionId=Ka.ya.UserSessionId;this.VYg=Ka.ya.BuildVersion}get kc(){return"WACSessionIdDialog"}HM(){return{[fb.Qwj]:P.a.instance.ga(668),[fb.Rwj]:this.sessionId,[fb.id]:"WACSessionIdDialog",[fb.i0c]:P.a.instance.ga(669),[fb.buildVersion]:this.VYg}}ig(){const Ka=this.HM();this.Ob=5;this.initializeAndShow(P.a.instance.ga(1025),this.l6j.bind(this),Ka)}l6j(){h.ULS.sendTraceTag(521434688,306,100,"Show WACSessionIdDialogHandler invoked")}}fb.id="id";fb.Qwj="sessionIdLabel";fb.Rwj="sessionIdValue";fb.i0c=
"buildLabel";fb.buildVersion="buildVersion";Object(r.a)(fb,"WACSessionIdDialog",L.a,[]);var yb=a(28),mb=a(29),nb=a(359),X=a(11),R=a(189),wa=a(282),na=a(21),Ba=a(45),Ra=a(253),qa=a(383),La=a(290),Yb=a(52),mc=a(6),Zb=a(147),qb=a(989),Ha=a(82),Ya=a(36),Gb=a(303),Ja=a(256);class Na{pQ(Ka,ub){Ka=mb.a.ed(12,1,670,0,0,0,"Blank");Ka.Description=String.format(P.a.instance.ga(671),ub);return Ka}qbc(Ka){switch(Ka){case 1:case 2:return 0;default:return 2}}}Object(r.a)(Na,"ReloadCloseConfirmation",null,[126]);
var Qa=a(154),Oa=a(593),bb=a(73),Ga=a(55),tb=a(382),wb=a(33);class lb extends v.a{constructor(Ka,ub,Kb,W){super();this.$=Ka;this.businessBar=W;this.openInExcelOperation=ub;this.PJ=Kb}get Xb(){return this.$.ea.Xb}get workbookContext(){return this.$.workbookContext}get x8b(){return this.$.workbookContext.FullDocumentInfo}get clientWorkflow(){return bb.a(this.$)}get $b(){return this.$.$b}Qbi(){var Ka,ub;return null!==(ub=null===(Ka=this.$.workbookContext.LoadBlockingFloatingObjectsInfo)||void 0===Ka?
void 0:Ka.LoadBlockType)&&void 0!==ub?ub:!1}Hc(){return!1}executeCommand(Ka,ub,Kb,W){const za=this.x8b,Sa=this.$,Wa=ub.command,ab=this.openInExcelOperation,ma=this.$.Bb,ha=Kb.SourceControlId;Sa.Uk.vpe(Wa);ab.Gyc(ub.startTime.getTime().toString());Ka=null;switch(Wa){case 1455037301:this.$.d5?ab.dGe():ab.F4c();break;case -2044628748:case 2004484710:this.$.d5?ab.dGe():ab.openInExcelClient();break;case 213236505:"ContextMenu.ShowOpenInAppDialogOnMobile"===ha?(this.SDb("CellLongPress"),h.ULS.sendTraceTag(576495705,
0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from cell long press")):(this.SDb("PencilIcon"),h.ULS.sendTraceTag(576495704,0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from pencil icon in toolbar"));this.showOpenInAppDialog();break;case 924877417:h.ULS.sendTraceTag(520372316,0,50,"User clicked the reload button");const eb=bb.a(this.$).gd.activityState;Ba.a(Sa).vr(new Ra.a(mc.a.hw,5,()=>{eb[Ja.a.Dp]=mc.a.Fi}));break;case 480922297:Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowWacSessionIdDialogOnMobile",
!1)&&(new fb(this.$)).ig();break;case -2028960985:ab.hbg();break;case -1059172980:new ba(ab.Jye(Wa),new Y(ab,Sa.qb));break;case -1285148982:this.clientWorkflow.gd.activityState[Ya.a.kWc]=!0;this.WCc(!1);break;case -75280711:this.WCc(!1);break;case -455164169:this.WCc(!0);break;case -1388494670:this.$.da.gb(400,kb=>{kb.MGi();this.WCc(!1)});break;case 810888577:k.AFrameworkApplication.qk=(new Date).getTime();h.ULS.sendTraceTag(537162656,0,50,`FileOperationsCommandHandler.ExecuteCommand: Set AccessTokenTtl to ${k.AFrameworkApplication.qk}`);
break;case -1804063550:case -974518828:ub=0;x.a.YEd in Kb&&(ub=Kb[x.a.YEd]);ab.CKf(Wa,ub);break;case -1339961039:ub=!1;Kb&&x.a.UKb in Kb&&(ub=Kb[x.a.UKb]);this.reloadWorkbook(!1,ub);break;case -8805455:const ta=this.workbookContext;if(Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CleanLoadBlockingFloatingObjects",!1)&&this.Qbi()&&wb.a.Ad(this.$)){const kb=f.GetServiceTaskFactory.Oa(this.$.da,522,523,0);d.TaskExtensions.za(kb,()=>{kb.result.dL()},this.$.la,3)}else Sa.isEditMode||(lb.yDe(Sa),
Ka=d.TaskExtensions.za(this.PJ.value,kb=>{kb=kb.result;var jb=kb.isEnabled();jb&&M.a(kb,t.a.copyAndEdit,D.a.pg.P1e(),this.$.ea.wg.get(2))?h.ULS.sendTraceTag(537162655,0,50,"FileOperationsCommandHandler.ExecuteCommand: ReloadInEditMode ribbon command was procesed through SendMessageIfOptionSet()"):jb&&k.AFrameworkApplication.qlg?(jb={},jb[l.a.UHd]=k.AFrameworkApplication.userSessionId,jb[k.AFrameworkApplication.cJi]=yb.a.Ya.Ub.getTime().toString(),h.ULS.sendTraceTag(537162654,0,50,"FileOperationsCommandHandler.ExecuteCommand: processing ReloadInEditMode ribbon command whike UseEditModePostMessage flag is ON"),
kb.jj(t.a.editMode,jb)):za.CopyAndEditUrl?this.oah():(this.$b.supportsEditing||ta.EditUrl)&&this.reloadWorkbookInEditMode()},this.la,3));break;case -723527778:Sa.isEditMode&&(lb.yDe(Sa),this.reloadWorkbookInViewMode());break;case 1783960667:case -1355155015:const ya=Sa.oa.xa.Wb(),sb=-1355155015===Wa?1:0,Qb=()=>new O(sb);Ka=S.a(this.$.userOperationManager,(kb,jb,Wb)=>E.y(Sa.oa.xa,sb,null,kb,jb,Wb,null,ya),kb=>new G.a(128,0,kb,void 0,Qb),ub);na.h(Sa).Gg.iM(!1);break;case -1158102843:Ka=na.h(Sa).Gg.recalcSheet(ub);
na.h(Sa).Gg.iM(!1);break;case -988468372:if(Da.EwaSettings.ra(269))if(W=parseInt(Kb[I.a.Kc],10),0<=W&&3>W)this.setCalculationMode(ub,W);else return h.ULS.sendTraceTag(537162652,0,10,`SetCalculationMode , unexpected menuItemId: ${Kb[I.a.Kc]}`),R.a(Wa);break;case 257398710:B.a.ntw(za.ReportAbuseUrl,Sa);break;case 1800405051:this.ssj();break;case -48469327:this.saveACopy();break;case 214430355:ub=!1;Kb&&x.a.E9c in Kb&&(ub=Kb[x.a.E9c]);if(!this.mGj(ub,Kb))break;k.AFrameworkApplication.W4?this.businessBar.ih(42,
null):this.businessBar.ih(ub?22:23,null);break;case 1389557314:Ka=d.TaskExtensions.za(this.PJ.value,kb=>{M.a(kb.result,t.a.mGh,null,this.$.ea.wg.get(6))||B.a.ntw(za.FileVersionUrl,Sa)},this.la,3);break;case 2145659238:this.closeWorkbook();break;case 1773624819:ha===ma+x.a.uof?ab.ozi():ab.nzi();break;case 512141517:ha===ma+x.a.tof?ab.wzi():ab.vzi();break;case -1224038235:const oc=n.a.On in Kb?!Kb[n.a.On]:H.j(Sa.ea.workbookContext.Options);Kb[n.a.Description]=oc?P.a.instance.ga(570):P.a.instance.ga(571);
Ka=S.a(this.$.userOperationManager,(kb,jb,Wb)=>Z(this.$.oa.xa,!oc,kb,jb,Wb,null),kb=>new G.a(129,0,kb),ub);break;case 1118926154:if(this.$.isEditMode){const kb=new y.a;this.$.da.gb(53,jb=>{jb?(jb.pp.gzi(this.$.Bb+x.a.xud),kb.setResult(!0)):h.ULS.sendTraceTag(537162649,0,50,"Ignoring RibbonCommand.LaunchFileMenuShortcut, the ribbonManager is null.")});Ka=kb.task}break;case -1698025133:ab.openInBrowser();break;case 520859864:Ka=d.TaskExtensions.za(f.GetServiceTaskFactory.Oa(this.$.da,393,394,W.f4()),
kb=>{kb.result||h.ULS.sendTraceTag(537162648,0,10,"FileMenuCommandHandler::ExecuteCommand Failed to create SaveToHostManager")},this.$.la,3);break;default:Ka=R.a(Wa)}return Ka||Ga.Task.Sa(!0)}SDb(Ka){if(X.HelperMethods.RZ){const ub=new Map;ub.set("EntryPoint",Ka);z.Health.instance.recordKpiUsage(La.a.g2i,0,qa.a.QIi,ub)}else h.ULS.sendTraceTag(537162647,0,15,"FileOperationsCommandHandler.LogUsageKpiOpenInAppDialog: KPI Usage not supported")}showOpenInAppDialog(){k.AFrameworkApplication.isMobileMode&&
(this.$.ya.IsMeetingLiveSession&&Da.EwaSettings.isChangeGateEnabled("OfficeVSO:7492428_OpenInAppExcelReactDialogChangegate")?(h.ULS.sendTraceTag(522859990,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app React dialog used"),(new Ca(this.$)).ig()):Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseOpenInAppDialogCopyMobile",!1)?(h.ULS.sendTraceTag(574993315,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app dialog used"),(new Fa(this.$)).ig()):
(h.ULS.sendTraceTag(574993314,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: Git-side open-in-app dialog used"),k.AFrameworkApplication.showOpenInAppDialog()))}mGj(Ka,ub){return k.AFrameworkApplication.isMobileMode&&!U.a(this.$.ya,29)?(this.showOpenInAppDialog(),h.ULS.sendTraceTag(577300448,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: Open-in-app dialog invoked from cell double tap"),this.SDb("CellDoubleTap"),h.ULS.sendTraceTag(537162646,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view in mobile browser "),
!1):k.AFrameworkApplication.Kic&&(Ka&&nb.c(this.workbookContext.WorkbookFileName)||!this.workbookContext.FullDocumentInfo.HostEditUrl)?(h.ULS.sendTraceTag(537162645,0,50,`FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view a non-editable format .${nb.d(this.workbookContext.WorkbookFileName)?"xls":"csv"}, HostEditUrl ${this.workbookContext.FullDocumentInfo.HostEditUrl?"not ":""}empty. Skipped prompt to edit`),!1):w.a.any([25,26,30,31,57,32,34],Kb=>this.businessBar.Jka(Kb))?
(h.ULS.sendTraceTag(537162644,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view after opening in Edit by default"),!1):ub&&x.a.s$i in ub&&!Ka?!1:!0}wc(Ka,ub){Ka=!1;switch(ub.command){case 1455037301:case -2044628748:case 2004484710:case -2028960985:case -974518828:case -1339961039:case -8805455:case -723527778:case 1783960667:case -1158102843:case -1355155015:case 257398710:case 214430355:case 1389557314:case 2145659238:case 1773624819:case 512141517:case 1118926154:case -1698025133:case 213236505:Ka=
!0;break;case 480922297:case 520859864:Ka=Da.EwaSettings.isChangeGateEnabled("OfficeVSO:3773098_SaveDeferredActionDispatcherEnabled")?!0:!1;break;case 924877417:Ka=tb.a.grd?!0:!1;break;case -1285148982:case -75280711:case -455164169:Ka=Da.EwaSettings.ra(106);break;case -1388494670:Ka=Da.EwaSettings.ra(106);break;case 810888577:Ka=Da.EwaSettings.ra(243);break;case -1224038235:Ka=this.$.ea.amIAlone;break;case -988468372:Ka=Da.EwaSettings.ra(269);break;case -1804063550:case -1059172980:case 1800405051:case -48469327:Ka=
!0,h.ULS.shipAssertTag(537162642,0,this.$.Gka,"Command execute requested for SaveAs or Copy operation when data duplication is disallowed.")}return Ka}Nc(){return!1}ssj(){if(this.Xb){var Ka=this.$;Ba.a(Ka).vr(new Ra.a(mc.a.hw,5,()=>{Ka.YH(!1,!0);const ub=this.clientWorkflow.gd.activityState;ub[Ja.a.Dp]=mc.a.Kda;ub[Zb.a.jT]=2;ub[Ya.a.Kr]=Ka.isEditMode;ub[Zb.a.Dga]=!1}))}}saveACopy(){if(this.Xb){var Ka=this.$;Ba.a(Ka).vr(new Ra.a(mc.a.hw,5,()=>{Ka.YH(!1,!1);const ub=this.clientWorkflow.gd,Kb=ub.activityState;
Kb[Ja.a.Dp]=mc.a.I0f;Kb[Oa.a.e_b]=this.$b.hasUnsupportedFeaturesForEdit;Kb[Zb.a.Dga]=!1;ub.Yq(mb.a.L3(this.businessBar.V9c,[-502303485]))}))}}WCc(Ka){Ba.a(this.$).vr(new Ra.a(mc.a.Dna,2,()=>{this.$.YH(!0,!0);var ub=bb.a(this.$).gd,Kb=this.$.isEditMode;Kb=mb.a.ed(1,1,0,0,0,Kb?-315732528:-2087635043,Kb?"DeploymentInvalidEditSession":"InvalidOrTimedOutSession");Kb.ForceVersionUpgrade=Ka;ub.Yq([Kb]);ub=bb.a(this.$).gd.activityState;ub[Ja.a.Dp]=mc.a.Dna;ub[Ya.a.Kr]=this.$.isEditMode;ub[Zb.a.Dga]=!1}))}closeWorkbook(){if(this.Xb){var Ka=
this.$;D.a.pg.kzc("2145659238")?d.TaskExtensions.za(this.PJ.value,ub=>{ub.result.jj(t.a.kXe,{})},this.la,3):Ba.a(Ka).vr(new Ra.a(mc.a.hw,5,()=>{Ka.YH(!0,!1);const ub=this.clientWorkflow.gd.activityState;ub[Zb.a.aY]=!1;ub[Zb.a.Dga]=!1;this.$b.inViewerFromWebPart?(N.a.JId(Ka,this.clientWorkflow.gd),Ka.Uk.Ly("InViewerFromWebPart"),ub[Ja.a.Dp]=mc.a.r_):(ub[Ja.a.Dp]=mc.a.Kj,Ka.qd&32?ub[Zb.a.jT]=0:(ub[Zb.a.jT]=1,ub[Zb.a.UZb]=new qb.a),ub[Qa.a.Rne]=!0)}))}}oah(){const Ka=this.$b.vbaRemovedDuringConversion;
h.ULS.sendTraceTag(537162636,0,50,`FileOperationsCommandHandler.CopyAndEditWorkbook: vbaRemovedDuringConversion = ${Ka}`);const ub=this.$;Ka?Ba.a(ub).vr(new Ra.a(mc.a.hw,5,()=>{const Kb=mb.a.ed(3,0,0,1264,0,1069271157,"XLSMacroFailure");this.clientWorkflow.gd.Yq([Kb]);this.clientWorkflow.gd.activityState[Ja.a.Dp]=mc.a.Pfb})):k.AFrameworkApplication.hideHeader?X.HelperMethods.gf(this.x8b.CopyAndEditUrl,"_blank",void 0,"FileOperationCommandHandler.CopyAndEditUrl"):B.a.ntw(this.x8b.CopyAndEditUrl,ub)}reloadWorkbookInEditMode(){if(this.Xb)if(D.a.pg.lV&&
D.a.pg.sKd(),k.AFrameworkApplication.Kic&&!k.AFrameworkApplication.Lba)X.HelperMethods.gf(this.$.qqb(!0),C.a.blank,void 0,"FileOperationCommandHandler.BuildHostUrl");else{var Ka=this.$,ub=!1,Kb=this.$b.hasUnsupportedFeaturesForEdit,W=this.workbookContext.FileWasRepaired;nb.d(this.workbookContext.WorkbookFileName)?(ub=!0,h.ULS.sendTraceTag(537162634,0,50,`FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an XLS file, unsupported features = ${Kb}`)):nb.a(this.workbookContext.WorkbookFileName)&&
(ub=!0,h.ULS.sendTraceTag(537162633,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an CSV file"));var za=Ka.$d.get(59);za=!(Ka.ea.$b.supportsEditing&&za);if(ub&&!Kb||za&&(ub||Kb)){let Sa;Sa=za?Kb?-2066104278:816071846:Da.EwaSettings.isChangeGateEnabled("OfficeVSO:4035916_RemoveConvertInTeams")&&U.a(this.$.ya,25)&&!this.$.WBb?765011943:-213064907;ub=()=>{const Wa=mb.a.C_a([Sa]);this.clientWorkflow.gd.Yq(Wa);this.clientWorkflow.gd.activityState[Ja.a.Dp]=mc.a.Pfb}}else ub=()=>
{Ka.YH(!0,!1);var Sa=this.clientWorkflow.gd;const Wa=Sa.activityState;Wa[Zb.a.jT]=1;Wa[Gb.a.ZZb]=m.a.qnc;Wa[Ya.a.Kr]=!0;Wa[Oa.a.e_b]=this.$b.hasUnsupportedFeaturesForEdit;Wa[Zb.a.Dga]=!!this.workbookContext.EditUrl;Wa[Ha.a.d2]=this.workbookContext.EditUrl;if(!this.x8b.CopyAndEditUrl){const ab=[Da.EwaSettings.isChangeGateEnabled("OfficeVSO:4035912_RemoveEditACopyInTeams")&&U.a(this.$.ya,25)&&!this.$.WBb?-943219229:1821390342];Sa.Yq(mb.a.L3(this.businessBar.V9c,ab))}W&&!Kb?(nb.b(this.workbookContext.WorkbookFileName)&&
Da.EwaSettings.isChangeGateEnabled("OfficeVSO:5693008_CGForFlightODFRepairEnabled")?(Sa=mb.a.C_a([-425642652]),h.ULS.sendTraceTag(537162631,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an .ods file")):Sa=mb.a.C_a([108482388]),this.clientWorkflow.gd.Yq(Sa),Wa[Ja.a.Dp]=mc.a.W0f):this.$.ea.hbf?(h.ULS.sendTraceTag(546111811,0,50,"Password-To-Modify Workbook: User trying to switch to edit-mode."),Yb.b().CWd("DialogShown","Password-To-Modify Workbook: Logging StopWatch duration after user tries to switch to exclusive edit-session",
"PasswordToModifyDialogShown"),Wa[Ja.a.Dp]=mc.a.KHb):Wa[Ja.a.Dp]=this.$.ea.vic?mc.a.vDb:mc.a.Pfb};Ba.a(Ka).vr(new Ra.a(mc.a.hw,5,ub))}}reloadWorkbookInViewMode(){if(this.Xb){D.a.pg.lV&&D.a.pg.sKd();var Ka=this.$;u.a.Hg&&na.h(Ka).Vb.textBox.blur();Ba.a(Ka).vr(new Ra.a(mc.a.hw,5,()=>{Ka.YH(!Ka.ea.isNamedObjectViewMode,!1);const ub=this.clientWorkflow.gd.activityState;ub[Ja.a.Dp]=mc.a.Gha;ub[Zb.a.jT]=1;ub[Zb.a.aY]=!0;ub[Ya.a.Kr]=!1;ub[Ya.a.Lnb]=!0;ub[Gb.a.ZZb]=m.a.qnc}))}}reloadWorkbook(Ka,ub){if(this.Xb){var Kb=
this.$;Kb.CU&65536&&Ba.a(Kb).vr(new Ra.a(mc.a.hw,5,()=>{Kb.YH(Ka,!0);const W=this.clientWorkflow.gd.activityState;W[Ja.a.Dp]=mc.a.Sy;W[Ya.a.nWc]=this.workbookContext.NovMode;ub||(W[Zb.a.jT]=1,W[Zb.a.UZb]=new Na)}))}}setCalculationMode(Ka,ub){h.ULS.sendTraceTag(537162629,0,50,`SetCalculationMode ,calculation mode chosen : ${ub} `);const Kb=this.$.ea.workbookContext.CalcMode;this.$.ea.workbookContext.CalcMode=ub;const W=()=>new ra(ub);return S.a(this.$.userOperationManager,(za,Sa,Wa)=>ea(this.$.oa.xa,
ub,wa.b(za,lb.YZi(this.$,Kb)),wa.a(Sa,lb.XZi(this.$,Kb)),Wa,null),za=>new G.a(197,0,za,void 0,W),Ka)}static yDe(Ka){Ka.qb&&0<Ka.qb.oR&&Ka.qb.ybd(ub=>{ub.dv()})}static YZi(Ka,ub){return Kb=>{mb.a.Wf(Kb.Errors)&&(Ka.ea.workbookContext.CalcMode=ub,h.ULS.sendTraceTag(537162628,0,50,`OnSetCalcModeSucess: successCallback was called with errors for SetCalculationMode. reverting calc mode to ${ub}.  Error id names: ${mb.a.nc(Kb.Errors)}`))}}static XZi(Ka,ub){return()=>{Ka.ea.workbookContext.CalcMode=ub;h.ULS.sendTraceTag(537162627,
0,50,`OnSetCalcModeFailure: failedCallback was called for SetCalculationMode. reverting calc mode to ${ub})`)}}}Object(r.a)(lb,"FileOperationsCommandHandler",v.a,[222]);var db=a(158);class Pa extends e.a{constructor(Ka){super(Ka)}hd(){const Ka=this.$,ub=[],Kb=f.GetServiceTaskFactory.create(Ka.da,56,this.la,this.Xa);ub.push(Kb);const W=f.GetServiceTaskFactory.Oa(Ka.da,5,4,this.Xa);ub.push(W);d.TaskExtensions.za(Ga.Task.aG(...ub),()=>{db.b(Kb)&&this.$c([new lb(Ka,Kb.result,new b.a(()=>f.GetServiceTaskFactory.create(Ka.da,
137,this.la,this.Xa)),W.result)])},this.la,0)}static ka(Ka){e.a.Md(94,new Pa(Ka))}}Object(r.a)(Pa,"FileOperationsCommandHandlerFactory",e.a,[]);a.d(F,"a",function(){return ja});const ja=()=>{c.a.Fa(Pa.ka)}},1195:function(r,F,a){var c=a(9);r=a(0);var b=a(226),e=a(8),f=a(19),d=a(67),h=a(63),l=a(5),k=a(31);class t{}t.nyh="ewa-resizehdr-row-hidden";t.myh="ewa-resizehdr-col-hidden";Object(r.a)(t,"CssClassNames",null,[]);var n=a(240),z=a(14),w=a(159),m=a(637),u=a(27),y=a(227),v=a(4),C=a(268),x=a(15),B=
a(68),H=a(127),I=a(41),U=a(140),S=a(24),G=a(51),D=a(12),E=a(74),N=a(1),M=a(96),L=a(11),aa=a(13),V=a(254),P=a(128),ba=a(377),Y=a(45),Z=a(34);class ea{constructor(Ja,Na,Qa,Oa,bb,Ga,tb){this.$va=Ja;this.LEb=Na;this.HOa=Qa;this.Lld=Oa;this.Tcb=bb;this.nnf=Ga;this.fbi=tb}}Object(r.a)(ea,"HeaderEventCachedInfo",null,[]);class ra{constructor(Ja){this.w9c=Ja}uGe(Ja){Ja=L.HelperMethods.wGd(Ja);return Math.max(0,Math.min(ra.qvf,Ja))}kGe(Ja){return this.Y5i(Ja)}N6g(Ja){return Math.round(this.w9c*Ja+2*this.x2e()+
1)}Y5i(Ja){return Math.max(0,Math.min(ra.Wuf,(Math.max(0,Math.min(e.a.Rmc,Ja))-2*this.x2e()-1)/this.w9c))}x2e(){return Math.floor(Math.max((this.w9c+3)/4,2))}Scc(Ja,Na){return Na?Ja?ra.qvf:e.a.Syd:Ja?ra.Wuf:e.a.Rmc}}ra.qvf=409;ra.Wuf=255;Object(r.a)(ra,"ResizeHeadersConverter",null,[]);var O=a(183);class da extends M.a{constructor(Ja,Na){super(Na.domElement);this.EX=this.GZf=!1;this.ai=this.A8a=this.eBa=null;this.HNd=!0;this.zjc=!1;this.uLb=this.gl=this.offset=0;this.OM=this.ER=this.D0=null;this.ici=
"headerResizeTooltip";this.VF=this.cxd=null;this.d_c=this.FX=this.fAa=!1;this.bLf=this.gab=e.a.vwa;this.Mgf=N.EwaSettings.isChangeGateEnabled("OfficeVSO:6649809_AutoFitHiddenRowCol");this.XQb=!1;this.vN=Qa=>{if(this.grid.sj)return!1;Qa=Z.a(this.grid.$).me(Qa);if(3===Qa.vb&&!this.onf(Qa.Ea)||!this.cOf(Qa,!1))return!1;x.ULS.sendTraceTag(537154058,2,50,"HeaderResizeBehavior.OnMouseDown: About to generate tooltip");const Oa=this.cAc();this.Ied(Qa.clientPoint,Oa,!0);this.fAa||(n.a.instance.ta(z.a.yj,this.domElement.ownerDocument.body,
this.t$a),w.a.instance.ta(z.a.Tf,this.domElement.ownerDocument.body,this.t$a),this.fAa=!0);this.gjf()&&this.EX&&this.Jdf(Qa);return!1};this.bGb=Qa=>{Qa=Z.a(this.grid.$).me(Qa);this.gjf()&&this.d_c&&this.Jdf(Qa);if(!Qa.Ea.type.includes("touch")&&Qa.Ea.button!==Sys.UI.MouseButton.leftButton||!this.QBb)return!1;E.g(Qa.Ea);this.MPe();Qa=this.grid.sj?this.gab:e.a.vwa;var Oa=!1;if(this.grid.sj&&this.ai){var bb=Qa!==this.gl||!this.Mgf&&this.FX;N.EwaSettings.isChangeGateEnabled("OfficeVSO:7021389_removeHiddenCellFromModelFix")&&
!bb&&this.XQb&&(this.fe.removeRowColFromModel(this.ai.qnb,this.ai.DUf),Oa=!0,N.EwaSettings.tm()&&(this.fe.N7(this.grid.ha.qa.selectedRanges),this.fe.Vm("HeaderResizeBehavior::onDocumentMouseUp")))}else this.ai&&(Qa=this.FX?this.jgd():this.ai.b4()),bb=Qa!==this.gl;this.eBa&&bb&&Qa!==e.a.vwa?(Qa=this.grid,Oa=this.Did(Qa),bb={},bb.SheetMultiRange=I.r(Oa,Qa.$),da.eSd(bb,this.isRow,this.gl),N.EwaSettings.Zod()&&this.grid.sj&&(Oa=bb.SheetMultiRange.Ranges[0],x.ULS.sendTraceTag(509694147,2,50,`HeaderResizeBehavior.OnDocumentMouseUp: cellAbsoluteIndex=${this.ai?
this.ai.qnb:-1}, isResizingHiddenHeader=${this.FX}, headerViewBlockHashCode=${this.fe.hashCode},
          rangeFirstRow=${Oa.FirstRow}, rangeFirstColumn=${Oa.FirstColumn}, rangeLastRow=${Oa.LastRow}, rangeLastColumn=${Oa.LastColumn},`)),this.Bsh(bb),Qa.zQj=!0):(!N.EwaSettings.tm()&&Oa&&(N.EwaSettings.isChangeGateEnabled("OfficeVSO:7094259_fixSelectionBugAfterRehideRowCol")&&this.fe.N7(this.grid.ha.qa.selectedRanges),this.fe.Vm("HeaderResizeBehavior::onDocumentMouseUp")),this.Xg(null,null),this.HJb());return this.XQb=this.FX=!1};this.yca=Qa=>{if(this.grid.sj)return!1;Qa=m.a.create(Qa.eventName,
Qa.Mb,Qa.Ea,Qa.vb);Qa=Z.a(this.grid.$).me(Qa);if(!this.cOf(Qa,!0))return!1;Qa=this.grid;var Oa=this.Did(Qa);Oa=I.r(Oa,Qa.$);Qa.Cb.Nj([this.isRow?13:14]);Qa.Cb.GSa();this.HJb();Qa.$.Yc(this.isRow?146338636:1391094586,B.a.zb,30,{["autoFitRanges"]:Oa});return!1};this.cEf=Qa=>{this.EX?(this.FX&&!this.XQb&&(this.lJg(),N.EwaSettings.tm()&&this.fe.Vm("HeaderResizeBehavior::onHeaderResizeChanged")),this.zjc||this.Wef(),Qa=new Sys.UI.DomEvent(Qa),Qa=m.a.create(z.a.iha,this.domElement,Qa,2),Qa=Z.a(this.grid.$).me(Qa),
this.rDd(Qa.clientPoint)):x.ULS.sendTraceTag(521480320,2,50,`HeaderResizeBehavior.onHeaderResizeChanged: Reached during no resize mode. cellAbsoluteIndex = ${this.ai?this.ai.qnb:-1}, isRow = ${this.isRow}`)};this.dEf=Qa=>{Qa=new Sys.UI.DomEvent(Qa);Qa=m.a.create(z.a.iha,this.domElement,Qa,2);this.bGb(Qa)};this.WUi=Qa=>{this.Fya(Qa,this.ai,!1)};this.t$a=Qa=>{Qa=Z.a(this.grid.$).me(Qa);E.g(Qa.Ea);return this.rDd(Qa.clientPoint)};this.UH=Qa=>{if(this.grid.sj)return!1;Qa=Z.a(this.grid.$).me(Qa);let Oa;
if((N.EwaSettings.isChangeGateEnabled("OfficeVSO:7409830_AllowResize")?!this.grid.isResizeAllowed(this.isRow):!this.isResizeAllowed)||-1!==this.grid.ha.selectionType)return Y.a(this.grid.$).ep()&&(Oa=this.Zgd(Qa))&&(Oa.$va.style.cursor=""),!1;if(this.EX)return this.Wef(),!1;Oa=this.Zgd(Qa);if(!Oa)return!1;Oa.$va.style.cursor=!this.grid.fb&&this.kud(Oa)?this.isRow?"row-resize":"col-resize":"";E.g(Qa.Ea);return!0};this.tr=()=>{this.HJb()};this.Xg=()=>{if((3===B.a.zb||u.a.fp)&&this.grid.ha.qa.Tg){var Qa=
this.grid.ha.qa.ld;if(!(!Qa.isRow&&!Qa.Rg||!this.domElement||Qa.isRow&&this.isRow&&!this.fe.qt.includes(Qa.top)||Qa.Rg&&!this.isRow&&!this.fe.qt.includes(Qa.left))){var Oa=this.grid.xg(Qa,this.fe.$i.paneType);if(Oa){if(this.grid.sj){const bb=this.isRow?Qa.bottom:Qa.right;this.ai=this.fe.Vr(S.Range.Mc(Qa.bottom,Qa.right));if(!this.ai){x.ULS.sendTraceTag(522826880,2,50,`HeaderResizeBehavior.onSelectionEnded: Cell being resized is undefined. Couldn't create touch resizer. Absolute index ${bb}, is row ${this.isRow}`);
return}}this.VF||this.Nhh();Qa.isRow&&this.isRow?(D.DOMElementExtensions.setVisible(this.VF,!0),this.VF.style.top=Oa.bottomRight.y-this.VF.offsetHeight/2+"px"):Qa.isRow||this.isRow||(D.DOMElementExtensions.setVisible(this.VF,!0),V.c(this.VF.style,this.grid.rtl,Oa.bottomRight.x-this.VF.offsetWidth/2+"px"))}}}};this.pF=(Qa,Oa)=>{N.EwaSettings.isChangeGateEnabled("OfficeVSO:6385697_HeaderResize_LogOnPartialInteractivityStatusChanged")&&x.ULS.sendTraceTag(521787422,2,50,`HeaderResizeBehavior.onPartialInteractivityStatusChanged: was called. isActivated ${Oa.OL}`);
Oa.OL&&this.Uqb()};this.fe=Na;this.isRow=Na.isRow;this.rtl=Na.$i.rtl;this.grid=Ja;this.Zuf=this.isRow?e.a.Syd:e.a.Rmc;this.dci=aa.a.instance.ga(435);this.mci=aa.a.instance.ga(434);this.gci=aa.a.instance.ga(436);P.a(this.grid.$,Qa=>{this.cxd=Qa.NP(H.a.vpj,!1)});this.Hfj();this.grid.ha.rT(this.Xg);this.grid.ha.z9(this.tr);this.grid.Uu(this.Xg);Y.a(this.grid.$).Sf.y9(this.pF)}get QBb(){return this.EX}get isResizeAllowed(){const Ja=(new U.a(this.grid.$.va)).Pd(this.isRow?16:8),Na=this.grid.$.qb.uv,Qa=
this.grid.Vh,Oa=Y.a(this.grid.$).ep();return Ja&&!Na&&!Qa&&!Oa}get xpj(){this.kth();return da.Ucb}Fya(Ja,Na,Qa){var Oa=new Sys.UI.DomEvent(Ja);Oa=m.a.create(z.a.iha,this.domElement,Oa,2);Oa=Z.a(this.grid.$).me(Oa);this.bOf(Na,Oa.clientPoint.x,Oa.clientPoint.y,!1,Qa,Ja);Ja=this.cAc();this.Ied(this.eBa,Ja,!0);this.fAa||(Ja=this.domElement.ownerDocument.body,Ja.addEventListener(z.a.iha,this.cEf),Ja.addEventListener(z.a.UGa,this.dEf),this.fAa=!0)}UUi(Ja,Na,Qa){this.bOf(Na,Ja.clientX,Ja.clientY,!0,this.Mgf?
Qa:!1,Ja);Ja=this.grid;Na=this.Did(Ja);Na=I.r(Na,Ja.$);Ja.Cb.Nj([this.isRow?13:14]);Ja.Cb.GSa();this.HJb();Ja.$.Yc(this.isRow?146338636:1391094586,B.a.zb,30,{["autoFitRanges"]:Na})}dispose(){this.E2c();this.grid.ha&&(this.grid.ha.AR(this.Xg),this.grid.ha.xda(this.tr));this.grid.my(this.Xg);Y.a(this.grid.$)&&Y.a(this.grid.$).Sf.vda(this.pF);y.a.instance.Ba(z.a.tk,this.domElement,this.yca);n.a.instance.Ba(z.a.Kf,this.domElement.ownerDocument.body,this.bGb);w.a.instance.Ba(z.a.ve,this.domElement.ownerDocument.body,
this.bGb);u.a.fp||(n.a.instance.Ba(z.a.pointerDown,this.domElement,this.vN),n.a.instance.Ba(z.a.yj,this.domElement,this.UH));this.fAa&&(n.a.instance.Ba(z.a.yj,this.domElement.ownerDocument.body,this.t$a),w.a.instance.Ba(z.a.Tf,this.domElement.ownerDocument.body,this.t$a),this.fAa=!1);this.VF&&(n.a.instance.Ba(z.a.pointerDown,this.VF,this.vN),y.a.instance.Ba(z.a.tk,this.VF,this.yca),this.E2c(),this.VF=null);this.GZf&&(D.DOMElementExtensions.vf(da.Ucb),da.Ucb=null);this.fe=null;super.dispose()}Hfj(){y.a.instance.ta(z.a.tk,
this.domElement,this.yca);n.a.instance.ta(z.a.Kf,this.domElement.ownerDocument.body,this.bGb);w.a.instance.ta(z.a.ve,this.domElement.ownerDocument.body,this.bGb);u.a.fp||(n.a.instance.ta(z.a.pointerDown,this.domElement,this.vN),n.a.instance.ta(z.a.yj,this.domElement,this.UH))}kth(){if(!da.Ucb){document.getElementById(da.FZf);this.GZf=!0;var Ja=da.Ucb=document.createElement("div");this.grid.$.frame.Paa().appendChild(Ja);Ja.id=da.FZf;Ja.className=k.a.oyh;D.DOMElementExtensions.setVisible(Ja,!1)}}MPe(){if(this.fAa){const Ja=
this.domElement.ownerDocument.body;this.grid.sj?(Ja.removeEventListener(z.a.iha,this.cEf),Ja.removeEventListener(z.a.UGa,this.dEf)):(n.a.instance.Ba(z.a.yj,Ja,this.t$a),w.a.instance.Ba(z.a.Tf,Ja,this.t$a));this.fAa=!1}this.EX=!1;N.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")?this.BVf():(this.j_f(),this.GLd());ba.c(this.grid.$,!0,"HeaderResizeBehavior:PrepareResizeOperation")}j_f(){this.grid.Cb.Nj([this.isRow?13:14]);this.grid.Cb.GSa()}lJg(){this.fe.addRowColToModel(this.ai.qnb-
1,this.ai.DUf);this.XQb=!0}rDd(Ja){if(!this.EX)return!1;const Na=this.isRow;if(!this.grid.sj&&!this.D0){this.D0=document.createElement("div");this.D0.style.cssText="position: relative; width: inherit; height: inherit;"+(Na?"top: 0px; ":this.rtl?"right: 0px:":"left: 0px:");for(var Qa=this.ai.OJ();Qa.nextSibling;)this.D0.appendChild(Qa.nextSibling);Qa.parentNode.appendChild(this.D0)}Qa=Na?Ja.y-this.A8a.y:(this.rtl?-1:1)*(Ja.x-this.A8a.x);const Oa=Na?Ja.y-this.eBa.y:(this.rtl?-1:1)*(Ja.x-this.eBa.x),
bb=this.grid.sj?this.gab:this.ai.b4();if(bb===e.a.vwa)return!1;Qa&&(0<this.gl||0<bb+Oa)&&bb+Oa<=this.Zuf&&(this.gl=this.cAc(Oa),this.Ied(Ja,this.gl,!1),this.grid.sj?this.gl>=da.Dbf?(this.HNd=!0,this.ai.setCellExtent(this.gl)):this.HNd&&(this.HNd=!1,this.ai.setCellExtent(da.Dbf)):(D.DOMElementExtensions.Ooa(this.ai.OJ(),!Na,Math.max(this.uLb+Oa,0)),this.D0.style[Na?"top":this.rtl?"right":"left"]=Math.max(Oa,-this.uLb)+"px"),Qa=(this.grid.sj?this.bLf:Na?this.ai.fe.gC:this.ai.fe.iC)+Math.max(Oa,this.grid.sj?
-this.gab+da.gec:-this.uLb),D.DOMElementExtensions.Ooa(this.ai.fe.domElement,!Na,Qa),this.grid.sj&&this.ai.fe.wxj(Qa),this.A8a=new Sys.UI.Point(Ja.x,Ja.y),D.DOMElementExtensions.setVisible(this.VF,!1));return!0}b4(){return this.ai?this.FX?da.tci:this.ai.b4():e.a.vwa}Ied(Ja,Na,Qa){this.OM&&Qa&&(x.ULS.sendTraceTag(537154051,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement already created, creating a new element instead"),this.GLd());this.OM||Qa||x.ULS.sendTraceTag(537154050,
2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement is null, creating a new element instead");this.cxd&&this.cxd(()=>({["Location"]:"canvas"}));this.OM?this.Q_e(Na):(this.OM=document.createElement("div"),this.OM.id=this.ici,this.Q_e(Na),this.OM.className=k.a.Swh,Na=document.getElementById(this.grid.$.Bb+l.a.Kwf),Na.insertBefore(this.OM,Na.firstChild),Ja=Z.a(this.grid.$).Mja(Ja),this.OM.style.left=(this.rtl?Math.max(Ja.x-this.OM.offsetWidth,0):Ja.x-Math.max(Ja.x+this.OM.offsetWidth-
Na.offsetWidth,0)).toString()+"px",Na=document.getElementById(l.a.isa),this.OM.style.top=(Ja.y-(v.AFrameworkApplication.sa&&v.AFrameworkApplication.sa.Qa.df?0:Na.offsetHeight)-this.OM.offsetHeight).toString()+"px")}GLd(){D.DOMElementExtensions.vf(this.OM);this.OM=null}Q_e(Ja){var Na=new ra(this.grid.$.workbookContext.DxDigitNormal);Na=this.isRow?Na.uGe(Ja).toFixed(2):Na.kGe(Ja).toFixed(2);this.OM.innerText=`${this.isRow?this.dci:this.mci} ${Na} (${Ja.toString()} ${this.gci})`}cOf(Ja,Na){let Qa;const Oa=
N.EwaSettings.isChangeGateEnabled("OfficeVSO:7409830_AllowResize")?this.grid.isResizeAllowed(this.isRow):this.isResizeAllowed;if(-1!==this.grid.ha.selectionType||2===Ja.vb&&Ja.Ea.button!==Sys.UI.MouseButton.leftButton||!this.kud(Qa=this.Zgd(Ja))||!Oa)return!1;E.g(Ja.Ea);this.eBa=this.A8a=new Sys.UI.Point(Ja.clientPoint.x,Ja.clientPoint.y);this.W_g(Qa,Na);if(!this.ai)return!1;this.EX=!0;this.tti(this.ai,Qa)&&this.igi();this.uLb=this.jgd();return this.dOf(Ja.Ea.rawEvent,Na)}bOf(Ja,Na,Qa,Oa,bb,Ga){this.EX=
!0;this.FX=bb;this.ai=Ja;this.zjc=!1;this.eBa=this.A8a=new Sys.UI.Point(Na,Qa);Ja=this.ai.getRange();this.ER=bb?this.wse(Ja):Ja;this.gab=this.b4();this.bLf=this.isRow?this.ai.fe.gC:this.ai.fe.iC;this.dOf(Ga,Oa)}dOf(Ja,Na){const Qa=N.EwaSettings.Zod()&&this.grid.sj?{["IsResizingHiddenHeader"]:this.FX,["IsAutoFitting"]:Na,["NumberOfSelectedRanges"]:this.grid.ha.qa.gD,["Location"]:"canvas",["ResizeRange"]:this.ER,["ResizedCellAbsoluteIndex"]:this.ai.qnb,["HeaderViewBlockHashCode"]:this.fe.hashCode}:
{["IsResizingHiddenHeader"]:this.FX,["IsAutoFitting"]:Na,["NumberOfSelectedRanges"]:this.grid.ha.qa.gD,["Location"]:"canvas"};P.b(this.grid.$).rd(H.a.mpj,Qa);this.grid.BHj&&(Na=Na?"header_resize_autofit":"header_resize_start",O.b(this.grid.$).IBa(Ja,Na,void 0));this.offset=this.ai.Xaa();this.gl=this.grid.sj?this.gab:this.ai.b4();if(this.gl===e.a.vwa)return!1;ba.c(this.grid.$,!1,"HeaderResizeBehavior:prepareResizeOperationInternal");return!0}tti(Ja,Na){var Qa=this.ai.OJ();if(!Qa)return x.ULS.shipAssertTag(537154049,
2,!1,"cell being resized element received is null"),!1;Qa=Qa.nextSibling;if(!Qa)return!1;Ja=Ja.getRange();Qa=this.fe.dva(Qa).getRange();if(!Ja||!Qa)return x.ULS.shipAssertTag(537154048,2,!1,"IsResizingHidden: range is null"),!1;Ja=this.isRow?Ja.bottom:Ja.right;Qa=this.isRow?Qa.bottom:Qa.right;return Ja+1!==Qa&&Ja!==Qa&&this.kud(Na,!0)}igi(){var Ja=this.ai.OJ();const Na=this.fe.dva(Ja.nextSibling);da.uti(Na,this.isRow)?(this.ai=Na,this.ER=this.ai.getRange()):(this.mJg(Ja),this.ai=Na,Ja=this.ai.getRange(),
this.ER=this.wse(Ja),this.FX=!0)}wse(Ja){return this.isRow?new S.Range(Ja.top-1,Ja.left,Ja.top-1,Ja.right,!1,!0):new S.Range(Ja.top,Ja.left-1,Ja.bottom,Ja.left-1,!1,!0)}mJg(Ja){const Na=this.fe.dva(Ja.nextSibling),Qa=da.Rdh(Na,this.isRow,this.rtl);Qa&&Ja.parentNode.insertBefore(Qa,Na.OJ())}Did(Ja){const Na=this.ER,Qa=Ja.ha.qa.selectedRanges;if(Ja.ha.qa.Wtb(Na))if(this.isRow){if(C.a.all(Qa,Oa=>Oa.isRow))return Qa}else if(C.a.all(Qa,Oa=>Oa.Rg))return Qa;return[Na]}getCellExtent(){return this.ai.getCellExtent()}jgd(){const Ja=
this.ai.OJ().style;return Math.max(0,Math.min(this.Zuf,0|parseInt(this.isRow?Ja.height:Ja.width,10)))}cAc(Ja=0){const Na=this.grid;var Qa=this.fe.$i.paneType;let Oa;Oa=this.isRow?3===Qa?[3,2]:[1,4]:4===Qa?[2,4]:[1,3];var bb=Math.max(this.grid.sj?this.gab:this.ai.b4(),0);Ja=this.FX&&!this.grid.sj?Math.max(this.jgd(),0):Math.max(bb+Ja,0);Qa=Na.JYh(Qa,this.isRow);Qa=this.isRow?new h.a(0,this.offset,Qa,Ja):new h.a(this.offset,0,Ja,Qa);bb=[this.isRow?13:14];Na.Cb.wk(new S.Range(1,1,e.a.Vg,e.a.Ug,!1,!0),
bb,!1);Na.Cb.Qq(bb,Qa,Oa);return Ja}E2c(){this.ER=this.eBa=this.A8a=null;if(this.D0){const Ja=this.D0.parentNode;if(Ja)for(Ja.removeChild(this.D0);this.D0.firstChild;)Ja.appendChild(this.D0.firstChild);this.D0=null}this.ai=null;this.EX=!1;N.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")||this.BVf()}BVf(){this.zjc=!1;this.GLd();D.DOMElementExtensions.setVisible(da.Ucb,!1);D.DOMElementExtensions.setVisible(this.VF,!1);N.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")&&
this.j_f()}Zgd(Ja){if(D.DOMElementExtensions.fz(Ja.Mb,"a"))return null;const Na=this.onf(Ja.Ea);if(Na&&this.grid.ha.qa.Tg){var Qa=this.grid.ha.qa.ld;Qa=this.fe.Vr(S.Range.Mc(Qa.bottom,Qa.right))}else Qa=this.fe.dva(Ja.Mb);if(!Qa)return null;const Oa=Qa.OJ(),bb=new Sys.UI.Bounds(Oa.offsetLeft,Oa.offsetTop,Oa.offsetWidth,Oa.offsetHeight);var Ga=D.DOMElementExtensions.getBoundingClientRect(Ja.Mb);Ga=new Sys.UI.Point(Ja.clientPoint.x-Ga.x,Ja.clientPoint.y-Ga.y);this.isRow&&!Na&&(Ga.y+=L.HelperMethods.PC(Ja.Mb,
Oa,this.rtl).y);return new ea(Oa,Ga,bb,Qa.getRange(),Math.max(da.MIi,Math.min(da.JHi,(this.isRow?bb.height:bb.width)*da.wpj)),Na,!this.isRow&&0<Oa.getElementsByTagName("input").length)}kud(Ja,Na=!1){if(!Ja||this.grid.fb)return!1;if(Ja.nnf)return!0;var Qa=Ja.HOa;const Oa=Ja.Tcb;var bb=this.fe.$i.paneType,Ga=this.grid.Rf(bb).hi,tb=!!Ga&&Ga.top===Ja.Lld.top,wb=!!Ga&&Ga.left===Ja.Lld.left;bb=!!Ga&&Ga.bottom===Ja.Lld.bottom&&(3===bb||2===bb);this.isRow?(wb=Ja.LEb.y,Ja=wb<=Oa&&!tb,Qa=wb>=Qa.height-Oa-(bb?
da.OKh:0),Na=Na?Ja:Qa||Ja):(bb=Ja.fbi,tb=this.rtl,Ga=Ja.LEb.x,Ja=Ga<=Oa&&(!wb||tb)&&(!bb||!tb),Qa=Ga>=Qa.width-Oa&&(!tb||!wb)&&(!bb||tb),Na=Na?tb?Qa:Ja:Ja||Qa);return Na}W_g(Ja,Na){const Qa=this.isRow;if(Ja.nnf)this.ai=this.fe.dva(Ja.$va);else if(Qa&&Ja.LEb.y<=Ja.Tcb&&Ja.HOa.height>Ja.Tcb||!Qa&&Ja.HOa.width>Ja.Tcb&&(!this.rtl&&Ja.LEb.x<=Ja.Tcb||this.rtl&&Ja.LEb.x>=Ja.HOa.width-Ja.Tcb)){if(this.ai=Ja.$va.previousSibling?this.fe.dva(Ja.$va.previousSibling):this.XXh(),Na&&Ja.$va.classList.contains(Qa?
k.a.IVe:k.a.HVe)&&(Ja=this.fe.dva(Ja.$va)))Ja=Ja.getRange(),this.ER=Qa?new S.Range(Ja.top-1,Ja.left,Ja.top-1,Ja.right,!1,!0):new S.Range(Ja.top,Ja.left-1,Ja.bottom,Ja.left-1,!1,!0)}else this.ai=this.fe.dva(Ja.$va);!this.ER&&this.ai&&(this.ER=this.ai.getRange())}XXh(){var Ja=this.isRow?1:0;return(Ja=this.fe.$i.JB(this.fe.$i.Ca.Fg(this.grid.$.na,d.a.pJ(this.fe.position.X+Ja-1,this.fe.position.Y-Ja,this.fe.position.PaneType))))?Ja.WXh():null}Wef(){this.zjc=!0;const Ja=this.xpj;D.DOMElementExtensions.setVisible(Ja,
!0);Ja.style.cursor=this.isRow?k.a.USe:k.a.xRe;this.cAc()}Bsh(Ja){this.grid.$.Yc(this.isRow?745189930:-445963340,B.a.zb,30,{["resizeRowColumnParameters"]:Ja})}Nhh(){const Ja=document.createElement("div");Ja.className=k.a.nzh;const Na=document.createElement("div");Na.className=f.a.Or;Ja.appendChild(Na);const Qa=document.createElement("img");Qa.src=G.a.qe(0);Qa.className=this.isRow?f.a.lyh:f.a.gyh;Na.appendChild(Qa);this.fe.sA.domElement.parentNode.insertBefore(Ja,this.fe.sA.domElement);this.grid.sj?
Ja.addEventListener(z.a.e$,this.WUi):(n.a.instance.ta(z.a.pointerDown,Ja,this.vN),y.a.instance.ta(z.a.tk,Ja,this.yca));D.DOMElementExtensions.setVisible(Ja,!1);this.VF=Ja}HJb(){this.E2c();this.VF&&(this.fe.sA.domElement.parentNode.removeChild(this.VF),this.VF=null)}onf(Ja){return D.DOMElementExtensions.Af(this.VF,Ja.target)}Uqb(){this.EX&&(N.EwaSettings.isChangeGateEnabled("OfficeVSO:6810003_HandleCancelResize")&&this.grid.sj&&this.rDd(this.eBa),this.MPe(),this.grid.sj||D.DOMElementExtensions.Ooa(this.ai.OJ(),
!this.isRow,this.uLb),this.HJb(),this.XQb=this.FX=!1)}gjf(){return N.EwaSettings.ra(587)}Jdf(Ja){(Ja=Ja.Ea.rawEvent)&&Ja.detail===da.iuj&&(Ja.type===z.a.lp?(this.EX=!1,this.d_c=!0):Ja.type===z.a.OH&&(this.EX=!0,this.d_c=!1))}static Ndh(Ja,Na){return new da(Ja,Na)}static eSd(Ja,Na,Qa){if(Na){Ja.ColumnWidth=-1;Ja.RowHeight=Qa;for(const Oa of Ja.SheetMultiRange.Ranges)Oa.FirstColumn=0,Oa.LastColumn=0}else{Ja.RowHeight=-1;Ja.ColumnWidth=Qa;for(const Oa of Ja.SheetMultiRange.Ranges)Oa.FirstRow=0,Oa.LastRow=
0}}static uti(Ja,Na){if(!Ja||!Ja.OJ())return x.ULS.shipAssertTag(537154014,2,!1,"header after hidden headers is null"),!1;const Qa=Ja.getRange();Ja=Ja.OJ().style;if(!Qa||!Ja)return x.ULS.shipAssertTag(537154013,2,!1,"header range or style is null"),!1;Ja=Na?Ja.height:Ja.width;return(Na?Qa.top:Qa.left)===(Na?e.a.Vg:e.a.Ug)&&Ja===da.dog}static Rdh(Ja,Na,Qa){if(!Ja)return x.ULS.shipAssertTag(537154012,2,!1,"header after hidden is null"),null;var Oa=Ja.OJ();if(!Oa||!Oa.style)return x.ULS.shipAssertTag(537154011,
2,!1,"header after hidden element or style is null"),null;Ja=document.createElement("div");const bb=Oa.style;Ja.style.top=Na?bb.top:da.dog;Na||(Qa?Ja.style.right=bb.right:Ja.style.left=bb.left);Ja.classList.add(Na?t.nyh:t.myh);Ja.classList.add(Na?k.a.bvb:k.a.avb);Qa=document.createElement("div");Qa.classList.add(Na?k.a.yVe:k.a.jbd);Oa=Na?Number.parseInvariant(Oa.innerText):S.Range.E0a(Oa.innerText);Qa.innerText=Na?(Oa-1).toString():S.Range.BP(Oa-1);Ja.appendChild(Qa);return Ja}}da.MIi=0;da.JHi=5;
da.gec=1;da.Dbf=1;da.tci=0;da.OKh=3;da.wpj=.1;da.FZf="ewa-rszrbg";da.dog="0px";da.iuj=2;da.Ucb=null;Object(r.a)(da,"HeaderResizeBehavior",M.a,[528]);class xa extends b.a{constructor(){super();this.Db()}create(){this.nb(da.Ndh)}static ka(Ja){Ja.da.Ha(136,new xa)}}Object(r.a)(xa,"HeaderResizeBehaviorFactory",b.a,[]);var ia=a(55),Ma=a(709),Ta=a(50),Da=a(37),fa=a(174),ua=a(427),Fa=a(376),ca=a(193),ka=a(249),Ca=a(282),fb=a(66),yb=a(21);class mb{constructor(Ja,Na){this.isRow=!1;this.autoFitRange=null;this.isRow=
Ja;this.autoFitRange=Na}}Object(r.a)(mb,"MacroRecorderSheetRowsColumnsAutoFitPayload",null,[162]);class nb{constructor(Ja){this.resizeParameters=null;this.resizeParameters=Ja}}Object(r.a)(nb,"MacroRecorderSheetRowsColumnsResizedPayload",null,[162]);var X=a(84);b=a(285);var R=a(22),wa=a(61);class na extends b.a{constructor(Ja,Na){super(Ja);this.mxb=Qa=>{Qa=this.nhd(Qa);return this.Aed(Qa)};this.npj=(Qa,Oa)=>{var bb=this.X7a=Oa[na.Zni];1===Qa?(Qa=Oa[na.gLj],bb=this.P8e(Qa,bb),x.ULS.shipAssertTag(537153996,
0,bb!==na.tba,`ResizeHeadersDialogHandler - invalid size input, size = ${Qa}`),Qa=bb!==this.Tnd,x.ULS.sendTraceTag(537153995,0,50,"ResizeHeadersDialog OK button pressed, isRow = {0}, isDefaultUnits = {1}, inputPx = {2}, inputChanged = {3}.",this.isRow,this.X7a,bb,Qa),Qa&&this.pbh(bb)):x.ULS.sendTraceTag(537153994,0,50,`ResizeHeadersDialog Cancel button pressed, isRow = ${this.isRow}.`)};this.isRow=2040891415===Na.command;this.gridView=yb.h(this.$);this.Rvc=new ra(this.$.workbookContext.DxDigitNormal);
this.Tnd=this.w0g();Ja=this.V$g(this.Tnd);Na=this.X$g(this.Tnd);this.el=aa.a.instance.ga(this.isRow?477:478);Ja=this.HM(Ja,Na);this.initializeAndShow(this.el,this.npj,Ja);x.ULS.sendTraceTag(537153997,0,50,`ResizeHeaders React Dialog opened, isRow = ${this.isRow}.`)}get kc(){return"ResizeHeadersDialog"}get X7a(){return na.ace}set X7a(Ja){na.ace=Ja}HM(Ja,Na){return{[na.YU]:this.kc,[na.Iti]:this.isRow,[na.Igi]:Ja,[na.Hgi]:Na,[na.sqi]:this.X7a,[na.mhd]:this.mxb}}w0g(){const Ja=this.aOh();try{return this.MSh(Ja)}finally{Ja&&
Ja.dispose()}}pbh(Ja){const Na={};Na.SheetMultiRange=I.r(this.gridView.ha.qa.selectedRanges,this.$);na.eSd(Na,this.isRow,Ja);this.$.Yc(this.isRow?745189930:-445963340,B.a.zb,8,{["resizeRowColumnParameters"]:Na})}P8e(Ja,Na){return R.a.Y4(Ja)?Na?this.U$g(Ja):this.W$g(Ja):na.tba}W$g(Ja){return Math.floor(parseFloat(Ja))}U$g(Ja){Ja=parseFloat(Ja);return 0>Ja?na.tba:Ja?this.isRow?L.HelperMethods.f6i(Ja):this.Rvc.N6g(Ja):0}X$g(Ja){return Ja===na.tba?"":this.isRow?this.Rvc.uGe(Ja).toString():this.Rvc.kGe(Ja).toFixed(2)}V$g(Ja){return Ja===
na.tba?"":Ja.toString()}MSh(Ja){if(!Ja||!Ja.$$mn()||!Ja.Nm)return na.tba;var Na=Object(X.a)(494,Ja.Nm);if(!Na)return na.tba;for(Na=this.isRow?Na.Nzb:Na.Rnd;Ja.$$mn();){const Qa=Object(X.a)(494,Ja.Nm);if(Qa&&(this.isRow?Qa.Nzb:Qa.Rnd)!==Na)return na.tba}return Na}aOh(){const Ja=[];for(const Qa of this.gridView.ha.qa.selectedRanges){const Oa=Qa.clone();var Na=this.gridView.Rf(this.gridView.ib.Ai(Oa));Na=Oa.we(Na.hi);if(!Na)return null;this.isRow?Oa.right=Oa.left=Na.left:Oa.top=Oa.bottom=Na.top;Ja.push(Oa)}return Ja.length?
this.gridView.O$("ResizeHeadersDialog.GetActiveRowColumnLoadedRangeEnumerator",Ja):null}nhd(Ja){if(!R.a.Y4(Ja))return 1;Ja=this.P8e(Ja,this.X7a);if(0===Ja)if(N.EwaSettings.isChangeGateEnabled("OfficeVSO:7428186_HideLastRowCol")){const Na=this.gridView.ha.qa.selectedRanges,Qa=this.gridView.Mj("ResizeHeaderDialog");if(Object(wa.c)(Qa)){if(!Qa.value.Yze(Na,this.isRow))return 3}else if(this.Nlf())return 3}else if(this.Nlf())return 3;return this.Dwi(Ja)?0:2}Nlf(){const Ja=this.gridView.ha.qa.selectedRanges;
return this.isRow&&I.P(Ja)||!this.isRow&&I.O(Ja)}Aed(Ja){let Na="";switch(Ja){case 0:Na="";break;case 1:Na=aa.a.instance.ga(766);break;case 2:Ja=this.X7a;Na=String.format(aa.a.instance.ob(99),0,this.Scc(Ja));break;case 3:Na=aa.a.instance.ga(767)}return Na}Dwi(Ja){return 0<=Ja&&Ja<=this.Scc(!1)}Scc(Ja){return this.Rvc.Scc(Ja,this.isRow)}static eSd(Ja,Na,Qa){if(Na){Ja.ColumnWidth=na.tba;Ja.RowHeight=Qa;for(const Oa of Ja.SheetMultiRange.Ranges)Oa.FirstColumn=0,Oa.LastColumn=0}else{Ja.RowHeight=na.tba;
Ja.ColumnWidth=Qa;for(const Oa of Ja.SheetMultiRange.Ranges)Oa.FirstRow=0,Oa.LastRow=0}}}na.YU="id";na.Iti="isRow";na.Igi="initialSizeInPx";na.Hgi="initialSizeInDefaultUnits";na.sqi="isInitialUnitsDefaultUnits";na.mhd="getInputErrorIfInvalid";na.gLj="size";na.Zni="isDefaultUnits";na.tba=-1;na.ace=!0;Object(r.a)(na,"ResizeHeadersDialog",b.a,[]);var Ba=a(60);const Ra=(Ja,Na,Qa,Oa,bb,Ga,tb=null)=>{tb=Ja.Na(41,tb);tb.resizeRowColumnParameters=Na;return Ba.g(Ja,"ResizeRowsColumns",tb,Qa,Oa,bb,Ga,0)};var qa=
a(345),La=a(292),Yb=a(65),mc=a(180),Zb=a(29),qb=a(347);class Ha{constructor(Ja,Na,Qa){this.SYi=(Oa,bb)=>{if(!ka.a(Oa)&&bb){const Ga=!!Oa&&!!Oa.RequestTelemetryData;yb.h(this.$).wh.Fla(bb,Oa.StateId,Ga?Oa.RequestTelemetryData.EcsOperationDuration:0,Ga?Oa.RequestTelemetryData.EcsRequestDuration:0,Ga?Oa.RequestTelemetryData.WfeRequestDuration:0)}};this.bQi=(Oa,bb)=>{bb&&bb.K1b&&bb.K1b.SheetName&&bb.K1b.Ranges.length&&bb.mni&&(N.EwaSettings.isChangeGateEnabled("OfficeVSO:7480949_SVLogFlightUsage")&&v.AFrameworkApplication.Tp("XLS-IntelligentMetadataTableProactiveSuggestions-Treatment;XLS-IntelligentMetadataTableProactiveSuggestions-Control"),
N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&(this.pXd=bb.K1b.Ranges[0],this.Qwa()?this.tEe(this.pXd):this.grid.M_b(this.nGb)))};this.nGb=()=>{this.Qwa()&&(this.grid.Nuc(this.nGb),this.tEe(this.pXd))};this.$=Ja;this.Nh=Na;this.gridInstantaneousAction=Qa;this.grid=yb.h(this.$);this.pXd=null}Hc(Ja,Na){Ja=!0;switch(Na){case -445963340:case 1391094586:Ja=this.Pd(8);break;case 745189930:case 146338636:Ja=this.Pd(16)}return!Ja}executeCommand(Ja,
Na,Qa){var Oa=yb.h(this.$);const bb=Na.command;var Ga=fa.a.create().toString();let tb=Da.TaskExtensions.Tj();switch(bb){case 1391094586:case 146338636:Ja=1391094586===bb;(Ga=Qa.autoFitRanges)&&Ga.Ranges&&Ga.Ranges.length||(Ga=I.r(Oa.ha.qa.selectedRanges,this.$));tb=this.Boh(Ja?1:0,Ga,Na);break;case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:Ja=-445963340===bb||-706918724===bb||369708605===bb;N.EwaSettings.EMa()&&-706918724===bb&&Oa.wh.z0(18,Ga);if(-445963340===
bb||745189930===bb){var wb=ua.a(Na.command);Oa.wh.z0(16,Ga,wb);Oa=Qa.resizeRowColumnParameters}else{Qa=Oa.ha.qa.selectedRanges;let db=0;for(var lb of Qa)if(-706918724===bb||369708605===bb){const Pa=lb.right-lb.left+1;db+=0<Pa?Pa:-1*Pa}else if(1542466017===bb||1051390410===bb)db+=lb.bottom-lb.top+1;369708605===bb||1542466017===bb?x.ULS.sendTraceTag(520938758,0,50,`ResizeCommandHandler.doResize: Unhide Rows/Columns NumberOfRanges=${db}`):(-706918724===bb||1051390410===bb)&&x.ULS.sendTraceTag(520938757,
0,50,`ResizeCommandHandler.doResize: hide Rows/Columns NumberOfRanges=${db}`);if(!N.EwaSettings.isChangeGateEnabled("OfficeVSO:7428186_HideLastRowCol")||!Object(wa.c)(Oa.Mj("ResizeCmdHandler"))){if(-706918724===bb&&6===Na.Ve&&I.O(Qa)){x.ULS.sendTraceTag(537154007,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideColumn' was ignored because entire row is selected");break}if(1051390410===bb&&6===Na.Ve&&I.P(Qa)){x.ULS.sendTraceTag(537154006,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideRow' was ignored because entire column is selected");
break}}lb=369708605===bb||1542466017===bb?-2:0;Oa={};Oa.SheetMultiRange=I.r(Qa,this.$);if(Ja)for(wb of Oa.SheetMultiRange.Ranges)wb.FirstRow=0,wb.LastRow=0;else for(const Pa of Oa.SheetMultiRange.Ranges)Pa.FirstColumn=0,Pa.LastColumn=0;Oa.RowHeight=Ja?-1:lb;Oa.ColumnWidth=Ja?lb:-1}tb=this.Woh(Oa,Na,Ga,Ja);break;case 957527587:case 2040891415:new na(this.$,Na)}return tb}tEe(Ja){if(N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)){const Na=
Yb.d(this.$.va.na),Qa=new qa.a(I.B(Ja),Na);Da.TaskExtensions.za(Ta.GetServiceTaskFactory.Oa(this.$.da,426,427,1),Oa=>{void Oa.result.VCc(Qa,"ColumnAutoFit")},this.$.la,3)}}wc(Ja,Na,Qa,Oa){if(Ja=!!Qa&&!!Oa&&1===Oa.zx)switch(Na.command){case 1391094586:case 146338636:case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:case 957527587:case 2040891415:break;default:Ja=!1}return Ja}Nc(){return!1}YCi(Ja){x.ULS.sendTraceTag(537154004,0,50,`ResizeCommandHandler.LogInstantaneousResize: Resize operation succeeded: ${Object(La.c)(Ja)}. Reason: ${Object(La.c)(Ja)?
void 0:Ja.reason}.`)}Pd(Ja){return(new U.a(this.$.va)).Pd(Ja)}Qwa(){return this.grid.Ca.PQ(4,this.$.na)}Boh(Ja,Na,Qa){const Oa=this.$.oa.xa.Wb(),bb=0===Ja,Ga=()=>new mb(bb,Na);return Fa.a(this.$.userOperationManager,(tb,wb,lb)=>{var db=this.$.oa.xa;tb=Ca.b(tb,this.bQi);var Pa={mni:!bb,K1b:Na};const ja=db.Na(41,Oa);ja.isRow=bb;ja.autoFitRanges=Na;return Ba.g(db,"AutoFit",ja,tb,wb,lb,Pa,0)},tb=>new ca.a(135,0,tb,void 0,Ga),Qa,N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MoveTaskCompletionToQueueItemLevelByOptingIn",
!1))}Woh(Ja,Na,Qa,Oa){const bb=Na.command,Ga=yb.h(this.$),tb=I.g(Ja.SheetMultiRange.Ranges);if(N.EwaSettings.isChangeGateEnabled("OfficeVSO:7428186_HideLastRowCol")){var wb=1051390410===bb||745189930===bb&&0===Ja.RowHeight;const ja=-706918724===bb||-445963340===bb&&0===Ja.ColumnWidth,Ka=Ga.Mj("ResizeCmdHandler");if((wb||ja)&&Object(wa.c)(Ka)&&!Ka.value.Yze(tb,!Oa))return this.Lnh(Oa),Da.TaskExtensions.Tj()}let lb;wb=N.EwaSettings.EMa()&&-706918724===bb;if(745189930===bb||-445963340===bb||wb)x.ULS.shipAssertTag(537154002,
0,this.$.activeItemName===Ja.SheetMultiRange.SheetName,"ResizeCommandHandler.DoResize: should do CSE for active sheet only!"),wb?Object(mc.c)(()=>{this.gridInstantaneousAction.DUg(bb);Ga.wh.NGi()},this.$.la,0):(lb=this.Nh.vJj(Ga,tb,Oa?Ja.ColumnWidth:Ja.RowHeight,!Oa),this.YCi(lb),Object(La.c)(lb)&&Ga.wh.$R(Qa,fb.BasicTelemetryCalculator.HQ));const db=this.$.oa.xa.Wb({Dla:!0,vka:3});Oa=(ja,Ka,ub)=>{this.$.py();I.i(tb,",",this.$,!1);return Ra(this.$.oa.xa,Ja,Ca.b(ja,this.SYi),Ka,ub,Qa,db)};const Pa=
()=>new nb(Ja);return lb&&Object(La.c)(lb)?Fa.a(this.$.userOperationManager,Oa,ja=>new ca.a(136,0,ja,64,Pa),Na):Fa.a(this.$.userOperationManager,Oa,ja=>new ca.a(136,0,ja,void 0,Pa),Na)}Lnh(Ja){Ja=Zb.a.ed(1,0,Ja?768:770,Ja?769:771,0,Ja?-2037763134:503471870,Ja?"HideAllColumnsError":"HideAllRowsError");new qb.a(this.$,Ja)}}Object(r.a)(Ha,"ResizeCommandHandler",null,[222]);class Ya extends Ma.a{constructor(Ja){super(Ja)}hd(){const Ja=Ta.GetServiceTaskFactory.create(this.$.da,18,this.la,this.Xa);let Na;
Na=N.EwaSettings.EMa()?Ta.GetServiceTaskFactory.Oa(this.$.da,528,529,this.Xa):ia.Task.Sa(null);Da.TaskExtensions.za(Ja,()=>{this.$c([new Ha(this.$,Ja.result,Na.result)])},this.la,3)}static ka(Ja){Ma.a.Md(113,new Ya(Ja))}}Object(r.a)(Ya,"ResizeCommandHandlerFactory",Ma.a,[]);a.d(F,"a",function(){return Gb});const Gb=()=>{c.a.Fa(Ja=>{xa.ka(Ja);Ya.ka(Ja)})}},1200:function(r,F,a){r=a(0);var c=a(135);class b extends c.StandardDialog{constructor(){super();this.Ob=0;this.tc(1,CommonUIStrings.l_DialogClose)}displayError(S){this.Nz(S,
CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)}T8c(S){this.Nz(S,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)}}Object(r.a)(b,"ErrorDialog",c.StandardDialog,[350]);var e=a(15),f=a(160);class d{o0e(){e.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const S=new f.a;S.setResult("api.onedrive.com");return S.task}}Object(r.a)(d,"OneDriveConsumerEndpointHelper",null,[224]);var h=a(85),l=a(54),k=a(380),t=a(231);class n{constructor(S,
G,D,E){this.HEa=this.e6=null;this.bTc=this.dTc=!1;this.hXa=null;this.mb=S;this.RRb=G;this.nEa=D;this.Es=E}get Hte(){return this.RRb}get fa(){return this.mb}K4a(){this.hXa||(this.hXa=this.$$a?t.a.create(this.$$a,null,null,null,!1):null);return this.hXa}setup(S){this.HEa=S;this.dTc||this.bTc?this.dTc&&this.HEa&&this.HEa(!0):(S=this.K4a())?(this.bTc=!0,S.Y8a.continueWith(G=>{this.DXi(G)}),k.a.yia(S)):(e.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),
this.HEa(!1))}HDd(S){e.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",S.exception?S.exception.toString():"No error detail.")}DXi(S){this.bTc=!1;if(S.Hf)this.HDd(S),this.HEa(!1);else try{this.dTc=!0,e.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.Wnd(),e.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.HEa(!0)}catch(G){e.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",G.toString()),this.HEa(!1)}}startPicker(S){this.e6=
S;this.nEa?e.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(e.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(h.a)(this,this.gCd,"onApiReady")))}gCd(S){S?this.rlc():this.kj()}kj(){this.Es().displayError(l.a.U1i)}onSuccess(S){e.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.e6&&this.e6(!0,S)}dispose(){this.hXa&&this.hXa.dispose()}}Object(r.a)(n,"AOneDriveFilePickerApiManager",
null,[55,2]);class z extends n{constructor(S,G,D,E,N,M){super(G,D,E,M);this.Ah=null;this.P1=S;this.eEg=N}get $$a(){return this.fa.Wa("OneDriveApiUrl")}start(S,G){this.Ah=S;this.startPicker(G)}Wnd(){WL.init(1===this.Hte||2===this.Hte?{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}startPicker(S){this.e6=S;!this.nEa&&this.P1.hMa?(e.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),
this.setup(Object(h.a)(this,this.gCd,"onApiReady"))):(e.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.eEg())}rlc(){try{e.ULS.sendTraceTag(17909027,352,50,"Launching file dialogue"),WL.fileDialog(this.Ah).then(Object(h.a)(this,this.onSuccess,"onSuccess"),Object(h.a)(this,this.d6,"onFailure"))}catch(S){e.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",S,S.stack),this.kj()}}d6(S){if(S&&S.error){if("user_canceled"===S.error.code){e.ULS.sendTraceTag(17909058,
352,50,"User canceled.");return}e.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",S.error.code,S.error.message)}else e.ULS.sendTraceTag(17909060,352,50,"File Dialog returned with no response");this.e6&&this.e6(!1,S);this.kj()}}Object(r.a)(z,"OneDriveFilePickerApiManagerV5",n,[]);class w extends n{constructor(S,G,D,E,N){super(S,G,D,E);this.oUb=this.Sfe=null;this.fwg=N;this.options={};this.options.clientId=this.fa.Wa("OneDriveApiV7ClientId");this.options.cancel=
Object(h.a)(this,this.BCc,"toggleHostDivVisibility")}get $$a(){return this.fa.Wa("OneDriveApiV72Url")}start(S,G){this.oUb=G;const D=this.fwg.o0e();D.continueWith(()=>{e.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.Sfe=D.result;this.startPicker((E,N)=>{this.BCc();S(E,N)})},3);D.continueWith(()=>{e.ULS.sendTraceTag(24134242,352,15,D.exception.message);this.BCc()},5)}Wnd(){this.options.success=S=>{const G={};G.data=S;this.onSuccess(G)};this.options.error=
S=>{const G={};G.error=S;this.d6(G)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=this.Sfe;this.options.advanced.iframeParentDiv=this.oUb}rlc(){try{e.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.BCc(),OneDrive.open(this.options)}catch(S){e.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",S.message),this.kj()}}d6(S){this.e6&&this.e6(!1,S);this.kj()}BCc(){this.oUb.style.visibility=
"hidden"===this.oUb.style.visibility?"":"hidden"}}Object(r.a)(w,"OneDriveFilePickerApiManagerV7",n,[]);class m extends n{constructor(S,G,D,E){super(S,G,D,E);this.Xsg=S;this.options={};this.options.advanced={};this.options.action="query";this.options.clientId=this.fa.Wa("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get $$a(){return this.fa.Wa("OneDriveApiV72Url")}start(S,G,D,E){this.options.advanced.iframeParentDiv=D;this.options.advanced.endpointHint=E;this.options.cancel=G;this.Xsg.pa("OneDriveApiV72RecentsViewEnabled")&&
(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive={},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.startPicker(S)}startPicker(S){this.e6=S;this.nEa?e.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(e.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(h.a)(this,this.gCd,"onApiReady")))}Wnd(){this.options.success=
S=>{const G={};G.data=S;this.onSuccess(G)};this.options.error=S=>{const G={};G.error=S;this.d6(G)}}rlc(){try{e.ULS.sendTraceTag(23881879,216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(S){e.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",S.message,S.stack),this.kj()}}HDd(S){e.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",S.exception?S.exception.toString():"No error detail.");k.a.Kij(this.$$a);
this.hXa=null}kj(){this.Es().T8c(l.a.osj)}d6(S){this.e6&&this.e6(!1,S)}}Object(r.a)(m,"OneDriveFilePickerApiManagerV72",n,[]);class u{constructor(S){this.olsSessionId=this.value=this.key=null;this.olsSessionId=S}}Object(r.a)(u,"IExtraData",null,[]);var y=a(4);class v extends m{constructor(S,G,D,E){super(S,G,D,E);this.options.advanced.filter=S.Wa("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=y.AFrameworkApplication.Pte;S.pa("OneDriveApiV72CommandModeEnabled")&&
(this.options.commandMode=S.Wa("OneDriveApiV72CommandMode")||"none");S.pa("OneDriveApiV72QosExtraDataEnabled")&&(this.options.qosExtradata=new u(y.AFrameworkApplication.userSessionId))}get $$a(){return this.fa.Wa("OneDriveApiV72Url")}rlc(){try{e.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:
"",y.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(S){e.ULS.sendTraceTag(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",S.message,S.stack),this.kj()}}}Object(r.a)(v,"OneDriveFilePickerApiOpenManagerV72",m,[]);var C=a(241);class x{constructor(S){this.Ck=null;this.ph=S;this.dSc=3}o0e(){this.Ck=new f.a;e.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.uQd();return this.Ck.task}uQd(S=null){const G=
String.format("GetMoreInfoHandler.ashx?{0}",y.AFrameworkApplication.jIa);this.ph.Jga(G,1,null,S,["PersonalFileStorageUrl","X-NewKey"],!1,2,Object(h.a)(this,this.fZh,"getMoreInfoSucceeded"),Object(h.a)(this,this.dZh,"getMoreInfoFailed"),null,void 0,void 0,void 0,void 0,"21")}dZh(S){if(S.data.httpStatus===C.a.nIb&&"X-NewKey"in S.data.responseHeaders){e.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const G={};G["X-Key"]=S.data.responseHeaders["X-NewKey"];
this.uQd(G)}else 0<this.dSc?(e.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.dSc),this.dSc--,this.uQd()):(e.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.Ck.setException(Error.create("GetMoreInfo request failed and no more retries remain")))}fZh(S){"PersonalFileStorageUrl"in S.data.responseHeaders&&""!==S.data.responseHeaders.PersonalFileStorageUrl?(e.ULS.sendTraceTag(24134239,
352,50,"Successfully received an ODB endpoint"),this.Ck.setResult(S.data.responseHeaders.PersonalFileStorageUrl)):(e.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.Ck.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))}}Object(r.a)(x,"OneDriveForBusinessEndpointHelper",null,[224]);var B=a(251),H=a(561);class I{constructor(){this.$a=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}Bh(S){this.$a=
S;this.$a.register(z,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").qc().yc(()=>new z(H.a.instance,y.AFrameworkApplication.fa,y.AFrameworkApplication.H2a,y.AFrameworkApplication.limitedEdit,y.AFrameworkApplication.E$f,()=>new b));y.AFrameworkApplication.Bmf?this.$a.register(224,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").qc().yc(()=>new d):this.$a.register(224,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").qc().yc(()=>
new x(y.AFrameworkApplication.Bd));this.$a.register(w,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").qc().yc(()=>new w(y.AFrameworkApplication.fa,y.AFrameworkApplication.H2a,y.AFrameworkApplication.limitedEdit,()=>new b,this.$a.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));this.$a.register(m,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").qc().yc(()=>new m(y.AFrameworkApplication.fa,y.AFrameworkApplication.H2a,y.AFrameworkApplication.limitedEdit,
()=>new b));this.$a.register(v,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").qc().yc(()=>new v(y.AFrameworkApplication.fa,y.AFrameworkApplication.H2a,y.AFrameworkApplication.limitedEdit,()=>new b))}static main(){B.a.instance.ii(new I)}}Object(r.a)(I,"PackageManager",null,[3,4]);a.d(F,"a",function(){return U});const U=()=>{Type.registerNamespace("Common.App.OneDriveFilePickerApi");I.main()}},1207:function(r,F,a){r=a(0);var c=a(85),b=a(15),e=a(135),f=a(54),d=a(25);class h extends e.StandardDialog{constructor(aa,
V){super();this.iXa=!1;this.eA=null;this.Ma=aa;this.djb=V;this.HSa=!1}displayError(aa,V,P){this.eA=V;this.iXa=P;b.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",aa,P);aa=this.d2c(aa);0===aa?(this.Ob=6,this.tc(0,CommonUIStrings.l_DialogClose)):(this.Ob=0,this.tc(1,CommonUIStrings.l_DialogClose));0===aa&&b.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.Nz(f.a.nsj,this.$fd(aa),this.BTh(aa,V),Object(c.a)(this,this.DOd,"retryDialogHandler"),!0)}DOd(aa){1===
aa?(b.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.eA?this.Ma.Vd(d.a.pLb,2,[this.eA,this.iXa]):this.Ma.processAction(d.a.pLb,2)):b.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")}d2c(aa){return 0>aa||6<aa?(b.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",aa),0):aa}BTh(aa,V){aa=this.d2c(aa);return this.djb?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,
String.format(CommonUIStrings.l_OverwriteTargetText,V),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][aa]:[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,V),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][aa]}$fd(aa){aa=this.d2c(aa);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,
CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][aa]}}Object(r.a)(h,"ErrorRetryDialog",e.StandardDialog,[668]);class l{constructor(aa,V){this.mb=aa;this.Ma=V;this.djb=this.mb.pa("SaveToHostWithExtraCharsInFileName")}create(){return new h(this.Ma,this.djb)}}Object(r.a)(l,"ErrorRetryDialogFactory",null,[662]);e=a(1071);var k=a(150);class t{static get og(){return k.a.zq(t.Ll,
CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}t.Ll="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(r.a)(t,"FileNameDialogHtml",null,[]);var n=a(4),z=a(30);class w extends e.a{constructor(aa,V,P,ba,Y,Z){super(aa,V,P,ba,Y,Z);this.og=t.og;this.pe="FileNameDialog-SaveAsToHost"}UP(aa,V){const P=z.a.Lp(n.AFrameworkApplication.om.fn);V={["txtFileName"]:aa||P,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:V};this.initializeAndShow(CommonUIStrings.L_SaveAs,Object(c.a)(this,this.T$b,"fileNameDialogHandler"),V);this.vMe(aa,P)}}Object(r.a)(w,"FileNameDialog",e.a,[667]);class m{constructor(aa,
V,P,ba,Y,Z){this.Ma=V;this.mb=aa;this.kX=ba;this.uga=Z;this.Es=Y;this.Ye=P}create(){return new w(this.mb,this.Ma,this.Ye,this.kX,this.Es,this.uga)}}Object(r.a)(m,"FileNameDialogFactory",null,[661]);var u=a(650),y=a(108);class v{constructor(aa,V,P){this.uga=P;this.LKc=V;this.mb=aa}Ag(){2===n.AFrameworkApplication.sa.Qa.Oj?n.AFrameworkApplication.rb.Oe(d.a.pLb,y.a.frame,Object(c.a)(this,this.R0f,"saveAsToHostActionDispatcher"),4):n.AFrameworkApplication.rb.Nb(d.a.pLb,y.a.frame,Object(c.a)(this,this.R0f,
"saveAsToHostActionDispatcher"))}R0f(aa,V,P,ba,Y){return V.contextId!==y.a.frame||aa!==d.a.pLb?2:this.mb.pa("SaveAsToHostBrsIsEnabled")?1===P?u.SessionStatusManager.instance.v5a||n.AFrameworkApplication.W4?8:32:2===P?(b.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),aa=this.LKc.create(),Y&&Object.getType(Y)===Array&&2===Y.length?aa.UP(Y[0],!!Y[1]):aa.UP(null,!1),32):8:8}}Object(r.a)(v,"SaveAsToHostActor",null,[]);var C=a(39),x=a(79),B=a(40),H=a(241),I=a(378),
U=a(168),S=a(652),G=a(777);class D{constructor(aa,V,P,ba,Y,Z,ea,ra){this.Hm=null;this.iXa=this.GDa=!1;this.tga=this.Ah=this.eA=null;this.mb=V;this.DFa=this.mb.appSettings.SaveAsToHostWebServiceBase;this.Mae=ba;this.Plb=Y;this.ph=P;this.Es=Z;this.rh=ra;this.Ye=ea;this.Ma=aa;this.tfa=V.Wa("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}INb(){1!==this.Ye.state&&(this.Hm=this.Plb(),this.Hm.message=CommonUIStrings.l_CommentProgressTooltip,this.Hm.Ob=5,this.Hm.pt=!1,this.Hm.ZAa(CommonUIStrings.l_DefaultDialogTitle,
null,null))}XR(aa=0){1!==this.Ye.state&&this.Es.create().displayError(aa,z.a.Lp(this.eA),this.iXa)}qQa(){const aa=this.mb.appSettings.BreadcrumbFolderUrl;b.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");B.a.gf(aa,B.a.bX(3),void 0,"UploadToHostManager.RedirectToFolder")}pQa(aa){let V=!1,P=!1;this.mb&&(V=this.mb.pa("SaveACopyIsEnabledForUiHost"),P=this.mb.pa("UiHostSupportsDocRebootFeatures"));b.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",
aa,V,P);if(V&&P){b.ULS.sendTraceTag(51245197,216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const ba={};ba[I.a.jQa]="1";ba[I.a.documentUrl]=aa;ba[I.a.reason]=S.a.saveAs;n.AFrameworkApplication.uQ().execute(Y=>{Y.jj(U.a.SY,ba)})}else V&&!P&&n.AFrameworkApplication.jV?B.a.gf(aa,B.a.bX(4),void 0,"UploadToHostManager.RedirectToEditUrl"):B.a.gf(aa,B.a.bX(3),void 0,"UploadToHostManager.RedirectToEditUrl")}hoa(aa,V,P=null){b.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");
this.Mae&&!this.Mae()&&this.ph&&(this.rh&&(this.tga=this.rh.Gc("DialogShown","SaveAsToHostUploadTime")),this.INb(),this.iXa=V,this.eA=aa,(this.Ah=P)&&"true"===this.Ah.SkipSaveToHost?this.o$b():this.aQ())}aQ(){32!==this.Ma.processAction(d.a.uRa,1)?(b.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.o$b()):this.Ma.Vd(d.a.uRa,2,[()=>{b.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.o$b()},(aa,
V)=>{b.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");this.XR(V)}])}g1i(aa){this.PIa();this.GDa=!1;if(aa&&aa.data&&aa.data.de)if(({ht:V}=C.d(aa.data.de)).returnValue)if(aa=V,aa.StatusCode!==H.a.IO&&aa.StatusCode!==H.a.Ssb){b.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var V={};V.FailureReason=aa.StatusCode.toString();V.ExtraInfo=aa.ExtraInfo;this.Ada(V);this.XR(parseInt(aa.ExtraInfo))}else{b.ULS.sendTraceTag(8194050,
216,50,"UploadToHost execute success.");this.pNd();try{aa.NewDocumentUrl&&""!==aa.NewDocumentUrl?this.pQa(aa.NewDocumentUrl):this.qQa()}catch(P){b.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",P.toString())}this.UHb()}else b.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:G.a.Yfb(aa.data.de)}),this.Ada({["FailureReason"]:"Failed to deserialize response"}),this.XR();else b.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),
this.Ada({["FailureReason"]:"null response"}),this.XR()}f1i(aa){5!==aa.data.status&&12!==aa.data.status||this.GDa?(b.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:aa.data.status,["HttpStatus"]:aa.data.httpStatus}),this.Ada({["FailureReason"]:aa.data.httpStatus.toString()}),this.PIa(),this.XR(),this.UHb()):(b.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.GDa=!0,this.Ah&&"true"===this.Ah.SkipSaveToHost?this.o$b():
this.aQ())}PIa(){this.Hm&&(this.Hm.close(),this.Hm=null)}UHb(){this.tga&&(this.tga.stop(),this.tga=null)}pNd(){this.Ah&&"VersionHistory"===this.Ah.SaveEntryPoint&&this.Ma.processAction(d.a.Gvc,2)}Ada(aa){this.Ah&&"VersionHistory"===this.Ah.SaveEntryPoint&&this.Ma.Vd(d.a.rNd,2,aa)}o$b(){let aa=this.DFa+this.tfa;aa=x.a.wl(aa,"qs",z.a.hf(n.AFrameworkApplication.vi));aa=x.a.wl(aa,"n",z.a.hf((new Date).getTime().toString()));aa=x.a.wl(aa,"ov",z.a.hf(this.iXa.toString()));aa=x.a.wl(aa,"fn",z.a.hf(this.eA));
this.Ah&&this.Ah.FileDownloadUrl&&(aa=x.a.wl(aa,"furl",z.a.hf(this.Ah.FileDownloadUrl)));this.ph.Jm(aa,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(c.a)(this,this.g1i,"onUploadFinished"),Object(c.a)(this,this.f1i,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(r.a)(D,"UploadToHostManager",null,[538]);var E=a(251),N=a(794);class M{constructor(){this.$a=null}get name(){return"Common.App.SaveAsToHost"}init(){n.AFrameworkApplication.fa.ru(Object(c.a)(this,this.lB,
"onFullAppSettingsReady"))}lB(){n.AFrameworkApplication.fa.pa("SaveAsToHostBrsIsEnabled")&&this.$a.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Ag()}Bh(aa){this.$a=aa;this.$a.register(l,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").yc(()=>new l(n.AFrameworkApplication.fa,n.AFrameworkApplication.rb)).qc();this.$a.register(D,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").yc(()=>new D(n.AFrameworkApplication.rb,
n.AFrameworkApplication.fa,n.AFrameworkApplication.Bd,()=>n.AFrameworkApplication.rg,()=>(new N.a).create(),aa.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),n.AFrameworkApplication.sa,n.AFrameworkApplication.sa.HD)).qc();this.$a.register(m,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").yc(()=>new m(n.AFrameworkApplication.fa,n.AFrameworkApplication.rb,n.AFrameworkApplication.sa,n.AFrameworkApplication.sa.Qa,aa.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),
aa.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).qc();this.$a.register(v,"Common.App.SaveAsToHost.SaveAsToHostActor").yc(()=>new v(n.AFrameworkApplication.fa,aa.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),aa.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).qc()}dispose(){}static main(){E.a.instance.ii(new M)}}Object(r.a)(M,"SaveAsToHostPackage",null,[3,4]);a.d(F,"a",function(){return L});const L=()=>{Type.registerNamespace("Common.App.SaveAsToHost");M.main()}},1208:function(r,
F,a){r=a(0);var c=a(85),b=a(15),e=a(150);class f{static get og(){return e.a.zq(f.Ll,CommonUIStrings.l_SaveACopyFileName)}}f.Ll="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(r.a)(f,"FileNameDialogHtml",
null,[]);var d=a(4),h=a(30);class l extends e.a{constructor(G,D,E,N){super();this.ZTb=this.x8=null;this.Ma=G;this.kX=D;this.inb=E;this.tc(1,CommonUIStrings.l_SaveButtonLabel);this.og=f.og;this.pe="FileNameDialog-SaveACopy";this.Ah=N}UP(G,D,E){this.ZTb=G;this.x8=E;G={["txtFileName"]:h.a.Lp(d.AFrameworkApplication.om.fn),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,D)};this.initializeAndShow(CommonUIStrings.l_SaveToOneDrive,Object(c.a)(this,this.T$b,"fileNameDialogHandler"),G);
b.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()}T$b(G,D){1!==G?b.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(G=D.txtFileName.trim(),b.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),D=h.a.Z3(d.AFrameworkApplication.fileName),G&&""!==G&&""!==D&&(G+=D),this.inb.hoa(this.ZTb,this.x8,G,this.Ah))}}Object(r.a)(l,"FileNameDialog",e.a,[664]);
class k{constructor(G,D,E){this.Ma=G;this.kX=D;this.inb=E}create(G){return new l(this.Ma,this.kX,this.inb,G)}}Object(r.a)(k,"FileNameDialogFactory",null,[653]);var t=a(135),n=a(25);class z extends t.StandardDialog{constructor(G){super();this.Ob=1;this.tc(1,CommonUIStrings.l_RetryButtonLabel);this.tc(0,CommonUIStrings.l_DialogClose);this.Ma=G}displayError(G){b.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",G);this.Nz(G,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
Object(c.a)(this,this.DOd,"retryDialogHandler"))}DOd(G){1===G?(b.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.Ma.processAction(n.a.saveACopy,2)):b.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")}}Object(r.a)(z,"RetryDialog",t.StandardDialog,[654]);t=a(1072);var w=a(852),m=a(380),u=a(108);class y extends t.a{constructor(G,D,E,N){super(G,D,E,N);this.lBg=D}e8a(){return this.mb.pa("SaveACopyBrsIsEnabled")}X_e(){return n.a.saveACopy}R2b(){m.a.EKd(Object(c.a)(this,
this.j1f,"saveToCloudActionDispatcher"));m.a.q$c([new w.a(n.a.saveACopy,u.a.frame,0)],this.lBg.K4a())}bTf(){d.AFrameworkApplication.ula("CreateCopy_cf;CreateCopy_tf");b.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")}}Object(r.a)(y,"SaveACopyActor",t.a,[]);t=a(1075);class v extends t.a{constructor(G,D,E,N,M,L,aa){super(D,E,N,M,L,aa);this.Gwg=G}onSuccess(G){G&&G.data&&G.data.folders?(b.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),
this.Gwg.create(this.Ah).UP(G.data.folders[0].id,G.data.folders[0].name,G.data.folders[0].urls.viewInBrowser)):(b.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.kj())}d6(G){G&&G.error&&"user_canceled"===G.error.code&&b.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.d6(G)}kj(){b.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");super.kj()}}Object(r.a)(v,"SaveACopyManager",t.a,[]);var C=a(1073);class x extends C.a{constructor(G,
D,E,N,M,L){super(D,E,N,M,L);this.Ma=G}Msd(){return!!this.Ah&&!!this.Ah.SaveEntryPoint&&"VersionHistory"===this.Ah.SaveEntryPoint.toString()}XR(){b.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");this.Msd()&&this.Ma.Vd(n.a.rNd,2,{["FailureReason"]:"Unknown"});super.XR()}qQa(){b.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.Msd()&&this.Ma.processAction(n.a.Gvc,2);super.qQa()}pQa(G){b.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",
G);this.Msd()&&this.Ma.processAction(n.a.Gvc,2);super.pQa(G)}aQ(){this.Ah&&"true"===this.Ah.SkipSaveToHost?super.aQ():32!==this.Ma.processAction(n.a.uRa,1)?(b.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),super.aQ()):this.Ma.Vd(n.a.uRa,2,[()=>{b.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");C.a.prototype.aQ.call(this)},()=>{b.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");
this.XR()}])}}Object(r.a)(x,"SaveACopyUploadToCloudManager",C.a,[]);var B=a(251),H=a(561),I=a(794);class U{constructor(){this.$a=null}get name(){return"Common.App.SaveACopy"}init(){d.AFrameworkApplication.fa.ru(Object(c.a)(this,this.lB,"onFullAppSettingsReady"))}lB(){d.AFrameworkApplication.fa.pa("SaveACopyBrsIsEnabled")&&this.$a.resolve("Common.App.SaveACopy.SaveACopyActor").Ag()}dispose(){}Bh(G){this.$a=G;this.$a.register(x,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").yc(()=>new x(d.AFrameworkApplication.rb,
G.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new I.a).create(),()=>new z(d.AFrameworkApplication.rb),d.AFrameworkApplication.sa,d.AFrameworkApplication.sa.HD)).qc();this.$a.register(k,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").yc(()=>new k(d.AFrameworkApplication.rb,d.AFrameworkApplication.sa.Qa,G.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).qc();this.$a.register(y,"Common.App.SaveACopy.SaveACopyActor").yc(()=>
new y(G.resolve("Common.App.SaveACopy.SaveACopyManager"),G.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),d.AFrameworkApplication.fa,d.AFrameworkApplication.sa.HD)).qc();this.$a.register(v,"Common.App.SaveACopy.SaveACopyManager").yc(()=>new v(G.resolve("Common.App.SaveACopy.FileNameDialogFactory"),G.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),H.a.instance,G.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),d.AFrameworkApplication.fa,d.AFrameworkApplication.H2a,
()=>new z(d.AFrameworkApplication.rb))).qc()}static main(){B.a.instance.ii(new U)}}Object(r.a)(U,"PackageManager",null,[3,4]);a.d(F,"a",function(){return S});const S=()=>{Type.registerNamespace("Common.App.SaveACopy");U.main()}},1209:function(r,F,a){var c=a(9);r=a(0);var b=a(226),e=a(15),f=a(30),d=a(84),h=a(244),l=a(36);class k extends h.a{constructor(E,N,M){super(E,N);this.TFd=this.executionContext=null;this.F4i=(L,aa)=>{this.LHb(L,aa)};this.EJ=M}initialize(E){super.initialize(E)}execute(E){this.executionContext=
E;E=Object(d.a)(7,this.executionContext.Ee);this.Ksb(E);return 1}xI(E){super.xI(E)}Ksb(){this.subscribe(this.executionContext,this.F4i,E=>{this.TFd.add_disposing(E)})}LHb(E){this.unsubscribe(N=>{E.remove_disposing(N)});this.executionContext.activityState[l.a.e2]=0}}Object(r.a)(k,"PasswordProtectedFileActivity",h.a,[]);var t=a(285),n=a(266),z=a(13);class w extends t.a{constructor(E){super(E);this.Wpa=0;this.ddj=(N,M)=>{this.Fbb(N,M)};this.M1d=(N,M)=>{this.wUa(N,M)}}get kc(){return"PasswordDialog"}get Ftb(){return this.Wpa}get el(){return z.a.instance.ga(1981)}Fbb(E){this.Wpa=
E}f3(){const E={};E[t.a.description]=z.a.instance.ga(1982);E[t.a.placeholderText]=z.a.instance.ga(1978);E[t.a.cMf]=z.a.instance.ga(2E3);E[t.a.aMf]=z.a.instance.ga(2001);E[t.a.bMf]=z.a.instance.ga(1979);E[t.a.vnd]=z.a.instance.ga(1985);E[t.a.swe]=z.a.instance.ga(1665);E[t.a.p5j]=z.a.instance.Ta(25);E[t.a.Bmg]=this.M1d;return E}lta(){const E={};E[n.a.it]=this.kc;E[t.a.s_a]=this.f3();return E}ig(){this.Ob=1;this.initializeAndShow(this.el,this.ddj,this.lta())}}Object(r.a)(w,"PasswordProtectedFilePasswordInputDialog",
t.a,[]);var m=a(60),u=a(29),y=a(249),v=a(52);class C extends w{constructor(E){super(E);this.yOd=5;this.Ibe=!1;this.passwordToModify=null;this.dMf=()=>{this.$.isEditMode&&this.Wic&&(v.b().o$c("PasswordToModifyPasswordVerifiedTillInteractive"),this.$.pl(this.dMf))};this.ig();this.$.Lk(this.dMf)}get Wic(){return this.Ibe}get el(){return z.a.instance.ga(1983)}Fbb(E,N){super.Fbb(E,N);e.ULS.sendTraceTag(537154755,0,50,`PasswordProtectedFileModifyActivity.PasswordProtectedFileModifyPasswordInputDialogDisposing: user response: ${E}`)}wUa(E,
N){this.passwordToModify=E;const M={};M.FileModifyPassword=f.a.hf(E);m.M(this.$.oa.xa,M,this.l1i(N),this.k1i(N),null,null)}f3(){const E=super.f3();E[t.a.vnd]=z.a.instance.ga(1986);E[t.a.description]=z.a.instance.Ta(24);return E}ig(){v.b().o$c("PasswordToModifyDialogShown");e.ULS.sendTraceTag(557446529,0,50,"PasswordProtectedFileModifyPasswordInputDialog.InitializeAndShowDialog: Initializing dialog.");super.ig()}l1i(E){return N=>{u.a.dh(N.Errors,[-2019873242])&&this.e8b(this.Bsb());if(!N||y.a(N))if(0<
this.yOd)this.ARf(E);else{e.ULS.sendTraceTag(537154754,0,10,`VerifyPasswordToModifyOperation.GenerateOnVerifyPasswordToModifyRequestSuccess: Unexpected error: ${u.a.nc(N.Errors)}`);this.$.ea.Tn(N.Errors);this.hide();return}this.Ibe=N.Result;this.Wic&&(v.b().CWd("UserAction","Password-To-Modify Workbook: Logging StopWatch duration after user enters corect password","PasswordToModifyPasswordVerifiedTillInteractive"),e.ULS.sendTraceTag(555758470,0,50,"PasswordProtectedFileModifyPasswordInputDialog.OnVerifyPasswordToModifyRequestSuccess: User entered the correct password."));
E(this.Wic?0:1)}}k1i(E){return()=>{0<this.yOd?this.ARf(E):(e.ULS.sendTraceTag(537154753,0,10,"PasswordProtectedFileModifyInputDialog.OnVerifyPasswordToModifyRequestFailure: VerifyPasswordToModify request failed."),E(3))}}ARf(E){--this.yOd;this.wUa(this.passwordToModify,E)}Bsb(){return u.a.ed(1,0,1664,1665,1,-2019873242,"TooManyWrongPasswordAttemptFileModifyError")}}Object(r.a)(C,"PasswordProtectedFileModifyPasswordInputDialog",w,[]);var x=a(6);class B extends k{constructor(E,N,M){super(E,N,M)}Ksb(E){this.TFd=
new C(E);super.Ksb(E)}LHb(E,N){const M=E.Ftb,L=E.Wic,aa=E.passwordToModify;super.LHb(E,N);this.executionContext.aya([2001366804]);switch(M){case 1:L?(N=Object(d.a)(7,this.executionContext.Ee),this.executionContext.activityState[l.a.ioe]=f.a.hf(aa),this.executionContext.activityState[l.a.GYa]=!0,E.passwordToModify="",this.gh(N.isEditMode?x.a.xj:this.wJ)):e.ULS.sendTraceTag(537154757,0,50,"PasswordProtectedFileModifyActivity.PasswordProtectedFilePasswordInputDialogDisposing: Unexpected State , Dialog disposed but password not verified.");
this.kp();break;case 0:this.executionContext.activityState[l.a.Kr]=!1;this.gh(this.EJ);this.kp();break;default:e.ULS.sendTraceTag(537154756,0,50,`PasswordToModifyFileModifyActivity.OnPasswordInputCommited: unhandled user response '${M}'`)}}}Object(r.a)(B,"PasswordProtectedFileModifyActivity",k,[]);class H extends b.a{constructor(E,N,M,L){super();this.activityName=E;this.wJ=N;this.EJ=M;this.$=L;this.Db()}create(){this.nb(new B(this.activityName,this.wJ,this.EJ))}static ka(E){E.da.Ha(434,new H(x.a.KHb,
x.a.Pfb,x.a.Crb,E))}}Object(r.a)(H,"PasswordProtectedFileModifyActivityFactory",b.a,[]);var I=a(45);class U extends w{constructor(E,N){super(E);this.password=null;this.Nnf=N;this.ig()}wUa(E,N){this.password=E;N(0)}f3(){const E=super.f3();this.Nnf&&(E[t.a.Eth]=1);return E}ig(){e.ULS.sendTraceTag(537154722,0,50,`PasswordProtectedFileOpenPasswordInputDialog.InitializeAndShowDialog: Initializing dialog. isWrongPassword=${this.Nnf}`);super.ig();I.a(this.$).zse()}}Object(r.a)(U,"PasswordProtectedFileOpenPasswordInputDialog",
w,[]);class S extends k{constructor(E,N,M){super(E,N,M)}Ksb(E){const N=u.a.dh(this.executionContext.errors,[1217361942]);this.TFd=new U(E,N);E.Xgc||E.bMe();super.Ksb(E)}LHb(E,N){let M,L;M=E.password;E.password="";L=E.Ftb;super.LHb(E,N);this.executionContext.activityState[l.a.sWc]=f.a.hf(M);this.executionContext.activityState[l.a.GYa]=!0;this.executionContext.aya([110414285,1217361942]);e.ULS.sendTraceTag(537154752,0,50,`PasswordProtectedFileOpenActivity.PasswordProtectedFileOpenPasswordInputDialogDisposing: user response: ${L}`);
switch(L){case 1:this.gh(this.wJ);this.kp();break;case 0:this.gh(this.EJ),this.kp()}}}Object(r.a)(S,"PasswordProtectedFileOpenActivity",k,[]);class G extends b.a{constructor(E,N,M,L){super();this.activityName=E;this.wJ=N;this.EJ=M;this.$=L;this.Db()}create(){this.nb(new S(this.activityName,this.wJ,this.EJ))}static ka(E){E.da.Ha(386,new G(x.a.Arc,x.a.xj,x.a.Kj,E))}}Object(r.a)(G,"PasswordProtectedFileOpenActivityFactory",b.a,[]);a.d(F,"a",function(){return D});const D=()=>{c.a.Fa(G.ka);c.a.Fa(H.ka)}},
1216:function(r,F,a){r=a(0);var c=a(135);class b extends c.StandardDialog{constructor(){super();this.Ob=0;this.tc(1,CommonUIStrings.l_DialogClose)}displayError(S){this.Nz(S,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,null)}}Object(r.a)(b,"ErrorDialog",c.StandardDialog,[654]);var e=a(1075),f=a(1072),d=a(15),h=a(85),l=a(4),k=a(255),t=a(40),n=a(25);class z extends c.StandardDialog{constructor(S,G,D){super();this.Ma=S;this.P1=G;this.kX=D;this.ax=!1;this.Ob=1;this.p0(1);
this.tc(1,CommonUIStrings.l_SignIn);this.tc(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}UP(){this.P1.SYa(Object(h.a)(this,this.QIf,"onSignIn"));this.Wl(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(h.a)(this,this.aji,"inputHandler"))}aji(S){0===S?(d.ULS.sendTraceTag(6590598,216,50,"User dismissed SignIn Dialog."),this.hide()):this.v6()}A3g(){let S="2";if(this.kX)switch(this.kX.Oj){case 3:S="0";break;case 2:S="3";break;case 1:S="1"}return S}hide(){this.P1.PJb(Object(h.a)(this,
this.QIf,"onSignIn"));super.hide()}v6(){var S=l.AFrameworkApplication.fa.pa("SignInAspxInWebAppsPortalIsEnabled")?"/start/signin.aspx":"Signin.aspx";S=new k.QueryStringBuilder(S);S.Zi("prompt","1");S.Zi("cbcxt",this.A3g());l.AFrameworkApplication.JYa(S);t.a.gf(S.toString(),"LoginWindow",void 0,"SignInDialog")}QIf(){this.Pn&&this.hide();d.ULS.sendTraceTag(7143885,216,50,"User signed in successfully. Calling Savetocloudstorage action handler");this.Ma.processAction(n.a.saveToCloudStorage,2)}}Object(r.a)(z,
"SignInDialog",c.StandardDialog,[665]);class w{constructor(S,G,D){this.Ma=S;this.P1=G;this.kX=D}create(){return new z(this.Ma,this.P1,this.kX)}}Object(r.a)(w,"SignInDialogFactory",null,[656]);var m=a(79),u=a(30);class y{constructor(S,G,D,E,N,M,L){this.DFa=S;this.eA=G;this.YVa=D;this.ZTb=E;this.zRc=N;this.tfa=M;this.Ah=L}execute(S,G){if(!l.AFrameworkApplication.rg&&l.AFrameworkApplication.Bd){var D=this.DFa+this.tfa;D=m.a.wl(D,"fo",u.a.hf(this.ZTb));D=m.a.wl(D,"fn",u.a.hf(this.eA));D=m.a.wl(D,"qs",
u.a.hf(this.zRc));D=m.a.wl(D,"n",u.a.hf((new Date).getTime().toString()));this.Ah&&this.Ah.FileDownloadUrl&&(D=m.a.wl(D,"furl",u.a.hf(this.Ah.FileDownloadUrl)));this.YVa&&(D=m.a.wl(D,"fnn",u.a.hf(this.YVa)));l.AFrameworkApplication.Bd.Jm(D,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,S,G,null)}}}Object(r.a)(y,"SkyDriveUploadCaller",null,[663]);class v{constructor(S){this.mb=S;this.EFa=S.appSettings.SkyDriveUploadWebServiceBase;this.eA=S.appSettings.FileName;this.tfa=S.Wa("SkyDriveUploadHandler")||
"skydriveuploadhandler.ashx"}create(S,G,D){return new y(this.EFa,this.eA,G,S,l.AFrameworkApplication.vi,this.tfa,D)}}Object(r.a)(v,"SkydriveUploadCallerFactory",null,[655]);var C=a(1073),x=a(251),B=a(561),H=a(794);class I{constructor(){this.$a=null}get name(){return"Common.App.SaveToCloudStorage"}init(){l.AFrameworkApplication.fa.pa("SaveToCloudStorageUIIsEnabled")&&this.$a.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Ag()}dispose(){}Bh(S){this.$a=S;this.$a.register(w,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").yc(()=>
new w(l.AFrameworkApplication.rb,B.a.instance,l.AFrameworkApplication.sa.Qa)).qc();this.$a.register(v,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").yc(()=>new v(l.AFrameworkApplication.fa)).qc();this.$a.register(f.a,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").yc(()=>new f.a(S.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),S.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),
l.AFrameworkApplication.fa,l.AFrameworkApplication.sa.HD)).qc();this.$a.register(C.a,"Common.App.SaveToCloudStorage.UploadToCloudManager").yc(()=>new C.a(S.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new H.a).create(),()=>new b,l.AFrameworkApplication.sa,l.AFrameworkApplication.sa.HD)).qc();this.$a.register(e.a,"Common.App.SaveToCloudStorage.SaveToCloudManager").yc(()=>new e.a(S.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),B.a.instance,S.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),
l.AFrameworkApplication.fa,l.AFrameworkApplication.H2a,()=>new b)).qc()}static main(){x.a.instance.ii(new I)}}Object(r.a)(I,"PackageManager",null,[3,4]);a.d(F,"a",function(){return U});const U=()=>{Type.registerNamespace("Common.App.SaveToCloudStorage");I.main()}},1217:function(r,F,a){r=a(0);var c=a(85),b=a(15),e=a(4),f=a(54),d=a(423),h=a(83);class l{constructor(C,x,B,H){this.rPc=null;this.jTb=H;this.JX=C;this.KX=x;this.PD=B;this.Zje=this.yuf.dGj;C=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");
this.sAg=C[0];this.rAg=C[1]}get yuf(){return this.rPc||(this.rPc=h.a.instance.resolve("Common.IMacOfficeOffer"))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get cwa(){return CommonUIStrings.l_OICErrorHelpLink}get tzc(){return this.Zje}get Auf(){return this.sAg}get zuf(){return this.rAg}get xuf(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.Zje?3:2}get Gub(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get b5b(){return!!this.KX}get Hub(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get el(){return CommonUIStrings.l_DefaultDialogTitle}yJd(C){this.JFb(C)}Pvd(C){this.JFb(C)}JFb(C){let x=
10;this.KX&&1===C&&(this.KX(this.PD),x=1);this.JX&&this.JX(this.PD);this.CF(x)}IOa(){d.Redirect.showHelp("OICFailure");this.CF(2)}WBd(){this.yuf.Wpf();this.CF(4)}CF(C){b.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",this.jTb,C);e.AFrameworkApplication.xvc(f.a.KKf,this.jTb,C)}dispose(){this.PD=this.JX=this.KX=null}}Object(r.a)(l,"AOICErrorDialog",null,[2]);var k=a(46),t=a(135);class n extends l{constructor(C,x,B,H){super(C,x,B,H);this.Mqa=this.hm=null;C=
document.createElement("span");C.id="errorMessageText";C.innerText=this.errorMessage;C.appendChild(document.createElement("br"));C.appendChild(document.createElement("br"));this.hm=document.createElement("a");this.hm.href="#";this.hm.innerText=this.cwa;C.appendChild(this.hm);k.a.addHandler(this.hm,"click",Object(c.a)(this,this.IOa,"oicErrorHelpLinkHandler"));x=new t.StandardDialog;x.pe=this.id;this.tzc?(B=document.createElement("span"),H=document.createElement("span"),B.innerText=this.Auf,H.innerText=
this.zuf,this.Mqa=document.createElement("a"),this.Mqa.href="#",this.Mqa.innerText=this.xuf,C.appendChild(document.createElement("br")),C.appendChild(B),C.appendChild(this.Mqa),C.appendChild(H),k.a.addHandler(this.Mqa,"click",Object(c.a)(this,this.WBd,"oicErrorMacOfferLinkHandler"))):this.b5b&&(C.appendChild(document.createElement("br")),C.appendChild(document.createElement("br")),B=document.createElement("span"),B.innerText=this.Gub,C.appendChild(B));this.b5b?(x.Ob=1,x.tc(1,this.Hub)):x.Ob=0;x.Wl(this.el,
null,this.icon,Object(c.a)(this,this.Pvd,"legacyOICErrorDialogHandler"),C);x.EW("errorMessageText")}dispose(){this.hm&&(k.a.removeHandler(this.hm,"click",Object(c.a)(this,this.IOa,"oicErrorHelpLinkHandler")),this.hm=null);this.Mqa&&(k.a.removeHandler(this.Mqa,"click",Object(c.a)(this,this.WBd,"oicErrorMacOfferLinkHandler")),this.Mqa=null);super.dispose()}}Object(r.a)(n,"OICErrorDialog",l,[]);class z{constructor(C,x,B){this.JX=x;this.KX=C;this.PD=B}get id(){return"OICErrorDialogWithDownload"}get EQe(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get cwa(){return CommonUIStrings.l_OICErrorHelpLink}get Gub(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get Hub(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get el(){return CommonUIStrings.l_DefaultDialogTitle}yJd(C){this.JFb(C)}Pvd(C){this.JFb(C)}JFb(C){let x=
10;1===C&&(this.KX(this.PD),x=1);this.JX&&this.JX(this.PD);this.CF(x)}IOa(){d.Redirect.showHelp("OICFailure");this.CF(2)}CF(C){e.AFrameworkApplication.xvc(f.a.LKf,3,C)}dispose(){this.PD=this.KX=this.JX=null}}Object(r.a)(z,"AOICErrorDialogWithDownload",null,[2]);class w extends z{constructor(C,x,B){super(C,x,B);this.hm=null;C=document.createElement("span");C.id="errorMessageText";C.innerText=this.EQe;C.appendChild(document.createElement("br"));C.appendChild(document.createElement("br"));this.hm=document.createElement("a");
this.hm.href="#";this.hm.innerText=this.cwa;C.appendChild(this.hm);k.a.addHandler(this.hm,"click",Object(c.a)(this,this.IOa,"oicErrorHelpLinkHandler"));C.appendChild(document.createElement("br"));C.appendChild(document.createElement("br"));x=document.createElement("span");x.innerText=this.Gub;C.appendChild(x);x=new t.StandardDialog;x.pe=this.id;x.Ob=1;x.tc(1,this.Hub);x.Wl(this.el,null,this.icon,Object(c.a)(this,this.Pvd,"legacyOICErrorDialogHandler"),C);x.EW("errorMessageText")}dispose(){this.hm&&
(k.a.removeHandler(this.hm,"click",Object(c.a)(this,this.IOa,"oicErrorHelpLinkHandler")),this.hm=null);super.dispose()}}Object(r.a)(w,"OICErrorDialogWithDownload",z,[]);var m=a(150);class u extends l{constructor(C,x,B,H){super(C,x,B,H);x={["errorMessage"]:this.errorMessage};x.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.cwa,["onExecute"]:I=>{this.IOa(I)}};this.tzc?(x.macOfficePreLinkText=this.Auf,x.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.xuf,
["onExecute"]:I=>{this.WBd(I)}},x.macOfficePostText=this.zuf):this.b5b&&(x.errorFileDownloadOffer=this.Gub);C=new m.a(!1,!1,!0);this.b5b?(C.Ob=1,C.tc(1,this.Hub)):C.Ob=0;C.pe=this.id;x={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:x};C.initializeAndShow(this.el,Object(c.a)(this,this.yJd,"reactOICErrorDialogHandler"),x)}}Object(r.a)(u,"ReactOICErrorDialog",l,[]);class y extends z{constructor(C,x,B){super(C,x,B);x={["errorMessage"]:this.EQe,["errorFileDownloadOffer"]:this.Gub};x.helpLink=
{["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.cwa,["onExecute"]:H=>{this.IOa(H)}};C=new m.a(!1,!1,!0);C.Ob=1;C.tc(1,this.Hub);C.pe=this.id;x={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:x};C.initializeAndShow(this.el,Object(c.a)(this,this.yJd,"reactOICErrorDialogHandler"),x)}}Object(r.a)(y,"ReactOICErrorDialogWithDownload",z,[]);a.d(F,"a",function(){return v});class v{constructor(){this.gkb=!!e.AFrameworkApplication.sa&&e.AFrameworkApplication.sa.Qa.tv}gfh(C,x,B){this.gkb?
new u(C,x,null,B):new n(C,x,null,B)}hfh(C,x,B){this.gkb?new y(C,x,B):new w(C,x,B)}ifh(C,x,B,H,I){const {ReactOICErrorDialogWithTrial:U}=a(1363),{OICErrorDialogWithTrial:S}=a(1364);this.gkb?new U(C,x,B,null,H,I):new S(C,x,B,null,H,I)}static get instance(){return v.La||(v.La=new v)}}v.La=null;Object(r.a)(v,"OICErrorDialogFactory",null,[642])},1236:function(r,F,a){var c=a(9);r=a(0);var b=a(709),e=a(21),f=a(41),d=a(1),h=a(15),l=a(30),k;(function(H){H[H.url=0]="url";H[H.ref=1]="ref";H[H.mailto=2]="mailto"})(k||
(k={}));Object(r.b)("HyperlinkSelectionState",k);var t=a(781),n=a(8),z=a(589),w=a(60),m=a(90),u=a(13);class y extends t.a{constructor(H,I,U){super(H);this.Hnb=0;this.LAb=!1;this.Z1a=null;this.oMe=!1;this.osb=!0;this.el=this.aWc=null;this.HAd=0;this.FAd=this.IAd=null;this.removeHyperLink=!1;this.location=this.cellValue=null;this.Qdi=(S,G)=>{1===S||2===S?(h.ULS.sendTraceTag(555755670,0,50,`HyperLink ${1===S?"OK":"Remove"} pressed`),this.IAd=G[y.kAi],this.HAd=G[y.Muj],this.FAd=G[y.Xnh],2===S&&(this.removeHyperLink=
!0),this.commit()):h.ULS.sendTraceTag(537157644,0,50,"HyperLink Cancel pressed")};this.X4j=(S,G)=>0!==G&&S.length?1===G?this.I2e(f.y(S,this.ea.va)||this.hKi(S),759):this.I2e(l.a.sqd(S),761):null;this.selectedRange=I;this.PL=U;this.ea=H.ea;this.sheetName=I.SheetName;this.SLa();this.$p();this.Ob=this.LAb?9:1;this.tc(1,u.a.instance.ga(4));this.LAb&&(h.ULS.sendTraceTag(509690183,0,50,"Edit HyperLink was called."),this.tc(2,u.a.instance.ga(762)));this.initializeAndShow(this.el,this.Qdi,{[y.it]:this.kc,
[y.Y4j]:this.X4j,[y.GWg]:{[y.hnh]:this.oMe,[y.Ynh]:this.Z1a,[y.HHg]:this.Hnb,[y.IHg]:this.aWc,[y.vah]:this.osb}})}get kc(){return"HyperLinkDialog"}x4e(H,I){switch(I){case 2:return H.startsWith("mailto:")?H:"mailto:"+H;case 1:return`${n.a.LNf}${this.nYh(H)}`;default:return H}}get IB(){return 526}GG(){const H=this.$;this.location=this.x4e(this.IAd,this.HAd);try{this.location=m.a.kf(this.location)}catch(S){h.ULS.sendTraceTag(537157643,0,15,"Decoding link text failed")}h.ULS.sendTraceTag(555755667,0,
50,`Committing ${k[this.HAd]} link`);this.cellValue=this.FAd.length?this.FAd:this.IAd;H.py();const I=H.oa.xa.Wb(),U=f.s(this.selectedRange);return(S,G,D)=>w.b(H.oa.xa,U,this.cellValue,this.location,this.removeHyperLink,!1,123,S,G,D,this.PL.range,I)}Vj(){const H=f.s(this.selectedRange);return()=>new z.a(H,this.cellValue,this.location)}WEh(){let H=this.PL.cell.O5a;this.PL.cell.Vva?H&&H.startsWith("mailto:")?(this.Hnb=2,H=H.substr(7)):this.Hnb=0:this.Hnb=1;return H}SLa(){d.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?
this.LAb=this.PL.bba:this.LAb=!!this.PL.EKa(64)||!!this.PL.EKa(128)}$p(){if(this.LAb){this.Z1a=this.PL.text;const H=this.WEh();H&&(this.aWc=H);this.el=u.a.instance.ga(826);this.osb=this.aWc===this.Z1a}else this.PL.text?(this.Z1a=this.PL.text,this.osb=!1):(this.Z1a="",this.osb=!0),this.Hnb=0,this.el=u.a.instance.ga(825);this.PL.RA&&(this.osb=!1,this.oMe=!0,d.EwaSettings.isChangeGateEnabled("OfficeVSO:5533269_formulaTextFixInHyperLink")&&(this.Z1a=this.PL.formulaBarText))}hKi(H){return this.ea.yb.Gk(H)}I2e(H,
I){return H?null:u.a.instance.ga(I)}nYh(H){let I,U;({sheetName:I,range:U}=f.Y(H,this.ea.va)).returnValue&&U&&(H=f.x(U,I||this.sheetName,!1));return H}}y.Y4j="validateLinkValues";y.GWg="bodyProps";y.hnh="disableDisplayText";y.Ynh="displayTextValue";y.HHg="activeLinkOption";y.IHg="activeLinkValue";y.vah="copyLinkValueToDisplay";y.kAi="linkValue";y.Muj="selectedLink";y.Xnh="displayText";Object(r.a)(y,"HyperlinkDialog",t.a,[]);var v=a(55);class C{constructor(H,I){this.$=H;this.gridView=I}Hc(){return!1}wc(H,
I){return 1===H&&-1583422759===I.command}Nc(){return!1}executeCommand(){this.oJj();return v.Task.Sa(!0)}oJj(){const H=f.v(this.gridView.ha.qa.ld,this.$),I=e.f(this.gridView);(!d.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.Us([this.gridView.ha.qa.ld],!0))&&I&&new y(this.$,H,I)}}Object(r.a)(C,"ShowHyperlinkCommandHandler",null,[222]);class x extends b.a{constructor(H){super(H)}hd(){this.$c([new C(this.$,e.h(this.$))])}static ka(H){b.a.Md(105,
new x(H))}}Object(r.a)(x,"ShowHyperlinkCommandHandlerFactory",b.a,[]);a.d(F,"a",function(){return B});const B=()=>{c.a.Fa(x.ka)}},1237:function(r,F,a){var c=a(9);r=a(0);var b=a(4),e=a(108),f=a(709),d=a(60),h=a(50),l=a(37),k=a(15),t=a(189),n=a(25),z=a(55);class w{constructor(x,B){this.$=x;this.hh=B}Hc(){return!1}executeCommand(x,B,H){x=2;switch(B.command){case -309686558:x=this.hh.Vd(n.a.saveACopy,2,H);break;case 617689800:x=this.hh.Vd(n.a.saveToCloudStorage,2,H);break;case -1244760097:x=this.hh.Vd(n.a.saveToSharePoint,
2,H)}return 2===x&&B?t.a(B.command):z.Task.Sa(!0)}wc(x,B){x=!1;switch(B.command){case -1244760097:case -309686558:case 617689800:x=!0,k.ULS.shipAssertTag(537153984,0,this.$.Gka,"Command execute requested for SaveAs operation when data duplication is disallowed.")}return x}Nc(){return!1}}Object(r.a)(w,"SaveToHostCommandHandler",null,[222]);class m extends f.a{constructor(x){super(x);this.JJh=(B,H,I,U,S)=>1===I?32:B===n.a.uRa&&2===I?(B=this.$.oa.xa.Wb(),d.C(this.$.oa.xa,S[0],S[1],null,null,B),32):8}hd(){l.TaskExtensions.za(h.GetServiceTaskFactory.create(this.$.da,
155,this.la,this.Xa),()=>{this.$c([new w(this.$,b.AFrameworkApplication.rb)])},this.la,3);b.AFrameworkApplication.rb.Nb(n.a.uRa,e.a.frame,this.JJh)}static ka(x){f.a.Md(267,new m(x))}}Object(r.a)(m,"SaveToHostCommandHandlerFactory",f.a,[]);var u=a(226);class y{constructor(x,B){this.$=x;this.hh=B;this.$.da.Ha(393,this)}Hc(x){switch(x){case -309686558:return 8===this.hh.processAction(n.a.saveACopy,1,null);case 617689800:return 8===this.hh.Vd(n.a.saveToCloudStorage,1,null);case -1244760097:return 8===
this.hh.Vd(n.a.saveToSharePoint,1,null)}return!1}dispose(){this.$=null}}Object(r.a)(y,"SaveToHostManager",null,[462,2]);class v extends u.a{constructor(x){super();this.$=x;this.Db()}create(){this.nb(this.$.da.Aa(393)||new y(this.$,b.AFrameworkApplication.rb))}static ka(x){x.da.Ha(394,new v(x))}}Object(r.a)(v,"SaveToHostManagerFactory",u.a,[]);a.d(F,"a",function(){return C});const C=()=>{c.a.Fa(m.ka);c.a.Fa(v.ka)}},1238:function(r,F,a){var c=a(9);r=a(0);var b=a(226),e=a(15),f=a(84),d=a(118),h=a(29),
l=a(36);class k extends d.a{constructor(G,D){super(G,D)}execute(G){const D=Object(f.a)(7,G.Ee);e.ULS.shipAssertTag(537153921,0,h.a.kpb(G.errors),"SessionReloadActivity.Execute: Only recoverable errors should reach this activity.");D.YH(!0,!0);G.activityState[l.a.YZb]=D.ea.sessionId;G.activityState[l.a.Knb]=!0;G.activityState[l.a.d_b]=!0;e.ULS.sendTraceTag(537153920,0,50,"SessionReloadActivity.Execute: session is going to reopen from cached state");return 3}}Object(r.a)(k,"SessionReloadActivity",d.a,
[]);var t=a(6);class n extends b.a{constructor(){super();this.Db()}create(){this.nb(new k(t.a.xdb,t.a.Sy))}static ka(G){G.da.Ha(142,new n)}}Object(r.a)(n,"SessionReloadActivityFactory",b.a,[]);var z=a(59),w=a(270),m=a(114),u=a(48),y=a(44),v=a(35),C=a(1),x=a(42),B=a(248),H=a(119);class I extends d.a{constructor(G,D,E,N,M){super(G,D);I.kyd=[-1468309555,611268539,-2087635043,2100961153,810218235,1112506702];I.jyd=[-1468309555,-315732528,-399065540,810218235,1531005923,1593924569,1112506702,1220851643];
I.suf=[-1468309555,611268539,-1750576502,61029505];I.ruf=[-1468309555,-315732528,1112506702,-238814601,-1750576502,61029505,-1337545025];this.iAc=E;this.aLj=N;this.sUj=M}execute(G){var D=Object(f.a)(7,G.Ee);G.activityState[l.a.Ora]=!0;var E=I.L3h(G);if(I.REj(G,E))return I.PGi(G),E=50,0<G.errors.length&&(E=15),e.ULS.sendTraceTag(537153891,0,E,`SessionReloadSilentActivity.ShouldCancelReload: ignore session reload, remaining errors : ${h.a.nc(G.errors)}`),G.activityState[l.a.Ora]=!1,this.gh(t.a.idle),
3;switch(E){case 1:case 3:this.Vii(G,E);break;case 2:this.Uii(G);break;case 0:G.activityState[l.a.HYa]=null}e.ULS.sendTraceTag(21837003,0,50,`SessionReloadSilentActivity.Execute: silentReloadType:${E}. activityName:${this.activityName}. NextActivityName:${this.u_}. TimeFromLastStatefulResponse:${D.ea.VW}.`);var N=v.a.lg(G.activityState,H.a.Tfb);e.ULS.shipAssertTag(40502925,0,!N||N&&(1===E||3===E),`triggerSilentReloadAfterTokenRefresh: ${N}, silentReloadType: ${E}`);D=D.Uk.reloadCount;return 0!==E&&
0<D?(N=w.a.PKa(D,200),e.ULS.sendTraceTag(537153890,0,50,`SessionReloadSilentActivity.Execute: schedule Silent-Type [${E}] retryNum [${D}] delayInMs [${N}] activityName [${this.activityName}]`),u.a.instance.create(()=>{I.lM(G)},N,y.a.Twj),1):3}Vii(G,D){e.ULS.sendTraceTag(8438495,0,50,"SessionReloadSilentActivity.InitiateSilentReopen: Silent reopen triggered");const E=Object(f.a)(7,G.Ee);G.activityState[l.a.Knb]=!0;E.Xgc||x.PageLoadTrackingInfo.instance.Ij("ReopenOnLoad");!I.isEditMode(G)&&h.a.kpb(G.errors)&&
(e.ULS.sendTraceTag(537153889,0,50,"SessionReloadSilentActivity.ShouldAttemptViewSilentReopen: session is going to reopen from cached state"),G.activityState[l.a.YZb]=E.ea.sessionId,G.activityState[l.a.d_b]=!0);G.Dyd();3===D?(E.ea.Bf()||E.ea.mMi(),E.YH(!0,!0),this.gh(this.sUj),G.activityState[l.a.Zne]=E.workbookContext.CalcMode):(C.EwaSettings.isChangeGateEnabled("OfficeVSO:5678588_FixSilentReopenAfterTokenRefresh")&&1===D&&E.YH(!0,!0),G.activityState[l.a.kWc]=!1,this.gh(this.iAc))}Uii(G){e.ULS.sendTraceTag(537153888,
0,15,"SessionReloadSilentActivity.InitiateSilentRefresh: Silent refresh triggered");G.activityState[l.a.HYa]=null;G.Dyd();this.gh(this.aLj);G=Object(f.a)(7,G.Ee);G.Xgc||(x.PageLoadTrackingInfo.instance.Ij("RefreshOnLoad"),G.qKb())}static lM(G){G.lM()}static L3h(G){const D=Object(f.a)(7,G.Ee),E=D.ea,N=I.isEditMode(G);var M=h.a.dh(G.errors,N?I.jyd:I.kyd);const L=h.a.dh(G.errors,N?I.ruf:I.suf),aa=D.SM,V=D.Uk.reloadCount,P=D.ya.MaxConsecutiveSilentReloadAllowed,ba=D.Uk.ebf(),Y=h.a.nc(G.errors),Z=h.a.nc(G.uza),
ea=0<h.a.yM(xa=>!xa.triggerSilentReopenOnly,G.errors).length;let ra=M;const O=v.a.lg(G.activityState,H.a.Tfb);O&&(ra=!0);const da={name:"SessionReloadSilentActivity.GetSilentReloadType"};da.editMode=N;da.isSilentReopenError=M;da.isSilentRefreshError=L;da.reloadSequenceCount=D.Uk.xQa;da.reloadCount=V;da.maxReloads=P;da.stopSilentReloads=ba;da.errorNames=Y;da.processedErrorNames=Z;da.isClientDirty=aa;da.errorsForSilentReopenOnly=ea;da.triggerSilentReloadAfterTokenRefresh=O;da.IsReopenDisabled=D.UMa;
M=z.a.Dc(da);e.ULS.sendTraceTag(21837004,0,50,M);if(!ba){if(ra&&(N?I.HEj(G):I.KEj(G)))return B.a.$7f(G,D)?3:D.UMa?2:1;if(L&&(N||!E.Nbb))return 2}return 0}static REj(G,D){for(const E of G.errors)if(-1337545025===E.MessageId||-238814601===E.MessageId)return!1;return h.a.yM(E=>!E.triggerSilentReopenOnly,G.errors).length?3!==D:!1}static PGi(G){const D=h.a.yM(E=>!E.triggerSilentReopenOnly,G.errors);for(const E of D)G.hca(E)}static isEditMode(G){const D=Object(f.a)(7,G.Ee);return D.ea.Xb?D.ut&&!!(D.qd&
64):v.a.lg(G.activityState,l.a.Kr)}static KEj(G){const D=Object(f.a)(7,G.Ee),E=h.a.L3(G.errors,I.kyd);if(m.b(E,N=>N.ForceVersionUpgrade))return!1;G=h.a.kpb(G.errors);return!D.ea.Nbb||G?!0:!1}static HEj(G){G=h.a.L3(G.errors,I.jyd);return!m.b(G,D=>D.ForceVersionUpgrade)}}I.kyd=null;I.jyd=null;I.suf=null;I.ruf=null;Object(r.a)(I,"SessionReloadSilentActivity",d.a,[]);class U extends b.a{constructor(G,D){super();this.activityName=G;this.wJ=D;this.Db()}create(){this.nb(new I(this.activityName,this.wJ,t.a.Sy,
t.a.Fi,t.a.uPb))}static ka(G){G.da.Ha(143,new U(t.a.Dna,t.a.O1b));G.da.Ha(144,new U(t.a.Qxc,t.a.sPa));G.da.Ha(145,new U(t.a.Rxc,t.a.$Ed));G.da.Ha(154,new U(t.a.ydb,t.a.DO))}}Object(r.a)(U,"SessionReloadSilentActivityFactory",b.a,[]);a.d(F,"a",function(){return S});const S=()=>{c.a.Fa(G=>{n.ka(G);U.ka(G)})}},1249:function(r,F,a){var c=a(9);r=a(0);var b=a(226),e=a(15),f=a(84),d=a(244),h=a(320),l=a(29),k=a(13),t=a(386),n=a(90);class z extends t.a{constructor(C,x){super(C,x);this.Wpa=0;this.Ar()}get kc(){return"SharedWorkbookDialog"}get Ftb(){return this.Wpa}kO(C,
x){this.Wpa=C;super.kO(C,x)}Ar(){super.Ar();this.Ob=9;const C=this.fYh();this.tc(1,k.a.instance.ga(1663));this.tc(2,k.a.instance.ga(993));this.Wl(k.a.instance.ga(701),n.a.kf(C),this.icon,this.s7)}fYh(){return String.format(k.a.instance.ga(702))}}Object(r.a)(z,"LegacySharedWorkbookDialog",t.a,[]);var w=a(6),m=a(36);class u extends d.a{constructor(C,x,B){super(C,x);this.executionContext=null;this.Tzi=H=>{const I=this.Ds.gd,U=Object(f.a)(7,I.Ee);let S;S=H.Ftb;this.unsubscribe(G=>{H.remove_disposing(G)});
for(let G=0,D=I.errors.length;G<D;G++)-573864504===I.errors[G].MessageId&&I.hca(I.errors[G]);switch(S){case 1:U.ea.gDc=!0;e.ULS.sendTraceTag(537155485,0,50,"LegacySharedWorkbookActivity.LegacySharedDialogDisposing: User has selected to turn off the Legacy Shared Workbook setting ");this.gh(U.isEditMode?w.a.uPb:this.rkh);this.kp();break;case 2:this.gh(w.a.openInExcelClient);this.kp();break;case 0:I.activityState[m.a.Kr]=!1,this.gh(this.EJ),this.kp()}};this.rkh=x;this.EJ=B}initialize(C){super.initialize(C)}execute(C){this.executionContext=
C;this.G5c();return 1}xI(C){super.xI(C)}G5c(){const C=Object(f.a)(7,this.executionContext.Ee),x=l.a.C_a([-573864504]);x[0].HelpDescription=k.a.instance.ga(704);x[0].HelpTopicId=h.a.Uzi;const B=new z(C,x[0]);this.subscribe(this.executionContext,this.Tzi,H=>{B.add_disposing(H)})}}Object(r.a)(u,"LegacySharedWorkbookActivity",d.a,[]);class y extends b.a{constructor(C,x,B,H){super();this.activityName=C;this.wJ=x;this.EJ=B;this.$=H;this.Db()}create(){this.nb(new u(this.activityName,this.wJ,this.EJ))}static ka(C){C.da.Ha(460,
new y(w.a.vDb,w.a.Pfb,C.uCb?w.a.Kj:w.a.Crb,C))}}Object(r.a)(y,"LegacySharedWorkbookActivityFactory",b.a,[]);a.d(F,"a",function(){return v});const v=()=>{c.a.Fa(y.ka)}},1272:function(r,F,a){function c(x){const B=f(x);let H=[];if(0===B&&1===x.length)return H.push({destination:x[0],source:null,ijc:!1}),H;for(let I=0;I<=B;I++){const U=x.filter(S=>S.qja().topLeft.Y===I);for(let S=0;S+1<U.length;S+=1)H.push({destination:U[S],source:U[S+1],ijc:!1})}z.ULS.sendTraceTag(509658E3,0,50,`GridInstantaneousAction.getBlockPairsInViewport parameter = blockPairsLength, value=${H.length}`);
return H}function b(x,B){let H;const I=t.HelperMethods.gR(()=>{H=gridRenderer.CanvasRendererGlobals.hideRowCols(x,B,!1)});d("HideRowCols",I);return H}function e(x,B,H,I){x=gridRenderer.CanvasRendererGlobals.performModelCascade(x,B,H,I);x.metric&&d("ModelCascade",x.metric.Z9j);return x}function f(x){let B=-1;for(let H=0;H<x.length;H++){const I=x[H].qja().topLeft.Y;I>B&&(B=I)}return B}function d(x,B){z.ULS.sendTraceTag(509723719,0,50,`GridInstantaneousAction: Time taken to complete operation=${x} is time=${B}`)}
var h=a(9);r=a(0);var l=a(226),k=a(21),t=a(11),n=a(174),z=a(15),w=a(1),m=a(61);class u{constructor(x){this.$=x;this.gridView=k.h(this.$);this.Ca=this.gridView.Ca;this.FBb=!1;this.RJe=this.$.ea.se;this.LKb={};this.C4={}}dispose(){this.gridView=this.$=null;this.C4={};this.FBb=!1;this.LKb={}}DUg(x){if(this.FBb)z.ULS.sendTraceTag(509658009,0,15,`GridInstantaneousAction.attemptInstantaneousGridAction command=${x}, parameter = isProcessing, value=true, reason = AttemptInstantaneousGridAction is still processing, isRow=false`);
else{var B=this.Ca.NPh(),H=c(B);this.C4={};this.yqi(x,B,H)&&(this.FBb=!0,this.xPf(x,!1,H,B))}}yqi(x,B,H){var I=this.gridView;if(-706918724!==x||I.rtl)return!1;var U=I.Mj("GridInstantaneousAction");if(!Object(m.c)(U))return z.ULS.sendTraceTag(509658008,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${x}, parameter = ActiveSheetProcessedData, value=null, isRow=false`),!1;I=I.ha.qa.selectedRanges;const S=I.length;if(1<S)return z.ULS.sendTraceTag(509658007,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${x}, parameter = SelectedRanges, value=${S}, reason = Discontinuous selection, isRow=false`),
!1;if(U.value.zBb(I[0]))return z.ULS.sendTraceTag(509658006,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${x}, parameter = isPartOfRangeHidden, value=true, isRow=false`),!1;U=I[0].right-I[0].left+1;if(U>w.EwaSettings.$Gi())return z.ULS.sendTraceTag(509658005,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${x}, parameter = ColumnCount, value=${U}, reason = Multiple columns selected, isRow=false`),!1;B=B.length;if(B>w.EwaSettings.ZGi())return z.ULS.sendTraceTag(509658004,
0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${x}, parameter = BlocksInViewport, value=${B}, reason = Blocks in viewport limit exceeded, isRow=false`),!1;a:{for(G of H){if(!G||!G.source||!G.destination){z.ULS.sendTraceTag(509649925,0,50,"GridInstantaneousAction.canRowColCascade: blockPair or sourceBlock or destinationBlock is null");var G=!1;break a}B=G.source.Wd.GridBlockModel;if(!gridRenderer.CanvasRendererGlobals.canRowColCascade(B,B.ColumnNumbers[0],!1)){G=!1;break a}}G=
!0}if(!G)return z.ULS.sendTraceTag(509658003,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${x}, parameter = canRowColCascade, value=false, reason = Model has complex cells, isRow=false`),!1;I=I[0];G=0;for(let D of H)if(D.destination.De.zd(I)||D.destination.De.left>I.right)G+=1;H=G;if(H>w.EwaSettings.cHi())return z.ULS.sendTraceTag(509658002,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${x}, parameter = TransitionCount, value=${H}, reason = Transition count limit exceeded, isRow=false`),
!1;z.ULS.sendTraceTag(509658001,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${x}, parameter = isInstantaneousGridActionPossible, value=true, reason = isInstantaneousGridActionPossible successful, isRow=false`);return!0}xPf(x,B,H,I){try{const U=t.HelperMethods.Kb(),S=w.EwaSettings.bHi();let G=H.filter(D=>!D.ijc);for(let D of G){if(this.$me("WebServiceResponseReceivedInProcessGridAction",I,x))return;const E=this.gridView.ha.qa.selectedRanges[0],N=D.destination.De.right;if(N<
E.left){D.ijc=!0;z.ULS.sendTraceTag(509657999,0,50,`GridInstantaneousAction.processGridAction command=${x}, parameter = BlockRangeLessThanSelectedRange, selectedRangeLeftValue=${E.left}, blockRangeRightMostValue=${N}, hashCode=${D.destination.Zc}, isRow=false`);continue}const M=B?E.topLeft.top:E.topLeft.left,L=this.R0e("SourceModel",D.source),aa=this.R0e("DestinationModel",D.destination),V=D.destination.Zc;if(D.destination.De.zd(E)){if(!b(aa,M)){this.Ira();z.ULS.sendTraceTag(509657998,0,15,`GridInstantaneousAction.processGridAction command=${x}, parameter = isHideColumnSuccessful, value=false, reason = "HideRowColOperation was failure", hashCode=${V}, isRow=${B}, rowColNumber=${M}`);
return}z.ULS.sendTraceTag(509657997,0,50,`GridInstantaneousAction.processGridAction command=${x}, parameter = isHideColumnSuccessful, value=true, reason = "HideRowColOperation was successful", hashCode=${V}, isRow=${B}, rowColNumber=${M}`)}const P=L.ColumnNumbers[0],ba=D.source.Zc;if(e(L,aa,P,B).isSuccess)D.ijc=!0,z.ULS.sendTraceTag(509657996,0,50,`GridInstantaneousAction.processGridAction command=${x}, parameter = cascadeResult.isSuccess, value=true, reason = "CascadeResult was successful", hashCode=${ba}, isRow=${B}, rowColNumber=${P}`);
else{this.Ira();z.ULS.sendTraceTag(509657995,0,15,`GridInstantaneousAction.processGridAction command=${x}, parameter = cascadeResult.isSuccess, value=false, reason = "CascadeResult was failure", hashCode=${ba}, isRow=${B}, rowColNumber=${P}`);return}this.bPj(aa,L,D);if(t.HelperMethods.Kb()-U>S){this.rtj(x,B,G,I);return}}this.K7g(B,x,I);d("ProcessGridAction",t.HelperMethods.Kb()-U)}catch(U){this.K9h(U)}}K7g(x,B,H){if(!this.$me("CommitGridInstantaneousActionResults",H,B)){var I=t.HelperMethods.Kb();
if(this.C4&&0!==Object.keys(this.C4).length)if(this.v6i(H),this.krg(B,H)){var U=n.a.create().toString(),S=this.gridView.Mj("GridInstantaneousAction");Object(m.c)(S)?(S.value.G0d(this.gridView.ha.qa.selectedRanges,0,x),B=Object.keys(this.C4),this.Ca.zQf(B,U,x?"row":"column",!0),this.FBb=!1,d("CommitGridInstantaneousActionResults",t.HelperMethods.Kb()-I)):(this.UZf(H),this.Ira(),z.ULS.sendTraceTag(509645768,0,50,`GridInstantaneousAction.commitGridInstantaneousActionResults command=${B}, parameter = ActiveSheetProcessedData, value=null, isRow=${x}`))}else this.UZf(H),
this.Ira();else this.Ira(),z.ULS.sendTraceTag(509657994,0,50,`GridInstantaneousAction.commitGridInstantaneousActionResults command=${B}, parameter = interimModels, value=false, reason = "InterimModels was null", isRow=${x}`)}}R0e(x,B){let H=this.C4[B.Zc];if(!H){const I=t.HelperMethods.gR(()=>{H=B.tRh()});d(x,I)}return H}v6i(x){for(let B of x)x=B.Zc,this.LKb[x]||(this.LKb[x]=B.N6e())}UZf(x){for(let B of x){x=B.Zc;const H=this.LKb[x];if(H&&!B.RXf(H)){z.ULS.sendTraceTag(509653846,0,15,`GridInstantaneousAction.restoreBlockModels parameter = isModelRestored, value=false, hashCode=${x}`);
this.Ira();break}}}krg(x,B){for(let H of B)if(B=H.Zc,this.C4[B]&&!H.RXf(this.C4[B]))return z.ULS.sendTraceTag(509657993,0,15,`GridInstantaneousAction.UpdateModelsInBlockCacheSuccessful command=${x}, parameter = isModelUpdated, value=false, reason = "Response Model not updated", hashCode=${B}, isRow=false`),!1;return!0}rtj(x,B,H,I){window.setTimeout(()=>{this.xPf(x,B,H,I)},0)}gwi(x){for(let B of x)if(B.Wd.Information.Revision>this.RJe)return!0;return!1}$me(x,B,H){return this.gwi(B)?(this.RJe=this.$.ea.se,
this.Ira(),z.ULS.sendTraceTag(509657992,0,50,`GridInstantaneousAction.abortIfServerResponseReceived command=${H}, parameter = ${x}, value=true, reason = "Server response received before completing client side estimation", isRow=false`),!0):!1}Ira(){this.C4={};this.FBb=!1;this.LKb={}}K9h(x){this.Ira();z.ULS.sendTraceTag(509723721,0,10,`${"GridInstantaneousAction.ProcessGridAction"} encountered exception ${x}.`)}bPj(x,B,H){this.C4[H.destination.Zc]=x;this.C4[H.source.Zc]=B}}Object(r.a)(u,"GridInstantaneousAction",
null,[445]);var y=a(712);class v extends l.a{constructor(x){super();this.$=x;this.Db()}create(){this.nb(Object(y.a)(this.$.da,528,()=>new u(this.$)))}static ka(x){x.da.Ha(529,new v(x))}}Object(r.a)(v,"GridInstantaneousActionFactory",l.a,[]);a.d(F,"a",function(){return C});const C=()=>{h.a.Fa(x=>{v.ka(x)})}},1273:function(r,F,a){r=a(0);var c=a(1311),b=a(1312),e=a(4);class f{constructor(){this.g8d=this.$a=null}get name(){return"Common.App.DirectPrint"}Bh(l){this.$a=l;l.register(c.a,"Common.App.DirectPrint.DirectPrintDialogFactory").qc().yc(()=>
new c.a(e.AFrameworkApplication.sa.RW));l.register(457,"Common.App.DirectPrint.IDirectPrintManager").qc().yc(()=>b.a.create(this.$a))}init(){this.g8d=this.$a.resolve("Common.App.DirectPrint.IDirectPrintManager");this.g8d.start()}dispose(){}}Object(r.a)(f,"PackageManager",null,[3,4]);var d=a(251);a.d(F,"a",function(){return h});const h=()=>{Type.registerNamespace("Common.App.DirectPrint");d.a.instance.ii(new f)}},1286:function(r,F,a){r=a(0);var c=a(15),b=a(4),e=a(89),f=a(133),d=a(264),h=a(27),l=a(38),
k=a(81),t;(function(P){P[P.unableToRefreshLock=0]="unableToRefreshLock";P[P.unableToRefreshLockExpected=1]="unableToRefreshLockExpected";P[P.workbookAlmostTooLarge=2]="workbookAlmostTooLarge";P[P.workbookTooLarge=3]="workbookTooLarge";P[P.externalWorkbookLinksDisabled=4]="externalWorkbookLinksDisabled";P[P.externalWorkbookLinksShowError=5]="externalWorkbookLinksShowError";P[P.editAndRefreshDisabledOnBIAHostedFiles=6]="editAndRefreshDisabledOnBIAHostedFiles";P[P.unsupportedFeatures=7]="unsupportedFeatures";
P[P.collabDataAndDataStringsLocaleMismatch=8]="collabDataAndDataStringsLocaleMismatch";P[P.collabDataStringsLocaleMismatch=9]="collabDataStringsLocaleMismatch";P[P.collabDataLocaleMismatch=10]="collabDataLocaleMismatch";P[P.lastGenericStatusError=11]="lastGenericStatusError";P[P.scratchPadWarning=12]="scratchPadWarning";P[P.authenticationLost=13]="authenticationLost";P[P.odfCompatibilityIssues=14]="odfCompatibilityIssues";P[P.pivotChartInteractivityMissingWarning=15]="pivotChartInteractivityMissingWarning";
P[P.workbookIsIrmProtected=16]="workbookIsIrmProtected";P[P.biFeatureNotAvailable=17]="biFeatureNotAvailable";P[P.anonymousCreateSaveWarning=18]="anonymousCreateSaveWarning";P[P.unsupportedInteractiveReportEditing=19]="unsupportedInteractiveReportEditing";P[P.mobileAppCampaignBizBar=20]="mobileAppCampaignBizBar";P[P.transientServerCommunicationFailures=21]="transientServerCommunicationFailures";P[P.editAttemptInReadOnly=22]="editAttemptInReadOnly";P[P.editAttemptInReadOnlyNoEditPermissions=23]="editAttemptInReadOnlyNoEditPermissions";
P[P.unsupportedBrowser=24]="unsupportedBrowser";P[P.readOnlyPermissions=25]="readOnlyPermissions";P[P.documentIsIrmProtectedWarning=26]="documentIsIrmProtectedWarning";P[P.policyWarningMessage=27]="policyWarningMessage";P[P.workingOnIt=28]="workingOnIt";P[P.passwordProtectedWorkbookLockedForEdit=29]="passwordProtectedWorkbookLockedForEdit";P[P.workbookIsReadOnlyRecommended=30]="workbookIsReadOnlyRecommended";P[P.workbookHasPasswordToModify=31]="workbookHasPasswordToModify";P[P.legacySharedWorkbookEditWarningBB=
32]="legacySharedWorkbookEditWarningBB";P[P.legacyConnectionsBB=33]="legacyConnectionsBB";P[P.tooManyLoadBlockingFloatingObjectsBB=34]="tooManyLoadBlockingFloatingObjectsBB";P[P.groupedSlicersBB=35]="groupedSlicersBB";P[P.thirdPartyAddinDisabled=36]="thirdPartyAddinDisabled";P[P.financeLinkedEntityDisclaimerBar=37]="financeLinkedEntityDisclaimerBar";P[P.wolframDeprecationAlertBar=38]="wolframDeprecationAlertBar";P[P.wacGdprNotice=39]="wacGdprNotice";P[P.automaticSensitivityLabel=40]="automaticSensitivityLabel";
P[P.recommendedSensitivityLabel=41]="recommendedSensitivityLabel";P[P.mandatorySensitivityLabel=42]="mandatorySensitivityLabel";P[P.localStorageDisabled=43]="localStorageDisabled";P[P.autoRefreshDisabled=44]="autoRefreshDisabled";P[P.corruptedFileRepaired=45]="corruptedFileRepaired";P[P.corruptedOdsFileRepaired=46]="corruptedOdsFileRepaired";P[P.minorVersionLimitReached=47]="minorVersionLimitReached";P[P.sensitivityApplicationGenericError=48]="sensitivityApplicationGenericError";P[P.sensitivityApplicationTooLargeFileError=
49]="sensitivityApplicationTooLargeFileError";P[P.sensitivityApplicationLabelNotSupportedError=50]="sensitivityApplicationLabelNotSupportedError";P[P.sensitivityApplicationLabelDisabledError=51]="sensitivityApplicationLabelDisabledError";P[P.sensitivityApplicationMandatoryConflictError=52]="sensitivityApplicationMandatoryConflictError";P[P.sensitivityApplicationMinorVersionLimitReachedError=53]="sensitivityApplicationMinorVersionLimitReachedError";P[P.sensitivityApplicationSetLabelError=54]="sensitivityApplicationSetLabelError";
P[P.promptEnableExternalLinks=55]="promptEnableExternalLinks";P[P.networkDown=56]="networkDown";P[P.defaultToViewDueToCogs=57]="defaultToViewDueToCogs";P[P.refreshLinkedEntityErrorBar=58]="refreshLinkedEntityErrorBar";P[P.promptEnableLinkedEntitiesUntrustedImages=59]="promptEnableLinkedEntitiesUntrustedImages";P[P.canvasHealth=60]="canvasHealth";P[P.mismatchedFileFormatConverted=61]="mismatchedFileFormatConverted";P[P.optimizeWorkbook=62]="optimizeWorkbook";P[P.novModePostDepreciation=63]="novModePostDepreciation";
P[P.officeScriptsRunning=64]="officeScriptsRunning";P[P.powerQueryRefreshDataSourceNotSupported=65]="powerQueryRefreshDataSourceNotSupported";P[P.readOnlyPivotTable=66]="readOnlyPivotTable";P[P.powerQueryRefreshHostNotSupported=67]="powerQueryRefreshHostNotSupported";P[P.refreshPageAfterEnablingTheExtension=68]="refreshPageAfterEnablingTheExtension";P[P.msFormsDataSyncStatus=69]="msFormsDataSyncStatus";P[P.count=70]="count"})(t||(t={}));Object(r.b)("EwaBusinessBarEntryType",t);var n=a(5),z=a(1078);
class w extends Sys.EventArgs{constructor(P,ba,Y=null){super();this.G_a=P;this.U8c=ba;this.data=Y}}Object(r.a)(w,"BusinessBarEntryDisplayChangedEventArgs",Sys.EventArgs,[]);var m=a(1080),u=a(1079),y=a(1082);a(1081);var v=a(1076),C=a(476),x=a(50),B=a(37),H=a(654),I=a(29),U=a(1),S=a(22),G=a(21),D=a(58),E=a(73),N=a(853),M=a(33),L=a(39);a.d(F,"a",function(){return V});const aa=[55,39,5,30,16,14,7,41,4];class V extends k.a{constructor(P,ba){super();this.Pa=new l.a;this.sP=null;this.kKc=[];this.Goc=()=>
{this.$.oa.hMa?this.removeEntry(13):this.ih(13,null)};this.eh=(Y,Z)=>{for(let ea=0,ra=V.Sdc().length;ea<ra;ea++)Y=V.Sdc()[ea],this.removeEntry(Y);Z.context&&0<Z.context.communicationErrorRetryCount&&(c.ULS.sendTraceTag(537170240,0,50,"OnWebMethodSuccess: retry due to previous communication failure succeeded, turning off the TransientServerCommunicationFailures business bar"),this.removeEntry(21));this.Vmj()};this.wm=(Y,Z)=>{var ea;Y=this.GGh(Z.errors);let ra=[];for(let da=0,xa=Y.length;da<xa;++da){const ia=
Y[da];if(1===ia.Type&&ia.Appearance&32)ra=this.mai(ia,ra);else if(Z.Gwj){c.ULS.sendTraceTag(537170210,0,50,"OnWebMethodError: Server communication failure detected, turning on the TransientServerCommunicationFailures business bar");var O=(null===(ea=Z.context)||void 0===ea?0:ea.stopwatch)?Z.context.stopwatch.Bc:-1;5E3>O?c.ULS.sendTraceTag(537170208,0,50,`OnWebMethodError:  communication errors duration is below the min time for notification, skipping raise of business bar (duration = ${O}ms).`):b.AFrameworkApplication.Uui()||
this.qLg(ia,Z.context.methodName)}O=[...V.Sdc()];for(let Ma=0,Ta=ra.length;Ma<Ta;++Ma){const Da=ra[Ma];this.ih(Da,ia);Array.remove(O,Da)}for(let Ma=0,Ta=O.length;Ma<Ta;++Ma)this.removeEntry(O[Ma])}};this.Rc=(Y,Z)=>{this.uc(Y,Z)};this.uc=()=>{const Y=this.$.ea;Y.Xb||Y.Bf()||(this.eLd(),this.kKc.length=0)};this.dd=(Y,Z)=>{this.$.ea.Bf()&&!Z.nV||this.kef(Z.nV)};this.eHb=()=>{const Y=this.$.userOperationManager.Edc();Y&&Y.operation.flags&1&&this.Y9f()};this.VDf=()=>{this.Y9f()};this.tf=()=>{this.OBe();
this.f$f()};this.uN=()=>{if(this.$.d5&&this.$.ea.Bf()&&this.$.ea.Xb)if(this.$.ea.isEditMode)this.removeEntry(45),this.removeEntry(12),this.removeEntry(29),this.removeEntry(30),this.removeEntry(31),this.removeEntry(32),this.removeEntry(34),this.removeEntry(22),this.removeEntry(57);else{const Y=this.$.da.Aa(331);Y&&Y.BJa||this.removeEntry(55);this.removeEntry(5)}};this.$=P;this.xZa=ba;this.QTg();b.AFrameworkApplication.Bd&&b.AFrameworkApplication.Bd.NWc(this);this.KFa=Array(70);for(let Y=0;70>Y;Y++)this.KFa[Y]=
null;this.uh=H.EcmaDateClock.instance;this.Mof=this.uh.Ub.getTime();ba&&(ba=P.oa,ba.rx(this.wm),ba.$q(this.eh),ba.iob(this.Goc),ba.SYa(this.Goc),P.ea.Jj(this.Rc),P.ea.$t(this.tf),P.Lk(this.dd),P.nj(this.uc),P.ea.l2(this.uN),P.userOperationManager.Zq(this.eHb),U.EwaSettings.ra(158)&&P.ea.wg.get(45)&&b.AFrameworkApplication.fa.pa("SupportsPolicies")||this.V$e(),this.kef(D.c(P)));P.da.Ha(5,this);M.a.Ujc()&&(this.$.PNb=this.Yli())}V$e(){I.a.qq(this.$.ea.rF)&&this.wm(this,new C.a(this.$.ea.rF,null,!1,
-1,-1,-1,-1,"",-1,"",-1))}VLg(P){this.Pa.addHandler("bBarAttachedOrDetached",P)}get V9c(){return this.kKc}get domElement(){return this.sP?this.sP.domElement:null}dispose(){if(this.$){const P=this.$,ba=P.oa;ba.ny(this.wm);ba.ps(this.eh);ba.Cuc(this.Goc);ba.PJb(this.Goc);P.ea.ik(this.Rc);P.ea.Av(this.tf);P.pl(this.dd);P.ol(this.uc);P.ea.K6(this.uN);P.userOperationManager.Un(this.eHb);G.h(P).Vb.nl(this.VDf)}e.a.Ja(this.sP);this.$=this.sP=null;super.dispose()}Yli(){for(let P=0;P<aa.length;P++)if(this.KFa[aa[P]])return!0;
return!1}zmi(P){switch(P){case 4:case 5:case 11:case 55:case 59:case 7:case 37:case 38:return!0;default:return!1}}ih(P,ba,Y=null,Z=null,ea=null){if(!this.$.isMobileMode||this.zmi(P))this.xZa&&!this.JG(P)&&(this.KFa[P]=this.uh.Jea,this.sP.gE(P,ba,Z,ea),M.a.Ujc()&&this.a_j(P),this.Pa.raiseEvent("bBarAttachedOrDetached",new w(P,!0,Y))),ba&&32===ba.Appearance&&E.a(this.$).gd.hca(ba)}dJj(P,ba,Y,Z){c.ULS.sendTraceTag(537170253,0,50,"BusinessBar.ShowGdprPrivacyNotice: Called");v.a.initialize(P,ba,Y,Z);this.ih(39,
null)}cIj(P,ba,Y,Z){z.a.initialize(P,ba,Y,Z);this.ih(40,null)}mKj(P,ba,Y,Z){u.a.initialize(P,ba,Y,Z);this.ih(41,null)}CJj(P,ba,Y,Z){m.a.initialize(P,ba,Y,Z);this.ih(42,null)}tKj(P,ba,Y,Z){y.a.initialize(P,ba,Y,Z);this.ih(54,null)}removeEntry(P){this.xZa&&(U.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&c.ULS.sendTraceTag(537170251,0,50,`Removing entry from BB: ${Enum.toString(t,P)}`),this.KFa[P]=null,this.sP.removeEntry(P)&&this.Pa.raiseEvent("bBarAttachedOrDetached",
new w(P,!1)))}Jka(P){return this.xZa?this.sP.Jka(P):!1}JG(P){return this.xZa?this.sP.JG(P):!1}fFb(){c.ULS.sendTraceTag(537170248,0,50,"Network disconnect notification received from the app")}Onc(){c.ULS.sendTraceTag(537170247,0,50,"Network resumed notification received from the app, turning off the TransientServerCommunicationFailures business bar");this.removeEntry(21)}QTg(){const {BusinessBarControl:P}=a(1171);if(this.xZa&&!this.sP){G.h(this.$).Vb.xl(this.VDf);var ba=document.getElementById(this.$.Bb+
n.a.Qye);this.sP=new P(this.$,ba)}}eLd(){this.xZa&&this.sP.eLd()}a_j(P){0<=aa.indexOf(P)&&!this.$.PNb&&(this.$.PNb=!0,this.$.cte&&this.Maj())}Maj(){try{const ba=f.a.get(n.a.EFd);if(S.a.lh(ba))c.ULS.sendTraceTag(509682970,0,50,"BusinessBarManager.raiseBusinessBarFlagInCookie: Can't find skeleton cookie eventough alreadyDefinedSkeletonCookie = true. Set page load skeleton cookie."),this.$.yyc();else{var P=L.a(decodeURIComponent(ba));P.Options|=4096;try{const Y=L.c(P);f.a.Cv(n.a.EFd,Y,d.AFrame.M0);c.ULS.sendTraceTag(509686989,
0,50,"BusinessBarManager.raiseBusinessBarFlagInCookie: Business bar flag in PageLoadSkeletonState cookie has been raised")}catch(Y){c.ULS.sendTraceTag(509686988,0,50,`BusinessBarManager.raiseBusinessBarFlagInCookie: Failed setting PageLoadSkeletonState cookie with error message: ${Y.message}`)}}}catch(ba){c.ULS.sendTraceTag(509686987,0,50,`BusinessBarManager.raiseBusinessBarFlagInCookie: exception while parsing PageLoadSkeletonCookie. Message: ${ba.message}`)}}Vmj(){if(U.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")){const ba=
this.uh.Jea;if(3E5<=ba-this.Mof){this.Mof=ba;for(let Y=0;70>Y;Y++){var P=this.KFa[Y];if(P&&(P=ba-P,3E5<=P)){const Z=Enum.toString(t,Y);c.ULS.sendTraceTag(537170241,0,50,`${"OnWebMethodSuccess"}: entry [${Z}] was activated but not turned off for ${P} Millis`)}}}}}GGh(P){const ba=[];for(const Y of P)switch(Y.MessageId){case -113742550:const Z=[757111532,2113407564,1393475740,1911608588,104919273,-689453604,157762400,-949523941];(this.$.ea.isNamedObjectViewMode||I.a.dh(P,Z))&&ba.push(-113742550)}return I.a.Fz(P,
ba)}mai(P,ba){switch(P.MessageId){case 2113407564:const Y=I.a.C_a([1821390342,-943219229,-502303485,1437034227]);for(let Z=0;Z<Y.length;Z++)Y[Z].HelpTopicId=P.HelpTopicId,Y[Z].HelpDescription=P.HelpDescription,this.kKc.push(Y[Z])}switch(P.MessageId){case -395951567:this.ih(6,P);break;case 1643490758:this.ih(4,P);break;case -907264831:this.ih(5,P);break;case 757111532:case 2113407564:this.ih(7,P);break;case 2010656511:this.ih(15,P);break;case 1321660996:this.$.D7c=!0;this.ih(8,P);break;case 526339737:this.$.D7c=
!0;this.ih(9,P);break;case -407088521:this.ih(10,P);break;case 1756116017:this.ih(14,P);break;case -1703455218:this.ih(17,P);break;case 1393475740:this.ih(25,P);break;case -949523941:this.ih(26,P);break;case 1779381952:this.ih(44,P);break;case 1421575100:this.ih(45,P);break;case 613676060:this.ih(46,P);break;case 1233668252:this.ih(61,P);break;case 1911608588:P=!!(this.$.qd&64);!this.$.ea.Bf()&&P&&ba.push(29);break;case 1544494907:break;case -655555355:ba.push(this.Htd()?1:0);break;case -1221382671:ba.push(2);
break;case 1662282929:ba.push(3);break;case 104919273:this.$.ea.Bf()||ba.push(30);break;case -689453604:P=!!(this.$.qd&64);this.$.ea.hbf=!0;!this.$.ea.Bf()&&P&&ba.push(31);break;case 157762400:this.$.ea.vic=!0;!this.$.ea.Bf()&&this.$.qd&64&&!this.$.isEditMode&&ba.push(32);break;case -1125398042:U.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CleanLoadBlockingFloatingObjects",!1)&&!this.$.ea.Bf()&&this.$.qd&64&&!this.$.isEditMode&&ba.push(34);break;case -73730134:!this.$.ea.Bf()&&this.$.qd&
64&&ba.push(33);break;case -293349236:ba.push(65);break;case 1580811823:ba.push(67);break;case -37299333:break;case 136737622:ba.push(47);break;case -1780327030:this.ih(55,P);break;case -113742550:this.ih(57,P);break;case -260312420:this.$.ea.Bf()||ba.push(66);break;default:this.ih(11,P)}return ba}Dgi(){if(b.AFrameworkApplication.fa.pa("WildFireExcelBizBar")&&!N.a.urd(N.a.jfd(1))&&(h.a.ap||h.a.Hg)){const P=x.GetServiceTaskFactory.create(this.$.da,155,this.$.la,1);B.TaskExtensions.za(P,()=>{this.ih(20,
null)},this.la,3)}}Vfi(P){P||3!==this.$.workbookContext.WorkbookNovType||this.ih(63,null)}kef(P){(!P&&!this.$.printingEnabled||this.$.$d.get(1))&&this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription&&(c.ULS.sendTraceTag(537170205,0,50,"BusinessBar.InitBusinessBar: Adding bisinessBar for irm protection."),this.ih(16,null));this.Dgi();this.OBe();this.f$f();this.Vfi(P)}OBe(){this.$.workbookContext.Options&32768&&this.TIj()}TIj(){this.KFa[37]||this.ih(37,null)}VKj(){this.KFa[38]||this.ih(38,null)}f$f(){this.$.workbookContext.Options&
524288&&this.ih(59,null)}C$f(P,ba){this.ih(58,P,null,ba)}mpe(P,ba=null){this.sP.JG(P)?this.sP.XPb(P,ba):this.ih(P,null,null,null,ba)}Y9f(){this.$.qd&8&&this.ih(12,null)}Htd(){const P=this.$.da.Aa(38);return P?P.tokenExpired:!1}qLg(P,ba){if(!this.JG(21)&&-1387426400!==P.MessageId){c.ULS.sendTraceTag(537170204,0,50,"BusinessBar: raising the transient communication failures notification.");const Y={};Y.FailedMethod=ba;this.ih(21,P,Y)}}static Sdc(){return V.Ose||(V.Ose=[0,1,2,3])}mfd(P){return this.sP.mfd(P)}}
V.Ose=null;Object(r.a)(V,"BusinessBarManager",k.a,[535,2,69])},1298:function(r,F,a){r=a(0);var c=a(226),b=a(1286);class e extends c.a{constructor(h){super();this.$=h;this.Db()}create(){this.nb(this.$.da.Aa(5)||new b.a(this.$,!this.$.kba))}static ka(h){h.da.Ha(4,new e(h))}}Object(r.a)(e,"BusinessBarManagerFactory",c.a,[]);var f=a(9);a.d(F,"a",function(){return d});const d=()=>{f.a.Fa(e.ka)}},1310:function(r,F,a){r=a(0);var c=a(15),b=a(85),e=a(869),f=a(853),d=a(1230);class h{constructor(){this.oHc=
new d.a;this.mHc=new d.a;this.lHc=new d.a;this.GXg(this.oHc);this.FXg(this.mHc);this.EXg(this.lHc);this.pMc=new d.a;this.oMc=new d.a;this.nMc=new d.a;this.e_g(this.pMc);this.d_g(this.oMc);this.c_g(this.nMc);this.EIc=new d.a;this.ZXg(this.EIc);this.TFa(this.EIc);this.TFa(this.lHc);this.TFa(this.mHc);this.TFa(this.oHc);this.TFa(this.oMc);this.TFa(this.pMc);this.TFa(this.nMc)}q4h(z,w){switch(z){case 1:return this.I7h(w);case 2:return this.ROh(w)}return f.a.Gzc?this.EIc:null}GXg(z){z.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);
z.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);z.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)}FXg(z){z.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);z.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);z.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)}EXg(z){z.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);z.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);
z.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)}e_g(z){z.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);z.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);z.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);z.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);z.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);z.add("OverlayBig","Get the Word app");z.add("OverlaySmall",
"Built for the iPad\u2014for when you're working on the go, even offline.");z.add("OverlaySmallSplit1","Discover Word");z.add("OverlaySmallSplit2","designed for the iPad.");z.add("SkipButton","Skip for now")}ZXg(z){z.add("Headline","Get the Office Online extension for Chrome");z.add("UseAppButton","Get the extension");z.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}d_g(z){z.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);z.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);
z.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);z.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);z.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);z.add("OverlayBig","Get the PowerPoint app");z.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");z.add("OverlaySmallSplit1","Discover PowerPoint");z.add("OverlaySmallSplit2","designed for the iPad.");z.add("SkipButton","Skip for now")}c_g(z){z.add("Headline",
CommonUIStrings.l_WildFireExcelBizBarHeadline);z.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);z.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);z.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);z.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)}TFa(z){z.add("Corporation","Microsoft Corporation")}I7h(z){switch(z){case 3:return this.pMc;case 2:return this.oMc;case 1:return this.nMc}return null}ROh(z){switch(z){case 3:return this.oHc;
case 2:return this.mHc;case 1:return this.lHc}return null}static get instance(){h.La||(h.La=new h);return h.La}}h.La=null;Object(r.a)(h,"WildFireStringFactory",null,[]);var l=a(4),k=a(40),t=a(27);a.d(F,"a",function(){return n});class n{constructor(z,w,m,u,y=null,v=null){this.DQc=null;this._id=z;this.lRc=w;this.xxg=y;this.akb=u;this.lmb=v;this.upa=null;this.nYa=m;this.Imb=h.instance.q4h(w,z)}x5c(){this.upa=new e.a(this.title,this.message,null);this.upa.addButton(this.Zye,Object(b.a)(this,this.oAf,
"onButtonOneClick"),"");this.nYa&&this.upa.AKg(this.aze,Object(b.a)(this,this.rAf,"onButtonTwoClick"));this.upa.w$=Object(b.a)(this,this.CMe,"dismissBar");this.upa.image=3;this.upa.id=16;this.upa.closeable=!0}get title(){return this.Imb.ma("Headline")}get message(){return this.Imb.ma("CallToAction")}get m3j(){return this.nYa}get Zye(){return this.nYa?this.Imb.ma("InstallButton"):this.Imb.ma("UseAppButton")}get aze(){return this.nYa?this.Imb.ma("OpenAppButton"):""}oAf(){this.nYa?this.Bji():this.c3j()}rAf(){this.nYa&&
this.Z1i()}get h_g(){return this.upa}get openUrl(){this.DQc||(this.DQc=this.xxg());return this.DQc}Bji(){c.ULS.sendTraceTag(17932829,306,50,"Install App Button of BusinessBar Clicked");this.akb&&this.lmb&&this.lmb();f.a.nTf(this._id,this.lRc)}Z1i(){this.openUrl&&(c.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.akb&&this.lmb&&this.lmb(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(f.a.Rte(this._id),this.openUrl,0,!1))}c3j(){f.a.Gzc?this.k_g():(c.ULS.sendTraceTag(17109255,
306,50,"AppBusinessBarNav"),f.a.wSd("BizBarClicked"),1!==this.lRc&&2!==this.lRc||f.a.G5g(this.openUrl,this.akb,this._id,this.lmb))}k_g(){this.akb?c.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):c.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");k.a.FU(l.AFrameworkApplication.fa.appSettings.WildFireChromeExtensionUrl.toString())}wnh(){this.akb?c.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):c.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");f.a.wSd(f.a.lCe)}CMe(){f.a.Gzc?
this.wnh():(f.a.wSd(f.a.jfd(this._id)),c.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static n6b(){const z=l.AFrameworkApplication.sa.Qa,w=new n(z.Oj,f.a.Qdc(),8<t.a.P5a,1===z.sca,()=>z.Bx,z.K0f());c.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed");return w}}Object(r.a)(n,"WildFireBusinessBar",null,[])},1311:function(r,F,a){r=a(0);var c=a(15),b=a(85),e=a(135),f=a(4),d=a(14),h=a(97),l=a(46),k=a(185),t=a(1096),n=a(88),z=a(57),w=a(79),m=a(956);class u extends e.StandardDialog{constructor(v,
C,x,B=null){super();this.cP=this.im=this.hqa=null;this.an=[];this.uWb=C;this.ZO=v;this.Rxg=x;this.HXb=B;this.Hmb=new m.a("LoadResource","LoadPrintablePdf")}UP(){this.Ob=5;this.width=40;const v=document.createElement("span");v.id=this.Fh("DirectPrintHeaderContent");const C=document.createElement("span");C.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(C,"DirectPrintHeader");this.cP=document.createElement("iframe");this.cP.name="pdfObjectFrame";this.cP.title=CommonUIStrings.l_DirectPrintDialogIFrame;
this.cP.onload=Object(b.a)(this,this.j9i,"printablePdfLoaded");if(this.HXb&&0<this.HXb.count){var x=w.a.Zhd(this.uWb,this.HXb);const B=w.a.BLd(this.uWb,this.HXb);this.im=document.createElement("form");this.im.id="printPreviewPostForm";this.im.method="POST";this.im.target=this.cP.name;this.im.action=B;for(let H of x)x=document.createElement("input"),x.type="hidden",x.name=H.key,x.value=H.value,this.im.appendChild(x)}else this.cP.setAttribute("src",this.uWb);Sys.UI.DomElement.addCssClass(this.cP,k.a.xfe);
this.Rxg?(Sys.UI.DomElement.addCssClass(this.cP,"DirectPrintPdfObjectHidden"),C.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,n.a.nh(this.cP,n.a.fC,n.a.Uj)):(Sys.UI.DomElement.addCssClass(this.cP,"DirectPrintPdfObject"),this.an.push(this.cP));v.appendChild(C);v.appendChild(document.createElement("br"));v.appendChild(this.cP);this.im&&v.appendChild(this.im);v.appendChild(document.createElement("br"));v.appendChild(this.q9g(this.im?"#":this.uWb));this.Hmb.start();this.EEb(CommonUIStrings.l_AppTitle,
null,null,null,null,v);this.EW(this.Fh("DirectPrintHeaderContent"));this.im&&this.im.submit();this.vdh();c.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")}q9g(v){const C=document.createElement("span");var x=document.createElement("span");x.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;C.appendChild(x);f.AFrameworkApplication.fa&&(2===f.AFrameworkApplication.sa.Qa.Oj&&f.AFrameworkApplication.fa.pa("PPTDisableDirectPrintDialogDownloadPDFLink")||1===f.AFrameworkApplication.sa.Qa.Oj&&
f.AFrameworkApplication.fa.pa("XLODisableDirectPrintDialogOpenPDFLink"))?(v=document.createElement("span"),2===f.AFrameworkApplication.sa.Qa.Oj?v.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===f.AFrameworkApplication.sa.Qa.Oj&&(v.innerText=CommonUIStrings.l_InternalError_Directive,c.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.hqa=v,C.appendChild(document.createElement("br")),C.appendChild(v)):(x=document.createElement("a"),x.innerText=
CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,x.href=v,x.target="_blank",x.id="PrintPDFLink",x.className="AllowBrowserClick",this.hqa=x,C.appendChild(document.createElement("br")),C.appendChild(x),this.im&&l.a.addHandler(x,"click",Object(b.a)(this,this.Cqc,"onSubmit")),this.ZO.ta(d.a.click,this.hqa,Object(b.a)(this,this.MNe,"downloadPDFLinkClicked"),null));this.an.push(this.hqa);return C}Cqc(v){this.im&&(this.im.target="_blank",this.im.submit());v.preventDefault()}vdh(){if(0<this.an.length){const v=
new t.a(this.an),C=h.FocusManager.instance().nQ();C&&(this.hqa.focus(),C.ef=v,C.i_=!0)}}MNe(){c.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1}Bwd(){c.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}j9i(){c.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.Hmb&&this.Hmb.stop()}dispose(){this.hqa&&(this.ZO.Ba(d.a.click,this.hqa,Object(b.a)(this,this.MNe,"downloadPDFLinkClicked")),this.hqa=null);
z.a.X_(this.cP);this.cP=null;super.dispose()}}Object(r.a)(u,"DirectPrintDialog",e.StandardDialog,[499]);a.d(F,"a",function(){return y});class y{constructor(v){this.ZO=v}HTh(v,C){return new u(this.ZO,v,C,null)}}Object(r.a)(y,"DirectPrintDialogFactory",null,[472])},1312:function(r,F,a){r=a(0);var c=a(15),b=a(552),e=a(85),f=a(1367),d=a(1097);class h{constructor(w,m){this.bdg=w;this.qTa=m}}Object(r.a)(h,"DirectPrintProbeResults",null,[]);var l=a(4),k=a(268),t=a(27),n=a(111);a.d(F,"a",function(){return z});
class z{constructor(w,m,u,y,v,C,x,B,H,I){this.bZb=null;this.Ovg=w;this.flb=m;this.eQc=u;this.Xyg=y;this.Czg=v;this.vRc=new b.a(Object(e.a)(this,this.M0h,"getProbeResults"));this.HVa=C;this.ode=H;this.HEg=x;this.Dzg=B;this.Kzg=I}get FC(){return this.Ovg}start(){}taj(){const w=Array(this.FC.pTa.length);if(void 0!==this.flb&&null!==this.flb)for(let m=0;m<this.FC.pTa.length;m++)w[m]=this.FC.pTa[m]in this.flb&&this.Xyg(this.flb[this.FC.pTa[m]]);return w}uaj(){const w=Array(this.FC.qTa.length),m=!(void 0===
this.eQc||null===this.eQc);for(let u=0;u<this.FC.qTa.length;u++){const y=this.FC.qTa[u];w[u]=m&&y in this.eQc?!0:this.Czg(y)}return w}E4h(){const w=this.taj(),m=Array(w.length);for(let u=0;u<w.length;u++)m[u]=w[u]?this.ZEh(this.flb[this.FC.pTa[u]]):null;return m}ZEh(w){if(void 0===w||null===w)return null;w=w.enabledPlugin;return void 0===w||null===w?null:w.name}M0h(){var w=this.E4h();const m=this.uaj(),u={},y={};for(let v=0;v<this.FC.pTa.length;v++)u[this.FC.pTa[v]]=w[v];for(w=0;w<this.FC.qTa.length;w++)y[this.FC.qTa[w]]=
m[w];return new h(u,y)}MHj(){return this.Kzg||!this.FC.isEnabled||l.AFrameworkApplication.isUnifiedHostMode?!1:this.UPj()}l9f(){if(null!=this.bZb)return this.bZb;const w=z.fif(this.FC);return this.bZb=this.FC.gif&&w||this.Zmi()}Zmi(){return t.a.cp&&this.FC.ani&&t.a.nCe>=this.FC.v4g?!0:!1}UPj(){if(!this.Dzg(this.FC))return!1;var w=n.a.Ojd(this.vRc.value.bdg);for(const m of w)if(void 0!==m&&null!==m)return!0;w=n.a.Ojd(this.vRc.value.qTa);for(const m of w)if(m)return!0;return!1}rbi(){const w=n.a.Ojd(this.vRc.value.bdg);
for(const m of w)if(k.a.contains(this.FC.Gei,m))return!0;return!1}aKj(w){l.AFrameworkApplication.sa&&l.AFrameworkApplication.fa.pa("DirectPrintDialogAsStandardDialogIsEnabled")?this.ode(w,null):this.MHj()?this.Onh(w,this.rbi()&&!0):this.ode(w,null)}Onh(w,m){const u=this.HEg.Gc("UserAction","OpenDirectPrintDialog");this.HVa.HTh(w,m).UP();u.stop()}static Lmf(w){try{return new ActiveXObject(w),!0}catch(m){c.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",w)}return!1}static hif(w){return void 0===
w||null===w?!1:!(void 0===w.enabledPlugin||null===w.enabledPlugin)}static create(w){const m=new d.a(l.AFrameworkApplication.fa.appSettings);let u=null;try{u=window.navigator.mimeTypes}catch(I){c.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}let y=null;try{y=window.navigator.plugins}catch(I){c.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const v=z.hif,C=z.Lmf;w=w.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");const x=l.AFrameworkApplication.sa.HD,
B=z.Mmf,H=!!l.AFrameworkApplication.sa&&l.AFrameworkApplication.sa.Qa.tv&&!l.AFrameworkApplication.fa.pa("PrintDialogFallbackLinkEnabled");return new z(m,u,y,v,C,w,x,B,(I,U)=>new f.a(I,!1,U,!0,H),l.AFrameworkApplication.J4)}static Mmf(w){return t.a.cp||t.a.sv&&w.Bqi||w.gif&&z.fif(w)?!0:!1}static fif(w){var m=t.a.jub;if(m){var u=m.split(".");if(2===u.length)return m=parseInt(u[0]),u=parseInt(u[1]),m>w.vzd||m===w.vzd&&u>=w.cwf}return!1}}Object(r.a)(z,"DirectPrintManager",null,[457])},1362:function(r,
F,a){a.d(F,"a",function(){return k});r=a(0);var c=a(85);F=a(135);var b=a(1085),e=a(264),f=a(4),d=a(14),h=a(79),l=a(27);class k extends F.StandardDialog{constructor(t,n=!0,z=!1,w=null,m=null,u=!1){super();this.dWa=this.cWa=this.im=this.HX=null;var y=this.JYd?this.JYd:CommonUIStrings.l_DefaultDialogTitle;k.E5a=u;this.qTb=w||new b.a(t,!0);this.qTb.bwe(this);const v=[],C=[];k.Iu&&(this.iYc&&this.iYc.forEach(H=>{Array.add(v,H)}),this.gse&&this.gse.forEach(H=>{Array.add(C,H)}));n?z?(this.Ob=4,this.tc(1,
this.buttonText),this.tc(2,CommonUIStrings.l_DialogClose)):(this.Ob=6,this.tc(0,CommonUIStrings.l_DialogClose)):this.Ob=5;u=document.createElement("span");this.T6c&&(u.className=this.T6c);w=document.createElement("a");w.innerText=this.Dlc;w.href=t;w.target="_blank";w.id=this.Clc;w.className=e.AFrame.Rse;var x=!l.a.ZA&&!!m&&0<m.count;if(x){const H=h.a.Zhd(t,m);m=h.a.BLd(t,m);w.href="#";w.target="_self";this.im=document.createElement("form");this.im.id="printPreviewPostForm1";this.im.method="post";
this.im.target="_blank";this.im.action=m;for(var B of H)m=document.createElement("input"),m.type="hidden",m.name=B.key,m.value=B.value,this.im.appendChild(m)}else this.im=null;this.im||k.E5a?k.E5a||Array.add(C,{["type"]:"AppLinkProps",["id"]:this.Clc,["text"]:this.Dlc,["onExecute"]:()=>{this.HRf()}}):Array.add(C,{["type"]:"AppLinkProps",["id"]:this.Clc,["text"]:this.Dlc,["handler"]:{["href"]:x?"#":t,["target"]:x?"_self":"_blank"}});this.qOa&&Array.add(v,this.qOa);z?(t=document.createElement("span"),
t.innerText=this.qOa.replace("{0}",""),u.appendChild(t)):this.Tvf?(t=document.createElement("span"),t.id=this.Fh("message"),B=document.createElement("span"),m=document.createElement("span"),x=this.qOa.split("{0}"),B.innerText=x[0],m.innerText=x[1],t.appendChild(B),t.appendChild(w),t.appendChild(m),u.appendChild(t)):(t=document.createElement("span"),t.innerText=this.qOa,u.appendChild(t),u.appendChild(document.createElement("br")),u.appendChild(document.createElement("br")),u.appendChild(w),k.E5a||
Array.add(v,"{0}"));this.im&&u.appendChild(this.im);k.Iu&&(this.U8a&&(this.rDb?this.Moe(this.U8a,this.rDb):(Array.add(v,"{0}"),Array.add(C,{["type"]:"AppLinkProps",["id"]:"LearnMoreLinkId",["text"]:this.U8a,["onExecute"]:()=>{this.wlc()}}))),this.Pra(v,C));this.EEb(y,null,this.udf,null,Object(c.a)(this,this.iu,"dialogHandler"),k.Iu?null:u);this.EW(this.Fh("message"));!k.Iu&&this.rDb&&this.U8a&&(y=document.createElement("div"),y.className="WACDialogLearnMoreLinkContainer",this.HX=document.createElement("a"),
this.HX.innerText=this.U8a,this.HX.href=this.rDb,this.HX.target="_blank",this.HX.id=this.Fh("LearnMoreLinkId"),this.HX.className=e.AFrame.Rse,y.appendChild(this.HX),n?this.lb.insertBefore(y,this.lb.lastChild):this.lb.appendChild(y),this.EW(String.format("{0} {1}",this.Fh("message"),this.Fh("LearnMoreLinkId"))));this.Oib=w;z?this.lI(this.NB):this.lI(this.Oib);this.Frf();f.AFrameworkApplication.sa.RW.ta(d.a.click,this.Oib,Object(c.a)(this,this.KNe,"downloadLinkClicked"),null);this.HX&&f.AFrameworkApplication.sa.RW.ta(d.a.click,
this.HX,Object(c.a)(this,this.wlc,"learnMoreLinkClicked"),null);this.pTb=!1}get udf(){return null}get JYd(){return null}get qOa(){return null}get rDb(){return null}get U8a(){return null}get Tvf(){return!1}get buttonText(){return CommonUIStrings.l_Open}get T6c(){return null}get iYc(){return null}get gse(){return null}JZc(){this.im&&(this.cWa||(this.cWa=Object(c.a)(this,this.INi,"onActionButtonClicked"),this.Ey.ta(d.a.click,this.NB,this.cWa)),this.dWa||(this.dWa=Object(c.a)(this,this.JNi,"onActionButtonKeyUp"),
this.Yd.ta(d.a.Ld,this.NB,this.dWa)));super.JZc()}INi(t){this.aWe(t);return!0}JNi(t){return this.Eof(t,Object(c.a)(this,this.aWe,"executeDismissActionButtonFromArgs"))}aWe(t){this.im&&this.im.submit();this.xua(t.Mb)}Bwd(){}KNe(){this.Hrf();this.im?this.im.submit():this.qTb.Z8c();return!0}wlc(){return!1}dispose(){this.qTb.dispose();this.Oib&&(f.AFrameworkApplication.sa.RW.Ba(d.a.click,this.Oib,Object(c.a)(this,this.KNe,"downloadLinkClicked")),this.Oib=null);this.HX&&(f.AFrameworkApplication.sa.RW.Ba(d.a.click,
this.HX,Object(c.a)(this,this.wlc,"learnMoreLinkClicked")),this.HX=null);this.Ey&&this.cWa&&(this.Ey.Ba(d.a.click,this.NB,this.cWa),this.cWa=null);this.Yd&&this.dWa&&(this.Yd.Ba(d.a.Ld,this.NB,this.dWa),this.dWa=null);super.dispose()}HRf(){this.im&&(document.body.appendChild(this.im),this.im.submit(),document.body.removeChild(this.im))}iu(t){1===t&&(this.Bwd(),this.im?k.Iu&&this.HRf():this.qTb.Z8c());this.dispose()}static get Iu(){return f.AFrameworkApplication.sa.Qa.tv&&f.AFrameworkApplication.sa.Qa.wlf}static get E5a(){return k.J$d}static set E5a(t){k.J$d=
t}}k.J$d=!1;Object(r.a)(k,"ADialogWithLinkToResource",F.StandardDialog,[])},1363:function(r,F,a){a.r(F);a.d(F,"ReactOICErrorDialogWithTrial",function(){return f});r=a(0);var c=a(85);F=a(1087);var b=a(423),e=a(150);class f extends F.a{constructor(d,h,l,k,t,n){super(d,h,l,k,t,n);h={["errorMessage"]:this.DQe,["offerString"]:this.Jyf};d=new e.a(!1,!1,!0);this.Z9f?(d.Ob=1,h.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.cwa,["onExecute"]:()=>{b.Redirect.showHelp(this.Qbf)}}):(d.Ob=4,
d.tc(2,this.ndf));d.tc(1,this.uZb);d.pe=this.id;h={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:h};d.initializeAndShow(this.el,Object(c.a)(this,this.Tcj,"reactOICErrorDialogWithTrialHandler"),h)}}Object(r.a)(f,"ReactOICErrorDialogWithTrial",F.a,[])},1364:function(r,F,a){a.r(F);a.d(F,"OICErrorDialogWithTrial",function(){return e});r=a(0);var c=a(85);F=a(1087);var b=a(135);class e extends F.a{constructor(f,d,h,l,k,t){super(f,d,h,l,k,t);f=document.createElement("span");f.innerText=this.DQe;
f.appendChild(document.createElement("br"));f.appendChild(document.createElement("br"));d=document.createElement("span");d.innerText=this.Jyf;f.appendChild(d);d=new b.StandardDialog;this.Z9f?(d.Ob=1,d.Woe(this.cwa,this.Qbf)):(d.Ob=4,d.tc(2,this.ndf));d.tc(1,this.uZb);d.pe=this.id;d.Wl(this.el,null,this.icon,Object(c.a)(this,this.Pzi,"legacyOICErrorDialogWithTrialHandler"),f)}}Object(r.a)(e,"OICErrorDialogWithTrial",F.a,[])},1365:function(r,F,a){a.r(F);a.d(F,"CheckRoamingRightsRequest",function(){return c});
r=a(0);a=a(1088);class c extends a.a{constructor(){super()}Kxb(){return 2}Maa(){return 1}}Object(r.a)(c,"CheckRoamingRightsRequest",a.a,[])},1366:function(r,F,a){a.r(F);a.d(F,"GetRoamingLauncherRequest",function(){return c});r=a(0);a=a(1088);class c extends a.a{constructor(){super()}Kxb(){return 0}Maa(){return 2}}Object(r.a)(c,"GetRoamingLauncherRequest",a.a,[])},1367:function(r,F,a){a.d(F,"a",function(){return k});r=a(0);var c=a(15),b=a(1362),e=a(1085),f=a(4),d=a(88),h=a(79),l=a(27);class k extends b.a{constructor(t,
n,z=null,w=!0,m=!1){super(t,!0,!(k.YBa&&w),new e.a(t,n),z,m);k.YBa=k.YBa&&w;if(k.YBa){n=document.createElement("iframe");w=null;m=this.Lmh;n.name="pdfObjectFrame";n.id="pdfObjectIFrame";if(z&&0<z.count){const u=h.a.Zhd(t,z);t=h.a.BLd(t,z);w=document.createElement("form");w.id="printPreviewPostForm";w.method="POST";w.target=n.name;w.action=t;for(let y of u)t=document.createElement("input"),t.type="hidden",t.name=y.key,t.value=y.value,w.appendChild(t)}else n.src=t;m.appendChild(n);w&&(m.appendChild(w),
w.submit());Sys.UI.DomElement.addCssClass(n,"DirectPrintPdfObjectHidden");d.a.nh(n,d.a.fC,d.a.Uj)}}get udf(){return"Print_32x32x32"}get JYd(){return k.YBa?CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get qOa(){return k.YBa?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get iYc(){const t=[];Array.add(t,CommonUIStrings.l_PrintDialogCanCloseDocument);if(b.a.E5a){let n=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==f.AFrameworkApplication.sa.Qa.XJe&&(n=f.AFrameworkApplication.sa.Qa.XJe);
Array.add(t,n)}return k.YBa?t:null}get Dlc(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get Clc(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get T6c(){return f.AFrameworkApplication.SLe?"UIFontDialogTextLarge":null}Frf(){c.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")}Hrf(){f.AFrameworkApplication.Gn.Fzb(9540);c.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}Bwd(){c.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")}static get YBa(){return!!f.AFrameworkApplication.sa&&
f.AFrameworkApplication.sa.Qa.tv&&f.AFrameworkApplication.fa.pa("DirectPrintDialogAsStandardDialogIsEnabled")&&!(l.a.ZA||l.a.sv||l.a.Cf||l.a.ZMa)&&!f.AFrameworkApplication.isUnifiedHostMode&&f.AFrameworkApplication.fa.pa("ShouldHostDefaultToNativeBrowserPrintExperience")}static set YBa(t){}}Object(r.a)(k,"PrintDialogWithLinkToPdf",b.a,[])},1384:function(r,F,a){r=a(0);var c=a(85),b=a(39);class e{constructor(){this.classId=0}static EIa(k){try{return b.a(k)}catch(t){}return null}}Object(r.a)(e,"ARoamingAppsResponse",
null,[]);class f{constructor(){this.state=this.callback=null;this.Hqd=!1}}Object(r.a)(f,"GetRoamingAppsLauncherContext",null,[]);var d=a(4),h=a(109);a.d(F,"a",function(){return l});class l{constructor(k){this.CIc=!1;this.BXa=l.hgc;this.mSc=this.qQc=0;this.platform=null;this.fDg=k;this.mme=this.nSc=!1}get roamingAppsAreEnabled(){return this.fDg}get y3j(){return this.roamingAppsAreEnabled&&this.nSc?this.mme:!1}i4g(){d.AFrameworkApplication.Ric&&this.roamingAppsAreEnabled&&!this.nSc&&!this.CIc&&(this.mSc=
1,this.CIc=!0,this.Uoj(),this.YVe())}Uoj(){this.BXa=l.hgc;this.qQc=0}getRoamingAppsLauncher(k,t,n){this.y3j?(k=new f,k.callback=t,k.state=n,k.Hqd=!0,this.dWe(k)):t(!1,"",n)}YVe(){const k=new (a(1365).CheckRoamingRightsRequest);k.RoamingApp=this.mSc;k.BaseDocQuerySignature=d.AFrameworkApplication.vi;k.execute(Object(c.a)(this,this.k4g,"checkUserRoamingRightsSucceeded"),Object(c.a)(this,this.j4g,"checkUserRoamingRightsFailed"),null)}k4g(k){d.AFrameworkApplication.rg||((k=e.EIa(k.data.de))?this.ySd(k.HasRights):
this.ySd(!1))}j4g(){if(!d.AFrameworkApplication.rg)if(this.qQc>=l.AHi)this.ySd(!1);else{var k=new h.a(2,1,this.BXa,Object(c.a)(this,this.retryCheckUserRoamingRights,"retryCheckUserRoamingRights"),59);d.AFrameworkApplication.ji.fg(k);this.qQc++;this.BXa*=l.pqj;this.BXa>l.nvf&&(this.BXa=l.nvf)}}ySd(k){this.mme=k;this.nSc=!0;this.CIc=!1}retryCheckUserRoamingRights(){this.YVe()}dWe(k){const t=new (a(1366).GetRoamingLauncherRequest);t.RoamingApp=this.mSc;t.BaseDocQuerySignature=d.AFrameworkApplication.vi;
t.execute(Object(c.a)(this,this.t2h,"getRoamingAppsLauncherSucceeded"),Object(c.a)(this,this.s2h,"getRoamingAppsLauncherFailed"),k)}t2h(k){if(!d.AFrameworkApplication.rg){var t=e.EIa(k.data.de);k=k.data.state;t?(this.platform=t.Platform,k.callback(!0,t.Launcher,k.state)):k.callback(!1,"",k.state)}}s2h(k){if(!d.AFrameworkApplication.rg){var t=k.data.state;5===k.data.status&&t.Hqd?(t.Hqd=!1,this.dWe(t)):t.callback(!1,"",t.state)}}static get instance(){return l.ZB||(l.ZB=new l(d.AFrameworkApplication.iTg))}}
l.hgc=1E3;l.pqj=5;l.nvf=12E5;l.AHi=5;l.ZB=null;Object(r.a)(l,"RoamingAppsManager",null,[])},1459:function(r,F,a){a.r(F);var c={};a.r(c);a.d(c,"SheetOptionsToggleCommandHandler",function(){return ec});var b=a(1070),e=a(0),f=a(251);class d{get name(){return"Common.App.DialogWithLinkToResource"}Bh(){}init(){}dispose(){}static main(){f.a.instance.ii(new d)}}Object(e.a)(d,"CommonAppDialogWithLinkToResourcePackage",null,[3,4]);var h=a(552),l=a(15),k=a(85),t=a(192),n=a(826),z=a(30),w=a(134);class m{static esh(sc){return m.Kye("New",
sc)}static fsh(sc){return m.Kye("Open",sc)}static uye(sc,ad){return m.kha("LoadingMenuSection",m.lBi,sc,m.rqb("lblLoading",ad))}static sqb(sc,ad,gb=null,Hb=null){return m.kha("MessageMenuSection",m.Awf,ad,m.rqb("lblMessage",sc,gb,Hb))}static TYg(sc){return m.uye(sc,CommonUIStrings.l_VoicedLoadingText)}static UYg(sc,ad){return m.sqb(CommonUIStrings.l_NewCreationLocationMessage,sc.gi,ad.pR,ad.loa)}static SYg(sc,ad){return m.sqb(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,ad.loa,"\n\n"),
sc.gi)}static wye(sc){return m.sqb(CommonUIStrings.l_NewGenericErrorMessage,sc.gi)}static QYg(sc,ad,gb){return m.kha("menuNewBlank",m.aci,gb?sc.gi:null,m.nqb(sc.Abf,sc.Bbf,sc.Cbf,null,sc.lka,sc.szb,ad,"blank"))}static QZg(){return m.rqb("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)}static Hye(){return m.rqb("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static RZg(sc,ad){return m.kha("menuNewTemplates",sc,null,ad)}static OYg(sc,ad){return m.kha("menuNewMoreTemplates",
m.sZe,null,m.nqb("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,sc,ad))}static RXg(sc,ad,gb){let Hb="";gb&&ad&&(Hb=m.kha("BrowseMoreMenuSection",m.sZe,null,m.nqb("btnBrowseMore",ad,ad,null,null,null,sc||"1959943459",gb)));return Hb}static rqb(sc,ad,gb=null,Hb=null){let ac=Hb;ad&&0<ad.length&&(ac=m.vxf.Prc(ad).trimEnd(),ac=0<=ac.indexOf("{0}")?String.format(ac,Hb):String.format("{0} {1}",ac,Hb));gb=gb&&Hb?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',
z.a.We(gb),z.a.We(Hb),z.a.We(ac)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',z.a.We(sc||""),m.vxf.Prc(z.a.We(ad||"")),gb)}static nqb(sc,ad,gb,Hb,ac,Ec,pd,Bd){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',z.a.We(sc||""),z.a.We(ad||
""),z.a.We(gb||""),Hb||"32by32",z.a.We(ac||""),z.a.We(Ec||""),pd,z.a.We(Bd||""))}static Kye(sc,ad){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',sc,ad)}static kha(sc,ad,gb,Hb){gb=gb?String.format('Title="{0}"',z.a.We(gb)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',
z.a.We(sc||""),z.a.We(ad||""),gb,Hb)}}m.Awf="MenuMru";m.lBi="MenuLoading";m.aci="MenuHeader";m.sZe="MenuFooter";m.vxf=w.a.Fx("\n","&#10;");Object(e.a)(m,"NewAndOpenXmlUtilities",null,[]);var u=a(4),y=a(99),v=a(145),C=a(146);class x{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(e.a)(x,"HostInformation",null,[]);var B=a(109),H=a(104),I=a(40),U=a(268),S=a(378),G=a(168),D=a(652),E=a(576),N=a(108),M=a(25);class L{constructor(sc,ad,gb,Hb,ac,Ec){this.GYb=this.Io=this.hSb=
null;this.dYb=this.zTc=!1;this.nee=0;this.nTc=this.MNc=!1;this.G1=sc;this.jjb=ad;this.QDa=new h.a(()=>new n.a(gb.value,Object(k.a)(this,this.sxb,"getMoreInfoEventReceived")));this.JAg=Hb;this.Sqa=ac;this.XDg=Ec;this.zmb=this.Ezc;2===this.xK.nca&&(this.nTc=!0);u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)&&this.GFh()}get kP(){switch(this.xK.nca){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";
case 5:return"VisioWAC"}return null}GFh(){H.a.instance.fg(new B.a(5,1,0,()=>{this.getTemplateListJson()}))}Ag(){const sc=this.xK.S9a;sc.Nb(M.a.newDocument,N.a.frame,Object(k.a)(this,this.newDocument,"newDocument"));sc.Nb(M.a.jsc,N.a.frame,Object(k.a)(this,this.jsc,"populateNewMenu"))}newDocument(sc,ad,gb,Hb,ac){if(1===gb)return 32;if(2===gb&&ac){if(u.AFrameworkApplication.fa.pa("BackstagePremiumTemplateExperienceEnabled")&&ac.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),
u.AFrameworkApplication.rb.processAction(M.a.Z7i,2);if(ac.MenuItemId&&ac.SourceControlId)return"NewDocumentHome"===ac.SourceControlId&&v.a("NewDocumentFromHomeTab"),this.h1a(ac.MenuItemId,ac.SourceControlId)}return 8}h1a(sc,ad){var gb=this.Rnc.k6c;if(null===gb)return 8;var Hb=u.AFrameworkApplication.fa.pa("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(u.AFrameworkApplication.Lba&&Hb){l.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");
const ac={};ac[S.a.leg]=sc;ac[S.a.kP]=this.kP;ac[S.a.lcid]=u.AFrameworkApplication.lcid.toString();ac[S.a.reason]=D.a.createNew;u.AFrameworkApplication.uQ().execute(Ec=>{Ec.jj(G.a.h1a,ac)})}else Hb=(new Date).getTime(),ad=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",gb,z.a.hf(this.Pla),z.a.hf(sc),z.a.hf(this.kP),z.a.hf(u.AFrameworkApplication.lcid.toString()),z.a.hf(Hb.toString()),z.a.hf(ad),z.a.hf(u.AFrameworkApplication.canary),
u.AFrameworkApplication.vi),(gb=u.AFrameworkApplication.fa.Wa("ScenarioId"))&&""!==gb&&(ad+="&wdscenarioid="+z.a.hf(gb)),ad+="&"+u.AFrameworkApplication.tdc(),u.AFrameworkApplication.Wwa&&(ad+="&"+u.AFrameworkApplication.Ncc()),(gb=this.Io?this.Io.pR:null)&&(ad+="&DestinationUrl="+z.a.hf(gb)),I.a.gf(ad,"_blank",void 0,"CreateNewDocument");2===this.xK.nca&&l.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:E.a[this.xK.nca],["Template"]:sc});return 32}DEi(sc){let ad=
Number.MAX_VALUE,gb=Number.MIN_VALUE;const Hb=window.performance;if(Hb&&"undefined"!==typeof Hb.getEntriesByName){for(let Ec=0;Ec<sc.length;Ec++){var ac=Hb.getEntriesByName(sc[Ec]);ac&&0<ac.length&&(ac=ac[0],ad=Math.min(parseInt(String(ac.fetchStart)),ad),gb=Math.max(parseInt(String(ac.responseEnd)),gb))}gb>ad&&l.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:gb-ad,["MinFetchStart"]:ad,["MaxResponseEnd"]:gb})}}jsc(sc,ad,gb,Hb,ac){if(1===gb)return this.nTc&&
(u.AFrameworkApplication.iN("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.nTc=!1),32;2!==gb||this.MNc||(this.nee=(new Date).getTime(),l.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.Ezc,["CachedNewMenuXmlExists"]:!!this.hSb,["ShouldCallGetMoreInfo"]:this.xK.supportsGetMoreInfoForPersonalStorage}));u.AFrameworkApplication.ula("AdditionalDocumentTemplates-tf;AdditionalDocumentTemplates-cf");return this.R6i(ac)}R6i(sc){sc&&
(this.hSb?sc.PopulationXML=this.hSb:(this.xK.supportsGetMoreInfoForPersonalStorage&&!this.Io&&this.gLi.vZ("Opened New menu",!0),sc.PopulationXML=this.HNh(this.getTemplateListJson())));return 32}Blf(){return!this.xK.supportsGetMoreInfoForPersonalStorage||!!this.Io&&3===this.Io.state&&!!this.Io.loa&&!!this.Io.pR}dti(){return u.AFrameworkApplication.sa&&u.AFrameworkApplication.sa.Qa.UZ?!0:this.Blf()}getTemplateListJson(){if(!this.Ezc||!this.dti())return null;if(this.zmb&&!this.dYb){var sc="9";u.AFrameworkApplication.fa&&
u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)&&(sc="21");const ad=u.AFrameworkApplication.fa.appSettings;"NumberOfTemplatesInBackstage"in ad&&(sc=ad.NumberOfTemplatesInBackstage);let gb=this.kP;"TemplateCollectionId"in ad&&(gb=ad.TemplateCollectionId);sc=String.format(this.xK.t_+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",z.a.hf(u.AFrameworkApplication.lcid.toString()),z.a.hf(gb),sc);Boolean.parse(ad.AppendOriginQueryParam||
"false")&&(sc+="&org=backstage");Boolean.parse(ad.BackstagePremiumTemplateExperienceEnabled||"false")&&"TemplateTier"in ad&&(sc+="&templateTier="+ad.TemplateTier);sc+="&"+u.AFrameworkApplication.tdc();u.AFrameworkApplication.Wwa&&(sc+="&"+u.AFrameworkApplication.Ncc());this.xK.gFb.Jm(sc,1,null,null,!1,2,Hb=>{this.xK.XNa("CreateNewActor.GetTemplateListJson",Hb.data);this.BRj(Hb.data.de)},Hb=>{this.xK.XNa("CreateNewActor.GetTemplateListJson",Hb.data);this.ARj()},null,void 0,void 0,void 0,void 0,"5");
this.zmb=!1}return this.GYb}BRj(sc){u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)?this.GYb=this.JGh(sc):this.GYb=sc;this.zmb=!1;this.gJb();if(u.AFrameworkApplication.sa&&u.AFrameworkApplication.sa.Qa.UZ&&C.c()){sc=u.AFrameworkApplication.fa.pa("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");const ad=u.AFrameworkApplication.Lba;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.GYb,
!0,sc&&ad))}}ARj(){this.dYb=this.zmb=!0;this.gJb();u.AFrameworkApplication.sa&&u.AFrameworkApplication.sa.Qa.UZ&&C.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1));y.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}JGh(sc){sc=JSON.parse(sc);const ad=new t.a;ad.add("TM00002102");ad.add("TM00002101");ad.add("TM16392939");const gb=U.a.z2d(sc,Hb=>ad.contains(Hb.AssetId));sc=sc.slice(0,9);sc.splice.apply(sc,[2,0].concat(gb));
return JSON.stringify(sc)}l5h(sc){var ad=0;for(var gb=0;gb<sc.length;gb++)if("ST"===sc[gb].ImageType){ad=gb;break}const Hb=sc.length?sc[ad]:null;sc=Hb?Hb.Url||"":"";var ac;let Ec=gb=ad=!1;if(Hb&&(ac=Hb.AspectRatio))ac=parseFloat(ac),1>ac?ad=!0:1.5<ac?gb=!0:1===ac&&(Ec=!0);else switch(l.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:sc}),this.xK.nca){case 3:ad=!0;break;case 2:gb=!0;break;case 5:Ec=!0}return{returnValue:sc,Aei:ad?"95by123":gb?"123by69":Ec?"100by100":"123by95"}}HNh(sc){sc=
({izc:ad}=this.RYg(sc,this.Rnc,this.Rnc.XGa||"1056925771")).returnValue;if(ad){this.hSb=sc;var ad=(new Date).getTime()-this.nee;l.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{["ElapsedMsSinceMenuOpened"]:ad})}return sc}sxb(sc,ad){l.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.Io||3!==sc.state?2===sc.state&&(l.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.zTc=!0,this.gJb()):(this.Io=sc,ad||this.gJb(),
u.AFrameworkApplication.sa&&u.AFrameworkApplication.sa.Qa.UZ&&C.c()&&C.d("setFileMenuHostInformation")&&(sc=Object.assign(new x,{hostUrl:this.Io.pR,hostName:this.Io.loa,folderUrl:u.AFrameworkApplication.breadcrumbFolderUrl,folderName:u.AFrameworkApplication.breadcrumbFolderName}),l.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(sc))))}RYg(sc,ad,gb){let Hb;Hb=!1;const ac=this.Blf();let Ec="";this.xK.supportsGetMoreInfoForPersonalStorage&&
(this.zTc?(Ec=m.wye(ad),this.zTc=!1,l.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.Io?ac?Ec=m.UYg(ad,this.Io):this.Io.Kji?(Hb=!0,this.zmb=!1,Ec=m.SYg(ad,this.Io),l.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):(Hb=!0,Ec=m.wye(ad),l.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{["PersonalFileStorageUrlIsSet"]:!!this.Io.pR,
["StorageServiceDisplayNameIsSet"]:!!this.Io.loa})):(Ec=m.TYg(ad.gi),l.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));ac&&(Ec+=m.QYg(ad,gb,!Ec)+({izc:Hb}=this.PZg(sc,gb)).returnValue);return{returnValue:m.esh(Ec),izc:Hb}}PZg(sc,ad){let gb;gb=!1;if(!this.Ezc)return gb=!0,l.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",izc:gb};let Hb="",ac="",Ec="MenuTemplate";if(this.dYb)Hb=m.Hye(),this.dYb=!1,l.ULS.sendTraceTag(5849610,
202,10,"Rendering File>New with template error message");else if(sc){try{const pd=Sys.Serialization.JavaScriptSerializer.deserialize(sc,!0);Hb=this.OZg(pd,ad);l.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");u.AFrameworkApplication.wxf&&"OneDrive"===this.Pla&&(ac=m.OYg(this.hLi,u.AFrameworkApplication.wxf))}catch(pd){l.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:sc}),Hb=m.Hye()}gb=!0}else Ec="MenuLoading",
Hb=m.QZg(),l.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:m.RZg(Ec,Hb)+ac,izc:gb}}OZg(sc,ad){let gb="";const Hb=[];for(let Ec=0;Ec<sc.length;Ec++){var ac=sc[Ec];let pd="";if(ac){const Bd=ac.Title,de=ac.AssetId;ac=ac.Thumbnails;de&&Bd&&ac&&({Aei:ac,returnValue:pd}=this.l5h(ac),gb+=m.nqb("jbtnNewTemplate"+Ec,Bd,null,ac,null,pd,ad,de))}Hb[Ec]=pd}sc=new B.a(4,1,5E3,()=>{this.DEi(Hb)},106);this.xK.Pnc.fg(sc);return gb}gJb(){this.MNc=!0;this.xK.oxf.Yw(this.Rnc.Kvb);
this.MNc=!1}get xK(){return this.G1.value}get Rnc(){return this.jjb.value}get gLi(){return this.QDa.value}get hLi(){return this.JAg.value}get Pla(){return this.Sqa.value}get Ezc(){return this.XDg.value}}Object(e.a)(L,"CreateNewActor",null,[]);var aa=a(1361);class V extends aa.a{constructor(){super()}Lpe(){this.nT(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.nT(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.nT(2,CommonUIStrings.l_Open);this.nT(3,CommonUIStrings.l_OpenMenuRecentDocuments);
this.nT(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.nT(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return V.La||(V.La=new V)}static w2i(sc){return V.instance.ga(sc)}}V.La=null;Object(e.a)(V,"MruActorIntlHelper",aa.a,[]);var P;(function(sc){sc[sc.success=0]="success";sc[sc.failure=1]="failure";sc[sc.spinner=2]="spinner";sc[sc.none=3]="none"})(P||(P={}));Object(e.b)("DisplayState",P);var ba=a(39);class Y{constructor(sc,ad,gb,Hb,ac,Ec,pd,Bd){this.kIc=null;this.kVc=!0;this.gSb="";this.HFg=
0;this.PWa=null;this.DOc=3;this.mb=Bd;this.G1=sc;this.Yi=ad;this.Hwg=gb;this.Ltg=Hb;this.Ktg=ac;this.QDa=new h.a(()=>new n.a(Ec.value,null));this.rxg=new h.a(()=>new n.a(pd.value,Object(k.a)(this,this.QJi,"mruEventResultReceived")));this.mb.pa("WacInTabOpenMRUIsEnabledForUiHost");this.mb.pa("UiHostSupportsDocRebootFeatures")}QJi(sc,ad){this.PWa=sc;ad||this.ETf()}Lgj(){this.nD.S9a.Oe(M.a.isc,N.a.frame,Object(k.a)(this,this.isc,"populateMruMenu"),96)}isc(sc,ad,gb,Hb,ac){return 1!==gb&&ac?this.O6i(ac):
32}O6i(sc){this.Ksh();this.Jsh();sc.PopulationXML=m.fsh(this.gSb+this.kIc);return 32}Ksh(){var sc=3;let ad=!1;if(this.gSb&&this.HFg===this.PWa.nTj)l.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),sc=this.DOc;else{l.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var gb=this.nD.jw();this.PWa=this.PJi.vZ("File Open opened",!0);this.gSb&&2!==this.DOc&&3!==this.PWa.state?
ad=!0:(sc=this.e3h(this.PWa),u.AFrameworkApplication.sa&&u.AFrameworkApplication.sa.Qa.UZ&&C.c()&&sc&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(sc,!0)),this.gSb=({ZKi:sc}=this.INh(this.PWa)).returnValue);gb=this.nD.jw()-gb;l.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:gb})}2!==sc&&(gb={["DisplayState"]:P[sc]},1!==sc&&(gb.IsStale=ad),l.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",
gb));this.DOc=sc}e3h(sc){let ad;try{ad=ba.c(sc.Vzd)}catch(gb){ad=null,l.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",gb)}return ad}Jsh(){this.kVc?(l.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.kIc=({v6j:this.kVc}=this.WFi()).returnValue):l.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");l.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",
{["WaitingOnLinkInfo"]:this.kVc,["NotDisplayingLink"]:!this.kIc})}INh(sc){let ad;1===sc.state||0===sc.state?(l.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),sc=2,ad=m.uye(this.Rja(2),this.Rja(5))):3===sc.state&&sc.Vzd?(ad=this.PYg(sc.Vzd),sc=0):(l.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),ad=m.sqb(this.Rja(1),this.Rja(2)),sc=1);return{returnValue:ad,ZKi:sc}}PYg(sc){let ad;const gb=this.AEb.XGa||"2155708348";if(sc.length){ad=
m.rqb("lblRecentDocuments",this.Rja(3));let Hb=0;for(let ac=0;ac<sc.length;ac++){const Ec=sc[ac];"FileName"in Ec&&"DocumentUrl"in Ec&&"Path"in Ec&&(ad+=m.nqb("MruButton"+ac,Ec.FileName.toString(),Ec.Path.toString(),null,this.AEb.lka,this.AEb.szb,gb,Ec.DocumentUrl.toString()),Ec.IsPinned&&Hb++)}ad=m.kha("RecentDocumentsMenuSection",m.Awf,this.Rja(2),ad);l.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:sc.length,["NumPinnedDocuments"]:Hb})}else ad=
m.sqb(this.Rja(0),this.Rja(2)),l.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return ad}WFi(){let sc;sc=!0;let ad=this.kXg;var gb=this.jXg;if(ad&&gb||!this.nD.supportsGetMoreInfoForPersonalStorage)sc=!1;else{const Hb=this.Ucc.vZ("File Open",!1);3===Hb.state&&(ad=Hb.pR,gb=Hb.loa,sc=!1)}gb=gb?String.format(this.Rja(4),gb):null;return{returnValue:m.RXg(this.AEb.XGa,gb,ad),v6j:sc}}ETf(){this.nD.oxf.Yw(this.AEb.Kvb)}get nD(){return this.G1.value}get Rja(){return this.Yi.value}get AEb(){return this.Hwg.value}get kXg(){return this.Ltg.value}get jXg(){return this.Ktg.value}get Ucc(){return this.QDa.value}get PJi(){return this.rxg.value}}
Object(e.a)(Y,"MruRenderer",null,[]);var Z=a(241),ea=a(777);class ra{constructor(sc,ad,gb,Hb,ac,Ec,pd){this.Io=null;this.hje=!1;this.jqa=this.P5d=0;this.QAg=sc;this.eXa=ad;this.VVb=gb;this.jjb=Hb;this.Sqa=ac;this.G1=Ec;this.QDa=new h.a(()=>new n.a(pd.value,Object(k.a)(this,this.sxb,"getMoreInfoEventReceived")))}h1a(){!this.Io&&this.DAd.supportsGetMoreInfoForPersonalStorage?this.Ucc.vZ("NewDocumentFromStream",!0):this.createNewDocumentFromStream()}sxb(sc){if(!this.Io&&3===sc.state)this.Io=sc;else if(2===
sc.state){this.hje?l.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.Ucc.vZ("NewDocumentFromStream",!0),this.hje=!0);return}this.createNewDocumentFromStream()}createNewDocumentFromStream(){this.P5d=(new Date).getTime();var sc=this.aGh.k6c;if(null===sc)this.eXa(null);else{var ad=this.VVb.menuItemId,gb=this.VVb.KF,Hb=this.VVb.gPj,ac=this.VVb.fGh;this.jqa="streamBase64"===Hb?ac.length/1024:0;l.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.kP,
this.jqa);var Ec=(new Date).getTime();sc=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",sc,z.a.hf(this.Pla),z.a.hf(ad),z.a.hf(this.kP),z.a.hf(u.AFrameworkApplication.lcid.toString()),z.a.hf(Ec.toString()),z.a.hf(gb),z.a.hf(u.AFrameworkApplication.canary),u.AFrameworkApplication.vi,z.a.hf(Hb));sc+="&"+u.AFrameworkApplication.tdc();u.AFrameworkApplication.Wwa&&(sc+="&"+u.AFrameworkApplication.Ncc());(ad=this.Io?this.Io.pR:null)&&
(sc+="&DestinationUrl="+z.a.hf(ad));this.DAd.gFb.Jm(sc,2,ac,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(k.a)(this,this.bLi,"newDocumentFromStreamSuccessHandler"),Object(k.a)(this,this.aLi,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,void 0,void 0,"31")}}bLi(sc){if(sc&&sc.data&&sc.data.de)if(({ht:ad}=ba.d(sc.data.de)).returnValue)if(sc=ad,sc.StatusCode!==Z.a.IO&&sc.StatusCode!==Z.a.Ssb)l.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",
this.kP,this.jqa,sc.StatusCode),this.eXa(null);else if(sc.NewDocumentUrl&&""!==sc.NewDocumentUrl){var ad=(new Date).getTime()-this.P5d;l.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.kP,this.jqa,ad);this.QAg(sc.NewDocumentUrl)}else l.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.kP,this.jqa),this.eXa(null);else l.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",
this.kP,this.jqa,{["ResponseData"]:ea.a.Yfb(sc.data.de)}),this.eXa(null);else l.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.kP,this.jqa),this.eXa(null)}aLi(sc){sc&&sc.data&&l.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.kP,this.jqa,sc.data.status);this.eXa(null)}get kP(){switch(this.DAd.nca){case 3:return"WordWAC";case 1:return"ExcelWAC";
case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get aGh(){return this.jjb.value}get Pla(){return this.Sqa.value}get DAd(){return this.G1.value}get Ucc(){return this.QDa.value}}Object(e.a)(ra,"NewDocumentFromStreamOperation",null,[]);class O{constructor(sc,ad,gb,Hb){this.jjb=sc;this.Sqa=ad;this.G1=gb;this.qxg=Hb}create(sc,ad,gb){return new ra(sc,ad,gb,this.jjb,this.Sqa,this.G1,this.qxg)}}Object(e.a)(O,"NewDocumentFromStreamOperationFactory",null,[592]);var da=a(83),xa=a(519),ia=a(55);
class Ma{get name(){return"Common.App.NewAndOpen.UX"}Bh(sc){sc.register(O,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").qc().yc(()=>new O(new h.a(()=>u.AFrameworkApplication.sa.Qa.xgd()),new h.a(()=>u.AFrameworkApplication.Pla),new h.a(()=>sc.mg("Common.INewAndOpenCommonHelpers")),new h.a(()=>sc.mg("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){u.AFrameworkApplication.fa.ru(()=>{this.Kzb()})}Kzb(){const sc=
xa.a.Rq(da.a.instance.Tb("Common.INewAndOpenCommonHelpers")),ad=xa.a.Rq(da.a.instance.Tb("Common.IEventEmitter<Common.IGetMoreInfoResult>"));u.AFrameworkApplication.Pla&&ia.Task.WAA.call(null,sc,ad).continueWith(()=>{const gb=new L(new h.a(()=>sc.result),new h.a(()=>u.AFrameworkApplication.sa.Qa.xgd()),new h.a(()=>ad.result),new h.a(()=>u.AFrameworkApplication.sa.Qa.ygd().XGa||"1959943459"),new h.a(()=>u.AFrameworkApplication.Pla),new h.a(()=>u.AFrameworkApplication.Gri));gb.Ag();gb.gJb()});if(u.AFrameworkApplication.bSf){const gb=
xa.a.Rq(da.a.instance.Tb("Common.IEventEmitter<Common.IMruResult>"));ia.Task.WAA.call(null,sc,ad,gb).continueWith(()=>{const Hb=new Y(new h.a(()=>sc.result),new h.a(()=>V.w2i),new h.a(()=>u.AFrameworkApplication.sa.Qa.ygd()),new h.a(()=>u.AFrameworkApplication.v2i),new h.a(()=>u.AFrameworkApplication.u2i),new h.a(()=>ad.result),new h.a(()=>gb.result),u.AFrameworkApplication.fa);Hb.Lgj();Hb.ETf()})}}dispose(){}}Object(e.a)(Ma,"UXPackageManager",null,[3,4,2]);var Ta=a(1200),Da=a(1207),fa=a(1180),ua=
a(1216),Fa=a(1208),ca;(function(sc){sc[sc.myFiles=0]="myFiles";sc[sc.recent=1]="recent";sc[sc.currentFolder=2]="currentFolder";sc[sc.yourPhone=3]="yourPhone"})(ca||(ca={}));Object(e.b)("SharedFilePickerLandingLocation",ca);class ka{constructor(sc){this.FLa=this.lbb=null;this._initialized=!1;this.Amd=sc}C2a(sc){this._initialized||(sc.$n(G.a.JSf),sc.Dl(G.a.JSf,Object(k.a)(this,this.CYi,"onReceivedPickerResponse")),this._initialized=!0)}zgd(sc){return this.FLa=new Promise((ad,gb)=>{const Hb={};Hb[S.a.x5i]=
sc;this.lbb=(ac,Ec)=>{""===Ec?(l.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),ad(ac)):("Canceled"===Ec?l.ULS.sendTraceTag(572548164,306,50,Ec):l.ULS.sendTraceTag(556901065,306,10,Ec),gb(Ec))};this.Amd.execute(ac=>{this.C2a(ac);ac.jj(G.a.A2i,Hb)})})}CYi(sc){this.lbb(sc.Values[S.a.Ouj],void 0===sc.Values[S.a.qGd]||null===sc.Values[S.a.qGd]?"":sc.Values[S.a.qGd])}btd(){return u.AFrameworkApplication.fa.pa("UiHostCommonFilePicker")}UHe(sc,ad,gb,Hb,ac,Ec,pd){const Bd={};Bd[S.a.Auj]=
sc;Bd[S.a.titleText]=ad;Bd[S.a.VQg]=gb;Bd[S.a.WQg]=Hb;Bd[S.a.XQg]=!1;Bd[S.a.Nnh]=!0;Bd[S.a.lGh]=ac;Bd[S.a.B5i]=Ec;Bd[S.a.A5i]=ca[pd];C.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(Bd[S.a.C5i]="Dark");return Bd}}Object(e.a)(ka,"SharedFilePickerManager",null,[537]);class Ca{constructor(){this.$a=null}get name(){return"Common.App.SharedFilePicker"}Bh(sc){this.$a=sc;sc.register(ka,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").qc().yc(()=>
new ka(sc.Tb("Postmessage.IHostPostmessenger")))}init(){u.AFrameworkApplication.fa.ru(()=>{this.Kzb()})}Kzb(){this.$a.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){f.a.instance.ii(new Ca)}}Object(e.a)(Ca,"SharedFilePickerPackage",null,[3,4]);var fb=a(1310),yb=a(853),mb=a(27);class nb{get name(){return"Common.App.WildFire"}roe(sc){let ad=!1;sc&&(sc.x5c(),sc.h_g&&(ad=!1));return ad}Ybh(){var sc=u.AFrameworkApplication.sa.Qa;sc=new fb.a(sc.Oj,yb.a.Qdc(),!1,1===sc.sca);
this.roe(sc)&&l.ULS.sendTraceTag(17571982,306,50,"ChromeExtBannerDisplayed")}n6b(sc,ad,gb,Hb,ac,Ec){sc=new fb.a(sc,gb,Hb,ad,ac,Ec);this.roe(sc)&&l.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}gih(){const sc=u.AFrameworkApplication.sa.Qa;var ad=u.AFrameworkApplication.fa;const gb=sc.Oj,Hb=1===sc.sca;if(ad.pa(yb.a.W6h(gb))){var ac=yb.a.Qdc(),Ec=8<mb.a.P5a;if(2!==gb||2!==ac||!Hb){ad=ad.pa(yb.a.X6h(gb));var pd=sc.K0f(),Bd=()=>sc.Bx;ad&&!yb.a.urd(yb.a.jfd(gb))&&this.n6b(gb,Hb,ac,Ec,Bd,pd)}}}init(){var sc=
u.AFrameworkApplication.fa;const ad=sc.pa("WildFireChromeExtensionEnabled");sc=sc.pa("WildFireChromeExtensionBar")&&ad;yb.a.Gzc&&sc&&!yb.a.urd(yb.a.lCe)?this.Ybh():(document.body&&yb.a.jHj&&this.gih(),u.AFrameworkApplication.rb.Nb(M.a.Fvd,N.a.frame,Object(k.a)(this,this.Fvd,"launchWildFireBusinessBar")))}Fvd(sc,ad,gb,Hb,ac){if(1===gb)return 32;if(!ac)return 8;this.n6b(ac.app,ac.mode,ac.platform,ac.useTwoButton,null,null);return 32}dispose(){}Bh(){}static main(){f.a.instance.ii(new nb)}}Object(e.a)(nb,
"PackageManager",null,[3,4]);var X=a(1298);a(1084);var R=a(9),wa=a(709),na=a(50),Ba=a(37),Ra=a(189),qa=a(1);class La{constructor(sc){this.hh=sc}Hc(){return!1}executeCommand(sc,ad,gb){return 2!==this.hh.Vd(M.a.newDocument,2,gb)?ia.Task.Sa(!0):Ra.a(ad.command)}wc(sc,ad){return 1056925771===ad.command}Nc(sc,ad,gb){sc=!0;switch(ad){case "PopulateNewMenu":this.hh&&(qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6883546_ConsumerTemplatesFileNewTrigger")&&u.AFrameworkApplication.Tp("XLS-ConsumerTemplates-Treatment;XLS-ConsumerTemplates-Control"),
qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConsumerTemplates",!1)&&(u.AFrameworkApplication.fa.appSettings.TemplateCollectionId="ExcelConsumerWAC",u.AFrameworkApplication.fa.appSettings.NumberOfTemplatesInBackstage="23"),this.hh.Vd(M.a.jsc,2,gb));break;default:sc=!1}return sc}}Object(e.a)(La,"CreateNewCommandHandler",null,[222]);class Yb extends wa.a{constructor(sc){super(sc)}hd(){const sc=na.GetServiceTaskFactory.create(this.$.da,155,this.la,this.Xa),ad=na.GetServiceTaskFactory.create(this.$.da,
165,this.la,this.Xa);Ba.TaskExtensions.za(Ba.TaskExtensions.Fd([sc,ad],this.la),()=>{this.$c([new La(u.AFrameworkApplication.rb)])},this.la,3)}static ka(sc){wa.a.Md(87,new Yb(sc))}}Object(e.a)(Yb,"CreateNewCommandHandlerFactory",wa.a,[]);var mc=a(1194),Zb=a(1086),qb=a(1236),Ha=a(512),Ya=a(103),Gb=a(193),Ja=a(11),Na=a(22),Qa=a(282),Oa=a(1013);class bb{}bb.create="Create";bb.activate="Activate";bb.close="Close";bb.remove="Delete";bb.duplicate="Duplicate";Object(e.a)(bb,"Actions",null,[]);var Ga=a(29),
tb=a(45);class wb extends ia.Task{constructor(sc){super();this.Z2d=null;this.a3d=0;this.XRb=null;this._state=0;this.moveNext=()=>{try{for(this._state=1;1===this._state;)this.fXa=this.fXa()}catch(ad){this.dispose(),this.JAa(ad),this._state=3}};this.Rt=sc;this.fXa=this.ZFc;this.moveNext()}ZFc(){this.Z2d=Ga.a.ed(3,2,0,1666,0,-1244327602,"MsFormDeleteConfirmation");this.XRb=tb.a(this.Rt.$).kj(this.Z2d).G();this.XRb.isCompleted||(this._state=2,this.XRb.p$a(this.moveNext));return this.tog}tog(){this.a3d=
this.XRb.vZ();0===this.a3d&&(this.Rt.$.workbookContext.Options=Ja.HelperMethods.fO(!1,this.Rt.$.workbookContext.Options,2048),this.Rt.deleteMsFormMetaDataSheet());this._state=3;this.RRa(!0)}dispose(){}}Object(e.a)(wb,"$$sm_Microsoft$Office$Excel$WebUI$Client$MsForm$MsFormCommandHandler$DeleteMsForm",ia.Task,[2]);class lb{}lb.action="Action";lb.AIh="FlexPane";lb.Pac="formId";lb.id="id";lb.title="Title";lb.jRb="XlWorkbookId";lb.vKh="Fragment";lb.host="Host";lb.pUj="TopView";lb.accountType="auth_pvr";
Object(e.a)(lb,"Parameters",null,[]);var db=a(60);const Pa=(sc,ad,gb,Hb,ac,Ec,pd=null)=>{pd=sc.Na(9,pd);pd.sheetName=ad;pd.confirmationChoice=!0;return db.g(sc,"DeleteSheet",pd,gb,Hb,ac,Ec,0)};class ja{constructor(sc){this.ko="Excel";this.$=sc;this.GU=Oa.a.current}get hasMsForm(){return Ya.c(this.$.dg)}get Dnc(){return this.$.workbookContext.MsFormId}get gRb(){return this.$.workbookContext.MsFormDocUrl}get accountType(){return Na.a.contains(this.$.Wu.DocumentHostInfo.FileSource,"onedrive",!0)?"MSA":
"OrgId"}Hc(sc,ad){switch(ad){case -105284469:return!Ya.i(this.$.dg)||this.hasMsForm;case -1219864912:case 1674421386:case -1128532220:case 2023601781:return!this.hasMsForm}return!1}executeCommand(sc,ad){sc=Ba.TaskExtensions.Tj();ad=ad.command;switch(ad){case -105284469:this.insertMsForm();break;case -1219864912:this.previewMsForm();break;case -1128532220:this.editMsForm();break;case 1674421386:this.sendMsForm();break;case 2023601781:sc=this.deleteMsForm();break;default:sc=Ra.a(ad)}return sc}wc(sc,
ad){if(!this.$.ea.wg.get(61))return!1;sc=!1;switch(ad.command){case -105284469:sc=Ya.i(this.$.dg)&&!this.hasMsForm;break;case -1219864912:case 1674421386:case -1128532220:case 2023601781:sc=this.hasMsForm}return sc}Nc(){return!1}insertMsForm(){const sc=z.a.Lp(this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),ad={},gb={};ad[lb.action]=bb.create;ad[lb.accountType]=this.accountType;gb[lb.action]=bb.create;gb[lb.jRb]=encodeURIComponent(this.gRb);gb[lb.host]=this.ko;gb[lb.title]=encodeURIComponent(sc);
this.rEb(ad,gb);this.$.workbookContext.Options=Ja.HelperMethods.fO(!1,this.$.workbookContext.Options,2048)}editMsForm(){const sc={},ad={};sc[lb.accountType]=this.accountType;ad[lb.Pac]=this.Dnc;ad[lb.jRb]=encodeURIComponent(this.gRb);ad[lb.host]=this.ko;this.rEb(sc,ad)}previewMsForm(){const sc={},ad={};sc[lb.accountType]=this.accountType;ad[lb.Pac]=this.Dnc;ad[lb.jRb]=encodeURIComponent(this.gRb);ad[lb.host]=this.ko;ad[lb.pUj]="Preview";this.rEb(sc,ad)}sendMsForm(){const sc={},ad={};sc[lb.accountType]=
this.accountType;ad[lb.Pac]=this.Dnc;ad[lb.AIh]="SendForm";ad[lb.jRb]=encodeURIComponent(this.gRb);ad[lb.host]=this.ko;this.rEb(sc,ad)}deleteMsForm(){return new wb(this)}deleteMsFormMetaDataSheet(){this.$.userOperationManager.KE(new Gb.a(158,0,(sc,ad,gb)=>Pa(this.$.oa.Bw,this.GU.Qvb,Qa.b(sc,()=>{this.ilh()}),ad,gb,null)))}ilh(){const sc={},ad={};sc[lb.action]=bb.remove;sc[lb.accountType]=this.accountType;ad[lb.action]=bb.remove;ad[lb.host]=this.ko;ad[lb.Pac]=encodeURIComponent(this.Dnc);ad[lb.jRb]=
encodeURIComponent(this.gRb);this.rEb(sc,ad)}rEb(sc,ad){const gb=this.$.ya.MsFormBaseUrl+"/Pages/DesignPage.aspx";let Hb="";var ac="";if(ad){for(let Bd in ad){var Ec=Bd,pd=ad[Bd];ac+=ac.length?"&":"";ac+=Ec+"="+pd}sc||(sc={});sc[lb.vKh]=encodeURIComponent(ac)}if(sc)for(let Bd in sc)ad=Bd,ac=sc[Bd],Hb+=Hb.length?"&":"?",Hb+=ad+"="+ac;window.open(gb+Hb,"_blank")}}Object(e.a)(ja,"MsFormCommandHandler",null,[222]);class Ka extends wa.a{constructor(sc){super(sc)}hd(){const sc=na.GetServiceTaskFactory.create(this.$.da,
203,this.la,this.Xa);Ba.TaskExtensions.za(Ba.TaskExtensions.Fd([sc],this.la),()=>{this.$c([new ja(this.$)])},this.la,3)}static ka(sc){sc.ea.wg.get(61)&&wa.a.Md(215,new Ka(sc))}}Object(e.a)(Ka,"MsFormCommandHandlerFactory",wa.a,[]);var ub=a(226);class Kb extends ub.a{constructor(sc){super();this.$=sc;this.Db()}create(){Ba.TaskExtensions.za(na.GetServiceTaskFactory.create(this.$.da,164,this.la,this.Xa),()=>{this.nb(new Ma)},this.la,3)}}Object(e.a)(Kb,"NewAndOpenUXFactory",ub.a,[]);class W{constructor(sc,
ad){this.hh=ad;this.$=sc}executeCommand(sc,ad,gb){sc=2;switch(ad.command){case M.a.openUrlInNewTab:sc=this.hh.Vd(M.a.openUrlInNewTab,2,gb);break;case M.a.rPa:sc=this.hh.Vd(M.a.rPa,2,gb)}return 2!==sc?ia.Task.Sa(!0):Ra.a(ad.command)}wc(sc,ad){return ad.command===M.a.openUrlInNewTab||ad.command===M.a.rPa}Nc(sc,ad,gb){return"PopulateMruMenu"===ad?(this.hh.Vd(M.a.isc,2,gb),!0):!1}Hc(){return!1}}Object(e.a)(W,"OpenFromMruCommandHandler",null,[222]);class za extends wa.a{constructor(sc){super(sc)}hd(){const sc=
na.GetServiceTaskFactory.create(this.$.da,155,this.la,this.Xa),ad=na.GetServiceTaskFactory.create(this.$.da,165,this.la,this.Xa);Ba.TaskExtensions.za(Ba.TaskExtensions.Fd([sc,ad],this.la),()=>{this.$c([new W(this.$,u.AFrameworkApplication.rb)])},this.la,3)}static ka(sc){wa.a.Md(88,new za(sc))}}Object(e.a)(za,"OpenFromMruCommandHandlerFactory",wa.a,[]);var Sa=a(1170),Wa=a(1209),ab=a(1249),ma=a(1089),ha=a(1190),eb=a(1090),ta=a(1091),ya=a(1195),sb=a(1237),Qb=a(1238),oc=a(161),kb=a(84),jb=a(376),Wb=a(101),
wc=a(21),Jc=a(377);class zc{constructor(sc,ad){this.sheetName=null;this.value=!1;this.sheetName=sc;this.value=ad}getSheetName(){return this.sheetName}Kva(){return this.value}}Object(e.a)(zc,"MacroRecorderSheetOptionToggledPayload",null,[162]);const gd=(sc,ad,gb,Hb,ac,Ec,pd,Bd=null)=>{Bd=sc.Na(9,Bd);Bd.sheetName=ad;Bd.show=gb;return db.g(sc,"ShowGridlines",Bd,Hb,ac,Ec,pd,0)},Va=(sc,ad,gb,Hb,ac,Ec,pd,Bd=null)=>{Bd=sc.Na(9,Bd);Bd.sheetName=ad;Bd.show=gb;return db.g(sc,"ShowHeadings",Bd,Hb,ac,Ec,pd,0)},
Eb=(sc,ad,gb,Hb,ac,Ec,pd,Bd=null)=>{Bd=sc.Na(9,Bd);Bd.sheetName=ad;Bd.directionRtl=gb;return db.g(sc,"ChangeSheetDirection",Bd,Hb,ac,Ec,pd,0)};var hc=a(187),Ab=a(105),Bb;let ec=Bb=class{constructor(sc){this.$=sc}Hc(){return!1}executeCommand(sc,ad){const gb={};this.$.ak(gb);sc=ad.command;const Hb=Object(kb.a)(Wb.a,this.$.va.getItemByName(gb.SheetName));if(!Hb)return Ra.a(sc);let ac,Ec,pd,Bd,de;switch(sc){case 705559150:case -1411193626:ac=16;Ec=!Hb.hideGridLines;pd=gd;de=183;Bd=Hb.hideGridLines;break;
case -2052321504:case 515737500:ac=4;Ec=!Hb.headersVisible;pd=Va;de=184;Bd=!Hb.headersVisible;break;case -1478455630:ac=2;Ec=!Hb.displayRtl;pd=Eb;de=185;Bd=!Hb.displayRtl;wc.h(this.$).Ca.VZj(Ec);break;default:return Ra.a(sc)}Hb.crb(ac,Ec);const Jb=()=>new zc(gb.SheetName,Bd),tc=this.$.oa.xa;return jb.a(this.$.userOperationManager,(fd,Ad,me)=>pd(tc,gb.SheetName,Bd,Qa.b(fd,Vd=>{Bb.VGb(Vd,Hb,ac,Ec)}),Qa.a(Ad,()=>{Bb.gGb(Hb,ac,Ec)}),me,null),fd=>new Gb.a(de,0,fd,void 0,Jb),ad)}wc(sc,ad){sc=!1;switch(ad.command){case -1411193626:case 515737500:case -1478455630:sc=
!0;break;case 705559150:case -2052321504:sc=Jc.a(this.$)}return sc}Nc(){return!1}static VGb(sc,ad,gb,Hb){Ga.a.qq(sc.Errors)&&ad.crb(gb,!Hb)}static gGb(sc,ad,gb){sc.crb(ad,!gb)}};ec=Bb=Object(oc.b)([Object(hc.d)(Ab.m),Object(oc.c)(0,Object(Ab.f)())],ec);Object(e.a)(ec,"SheetOptionsToggleCommandHandler",null,[222]);class Qd extends wa.a{constructor(sc){super(sc)}hd(){this.$c([new ec(this.$)])}static ka(sc){wa.a.Md(100,new Qd(sc))}}Object(e.a)(Qd,"SheetOptionsToggleCommandHandlerFactory",wa.a,[]);String(c);
window.___1676210823994_closurehack=c;var dc=a(174),dd=a(182),jd=a(152),md=a(65),vd=a(56),wd=a(213),Pd=a(592),ic=a(94),cd=a(253),Hd=a(215),he=a(12);class Lb extends Hd.a{constructor(sc,ad,gb,Hb=null){super(sc,gb,2,Hb);this.kMc=null;this.onResize=()=>{const ac=this.XWh();this.HLa.setAttribute("width",ac.x.toString());this.HLa.setAttribute("height",ac.y.toString());this.I_j(ac);this.wDd()};this.VKe=ad;this.$.dC(this.onResize);this.dfc()}get HLa(){return this.kMc}initialize(){const sc=this.$.Bb+"iframeDialog_frame",
ad=this.$.Bb+"iframeDialog";this.Fb.style.margin=Ja.HelperMethods.sc(0);this.Fb.style.marginBottom=Ja.HelperMethods.sc(-2);if(qa.EwaSettings.isChangeGateEnabled("OfficeVSO:7111358_IFrameDialogReduceInnerHtml")){var gb=document.createElement("iframe");gb.id=sc;gb.frameBorder="0";gb.scrolling="auto";gb.src=this.Ogd(ad);this.Fb.appendChild(gb)}else gb=String.format('<iframe id="{0}" frameborder="0" scrolling="auto" src="{1}">\r\n</iframe>',sc,this.Ogd(ad)),this.Fb.innerHTML=gb;this.kMc=document.getElementById(sc);
this.domElement.id=ad;this.onResize(null,Sys.EventArgs.Empty);super.initialize()}dispose(){this.$&&this.$.zF(this.onResize);super.dispose()}setFocus(){he.DOMElementExtensions.setFocus(this.HLa)}onHide(){this.HLa.contentWindow.close();he.DOMElementExtensions.vf(this.HLa);this.kMc=null;super.onHide()}I_j(sc){const ad=this.domElement.style;ad.width=Ja.HelperMethods.sc(sc.x);ad.marginLeft=Ja.HelperMethods.sc(-sc.x/2)}XWh(){const sc=he.DOMElementExtensions.getBounds(document.body);return new Sys.UI.Point(Math.min(Math.floor(.9*
sc.width),this.VKe.x),Math.min(Math.floor(.9*sc.height),this.VKe.y))}}Object(e.a)(Lb,"IFrameDialog",Hd.a,[]);var Ic=a(5),Ob=a(77),Kc=a(13);class Ac extends Lb{constructor(sc){super(sc,new Sys.UI.Point(960,680),Kc.a.instance.ga(1263));this.name=Ic.a.lPe}get kc(){return"EmbeddingDialog"}Ogd(sc){const ad=new Sys.StringBuilder(this.$.ya.EmbedConfiguratorUrl);wd.a.Mk(ad,Ic.a.Nuh,sc);Ob.a(this.$.ya,32)&&wd.a.Mk(ad,Ic.a.zRe,"1");Ob.a(this.$.ya,33)&&wd.a.Mk(ad,Ic.a.ARe,"1");Ob.a(this.$.ya,34)&&wd.a.Mk(ad,
Ic.a.yRe,"1");return ad.toString()}onShow(){l.ULS.sendTraceTag(537151690,0,50,"EmbeddingDialog.OnShow: the dialog is being shown");super.onShow()}}Object(e.a)(Ac,"EmbeddingDialog",Lb,[]);var Yc=a(1263),td=a(89),$d=a(79),be=a(838);class ke{}ke.u7f="FrameDialog_ShareFromEdit";ke.view="FrameDialog_View";ke.uDe="FrameDialog_CloseAndRefresh";ke.ODj="FrameDialog_ShareFromView";ke.edit="FrameDialog_Edit";ke.Yej="FrameDialog_RefreshGrid";ke.f6g="FrameDialog_CloseMe";ke.EDe="FrameDialog_CloseMeError";ke.ready=
"FrameDialog_Ready";ke.e6i="FrameDialog_PleaseClose";ke.UJ="GotoRange";Object(e.a)(ke,"PostMessageConstants",null,[]);var Pe=a(284),Dd=a(113),ge=a(249);class ne{constructor(){this.UJ=null;this.VGd=1461300262}}Object(e.a)(ne,"SessionUpdateContext",null,[]);class ce extends Lb{constructor(sc,ad,gb){super(sc,new Sys.UI.Point(ce.Ikh,ce.ikh),Kc.a.instance.ga(ad?1268:1267));this.o1a=null;this.BNc=!1;this.Jqc=Hb=>{const ac=this.$,Ec=new ne;Ec.UJ=Hb.Values[ke.UJ];let pd=!1;switch(Hb.MessageId){case ke.u7f:this.dv();
pd=!0;Ec.VGd=1334518759;break;case ke.view:this.xoa=Kc.a.instance.ga(1268);this.Pkg(!0);break;case ke.uDe:this.dv(),pd=!0}Hb=new Gb.a(140,0,(Bd,de,Jb)=>Pe.n(ac.oa.xa,Qa.b(Bd,this.WZi),de,Jb,Ec));Hb.flags=pd?16:80;ac.userOperationManager.Jc(Hb,this.Sd)};this.IRi=()=>{const Hb=this.$;Hb.ya.SurveyRedirectUrl?(this.dv(),Hb.Yc(1305810481,0,8,null)):(this.xoa=Kc.a.instance.ga(1267),this.Pkg(!1))};this.j_i=()=>{const Hb=this.$;this.dv();Hb.Yc(1334518759,0,8,null)};this.Soc=Hb=>{const ac=this.$;this.dv();
Hb.MessageId===ke.EDe&&ac.ea.Ldd()};this.xYi=()=>{this.BNc=!0;this.raiseEvent(ce.Svd)};this.WZi=(Hb,ac)=>{if(!ge.a(Hb)){Hb=this.$;if(ac.UJ){const Ec=Hb.ea.va;if(Ec.contains(ac.UJ.SheetName))this.Epc(ac);else{let pd=null;pd=()=>{Ec.bna(pd);this.Epc(ac)};Ec.Nga(pd)}}1461300262!==ac.VGd&&Hb.Yc(ac.VGd,0,8,null)}};this.Mbe=ad;this.Sd=gb}BNg(sc){this.addHandler(ce.Svd,sc)}Bkj(sc){this.removeHandler(ce.Svd,sc)}get kc(){return"FormDialog"}get Vjf(){return this.BNc}get C7a(){return this.Mbe}dispose(){td.a.Ja(this.o1a);
this.o1a=null;super.dispose()}initialize(){super.initialize();const sc=$d.a.Uaa(this.$.ya.FormLightBoxUrl),ad=this.o1a=new Yc.a(this.HLa.contentWindow,sc);ad.isEnabled()&&ad.RFa(sc)&&(this.Tma(ke.u7f,this.Jqc),this.Tma(ke.view,this.Jqc),this.Tma(ke.uDe,this.Jqc),this.Tma(ke.ODj,this.j_i),this.Tma(ke.edit,this.IRi),this.Tma(ke.Yej,this.Jqc),this.Tma(ke.ready,this.xYi),this.Tma(ke.f6g,this.Soc),this.Tma(ke.EDe,this.Soc))}close(sc){sc===this.kM&&this.Vjf&&this.o1a.send(new be.a(ke.e6i))||super.close(sc)}Ogd(){return this.SHe(this.C7a)}SHe(sc){const ad=
this.$.ya,gb=new Sys.StringBuilder(ad.FormLightBoxUrl);wd.a.Mk(gb,Ic.a.dKh,this.$.ea.sessionId);wd.a.Mk(gb,Ic.a.bKh,sc?Ic.a.cKh:Ic.a.aKh);Dd.a.$ob(gb,ad);return gb.toString()}Pkg(sc){this.BNc=!1;this.HLa.src=this.SHe(sc);this.Mbe=sc}Tma(sc,ad){this.o1a.$n(sc);this.o1a.Dl(sc,ad)}Epc(sc){const ad=this.$.ea.va.getItemByName(sc.UJ.SheetName);ad&&0===ad.AB&&wc.h(this.$).qg(sc.UJ,null,null,null,20,"FormDialog.OnItemInserted")}}ce.Ikh=900;ce.ikh=1200;ce.Svd="lightBoxReady";Object(e.a)(ce,"FormDialog",Lb,
[219]);var we;(function(sc){sc[sc.comment=10]="comment";sc[sc.range=12]="range";sc[sc.table=13]="table";sc[sc.chart=14]="chart";sc[sc.sheet=15]="sheet"})(we||(we={}));Object(e.b)("NavigationType",we);var ve=a(996),Re=a(87),rf=a(19),We=a(560),Ye=a(960),bf=a(286),Ve=a(765),Za=a(51);class Xb extends Ve.a{constructor(sc,ad,gb,Hb,ac,Ec=0,pd){super(sc,Kc.a.instance.ga(ad),!1);this.htmlSanitizationHelper=null;this.message=gb;this.zNi=Hb;this.p2d=ac;this.operationFlags=Ec;this.htmlSanitizationHelper=pd}get kc(){return"WebMethodConfirmationDialog"}get IB(){return 1005}get IHa(){return this.operationFlags}initialize(){let sc=
"<div class='"+Re.a.Nl+"'>\r\n\t<div class='"+Re.a.qad+"'>\r\n\t\t<div class='"+rf.a.W2c+"'>\r\n\t\t\t<img src='{0}' class='"+rf.a.TUe+"' alt='{1}' />\r\n\t\t</div>\r\n\t</div>\r\n\t<div class='"+Re.a.tad+"'>\r\n\t\t<p>{2}</p>\r\n\t</div>\r\n</div>";sc=String.format(sc,Za.a.qe(13),Kc.a.instance.ga(25),Kc.a.instance.ga(this.message));this.htmlSanitizationHelper&&qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&qa.EwaSettings.isChangeGateEnabled("OfficeVSO:7094158_SocialSharingSanitizeInnerHtml")?
this.htmlSanitizationHelper.Rh(this.Fb,sc):this.Fb.innerHTML=sc;this.addButton(0,this.zNi);this.addButton(1);super.initialize()}GG(){return this.p2d}}Object(e.a)(Xb,"WebMethodConfirmationDialog",Ve.a,[]);class ib extends ve.a{constructor(sc,ad){super(sc,Kc.a.instance.ga(1270));this.htmlSanitizationHelper=this.aUa=this.BRa=this.textBox=null;this.RJf=()=>{const gb=this.$;this.dv();const Hb=new Xb(gb,1273,1274,1275,(ac,Ec,pd)=>{var Bd=gb.oa.xa.Wb(),de=gb.oa.xa;Bd=de.Na(1,Bd);return db.g(de,"UnshareForm",
Bd,ac,Ec,pd,null,0)},16,this.htmlSanitizationHelper);Hb.initialize();Hb.kg()};this.htmlSanitizationHelper=ad}get kc(){return"ShareFormDialog"}dispose(){this.aUa&&this.aUa.tda(this.RJf);td.a.pc([this.textBox,this.BRa,this.aUa]);this.aUa=this.BRa=this.textBox=null;super.dispose()}initialize(){let sc="<div class='"+Re.a.Nl+"'>\r\n\t<span>{0}</span>\r\n</div>\r\n<div class='"+Re.a.mJa+"'>\r\n\t<input type='text' id='{1}' class='"+Re.a.Px+"' aria-live='polite' aria-atomic='true'/>\r\n\t<br />\r\n\t<a href='#' id='{2}' class='{3}'>{4}</a>\r\n</div>";
sc=String.format(sc,Kc.a.instance.ga(1271),"sfd_input","sfd_unshare",rf.a.io,Kc.a.instance.ga(1272));this.htmlSanitizationHelper&&qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&qa.EwaSettings.isChangeGateEnabled("OfficeVSO:7094158_SocialSharingSanitizeInnerHtml")?this.htmlSanitizationHelper.Rh(this.Fb,sc):this.Fb.innerHTML=sc;this.textBox=new bf.a(this.getElementById("sfd_input"));this.BRa=new Ye.a(this.textBox.domElement);this.aUa=We.a.create(this.getElementById("sfd_unshare"));
this.aUa.m2(this.RJf);this.textBox.text=Kc.a.instance.ga(735);this.textBox.enabled=!1;this.textBox.readOnly=!mb.a.Hg;this.addButton(1,10);super.initialize()}D_a(){return(sc,ad,gb)=>{var Hb=this.$.oa.xa.Wb(),ac=this.$.oa.xa;sc=this.j4a(sc);ad=this.lKa(ad);Hb=ac.Na(1,Hb);return db.g(ac,"ShareForm",Hb,sc,ad,gb,null,0)}}y_(sc,ad,gb){this.textBox.text=sc.Result;this.textBox.enabled=!0;he.DOMElementExtensions.setVisible(this.aUa.domElement,!0);super.y_(sc,ad,gb)}setFocus(){if(this.textBox&&this.textBox.enabled)try{this.textBox.focus();
return}catch(sc){}super.setFocus()}}Object(e.a)(ib,"ShareFormDialog",ve.a,[]);var Rb=a(248),lc=a(6),nc=a(82),Oc=a(256),Ib=a(73),gc=a(628),Fc=a(142),Vc=a(430),ed=a(258),Sd=a(17),Zd=a(255);class pa extends dd.a{constructor(sc,ad,gb){super();this.Vze=this.Wze=!1;this.f3a=0;this.Kia=!1;this.XOi=()=>{this.Wze=!0;this.C9f()};this.$=sc;this.Va=ad;this.PJ=gb;Ib.a(this.$).zKd(new Fc.a(lc.a.Kig,lc.a.idle,pa.X2g),new Rb.a(lc.a.CDe,lc.a.r_,null,lc.a.DO,lc.a.idle))}get MFc(){return Ya.b(this.$.dg)}get oPd(){return this.$.isEditMode&&
(this.$.ea.tqh||this.$.SM)}Hc(sc,ad){switch(ad){case 353606613:case -1099009678:case 192430811:return!qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.f8f();case 783415632:return!qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)||this.f8f();case 869186573:return this.g8f();case -1570751769:case 1986648902:return 131072!==(this.$.CU&131072);case 330035228:return!(this.D3a(!0)&&this.MFc);case -509039657:return!(this.D3a()&&this.MFc);
case 1334518759:return!(this.D3a()&&this.MFc&&this.hAe())}return!1}f8f(){return this.$.ea.isNamedObjectViewMode||this.$.isMobileMode||this.g8f()}g8f(){const sc=this.$.workbookContext.FullDocumentInfo,ad=ed.a()&&this.$.ea.wg.get(5);return!sc.FileSharingUrl&&!ad}executeCommand(sc,ad,gb){sc=this.$.workbookContext.FullDocumentInfo;var Hb=M.a.workflow,ac=Ba.TaskExtensions.Tj();const Ec=ad.command;if(Ec===Hb||-266099===Ec)return this.Qai(ad,Hb,sc);switch(Ec){case 1986648902:this.J6f();break;case -1570751769:this.l9h(ad);
break;case 869186573:ad=M.a.NDj;ac=u.AFrameworkApplication.fa.pa("ShareMenuIsEnabled");Hb=null;(qa.EwaSettings.ra(478)||ac)&&gb&&"CopyLink"===gb.SourceControlId?(Hb={},Hb[S.a.PMb]="copy",ad=M.a.t7f):ac&&gb&&"ManageAccess"===gb.SourceControlId?(Hb={},Hb[S.a.PMb]="manageAccess",ad=M.a.PDj):gb&&"LinkToComment"===gb.SourceControlId&&(Hb={},Hb[S.a.PMb]="copy",Hb[S.a.QSd]=gb.navId,ad=M.a.t7f);ac=this.J$f(sc,Hb);v.c(ad);break;case -1099009678:ac=this.Qyc(12,sc);break;case 192430811:ac=this.Qyc(13,sc);break;
case 353606613:ac=this.Qyc(14,sc);break;case 783415632:gb&&"LinkToThisSheet"===gb.SourceControlId&&l.ULS.sendTraceTag(509691100,0,50,"SocialSharingCommandHandler.ExecuteCommand: Share Sheet invoked from Collab Corner");ac=this.Qyc(15,sc);break;case -59906385:case 1197060601:this.aai(ad,sc);break;case 1305810481:this.E$e(!1,ad);break;case 330035228:this.E$e(!0,ad);break;case -509039657:qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&qa.EwaSettings.isChangeGateEnabled("OfficeVSO:7094158_SocialSharingSanitizeInnerHtml")?
Ba.TaskExtensions.za(na.GetServiceTaskFactory.Oa(this.$.da,498,499,0),pd=>{this.deleteForm(pd.result)},this.$.la,3):this.deleteForm(null);break;case 1334518759:ad.KAb=!0;qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&qa.EwaSettings.isChangeGateEnabled("OfficeVSO:7094158_SocialSharingSanitizeInnerHtml")?Ba.TaskExtensions.za(na.GetServiceTaskFactory.Oa(this.$.da,498,499,0),pd=>{this.shareForm(pd.result)},this.$.la,3):this.shareForm(null);break;case 710925581:vd.a.pg.kzc("710925581")&&
(ac=Ba.TaskExtensions.za(this.PJ.value,pd=>{pd.result.jj(G.a.conversation,{})},this.la,3));break;case 327119921:this.Z8h();break;default:ac=Ra.a(Ec)}return ac}wc(sc,ad){sc=!1;ad=ad.command;if(ad===M.a.workflow)return!0;switch(ad){case 1986648902:case -1570751769:case 869186573:case -59906385:case 1197060601:case 1305810481:case 330035228:case -509039657:case 1334518759:case -266099:case 710925581:case 327119921:sc=!0;break;case 353606613:case -1099009678:case 192430811:sc=qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",
!1)&&!this.$.ea.isNamedObjectViewMode;break;case 783415632:sc=qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)&&!this.$.ea.isNamedObjectViewMode}return sc}Nc(sc,ad,gb){if("PopulateFormMenu"===ad){ad=this.MFc?this.hAe()?pa.oEh:pa.pEh:pa.fLi;sc=this.Va.Ec();for(let Hb=0;Hb<ad.length;Hb++)sc.buttons.push(this.Va.pb(ad[Hb]));ad=this.Va.uq("Forms.Flyout");ad.rc.push(sc);gb.MenuItems=ad.oE();return!0}return!1}Qai(sc,ad,gb){return this.oPd&&sc.command===ad?(this.mPd(sc,-266099),
Ba.TaskExtensions.Yaa()):Ba.TaskExtensions.za(this.PJ.value,Hb=>{Pd.a(Hb.result,G.a.workflow,null,gb.WorkflowPostMessage)||Ja.HelperMethods.gf(gb.WorkflowUrl,"_blank",void 0,"SocialSharingCommandHandler.WorkflowUrl")},this.la,3)}hAe(){return!!this.$.workbookContext.FullDocumentInfo.ShareFormCommandUrl||this.$.ea.wg.get(26)}Z8h(){var sc=dc.a.create().toString();l.ULS.sendTraceTag(528581128,306,50,`Calling share to teams deeplink with ID: ${sc}`);var ad=this.$.frame,gb=ad.O9a,Hb=this.$;const ac=new Zd.QueryStringBuilder(u.AFrameworkApplication.fa.Wa("TeamsMeetingShareEndpoint"));
ac.Zi("deeplinkId",sc);ac.Zi("lm","deeplink");sc=ac.Zi;var Ec={};const pd=new Zd.QueryStringBuilder(u.AFrameworkApplication.fa.Wa("TeamsAppSharingUrl"));pd.Zi("auth","2");pd.Zi("flight","officeunihost");pd.Zi("source","TEAMS-ELECTRON.meetingStage.deeplink");var Bd={};Bd.fileType=z.a.Z3(Hb.workbookContext.FullDocumentInfo.WorkbookPath).substring(1);Bd.objectUrl=Hb.workbookContext.FullDocumentInfo.WorkbookPath;Bd.baseUrl=Hb.workbookContext.FullDocumentInfo.BreadcrumbBrandUrl;{Hb=Hb.workbookContext.WorkbookFileVersionId;
let de=decodeURIComponent(Hb);for(;Hb!=de;)Hb=de,de=decodeURIComponent(Hb);0>Hb.indexOf("{")||0>Hb.indexOf("}")?(l.ULS.sendTraceTag(528250338,306,15,`Decoded fileId does not match expected format. Decoded id: ${Hb}`),Hb=""):Hb=Hb.substring(Hb.indexOf("{")+1,Hb.indexOf("}")).toLowerCase()}Bd.fileId=Hb;Bd=ba.c(ba.c(Bd));pd.Zi("subEntityId",Bd.substring(1,Bd.length-1));Ec.appSharingUrl=pd.toString();Ec.appId=u.AFrameworkApplication.fa.Wa("TeamsAppId");Ec.useMeetNow=qa.EwaSettings.isChangeGateEnabled("OfficeVSO:7569119_MeetNowIsEnabled");
Ec=JSON.stringify(Ec);sc.call(ac,"appContext",Ec);gb.call(ad,ac.toString(),!0)}l9h(sc){this.oPd?this.mPd(sc,1986648902):this.J6f()}E$e(sc,ad){!sc&&this.$.ya.SurveyRedirectUrl?this.t$i():(sc=new ce(this.$,sc,ad),sc.initialize(),sc.kg())}aai(sc,ad){this.oPd&&1197060601===sc.command?this.mPd(sc,-59906385):Ba.TaskExtensions.za(this.PJ.value,gb=>{gb=gb.result;gb&&Pd.a(gb,G.a.replyWithChanges,null,this.$.ea.wg.get(8))||(gb=new Sys.StringBuilder(ad.ReplyWithChangesUrl),wd.a.Mk(gb,Vc.e,Vc.d),jd.a.ntw(gb.toString(),
this.$))},this.la,3)}mPd(sc,ad){const gb=Ib.a(this.$).gd.activityState,Hb=new ic.a(ad,sc.method,sc.mode,sc.Ve,sc.tabName);tb.a(this.$).vr(new cd.a(lc.a.hw,5,()=>{gb[Oc.a.Dp]=lc.a.L0f;gb[gc.a.gWc]=Hb;this.$.Uk.Ly("SocialSharingSaveBeforeCommand");this.$.Uk.vpe(Hb.command)}))}J6f(){const sc=this.$.ya.DocumentHostInfo;sc.HostEmbeddedViewUrl||this.Wze?this.C9f():this.$.$d.get(53)&&Ba.TaskExtensions.za(this.PJ.value,ad=>{this.rXj(ad.result)||jd.a.ntw(sc.FileEmbedCommandUrl,this.$)},this.la,3)}rXj(sc){return sc.isEnabled()&&
(this.Vze||(this.Vze=sc.Dl(G.a.Uze,this.XOi)))?sc.jj(G.a.PFh,null):!1}C9f(){if(mb.a.fp)jd.a.ntw(this.$.ya.EmbedConfiguratorUrl,this.$);else{const sc=new Ac(this.$);sc.initialize();sc.kg()}}deleteForm(sc){const ad=this.$;sc=new Xb(ad,1276,1277,1269,(gb,Hb,ac)=>{var Ec=ad.oa.xa.Wb(),pd=ad.oa.xa;Ec=pd.Na(9,Ec);Ec.surveyId=null;return db.g(pd,"DeleteSurvey",Ec,gb,Hb,ac,null,0)},0,sc);sc.initialize();sc.kg()}shareForm(sc){const ad=this.$.workbookContext.FullDocumentInfo;this.$.ea.wg.get(26)?(sc=new ib(this.$,
sc),sc.initialize(),sc.kg()):Ba.TaskExtensions.za(this.PJ.value,gb=>{Pd.a(gb.result,G.a.shareForm,{[S.a.kQj]:this.$.workbookContext.SurveyTitle},this.$.ea.wg.get(10))||jd.a.ntw(ad.ShareFormCommandUrl,this.$)},this.la,3)}t$i(){const sc=this.$;sc.ya.SurveyRedirectUrl.replace(RegExp("&startupdialog=[formedit|formpreview]","gi"),"");const ad=new Sys.StringBuilder(sc.ya.SurveyRedirectUrl);wd.a.Mk(ad,"startupDialog","FormEdit");const gb=Ib.a(this.$),Hb=gb.gd.activityState;Hb[nc.a.d2]=ad.toString();Hb[nc.a.QL]=
nc.a.nAd;this.$.Uk.Ly("SocialSharingEnvironmentChange");tb.a(sc).vr(new cd.a(lc.a.hw,5,()=>{const ac=Ga.a.ed(3,2,1321,1322,1323,554412057,"FossEnvironmentUnsupported");gb.gd.Yq([ac]);Hb[Oc.a.Dp]=lc.a.Kig}))}D3a(sc=!1){return(this.$.ea.isEditMode||sc)&&this.$.ea.wg.get(25)&&ed.a()}w3h(sc){var ad=wc.h(this.$).ha;const gb=this.$.va.na?md.d(this.$.va.na):null;if(!gb)return l.ULS.sendTraceTag(537151649,0,10,`SocialSharingCommandHandler.GetSharingDetail: Unable to find current sheet id for navType: ${we[sc]}.`),
null;var Hb=null;14===sc?Hb=this.V2h(ad):12===sc?(Hb=ad.fia,Hb=Na.a.contains(Hb,"!",!0)?Hb.split("!")[1]:Hb):13===sc&&(ad=ad.qa.selectedRanges,ad[0]&&(ad=wc.h(this.$).tb.Dh(ad[0])))&&(Hb=ad.Hi);if(!Hb&&15!==sc)return l.ULS.sendTraceTag(537151648,0,10,`SocialSharingCommandHandler.GetSharingDetail: Unable to find the selected range reference or object id for navType: ${we[sc]}`),null;ad={};ad[S.a.PMb]="copy";ad[S.a.QSd]=this.tUh(sc,Hb,gb);ad[S.a.QDj]="deepLinkShare";l.ULS.sendTraceTag(537151647,0,50,
`SocialSharingCommandHandler.GetSharingDetail: Send Section_Sharing post message with navType: ${we[sc]} and sectionNameOrId: ${Hb} and SheetId: ${gb}`);return ad}V2h(sc){if(sc.Ra.O4&&(sc=sc.Ra.dc.floatingObject)&&0===sc.type){const ad=sc.id.split(".");if(1<ad.length)return ad[1];l.ULS.sendTraceTag(537151646,0,10,`SocialSharingCommandHandler.GetSelectedFloatingObjectXluid: Invalid floating object id =  ${sc.id}`)}return null}tUh(sc,ad,gb){let Hb=sc+"_";Hb=btoa(15===sc?Hb+gb:Hb+(ad+"_"+gb));Hb=Hb.replace(RegExp("\\+",
"g"),"-");Hb=Hb.replace(RegExp("\\/","g"),"_");return Hb=Hb.replace(RegExp("\\=+$","g"),"")}J$f(sc,ad,gb=!1){return Ba.TaskExtensions.za(this.PJ.value,Hb=>{Pd.a(Hb.result,G.a.sharing,ad,this.$.ea.wg.get(5))?(l.ULS.sendTraceTag(537151644,0,50,`SocialSharingCommandHandler.ShowShareDialog: Send UI_Sharing post message with mode: ${ad?ad[S.a.PMb]:""}`),gb&&qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)&&qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DeepLinkCreationSurveyFPS",
!1)&&!this.Kia&&(this.f3a=window.setInterval(()=>{this.oVj()},6E4),this.Kia=!0)):Ja.HelperMethods.gf(sc.FileSharingUrl,"_blank",void 0,"SocialSharingCommandHandler.FileSharingUrl")},this.la,3)}Qyc(sc,ad){if(15===sc&&!qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)||15!==sc&&!qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.isMobileMode)return null;const gb=this.w3h(sc);if(gb)return l.ULS.sendTraceTag(520737606,0,50,`SocialSharingCommandHandler.ShareExcelSection: Calling share dialog with nav id=${gb[S.a.QSd]}`),
this.J$f(ad,gb,!0);l.ULS.sendTraceTag(537151643,0,10,`SocialSharingCommandHandler.ShareExcelSection: Unable to get the sharing details for navType: ${we[sc]}`);return null}oVj(){this.Kia&&window.clearInterval(this.f3a);qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DeepLinkCreationSurveyFPS",!1)&&(this.$.Yc(638984051,0,0,null),l.ULS.sendTraceTag(512328542,0,50,"SocialSharingCommandHandler.triggerDeepLinkCreationSurvey: FPS survey got triggered."))}}pa.fLi=[103];pa.oEh=[107,104,105,106];
pa.pEh=[104,105];pa.X2g=[new Sd.a(lc.a.CDe,554412057,0,0,1324),new Sd.a(lc.a.idle,554412057,0,1)];Object(e.a)(pa,"SocialSharingCommandHandler",dd.a,[222]);class zb extends wa.a{constructor(sc){super(sc)}hd(){const sc=new h.a(()=>na.GetServiceTaskFactory.create(this.$.da,137,this.la,this.Xa));Ba.TaskExtensions.za(na.GetServiceTaskFactory.create(this.$.da,102,this.la,this.Xa),ad=>{this.$c([new pa(this.$,ad.result,sc)])},this.la,3)}static ka(sc){wa.a.Md(114,new zb(sc))}}Object(e.a)(zb,"SocialSharingCommandHandlerFactory",
wa.a,[]);var Vb=a(1176);class xc{constructor(sc){this.hh=sc}executeCommand(sc,ad,gb){return 2!==this.hh.Vd(M.a.tryOfficeThroughTellMe,2,gb)?ia.Task.Sa(!0):Ra.a(ad.command)}wc(sc,ad){return 215809929===ad.command}Nc(){return!1}Hc(){return!1}}Object(e.a)(xc,"TryOfficeThroughTellMeCommandHandler",null,[222]);class Sc extends wa.a{constructor(sc){super(sc)}hd(){this.$c([new xc(u.AFrameworkApplication.rb)])}static ka(sc){wa.a.Md(207,new Sc(sc))}}Object(e.a)(Sc,"TryOfficeThroughTellMeCommandHandlerFactory",
wa.a,[]);var Jd=a(160),ye=a(266),pe=a(150),re=a(190);class He{static MU(){return pe.a.zq(He.Ll,re.a.Ta(444))}}He.Ll="<div class='namedsheetview_teaching_dialog_control' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_description_label' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_textarea' id='TextArea'> <label id='TeachingDescriptionId' class='WACDialogLabel' >{0}</label> </div> </div> </div>";Object(e.a)(He,"NamedSheetViewTeachingDialogHtml",null,
[]);var ze=a(68),ef=a(158),$a=a(52);class Nb extends ye.a{constructor(sc){super(sc);this.stopwatch=this.jt=null;this.pKi=ad=>{if(1===ad)this.$.Ia.Hb(new ic.a(-2050946363,ze.a.zb,2,8,null)).continueWith(gb=>{this.jt.setResult(!ef.a(gb)&&gb.result)}),ad="Yes";else{const gb=2===ad;this.jt.setResult(gb);ad=2===ad?"No":"Close";gb&&this.S8i()}this.qDi(ad);this.hide()}}get kc(){return"ShowNamedSheetViewTeachingDialog"}ig(){this.Ob=4;this.stopwatch=this.$.Jb.Gc("UserAction",this.kc);const sc=Kc.a.instance.ga(1912);
this.og=He.MU();this.jt=new Jd.a;this.initializeAndShow(sc,this.pKi,{});return this.jt.task}ry(sc){super.ry(sc);this.tc(1,Kc.a.instance.ga(1914));this.tc(2,Kc.a.instance.Ta(457))}S8i(){this.$.ea.hAd=!1}qDi(sc){const ad={};ad.a=this.$.ya.UserSessionId;ad.b="NamedSheetViewTeachingDialogClose";ad.c=sc;ad.e=!0;this.stopwatch&&(this.stopwatch.stop(),ad.d=this.stopwatch.Bc);$a.b().Se(53,ad,!0)}}Object(e.a)(Nb,"NamedSheetViewTeachingDialog",ye.a,[]);var qc=a(162);class Lc{constructor(sc){this.$=sc;sc.da.Ha(309,
this)}DSa(){return this.SGj()?(new Nb(this.$)).ig():ia.Task.Sa(!0)}SGj(){const sc=this.$.va.na;return this.$.ea.b$a&&this.$.ea.hAd&&!sc.Zd.kz&&this.$.ea.tM&&!qc.g(this.$)}}Object(e.a)(Lc,"NamedSheetViewPublic",null,[529]);class sd extends ub.a{constructor(sc){super();this.$=sc;this.Db()}create(){this.nb(this.$.da.Aa(309)||new Lc(this.$))}static ka(sc){sc.da.Ha(310,new sd(sc))}}Object(e.a)(sd,"NamedSheetViewPublicFactory",ub.a,[]);var Fd=a(7),Td=a(1360),ue=a(878),Ae=a(463);class Le{constructor(sc,
ad,gb,Hb,ac,Ec,pd){this.title=sc;this.body=ad;this.b9i=gb;this.primaryButtonAction=Hb;this.secondaryButtonAction=Ec;this.l2f=ac;this.targetObject=pd}}Object(e.a)(Le,"NamedSheetViewTeachingCalloutContent",null,[]);class df{constructor(sc){this.ple=0;this.$dg=sc}get Ydg(){return this.ple}get E$i(){return this.Ydg<this.$dg.count?this.$dg.ma(this.ple++):null}}Object(e.a)(df,"NamedSheetViewTeachingCalloutList",null,[]);var Oe=a(1095);class cf{constructor(sc){this.stopwatch=this.Q0b=this.XBc=this.dYd=null;
this.Zdg=0;this.$=sc}vgi(sc){this.Zdg=sc;const ad=Object(Fd.a)(new t.a,{});cf.bpi(sc)?(ad.add(new Le(Kc.a.instance.Ta(446),Kc.a.instance.Ta(447),Kc.a.instance.ga(1942),()=>{this.C5(2,"Continue");this.faa(!0)},Kc.a.instance.ga(1943),()=>{this.faa();this.C5(1,"ExitGuide")},Oe.a())),1===sc&&ad.add(new Le(Kc.a.instance.ga(1944),Kc.a.instance.Ta(449),Kc.a.instance.ga(1942),()=>{this.C5(2,"FirstEnterTempViewContinueSecond");this.faa(!0)},Kc.a.instance.ga(1943),()=>{this.faa();this.C5(1,"FirstEnterTempViewExitGuideSecond")},
Oe.a())),ad.add(new Le(Kc.a.instance.Ta(450),Kc.a.instance.Ta(451),Kc.a.instance.ga(1942),()=>{this.C5(2,"FirstEnterExitCalloutContinue");this.faa(!0)},Kc.a.instance.ga(1943),()=>{this.faa();this.C5(1,"FirstEnterExitCalloutGuide")},cf.wZh())),ad.add(new Le(Kc.a.instance.ga(1945),Kc.a.instance.Ta(448),Kc.a.instance.ga(1946),()=>{this.FJj();this.faa();this.C5(1,"LearnMore")},Kc.a.instance.ga(1947),()=>{this.faa();this.C5(1,"Done")},cf.vZh()))):2===sc&&ad.add(new Le(Kc.a.instance.ga(1944),Kc.a.instance.Ta(449),
Kc.a.instance.ga(1941),()=>{this.faa();this.C5(1,"EnterTempViewAfterPersistedView")},null,null,Oe.a()));this.dYd=new df(ad)}FJj(){const sc=new ic.a(-859308420,ze.a.zb,this.$.xc,9,null);this.$.Ia.Hb(sc,{[ze.a.Pf]:"HelpID=SheetViews",["InputMethod"]:ze.a.zb,[ze.a.Kc]:Ic.a.WU,["ShouldCanvasTakeFocus"]:!0})}show(sc){this.vgi(sc);this.zeb()}pAj(sc){this.Q0b=sc}zeb(){var sc=this.dYd.E$i;if(sc){var ad=Object(Fd.a)(new Td.a,{label:sc.b9i,onExecute:sc.primaryButtonAction}),gb=null;sc.l2f&&(gb=Object(Fd.a)(new Td.a,
{label:sc.l2f,onExecute:sc.secondaryButtonAction}));sc=Object(Fd.a)(new ue.a,{target:sc.targetObject,content:sc.body,title:sc.title,showCloseIcon:!0,primaryButtonProps:ad,secondaryButtonProps:gb,useTeachingStyles:!0});sc=this.Q0b.callout(sc);ad=Object(Fd.a)(new Ae.a,{onShow:()=>{this.C5(0)}});this.XBc=this.Q0b.addNotification(sc,ad)}}dismiss(){this.faa();this.C5(1,"DismissedByOthers")}faa(sc=!1){this.XBc&&(this.Q0b.removeNotification(this.XBc),this.XBc=null);sc&&this.zeb()}C5(sc,ad=null){const gb=
{};gb.a=this.$.ya.UserSessionId;gb.b=this.Zdg;gb.c=this.dYd.Ydg;gb.d=sc;gb.e=ad;0===sc?this.stopwatch=this.$.Jb.Gc("UserAction","ShowNamedSheetViewTeachingCallout"):(this.stopwatch&&(this.stopwatch.stop(),gb.f=this.stopwatch.Bc,this.stopwatch=null),2===sc&&(this.stopwatch=this.$.Jb.Gc("UserAction","ShowNamedSheetViewTeachingCalloutNext")));$a.b().Se(52,gb,!0)}static vZh(){return document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv")}static wZh(){return document.querySelector("[data-unique-id=Ribbon-NamedSheetViewExit]")}static bpi(sc){return 0===
sc||1===sc}}Object(e.a)(cf,"NamedSheetViewTeachingCallout",null,[460]);class vf extends ub.a{constructor(sc){super();this.$=sc;this.Db()}create(){let sc=this.$.da.Aa(322);sc||(sc=new cf(this.$),this.$.da.Ha(322,sc));this.nb(sc)}static ka(sc){sc.da.Ha(323,new vf(sc))}}Object(e.a)(vf,"NamedSheetViewTeachingCalloutFactory",ub.a,[]);var hf=a(1273),Mf=a(1167),xf=a(1272);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.BusinessBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.HyperLink");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.MsForm");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PresentMode");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Print");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Resize");Type.registerNamespace("_Ewa");Object(b.a)();Type.registerNamespace("CADWLTR");d.main();Type.registerNamespace("Common.App.NewAndOpen.UX");f.a.instance.ii(new Ma);Object(Ta.a)();Type.registerNamespace("Common");Type.registerNamespace("Common.App.OpenInClient");
Object(Da.a)();Object(fa.a)();Object(ua.a)();Object(Fa.a)();Type.registerNamespace("Common.App.SharedFilePicker");Ca.main();Type.registerNamespace("Common.App.WildFire");nb.main();Object(X.a)();R.a.Fa(Yb.ka);Object(mc.a)();Object(Zb.a)();Object(qb.a)();Ha.a.Bi(".MsformCalloutContent{color:#fff;font-size:13pt;line-height:1;padding-right:5px;margin-bottom:12px;margin-top:-6px;padding-left:10px;width:90%}.MsFormCalloutOuter{background-color:#107c41;z-index:1030}");(()=>{R.a.Fa(sc=>{Ka.ka(sc)})})();(()=>
{R.a.Fa(sc=>{sc.da.Ha(165,new Kb(sc))})})();R.a.Fa(za.ka);Object(Sa.a)();Object(Wa.a)();Object(ab.a)();Object(ma.a)();Object(ha.a)();Object(eb.a)();Object(ta.a)();Object(ya.a)();Object(sb.a)();Object(Qb.a)();Object(xf.a)();(()=>{R.a.Fa(sc=>{qa.EwaSettings.isChangeGateEnabled("OfficeVSO:7505051_MoveBatchHandlerToNewServices")||Qd.ka(sc)})})();R.a.Fa(zb.ka);Object(Vb.a)();R.a.Fa(Sc.ka);(()=>{R.a.Fa(sc=>{sd.ka(sc);vf.ka(sc)})})();Object(hf.a)();Object(Mf.a)()},722:function(r,F,a){a.d(F,"a",function(){return U});
r=a(0);var c=a(7),b=a(15),e=a(89),f=a(227),d=a(14),h=a(110),l=a(176),k=a(4),t=a(86);F=a(239);var n=a(1077),z=a(19),w=a(5),m=a(325),u=a(51),y=a(12),v=a(74),C=a(13),x=a(21),B=a(90),H=a(918),I=a(1);class U extends F.a{constructor(S,G){super(document.createElement("div"));this.rqf=this.fte=this.kne=this.k4b=this.Zba=this.Y7=this.KO=this.Ry=null;this.Xva=this.VU=this.Yr=this.hideCloseButton=!1;this.SPi=D=>{this.iD(D)};this.YPi=D=>{13===D.keyCode&&this.iD(D)};this.$Bd=D=>{this.Sm(D.vb);return!0};this.eCd=
D=>{this.BV(D.vb);return!0};this.Ipc=D=>{this.lma(D.vb?D.vb:0);return!0};this.TPi=D=>{this.iD(D.Ea);return!0};this.Cqg=(D=null)=>{this.Sm(D.inputMethod?D.inputMethod:0);return!0};this.Dqg=(D=null)=>{this.BV(D.inputMethod?D.inputMethod:0);return!0};this.d1=S;this.mu=G;this.e_c=G.G_a.toString();this.title=G.title;this.message=G.message;this.set_visibilityMode(1)}get j_g(){return this.mu.G_a}get businessBar(){return this.d1}get actionButton(){return this.mu?this.mu.actionButton:""}get esa(){return this.mu?
this.mu.esa:""}get linkText(){return this.mu?this.mu.link:""}get ek(){return this.mu?this.mu.ek:""}get alt(){return this.mu?this.mu.alt:""}Ena(S){this.mu.businessBarType=S}dispose(){e.a.pc([this.k4b,this.KO,this.Y7]);this.Yr&&this.KO&&(f.a.instance.Ba(d.a.click,this.KO.domElement,this.$Bd),h.KeyInputManager.instance.Xw(this.domElement,this.kne));this.VU&&this.Y7&&(f.a.instance.Ba(d.a.click,this.Y7.domElement,this.eCd),h.KeyInputManager.instance.Xw(this.domElement,this.fte));this.Xva&&this.Zba&&(f.a.instance.Ba(d.a.click,
this.Zba,this.Ipc),h.KeyInputManager.instance.Xw(this.domElement,this.rqf));this.Zba=this.Ry=this.d1=this.Y7=this.KO=null;super.dispose()}update(){}$Zj(){this.FIe(!0)}x5c(){this.FIe(!1)}fgh(){const S=this.businessBar.$.Jb.zg("DOMUpdate","ReactBusinessBar");S.start();this.message=B.a.kf(this.message);this.title=B.a.kf(this.title);l.UISurfaces.Dhd().then(G=>{G.initializeMessageBarInStore();let D=Object(c.a)(new H.a,{messageTitle:this.title,message:this.message,isMultiline:!1,messageBarType:this.mu.businessBarType,
dismissButtonAriaLabel:C.a.instance.ga(10)});this.hideCloseButton||(D.onDismiss=this.TPi);this.Xva&&(D.linkProps={["type"]:"AppLinkProps",["text"]:this.linkText,["onExecute"]:this.Ipc});this.Yr&&(D.firstActionButtonProps={["type"]:"AppButtonProps",["label"]:this.actionButton,["onExecute"]:this.Cqg});this.VU&&(D.secondActionButtonProps={["type"]:"AppButtonProps",["label"]:this.esa,["onExecute"]:this.Dqg});I.EwaSettings.isChangeGateEnabled("OfficeVSO:7445369_IconFunctionalityReactBizBars")&&this.mu.iconName&&
(D.messageBarIconProps={["iconName"]:this.mu.iconName});I.EwaSettings.isChangeGateEnabled("OfficeVSO:7476511_BizBarCallbackTelemetry")?G.createNewMessageBarWithCallback(this.domElement,D,()=>{S.stop();b.ULS.sendTraceTag(509657951,0,50,`React Business Bar created for ${this.mu.hJa} in: ${S.Bc} milliSeconds.`)}):G.createNewMessageBar(this.domElement,D);return null},()=>{b.ULS.sendTraceTag(524075914,0,10,`React BusinessBar for ${this.mu.hJa} could not be initialized`);return null});k.AFrameworkApplication.fa.pa("Fluent2StyleIsEnabled")&&
(this.domElement.classList.add("VNextBusinessBarEntry"),this.domElement.classList.add("WACBusinessBarEntry"));this.domElement.classList.add("ReactBusinessBarEntry");this.domElement.tabIndex=0;this.businessBar.domElement.appendChild(this.domElement)}qfh(S){S||(this.domElement.tabIndex=0,this.businessBar.domElement.appendChild(this.domElement));var G=this.businessBar.$.Bb;S=G+"ewaBusinessBarEntryBody"+this.e_c;const D=G+"ewaBusinessBarEntryTitle"+this.e_c;var E=G+"ewaBusinessBarEntryIcon"+this.e_c;
this.domElement.className=n.a.puh;if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:7409767_BizBarUpdateReduceInnerHtml")){y.DOMElementExtensions.KG(this.domElement);G=document.createElement("div");G.className=n.a.dRe;G.id=S;var N=document.createElement("div");N.className=n.a.cRe;var M=document.createElement("a");M.className=n.a.jRe;M.title=this.alt;const L=document.createElement("span");L.classList.add(z.a.yrb);L.classList.add(n.a.fRe);L.id=E;this.ek.length&&(E=document.createElement("img"),E.classList.add(this.ek),
E.src=u.a.qe(0),L.appendChild(E));M.appendChild(L);N.appendChild(M);E=document.createElement("span");E.classList.add(n.a.iRe);E.id=D;E.innerText=B.a.kf(this.title);N.appendChild(E);E=document.createElement("span");E.classList.add(n.a.hRe);E.id="message";E.innerText=B.a.kf(this.message);N.appendChild(E);E=document.createElement("a");E.id="link";E.href="#";E.className=n.a.gRe;E.innerText=B.a.kf(this.linkText);N.appendChild(E);E=document.createElement("span");E.classList.add(n.a.I9b);M=document.createElement("button");
M.type="button";M.id="action";M.className=n.a.H9b;M.innerText=B.a.kf(this.actionButton);E.appendChild(M);N.appendChild(E);E=document.createElement("span");E.classList.add(n.a.I9b);M=document.createElement("button");M.type="button";M.id="altAction";M.className=n.a.H9b;M.innerText=B.a.kf(this.esa);E.appendChild(M);N.appendChild(E);G.appendChild(N);N=document.createElement("a");N.className=n.a.eRe;N.tabIndex=0;N.setAttribute("role","button");E=document.createElement("span");E.id="close";E.classList.add(z.a.Or);
M=document.createElement("img");M.classList.add(z.a.Uub);M.src=u.a.qe(13);M.alt=C.a.instance.ga(792);M.title=C.a.instance.ga(792);M.setAttribute("role","button");E.appendChild(M);N.appendChild(E);G.appendChild(N);this.domElement.appendChild(G)}else G="<div class='"+n.a.dRe+"' id='{0}'><div class='"+n.a.cRe+"'><a class='"+n.a.jRe+"' title='{1}'><span class='"+z.a.yrb+" "+n.a.fRe+"' id='{2}'>",this.ek.length&&(G+="<img class='{3}' src='{4}'/>"),G+="</span></a><span class='"+n.a.iRe+"' id='{5}'>{6}</span><span class='"+
n.a.hRe+"' id='message'>{7}</span><a id='link' href='#' class='"+n.a.gRe+"'>{8}</a><span class='"+n.a.I9b+"'><button type='button' id='action' class='"+n.a.H9b+"'>{9}</button></span><span class='"+n.a.I9b+"'><button type='button' id='altAction' class='"+n.a.H9b+"'>{10}</button></span></div><a class='"+n.a.eRe+"' tabindex='0' role='button'><span id='close' class='"+z.a.Or+"'><img class='"+z.a.Uub+"' src='{11}' alt='{12}' title='{12}' role='button'/></span></a></div>",this.domElement.innerHTML=String.format(G,
S,this.alt,E,this.ek,u.a.qe(0),D,this.title,this.message,this.linkText,this.actionButton,this.esa,u.a.qe(13),C.a.instance.ga(792));y.DOMElementExtensions.It(this.domElement,w.a.nsa,D,S);this.Zba=$get("link",this.domElement);y.DOMElementExtensions.setVisible(this.Zba,this.Xva);this.Xva&&(f.a.instance.ta(d.a.click,this.Zba,this.Ipc),this.rqf=h.KeyInputManager.instance.Dt(this.Zba,this.Ipc,t.a.Lh,t.a.$W));this.KO=new m.a(y.DOMElementExtensions.getElementById(this.domElement,"action"));this.KO.isVisible=
this.Yr;this.Y7=new m.a(y.DOMElementExtensions.getElementById(this.domElement,"altAction"));this.Y7.isVisible=this.VU;this.Yr&&(f.a.instance.ta(d.a.click,this.KO.domElement,this.$Bd),this.kne=h.KeyInputManager.instance.Dt(this.KO.domElement,this.$Bd,t.a.Lh,t.a.$W),this.VU&&(f.a.instance.ta(d.a.click,this.Y7.domElement,this.eCd),this.fte=h.KeyInputManager.instance.Dt(this.KO.domElement,this.eCd,t.a.Lh,t.a.$W)));this.Ry=$get("close",this.domElement);this.k4b=this.Ae.ie(this.Ry);this.k4b.ka("click",
this.SPi);this.k4b.ka("keydown",this.YPi);y.DOMElementExtensions.setVisible(this.Ry,!this.hideCloseButton)}FIe(S){I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)&&k.AFrameworkApplication.fa.pa("Fluent2StyleIsEnabled")?this.fgh():this.qfh(S)}Sm(){b.ULS.sendTraceTag(21517968,0,50,`BusinessBar [${this.mu.hash}]: BusinessBarEntry.OnActionClick() for EntryName ${this.mu.hJa}`);x.h(this.businessBar.$).Fo(!0)}BV(){b.ULS.sendTraceTag(537170257,0,50,`BusinessBar [${this.mu.hash}]: BusinessBarEntry.OnAltActionClick() for EntryName ${this.mu.hJa}`);
x.h(this.businessBar.$).Fo(!0)}lma(){b.ULS.sendTraceTag(537170256,0,50,`BusinessBar [${this.mu.hash}]: BusinessBarEntry.OnLinkClick() for EntryName ${this.mu.hJa}`);x.h(this.businessBar.$).Fo(!0)}iD(S){b.ULS.sendTraceTag(21517971,0,50,`BusinessBar [${this.mu.hash}]: BusinessBarEntry.OnCloseClick() for EntryName ${this.mu.hJa}`);this.set_visible(!1);this.businessBar.removeEntry(this.j_g);v.g(S)}KJ(){return I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)&&k.AFrameworkApplication.fa.pa("Fluent2StyleIsEnabled")?
this.domElement.getElementsByTagName("button")[0]:this.KO.domElement}}Object(r.a)(U,"BusinessBarEntry",F.a,[])},793:function(r,F,a){a.r(F);var c=a(161);r=a(0);var b=a(7),e=a(15),f=a(4);a(27);var d=a(389),h=a(38),l=a(50),k=a(12),t=a(131),n=a(1),z=a(13),w=a(21);class m extends Sys.EventArgs{constructor(L){super();this.g9i=L}}Object(r.a)(m,"PrintPreviewPaneOperationStatusEventArgs",Sys.EventArgs,[]);var u=a(263),y=a(250);class v{constructor(L){this.jg=L}Yh(){u.a(this.jg.$).mw(this.Xd)||u.a(this.jg.$).Yh(this)}L7(){u.a(this.jg.$).mw(this.Xd)&&
u.a(this.jg.$).Ez(this)}get Xd(){return y.a.VOf}get jc(){const {PrintPreviewPane:L}=a(793);return document.getElementById(L.e9i)}get Ff(){return!0}sh(L){return k.DOMElementExtensions.Af(this.jc,L)}rj(){this.jg.$.frame.Le.kk(this.jg.$.frame.Le.HE)}dk(){}ag(L,aa){return aa?!1:(this.jg.enterPrintPreviewHeaderFocusTrapZone(),!0)}}Object(r.a)(v,"PrintPreviewHeaderKeyboardAccessibleSection",null,[54]);class C{constructor(L){this.jg=L}Yh(){u.a(this.jg.$).mw(this.Xd)||u.a(this.jg.$).Yh(this)}L7(){u.a(this.jg.$).mw(this.Xd)&&
u.a(this.jg.$).Ez(this)}get Xd(){return y.a.WOf}get jc(){const {PrintPreviewPane:L}=a(793);return this.jg.useMSPdfViewer?document.getElementById(a(793).PrintPreviewPane.WFd):document.getElementById(L.nMf)}get Ff(){return!0}sh(L){return k.DOMElementExtensions.Af(this.jc,L)}rj(){this.jg.$.frame.Le.kk(this.jg.$.frame.Le.HE)}dk(){}ag(L,aa){return aa?!1:(this.jg.useMSPdfViewer?(L=document.getElementById(a(793).PrintPreviewPane.WFd))&&k.DOMElementExtensions.setFocus(L,!0):k.DOMElementExtensions.setFocus(this.jg.CK),
!0)}}Object(r.a)(C,"PrintPreviewKeyboardAccessibleSection",null,[54]);class x{constructor(L){this.jg=L}Yh(){u.a(this.jg.$).mw(this.Xd)||u.a(this.jg.$).Yh(this)}L7(){u.a(this.jg.$).mw(this.Xd)&&u.a(this.jg.$).Ez(this)}get Xd(){return y.a.YOf}get jc(){const {PrintPreviewPane:L}=a(793);return document.getElementById(L.bId)}get Ff(){return!0}sh(L){return k.DOMElementExtensions.Af(this.jc,L)}rj(){this.jg.$.frame.Le.kk(this.jg.$.frame.Le.HE)}dk(){}ag(L,aa){return aa?!1:(this.jg.enterPrintSettingsTaskPaneFocusTrapZone(),
!0)}}Object(r.a)(x,"PrintSettingsTaskPaneKeyboardAccessibleSection",null,[54]);class B{constructor(){this.msPdfKitWasmUrl=this.msPdfKitJSUrl=this.pdfViewerWorkerUrl=null}}Object(r.a)(B,"MSPdfViewerFileUrl",null,[]);class H{constructor(){this.logger=this.printSettingsTaskPaneCallbacks=this.selectedPrintSettingsValues=this.colorOptions=this.marginDetailedOptions=this.marginOptions=this.scalingOptions=this.paperSizeOptions=this.orientationOptions=this.whatToPrintOptions=null;this.isViewMode=this.shouldDisableCurrentSelection=
!1;this.dataCultureTag=this.isMetricMeasurementUnit=this.isUniversalPrintFlowEnabled=null}}Object(r.a)(H,"PrintSettingsTaskPaneProps",null,[]);class I{constructor(){this.msPdfViewerFileUrl=null;this.useMSPdfViewer=!1;this.onPdfLoad=null}}Object(r.a)(I,"ViewerPaneProps",null,[]);var U=a(1098),S=a(384),G=a(5);class D{}D.printDialogTitle="PrintDialogTitle";D.K9b="ewa-dlg-elements-container-rtl";D.Jw="PrintPreviewerContainer";Object(r.a)(D,"CssClassNames",null,[]);var E=a(187),N=a(105);a.d(F,"PrintPreviewPane",
function(){return M});class M extends h.a{constructor(L,aa,V,P){super();this.GDb=this.Klc=this.CK=this.AIb=this.Jw=this.RV=this.vD=this.vF=null;this.FDb=!1;this.Owa=!0;this.cId=this.ZHd=this.$Hd=this.ewaAccessibilityManager=this.Frc=null;this.dqd=!1;this.yEf=()=>{e.ULS.sendTraceTag(537154206,0,50,`PrintPreviewPane:OnIframeContentChange API invoked with loadPdfCalled: ${this.FDb}`);this.FDb&&(this.Zci(),this.CK.style.visibility="visible",this.Klc?this.Klc.stop():e.ULS.sendTraceTag(537154205,0,10,"PrintPreviewPane:OnIframeContentChange - loadPdfStopwatchForIframe is null."),
this.raiseEvent(M.tFb,new m(1)),this.ARd(),this.FDb=!1)};this.$=L;this.uD=aa;this.Tfh();this.useMSPdfViewer=V;this.isUniversalPrintEnabled=P;this.gF=n.EwaSettings.isChangeGateEnabled("OfficeVSO:7497739_UniversalPrintCG");this.EAb=n.EwaSettings.isChangeGateEnabled("OfficeVSO:7451487_DisabledPrintBtnOnError");this.isExportPdfMode=!1}RNg(L){this.addHandler(M.tFb,L)}Pkj(L){this.removeHandler(M.tFb,L)}dKj(L){this.isExportPdfMode=L;this.Ofh()}eKj(){var L=this.$.Jb.Gc("UserAction","createSettingsPaneStopwatch");
const aa=document.getElementById(M.bId);this.Ufh();const V=this.Vfh();this.vD.createPrintSettingsTaskPane(aa,V);L.stop();this.FDb=!1;if(this.isUniversalPrintEnabled&&this.Jw){L="A4";switch(V.selectedPrintSettingsValues.selectedPaperSize){case 8:L="A3";break;case 9:L="A4";break;case 11:L="A5";break;case 12:L="JIS B4";break;case 13:L="JIS B5";break;case 5:L="North America Legal";break;case 1:L="North America Letter";break;case 6:L="North America Invoice";break;case 7:L="North America Executive";break;
case 3:L="North America Ledger"}this.vF.setDocumentSettings({mediaSize:L,orientation:2===V.selectedPrintSettingsValues.selectedOrientation?"landscape":"portrait",colorMode:1===V.selectedPrintSettingsValues.selectedColor?"color":"blackAndWhite"})}this.NKd()}setPageRangeSettings(L,aa,V,P,ba){this.vD&&(this.vD.setPageRangeSettings(L,aa,V,P,ba),this.U5f(String.format(z.a.instance.ob(205),P,ba,L)))}Pci(){this.Jw&&(this.Jw.style.display="none")}poh(){this.dispose();this.G_d();this.p_d();this.vF&&this.vF.closePrintPreviewPane();
this.RV=this.vD=this.vF=this.Jw=null}TAi(L){e.ULS.sendTraceTag(575534018,0,50,"PrintPreviewPane: LoadPdf invoked.");this.hidePreviewError();this.useMSPdfViewer?((this.GDb=this.$.Jb.Gc("UserAction","pdfLoadTimeStopwatchForMsPdfViewer"))||e.ULS.sendTraceTag(537154210,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForMsPdfViewer is null."),this.RV.renderPdf(L)):this.CK&&((this.Klc=this.$.Jb.Gc("UserAction","loadPdfStopwatch"))||e.ULS.sendTraceTag(537154209,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForIframe is null."),
this.FDb=!0,this.CK.src&&this.CK.src===L?this.yEf(null):this.CK.src=L);if(this.gF&&this.Jw){const aa=S.b(this.$.workbookContext);this.vF.setFileUrl(L,aa)}}onPdfLoad(){this.GDb?(e.ULS.sendTraceTag(537154208,0,50,`PrintPreviewPane:onPdfLoad - Rendering time : ${this.GDb.Bc} ms, isFirstTimeLoad: ${this.Owa}`),this.GDb.stop()):e.ULS.sendTraceTag(537154207,0,10,"PrintPreviewPane:onPdfLoad - loadPdfStopwatchForMsPdfViewer is null.");this.raiseEvent(M.tFb,new m(1));this.hideWaitCursor();this.EAb&&this.enablePrintButton();
this.ARd()}printPdf(){k.DOMElementExtensions.setFocus(this.CK);this.CK.contentWindow.print()}TKj(){this.showSpinner();this.showWaitCursor();this.EAb&&this.disablePrintButton();this.U5f("")}Zci(){this.hideSpinner();this.hideWaitCursor();this.EAb&&this.enablePrintButton()}Nz(L,aa,V=null){this.Jw&&this.RV&&(this.dqd=!1,this.RV.showErrorDetails(aa,L,V),this.uD.M6a=!0,this.CK&&(this.CK.src=""),this.hideWaitCursor(),this.disablePrintButton(),M.jsi(aa)&&(this.dqd=!0,this.NXi()))}hidePreviewError(){this.uD.M6a=
!1;this.RV.hidePreviewError();this.enablePrintButton()}goh(){(this.AIb=document.getElementById(M.XOf))&&this.AIb.parentNode&&this.AIb.parentNode.removeChild(this.AIb)}hideErrorMessageForPrintOptions(){this.vD&&this.vD.hideErrorMessageForPrintOptions()}showErrorMessageForPrintOptions(L){this.vD&&this.vD.showErrorMessageForPrintOptions(L)}showSpinner(){this.uD.M6a||this.dqd?this.hidePreviewError():this.CK&&(this.CK.style.visibility="hidden");this.RV&&this.RV.showSpinner()}hideSpinner(){this.RV&&this.RV.hideSpinner()}enablePrintButton(){this.vD&&
this.vD.enablePrintButton();this.gF&&this.Jw&&this.vF.updatePrintButtonEnableDisableState(!0)}disablePrintButton(){this.vD&&this.vD.disablePrintButton();this.gF&&this.Jw&&this.vF.updatePrintButtonEnableDisableState(!1)}showWaitCursor(){this.vD&&this.vD.showWaitCursor();!this.EAb&&this.gF&&this.Jw&&this.vF.updatePrintButtonEnableDisableState(!1)}hideWaitCursor(){this.vD&&this.vD.hideWaitCursor();!this.EAb&&this.gF&&this.Jw&&this.vF.updatePrintButtonEnableDisableState(!0)}Rfh(){if(this.Jw)e.ULS.sendTraceTag(591927430,
0,10,"PrintPreviewerPane:CreatePrintPreviewerContainer - printPreviewerContainer should be null");else if(this.Jw=document.createElement("div"),this.Jw.id=M.XOf,this.Jw.classList.add(M.h9i),this.$.ar.insertBefore(this.Jw,this.$.ar.firstChild),f.AFrameworkApplication.sa&&f.AFrameworkApplication.sa.Qa.df){const L=document.getElementById(G.a.isa);L&&(this.Jw.style.top=`${L.clientHeight}px`,this.Jw.style.height=`calc(100vh - ${L.clientHeight}px)`)}}enterPrintPreviewHeaderFocusTrapZone(){this.vF.enterPrintPreviewHeaderFocusTrapZone()}enterPrintSettingsTaskPaneFocusTrapZone(){this.vF.enterPrintSettingsTaskPaneFocusTrapZone()}V6i(){this.$.da.gb(15,
L=>{this.ewaAccessibilityManager=L;this.ewaAccessibilityManager.mode=3})}Tfh(){this.cId=new x(this);this.$Hd=new C(this);this.ZHd=new v(this)}NKd(){this.cId.Yh();this.$Hd.Yh();this.ZHd.Yh();this.V6i()}G_d(){this.cId.L7();this.$Hd.L7();this.ZHd.L7();w.h(this.$).q0();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0)}$H(){this.Frc=t.a.instance.ie(this.CK);this.Frc.ka("load",this.yEf)}p_d(){this.Frc&&this.CK&&this.Frc.detach("load")}ARd(){this.gF?this.Z4f(M.f9i,M.jLi):this.Z4f(M.bId,
M.ROf)}Z4f(L,aa){this.Owa&&(L=document.getElementById(L))&&(aa=k.DOMElementExtensions.getElementById(L,aa))&&(this.Owa=!1,aa.focus())}NXi(){this.uD.M6a=!1;this.enablePrintButton();this.ARd()}Ofh(){if(n.EwaSettings.isChangeGateEnabled("OfficeVSO:7457857_DynamicScriptLoaderNewService"))void E.a.resolve(N.d,{Tl:0}).then(aa=>Object(c.a)(this,void 0,void 0,function*(){yield aa("excel-print-preview-sprite");yield aa("printPreviewer");yield aa("excelPrintPreviewer");this.MIe()}));else{var L=l.GetServiceTaskFactory.Oa(this.$.da,
283,284,0).result.Hl;L.loadScript("excel-print-preview-sprite").then(()=>{L.loadScript("printPreviewer").then(()=>{L.loadScript("excelPrintPreviewer").then(()=>{this.MIe()})},()=>{e.ULS.sendTraceTag(525358669,0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load printPreviewer script required for excelPrintPreviewer.")})},()=>{e.ULS.sendTraceTag(525358668,0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load excelPrintPreviewSprite script required for excelPrintPreviewer.")})}}MIe(){const L=
this.$.Jb.Gc("UserAction","createEmptyPreviewerStopwatch");this.Rfh();this.Sfh();this.gF?this.vF.createEmptyPrintPreviewPaneAsync(this.Jw,this.LIe()).then(()=>{L.stop();this.AFe();this.vF.updatePrintButtonEnableDisableState(!1)}):(this.vF.createEmptyPrintPreviewPane(this.Jw,this.LIe()),L.stop(),this.AFe())}AFe(){const L=this.$.Jb.Gc("UserAction","createPdfPreviewPaneStopwatch"),aa=document.getElementById(M.WFd);this.useMSPdfViewer&&(aa.tabIndex=0);this.Afh();this.zfh(aa);L.stop();this.raiseEvent(M.tFb,
new m(0))}Sfh(){this.vF||(this.vF=printPreviewer.PrintPreviewPaneControllerFactoryGlobal.createPrintPreviewPaneController());this.vF||e.ULS.sendTraceTag(537154203,0,10,"PrintPreviewerPane:CreatePrintPreviewerController - printPreviewerController should not be null")}Ufh(){this.vD||(this.vD=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintSettingsTaskPaneController());this.vD||e.ULS.sendTraceTag(537154202,0,10,"PrintPreviewerPane:CreatePrintSettingsPaneController - printSettingsPaneController should not be null")}Afh(){this.RV||
(this.RV=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintPreviewController());this.RV||e.ULS.sendTraceTag(537154201,0,10,"PrintPreviewerPane:CreatePdfPreviewPaneController - pdfPreviewerPaneController should not be null")}zfh(L){this.RV.createPrintPreviewPane(L,this.dih());this.useMSPdfViewer||(this.CK=k.DOMElementExtensions.getElementById(this.Jw,M.nMf),this.CK.title=z.a.instance.ga(1211),this.$H())}Vfh(){let L,aa="en-US";L=this.$.ya.IsMetricMeasurementUnit;this.$.ya.DataCultureTag?
aa=this.$.ya.DataCultureTag:e.ULS.sendTraceTag(536994563,0,50,"PrintPreviewerPane:createPrintSettingsProps - DataCultureTag in ewaControl.bootstrapContext is nullable");return Object(b.a)(new H,{whatToPrintOptions:this.uD.zv.whatToPrintOptions,orientationOptions:this.uD.zv.orientationOptions,paperSizeOptions:this.uD.zv.paperSizeOptions,scalingOptions:this.uD.zv.scalingOptions,marginDetailedOptions:this.uD.IYh(),selectedPrintSettingsValues:this.uD.J0h(),printSettingsTaskPaneCallbacks:this.uD.H0h(),
logger:new d.a,shouldDisableCurrentSelection:this.uD.e8f(),isViewMode:!this.$.isEditMode,isMetricMeasurementUnit:L,dataCultureTag:aa,isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled})}LIe(){return this.gF?this.uD.F0h():Object(b.a)(new U.a,{backActionButtonText:z.a.instance.ga(1209),printPreviewPaneCallbacks:this.uD.k6e(),logger:new d.a,disableTellMeControl:!0,isExportPdfMode:!1})}dih(){return this.useMSPdfViewer?Object(b.a)(new I,{useMSPdfViewer:!0,msPdfViewerFileUrl:this.Oeh(),onPdfLoad:()=>
{this.onPdfLoad()}}):Object(b.a)(new I,{useMSPdfViewer:!1})}Oeh(){return Object(b.a)(new B,{pdfViewerWorkerUrl:this.$.ya.PrintPreviewerPdfViewerWorkerUrl,msPdfKitJSUrl:this.$.ya.PrintPreviewerMSPdfKitJsUrl,msPdfKitWasmUrl:this.$.ya.PrintPreviewerMSPdfKitWasmUrl})}U5f(L){this.Jw&&this.vF.setAdditionalHeaderText(L)}static jsi(L){return 3===L||2===L}}M.XOf="PrintPreviewerContainer";M.bId="printSettingsTaskPaneId";M.WFd="previewId";M.nMf="printpreviewiframe";M.e9i="printPreviewHeaderId";M.ROf="printButton";
M.f9i="printPreviewPaneId";M.jLi="printButtonId";M.h9i=D.Jw;M.tFb="pppnosu";Object(r.a)(M,"PrintPreviewPane",h.a,[512])},853:function(r,F,a){a.d(F,"a",function(){return d});r=a(0);var c=a(15),b=a(4),e=a(40),f=a(27);class d{static s0e(h,l){switch(h){case 3:return d.$6h(l);case 2:return d.D_h(l);case 1:return d.IUh(l)}return""}static $6h(h){switch(h){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static D_h(h){switch(h){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString();
case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static IUh(h){switch(h){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static openInClient(h,l,k){if(f.a.Hg||f.a.ap)window.setTimeout(()=>{d.nTf(k,d.Qdc())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(d.Rte(k),h,0,!1)}static G5g(h,l,k,t){l&&
t&&t();d.openInClient(h,l,k)}static Qdc(){return f.a.Hg?1:f.a.ap?2:f.a.q8a?3:f.a.isMac?4:0}static W6h(h){switch(h){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}}static X6h(h){switch(h){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";case 1:return"WildFireExcelBizBarFlight";default:return""}}static get mBb(){return"zh-CN"===window.navigator.language}static nTf(h,l){1===l?(c.ULS.sendTraceTag(17151569,
306,50,"User Directed to App Store"),h=d.s0e(h,l),8<f.a.P5a?e.a.gf(h,void 0,void 0,"RedirectToAppStore"):e.a.FU(h)):document.hidden||(d.mBb?(h=b.AFrameworkApplication.fa.appSettings.WildFireUrlChinaStoreAndroid.toString())?(c.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),e.a.FU(h)):c.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(c.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(d.s0e(h,
l),null,null)))}static Rte(h){switch(h){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}}static get Gzc(){return(f.a.q8a||f.a.isMac)&&f.a.cp}static get jHj(){return f.a.Hg||f.a.ap}static jfd(h){switch(h){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static urd(h){return(h=d.FXh(h))&&""!==h?Boolean.parse(h):!1}static wSd(h){d.Nzj(h)}static FXh(h){try{return localStorage.getItem(h)}catch(l){return c.ULS.sendTraceTag(18416668,
306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+l.message),null}}static Nzj(h){try{localStorage.setItem(h,"true")}catch(l){c.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+l.message)}}}d.lCe="ChromeExtensionBarDismiss";Object(r.a)(d,"WildFireUtilities",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.kmhv.js.map/c7e4d5e67d1f30fbfebb12a1b1b31288/EwaDSEsNext.kmhv.js.map
(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[22],{386:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.unknown=1]="unknown";e[e.odb=2]="odb";e[e.sharePoint=3]="sharePoint";e[e.ngsc=4]="ngsc";e[e.word=5]="word";e[e.powerpoint=6]="powerpoint";e[e.excel=7]="excel";e[e.onenoteWeb=8]="onenoteWeb";e[e.wac=9]="wac";e[e.visio=10]="visio";e[e.officecom=11]="officecom";e[e.listPart=12]="listPart";e[e.outlookWeb=13]="outlookWeb";e[e.odIos=14]="odIos";e[e.odAndroid=15]="odAndroid";e[e.teams=16]="teams";e[e.sample=17]="sample";e[e.odc=18]="odc";e[e.wordAndroid=19]="wordAndroid";e[e.excelAndroid=20]="excelAndroid";e[e.powerpointAndroid=21]="powerpointAndroid";e[e.wordIos=22]="wordIos";e[e.excelIos=23]="excelIos";e[e.powerpointIos=24]="powerpointIos";e[e.onenote=25]="onenote";e[e.teamsIos=26]="teamsIos";e[e.teamsAndroid=27]="teamsAndroid";e[e.onenoteIos=28]="onenoteIos";e[e.visioIos=29]="visioIos";e[e.onenoteAndroid=30]="onenoteAndroid";e[e.visioAndroid=31]="visioAndroid";e[e.outlookWindows=32]="outlookWindows";e[e.outlookMac=33]="outlookMac";e[e.onenoteUWP=34]="onenoteUWP";e[e.officemobileIos=35]="officemobileIos";e[e.officemobileAndroid=36]="officemobileAndroid";e[e.odcWac=37]="odcWac";e[e.outlookGroupsWeb=38]="outlookGroupsWeb";e[e.fluid=39]="fluid";e[e.modernFileExplorer=40]="modernFileExplorer";e[e.listsHome=41]="listsHome";e[e.listsIos=42]="listsIos";e[e.edgeEnterpriseNtp=43]="edgeEnterpriseNtp";e[e.officeFeed=44]="officeFeed";e[e.searchUx=45]="searchUx";e[e.consumerList=46]="consumerList";e[e.shareDemo=47]="shareDemo";e[e.onePlayer=48]="onePlayer";e[e.windowsShare=49]="windowsShare";e[e.streamIos=50]="streamIos";e[e.streamAndroid=51]="streamAndroid";e[e.loopIos=52]="loopIos";e[e.outlookAndroid=53]="outlookAndroid";e[e.outlookiOS=54]="outlookiOS";e[e.whiteboard=55]="whiteboard";e[e.businesscentral=56]="businesscentral";e[e.mslens=57]="mslens";e[e.pbidesktop=58]="pbidesktop"})(r||(r={}))},451:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(447),i=n(144),s=n(17);function o(e){var t;try{t=decodeURI(e)}catch(n){t=e}if(t===e)e=Object(r.e)(e,!0);else{e=e.replace("#","%23");s.t.isActivated("589c6b39-fbce-42b5-bff1-125e13e2367a","05/19/2021","encode url with %number in the name")||i.e.isFeatureEnabled({ECS:83959})||!e.indexOf("%25")||(e=Object(r.e)(e,!0))}return e}},547:function(e,t,n){"use strict";n.d(t,"e",function(){return y});var r=n(108),i=(function(){function e(e){this._scope=new r.e;this._targetMap=new WeakMap;this._disposableMap=new WeakMap}e.prototype.on=function(e,t,n){var r;if(s(e))r=e;else{var i=this._targetMap.get(e);if(i)r=i;else{r=new EventTarget;this._targetMap.set(e,r)}}r.addEventListener(t,n);var o=this._disposableMap.get(e);if(!o){o=new Map;this._disposableMap.set(e,o)}var u=this._scope.attach({dispose:function(){r.removeEventListener(t,n)}});o.set(t,u)};e.prototype.off=function(e,t,n){var r;if(s(e))r=e;else{var i=this._targetMap.get(e);i&&(r=i)}var o=this._disposableMap.get(e);if(o){var u=o.get(t);if(u){u.dispose();o.delete(t)}0===o.size&&this._disposableMap.delete(e)}r&&r.removeEventListener(t,n)};e.prototype.dispose=function(){this._scope.dispose()};return e})();function s(e){return!!e.addEventListener}var o=(function(){function e(e){this._scope=new r.e;this._timeoutMap=new Map}e.prototype.setTimeout=function(e,t){var n=this,r=setTimeout(function(){n._timeoutMap.delete(r);e()},t),i=this._scope.attach({dispose:function(){clearTimeout(r)}});this._timeoutMap.set(r,i);return r};e.prototype.clearTimeout=function(e){var t=this._timeoutMap.get(e);if(t){this._timeoutMap.delete(e);t.dispose()}};e.prototype.dispose=function(){this._scope.dispose()};return e})(),u="unsupportedCommand",a="handlerError",f="handlerRejection",l="acknowledgeTimeout",c="resultTimeout",h="setupTimeout",p="canceled",d="disposed",v=0,m=(function(){function e(e,t){void 0===t&&(t={});var n=this,s=new Map,l={onCommand:e.onCommand,onNotification:e.onNotification},c=e.initResources,d=e.initTimeoutMs,v=void 0===d?1e4:d,m=e.ackTimeoutMs,g=void 0===m?1e3:m,y=e.resultTimeoutMs,b=void 0===y?1e4:y,w=t.asyncType,E=void 0===w?o:w,S=t.eventGroupType,x=void 0===S?i:S,T=this._scope=new r.e;T.attach(c);var N,C=this._async=T.attach(new E(this)),k=T.attach(new x(this));this._ackTimeoutMs=g;this._resultTimeoutMs=b;this._invokeCommandHandler=function(e){try{var t=l.onCommand&&l.onCommand(e);return t?Promise.resolve(t).catch(function(e){return{result:"error",error:{code:(e=e||{name:f,isExpected:!1,message:"Unknown error"}).code||e.name||f,message:e.message||"".concat(e)},isExpected:!!e.isExpected}}):Promise.resolve({result:"error",error:{code:u,message:e.command},isExpected:!0})}catch(e){return Promise.resolve({result:"error",isExpected:!1,error:{code:a,message:e&&"Name: ".concat(e.name,"; Message: ").concat(e.message||e)}})}};this._invokeNotificationHandler=function(e){try{l.onNotification&&l.onNotification(e)}catch(e){}};var L=this._port=new Promise(function(t,r){T.attach({dispose:function(){var e=new Error("Initialization canceled.");e.code=p;r(e)}});N=C.setTimeout(function(){var e=new Error("Initialization timed out after ".concat(v,"ms"));e.code=h;r(e)},v);e.init(function(e){C.clearTimeout(N);T.attach({dispose:function(){e.close()}});k.on(e,"message",function(t){var r=t.data;if(r&&"object"==typeof r)return"acknowledge"===r.type?n._onAcknowledge(r):"command"===r.type?n._onCommand(e,r):"notification"===r.type?n._onNotification(r):"result"===r.type?n._onResult(r):void 0});e.start();t(e)},r)});this.ready=L.then(function(){},function(e){n.dispose();return Promise.reject(e)});this._signals=s}e.prototype.dispose=function(){this._scope.dispose();this._signals.forEach(function(e){e.resolve({result:"error",isExpected:!0,error:{code:p,message:"Messenger disposed"}})});this._signals.clear()};e.prototype.sendCommand=function(e,t){var n=this;void 0===t&&(t={});if(this._scope.isDisposed)return Promise.resolve({result:"error",isExpected:!1,error:{code:d,message:"disposed"}});var r=++v,i=t.timeoutDelayMs,s=void 0===i?this._resultTimeoutMs:i,o=t.acknowledgeTimeoutMs,u=void 0===o?this._ackTimeoutMs:o;return this._port.then(function(t){var i=n._async,o=new Promise(function(e){n._signals.set(r,{acknowledgeTimeout:i.setTimeout(function(){n._onResult(g(r,l))},u),resultTimeout:i.setTimeout(function(){n._onResult(g(r,c))},s),resolve:e})});t.postMessage({type:"command",id:r,data:e});return o})};e.prototype.sendNotification=function(e){this._scope.isDisposed||this._port.then(function(t){t.postMessage({type:"notification",data:e})})};e.prototype._onAcknowledge=function(e){var t=this._signals.get(e.id);t&&this._async.clearTimeout(t.acknowledgeTimeout)};e.prototype._onCommand=function(e,t){var n=t.id;e.postMessage({type:"acknowledge",id:n});this._invokeCommandHandler(t.data).then(function(t){e.postMessage({type:"result",data:t,id:n})}).catch(function(e){})};e.prototype._onNotification=function(e){this._invokeNotificationHandler(e.data)};e.prototype._onResult=function(e){var t=e.id,n=this._async,r=this._signals,i=r.get(t);if(i){n.clearTimeout(i.acknowledgeTimeout);n.clearTimeout(i.resultTimeout);i.resolve(e.data)}r.delete(t)};return e})();function g(e,t){return{id:e,data:{result:"error",error:{code:t,message:"Timed out"},isExpected:!1}}}function y(e,t){void 0===t&&(t={});var n=e.channelId,s=e.onReinitialize,o=e.origin,u=e.receiver,a=void 0===u?window:u,f=e.source,l=e.identifyParent,c=t.eventGroupType,h=void 0===c?i:c,p=t.messengerType,d=void 0===p?m:p,v=new r.e,g=v.attach(new h(null));return new d({onCommand:e.onCommand,onNotification:e.onNotification,init:function(e,t){var r;if(l&&f){var i=setInterval(function(){var e={type:"identify-parent",channelId:n};f.postMessage(e,o)},100);r=v.attach({dispose:function(){clearInterval(i)}})}var u=!1;g.on(a,"message",function(t){var i=t.data;if(t.origin===o&&(!f||t.source===f)&&i&&"object"==typeof i&&"initialize"===i.type&&i.channelId===n){r&&r.dispose();if(s){if(u){s();g.dispose();return}u=!0}else g.dispose();var a=i.replyTo;a.postMessage({type:"activate"});e(a)}})},initResources:v,initTimeoutMs:e.initTimeoutMs,ackTimeoutMs:e.ackTimeoutMs,resultTimeoutMs:e.resultTimeoutMs})}},552:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n(547),s=n(26),o=(function(){function e(){this._commandHandlers=[];this._notificationHandlers=[]}Object.defineProperty(e.prototype,"ready",{get:function(){return this._messenger.ready},enumerable:!1,configurable:!0});e.prototype.sendCommand=function(e,t){return this._messenger.sendCommand(e,t)};e.prototype.sendNotification=function(e){return this._messenger.sendNotification(e)};e.prototype.addCommandHandler=function(e){var t=this;this._commandHandlers.push(e);return{dispose:function(){var n=t._commandHandlers.indexOf(e);n>-1&&t._commandHandlers.splice(n,1)}}};e.prototype.addNotificationHandler=function(e){var t=this;this._notificationHandlers.push(e);return{dispose:function(){var n=t._notificationHandlers.indexOf(e);n>-1&&t._notificationHandlers.splice(n,1)}}};e.prototype.dispose=function(){this._messenger.dispose()};e.prototype._onCommand=function(e){for(var t=0,n=this._commandHandlers;t<n.length;t++){var r=(0,n[t])(e);if(r)return r}};e.prototype._onNotificiation=function(e){for(var t=0,n=this._notificationHandlers;t<n.length;t++){(0,n[t])(e)}};return e})(),u=(function(e){Object(r.r)(t,e);function t(t){var n=this,s=t.initTimeoutMs,o=void 0===s?4e4:s,u=Object(r.s)(t,["initTimeoutMs"]);(n=e.call(this)||this)._customerPromiseLogger=u.customerPromiseLogger;n._messenger=Object(i.e)(Object(r.e)(Object(r.e)({},u),{initTimeoutMs:o,identifyParent:!0,onCommand:n._onCommand.bind(n),onNotification:n._onNotificiation.bind(n)}));return n}t.prototype.sendShareDestruct=function(){var e={command:"shareCommand",name:"share_destruct"};return this._send(e)};t.prototype.sendShareRevisible=function(e){e.command="shareCommand";return this._send(e)};t.prototype.sendSharingContextInformation=function(e){var t={command:"shareCommand",name:"share_postContextInformation",data:e};return this._send(t)};t.prototype.sendNewToken=function(e,t,n){var r={command:"shareCommand",name:"share_newToken"};if(e)r.token=e;else if(t){r.error=t;r.errorDetails=n}return this._send(r)};t.prototype.sendDocumentInformation=function(e){var t={command:"shareCommand",name:"share_documentInformation",data:{documentInformation:e}};return this._send(t)};t.prototype._send=function(e){var t=this;0;return this._messenger.sendCommand(e).then(function(e){return!!e}).catch(function(n){var r;null===(r=t._customerPromiseLogger)||void 0===r||r.end({resultType:s.e.Failure,errorCode:"SharingHostMessenger - send ".concat(e.name," failed"),extraData:{errorMessage:n.toString()}});return!1})};return t})(o)},606:function(e,t,n){"use strict";n.r(t);n.d(t,"SharePrefetch",function(){return Qt});var r={};n.r(r);n.d(r,"Default",function(){return Ke});n.d(r,"Tenant",function(){return Qe});n.d(r,"Hub",function(){return Ge});n.d(r,"Site",function(){return Ye});var i,s=n(0),o=0,u=1,a=2,f=n(339),l=n(206),c=n(97),h=n(304);(function(e){e[e.share=1]="share";e[e.copy=2]="copy";e[e.atMention=3]="atMention";e[e.linkSettings=4]="linkSettings";e[e.manageAccess=5]="manageAccess";e[e.notify=6]="notify";e[e.addPeople=7]="addPeople"})(i||(i={}));var p=i,d=n(112);function v(e,t){void 0===t&&(t=!1);var n=new Date(e),r=n.getTimezoneOffset()<0,i=n.getFullYear()+"",s=Object(d.i)(n.getMonth()+1+"",2),o=Object(d.i)(n.getDate()+"",2),u=Object(d.i)(n.getHours()+"",2),a=Object(d.i)(n.getMinutes()+"",2),f=Object(d.i)(n.getSeconds()+"",2),l=(r?"+":"-")+Object(d.i)(r?(Math.ceil(n.getTimezoneOffset()/60)+"").replace("-",""):Math.floor(n.getTimezoneOffset()/60)+"",2)+Object(d.i)((n.getTimezoneOffset()%60).toString().replace("-",""),2);return t?i+"-"+s+"-"+o+"T"+u+":"+a+":"+f+l:i+s+o+"T"+u+a+f+l}var m,g,y=n(137);(function(e){e[e.sameSite=0]="sameSite";e[e.crossSite=1]="crossSite";e[e.unknown=2]="unknown"})(m||(m={}));(function(e){e[e.sameGeo=0]="sameGeo";e[e.crossGeo=1]="crossGeo";e[e.unknown=2]="unknown"})(g||(g={}));var b=(function(){function e(e){var t=e.defaultFullWebUrl,n=e.defaultListUrl,r=e.multiGeoInfo,i=e.options,s=void 0===i?{}:i,o=s.path,u=void 0===o?void 0:o,a=s.listUrl,f=void 0===a?void 0:a,l=s.webUrl,c=void 0===l?void 0:l,h=s.mayInferListUrl,p=void 0!==h&&h;this._rawPath=u||void 0;this._rawListUrl=f||void 0;this._rawWebUrl=c||void 0;this.defaultFullWebUrl=E(t||void 0);this.defaultListUrl=E(n||void 0);this.multiGeoInfo=r;this.mayInferListUrl=p}Object.defineProperty(e.prototype,"serverRelativeItemUrl",{get:function(){return w(this._getServerRelativeItemUrl())},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"serverRelativeListUrl",{get:function(){return w(this._getServerRelativeListUrl())},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"fullListUrl",{get:function(){return this._getFullListUrl()},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"normalizedListUrl",{get:function(){return w(this._getNormalizedListUrl())},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"fullItemUrl",{get:function(){return this._getFullItemUrl()},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"normalizedItemUrl",{get:function(){return w(this._getNormalizedItemUrl())},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"listRelativeItemUrl",{get:function(){return this._getListRelativeItemUrl()},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"webRelativeItemUrl",{get:function(){return this._getWebRelativeItemUrl()},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"fullWebUrl",{get:function(){return this._getFullWebUrl()},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"normalizedWebUrl",{get:function(){return w(this._getNormalizedWebUrl())},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"serverRelativeWebUrl",{get:function(){return w(this._getServerRelativeWebUrl())},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"isCrossDomain",{get:function(){return this._getIsCrossDomain()},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"isCrossList",{get:function(){return this._getIsCrossList()},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"siteRelation",{get:function(){return this._getSiteRelation()},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"geoRelation",{get:function(){return this._getGeoRelation()},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"path",{get:function(){return this._getPath()},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"listUrl",{get:function(){return this._getListUrl()},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"webUrl",{get:function(){return this._getWebUrl()},enumerable:!1,configurable:!0});e.prototype._getPath=function(){var e,t=this._rawPath;if(t)if("/"===t[0]||t.indexOf("://")>-1)e=E(t);else{var n=this._getListUrl()||this.defaultListUrl;n&&(e="".concat(n,"/").concat(t))}this._getPath=function(){return e};return e};e.prototype._getListUrl=function(){var e,t=this._rawListUrl;if(t)if("/"===t[0]||t.indexOf("://")>-1)e=E(t);else{var n=this._getWebUrl()||this.defaultFullWebUrl;n&&(e="".concat(n,"/").concat(t))}this._getListUrl=function(){return e};return e};e.prototype._getWebUrl=function(){var e,t=this._rawWebUrl;t&&(e="/"===t[0]||t.indexOf("://")>-1?E(t):"".concat(this.defaultFullWebUrl,"/").concat(t));this._getWebUrl=function(){return e};return e};e.prototype._getCurrentAuthority=function(){var e=new y.e(this.defaultFullWebUrl).authority;this._getCurrentAuthority=function(){return e};return e};e.prototype._getNormalizedWebUrl=function(){var e,t=this._getFullWebUrl(),n=this.defaultFullWebUrl;if(void 0!==t&&!Object(d.t)(t,n)){var r=new y.e(t);e=Object(d.t)(r.authority,this._getCurrentAuthority())?r.path:t}this._getNormalizedItemUrl=function(){return e};return e};e.prototype._getNormalizedItemUrl=function(){var e,t=this._getFullItemUrl();if(void 0!==t){var n=new y.e(t);e=Object(d.t)(n.authority,this._getCurrentAuthority())?n.path:t}this._getNormalizedItemUrl=function(){return e};return e};e.prototype._getNormalizedListUrl=function(){var e,t=this._getFullListUrl(),n=this._getDefaultListUrl();void 0===t||Object(d.t)(t,n)||(e=Object(d.t)(new y.e(t).authority,this._getCurrentAuthority())?this._getServerRelativeListUrl():t);this._getNormalizedListUrl=function(){return e};return e};e.prototype._getServerUrl=function(){var e=this.path&&new y.e(this.path).authority||this.listUrl&&new y.e(this.listUrl).authority||this.webUrl&&new y.e(this.webUrl).authority||this.defaultListUrl&&new y.e(this.defaultListUrl).authority||new y.e(this.defaultFullWebUrl).authority;this._getServerUrl=function(){return e};return e};e.prototype._getServerRelativeListUrl=function(){var e;if(void 0!==this.listUrl)e=new y.e(this.listUrl).path;else{var t=this._getDefaultListUrl(),n=this.mayInferListUrl;if(void 0!==t||n){var r=this._getServerRelativePath(),i=new y.e(t).path;if(void 0===r&&(void 0===this.webUrl||i&&T(x(i),x(this._getServerRelativeWebUrl())))||i&&T(x(r),x(i)))e=i;else if(void 0!==r&&(""===this.defaultListUrl||n)){var s=this._getServerRelativeWebUrl();if(T(x(r),x(s))){var o=new y.e(r).segments[new y.e(s).segments.length];e="".concat(x(s)).concat(o)}}}}this._getServerRelativeListUrl=function(){return e};return e};e.prototype._getFullListUrl=function(){var e,t=this._getServerUrl(),n=this._getServerRelativeListUrl();void 0!==n&&(e="".concat(t).concat(n));return e};e.prototype._getFullItemUrl=function(){var e,t=this._getServerUrl(),n=this._getServerRelativeItemUrl();void 0!==n&&(e="".concat(t).concat(n));this._getFullItemUrl=function(){return e};return e};e.prototype._getServerRelativeWebUrl=function(){var e,t;if(void 0!==this.webUrl)e=new y.e(this.webUrl).path;else if(!this.defaultListUrl&&!this.listUrl||this.mayInferListUrl||void 0===(t=this._getServerRelativeListUrl()))this.defaultFullWebUrl&&(e=new y.e(this.defaultFullWebUrl).path);else{var n=new y.e(t);e="".concat(n.segments.slice(0,-1).join("/"))}this._getServerRelativeWebUrl=function(){return e};return e};e.prototype._getServerRelativePath=function(){var e;void 0!==this.path&&(e=new y.e(this.path).path);this._getServerRelativePath=function(){return e};return e};e.prototype._getServerRelativeItemUrl=function(){var e;this.path||this._rawPath?e=this._getServerRelativePath():this.listUrl?e=this._getServerRelativeListUrl():this.webUrl?e=this._getServerRelativeWebUrl():this.defaultListUrl?e=this._getServerRelativeListUrl():this.defaultFullWebUrl&&(e=this._getServerRelativeWebUrl());this._getServerRelativeItemUrl=function(){return e};return e};e.prototype._getListRelativeItemUrl=function(){var e,t,n=this._getServerRelativePath(),r=this._getServerRelativeListUrl();void 0!==this.path&&void 0!==r&&T(x(n),t=x(r))&&(e=n&&n.substring(t.length));this._getListRelativeItemUrl=function(){return e};return e};e.prototype._getWebRelativeItemUrl=function(){var e,t,n=this._getServerRelativePath(),r=this._getServerRelativeWebUrl();void 0!==this.path&&void 0!==r&&T(x(n),t=x(r))&&(e=n&&n.substring(t.length));this._getWebRelativeItemUrl=function(){return e};return e};e.prototype._getDefaultListUrl=function(){var e;void 0!==this.defaultListUrl&&(e=new y.e(this.defaultListUrl).authority?this.defaultListUrl:"".concat(this._getCurrentAuthority()).concat(this.defaultListUrl));this._getDefaultListUrl=function(){return e};return e};e.prototype._getIsCrossDomain=function(){var e=this._getCurrentAuthority(),t=!Object(d.t)(new y.e(this._getServerUrl()).authority,e);this._getIsCrossDomain=function(){return t};return t};e.prototype._getIsCrossList=function(){var e=this._getFullListUrl(),t=this._getDefaultListUrl(),n=!Object(d.t)(e,t);this._getIsCrossList=function(){return n};return n};e.prototype._getSiteRelation=function(){var e=m.unknown;if(this._getIsCrossDomain())e=m.crossSite;else if(void 0!==this.webUrl)e=Object(d.t)(S(this.defaultFullWebUrl),S(this._getFullWebUrl()))?m.sameSite:m.crossSite;else{var t=new y.e(this.defaultFullWebUrl).path,n=this._getServerRelativeListUrl()||this._getServerRelativePath();if(void 0!==n)if(T(x(n),x(t))){var r=new y.e(S(n)),i=new y.e(S(t));e=r.segments.length-1===i.segments.length||r.segments.length-2===i.segments.length&&"Lists"===r.segments[r.segments.length-2]?m.sameSite:m.unknown}else e=m.crossSite}this._getSiteRelation=function(){return e};return e};e.prototype._getFullWebUrl=function(){var e,t=this._getServerUrl(),n=this._getServerRelativeWebUrl();void 0!==n&&(e="".concat(t).concat(n));this._getFullWebUrl=function(){return e};return e};e.prototype._getGeoRelation=function(){if(!this._getIsCrossDomain())return g.sameGeo;var e=new y.e(this._getServerUrl()).authority;if(!e)return g.unknown;var t=this._getCurrentGeo();if(!t)return g.unknown;var n=this._getGeoByAuthority()[e.toUpperCase()];return n?Object(d.t)(n,t)?g.sameGeo:g.crossGeo:g.unknown};e.prototype._getGeoByAuthority=function(){var e={},t={};function n(n,r,i){var s=new y.e(n).authority.toUpperCase();!i&&t[s]||(e[s]=r);i&&(t[s]=!0)}if(this.multiGeoInfo)for(var r=0,i=this.multiGeoInfo;r<i.length;r++){var s=i[r],o=s.InstanceId,u=s.IsDefaultDataLocation;n(s.MySiteHostUrl,o,u);n(s.PortalUrl,o,u);n(s.RootSiteUrl,o,u);n(s.TenantAdminUrl,o,u);if(s.AdditionalUrls)for(var a=0,f=s.AdditionalUrls;a<f.length;a++){n(f[a],o,u)}}this._getGeoByAuthority=function(){return e};return e};e.prototype._getCurrentGeo=function(){var e=this._getCurrentAuthority();if(e){var t=this._getGeoByAuthority()[e.toUpperCase()];this._getCurrentGeo=function(){return t};return t}};return e})();function w(e){return""===e?"/":e}function E(e){return"/"===e?"/":e}function S(e){void 0===e&&(e="");return"/"===e[e.length-1]?e.substring(0,e.length-1):e}function x(e){void 0===e&&(e="");return"/"===e[e.length-1]?e:"".concat(e,"/")}function T(e,t){var n=e.toUpperCase(),r=t&&t.toUpperCase();return n.substring(0,r&&r.length||0)===r}var N=(function(){function e(e){var t=e.context,n=e.itemUrlPartsType,r=void 0===n?b:n;this.itemUrlPartsType=r;this.itemUrlContext=t}e.prototype.getUrlParts=function(e){var t=this.itemUrlContext,n=t.webAbsoluteUrl,r=t.listUrl,i=t.multiGeoInfo;return new this.itemUrlPartsType({defaultFullWebUrl:n,defaultListUrl:r,multiGeoInfo:i,options:e})};return e})(),C=n(111),k=(function(e){Object(s.r)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}return t})(b),L=(function(e){Object(s.r)(t,e);function t(t,n){var r=n.itemUrlPartsType,i=void 0===r?k:r;return e.call(this,{context:n.pageContext,itemUrlPartsType:i})||this}t.prototype.getUrlParts=function(t){return e.prototype.getUrlParts.call(this,t)};t.prototype.getItemUrlParts=function(e){var t=Object(C.e)(e);return this.getUrlParts({path:t.id,listUrl:t.listurl})};return t})(N),A=n(123),O=(function(){function e(e){var t=e.webAbsoluteUrl,n=e.encodeWebAbsoluteUrl,r=void 0===n||n;this._webAbsoluteUrl=t;this._encodeWebAbsoluteUrl=r;this._segments=[];this._parameters=[];this._rawParameters=[];this._lastParameterId=0}e.prototype.toString=function(){var e,t=[];this._parameters.length&&t.push(this._parameters.map(function(e){var t=e.name,n=e.serializedValue;return"".concat(t,"=").concat(n)}).join("&"));t.push.apply(t,this._rawParameters);e=t.length?"?".concat(t.join("&")):"";var n=this._webUrl,r=void 0===n?this._webAbsoluteUrl:n,i=Object(s.o)([this._encodeWebAbsoluteUrl?encodeURI(r):r,"_api"],this._segments,!0);return"".concat(i.join("/")).concat(e)};e.prototype.segment=function(e){return this._extend({segments:[e]})};e.prototype.segments=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._extend({segments:e})};e.prototype.methodWithAliases=function(e,t){for(var n=this,r=[],i=0,s=Object.keys(t);i<s.length;i++){var o=s[i],u=t[o],a=n._autoParameter(u);n=a.apiUrl;r.push("".concat(o,"=").concat(a.name))}return n.segment("".concat(e,"(").concat(r.join(","),")"))};e.prototype.method=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=this,i=[],s=0,o=t;s<o.length;s++){var u=o[s],a=r._autoParameter(u);r=a.apiUrl;i.push(a.name)}return r.segment("".concat(e,"(").concat(i.join(","),")"))};e.prototype.parameter=function(e,t){return this._parameter(e,t)};e.prototype.parameters=function(e){for(var t=this,n=0,r=Object.keys(e);n<r.length;n++){var i=r[n],s=e[i];t=t.parameter(i,s)}return t};e.prototype.oDataParameter=function(e,t){return this.parameter(e,{raw:t})};e.prototype.rawParameter=function(e){return this._extend({rawParameters:[e]})};e.prototype._autoParameter=function(e){var t=this._lastParameterId+1,n="@a".concat(t);return{name:n,apiUrl:this._extend({lastParameterId:t})._parameter(n,e)}};e.prototype._parameter=function(e,t){var n;n=(function(e){return!!e&&"object"==typeof e&&"json"in e})(t)?A.e.encodeRestUriStringToken(JSON.stringify(t.json)):(function(e){return!!e&&"object"==typeof e&&"guid"in e})(t)?"guid'".concat(t.guid,"'"):(function(e){return!!e&&"object"==typeof e&&"raw"in e})(t)?t.raw:"number"==typeof t||"boolean"==typeof t?"".concat(t):"'".concat(A.e.encodeRestUriStringToken(t),"'");return this._extend({parameters:[{name:e,serializedValue:n}]})};e.prototype.clone=function(){return new e({webAbsoluteUrl:this._webAbsoluteUrl,encodeWebAbsoluteUrl:this._encodeWebAbsoluteUrl})};e.prototype._extend=function(e){var t,n,r,i,s,o;void 0===e&&(e={});var u=this.clone();u._webUrl=this._webUrl;u._lastParameterId=this._lastParameterId;(t=u._parameters).push.apply(t,this._parameters);(n=u._segments).push.apply(n,this._segments);(r=u._rawParameters).push.apply(r,this._rawParameters);"webUrl"in e&&(u._webUrl=e.webUrl);"lastParameterId"in e&&(u._lastParameterId=e.lastParameterId);"parameters"in e&&(i=u._parameters).push.apply(i,e.parameters);"rawParameters"in e&&(s=u._rawParameters).push.apply(s,e.rawParameters);"segments"in e&&(o=u._segments).push.apply(o,e.segments);return u};return e})(),M=(function(){function e(e){this._apiUrlType=(function(t){Object(s.r)(n,t);function n(){return t.call(this,{webAbsoluteUrl:e.webAbsoluteUrl,encodeWebAbsoluteUrl:e.encodeWebAbsoluteUrl})||this}return n})(O)}e.prototype.build=function(){return new this._apiUrlType};e.prototype.contextInfoUrl=function(e){var t,n=e.indexOf("/_layouts/");if(n>-1)t=e.substring(0,n);else{var r=e.lastIndexOf("/"),i=e.lastIndexOf(".");t=i>r?"".concat(e.substring(0,i),"_").concat(e.substring(i+1)):e}return"".concat(t,"/_api/contextinfo")};return e})();var _=(function(e){Object(s.r)(t,e);function t(t,n){var r=e.call(this,{webAbsoluteUrl:n.pageContext.webAbsoluteUrl,encodeWebAbsoluteUrl:n.encodeWebAbsoluteUrl})||this;r._pageContext=n.pageContext;r._shouldEncodeWebAbsoluteUrl=n.encodeWebAbsoluteUrl;r._itemUrlHelper=n.itemUrlHelper;return r}t.prototype.webByUrl=function(e){return this.webByItemUrl(this._itemUrlHelper.getUrlParts(e))};t.prototype.webByItemUrl=function(e){var t=e.siteRelation,n=e.isCrossDomain,r=e.fullItemUrl,i=this;(n||t===m.crossSite)&&(i=i.method("SP.RemoteWeb",r));return i.segment("web")};t.prototype.listById=function(e,t){return this.webByItemUrl(e).segment("lists").method("GetById",t)};t.prototype.clone=function(){return new t({webAbsoluteUrl:this._pageContext.webAbsoluteUrl},{pageContext:this._pageContext,itemUrlHelper:this._itemUrlHelper,encodeWebAbsoluteUrl:this._shouldEncodeWebAbsoluteUrl})};return t})(O),D=(function(e){Object(s.r)(t,e);function t(t,n){var r=e.call(this,{webAbsoluteUrl:n&&n.pageContext?n.pageContext.webAbsoluteUrl:"",encodeWebAbsoluteUrl:n.encodeWebAbsoluteUrl})||this,i=n.itemUrlHelper,o=n.pageContext,u=n.encodeWebAbsoluteUrl,a=n.apiUrlType,f=void 0===a?(function(e){Object(s.r)(t,e);function t(){return e.call(this,{},{itemUrlHelper:i,pageContext:o,encodeWebAbsoluteUrl:u})||this}return t})(_):a;r._apiUrlType=f;return r}t.prototype.build=function(){return new this._apiUrlType};return t})(M);var P,H=n(85),B=n(127),j=n(26),F=n(72);(function(e){e[e.none=0]="none";e[e.fullPageLoad=4]="fullPageLoad";e[e.onePageAppNavigation=5]="onePageAppNavigation"})(P||(P={}));var I=P,q=n(87),R=n(9),U=Object(q.e)({eventName:"RUMOneDataUpload,",shortEventName:"RUMOneDataUpload"},{streamName:R.e.String,dictionary:R.e.Object,privacyClassification:{isPrefixingDisabled:!0,type:R.e.String}}).withData({privacyClassification:R.t.requiredService}),z=n(212),W=n(107),X=n(17);var V,$="undefined"==typeof window?self:window;(function(e){e[e.xhr=0]="xhr";e[e.fetch=1]="fetch"})(V||(V={}));var J,K,Q=(function(){function e(){this._requestIdGenerator=(e=0,function(){return(e++).toString()});var e}e.prototype.instrument=function(e){var t=this;if(!$.__RUMOneAPITrackerInstrumented){$.__RUMOneAPITrackerInstrumented=!0;var n=e.fetch,r=e.xhr;if("XMLHttpRequest"in $&&"undefined"!=typeof XMLHttpRequest){this._originalXhrSend=XMLHttpRequest.prototype.send;this._originalXhrOpen=XMLHttpRequest.prototype.open;var i=this;XMLHttpRequest.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.requestUrl=e[1];return i._originalXhrOpen.apply(this,e)};XMLHttpRequest.prototype.send=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var s=i._requestIdGenerator();r.onRequest({request:this,id:s,type:V.xhr});this.addEventListener("readystatechange",function(){4===e.readyState&&r.onResponse({request:e,id:s,type:V.xhr})});return i._originalXhrSend.apply(this,t)}}if("fetch"in $&&void 0!==$.fetch){this._originalFetch=$.fetch.bind($);$.fetch=function(e,r){return new Promise(function(i,s){var o=t._requestIdGenerator();n.onRequest({request:e,id:o,type:V.fetch});t._originalFetch(e,r).then(function(e){n.onResponse({response:e,id:o,type:V.fetch});i(e)},function(e){s(e)})})}}}};e.prototype.undoInstrument=function(){$.__RUMOneAPITrackerInstrumented=!1;this._originalXhrOpen&&(XMLHttpRequest.prototype.open=this._originalXhrOpen);this._originalXhrSend&&(XMLHttpRequest.prototype.send=this._originalXhrSend);this._originalFetch&&($.fetch=this._originalFetch)};return e})(),G=n(31);new Date;(function(e){e[e.own=0]="own";e[e.cors=1]="cors"})(K||(K={}));var Y,Z=function(e,t,n,r,i,s,o){this.url=e;this.duration=t;this.correlationId=n;this.status=r;this.startTime=i;this.endTime=s;this.name=o;this.clientDurationInMilliseconds=new Date(s).getTime()-new Date(i).getTime();this.origin=e&&new G.t(e).getHost()};(function(e){e[e.Incomplete=1]="Incomplete";e[e.ReadyToUpload=2]="ReadyToUpload";e[e.Uploaded=3]="Uploaded";e[e.TimeOut=4]="TimeOut";e[e.Skipped=5]="Skipped"})(Y||(Y={}));var ee=["EUPL","ScenarioId"],te=/^[a-zA-Z0-9](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,ne=/(?:\/api\/|\/_api\/)(.*?)(?:\(|\?|sharePoint\:|$)/;function re(e){return null==e}var ie={checkInterval:100,error_timeout:3e4,max_markers:200},se=(function(){function e(e,t,n){void 0===n&&(n=ie);var r=this;this._keyMetrics=ee.slice(0);this.async=new F.e(this);this.dataStartTime=Date.now();this._rumoneData={};this.dataState=Y.Incomplete;this.controls=[];this.apis=[];this._apiBuffer={};this._loggingFunctions=[];this.euplBreakDown={};this.ttiBreakDown={};this.serverMetrics={};this.isW3cTimingCollected=!1;this._isW3cResourceTimingCollected={};this.tempData={};this._settings={};this._emergencyUpdateFunc=this._emergencyUpload.bind(this);this.undoAPIInstrument=function(){r._apiTracker.undoInstrument()};this._name=e;this.registerLoggingFunc(t);this._config=n;this.setPerfDataTimer();this._platformDetection=new z.e;this._hookUnloadEvent();this._apiTracker=new Q}e.getRUMOneLogger=function(t,n,r){void 0===t&&(t="__default_rumone__");void 0===r&&(r=ie);var i=n||function(e,t){U.logData({streamName:e,dictionary:t})};if(!e.Loggers[t])try{var s=new e(t,i,r);"__default_rumone__"===t&&(e.rumOneLogger=s);e.Loggers[t]=s}catch(e){}return e.Loggers[t]};e.prototype.registerLoggingFunc=function(e){var t=this,n=this._loggingFunctions.indexOf(e);n<0&&this._loggingFunctions.push(e);return function(){n>=0&&t._loggingFunctions.splice(n,1)}};Object.defineProperty(e.prototype,"KeyMetrics",{get:function(){this._TTIMeasurementEnabled()&&this.addExpectedKeyMetric("TTI");this._FCIMeasurementEnabled()&&this.addExpectedKeyMetric("FCI");return this._keyMetrics},enumerable:!1,configurable:!0});e.prototype.getPerformanceData=function(){return this._rumoneData};e.prototype.startAPIMeasurement=function(e){var t=this,n=e&&e.ignore||function(e){return!1},r=e&&e.getAPIName||function(e){},i=function(e){var n=e.id,r=e.request,i=e.type,s=new Z;s.startTime=(new Date).toISOString();s.startTimeRelative=t.now();i===V.fetch&&(s.url="string"==typeof r?r:r.url);t._apiBuffer[n]=s};this._apiTracker.instrument({fetch:{onRequest:i,onResponse:function(e){var i=e.response,o=e.id,u=t._apiBuffer[o];if(u&&!n(u.url)){var a=void 0,f=void 0;try{a=i.headers.get("SPClientServiceRequestDuration");f=i.headers.get("SPSQLQueryCount")}catch(e){}var l=void 0;try{l=i.headers.get("SPRequestGuid")}catch(e){}u.name=r(u.url);u=Object(s.e)(Object(s.e)({},u),Object(s.e)(Object(s.e)(Object(s.e)({endTime:(new Date).toISOString(),endTimeRelative:t.now(),clientDurationInMilliseconds:t.now()-u.startTimeRelative,status:i.status},a?{duration:Number(a)}:{}),f?{sqlRT:Number(f)}:{}),l?{correlationId:l}:{}));t.apis.push(u)}}},xhr:{onRequest:i,onResponse:function(e){var i,o,u=e.request,a=e.id,f=t._apiBuffer[a],l=u.responseURL||u.requestUrl;if(f&&!n(l)){var c=null!==(o=null===(i=u.getAllResponseHeaders())||void 0===i?void 0:i.toLowerCase())&&void 0!==o?o:"",h=c.indexOf("spclientservicerequestduration:")>=0&&u.getResponseHeader("SPClientServiceRequestDuration"),p=c.indexOf("spsqlquerycount:")>=0&&u.getResponseHeader("SPSQLQueryCount"),d=c.indexOf("sprequestguid:")>=0&&u.getResponseHeader("SPRequestGuid");f.name=r(l);f=Object(s.e)(Object(s.e)({},f),Object(s.e)(Object(s.e)(Object(s.e)(Object(s.e)({endTime:(new Date).toISOString(),endTimeRelative:t.now(),clientDurationInMilliseconds:t.now()-f.startTimeRelative,status:u.status},h?{duration:Number(h)}:{}),p?{sqlRT:Number(p)}:{}),d?{correlationId:d}:{}),{url:l}));t.apis.push(f)}}}});return function(){t._apiTracker.undoInstrument()}};e.prototype.resetLogger=function(){this._emergencyUpload();this._apiBuffer={};this.dataStartTime=(new Date).getTime();this.dataState=Y.Incomplete;this.isW3cTimingCollected=!1;this._isW3cResourceTimingCollected={};this.controls=[];this.apis=[];this.tempData={};this._rumoneData={};this._settings={};this._keyMetrics=ee.slice(0);this.clearPerfDataTimer();this.setPerfDataTimer();this.euplBreakDown={};this.ttiBreakDown={};this.serverMetrics={};this.clearResourceTimings();Object(W.n)(this._getOwnMakers().map(function(e){return e.name}));e._markers[this._name]=[];this._unhookUnloadEvent();this._hookUnloadEvent();this._ttiPromise=void 0;this._fciPromise=void 0;this.logMessageInConsole("Reset performance Logger Done")};e.prototype.setSettings=function(e){this._settings=Object(s.e)(Object(s.e)({},this._settings),e)};e.prototype.excludePageForPerfData=function(){this.setSettings({excludePageData:!0})};e.prototype.getPerformanceDataPropertyValue=function(e){return e&&this._rumoneData[e]};e.prototype.setPerformanceDataPropertyValue=function(e,t){if(e&&te.test(e)){this._rumoneData[e]=t;return!0}console.error("key ".concat(e," does not confrim to the Regex ").concat(te));return!1};e.prototype.addExpectedControl=function(e){var t=this._normalizeControl(e);this.expectingControl(e)?this.controls.filter(function(e){return e.controlId===t.controlId})[0].ignoreForEUPL=t.ignoreForEUPL:this.controls.push(t)};e.prototype.ignoreExpectedControl=function(e){var t=this._normalizeControl(e);this.expectingControl(e)&&(this.controls.filter(function(e){return e.controlId===t.controlId})[0].ignoreForEUPL=!0)};e.prototype.expectingControl=function(e){var t=this._normalizeControl(e);return this.controls.filter(function(e){return e.controlId===t.controlId}).length>0};e.prototype.writeServerCorrelationId=function(e){this._rumoneData.ServerCorrelationId=this._rumoneData.ServerCorrelationId||e};e.prototype.writeServerUrl=function(){this._rumoneData.ServerUrl=this._processEUIIUrl(location.href)};e.prototype.writeServerSideLatency=function(e,t){if(!this.isCollected("ServerRequestDuration")){this._rumoneData.ServerRequestDuration=e;this._rumoneData.IISLatency=t}};e.prototype.writeControlPerformanceData=function(e){if(e){var t=this.controls.filter(function(t){return t.controlId===e.controlId})[0];if(t)t.data||(t.data=e);else{var n={controlId:e.controlId,data:e,ignoreForEUPL:e.ignoreForEUPL};this.controls.push(n)}}};e.prototype.writeAPICallPerformanceData=function(e){e&&this.apis.push(e)};e.prototype.readAPICallPerformanceData=function(){return this.apis};e.prototype.writeAppCache=function(e){this.isCollected("AppCache")||(this._rumoneData.AppCache=e)};e.prototype.writePageTransitionType=function(e,t){this.isCollected("PageTransitionType")&&!t||e!==I.fullPageLoad&&e!==I.none&&e!==I.onePageAppNavigation||(this._rumoneData.PageTransitionType=e)};e.prototype.writeScenarioId=function(e,t){this.isCollected("ScenarioId")&&!t||(this._rumoneData.ScenarioId=e)};e.prototype.collectW3CPerfTimings=function(){if(!this.isW3cTimingCollected){var e=["navigationStart","unloadEventStart","unloadEventEnd","fetchStart","redirectStart","redirectEnd","domainLookupStart","domainLookupEnd","connectStart","secureConnectionStart","connectEnd","requestStart","responseStart","responseEnd","domLoading","domComplete","loadEventStart","loadEventEnd"],t=performance&&performance.timing;if(t){for(var n=0;n<e.length;n++){var r=t[e[n]];r&&this._logRUMOneData(this.getW3cTimingName(e[n]),Number(r))}this.isW3cTimingCollected=!0}}};e.prototype.collectW3cResourceTimings=function(t){void 0===t&&(t=void 0);var n=t||{},r=n.logSummery,i=void 0===r||r,o=n.start,u=void 0===o?0:o,a=n.end,f=void 0===a?Math.round(this.now()):a,l=n.columnNameOverride,c=void 0===l?function(e){return e}:l,h="logSummery=".concat(i,"|start=").concat(u,"|end=").concat(f,"|columnNameOverride=").concat(c),p=this._isW3cResourceTimingCollected[h];if(window.document&&!p&&performance&&performance.getEntriesByType){for(var d=performance.getEntriesByType("resource"),v=document.getElementsByTagName("iframe"),m=0;m<v.length;m++){var g=null;try{g=v[m].contentWindow.performance}catch(e){}g&&g.getEntriesByType&&d.concat(g.getEntriesByType("resource"))}var y={SharePoint:function(e){return 0===e.name.search(window.location.protocol+"//"+window.location.host)}};y.CDN=e._isRequestFromCDN;y.ThirdParty=function(e){return!y.SharePoint(e)&&!y.CDN(e)};var b={ASPX:function(e){return/\.aspx/i.test(e.name)},JS:function(e){return/script/i.test(e.initiatorType)},CSS:function(e){return/link|css/i.test(e.initiatorType)},IMG:function(e){return/img/i.test(e.initiatorType)}};d=d.filter(function(e){return e.startTime>=u&&e.startTime<=f});var w=Object.keys(y);for(m=0;m<w.length;m++){var E=w[m],S=this.categorizeResourceRequests(d,{from:y[E],requestType:null});i&&this._logRUMOneData(c(E+"RequestCountTotal"),S.length);for(var x=Object.keys(b),T=0;T<x.length;T++){var N=x[T];i&&this._logRUMOneData(c(E+"RequestCount"+N),this.categorizeResourceRequests(S,{from:null,requestType:b[N]}).length)}if(S.length>0){i&&this._logRUMOneData(c(E+"RequestDownloadTime"),Math.round(S.reduce(function(e,t){return e+t.duration},0)/S.length));if("CDN"===E){var C=JSON.stringify(S.map(function(e){return Object(s.e)(Object(s.e)(Object(s.e)(Object(s.e)({name:e.name.split("/").map(function(e){return e.split("?")[0]}).filter(function(e){return e&&e.length>0}).slice(-1)[0].replace(/\(.*?\)/g,"()"),startTime:Math.round(e.startTime),duration:Math.round(e.duration),transferSize:e.transferSize||0,fetchStart:Math.round(e.fetchStart),requestStart:Math.round(e.requestStart),connect:Math.round(e.connectEnd-e.connectStart),domainLookup:Math.round(e.domainLookupEnd-e.domainLookupStart),redirect:Math.round(e.redirectEnd-e.redirectStart)},oe(e,"workerStart")),oe(e,"responseStart")),oe(e,"responseEnd")),oe(e,"secureConnectionStart"))}));this._logRUMOneData(c(E+"RequestNames"),C)}}}this._isW3cResourceTimingCollected[h]=!0}};e.prototype.saveTempData=function(e,t){this.tempData[e]=t};e.prototype.readTempData=function(e){return this.tempData[e]};e.prototype.writeRenderTime=function(e,t){this.isCollected("RenderTime")&&!t||(this._rumoneData.RenderTime=e)};e.prototype.writePreRenderTime=function(e){this.isCollected("PreRender")||(this._rumoneData.PreRender=e)};e.prototype.writePostRenderTime=function(e){this.isCollected("PostRender")||(this._rumoneData.PostRender=e)};e.prototype.writeDataFetchTime=function(e,t){this.isCollected("DataFetch")&&!t||(this._rumoneData.DataFetch=e)};e.prototype.writeAppInfo=function(e,t){this.isCollected("AppInfo")&&!t||(this._rumoneData.AppInfo=e)};e.prototype.isRunning=function(){return!(this.dataState===Y.Uploaded||this.dataState===Y.TimeOut||this.dataState===Y.Skipped)};e.prototype.writeEUPLBreakdown=function(e,t){return this._writeBreakdown(this.euplBreakDown,e,t)};e.prototype.addEUPLBreakdown=function(e,t,n){return this._addBreakdown(this.euplBreakDown,e,t,n)};e.prototype.readEUPLBreakdown=function(e){return this._readBreakdown(this.euplBreakDown,e)};e.prototype.writeTTIBreakdown=function(e,t){return this._writeBreakdown(this.ttiBreakDown,e,t)};e.prototype.addTTIBreakdown=function(e,t,n){return this._addBreakdown(this.ttiBreakDown,e,t,n)};e.prototype.readTTIBreakdown=function(e){return this._readBreakdown(this.ttiBreakDown,e)};e.prototype.addFlights=function(e){if(e&&e.length>0){for(var t=JSON.parse(this.getPerformanceDataPropertyValue("Flights")||"[]"),n=0;n<e.length;n++){var r=e[n];r&&-1===t.indexOf(r)&&t.push(r)}this._rumoneData.Flights=JSON.stringify(t)}};e.prototype.collectSPClientFlights=function(e){for(var t="",n=0,r=e.ExpFeatures;n<r.length;n++){var i=r[n];t+=this._numberToBinString(i).split("").reverse().join("")}this._rumoneData.Flights=t};e.prototype.collectODCClientRamps=function(e,t){for(var n=e.Ramps,r=void 0===n?{}:n,i=[],s=0,o=t;s<o.length;s++){var u=o[s];u.ODC&&"boolean"!=typeof u.ODC&&r[u.ODC]&&i.push(u.ODC)}this._rumoneData.Flights=JSON.stringify(i)};e.prototype.addServerMetrics=function(e,t){if(e)for(var n in e)n&&!re(e[n])&&(re(this.serverMetrics[n])||t)&&(this.serverMetrics[n]=e[n])};e.prototype.writeServerVersion=function(e){this._rumoneData.SharePointServerVersion=e};e.prototype.readControlPerformanceData=function(){return this.controls.filter(function(e){return!!e.data}).map(function(e){return e.data})};e.prototype.mark=function(t){(e._markers[this._name]=e._markers[this._name]||[]).push(t);Object(W.s)(t)};e.prototype.now=function(){return performance&&performance.now?Math.round(performance.now()):NaN};e.prototype.registerEUPLComputedHandler=function(e){this._EUPLComputedHandler=e};e.prototype.registerErrorHandler=function(e){};e.prototype.getMarkerTime=function(e){return Object(W.i)(e)};e.prototype.addExpectedKeyMetric=function(e){this._keyMetrics&&-1===this._keyMetrics.indexOf(e)&&this._keyMetrics.push(e)};Object.defineProperty(e.prototype,"waitOnAddingExpectedControl",{set:function(e){this.setSettings({waitOnAddingExpectedControl:e})},enumerable:!1,configurable:!0});e._isRequestFromCDN=function(e){var t=window._spPageContextInfo,n=e.name;return!(!t||!t.cdnPrefix||0!==n.search(window.location.protocol+"//"+t.cdnPrefix))||(!(!t||!t.cdnBaseUrl||0!==n.search(t.cdnBaseUrl))||/(cdn(ppe)?|static(ppe)?)\.sharepointonline\.com|\.akamaihd\.net|akamai\.odsp\.cdn\.office\.net/i.test(n))};e.prototype._measureTTI=function(){var e=this;this._rumoneData.TTISupported="PerformanceLongTaskTiming"in window;if(this._TTIMeasurementEnabled()&&!this._ttiPromise){this._ttiPromise=(function(e){return Object(s.t)(this,void 0,void 0,function(){var t;return Object(s.i)(this,function(r){switch(r.label){case 0:t=Object(s.e)({minValue:Math.round(window.performance&&performance.now?Math.round(performance.now()):Date.now()),useMutationObserver:!1,trackNetworkRequests:!1,requiredMainThreadQuietnessDurationInMilliseconds:1e3,requiredNetworkQuietnessDurationInMilliseconds:1e3},e);return[4,n.ee([42],573)];case 1:return[2,r.sent().getFirstConsistentlyInteractive(t).then(function(e){return Object(s.e)(Object(s.e)({},e||{}),{options:t})})]}})})})(this._settings.TTISettings.TTIPolyfillSettings.options);this._ttiPromise.then(function(t){var n=t||{},r=n.tti,i=n.longTasks,s=n.options,o=r;if(re(r))r=NaN;else{var u=e._settings.TTISettings.TTIPolyfillSettings.calculateTTI;u&&(r=u(Math.round(r),e._rumoneData,"TTI"))}re(e._rumoneData.TTI)?e.addEUPLBreakdown("currentTTI",{data:JSON.stringify(r),needFlatten:!1}):e.addEUPLBreakdown("prevTTI",{data:JSON.stringify(e._rumoneData.TTI),needFlatten:!1});e._rumoneData.TTI=r;if(i){e._rumoneData.TTILongTasks=JSON.stringify(i);X.t.isActivated("4c338685-350e-4aae-a03e-fb969ab4dc98","02/24/2021")||(e._rumoneData.TTILongTasksPostFMPCount=i.filter(function(t){return t.end>e._rumoneData.EUPL}).length)}e._logLastRequestBeforeTTI(r,i,"TTI");e.collectW3cResourceTimings({logSummery:!1,start:o-(r-e._rumoneData.EUPL),end:o,columnNameOverride:function(e){return"".concat(e,"OfTTI")}});s&&e.addEUPLBreakdown("TTIOptions",{data:JSON.stringify(s),needFlatten:!1});var a=J;if(a){e._rumoneData.CLS=a.cls;e._rumoneData.CLSFullResult=a}})}if(this._FCIMeasurementEnabled()&&!this._fciPromise){if(X.t.isActivated("eff83b08-6883-438b-9f0e-59724a25b7e7","10/27/2021")){this._rumoneData.FCI=NaN;return}var t=this._settings.TTISettings.TTIPolyfillSettings.getAbsoluteEUPL,r=t?t(this._rumoneData.EUPL):this.now();this._fciPromise=(function(e){return Object(s.t)(this,void 0,void 0,function(){var t;return Object(s.i)(this,function(r){switch(r.label){case 0:t={measurementStartTime:e,requiredMainThreadCPUIdleDurationInMilliseconds:1e3};return[4,n.ee([41],618)];case 1:return[2,r.sent().getFirstCPUIdle(t)]}})})})(r);this._fciPromise.then(function(t){var n=t||{},r=n.fci,i=n.longTasks;if(re(r))r=NaN;else{var s=e._settings.TTISettings.TTIPolyfillSettings.calculateTTI;s&&(r=s(Math.round(r),e._rumoneData,"FCI"))}e._rumoneData.FCI=r;if(i){e._rumoneData.FCILongTasks=JSON.stringify(i);X.t.isActivated("4c338685-350e-4aae-a03e-fb969ab4dc98","02/24/2021")||(e._rumoneData.FCILongTasksPostFMPCount=i.filter(function(t){return t.end>e._rumoneData.EUPL}).length)}e._logLastRequestBeforeTTI(r,i,"FCI")})}};e.prototype._logLastRequestBeforeTTI=function(t,n,r){var i=performance.getEntriesByType("resource");if(t&&n&&n.length>0&&i&&i.length>0){for(var s=n[n.length-1].start,o=i[0],u=0,a=i;u<a.length;u++){var f=a[u];f.responseEnd<s&&f.responseEnd>o.responseEnd&&(o=f)}var l=void 0;l=e._isRequestFromCDN(o)?o.name:this._processLastNetworkUrl(o.name);var c=void 0;c=/\.aspx/i.test(o.name)?"ASPX":/\.js/i.test(o.name)?"JS":/\.css/i.test(o.name)?"CSS":/img/i.test(o.initiatorType)||/\.jpg|\.jpeg|\.png|\.gif/i.test(o.name)?"IMG":/aria\.microsoft\.com/i.test(o.name)?"Aria":/_api/i.test(o.name)?"API":"Other";if("TTI"===r){this._rumoneData.TTILastRequestName=l;this._rumoneData.TTILastRequestType=c;this._rumoneData.TTILastRequestStartTime=o.startTime;this._rumoneData.TTILastRequestEndTime=o.responseEnd}else{this._rumoneData.FCILastRequestName=l;this._rumoneData.FCILastRequestType=c;this._rumoneData.FCILastRequestStartTime=o.startTime;this._rumoneData.FCILastRequestEndTime=o.responseEnd}}};e.prototype._numberToBinString=function(e){var t=(e>>>0).toString(2);return"".concat(Array(32-t.length+1).join("0")).concat(t)};e.prototype._logRUMOneData=function(e,t){e&&(this._rumoneData[e]=t)};e.prototype.clearResourceTimings=function(){performance&&performance.clearResourceTimings&&performance.clearResourceTimings()};e.prototype._isBreakdownValue=function(e){return void 0!==e.needFlatten};e.prototype.collectMarks=function(){var e=this,t={},n=0;this._getOwnMakers().forEach(function(r){if(n<e._config.max_markers){var i=r.name.substr(W.t.length)+".mark".concat(n++);t[i]=Math.round(r.startTime)}});this.writeEUPLBreakdown(JSON.stringify(t))};e.prototype._getOwnMakers=function(){var t=this,n=e._markers,r=[].concat.apply([],Object.keys(n).filter(function(e){return n.hasOwnProperty(e)&&e!==t._name}).map(function(e){return n[e]}));return Object(W.r)().filter(function(e){return-1===r.indexOf(e.name)})};e.prototype.logMessageInConsole=function(e){this.isRUMOneDebuggingEnabled&&console.log(e)};Object.defineProperty(e.prototype,"isRUMOneDebuggingEnabled",{get:function(){try{if("sessionStorage"in window&&window.sessionStorage){var e=window.sessionStorage.enableRUMOneDebugging;return e&&"true"===e.toLowerCase()&&"undefined"!=typeof console&&!!console}}catch(e){}return!1},enumerable:!1,configurable:!0});e.prototype.logObjectForDebugging=function(e,t){if(this.isRUMOneDebuggingEnabled){var n="".concat(this._name," ").concat(e)+" : "+JSON.stringify(t);console.log(n)}};e.prototype.isCollected=function(e){return!re(this.getPerformanceDataPropertyValue(e))};e.prototype._normalizeControl=function(e){return"string"==typeof e?{controlId:e,ignoreForEUPL:!1}:e};e.prototype.setPerfDataTimer=function(){this.perfDataTimer=this.async.setTimeout(this.loopForDataCompleteness,this._config.checkInterval)};e.prototype.clearPerfDataTimer=function(){if(!re(this.perfDataTimer)){this.async.clearTimeout(this.perfDataTimer);this.perfDataTimer=null}};e.prototype._hookUnloadEvent=function(){window.addEventListener&&window.addEventListener("beforeunload",this._emergencyUpdateFunc)};e.prototype._unhookUnloadEvent=function(){window.removeEventListener&&window.removeEventListener("beforeunload",this._emergencyUpdateFunc)};e.prototype.categorizeResourceRequests=function(e,t){for(var n=[],r=0;r<e.length;r++){var i=e[r];t.from&&!t.from(i)||t.requestType&&!t.requestType(i)||n.push(i)}return n};e.prototype._setFCP=function(){var e=NaN,t=performance&&performance.getEntriesByType&&performance.getEntriesByType("paint");if(t&&t.length>0){var n=t.filter(function(e){return"first-contentful-paint"===e.name});if(n&&1===n.length)e=n[0].startTime;else{var r=t.filter(function(e){return"first-paint"===e.name});r&&1===r.length&&(e=r[0].startTime)}}isNaN(e)||(this._rumoneData.FCP=Math.round(e))};e.prototype.collectSupplementaryData=function(){this._setFCP();this.setAPIDataToRUMOne();this.collectMarks();this.writeServerUrl();this.setBrowseInfo();this.setReferrer();this._collectMemoryData();this._collectPageServerData();this._setAppInfo();this._setTestName();this._collectExperiments();this._rumoneData.DOMElements=document&&document.querySelectorAll("*").length;this._rumoneData.ServerMetrics=JSON.stringify(this.serverMetrics);this._rumoneData.EUPLBreakdown=JSON.stringify(this.euplBreakDown);this._rumoneData.TTIBreakdown=JSON.stringify(this.ttiBreakDown);this._normalizeTTI()};e.prototype._normalizeTTI=function(){var e;this._rumoneData.PageTransitionType===I.fullPageLoad&&((null===(e=this._rumoneData.ScenarioId)||void 0===e?void 0:e.indexOf("SPPages"))>-1||!X.t.isActivated("c930d25d-de79-434f-ba7b-c2fbf0aa9204","09/01/2022")&&this._rumoneData.ScenarioId.indexOf("VivaHome")>-1)&&(this._rumoneData.TTI=this._rumoneData.FCI||this._rumoneData.TTI)};e.prototype._collectExperiments=function(){var e=window.ODSP_EXPERIMENTS||{},t={};for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];r&&r._serverTime&&Date.now()-new Date(r._serverTime).getTime()<1296e6&&(t[n]=e[n])}this._rumoneData.SPExperiments=JSON.stringify(t)};e.prototype._setTestName=function(){var e=new G.t(location.href).getQueryParameter("perftest");e&&!this._rumoneData.TestName&&(this._rumoneData.TestName=e)};e.prototype.loopForDataCompleteness=function(){this.clearPerfDataTimer();if(!this._settings.waitOnAddingExpectedControl){if(this.isRUMOneDebuggingEnabled){this.logMessageInConsole("====================================================================");this.logObjectForDebugging("RUMONE: ",this._rumoneData);this.logObjectForDebugging("RUMOne DataState: ",String(this.getReadableDataState(this.dataState)));this.logObjectForDebugging("Controls: ",this.controls);this.logObjectForDebugging("API Performance Data: ",this.apis);this.logObjectForDebugging("Temp Data: ",this.tempData);this.logObjectForDebugging("EUPLBreakdown: ",this.euplBreakDown);this.logObjectForDebugging("TTIBreakdown: ",this.ttiBreakDown);this.logObjectForDebugging("ServerMetrics: ",this.serverMetrics);this.logMessageInConsole("====================================================================\n\n")}if(!this.isRunning())return;this._updateState()}this._checkTimeout();this.isRunning()&&this.setPerfDataTimer()};e.prototype._updateState=function(){switch(this.dataState){case Y.Incomplete:this.processControlRenderTime();this.readyToComputeEUPL()&&this.setEUPL();var e=this._getMissedControls();this._TTIMeasurementEnabled()&&this.isCollected("EUPL")&&0===e.length&&this._measureTTI();0===this._getMissedKeyMetrics().length&&0===e.length&&(this.dataState=Y.ReadyToUpload);break;case Y.ReadyToUpload:this._uploadPerfData({emergency:!1})}};e.prototype._checkTimeout=function(){if(this.isRunning()&&this.dataState!==Y.ReadyToUpload){var e=Date.now();if(!(this.dataState===Y.Incomplete&&e-this.dataStartTime<=this._config.error_timeout)){var t={reason:"TimeOut",details:{MissingMetrics:this._getMissedKeyMetrics(),MissingControls:this._getMissedControls()}};this._rumoneData.RUMOneError=JSON.stringify(t);this.dataState=Y.TimeOut;this._uploadPerfData({emergency:!1})}}};e.prototype._getMissedKeyMetrics=function(){for(var e=[],t=0;t<this.KeyMetrics.length;t++){re(this.getPerformanceDataPropertyValue(this.KeyMetrics[t]))&&e.push(this.KeyMetrics[t])}return e};e.prototype._getMissedControls=function(){return this.controls.filter(function(e){return!e.data||!e.data.renderTime})};e.prototype._emergencyUpload=function(){this.isRunning()&&this._uploadPerfData({emergency:!0})};e.prototype._uploadPerfData=function(e){this.writeControlDataToRUMOne();this.collectSupplementaryData();var t,n=e.emergency;this._rumoneData.EmergencyUploaded=!!n;try{if(this._settings.excludePageData){this.dataState=Y.Skipped;this.logMessageInConsole("Uploading perf data skipped as requested by the consumer")}else if(n||this.dataState===Y.ReadyToUpload||this.dataState===Y.TimeOut)if(this._loggingFunctions&&this._loggingFunctions.length>0)if(this._rumoneData){var r=this.getPerformanceData();this._loggingFunctions.forEach(function(e){e("RUMOne",r)});this.dataState=Y.Uploaded;if(this.isRUMOneDebuggingEnabled){this.logMessageInConsole("Final Data uploaded");this.logObjectForDebugging("RUMONE: ",r);this.logObjectForDebugging("RUMOne DataState: ",this.getReadableDataState(this.dataState))}}else console.error("Error: Uploading perf data called but perf data is not available");else console.error("Uploading perf data skipped as loggingFunc is not defined");else console.error("Error: Uploading perf data called with wrong data state ".concat(this.dataState))}catch(e){t="PerformanceLogger error writing RUMOne data: ".concat(e),"undefined"!=typeof console&&Boolean(console)&&console.error(t)}finally{if(!this.isRunning()){this._unhookUnloadEvent();this._apiTracker.undoInstrument()}}};e.prototype._TTIPolyfillEnabled=function(){return!!(this._settings.TTISettings&&this._settings.TTISettings.TTIPolyfillSettings&&this._settings.TTISettings.TTIPolyfillSettings.enabled)};e.prototype._FCIMeasurementEnabled=function(){var e=this._TTIPolyfillEnabled();return X.t.isActivated("CC5234AA-C7A5-4D4A-B6E5-52CC2A4E7078","11/4/2021")?e:!(!e||this._settings.TTISettings.FCIMeasurementSettings&&this._settings.TTISettings.FCIMeasurementSettings.disabled)};e.prototype._TTIMeasurementEnabled=function(){return this._TTIPolyfillEnabled()};e.prototype.getReadableDataState=function(e){for(var t in Y)if(e===Number(Y[t]))return t;return"NaN"};e.prototype.writeControlDataToRUMOne=function(){if(this.controls&&this.controls.length){var e=this.controls.slice(0).filter(function(e){return!!e.data&&!!e.data.renderTime&&!e.ignoreForEUPL});e.sort(function(e,t){return t.data.renderTime-e.data.renderTime});for(var t=0;t<10&&t<e.length;t++){this._logRUMOneData("Control".concat(t+1,"Id"),e[t].controlId);this._logRUMOneData("Control".concat(t+1,"RenderTime"),e[t].data.renderTime)}var n={};this.controls.slice(0).filter(function(e){return!!e.data&&!!e.data.renderTime&&!!e.ignoreForEUPL}).forEach(function(e){n[e.controlId]={data:e.data.renderTime,needFlatten:e.data.needFlatten}});Object.keys(n).length>0&&this.writeEUPLBreakdown(JSON.stringify(n),!0)}};e.prototype.processControlRenderTime=function(){for(var e=0,t=this.controls;e<t.length;e++){var n=t[e];n.data&&!n.data.renderTime&&n.data.renderTimeRequiredDataChecker(n.data)&&(n.data.renderTime=n.data.renderTimeCalculator(n.data))}};e.prototype.readyToComputeEUPL=function(){for(var e=this.controls.filter(function(e){return!e.ignoreForEUPL}),t=e.length>0,n=0,r=e;n<r.length;n++){var i=r[n];if(!i.data||!i.data.renderTime){t=!1;break}}return t};e.prototype.setEUPL=function(){if(!this.isCollected("EUPL")){for(var e=0,t=0,n=this.controls;t<n.length;t++){var r=n[t];!r.ignoreForEUPL&&r.data&&r.data.renderTime&&e<r.data.renderTime&&(e=r.data.renderTime)}this._rumoneData.EUPL=e;"function"==typeof this._EUPLComputedHandler&&this._EUPLComputedHandler(e)}};e.prototype.setBrowseInfo=function(){this._rumoneData.Browser=this._platformDetection.browserName+this._platformDetection.browserMajor;this._rumoneData.BrowserIsMobile=this._platformDetection.isMobile};e.prototype._collectMemoryData=function(){if(!this.isCollected("UsedJSHeapSize")&&"undefined"!=typeof performance&&void 0!==performance.memory){this._rumoneData.UsedJSHeapSize=performance.memory.usedJSHeapSize;this._rumoneData.TotalJSHeapSize=performance.memory.totalJSHeapSize}};e.prototype._collectPageServerData=function(){this.addServerMetrics({cpuDuration:window.g_cpuDuration,duration:window.g_duration,iisLatency:window.g_iisLatency,queryCount:window.g_queryCount,queryDuration:window.g_queryDuration,spPageContextDuration:window.g_pageContextDuration,deferred_cpuDuration:window.g_deferred_cpuDuration,deferred_duration:window.g_deferred_duration,deferred_iisLatency:window.g_deferred_iisLatency,deferred_queryCount:window.g_deferred_queryCount,deferred_queryDuration:window.g_deferred_queryDuration})};e.prototype.setAPIDataToRUMOne=function(){for(var e=0,t=0,n=[],r=0;r<this.apis.length;r++){var i=this.apis[r];if(i){e++;t+=i.duration;i.origin||(i.origin=new G.t(i.url).getHost());i.hostType=new G.t(window.location.href).getHost()===i.origin?K.own:K.cors;i.url;var o=Object(s.s)(i,["url"]);n.push(o)}}this._rumoneData.APICallCount=e;this._rumoneData.APICallDurationSum=t;this._rumoneData.APICalls=JSON.stringify(n)};e.prototype.setReferrer=function(){this._rumoneData.Referrer=this._processEUIIUrl(document.referrer)};e.prototype._setAppInfo=function(){if(!this._rumoneData.AppInfo){var e=window._spModuleLink;if(e){var t=e.buildNumber,n=e.manifestName,r=e.scenarioName,i=JSON.stringify({buildNumber:t,manifestName:n,scenarioName:r});this._rumoneData.AppInfo=i}}};e.prototype.getW3cTimingName=function(e){return"secureConnectionStart"!==e?"W3c"+e.charAt(0).toUpperCase()+e.slice(1):"W3cSecureConnectStart"};e.prototype._writeBreakdown=function(e,t,n){if(t)try{var r=JSON.parse(t);for(var i in r)r.hasOwnProperty(i)&&this._addBreakdown(e,i,r[i],n)}catch(e){this.logMessageInConsole("Failed to write EUPL breakdown data:"+e.toString())}};e.prototype._addBreakdown=function(e,t,n,r){if(t&&!re(n)){if(re(e[t])||r){var i=this._isBreakdownValue(n)?n.data:n;e[t]=i}this._isBreakdownValue(n)&&n.needFlatten&&(!this.isCollected(t)||r)&&this._logRUMOneData(t,n.data)}};e.prototype._readBreakdown=function(e,t){return t?e[t]:e};e.prototype._processEUIIUrl=function(e){var t=new y.e(e||"");return"".concat(t.authority,"/{ length: ").concat(t.path.length,", segments: ").concat(t.segments.length," }")};e.prototype._processLastNetworkUrl=function(e){var t=new y.e(e||"");if(t.authority.indexOf("lpcres")>0)return e;if(t.authority.indexOf("shell.cdn.office")>0)return e;var n=ne.exec(e),r="";n&&n.length>0&&(r="".concat(n[0]));return"".concat(t.authority).concat(r)};e.rumOneLogger=void 0;e.Loggers={};e._markers={};return e})();function oe(e,t){var n;return t in e?((n={})[t]=Math.round(e[t]),n):{}}var ue=n(52),ae=n(199),fe=n(180),le=(function(e){Object(s.r)(t,e);function t(n){var r=this,i=n.errorData,o=void 0===i?n.innerError instanceof t&&n.innerError.errorData||{status:0}:i,u=o.message,a=void 0===u?void 0:u,f=o.correlationId,l=void 0===f?void 0:f,c=o.code,h=void 0===c?void 0:c,p=Object(s.s)(o,["message","correlationId","code"]),d="object"==typeof a?a?"string"==typeof a.value?a.value:JSON.stringify(a):"".concat(a):a,v=Object(s.e)(Object(s.e)(Object(s.e)(Object(s.e)(Object(s.e)({},"string"==typeof l?{correlationId:l}:{}),"string"==typeof h?{code:h}:{}),"string"==typeof d?{message:d}:{}),n),{extraData:Object(s.e)(Object(s.e)({},n.extraData||{}),{hasAuthChallenge:!!p.authenticate,status:p.status,infected:p.infected,groupThrottle:p.groupThrottle,statusText:p.statusText})});(r=e.call(this,v)||this).name="GetDataError";r.errorData=o;for(var m=0,g=Object.keys(p);m<g.length;m++){var y=g[m];r[y]=p[y]}return r}return t})(ue.e);var ce=(function(){function e(e,t,n){this._request=e;this._url=t;this._webAbsoluteUrl=n&&n.webAbsoluteUrl;this._isCanaryRequest=n&&n.isCanaryRequest}e.prototype.getSourceUrl=function(){return this._url};e.prototype.getXSPOErrorMessage=function(){return this.getResponseHeader("x-spo-errormessage")};e.prototype.getAllResponseHeaders=function(){return this._request.getAllResponseHeaders()};e.prototype.getCorrelationId=function(){return this.getResponseHeader("SPRequestGuid")};e.prototype.getServerDuration=function(){return this._getNumberHeader("SPClientServiceRequestDuration")};e.prototype.getSQLRT=function(){return this._getNumberHeader("SPSQLQueryCount")};e.prototype.getGroupThrottle=function(){return this.getResponseHeader("SPGroupThrottle")};e.prototype.getAuthErrorType=function(){return this.getResponseHeader("x-ms-diagnostics")};e.prototype.getMSCorrelationVector=function(){return this.getResponseHeader("MS-CV")};e.prototype.getServiceWorkerDataSourceHeader=function(){return this.getResponseHeader("X-SERVICEWORKER-DATA-SOURCE")};e.prototype.getServiceWorkerFetchInfoFromHeader=function(){return this.getResponseHeader("X-ServiceWorkerFetchInfo")};e.prototype.getRetryAfterHeader=function(){return this._getNumberHeader("Retry-After")};e.prototype.getStatus=function(){var e=-1;try{e=this._request.status}catch(e){}return"number"==typeof e?e:-1};e.prototype.getAuthenticationRedirect=function(){return this.getResponseHeader("X-Forms_Based_Auth_Required")};e.prototype.getFBAError=function(){return this.getResponseHeader("X-MSDAVEXT_Error")};e.prototype.getAuthenticateHeader=function(){return this.getResponseHeader("WWW-Authenticate")};e.prototype.getResponseType=function(){return this._request.responseType};e.prototype.getResponseText=function(){return this._request.responseType&&"text"!==this._request.responseType?this._request.response:this._request.responseText};e.prototype.getErrorResponseText=function(){if("blob"===this._request.responseType){return{status:this._request.status,statusText:this._request.statusText,infected:!!this.getResponseHeader("x-virus-infected"),authenticate:this.getResponseHeader("WWW-Authenticate")}}return this.getResponseText()};e.prototype.parseError=function(){var e=this,t=new h.e;this._request.responseType&&"text"!==this._request.responseType?"blob"===this._request.responseType?(function(e){var t,n=new h.e,r=function(){if(t.result){var e=void 0;try{e=JSON.parse(t.result);n.complete(e)}catch(e){n.complete({message:"Unable to parse blob result."})}}},i=function(){n.complete({message:"Unable to read blob error response."})};try{(t=new FileReader).addEventListener("load",r);t.addEventListener("error",i);t.readAsText(e)}catch(e){i()}return n.getPromise().then(function(e){if(t){t.removeEventListener("load",r);t.removeEventListener("error",i)}return e})})(this._request.response).then(function(n){var r={data:n,status:e.getStatus(),statusText:e._request.statusText,infected:!!e.getResponseHeader("x-virus-infected"),authenticate:e.getResponseHeader("WWW-Authenticate")};t.complete(r)}):t.complete(this._request.response):t.complete(this._request.responseText);return t.getPromise()};e.prototype.getValue=function(t){var n;switch(t){case e.DataValueKeys.SourceURL:n=this.getSourceUrl();break;case e.DataValueKeys.CorrelationId:n=this.getCorrelationId();break;case e.DataValueKeys.Status:n=this.getStatus();break;case e.DataValueKeys.AuthenticationRedirect:n=this.getAuthenticationRedirect();break;case e.DataValueKeys.ResponseText:n=this.getResponseText();break;case e.DataValueKeys.ErrorResponseText:n=this.getErrorResponseText()}return n};e.prototype.getRedirectUrl=function(){var e=X.t.isActivated("3FBEEB53-441C-4A84-82FC-C8221FCC50D8","02/11/2021","redirect url when access denied");if(this._isCanaryRequest)return 403===this.getStatus()?this.shouldRedirectToErrorCustomPromptLocation()?this.getRedirectToErrorCustomPromptLocation():this.getRedirectLoginPageUrl():this.getAccessDeniedRedirectUrl();if(403===this.getStatus()){if(this.shouldRedirectToErrorCustomPromptLocation())return this.getRedirectToErrorCustomPromptLocation();if(!e)return this.getRedirectLoginPageUrl()}else if(401===this.getStatus()){if(this.shouldRedirectToErrorCustomPromptLocation())return this.getRedirectToErrorCustomPromptLocation();if(!e)return this.getRedirectLoginPageUrl()}};e.prototype.getRedirectLoginPageUrl=function(){var e,t=this.getAuthenticationRedirect();if(t){var n=new G.t(t);n.setQueryParameter("ReturnUrl",A.e.encodeURIComponent(window.location.href));e=n.toString()}return e};e.prototype.getAccessDeniedRedirectUrl=function(){var e;if(this._webAbsoluteUrl){var t=this._webAbsoluteUrl+"/_layouts/15/AccessDenied.aspx";if(t){var n=new G.t(t);n.setQueryParameter("Source",A.e.encodeURIComponent(window.location.href));n.setQueryParameter("Type","list");n.setQueryParameter("correlation",A.e.encodeURIComponent(this.getCorrelationId()));e=n.toString()}}return e};e.prototype.getRedirectToErrorCustomPromptLocation=function(){var e=this.getResponseHeader("X-SPO-ErrorCustomPromptLocation"),t=new G.t(e);t.setQueryParameter("ReturnUrl",window.location.href);return t.toString()};e.prototype.shouldRedirectToErrorCustomPromptLocation=function(){var e=this.getResponseHeader("X-SPO-ErrorCode"),t=this.getResponseHeader("sharepointerror");return"9.3"===e||"-2130575129"===t};e.prototype.getResponseHeadersDictionary=function(){var e={},t=this.getAllResponseHeaders();if(t){var n=t.trim().split(/[\r\n]+/);n&&n.length>0&&n.forEach(function(t){var n=t.split(": "),r=n.shift(),i=n.join(": ");e[r]=i})}this.getResponseHeadersDictionary=function(){return e};return e};e.prototype.getResponseHeader=function(e){var t=this.getResponseHeadersDictionary();return t[e.toLowerCase()]||t[e]||this._request.getResponseHeader(e)};e.prototype._getNumberHeader=function(e){var t=this.getResponseHeader(e),n=Number(t);return isNaN(n)?void 0:n};e.DataValueKeys={SourceURL:"SourceUrl",CorrelationId:"CorrelationId",Status:"Status",AuthenticationRedirect:"AuthenticationRedirect",ResponseText:"ResponseText",ErrorResponseText:"ErrorResponseText",GroupThrottle:"GroupThrottle"};return e})(),he=n(110),pe=n(75);var de=(function(){function e(e){void 0===e&&(e={});var t;this._scope=new he.e;this._events=this._scope.attach(new pe.e(this));var n=e.webAbsoluteUrl||e.webUrl;this._webServerRelativeUrl=e.webServerRelativeUrl||n&&new G.t(n).getPath();"/"===this._webServerRelativeUrl&&(this._webServerRelativeUrl="");if(X.e.isActivated("5F6AAA43-30D4-4E2C-B9CF-76C77A7F48DE","10/04/2022","Always use token provider to fetch tokens"))if(n){this._webAbsoluteUrl=n;this._alwaysGetDigest=!0}else this._alwaysGetDigest=!1;else this._alwaysGetDigest=null!==(t=e.alwaysGetDigest)&&void 0!==t&&t;this._needsRequestDigest=!1!==e.needsRequestDigest;this._needsRequestDigest&&this._tryLoadDigest(e.formDigest);this._requestCanaryForAuth=!1;this._engagement=e.engagement;this._operationName=e.operationName}e._isValidFormDigest=function(e){return e&&e.serverTime&&Date.now()-new Date(e.serverTime).getTime()<1e3*(e.formDigestTimeoutSeconds-60)};e.prototype.dispose=function(){this._scope.dispose()};e.prototype.abort=function(){if(this._currentRequest){var e=this._currentRequest;e.isCancelled=!0;e.abort();this._currentRequest=void 0}};e.prototype.isRequestActive=function(){return!!this._currentRequest};e.prototype.getServerDataFromUrl=function(e){var t=this,n=e.url,r=e.successCallback,i=e.failureCallback,s=e.uploadProgressCallback,o=e.additionalPostData,u=e.isRest,a=void 0===u||u,f=e.method,l=void 0===f?"POST":f,c=e.withCredentials,h=e.additionalHeaders,p=e.contentType,d=e.noRedirect,v=e.responseType,m=e.needsRequestDigest,g=void 0===m?this._needsRequestDigest:m,y=(new Date).toISOString(),b=new XMLHttpRequest;b.open(l,n,!0);"boolean"==typeof c&&(b.withCredentials=c);v&&(b.responseType=v);p?b.setRequestHeader("Content-Type",p):a?b.setRequestHeader("Content-Type","application/json;odata=verbose"):b.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var w=!1;if(h)for(var E in h)if(E){b.setRequestHeader(E,h[E]);"accept"===E.toLowerCase()&&(w=!0)}w||b.setRequestHeader("accept","application/json;odata=verbose");this._currentRequest=b;var S=function(e){g&&e&&b.setRequestHeader("x-requestdigest",e);t._events.on(b,"readystatechange",function(){t._onReadyStateChange(b,n,r,i,d,y)});s&&b.upload&&t._events.on(b.upload,"progress",function(e){s(e)});b.send(o)};g?this._ensureRequestDigest(S,i):S()};e.prototype.ensureRequestDigest=function(e,t){this._ensureRequestDigest(e,t)};e.prototype._ensureRequestDigest=function(t,n){var r=e._formDigests[this._webServerRelativeUrl];!this._alwaysGetDigest&&e._isValidFormDigest(r)?t(r.formDigestValue):this._ensureRequestDigestWorker(t,n)};e.prototype._ensureRequestDigestWorker=function(t,n){var r=this,i=new Date,s=new e({needsRequestDigest:!1,webServerRelativeUrl:this._webServerRelativeUrl,webUrl:void 0});t||(s._requestCanaryForAuth=!0);var o=this._webAbsoluteUrl||this._webServerRelativeUrl;if("string"==typeof o){e._requestDigestPromise||(e._requestDigestPromise=new c.t(function(u,a){s.getServerDataFromUrl({url:G.t.concatenate(o,"/_api/contextinfo"),successCallback:function(t){var n=t.getResponseText(),s=JSON.parse(n).d.GetContextWebInformation;e._formDigests[r._webServerRelativeUrl]={serverTime:i.toISOString(),formDigestValue:s.FormDigestValue,formDigestTimeoutSeconds:s.FormDigestTimeoutSeconds-60,updateFormDigestPageLoaded:new Date};u(e._formDigests[r._webServerRelativeUrl].formDigestValue);e._requestDigestPromise=void 0},failureCallback:function(r,i){t?t(void 0):n&&n(r,i);a(void 0);e._requestDigestPromise=void 0},method:"POST",noRedirect:!!n})}));e._requestDigestPromise.then(function(e){t&&t(e);return e})}else n&&n(void 0,new ue.e({code:"MissingWebForDigestAuth",isExpected:!1}))};e.prototype._onReadyStateChange=function(t,n,r,i,s,o){if(4===t.readyState){this._currentRequest=void 0;this._events.off(t);t.upload&&this._events.off(t.upload);if((c=t)&&c.isCancelled)i(void 0,new ue.e({code:"RequestAborted",isExpected:!0}));else if((function(e){try{if(4===e.readyState&&(void 0===e.status||0===e.status))return!1}catch(e){return!1}return!0})(t)){var u=new ce(t,n,{webAbsoluteUrl:this._webAbsoluteUrl||this._webServerRelativeUrl,isCanaryRequest:this._requestCanaryForAuth}),a=u.getStatus(),f=!s&&u.shouldRedirectToErrorCustomPromptLocation();if(this._requestCanaryForAuth){this._requestCanaryForAuth=!1;if(403===a){var l=u.getRedirectLoginPageUrl();try{f?window.location.href=u.getRedirectToErrorCustomPromptLocation():i(u)}catch(e){}l&&!s&&(window.location.href=l)}else{l=u.getAccessDeniedRedirectUrl();try{i(u)}catch(e){}if(l&&!s){this._engagement&&this._engagement.logData({name:"AccessDeniedRedirect",isIntentional:!1,extraData:{originalOperation:this._operationName||""}});window.location.href=l}}return}if(200===a||201===a||204===a){r(u);return}if(403===a){e._requestDigestPromise=void 0;s?this._ensureRequestDigestWorker(void 0,function(e,t){return i(u,t)}):f?window.location.href=u.getRedirectToErrorCustomPromptLocation():this._ensureRequestDigestWorker(void 0);return}401===a&&f&&(window.location.href=u.getRedirectToErrorCustomPromptLocation());i(u)}else i(void 0,new ue.e({code:"NoConnection",isExpected:!0}));var c}};e.prototype._tryLoadDigest=function(t){if(e._isValidFormDigest(t))e._formDigests[this._webServerRelativeUrl]=t;else{var n=e._formDigests[this._webServerRelativeUrl];e._isValidFormDigest(t)&&(!e._isValidFormDigest(n)||n&&new Date(n.serverTime).getTime()<new Date(t.serverTime).getTime())&&(e._formDigests[this._webServerRelativeUrl]=t)}};e._formDigests={};e._requestDigestPromise=void 0;return e})();function ve(e){var t=e.options,n=t.url,r=t.authToken,i=t.telemetryHandler,o=t.useExactAuthToken,u=t.method,a=t.additionalHeaders,f=e.dataSyncClient,l=e.aadUserId,h=e.getData,p=function(){return h({url:n,telemetryHandler:i,authToken:r,useExactAuthToken:o})};if(!l)return p();var d=function(e){var t=(function(e,t){return function(n,r){var i=n.eventData,o=i.extraData,u={performanceEntry:o&&o.performanceEntry,httpStatus:o&&o.HttpStatus,correlationId:o&&o.CorrelationId,succeeded:i&&i.resultType===j.e.Success||!1,resultCode:i&&i.resultCode,endpoint:r},a=t&&t(n),f=e.onRequestComplete(u);o.dataSyncQos=e.getQosInfo();return Object(s.e)(Object(s.e)({},a||{}),{eventData:Object(s.e)(Object(s.e)({},a?a.eventData:i),{extraData:Object(s.e)(Object(s.e)({},a?a.eventData.extraData:i.extraData),e.getQosInfo())}),canRetry:f&&(!a||a.canRetry)})}})(e,i);return e.getData({url:n,method:u,additionalHeaders:a},function(e){return h({url:e.url,authToken:e.authToken,telemetryHandler:function(n){return t(n,e)},useExactAuthToken:!0})},p)};return c.t.resolve(f).then(function(e){return e?d(e):p()})}var me=n(144),ge=n(267);function ye(e){var t=e.options,n=e.webAbsoluteUrl,r=e.apiEvent,i=e.tokenProvider,o=e.getData,u=e.qosName,a=t.url,f=new ae.e(a),l="".concat(f.authority,"/{ length: ").concat(f.path.length,", segments: ").concat(f.segments.length," }"),h=function(e,t){if(!i.getAuthToken)return c.t.resolve({authToken:void 0});var n=new r({name:"".concat(u,".getAuthToken").concat(t?".retry":""),url:l});return c.t.resolve(i.getAuthToken(e)).then(function(e){if(!e||"string"==typeof e){n.end({resultType:j.e.Success,resultCode:e?"tokenAuth.string":"cookieAuth.string"});return{authToken:e}}n.end({resultType:j.e.Success,resultCode:e.authToken?"tokenAuth":"cookieAuth",extraData:{AuthCorrelationId:e.correlationId,AuthExpiration:e.expiresOn}});return e}).catch(function(e){n.end(Object(ge.e)(e));return c.t.reject(e)})},p=function(e,t){if(!i.getFormDigest)return c.t.resolve(void 0);var n=new r({name:"".concat(u,".getAuthToken").concat(t?".retry":""),url:l});return c.t.resolve(i.getFormDigest(e)).then(function(e){n.end({resultType:j.e.Success,resultCode:e?"newDigest":"sameDigest"});return e}).catch(function(e){n.end(Object(ge.e)(e));return c.t.reject(e)})};if(!h&&!p)return o({url:a});var d={url:a,webAbsoluteUrl:n},v={url:a,webAbsoluteUrl:n};return h(d,!1).then(function(e){return e.authToken?e:p(v,!1).then(function(t){return e})}).then(function(e){return o({url:a,authToken:e.authToken,qosExtraData:{AuthCorrelationId:e.correlationId,AuthExpiration:e.expiresOn}}).catch(function(t){if(e.authToken){var n=void 0;we(t)?n={claimsChallenge:{authToken:e.authToken,claims:be(t),error:t}}:Ee(t)&&(n={expiration:{authToken:e.authToken,error:t}});if(n)return h(Object(s.e)(Object(s.e)({},d),n),!0).then(function(n){return n.authToken&&n.authToken!==e.authToken?o({url:a,authToken:n.authToken,qosExtraData:{AuthCorrelationId:n.correlationId,AuthExpiration:n.expiresOn}}):c.t.reject(t)})}if(i.getFormDigest){var r=void 0;we(t)?r={claimsChallenge:{claims:be(t),error:t}}:Ee(t)&&(r={expiration:{error:t}});if(r)return p(Object(s.e)(Object(s.e)({},v),r),!0).then(function(e){return o({url:a})})}return c.t.reject(t)})})}function be(e){var t=e.authenticate;if(t){var n=t.indexOf('claims="');if(n>-1){var r=t.indexOf('"',n+'claims="'.length);if(r>-1){var i=t.slice(n+'claims="'.length,r);return X.e.isActivated("93E9F77D-7B3B-4760-B58F-1154E9E530ED","06/02/2022","Decode claims from base64")?i:atob(i)}}}}function we(e){var t=e.authenticate;return!!(t&&"Bearer"===t.slice(0,"Bearer".length)&&t.indexOf('error="insufficient_claims"')>-1)}function Ee(e){var t=e.code;return"3000002,invalid_client"===t||"10013"===t||"917656"===t}var Se="undefined"!=typeof window?window:void 0,xe=Se&&Se.performance;var Te=(function(){function e(e,t){var n,r,i,s,o,u,a,f;this._pageContext=t?t.pageContext:e.pageContext;this._tokenProvider=null!==(n=null==t?void 0:t.tokenProvider)&&void 0!==n?n:null===(r=this._pageContext)||void 0===r?void 0:r.tokenProvider;this._dataSyncClient=null!==(i=null==t?void 0:t.dataSyncClient)&&void 0!==i?i:null===(s=this._pageContext)||void 0===s?void 0:s.dataSyncClient;this._qosName=e.qosName;this._apiEvent=null!==(o=null==t?void 0:t.apiEvent)&&void 0!==o?o:H.t;this._engagement=null!==(u=null==t?void 0:t.engagement)&&void 0!==u?u:B.e;this._normalizeErrors=!!e.normalizeErrors;this._getDataWithTokenProvider=null!==(a=null==t?void 0:t.getDataWithTokenProvider)&&void 0!==a?a:ye;this._getDataWithSyncClient=null!==(f=null==t?void 0:t.getDataWithSyncClient)&&void 0!==f?f:ve;this._offlineDetection=null==t?void 0:t.offlineDetection}e.parseJSON=function(e){return e&&JSON.parse(e)||void 0};e.prototype.getData=function(t){var n=this,r=t.parseResponse,i=void 0===r?e.parseJSON:r,o=t.qosExtraData,u=t.additionalPostData,a=void 0===u?"":u,f=t.contentType,l=t.method,p=void 0===l?"POST":l,d=t.maxRetries,v=void 0===d?0:d,m=t.responseType,g=t.onUploadProgress,y=t.timeout,b=t.noTimeoutInLastRetry,w=void 0!==b&&b,E=t.webAbsoluteUrl,S=this._pageContext,x=this._tokenProvider,T=this._getDataWithTokenProvider,N=this._getDataWithSyncClient,C=[];this._qosName&&C.push(this._qosName);t.qosName&&C.push(t.qosName);var k=C.join("."),L=function(e){var r=e.url,u=e.telemetryHandler,l=e.authToken,d=e.useExactAuthToken,b=void 0!==d&&d,N=!0,C=new ae.e(r),L="".concat(C.authority,"/{ length: ").concat(C.path.length,", segments: ").concat(C.segments.length," }"),A=function(e){var l=e.authToken,d=e.qosExtraData,x=t.crossSiteCollectionCall,T=void 0!==x&&x,C=t.noRedirect,A=void 0!==C&&C,O=t.needsRequestDigest,M=void 0===O||O,_=Object(s.e)(Object(s.e)({},t.additionalHeaders),X.e.isActivated("3404B5AF-0FCD-496E-AE1A-7249248BACFE","10/5/2021","Send CollectSPPerfMetrics header for all SP data requests")?{}:{CollectSPPerfMetrics:"SPSQLQueryCount"});if(l){var D=!1;X.t.isActivated("589c6b39-fbce-42b5-bff1-125e13e2367a","06/09/2021","check if auth token has auth header already, if yes, use exact auth token")||me.e.isFeatureEnabled({ECS:86137})||l.split(" ").length>1&&(D=!0);var P=b||D?l:"Bearer ".concat(l),H=!1;for(var B in _)B&&"authorization"===B.toLowerCase()&&(H=!0);H||(_.Authorization=P);T=!0;M=!1;A=!0}var F,I,q=new de(Object(s.e)(Object(s.e)({},S?Object(s.e)(Object(s.e)({webServerRelativeUrl:S.webServerRelativeUrl},X.e.isActivated("5F6AAA43-30D4-4E2C-B9CF-76C77A7F48DE","10/04/2022","Always use token provider to fetch tokens")?{webAbsoluteUrl:T?S.webAbsoluteUrl:E}:{webAbsoluteUrl:E||S.webAbsoluteUrl,alwaysGetDigest:T}),{formDigest:{serverTime:S.serverTime,updateFormDigestPageLoaded:S.updateFormDigestPageLoaded,formDigestValue:S.formDigestValue,formDigestTimeoutSeconds:S.formDigestTimeoutSeconds}}):{}),{needsRequestDigest:M,engagement:n._engagement,operationName:n._qosName})),R=Se&&Se.location&&new ae.e(Se.location.href).authority,U=new ae.e(r).authority,z=se.getRUMOneLogger(),W=Date.now();z&&(Boolean(z.readTempData("appDataFetchStart"))||z.saveTempData("appDataFetchStart",W));return(function(e){var t,n=e.onExecute,r=e.onCancel,i=e.timeout,s=e.canRetry,o=e.noTimeoutInLastRetry,u=0,a=Math.max(e.maxRetries,0),f=function(){var e=new c.t(n,function(){r(u>=a||!s())});return i&&(!o||u<a)?c.t.timeout(i,e):e};t=u<a?(function(e){var t,n=e.adjustRetries,r=e.async,i=e.beforeRetry,s=e.callback,o=e.canRetry,u=void 0===o?function(){return!0}:o,a=e.delay,f=e.resetAttemptsOnRestart,l=e.retries,c=e.shouldRestart,p=0,d=new h.e(function(){t.cancel()});function v(e){if(c&&c()){f&&(p=0);g()}else d.complete(e)}function m(e){n&&(l=n(e));if(p<l&&u(e)){p++;i&&i();"number"==typeof a&&r?r.setTimeout(g,a):g()}else d.error(e)}function g(){(t=s()).then(v,m)}g();return d.getPromise()})({canRetry:s,retries:a,callback:f,beforeRetry:function(){u++}}):f();return t})({timeout:y,onExecute:function(e,t){var c=function(a,f){return function(c){var h=c.getResponseText();I=c.getServiceWorkerDataSourceHeader();var p,v,g,y,b=Object(fe.e)(r,f),w=Object(s.e)(Object(s.e)(Object(s.e)(Object(s.e)({},o||{}),{needsRequestDigest:M,hasAuthToken:!!l,isCrossOrigin:!!R&&R!==U,CorrelationId:c.getCorrelationId()}),d||{}),{HttpStatus:c.getStatus(),serviceWorkerDataSource:I||void 0,rawRequestDuration:b.duration,performanceEntry:JSON.stringify(b),serviceWorkerFetchInfo:c.getServiceWorkerFetchInfoFromHeader()||void 0,SQLRT:c.getSQLRT(),ServerDuration:c.getServerDuration()}),E=!1;try{!(function(e,t){return"blob"===e&&t&&"object"==typeof t})(m,h)?v=i(h,c):g=h;E=!0}catch(e){p=e;y={resultType:j.e.Failure,resultCode:"InvalidJSON",error:"object"==typeof e?JSON.stringify(e):e,extraData:w}}y||(y={resultType:j.e.Success,extraData:w});if(u){y=u({response:v,eventData:y,serverData:c}).eventData}a.end(y);if(E)try{e(g||v)}catch(e){}else t(n._normalizeErrors?new le({code:"-1,parse_response",innerError:p,errorData:{status:c.getStatus()}}):void 0);q=void 0}},h=function(e,i){return function(a,f){var c=Object(fe.e)(r,i),h=Object(s.e)(Object(s.e)({},o||{}),{needsRequestDigest:M,hasAuthToken:!!l,isCrossOrigin:!!R&&R!==U,rawRequestDuration:c.duration,performanceEntry:JSON.stringify(c)}),p="undefined"!=typeof navigator&&!1===navigator.onLine;n._offlineDetection&&(p=n._offlineDetection.offline);if(a){var d=a.getCorrelationId(),v=a.getGroupThrottle(),m=a.getMSCorrelationVector(),g=a.getStatus(),y=a.getAuthErrorType(),b=a.getFBAError();h=Object(s.e)(Object(s.e)({},h),{CorrelationId:d,HttpStatus:g,GroupThrottle:v,MSCorrelationVector:m,AuthErrorType:y});var w=j.e.Failure;if(401===g&&b||403===g||404===g||429===g||503===g||-1===g||0===g&&p){N=!1;w=j.e.ExpectedFailure}var E=function(r){var i,o=void 0;if("object"==typeof r&&"number"==typeof r.status)o=r;else if("string"==typeof r){var f=void 0;try{f=JSON.parse(r)}catch(e){}i=(function(e){var t=e.authDiagnostics,n=e.fbaHeaderError;if(t)try{var r=/(\d+)(?:;reason="([^"]+?)")?(?:;category="([^"]+?)")?/.exec(t),i=r[1],s=void 0===i?"-1":i,o=r[2],u=void 0===o?"":o,a=r[3],f=void 0===a?"unknown":a,l=void 0;switch(Number(s)){case 3e6:case 3000003:case 3000006:case 3001003:case 3001004:case 3001005:case 3002e3:case 3004009:case 3004010:case 3003e3:l=!0;break;default:l=!1}return new ue.e({code:"".concat(s,",").concat(f),message:u,isExpected:l})}catch(e){return new ue.e({code:"-1,Unknown",innerError:e})}if(n)try{var c=/(\d+);\s+(.+)/.exec(n),h=c[1],p=(s=void 0===h?"-1":h,c[2]);u=void 0===p?"":p;return new ue.e({code:"".concat(s),message:u,isExpected:!0})}catch(e){return new ue.e({code:"-1,Unknown",innerError:e})}})({authDiagnostics:y,fbaHeaderError:b});f&&(o=f.error_description?{code:"-1,".concat(f.error||"Unknown"),message:f.error_description}:"string"==typeof f.error?{message:f.error}:f.error||f["odata.error"]||{responseData:f})}(o=o||{}).status=g;o.retryAfter=a.getRetryAfterHeader();var l=a.getXSPOErrorMessage();if(!X.t.isActivated("9075af7b-b0a1-433c-91d3-eeff1701c557","05/26/2022","Add x-spo-errormessage response header value to errorData")&&l){o.code="XSPOErrorMessage";o.message=l}var c=o["@error.redirectUrl"],p=a.getRedirectUrl()||c;p&&(w=j.e.ExpectedFailure);o.redirectUrl=p;o.authenticate=a.getAuthenticateHeader();d&&(o.correlationId=d);v&&(o.groupThrottle=v);"-1,policy_enforced"===o.code&&(w=j.e.ExpectedFailure);i&&i.isExpected&&(w=j.e.ExpectedFailure);o.code=i&&i.code||o.code||"Unknown";var m="[".concat(g.toString(),"] ").concat(o.code),E=JSON.stringify(o),S={resultType:w,error:E,resultCode:m,extraData:h};if(u){var x=u({eventData:S,errorData:o,serverData:a}),T=x.eventData,C=x.canRetry;S=T;!0!==C&&!1!==C||(N=C)}e.end(S);t(n._normalizeErrors?new le(Object(s.e)({errorData:o,innerError:i},S.resultType===j.e.ExpectedFailure?{isExpected:!0}:{})):o)},S=a.getResponseType();if(S&&"text"!==S)a.parseError().then(E);else{E(a.getResponseText())}}else{var x="Unknown",T=!0,C=0;if(f&&f instanceof ue.e){x=f.code;T=f.isExpected;C=-1}!p||"NoConnection"!==x&&"Unknown"!==x||(x="Offline");var k={status:C,code:x},L={resultType:T?j.e.ExpectedFailure:j.e.Failure,resultCode:x,extraData:h};if(u){L=u({eventData:L,errorData:k}).eventData}e.end(L);t(n._normalizeErrors?new le({errorData:k,innerError:f}):k)}}};(function(){var e=F=new n._apiEvent({url:L,name:k}),t=xe&&xe.now();q.getServerDataFromUrl({url:r,successCallback:c(e,t),failureCallback:h(e,t),uploadProgressCallback:g,additionalPostData:a,method:p,additionalHeaders:_,contentType:f,withCredentials:!l&&void 0,noRedirect:A,responseType:m,needsRequestDigest:M})})()},maxRetries:v,noTimeoutInLastRetry:w,canRetry:function(){return N},onCancel:function(e){if(q){q.abort();e&&q.dispose()}}}).then(function(e){q&&q.dispose();return e},function(e){q&&q.dispose();!F.endTime&&c.t.isCanceled(e)&&F.end({resultCode:"Canceled",resultType:j.e.ExpectedFailure});return c.t.reject(e)})};if(l)return c.t.resolve(l).then(function(e){return A({url:r,authToken:e})});if(x)return T({apiEvent:n._apiEvent,getData:A,options:{url:r,authToken:t.authToken,qosExtraData:t.qosExtraData},webAbsoluteUrl:!X.e.isActivated("5F6AAA43-30D4-4E2C-B9CF-76C77A7F48DE","10/04/2022","Always use token provider to fetch tokens")&&E||S&&S.webAbsoluteUrl,qosName:k,tokenProvider:x});if(S){if(S.getAuthToken)return c.t.resolve(S.getAuthToken()).then(function(e){return A({url:r,authToken:e})});if(S.authToken)return c.t.resolve(S.authToken).then(function(e){return A({url:r,authToken:e})})}return A({url:r})},A={authToken:t.authToken,telemetryHandler:t.telemetryHandler,url:t.url,useExactAuthToken:t.useExactAuthToken,method:t.method,additionalHeaders:t.additionalHeaders};return this._dataSyncClient&&!t.skipSyncClient?N({options:A,aadUserId:null==S?void 0:S.aadUserId,dataSyncClient:this._dataSyncClient,getData:L}):L(A)};return e})();var Ne,Ce=Te,ke=(function(){function e(e,t){var n=this._pageContext=t.pageContext,r=t.tokenProvider,i=t.dataRequestorType,o=void 0===i?(function(e){Object(s.r)(t,e);function t(t){return e.call(this,t,{pageContext:n,tokenProvider:r})||this}return t})(Ce):i,u=e.dataSourceName,a=void 0===u?"DataSource":u;this.dataRequestor=new o({qosName:a})}e.prototype.getDataSourceName=function(){return this.dataSourceName};e.prototype.needsRequestDigest=function(e){return!0};e.prototype.getData=function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){void 0===i&&(i="POST");var m=e(),g=r&&r(),y=this.needsRequestDigest(m);return this.dataRequestor.getData({url:m,parseResponse:t,qosName:n,additionalPostData:g,method:i,additionalHeaders:s,contentType:o,maxRetries:u,noRedirect:a,crossSiteCollectionCall:f,telemetryHandler:l,qosExtraData:c,needsRequestDigest:y,authToken:h,webAbsoluteUrl:p,useExactAuthToken:d,skipSyncClient:v})};return e})(),Le=n(428);(function(e){e[e.unknown=0]="unknown";e[e.prefetch=1]="prefetch";e[e.hostapp=2]="hostapp";e[e.api=3]="api"})(Ne||(Ne={}));var Ae,Oe=5,Me=6,_e=9;(function(e){e[e.none=0]="none";e[e.view=1]="view";e[e.edit=2]="edit";e[e.owner=3]="owner";e[e.review=6]="review";e[e.restrictedview=7]="restrictedview";e[e.submit=8]="submit";e[e.manageList=9]="manageList"})(Ae||(Ae={}));var De={authFailure:1,serverFailure:2,invalidItem:3,invalidWebAbsoluteUrl:4,generic:5,objectNotSupported:6,invalidEmail:7,linkNoLongerAvailable:8},Pe=n(386);var He,Be,je=Pe.e;(function(e){e[e.uninitialized=0]="uninitialized";e[e.direct=1]="direct";e[e.organizationView=2]="organizationView";e[e.organizationEdit=3]="organizationEdit";e[e.anonymousView=4]="anonymousView";e[e.anonymousEdit=5]="anonymousEdit";e[e.flexible=6]="flexible";e[e.requestAccess=7]="requestAccess"})(He||(He={}));(function(e){e[e.specificPeople=0]="specificPeople";e[e.organization=1]="organization";e[e.anyone=2]="anyone";e[e.existing=3]="existing";e[e.specificPeopleFlex=4]="specificPeopleFlex";e[e.customLabeledSpecificPeople=5]="customLabeledSpecificPeople"})(Be||(Be={}));var Fe,Ie=Be,qe=-1,Re=0,Ue=1,ze=2,We=3,Xe=0,Ve=1,$e=2,Je=n(379),Ke=0,Qe=1,Ge=2,Ye=3;X.t.isActivated("F9624ACA-9230-4329-9616-969638C4D4CB","05/08/2022","Include Personal Site Id in generated Server Url for Freemium lists"),"undefined"!=typeof window&&Je.e.isFeatureEnabled({ODB:1737});(function(e){e[e.FooterEnabled=2]="FooterEnabled";e[e.MegaMenuEnabled=128]="MegaMenuEnabled";e[e.FooterEmphasis0=256]="FooterEmphasis0";e[e.FooterEmphasis1=512]="FooterEmphasis1";e[e.FooterLayout0=1024]="FooterLayout0";e[e.FooterLayout1=2048]="FooterLayout1";e[e.HideTitleInHeader=33554432]="HideTitleInHeader";e[e.HorizontalQuickLaunch=1]="HorizontalQuickLaunch"})(Fe||(Fe={}));var Ze,et=n(42),tt=n(451),nt=(function(){function e(e){this._itemUrlHelper=e.itemUrlHelper;this._sharingContextInformation=e.sharingContextInformation}e.prototype.getApiRoot=function(e,t,n){if(this._sharingContextInformation){var r=this._sharingContextInformation,i=r.isFolder,s=r.isListSharing,o=r.itemUrl,u=r.listId,a=r.listItemId,f=r.listUrl,l=r.resourceId,c=r.serverRelativeItemUrl,h=r.uniqueId,p=r.webAbsoluteUrl;if(s)return e.build().webByUrl({webUrl:p}).method("Lists",u);if(h){if(u)return e.build().webByUrl({webUrl:p}).segment("lists").method("getbyid",u).method("GetItemByUniqueId",h);var d=i?"GetFolderById":"GetFileById",v={guid:h};return e.build().webByUrl({webUrl:p}).method(d,v).segment("ListItemAllFields")}return f?e.build().webByUrl({listUrl:f}).method("GetListItem",c):o?e.build().webByUrl({webUrl:p}).method("GetFileByUrl",tt.e(o)).segment("ListItemAllFields"):u&&a?e.build().webByUrl({webUrl:p}).method("Lists",u).method("GetItemById",a):e.build().webByUrl({webUrl:p}).method("GetListItemByResourceId",l)}var m;m=t.properties.path?this._itemUrlHelper.getUrlParts({path:t.properties.path}):this._itemUrlHelper.getItemUrlParts(t.key);var g=e.build().webByItemUrl(m).method("Lists",n);t.isRootFolder||(g=t.properties.ID?g.method("GetItemById",t.properties.ID):g.method("GetItemByUniqueId",t.properties.uniqueId));return g};e.prototype.getFileUrl=function(e){return this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl};e.prototype.canUseSecurable=function(e){var t=e.properties;return!!t&&(e.isRootFolder?!!e.list&&!!e.list.id:!!t.ID||!!t.uniqueId)};e.getUniqueSharingPrincipals=function(e){if(e){var t=new Set;return e.filter(function(e){if(t.has(e.loginName))return!1;t.add(e.loginName);return!0})}};return e})(),rt=n(345),it=n(458),st=n(45),ot=2,ut=3,at={},ft={};function lt(e){if(-1===e.indexOf("_oat_"))return!0;var t=ft[e];if(t)return Date.now()/1e3<t;var n=new G.t(e),r=n.getQueryParameter("_oat_");if(r){var i=r.split("_");2===i.length&&(t=Number(i[0]));if(!t){new st.e({name:"TryGetAlternativeUrlFailure"}).end({resultType:j.e.Failure,resultCode:"OatParamUnexpectedFormat",extraData:{eatParam:r}});ft[e]=Date.now()/1e3+86400;return!0}t-=30;ft[e]=t;if(Date.now()/1e3>t)return!1}var s=n.getQueryParameter("P1");if(!s)return!0;var o=Number(s);o-=30;ft[e]=Math.min(o,ft[e]);return!(Date.now()/1e3>o)}function ct(e,t,n){n=n||(function(e){var t,n;function r(e){if(lt(window[e].userPhotoCdnBaseUrl))return window[e].userPhotoCdnBaseUrl;delete window[e].userPhotoCdnBaseUrl;return""}try{var i=at&&at[e];i||"UserPhotoAspx"!==e||((null===(t=window._spPageContextInfo)||void 0===t?void 0:t.userPhotoCdnBaseUrl)?i=r("_spPageContextInfo"):(null===(n=window._spHomePageContext)||void 0===n?void 0:n.userPhotoCdnBaseUrl)&&(i=r("_spHomePageContext")));if(!i)return;if(!lt(i)){delete at[e];return}return i}catch(e){new st.e({name:"TryGetAlternativeUrlFailure"}).end({resultType:j.e.Failure,resultCode:"Unexpected",extraData:{error:e}})}})("UserPhotoAspx")||"/_layouts/15/userphoto.aspx";var r;switch(t){case ot:r="M";break;case ut:r="L";break;default:r="S"}var i=new G.t(n);i.setQueryParameter("size",r);i.setQueryParameter("accountname",e||"");return i.toString()}(function(e){e.Small="S";e.Medium="M";e.Large="L"})(Ze||(Ze={}));function ht(e,t,n){var r=ct(t,void 0,n);if(!e||!r||0===r.indexOf("http"))return r;try{return new ae.e(e).authority+r}catch(e){return r}}var pt,dt,vt,mt,gt,yt,bt,wt=(function(){function e(e){this._features=new Map;if(!e)throw new Error("Cannot create SPFeatureInfo object, incoming data is undefined.");for(var t in e)if(void 0!==t){var n=e[t];this._features.set(t,{version:n.Version,enabled:n.Enabled})}}e.prototype._serialize=function(){var e={};this._features.forEach(function(t,n){e[n]={Version:t.version,Enabled:t.enabled}});return e};e.prototype.get=function(e){if(!e||e&&0===e.length)throw new Error("Cannot get feature, featureName input is empty or undefined");return this._features.get(e)};return e})();(function(){function e(){}e.hasItemPermission=function(t,n){return t&&t.permissions&&e.hasPermission(t.permissions,n)};e.hasPermission=function(e,t){return!!t&&!!e&&(t.Low&e.Low)>>>0===t.Low&&(t.High&e.High)>>>0===t.High};e.hasAny=function(t,n){return(n||[]).some(function(n){return e.hasPermission(t,n)})};e.hasIdentityPermission=function(t,n){return n&&t.webPermMasks&&e.hasPermission(t.webPermMasks,n)};e.viewListItems={High:0,Low:1};e.insertListItems={High:0,Low:2};e.editListItems={High:0,Low:4};e.deleteListItems={High:0,Low:8};e.approveItems={High:0,Low:16};e.openItems={High:0,Low:32};e.viewVersions={High:0,Low:64};e.deleteVersions={High:0,Low:128};e.cancelCheckout={High:0,Low:256};e.manageLists={High:0,Low:2048};e.viewFormPages={High:0,Low:4096};e.reviewListItems={High:0,Low:16384};e.viewPages={High:0,Low:131072};e.layoutsPage={High:0,Low:135168};e.addAndCustomizePages={High:0,Low:262144};e.applyThemeAndBorder={High:0,Low:524288};e.viewUsageData={High:0,Low:2097152};e.manageSubwebs={High:0,Low:8388608};e.managePermissions={High:0,Low:33554432};e.browseDirectories={High:0,Low:67108864};e.manageWeb={High:0,Low:1073741824};e.useClientIntegration={High:16,Low:0};e.manageAlerts={High:64,Low:0};e.createAlerts={High:128,Low:0};e.enumeratePermissions={High:1073741824,Low:0};e.useRemoteAPIs={High:32,Low:0};e.fullMaskWithoutACP={High:2147483647,Low:4294705151};e.fullMask={High:2147483647,Low:4294967295}})();(function(e){e[e.HEADER=0]="HEADER";e[e.NAV=1]="NAV";e[e.FOOTER=2]="FOOTER";e[e.SEARCHBOX=3]="SEARCHBOX"})(pt||(pt={}));(function(e){e[e.LEFT=0]="LEFT";e[e.HORIZONTAL=1]="HORIZONTAL"})(dt||(dt={}));(function(e){e[e.FULLBLEED=0]="FULLBLEED";e[e.WITHLEFTNAV=1]="WITHLEFTNAV"})(vt||(vt={}));(function(e){e[e.none=0]="none";e[e.standard=1]="standard";e[e.compact=2]="compact";e[e.minimal=3]="minimal";e[e.extended=4]="extended"})(mt||(mt={}));(function(e){e[e.left=0]="left";e[e.middle=1]="middle";e[e.right=2]="right"})(gt||(gt={}));(function(e){e[e.SIMPLE=0]="SIMPLE";e[e.EXTENDED=1]="EXTENDED";e[e.STACKED=2]="STACKED"})(yt||(yt={}));(function(e){e[e.Strong=0]="Strong";e[e.Neutral=1]="Neutral";e[e.Soft=2]="Soft";e[e.None=3]="None"})(bt||(bt={}));var Et=n(84);var St=n(330),xt=!X.t.isActivated("48d0bf6b-2e41-42a8-a3a3-e8d2ef405dbb","7/14/2022","better error handling"),Tt=!X.t.isActivated("4d79eceb-84fd-45bc-af6c-c5946827a170","10/12/2022","ask shareLink to return nav in copy link instead of adding it on the client side")&&!me.e.isFeatureEnabled({ECS:1046652})&&Je.e.isFeatureEnabled({ODB:1687}),Nt=X.t.isActivated("62a4337e-d21e-407b-b2ef-2163777d20b8","12/19/2022","Link unfurl using displayName KS")||me.e.isFeatureEnabled({ECS:1059927}),Ct=(function(e){Object(s.r)(t,e);function t(t,n){void 0===n&&(n={pageContext:t.pageContext});var r=e.call(this,{dataSourceName:"SharingDataSource"},n)||this;r._getParentListId=t.getParentListId;r._itemUrlHelper=t.itemUrlHelper||new L({},{pageContext:t.pageContext});r._apiUrlHelper=t.apiUrlHelper||new D({},{pageContext:t.pageContext,itemUrlHelper:r._itemUrlHelper});r._sharingContextInformation=t.sharingContextInformation||void 0;r._sharingDataSourceHelper=new nt({itemUrlHelper:r._itemUrlHelper,sharingContextInformation:r._sharingContextInformation,isItemUrlEncoded:t.isItemUrlEncoded});var i,s="/"===(i=r._pageContext).webServerRelativeUrl?"":i.webServerRelativeUrl;r._shareUrl=s+"/_api/SP.Web.ShareObject";return r}t.parsePeople=function(e){return e.map(function(e){var n={role:t.parseSharingRole(e.CurrentRole),statusCode:Number(!e.Status),errorMessage:e.Message||null};return{name:e.DisplayName,email:e.Email,userId:e.UserId,sharingInfo:n}})};t.parseSharingRole=function(e){switch(e){case 0:return Le.e.None;case 1:return Le.e.View;case 2:return Le.e.Edit;case 6:return Le.e.Review;default:return Le.e.View}};t.prototype.getSharingInformation=function(e,t,n,r,i,s){var o,u=this,a=(r=r||this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e))).segment("GetSharingInformation"),f="pickerSettings";t&&(f+=",permissionsInformation");n&&(f+=",sharingLinkTemplates");i&&(f+=",addressBarLinkSettings");o=a.oDataParameter("$Expand",f).toString();return this.getData(function(){return o},function(t){var n=JSON.parse(t),r=u._parseGetSharingInformationResponse(n,e);r.getSharingInformationSources=Ne.api;return r},"GetSharingInformation",null,"POST",this._sharingContextInformation&&this._sharingContextInformation.listId&&Mt(this._sharingContextInformation.listId.slice(1,-1))?{"X-SP-REQUESTRESOURCES":"WEBPROPERTIES, list=".concat(this._sharingContextInformation.listId.slice(1,-1))}:null,null,null,!0,void 0,void 0,this._getExtraData(),s)};t.prototype.emailWithoutPermissioning=function(e,n,r,i){var s=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,n,this._getParentListId(n)).segment("ForwardObjectLink").toString();return this.getData(function(){return s},function(e){var r=JSON.parse(e).d,i=[];r.UniquelyPermissionedUsers&&r.UniquelyPermissionedUsers.results&&(i=r.UniquelyPermissionedUsers.results);var s=[];r.InvitedUsers&&r.InvitedUsers.results&&(s=r.InvitedUsers.results);var o={};o.statusCode=r.StatusCode;o.errorMessage=r.ErrorMessage;o.people=t.parsePeople(i);o.invitedUsers=t.parsePeople(s);o.itemId=n&&n.id;s.length>0&&(o.invitationLink=s[0].InvitationLink);o.invalidEmails=[];if(r.UsersWithInvalidEmails&&r.UsersWithInvalidEmails.results)for(var u=0,a=r.UsersWithInvalidEmails.results;u<a.length;u++){var f=a[u];o.invalidEmails.push(f.User)}return o},"ForwardObjectLink",function(){for(var t=[],n=0,s=e;n<s.length;n++){var o=s[n];t.push(o.rawPersonData)}var u={peoplePickerInput:JSON.stringify(t),emailBody:r,emailSubject:i};return JSON.stringify(u)})};t.prototype.checkPermissions=function(e,t){var n=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("CheckPermissions").toString();return this.getData(function(){return n},function(e){var t=JSON.parse(e);if(t.d){return t.d.CheckPermissions.results}return null},"CheckPermissions",function(){var t={recipients:e};return JSON.stringify(t)})};t.prototype.share=function(e,n){var r,i=this,s=!!this._sharingContextInformation||this._sharingDataSourceHelper.canUseSecurable(n.items[0]);if(n.linkType===_e||n.linkType===Me||n.linkType===Oe)return this._shareLink(e,n);if(s){var o=n.items[0],u=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,o,this._getParentListId(o));r=u.segment("ShareObject").toString()}else r=this._shareUrl;return this.getData(function(){return r},function(e){var r=JSON.parse(e).d,i=[];Object(St.e)()&&window.sessionStorage.setItem("Share_Response",JSON.stringify(r));r.UniquelyPermissionedUsers&&r.UniquelyPermissionedUsers.results&&(i=r.UniquelyPermissionedUsers.results);var s=[];r.InvitedUsers&&r.InvitedUsers.results&&(s=r.InvitedUsers.results);var o={};o.statusCode=r.StatusCode;o.errorMessage=r.ErrorMessage;o.people=t.parsePeople(i);o.invitedUsers=t.parsePeople(s);o.itemId=n.items[0]&&n.items[0].id;s.length>0&&(o.invitationLink=s[0].InvitationLink);o.invalidEmails=[];if(r.UsersWithInvalidEmails&&r.UsersWithInvalidEmails.results)for(var u=0,a=r.UsersWithInvalidEmails.results;u<a.length;u++){var f=a[u];o.invalidEmails.push(f.User)}return o},"Share",function(){for(var t=[],r=0;r<e.length;r++){var o=e[r];t.push(o.rawPersonData)}n.roleValue===Le.e.Edit.toString()?n.roleValue="role:1073741827":n.roleValue===Le.e.View.toString()&&(n.roleValue="role:1073741826");var u={peoplePickerInput:JSON.stringify(t),roleValue:n.roleValue,sendEmail:n.sendEmail,emailBody:n.message,emailSubject:n.subject,includeAnonymousLinkInEmail:!n.requireSignIn,propagateAcl:n.propagateSharing,useSimplifiedRoles:!0};s||(u.url=i._sharingDataSourceHelper.getFileUrl(n.items[0]));Object(St.e)()&&window.sessionStorage.setItem("Share_Payload",JSON.stringify(u));return JSON.stringify(u)})};t.prototype.updatePermissions2=function(e,t,n){var r=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return r},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole}:null},"UpdatePermissions2",function(){var t;switch(n){case Ae.none:case Ae.view:case Ae.review:case Ae.edit:case Ae.owner:t=n;break;default:t=Ae.view}var r={userRoleAssignments:[{UserId:e.loginName,Role:t}],validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:!1,customMessage:null,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(r)})};t.prototype.updatePermissionsMultiple=function(e,t,n,r,i){var s=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return s},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole,success:t.UpdateDocumentSharingInfo.results.map(function(e){return e.Status}).reduce(function(e,t){return e&&t},!0)}:null},"UpdatePermissionsMultiple",function(){var t;switch(n){case Ae.none:t=0;break;case Ae.view:t=1;break;case Ae.review:t=6;break;case Ae.edit:t=2;break;default:t=1}var s={userRoleAssignments:e.map(function(e){return{UserId:e.userId,Role:t}}),validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:r,customMessage:i,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(s)})};t.prototype.parseRawSharingInformation=function(e,t){return this._parseGetSharingInformationResponse(e,t)};t.prototype.unshareLink=function(e){var t=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.item,this._getParentListId(e.item)).segment("UnshareLink").toString();return this.getData(function(){return t},function(e){return!!JSON.parse(e).d},"UnshareLink",function(){var t={linkKind:e.kind,shareId:e.shareId};return JSON.stringify(t)})};t.prototype.shareLink=function(e){var t=this,n=e.settings,r=e.items[0],i=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.items[0],this._getParentListId(r)).segment("ShareLink").toString(),s={};if(this._sharingContextInformation){this._sharingContextInformation.listId&&Mt(this._sharingContextInformation.listId.slice(1,-1))&&(s["X-SP-REQUESTRESOURCES"]="WEBPROPERTIES, list=".concat(this._sharingContextInformation.listId.slice(1,-1)));this._sharingContextInformation&&this._sharingContextInformation.enableFallbackShareLink&&(s.Prefer="DirectUrlWithShareToken")}return this.getData(function(){return i},function(e){var t=JSON.parse(e);if(t.d){Object(St.e)()&&window.sessionStorage.setItem("ShareLink_Response",JSON.stringify(t.d));return(function(e){if(e.d){return kt(e.d.ShareLink.sharingLinkInfo)}})(t)}if(t.error)return{error:De.generic,errorMessage:t.error.message}},"ShareLink",function(){var r=null;n.expiration&&(r=v(n.expiration.toString()));var i=null;if(e.recipients&&e.recipients.length>0){i=[];for(var s=0,o=e.recipients;s<o.length;s++){var u=o[s];u.rawPersonData&&i.push(u.rawPersonData)}}var a=null;if(n.inviteesToRemove&&n.inviteesToRemove.length>0){a=[];for(var f=0,l=n.inviteesToRemove;f<l.length;f++){var c=l[f];a.push({id:c.id,loginName:c.loginName,name:c.primaryText,isExternal:c.isExternal,principalType:c.type,email:c.email})}}var h={request:{createLink:!!n.createLink,settings:{allowAnonymousAccess:n.allowAnonymousAccess,trackLinkUsers:n.trackLinkUsers,linkKind:n.sharingLinkKind,expiration:r,role:n.role,restrictShareMembership:n.restrictShareMembership,updatePassword:n.updatePassword,password:n.password,shareId:n.shareId,description:n.description,scope:n.scope}}};t._sharingContextInformation&&t._sharingContextInformation.navId&&t._sharingContextInformation.optInSendNavIdInShareLink&&Tt&&(h.request.settings.nav=t._sharingContextInformation.navId);a&&(h.request.settings.inviteesToRemove={results:a});if(i&&i.length>0){h.request.peoplePickerInput=JSON.stringify(i);var p=e.emailData,d=e.emailSubject;void 0!==p&&void 0===d&&(h.request.emailData={body:e.emailData,subject:""});void 0===p&&void 0!==d&&(h.request.emailData={body:"",subject:e.emailSubject});void 0!==p&&void 0!==d&&(h.request.emailData={body:e.emailData,subject:e.emailSubject})}var m=e.settings.shareId;if(m){h.request.settings.shareId=m;h.request.emailData={body:""}}var g=JSON.stringify(h);Object(St.e)()&&window.sessionStorage.setItem("ShareLink_Payload",g);return g},"POST",0!==Object.keys(s).length?s:null,null,null,!0,void 0,void 0,this._getExtraData()).catch(function(e){if(xt)return{error:e};var t="";try{t=JSON.stringify(e)}catch(e){}return{error:De.generic,debugErrorMessage:t}})};t.prototype.setAddressBarLinkCapability=function(e,t){var n=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e)).segment("SetAddressBarLinkCapability").toString();return this.getData(function(){return n},function(e){return!!JSON.parse(e).d},"SetAddressBarLinkCapability",function(){var e={enable:t};return JSON.stringify(e)})};t.prototype.shareLinkExpress=function(e,t,n){var r=this._apiUrlHelper.build().webByUrl({webUrl:this._pageContext.webAbsoluteUrl}).method("Lists",e).method("GetItemById",t).segment("ShareLinkExpress").toString();return this.getData(function(){return r},function(e){var t=JSON.parse(e);return t.d?kt(t.d.ShareLinkExpress.sharingLinkInfo):t.error?{error:De.generic,errorMessage:t.error.message}:void 0},"ShareLinkExpress",function(){var e={expressOption:n};return JSON.stringify(e)},"POST",null,null,null,!0,void 0,void 0,this._getExtraData()).catch(function(e){if(xt)return{error:e};var t="";try{t=JSON.stringify(e)}catch(e){}return{error:De.generic,debugErrorMessage:t}})};t.prototype.getClientId=function(){var e=Number(this._pageContext.webTemplate);if((function(e){if(e.featureInfo){var t=new wt(e.featureInfo);if(t){var n=t.get("SitePagePublishing");return!!n&&n.enabled}return!1}return Number(e.webTemplate)===it.e.sitePagePublishing})(this._pageContext))return je.sharePoint;switch(e){case it.e.teamSite:case it.e.group:case it.e.subgroup:case it.e.sitePagePublishing:return je.sharePoint;case it.e.mySite:return je.odb;default:return je.sharePoint}};t.prototype._shareLink=function(e,t){var n=this,r=t.items[0],i=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,r,this._getParentListId(r)).segment("ShareLink").toString();return this.getData(function(){return i},function(n){return{statusCode:0,errorMessage:"",people:e,itemId:t.items[0].id}},"ShareLink",function(){for(var r=[],i=0,s=e;i<s.length;i++){var o=s[i];r.push(o.rawPersonData)}var u=null;t.expiration&&(u=v(t.expiration));var a={request:{peoplePickerInput:JSON.stringify(r),emailData:{body:t.message,subject:t.subject},linkKind:n._getSharingLinkKind(t.linkType,t.roleValue),createLink:!0,expiration:u}};return JSON.stringify(a)})};t.prototype._getSharingLinkKind=function(e,t){var n=He.direct;e===Me?n=He.anonymousEdit:e===Oe?n=He.anonymousView:e===_e&&(n=t===Le.e.Edit.toString()?He.organizationEdit:He.organizationView);return n};t.prototype._parseGetSharingInformationResponse=function(e,t){if(e.error)return{error:De.generic,anonymousLinkExpirationRestrictionDays:void 0,anyoneLinkTrackUsers:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canRequestAccessForGrantAccess:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkScope:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,fileExtension:void 0,sharedObjectType:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,userRole:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0,outlookEndpointHostUrl:void 0,webUrl:void 0,userPhotoCdnBaseUrl:void 0,permissionsInformation:void 0,sensitivityLabelInformation:void 0,displayName:void 0};var n=e.d,r=n.userPhotoCdnBaseUrl,i=n.permissionsInformation,o=!!i,u=!!n.sharingLinkTemplates,a=o,f=!!n.addressBarLinkSettings,l=o?this._parseSharingLinks(i.links.results,n.directUrl,r):[],c=u?this._parseSharingLinkTemplates(n.sharingLinkTemplates.templates.results,r):[],h=f?n.addressBarLinkSettings:null,p=[];if(o){var d=i.siteAdmins.results,v=i.principals.results,m=this._parseSharingPrincipals(d,void 0,r);m.forEach(function(e){return e.isSiteAdmin=!0});var g=this._parseSharingPrincipals(v,void 0,r);p=m.concat(g)}var y=this._getDefaultSharingLink(n.defaultLinkKind,n.defaultShareLinkScope,l,n.sharingAbilities),b=this._sharingContextInformation?this._sharingContextInformation.itemName:void 0;Nt||b||!n||(b=n.displayName);var w={name:b,childCount:this._sharingContextInformation?this._sharingContextInformation.itemCount:void 0,hasDlpPolicy:this._sharingContextInformation?this._sharingContextInformation.hasDlpPolicy:void 0,extension:this._sharingContextInformation&&this._sharingContextInformation.itemExtension?this._sharingContextInformation.itemExtension:n.fileExtension,appmap:this._sharingContextInformation?this._sharingContextInformation.itemAppmap:void 0,itemType:this._sharingContextInformation?this._sharingContextInformation.itemType:void 0};if(t){var E=t.properties,S=E.ItemChildCount?parseInt(E.ItemChildCount,10):0,x=E.FolderChildCount?parseInt(E.FolderChildCount,10):0,T=t.type===et.e.OneNote?0:S+x,N=this._isPolicyTipFlagSet(t.policyTip,rt.t.blockSharing),C=t.name;Nt||C||!n.displayName||(C=n.displayName);w={name:C,childCount:T,hasDlpPolicy:N,extension:t.extension,appmap:t.appMap,itemType:t.type}}var k=n.canRequestAccessForGrantAccess||n.canAddInternalPrincipal||l.length>1,L={anonymousLinkExpirationRestrictionDays:0===n.anonymousLinkExpirationRestrictionDays?-1:n.anonymousLinkExpirationRestrictionDays,anyoneLinkTrackUsers:n.anyoneLinkTrackUsers,canAddExternalPrincipal:n.canAddExternalPrincipal,canAddInternalPrincipal:n.canAddInternalPrincipal,defaultShareLinkToExistingAccess:n.defaultShareLinkToExistingAccess,canManagePermissions:k,defaultSharingLink:y,fileExtension:n.fileExtension,sharedObjectType:n.sharedObjectType,hasInheritedLinks:!!a&&n.permissionsInformation.hasInheritedLinks,isShared:this._computeIsShared(l,p),item:w,sharingLinks:l,sharingPrincipals:p,peoplePickerSettings:n.pickerSettings,userDisplayName:this._pageContext.userDisplayName,blockPeoplePickerAndSharing:n.blockPeoplePickerAndSharing,requiresAccessApproval:!n.canAddInternalPrincipal&&n.canRequestAccessForGrantAccess,canRequestAccessForGrantAccess:n.canRequestAccessForGrantAccess,userRole:n.currentRole,defaultShareLinkPermission:n.defaultShareLinkPermission,sharingAbilities:n.sharingAbilities,defaultLinkKind:n.defaultLinkKind,defaultShareLinkScope:n.defaultShareLinkScope,directLink:{allowsAnonymousAccess:!1,audience:Ie.existing,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:He.direct,sharingScope:We,url:n.directUrl,updatePassword:!1,password:"",passwordLastModifiedBy:null},hasPermissionsInformation:!!n.permissionsInformation,sharingLinkTemplates:c,addressBarLinkSettings:h,webTemplateId:n.webTemplateId,itemUniqueId:n.itemUniqueId,customizedExternalSharingServiceUrl:n.customizedExternalSharingServiceUrl||"",siteIBSegmentIDs:n.siteIBSegmentIDs?n.siteIBSegmentIDs.results:null,siteIBMode:n.siteIBMode,enforceIBSegmentFiltering:!!n.enforceIBSegmentFiltering,enforceSPOSearch:!!n.enforceSPOSearch,outlookEndpointHostUrl:n.outlookEndpointHostUrl?n.outlookEndpointHostUrl:null,webUrl:n.webUrl?n.webUrl:null,isStubFile:!!n.isStubFile&&n.isStubFile,userPhotoCdnBaseUrl:n.userPhotoCdnBaseUrl,permissionsInformation:n.permissionsInformation,sensitivityLabelInformation:n.sensitivityLabelInformation,displayName:n.displayName},A=window.sessionStorage.getItem("Get_Sharing_Information");if(Object(St.e)()&&A&&Object.keys(A).length>0){var O=JSON.parse(A);return Object(s.e)(Object(s.e)({},L),O)}return L};t.prototype._computeIsShared=function(e,t){for(var n=!1,r=0,i=e;r<i.length;r++){var s=i[r];s.isActive&&s.sharingLinkKind!==He.direct&&(n=!0)}n||(n=t.length>0);return n};t.prototype._parseSharingLinks=function(e,t,n){var r=this,i=(e=e.filter(function(e){return!e.isInherited})).map(function(e){var t,i=e.linkDetails;t=void 0!==i.Scope&&i.Scope!==qe?At(i.LinkKind,i.Scope):Lt(i.LinkKind,i.AllowsAnonymousAccess,i.RestrictedShareMembership);return{allowsAnonymousAccess:i.AllowsAnonymousAccess,hasPassword:i.RequiresPassword,blockDownload:i.BlocksDownload,description:i.Description,audience:t,expiration:i.Expiration?new Date(i.Expiration):null,isActive:i.IsActive,isEdit:Ot(i.LinkKind)||i.IsEditLink,isReview:i.IsReviewLink,isManageList:i.IsManageListLink,principals:r._parseSharingPrincipals(e.linkMembers.results,i.LinkKind,n),invitees:r._parseLinkInvitees(i,n),shareId:i.ShareId,sharingLinkKind:i.LinkKind,sharingScope:i.Scope,url:i.Url,updatePassword:i.UpdatePassword,password:i.Password,passwordLastModifiedBy:r._parseSharingPrincipal(i.PasswordLastModifiedBy,n),isCreateOnlyLink:i.IsCreateOnlyLink,isAddressBarLink:i.IsAddressBarLink,isUnhealthy:i.IsUnhealthy,status:i.SharingLinkStatus,created:i.Created,trackLinkUsers:i.TrackLinkUsers}});(i=i.sort(function(e,t){return r._getLinkRanking(t)-r._getLinkRanking(e)})).push({allowsAnonymousAccess:!1,audience:Ie.specificPeople,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:He.direct,sharingScope:ze,url:t,updatePassword:!1,password:"",passwordLastModifiedBy:null});return i};t.prototype._getLinkRanking=function(e){var t=0;switch(e.audience){case Ie.anyone:t+=30;break;case Ie.organization:t+=20;break;case Ie.specificPeopleFlex:t+=10}e.isEdit?t+=3:e.isReview?t+=2:e.isEdit||e.isReview||e.blockDownload||(t+=1);return t};t.prototype._getSharingLinkTemplateRanking=function(e){var t=0;if(e&&e.linkDetails&&e.linkDetails.shareId){switch(e.scope){case Xe:t+=30;break;case Ve:t+=20;break;case $e:t+=10}switch(e.role){case Ae.edit:t+=3;break;case Ae.review:t+=2;break;case Ae.view:t+=1}}return t};t.prototype._parseSharingLinkTemplates=function(e,t){var n=this,r=e.map(function(e){var r,i=e.linkDetails;if(null!==i){var s=void 0;s=void 0!==i.Scope&&i.Scope!==qe?At(i.LinkKind,i.Scope):Lt(i.LinkKind,i.AllowsAnonymousAccess,i.RestrictedShareMembership);r={allowsAnonymousAccess:i.AllowsAnonymousAccess,hasPassword:i.RequiresPassword,blockDownload:i.BlocksDownload,audience:s,expiration:i.Expiration?new Date(i.Expiration):null,description:i.Description,isActive:i.IsActive,isEdit:Ot(i.LinkKind)||i.IsEditLink,isReview:i.IsReviewLink,principals:void 0,invitees:n._parseLinkInvitees(i,t),shareId:i.ShareId,sharingLinkKind:i.LinkKind,sharingScope:i.Scope,url:i.Url,updatePassword:i.UpdatePassword,password:i.Password,passwordLastModifiedBy:n._parseSharingPrincipal(i.PasswordLastModifiedBy,t)}}return{linkDetails:r,passwordProtected:e.passwordProtected,role:e.role,scope:e.scope,shareKind:e.shareKind}});return r=r.sort(function(e,t){return n._getSharingLinkTemplateRanking(t)-n._getSharingLinkTemplateRanking(e)})};t.prototype._parseLinkInvitees=function(e,t){var n=this,r=e.Invitations;if(!r)return[];for(var i=[],s=0,o=r.results;s<o.length;s++){var u=o[s];u&&u.invitee&&i.push(u.invitee)}return i.map(function(e){return{id:e.id,email:e.email,primaryText:e.name,isExternal:e.isExternal,loginName:e.loginName,role:null,secondaryText:e.jobTitle,type:e.principalType,imageUrl:ht(n._pageContext.webAbsoluteUrl,e.email,t)}})};t.prototype._parseSharingPrincipals=function(e,t,n){var r=this,i=e.map(function(e){var i=e.principal;i||(i=e);var s={id:i.id,isExternal:i.isExternal,loginName:i.loginName,primaryText:i.name,role:e.role,secondaryText:i.jobTitle,type:i.principalType,imageUrl:ht(r._pageContext.webAbsoluteUrl,i.email,n),email:i.email};t&&(s.sharingLinkKind=t);return s});return nt.getUniqueSharingPrincipals(i)};t.prototype._getExtraData=function(){var e;this._sharingContextInformation&&(e={clientId:this._sharingContextInformation.clientId,mode:p[this._sharingContextInformation.mode]});return e};t.prototype._parseSharingPrincipal=function(e,t){if(e){var n=e.principal;n||(n=e);return{id:n.id,isExternal:n.isExternal,loginName:n.loginName,primaryText:n.name,role:e.role,secondaryText:n.jobTitle,type:n.principalType,imageUrl:ht(this._pageContext.webAbsoluteUrl,n.email,t),email:n.email}}return null};t.prototype._getDefaultSharingLink=function(e,t,n,r){r.peopleSharingLinkAbilities&&(r.peopleSharingLinkAbilities.canManageEditLink.enabled||r.peopleSharingLinkAbilities.canManageReadLink.enabled)&&e===He.direct&&(e=He.flexible);var i=e,s=t;if(r.anyoneLinkAbilities){i!==He.anonymousEdit||r.anyoneLinkAbilities.canManageEditLink.enabled||(i=He.anonymousView);i!==He.anonymousView||r.anyoneLinkAbilities.canManageReadLink.enabled||(i=He.organizationEdit);s!==Re||r.anyoneLinkAbilities.canManageReadLink.enabled||r.anyoneLinkAbilities.canManageReadLink.enabled||(s=Ue)}else{i!==He.anonymousEdit||r.anonymousLinkAbilities.canManageEditLink.enabled||(i=He.anonymousView);i!==He.anonymousView||r.anonymousLinkAbilities.canManageReadLink.enabled||(i=He.organizationEdit);s!==Re||r.anonymousLinkAbilities.canManageReadLink.enabled||r.anonymousLinkAbilities.canManageReadLink.enabled||(s=Ue)}if(r.organizationLinkAbilities){i!==He.organizationEdit||r.organizationLinkAbilities.canManageEditLink.enabled||(i=He.organizationView);i!==He.organizationView||r.organizationLinkAbilities.canManageReadLink.enabled||(i=He.direct);s!==Ue||r.organizationLinkAbilities.canManageReadLink.enabled||r.organizationLinkAbilities.canManageEditLink.enabled||(s=ze)}r.peopleSharingLinkAbilities&&(s!==ze||r.peopleSharingLinkAbilities.canManageReadLink.enabled||r.peopleSharingLinkAbilities.canManageEditLink.enabled||(s=We));var o=void 0;e===He.anonymousEdit||e===He.anonymousView?o=Ie.anyone:e===He.organizationEdit||e===He.organizationView?o=Ie.organization:e===He.direct?o=Ie.specificPeople:e===He.flexible&&(o=Ie.specificPeopleFlex);return{allowsAnonymousAccess:void 0,audience:o,expiration:void 0,description:void 0,isActive:!0,isEdit:void 0,principals:void 0,shareId:void 0,sharingLinkKind:i,sharingScope:s,url:void 0,invitees:void 0,updatePassword:!1,password:"",passwordLastModifiedBy:void 0}};t.prototype._isPolicyTipFlagSet=function(e,t){return e&&(e&t)===t};return t})(ke);function kt(e){var t;t=void 0!==e.Scope&&e.Scope!==qe?At(e.LinkKind,e.Scope):Lt(e.LinkKind,e.AllowsAnonymousAccess,e.RestrictedShareMembership);var n=e.Expiration?new Date(e.Expiration):void 0;return{link:{allowsAnonymousAccess:e.AllowsAnonymousAccess,audience:t,expiration:n,description:e.Description,isActive:e.IsActive,isEdit:Ot(e.LinkKind)||e.IsEditLink,principals:null,invitees:null,hasPassword:e.RequiresPassword,shareId:e.ShareId,sharingLinkKind:e.LinkKind,sharingScope:e.Scope,url:e.Url,updatePassword:e.UpdatePassword,password:e.Password,passwordLastModifiedBy:e.PasswordLastModifiedBy,shareTokenString:e.ShareTokenString,isAddressBarLink:e.IsAddressBarLink,isUnhealthy:e.IsUnhealthy,status:e.SharingLinkStatus,created:e.Created}}}function Lt(e,t,n){return e===He.anonymousEdit||e===He.anonymousView?Ie.anyone:e===He.organizationEdit||e===He.organizationView?Ie.organization:e===He.direct?Ie.specificPeople:e===He.flexible?t?Ie.anyone:!1===n?Ie.organization:Ie.specificPeopleFlex:void 0}function At(e,t){return e===He.anonymousEdit||e===He.anonymousView?Ie.anyone:e===He.organizationEdit||e===He.organizationView?Ie.organization:e===He.direct?Ie.specificPeople:e===He.flexible?t==Re?Ie.anyone:t===Ue?Ie.organization:Ie.specificPeopleFlex:void 0}function Ot(e){return e===He.anonymousEdit||e===He.organizationEdit||e!==He.anonymousView&&e!==He.organizationView&&null}function Mt(e){"{"===e[0]&&(e=e.substring(1,e.length-1));return/^(\{){0,1}[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}(\}){0,1}$/gi.test(e)&&"00000000-0000-0000-0000-000000000000"!=e}var _t=(function(){function e(e){this._dataSource=e.sharingDataSource||new Ct({getParentListId:e.getParentListId,pageContext:e.pageContext});this._itemProvider=e.itemProvider}e.prototype.getSharingInformation=function(e,t,n,r,i){return this._dataSource.getSharingInformation(e,t,n,r,i)};e.prototype.shareLink=function(e){var t=this;return this._dataSource.shareLink(e).then(function(n){t._invalidateItem(e.items[0]);return n})};e.prototype.unshareLink=function(e){var t=this;return this._dataSource.unshareLink(e).then(function(n){t._invalidateItem(e.item);return n})};e.prototype.updatePermissions2=function(e,t,n){var r=this;return this._dataSource.updatePermissions2(e,t,n).then(function(e){r._invalidateItem(t);return e})};e.prototype.updatePermissionsMultiple=function(e,t,n,r,i){var s=this;return this._dataSource.updatePermissionsMultiple(e,t,n,r,i).then(function(e){s._invalidateItem(t);return e})};e.prototype.getClientId=function(){return this._dataSource.getClientId()};e.prototype.parseRawSharingInformation=function(e){return this._dataSource.parseRawSharingInformation(e)};e.prototype.emailWithoutPermissioning=function(e,t,n,r){return this._dataSource.emailWithoutPermissioning(e,t,n,r).then(function(e){return e})};e.prototype.checkPermissions=function(e,t){return this._dataSource.checkPermissions(e,t)};e.prototype.share=function(e,t,n){return this._dataSource.share(e,t).then(function(e){return e})};e.prototype.setAddressBarLinkCapability=function(e,t){return this._dataSource.setAddressBarLinkCapability(e,t)};e.prototype._invalidateItem=function(e){this._itemProvider&&e&&e.parent&&e.parent.key&&this._itemProvider.invalidateItem(e.parent.key)};return e})(),Dt=n(198),Pt=n(327),Ht=n(94);var Bt=(function(e){Object(s.r)(t,e);function t(t){return e.call(this,t)||this}return t})(Object(Pt.e)()((function(e){return(function(e){Object(s.r)(t,e);function t(t){var n=t.context,r=void 0===n?{}:n,i=t.accountType,o=void 0===i?"Unknown":i,u=t.clientName,a=void 0===u?"Unknown":u,f=t.cloudType,l=void 0===f?"Unknown":f,c=t.correlationId,h=t.environment,p=void 0===h?t.ariaEnvironment||"prod":h,d=t.isAuthenticated,v=void 0===d?"NA":d,m=t.language,g=void 0===m?r.Market:m,y=t.scenario,b=void 0===y?"Unknown":y,w=t.siteSubscriptionId,E=void 0===w?"Unknown":w,S=t.userId,x=void 0===S?"Unknown":S,T=t.version,N=void 0===T?"Unknown":T,C=t.tenantToken,k=void 0===C?"eeddb977348d43ebaaae45e759ea6e96-42528e91-0556-4879-9b8d-af7b3b8417e4-6984":C,L=(t.context,Object(s.s)(t,["accountType","clientName","cloudType","correlationId","environment","isAuthenticated","language","scenario","siteSubscriptionId","userId","version","tenantToken","context"]));return e.call(this,Object(s.e)({tenantToken:k,context:Object(s.e)({AccountType:o,ClientName:a,CloudType:l,CorrelationId:c,Environment:p,IsAuthenticated:v,IsSharedControl:!0,Market:g,Scenario:b,Session:Ht.generate(),SiteSubscriptionId:E,UserId:x,Version:N,Workload:"SharedControls"},r)},L))||this}return t})(e)})((function(e){Object(s.r)(t,e);function t(t){var r=this,i=t.context,o=void 0===i?{}:i,u=t.ariaLoader,a=void 0===u?function(){return Object(s.t)(r,void 0,void 0,function(){return Object(s.i)(this,function(e){return[2,n.ee(1,598,7)]})})}:u,f=(t.context,Object(s.s)(t,["ariaLoader","context"]));return r=e.call(this,Object(s.e)({ariaLoader:a,context:Object(s.e)({},o)},f))||this}return t})(Dt.e)))),jt=n(340),Ft=(function(e){Object(s.r)(t,e);function t(t){return e.call(this,t)||this}return t})(Object(jt.e)()(Bt)),It=n(56),qt=n(151),Rt=n(361),Ut=n(552),zt=!X.t.isActivated("d5b8cbb0-c266-4df4-9114-140574fe3794","01/24/2022","use new prefetch for converged share dialog endpoint"),Wt=!X.t.isActivated("FE17821F-BAE7-44D8-91C0-5145C4D97969","10/01/2021","Invite placeholder user")&&Je.e.isFeatureEnabled({ODB:60596}),Xt=!X.t.isActivated("c877bf24-d915-49e7-8142-4f3051896aad","04/21/2022","crossdomain url"),Vt=!X.t.isActivated("209e41e5-d804-4aa1-9d59-5209d8d48f2c","02/03/2022","render wider dialog across all endpoints")&&!Je.e.isFeatureEnabled({ECS:1000799}),$t=X.t.isActivated("acd90abc-a3c2-4370-a5cd-c49cd5e7850b","02/15/2022","use sharingMessenger for shareprefetch")||Je.e.isFeatureEnabled({ECS:1002676}),Jt=X.t.isActivated("0e31a500-ba9b-4838-9978-19d35b8947e6","10/26/2022","refactor window post message types")||Je.e.isFeatureEnabled({ECS:1049278}),Kt=Je.e.isFeatureEnabled({ODC:"ODCSharePrefetchInline"}),Qt=(function(){function e(e){var t,n=this;this._iframe=document.createElement("iframe");this._form=document.createElement("form");this._formInput=document.createElement("input");this._sharingHostMessenger=null;this._channelId=Et.e.generate();this._onReceiveWindowMessage=function(e){try{var t=(null==e?void 0:e.data)&&JSON.parse(e.data);if(!n._elementWindow.document.body.contains(n._props.element)){n._messagesReceived.sharePrefetch_selfDispose=!0;n.dispose();return}if(t.name){n._messagesReceived[t.name||""]=!0;n._processEvent(t)}}catch(e){}};this._signal=new h.e;this._context=e.context;this._iframeWidth=0;this._iframeHeight=0;this._timeoutId=-1;this._isShareReady=!1;this._iframeUrl="";this._iframeBaseUrl="";this._messagesReceived={};this._props=e;this._receiveMessageBound=this._receiveMessage.bind(this);this._elementWindow=this._props.elementWindow||window;this._sessionId=Et.e.generate();this._manager=Object(It.t)();this._hostOrigin="";this._clientOrigin="";this._sessionQos=new(st.e.withManager(this._manager).withContext(function(e){return Object(s.e)(Object(s.e)({},e),{"AppInfo.Session":n._sessionId})}))({name:"SharingSession.".concat(p[e.context.mode||p.share])});this._shareCustomerPromiseLogger=new Rt.e({scenario:"sharePrefetch.load",perfGoalInMs:3e4});var r,i=void 0===this._props.context.hostMethod?u:this._props.context.hostMethod,f=this._props.isConsumer;this._launchNewSharedialog=zt&&i===o&&!f;this._isInlineConsumer=!!f&&i===a;this._useODCSharePrefetchInline=Kt&&this._isInlineConsumer;if(!(null===(t=this._context)||void 0===t?void 0:t.authToken))throw new Error("An access token is required for SharePrefetch optimization");var l="";Wt&&this._context.invitationId&&(l="&invitationId=".concat(this._context.invitationId));if(this._launchNewSharedialog){var c=Xt&&this._props.sharepointHostUrl?"".concat(this._props.sharepointHostUrl,"&sessionid=").concat(this._sessionId):void 0;this._iframeUrl=c||"".concat(this._context.webAbsoluteUrl,"/_layouts/15/sharedialog.aspx?sessionid=").concat(this._sessionId).concat(l,"&crossdomain=true")}else if(i===o&&this._props.sharepointHostUrl)this._iframeBaseUrl=this._iframeUrl=this._props.sharepointHostUrl;else if(this._useODCSharePrefetchInline&&this._isInlineConsumer){this._iframeBaseUrl=window.location.protocol+"//"+window.location.hostname;r=document.cookie.replace(/ /g,"").split(";").filter(function(e){return 0===e.indexOf("srr=")}).map(function(e){return e.split("=")[1]})[0]}else{switch((r=document.cookie.replace(/ /g,"").split(";").filter(function(e){return 0===e.indexOf("srr=")}).map(function(e){return e.split("=")[1]})[0])?"test":e.environment){case"pathfinder":this._iframeBaseUrl="https://od.apps.mil";break;case"trailblazer":this._iframeBaseUrl="https://admin.onedrive.us";break;case"ag08":this._iframeBaseUrl="https://odweba.svc.ms.eaglex.ic.gov";break;case"ag09":this._iframeBaseUrl="https://odweba.svc.ms.microsoft.scloud";break;case"test":this._iframeBaseUrl="https://www.onedrive-tst.com";this._iframeUrl=e.testEnvironmentUrl||"";break;default:this._iframeBaseUrl="https://www.odwebp.svc.ms"}}var d={clientName:this._context.clientId,userAuthToken:this._context.authToken,Session:this._sessionId};f&&(this._context.userId?d.userId=this._context.userId:d.accountType="ConsumerAnonymous");new Ft(d).attach(this._manager);if(this._iframeUrl||i!==u){if(!this._iframeUrl&&this._useODCSharePrefetchInline&&this._isInlineConsumer){v=f?"&consumer=true":"";this._iframeUrl="".concat(this._iframeBaseUrl,"/share?smkt=").concat(e.locale).concat(v,"&sessionid=").concat(this._sessionId).concat(l).concat(r?"&nextdevhost=".concat(encodeURIComponent(r),"&nextserverhost=").concat(encodeURIComponent(r)):"")}}else{var v=f?"&consumer=true":"";this._iframeUrl="".concat(this._iframeBaseUrl,"/share?smkt=").concat(e.locale).concat(v,"&sessionid=").concat(this._sessionId).concat(l).concat(r?"&devhost=".concat(encodeURIComponent(r)):"")}this._iframeStartTime=new Date;this._initializeIframe();e.element.appendChild(this._iframe);var m=this._isInlineConsumer&&this._useODCSharePrefetchInline;if(f&&!m){this._initializeForm();e.element.appendChild(this._form)}else if(this._launchNewSharedialog){this._initializeForm();var g=this._iframe.contentWindow;if(g){g.document.body.appendChild(this._form);this._form.submit()}}$t||this._sharingHostMessenger||(this._sharingHostMessenger=this._createSharingHostMessenger())}e.prototype.initializeUI=function(){return Object(s.t)(this,void 0,void 0,function(){var e,t,n,r,i,o,u,a,f,l=this;return Object(s.i)(this,function(h){e=this._context&&this._context.correlationId;t=this._props.isConsumer;n=this._context.mode===p.copy&&"teams"===this._context.clientId&&!this._context.shareId;r=n?this._getDefaultLink():Promise.resolve(void 0);i=t||this._props.disablePrefetchSharingInformation?Promise.resolve(void 0):this._getSharingInformation();o=!t||this._useODCSharePrefetchInline&&this._isInlineConsumer;u=o?this._signal.getPromise():Promise.resolve(void 0);this._isShareReady=!1;Promise.all([this._toTuple(r),this._toTuple(i),this._toTuple(u)]).then(function(n){var r=n[0],i=n[1];n[2];try{var o=!1;if(!t){var u=l._props.options.onError;if(l._isError(r)){o=!0;u&&u({name:"SharePrefetchError",message:"",error:r.error,resultCode:c.t.isCanceled(r.error)?"Canceled":Object(qt.r)(r.error)})}if(l._isError(i)){o=!0;var a=i.error,f={code:a.code,status:a.status};u&&u({name:"SharePrefetchError",message:"",error:a,resultCode:c.t.isCanceled(i.error)?"Canceled":"[".concat(f.status.toString(),"] ").concat(f.code||"Unknown")})}}var h=l._iframe.contentWindow;if(h&&!t){var p=l._props.options.spRestTokenProvider,d=Object(s.e)(Object(s.e)({},l._context),{rawInvite:r.value,sharingInformation:i.value,hasTokenProvider:!!p&&!!p.getAuthToken});l._sharingHostMessenger?l._sharingHostMessenger.sendSharingContextInformation(d):h.postMessage(d,l._iframeUrl)}else if(t)if(l._useODCSharePrefetchInline&&l._isInlineConsumer&&h){d=Object(s.e)(Object(s.e)({},l._context),{rawInvite:r.value,sharingInformation:i.value,hasTokenProvider:!1});h.postMessage(d,l._iframeUrl)}else{l._formInput.value=JSON.stringify(l._context);l._form.submit()}else o||l._sessionQos.end({resultType:j.e.ExpectedFailure,resultCode:"abandoned",extraData:{error:"contentWindow not defined to postMessage context",iframeInBody:l._elementWindow.document.body.contains(l._iframe),messagesReceived:Object.keys(l._messagesReceived).join(","),mode:l._context.mode,correlationId:e}})}catch(t){l._sessionQos.end({resultType:j.e.Failure,extraData:{unhandledError:t.toString(),correlationId:e}})}});if(!this._props.disableIframeDomainCheck){a=!this._props.iframeCheckTimeout||this._props.iframeCheckTimeout<=0?8e3:this._props.iframeCheckTimeout;setTimeout(function(){if(!l._scriptsLoadedTime){var t=new Image;t.onerror=function(){var t="ShareDomainNotReachable"+(window.navigator&&window.navigator.onLine?"Online":"Offline"),n=l._props.options&&l._props.options.onError;n&&n({name:"SharePrefetchError",message:t,error:new Error(t),debugErrorMessage:"Unable to reach ".concat(l._iframeBaseUrl," domain. Refer to https://docs.microsoft.com/en-us/office365/enterprise/urls-and-ip-address-ranges"),resultCode:t});l._sessionQos.end({resultType:j.e.ExpectedFailure,resultCode:t,extraData:{mode:l._context.mode,iframeBaseUrl:l._iframeBaseUrl,correlationId:e}});clearTimeout(l._timeoutId)};t.src="".concat(l._iframeBaseUrl,"/favicon.ico?").concat(Math.random())}},a)}f=this._props.timeout||45e3;this._timeoutId=setTimeout(function(){return Object(s.t)(l,void 0,void 0,function(){var n,o,u,a,l,c,h,p,d,v,m;return Object(s.i)(this,function(s){switch(s.label){case 0:o=!1;s.label=1;case 1:s.trys.push([1,3,,4]);return[4,i];case 2:u=s.sent();o=!!u;return[3,4];case 3:a=s.sent();n=a;return[3,4];case 4:c=!1;s.label=5;case 5:s.trys.push([5,7,,8]);return[4,r];case 6:h=s.sent();c=!(!h||!h);return[3,8];case 7:p=s.sent();l=p;return[3,8];case 8:d=this._elementWindow.document.body.contains(this._props.element);v={isTimeout:!0,iframeInBody:this._elementWindow.document.body.contains(this._iframe),rootElementInBody:d,messagesReceived:Object.keys(this._messagesReceived).join(","),getSharingHasData:o,getSharingError:n,inviteHasData:c,inviteError:l,isConsumer:t,timeout:f,mode:this._context.mode,isOnline:window.navigator&&window.navigator.onLine,scriptsLoadedTime:this._scriptsLoadedTime?this._scriptsLoadedTime.getTime()-this._iframeStartTime.getTime():-1,iframeLoadedTime:this._iframeLoadedTime,correlationId:e};this._showShareUX();(m=this._props.options&&this._props.options.onTimeout)&&m(v);this._sessionQos.end({resultType:d?j.e.Failure:j.e.ExpectedFailure,resultCode:"timeout",extraData:v});return[2]}})})},f);return[2]})})};e.prototype.dispose=function(){var e=this._context&&this._context.correlationId;clearTimeout(this._timeoutId);this._messagesReceived.sharePrefetch_dispose=!0;Jt?this._elementWindow.removeEventListener("message",this._receiveMessageBound):this._elementWindow.removeEventListener("message",this._onReceiveWindowMessage);this._props.element.removeChild(this._iframe);this._sessionQos.end({resultType:j.e.ExpectedFailure,resultCode:"disposed",extraData:{isDisposed:!0,iframeInBody:this._elementWindow.document.body.contains(this._iframe),messagesReceived:Object.keys(this._messagesReceived).join(","),mode:this._context.mode,correlationId:e,isOnline:window.navigator&&window.navigator.onLine,iframeLoadedTime:this._iframeLoadedTime}})};e.prototype._getDefaultLink=function(){return Object(s.t)(this,void 0,void 0,function(){var e,t,n,r=this;return Object(s.i)(this,function(i){switch(i.label){case 0:e=new l.t({},{urlDataSource:{getApiBaseUrl:function(){return"".concat(r._context.webAbsoluteUrl,"/_api/v2.0")}},sessionManagementProvider:this._props.options.graphTokenProvider||{getToken:function(){return c.t.resolve({accessToken:r._context.authToken})}},apiEvent:H.e.withManager(this._manager)});t=new f.e({},{dataRequestor:e});n=[];this._context.defaultRecipients&&this._context.defaultRecipients.length>0&&(n=this._context.defaultRecipients.map(function(e){return{email:e}}));return[4,this._context.uniqueId?t.getDefaultLinkByUniqueId(this._context.uniqueId||"",n,!this._props.disableUseMultiPart):t.getDefaultLink(this._context.itemUrl||"",n,!this._props.disableUseMultiPart)];case 1:return[2,{value:i.sent()}]}})})};e.prototype._getSharingInformation=function(){var e={authToken:this._context.authToken,webAbsoluteUrl:this._context.webAbsoluteUrl,webTemplate:this._context.isODB?"21":"1",env:"prod"},t=this._props.options.spRestTokenProvider,n=this._manager,r=new Ct({pageContext:e,getParentListId:this._getParentListId,sharingContextInformation:this._context},{pageContext:e,dataRequestorType:(function(r){Object(s.r)(i,r);function i(i){return r.call(this,i,{pageContext:e,apiEvent:H.e.withManager(n),tokenProvider:t})||this}return i})(Te),tokenProvider:t}),i=new _t({pageContext:e,getParentListId:this._getParentListId,itemProvider:{invalidateItem:function(){}},sharingDataSource:r}),o=this._launchNewSharedialog||this._context.mode===p.copy||this._context.mode===p.linkSettings;return i.getSharingInformation({key:"",name:this._context.itemName,properties:{}},o,!0,void 0,this._context.mode===p.manageAccess)};e.prototype._initializeIframe=function(){var e=this;Jt?this._elementWindow.addEventListener("message",this._receiveMessageBound):this._elementWindow.addEventListener("message",this._onReceiveWindowMessage);this._iframe.name="shareFrame";this._iframe.id="shareFrame";this._iframe.onload=function(){e._iframeLoadedTime=(new Date).getTime()-e._iframeStartTime.getTime()};if(!$t&&this._iframeUrl){this._hostOrigin=new ae.e(window.location.href).authority;this._iframeUrl+="&channelId=".concat(this._channelId,"&origin=").concat(this._hostOrigin)}this._launchNewSharedialog||(this._iframe.src=this._iframeUrl);this._iframe.style.width="0px";this._iframe.style.height="0px";this._iframe.style.visibility="hidden";this._iframe.allow="clipboard-read; clipboard-write self ".concat(new ae.e(this._iframeUrl).authority)};e.prototype._initializeForm=function(){var e;this._form.target="shareFrame";this._form.method="POST";this._form.action=this._iframeUrl;this._form.style.display="none";this._formInput.type="text";var t=null===(e=this._context)||void 0===e?void 0:e.authToken;if(this._launchNewSharedialog){this._formInput.value=t;this._formInput.name="access_token"}else this._formInput.name="context";this._form.appendChild(this._formInput);var n=document.createElement("input");n.type="submit";this._form.appendChild(n)};e.prototype._showShareUX=function(){var e,t;this._isShareReady=!0;var n=this._props.styles;n&&n.border?this._iframe.style.border=n.border:this._iframe.style.border="0";if(n){n.margin&&(this._iframe.style.margin=n.margin);n.minWidth&&(this._iframe.style.minWidth=n.minWidth);n.minHeight&&(this._iframe.style.minHeight=n.minHeight)}this._iframe.style.visibility="visible";this._iframe.style.height=this._context.fullScreenIframe?"100%":"".concat(this._iframeHeight||400,"px");var r=Vt&&!1!==(null===(t=null===(e=this._props.context)||void 0===e?void 0:e.hostOptions)||void 0===t?void 0:t.enableWiderDialog)?480:320;this._iframe.style.width=this._context.fullScreenIframe?"100%":"".concat(r||this._iframeWidth||this._iframe.style.minWidth,"px");clearTimeout(this._timeoutId)};e.prototype._receiveMessage=function(e){return Object(s.t)(this,void 0,void 0,function(){var t,n;return Object(s.i)(this,function(r){try{t=e&&e.data&&JSON.parse(e.data)}catch(e){return[2]}try{if(!this._elementWindow.document.body.contains(this._props.element)){this._messagesReceived.sharePrefetch_selfDispose=!0;this.dispose();return[2]}}catch(e){}n=t.name;this._messagesReceived[n||""]=!0;this._processEvent(t);return[2]})})};e.prototype._getParentListId=function(e){return""};e.prototype._toTuple=function(e){return Object(s.t)(this,void 0,void 0,function(){var t;return Object(s.i)(this,function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);t={};return[4,e];case 1:return[2,(t.value=n.sent(),t)];case 2:return[2,{error:n.sent()}];case 3:return[2]}})})};e.prototype._isError=function(e){return!!e.error};e.prototype._createSharingHostMessenger=function(){var e=this;0;this._clientOrigin=new ae.e(this._iframeUrl).authority;if(this._clientOrigin&&this._iframe.contentWindow){var t=new Ut.e({origin:this._clientOrigin,channelId:this._channelId,source:this._iframe.contentWindow,customerPromiseLogger:this._shareCustomerPromiseLogger});t.addCommandHandler(function(t){0;e._processEvent(t);return{result:"success"}});return t}return null};e.prototype._processEvent=function(e){var t,n,r,i,s=this;switch(e.name){case"share_scriptsLoaded":this._scriptsLoadedTime=new Date;this._signal.complete();var o=this._props.options&&this._props.options.onScriptsLoaded;o&&o();break;case"share_resize":if(!this._context.fullScreenIframe&&"width"in e&&"height"in e){var u=this._props.options&&this._props.options.onResize;u&&e.width&&e.height&&u(e.width,e.height);this._iframeWidth=e.width||320;this._iframeHeight=e.height||400;if(this._isShareReady){this._iframe.style.height="".concat(this._iframeHeight,"px");this._iframe.style.width="".concat(this._iframeWidth,"px")}}break;case"share_started":var a=this._props.options&&this._props.options.onStarted;a&&a();break;case"share_ready":this._showShareUX();var f={scriptsLoadedTime:this._scriptsLoadedTime?this._scriptsLoadedTime.getTime()-this._iframeStartTime.getTime():-1,iframeLoadedTime:this._iframeLoadedTime,mode:this._context.mode,recipientsCount:this._context.defaultRecipients&&this._context.defaultRecipients.length||0,shareId:this._context.shareId,correlationId:null===(t=this._context)||void 0===t?void 0:t.correlationId};this._sessionQos.end({resultType:j.e.Success,extraData:f});this._shareCustomerPromiseLogger.end({resultType:j.e.Success});var l=this._props.options&&this._props.options.onReady;l&&l();break;case"share_error":this._showShareUX();var c=this._props.options&&this._props.options.onError;if("error"in e){var h=e.resultCode||Object(qt.r)(new Error(e.error))||"unavilable";this._sessionQos.end({resultType:j.e.Failure,resultCode:h,extraData:{correlationId:null===(n=this._context)||void 0===n?void 0:n.correlationId}});this._shareCustomerPromiseLogger.end({resultType:j.e.Failure,errorCode:h,extraData:{clientId:this._context.clientId,mode:null===(r=this._context)||void 0===r?void 0:r.mode,correlationId:null===(i=this._context)||void 0===i?void 0:i.correlationId}});c&&c({name:"SharePrefetchError",message:e.errorMessage||"",error:Error(e.error),debugErrorMessage:e.debugErrorMessage||"",errorMessage:e.errorMessage||"",resultCode:h})}break;case"share_completed":var p=this._props.options&&this._props.options.onCompleted;p&&p({scope:"scope"in e&&e.scope||""});break;case"share_dismiss":var d=this._props.options&&this._props.options.onDismiss;d&&d();break;case"share_manageAccessClicked":var v=this._props.options&&this._props.options.openManageAccess;v&&v();break;case"share_linkSettingsCompleted":var m=this._props.options&&this._props.options.onLinkSettingsComplete;e&&m&&m(e);break;case"share_grantAccessCompleted":var g=this._props.options&&this._props.options.onGrantAccessComplete;"successful"in e&&e.successful&&g&&g();break;case"share_getToken":var y=new st.e({name:"SharingSession.GetToken"}),b=this._iframe.contentWindow;if(!b){y.end({resultType:j.e.Failure,error:"no_window"});break}if(this._props.options.spRestTokenProvider&&this._props.options.spRestTokenProvider.getAuthToken&&e&&"url"in e)this._props.options.spRestTokenProvider.getAuthToken(e).then(function(e){if(e){s._sharingHostMessenger?s._sharingHostMessenger.sendNewToken(e,void 0):b.postMessage(JSON.stringify({name:"share_newToken",token:e}),s._iframeUrl);y.end({resultType:j.e.Success})}else{s._sharingHostMessenger?s._sharingHostMessenger.sendNewToken(void 0,"no_token"):b.postMessage(JSON.stringify({name:"share_newToken",error:"no_token"}),s._iframeUrl);y.end({resultType:j.e.Failure,error:"no_token"})}}).catch(function(e){s._sharingHostMessenger?s._sharingHostMessenger.sendNewToken(void 0,"token_exception",e.toString()):b.postMessage(JSON.stringify({name:"share_newToken",error:"token_exception",errorDetails:e}),s._iframeUrl);y.end({resultType:j.e.Failure,error:String(e)})});else{this._sharingHostMessenger?this._sharingHostMessenger.sendNewToken(void 0,"no_handler"):b.postMessage(JSON.stringify({name:"share_newToken",error:"no_handler"}),this._iframeUrl);y.end({resultType:j.e.Failure,error:"no_handler"})}}};return e})()}}]);
(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[30],{550:function(e,t,n){"use strict";var r;(function(e){e[e.none=0]="none";e[e.htmlFileUpload=1]="htmlFileUpload";e[e.folderUpload=2]="folderUpload";e[e.downlevelUpload=3]="downlevelUpload";e[e.silverlightUpload=4]="silverlightUpload"})(r||(r={}));t.e=r},551:function(e,t,n){"use strict";n.d(t,"n",function(){return i});n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});var r=n(4),i=new r.t("pageContext"),s=(new r.t("sharingContextInformation"),new r.t("listContext"),new r.t("listItems"),new r.t("inplaceEditorUrl"),new r.t("inplaceEditorClosing"),new r.t("appViewChangeInProgress"),new r.t("appViewChangeInProgress"),new r.t("itemsPerGroup"),new r.t("loggingContext")),o=new r.t("loggingContextBuckets");new r.t("provider.contentTypes"),new r.t("onePageContext"),new r.t("searchBehavior"),new r.t("newDocumentTemplates"),new r.t("listsHostContext"),new r.t("listsHostWelcomeContext")},605:function(e,t,n){"use strict";n.r(t);n.d(t,"RedeemDialog",function(){return zn});n.d(t,"RedeemStatus",function(){return Fn});n.d(t,"WacRedeemDialog",function(){return Wn});var r=n(0),i=n(532),s=n(371),o=n(1),u=n(307);Object(u.e)([]);var a=n(554),f=n(15),l=n(317);n(393);window.__ko=f;var c=n(308),h=n(4),p=n(304),d=(function(){function e(){}e.prototype.debounce=function(e){var t=this;this.clear();this._originalPromise=e;var n=new p.e(function(){return t._originalPromise.cancel()});this._originalPromise.done(function(e){t._clear(!1);n.complete(e)},function(e){t._clear(!1);n.error(e)});return n.getPromise()};e.prototype.clear=function(){this._clear(!0)};e.prototype.isExecuting=function(){return Boolean(this._originalPromise)};e.prototype._clear=function(e){if(this.isExecuting()){e&&this._originalPromise.cancel();this._originalPromise=null}};return e})(),v=n(97),m=n(328),g=n(110),y=n(32);var b=(function(){function e(e){var t=e.viewModelType;this.dependencies=Object(r.e)(Object(r.e)({},t.dependencies||{}),e.dependencies||{});this._automationName=e.automationName;this._viewModelType=e.viewModelType;this._template=e.template}e.prototype.create=function(e){var t=this,n=e.resources,i=(function(t){Object(r.r)(i,t);function i(i){return t.call(this,i,Object(r.e)(Object(r.e)({},e||{}),{resources:new h.n(n)}))||this}return i})(this._viewModelType),s=function(){return t._getTemplateNodes()},o=this._automationName;return{instance:new((function(){function e(){}e.prototype.toSpecification=function(e){return{automationName:o,viewModelType:i,getTemplateNodes:s,params:e}};return e})())}};e.prototype._getTemplateNodes=function(){var e=f.utils.parseHtmlFragment(this._template);this._getTemplateNodes=function(){return e};return e};return e})();function w(e,t){return!e&&!t||e===t||!(!e||!t)&&(e.getTemplateNodes===t.getTemplateNodes&&e.viewModelType===t.viewModelType&&e.params===t.params)}function E(e){return!!e&&"object"==typeof e&&"specification"in e}function S(e){return!!e.definitionKey}var x=(function(e){Object(r.r)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.controlsDescendantBindings=!0;var i=r.element;r._transcludedTemplateNodes=Array.prototype.slice.call(f.virtualElements.childNodes(i));f.virtualElements.emptyNode(i);r._resolvedSpecification=r._getResolvedSpecification();r._initializeRenderComponent();return r}t.prototype._getResolvedSpecification=function(){var e=this,t=this.resources,n=this.observables,i=n.create();i.equalityComparer=w;var s=new d;n.compute(function(){var o,u,a,f=e.valueAccessor();if(E(f)){o=n.unwrap(f.specification);u=f.placeholder;a=f.error}else o=n.unwrap(f);e.observables.ignore(function(){var n;if(o)if(S(o)){var f=o.params,l=o.definitionKey.local,c=t.consume(l.optional);if(c)i(c.toSpecification(f));else{if(u)if(S(u)){var h=t.consume(u.definitionKey.optional.local);h&&i(Object(r.e)(Object(r.e)({},h.toSpecification(u.params)),{isPlaceholder:!0}))}else i(Object(r.e)(Object(r.e)({},u),{isPlaceholder:!0}));n=v.t.resolve(t.consumeAsync(l)).then(function(e){return e.toSpecification(f)})}}else i(o);else i(void 0);s.debounce(n?e.trackPromise(n.then(function(e){i(e)},function(e){if(!v.t.isCanceled(e)){y.e.log(e);if(a)if(S(a)){var n=t.consume(a.definitionKey.optional.local);n&&i(Object(r.e)(Object(r.e)({},n.toSpecification(Object(r.e)(Object(r.e)({},a.params),{error:e}))),{isError:!0}))}else i(Object(r.e)(Object(r.e)({},a),{params:Object(r.e)(Object(r.e)({},a.params),{error:e}),isError:!0}))}})):v.t.wrap())})});return i};t.prototype._initializeRenderComponent=function(){var e,t=this,n=this.element,r=this.observables,i=this._transcludedTemplateNodes;r.compute(function(){var r=t._resolvedSpecification();t.observables.ignore(function(){if(e){e.dispose();f.virtualElements.emptyNode(n)}if(r){var s=r.getTemplateNodes().map(function(e){return e.cloneNode(!0)}),o=(e=t.scope.attach(new g.e)).attach(new r.viewModelType(r.params));e.attach(new m.e({viewModel:o,element:n,bindingContext:t.bindingContext,name:r.automationName}));for(var u=t.bindingContext.createChildContext(o,void 0,function(e){e.$component=o;e.$componentTemplateNodes=i}),a=document.createDocumentFragment(),l=0,c=s;l<c.length;l++){var h=c[l];a.appendChild(h)}f.virtualElements.setDomNodeChildren(n,[a]);f.applyBindingsToDescendants(u,n);var p=t.valueAccessor();if(E(p)){var d=p.afterRender;!d||r.isPlaceholder||r.isError||d()}}})})};t.supportsVirtualElements=!0;return t})(c.t),T=n(163),N=n(134),C=n(22),k=n(64),L=n(77);function A(e,t){var n,r=null!==(n=null==t?void 0:t.inline)&&void 0!==n&&n,i=O(),s=o.useRef(),u=s.current||(s.current=Object(k.e)(i.create(e),{equalityComparer:L.e}));(r?o.useMemo:o.useEffect)(function(){u(e)},[e]);return u}function O(){var e=Object(T.t)(),t=o.useRef(),n=t.current||(t.current=new(e.consume(C.n.optional)||N.e));o.useLayoutEffect(function(){return function(){n.dispose()}},[]);return n}var M=n(391),_=n(148),D=n(459);function P(e){return(function(e){return void 0!==e.getModule})(e)?H({path:e.path,getModule:e.getModule,getExport:D.e}):H({path:e.path,require:e.require,getExport:D.e})}function H(e){var t=e.path,n=e.getExport;return v.t.resolve((function(e){return void 0!==e.getModule})(e)?j(e.getModule,t):B(e.require,t)).then(n)}function B(e,t){return j(function(){return new v.t(function(n,r){e([t],n,r)})},t)}function j(e,t){_.e.mark("Module_".concat(t),20);return e().then(function(e){return e},function(e){v.t.isCanceled(e)||M.e.log(e);return v.t.reject(e)})}var F=n(88),I=n(141),q=n(26),R=(function(e){Object(r.r)(t,e);function t(t){var n=e.call(this,t)||this;n.state={hasError:!1};return n}t.getDerivedStateFromError=function(e){return{hasError:!0}};t.prototype.render=function(){return this.state.hasError?null:o.createElement(o.Fragment,null,this.props.children)};t.prototype.componentDidCatch=function(e,t){var n=this.props.onError;y.e.logError(e,{"react.componentStack":t.componentStack,"react.component":this.props.componentName},{eventName:"ReactRenderError",resultCode:"",resultType:q.e.Failure});n&&n(e)};return t})(o.PureComponent),U=n(251),z=n(337),W=n(46),X=n(268),V=0,$=Object(W.e)(function(e){return"".concat(++V)});var J=new((function(){function e(){this._promises={}}e.prototype.load=function(e){var t=e.path,n=e.getModule,r=window.require.toUrl("".concat(t,"_unmapped")),i=this._promises,s=i[r];s||(s=i[r]=v.t.as(P({path:t,getModule:n}))).done(void 0,function(e){delete i[r]});var o=new p.e;s.done(function(e){return o.complete(e)},function(e){return o.error(e)});return o.getPromise()};e.prototype._loadSync=function(e,t){var n;if(t.defined&&t.defined(e)){var r=t(e);if(r)if("object"==typeof r){if(Object.keys(r).length>0){var i=Object(D.e)(r);i&&(n=i)}}else n=r}return n};return e})());function K(e){var t=e.applyBindings,n=e.bindingContext,i=e.children,s=Object(r.s)(e,["applyBindings","bindingContext","children"]),u=o.useRef(null),a=(function(){var e=o.useState(function(){return{}}),t=e[0],n=e[1],i=Object(X.e)(function(e,t){n(function(n){var i,s=$(t);return Object(r.e)(Object(r.e)({},n),((i={})[s]=F.createPortal(e,t),i))})}),s=Object(X.e)(function(e){n(function(t){var n=t,i=$(e);n[i];return Object(r.s)(n,["symbol"==typeof i?i:i+""])})}),u=o.useRef(),a=u.current||(u.current={render:i,unmount:s}),f=o.useMemo(function(){return o.createElement(o.Fragment,null,Object.keys(t).map(function(e){return o.createElement(o.Fragment,{key:e},t[e])}))},[t]);return o.useMemo(function(){return[a,f]},[a,f])})(),l=a[0],c=a[1],h=A({children:i}),p=o.useCallback(function(e){return o.createElement(o.Fragment,null,e.children)},[]),d=o.useRef(),v=o.useRef(!1);o.useEffect(function(){if(u.current&&t&&!v.current){if(i){var e=document.createElement("div");e.setAttribute("data-bind","react: Children");u.current.appendChild(e)}var s=n||(function(){var e=document.createElement("div");f.applyBindings({},e);var t=f.contextFor(e);f.removeNode(e);return t})(),o=t(u.current,s.extend(Object(r.e)({$react:l},i?{$data:{bindingHandlers:{react:Q},Children:{componentType:p,props:h}}}:{})));d.current=function(){o&&o.dispose();u.current&&f.cleanNode(u.current)}}},[]);o.useLayoutEffect(function(){return function(){v.current=!0;var e=d.current;e&&e()}},[]);var m=Object(z.e)(function(){return o.createElement("div",Object(r.e)({key:"root",ref:u,role:"presentation","data-is-ko-react-root":"true"},s))},s);return o.createElement(o.Fragment,null,m,c)}var Q=(function(e){Object(r.r)(t,e);function t(t){var n=e.call(this,t)||this;n.controlsDescendantBindings=!0;var r,i=n.observables;n._value=i.pureCompute(function(){return i.unwrap(n.valueAccessor())});if(n._value.peek().useDOMContext){var s=Object(U.e)(n.element,function(e){return"true"===e.getAttribute("data-is-ko-react-root")});s&&(r=f.contextFor(s))}else r=n.bindingContext;n._context=r&&r.$react;n._transcludedTemplateNodes=Array.prototype.slice.call(f.virtualElements.childNodes(n.element));f.virtualElements.emptyNode(n.element);n._renderDependencies=n.createObservable();n._componentProps=i.pureCompute(function(){return i.unwrap(n._value().props)});n._componentProps.equalityComparer=I.t;n._rootProps=i.pureCompute(function(){return i.unwrap(n._value().rootProps)});n._rootProps.equalityComparer=I.t;var o=n.scope.attach(new d);n.createComputed(function(){var e,t=n._value();if((function(e){return!!e.componentType})(t)){var r=n.observables.unwrap(t.componentType);n._componentNameForLogging=r.displayName||"";_.e.mark("EUPL.ReactBinding.LoadStart.".concat(n._componentNameForLogging));e=v.t.wrap(r)}else{t.getModule||console.error("ReactBinding instantiated with componentPath ".concat(t.componentPath," but missing getModule"));n._componentNameForLogging=t.componentPath;_.e.mark("EUPL.ReactBinding.LoadStart.".concat(n._componentNameForLogging));e=J.load({path:t.componentPath,getModule:t.getModule})}n.trackPromise(o.debounce(v.t.all({componentType:e}).then(function(e){_.e.mark("EUPL.ReactBinding.Loaded.".concat(n._componentNameForLogging));var t=n._context;n.addDisposable({dispose:t?function(){t.unmount(n.element)}:function(){F.unmountComponentAtNode(n.element)}});n._renderDependencies(e)})))});n.createComputed(n._computeRenderComponent);return n}t.prototype._computeRenderComponent=function(){var e=this,t=this._renderDependencies();if(t){var n=t.componentType,i=this._componentProps(),s=this._rootProps(),u=this._transcludedTemplateNodes;_.e.mark("EUPL.ReactBinding.AsyncRender.".concat(this._componentNameForLogging));try{this.observables.ignore(function(){var t=u.length>0?function(e,t){f.applyBindingsToNode(e,{template:{nodes:u}},t)}:void 0,a=o.createElement(T.e,{resources:e.resources},o.createElement(R,{onError:function(t){var n=e._value.peek().error;n&&n(t)},componentName:e._componentNameForLogging},o.createElement(n,Object(r.e)({},Object(r.e)(Object(r.e)({},i),t?{children:o.createElement(K,Object(r.e)({bindingContext:e.bindingContext,applyBindings:t},s||{}))}:{})))));e._context?e._context.render(a,e.element):F.render(a,e.element)})}catch(e){y.e.logError(e)}}};return t})(c.t),G=Q;var Y=n(108);function Z(e){var t=e.specification,n=e.placeholder,r=Object(T.t)(),i=A(t),s=Object(X.e)(function(t,s){var o=new Y.e;if(e.onApplyBindings){var u=e.onApplyBindings(t);u&&o.attach(u)}o.attach(new(r.resolved(x))({element:t,valueAccessor:function(){return{specification:i,placeholder:n}},bindingContext:s}));return o});return o.createElement(K,{applyBindings:s},e.children)}function ee(e){var t=e.resources,n=Object(r.s)(e,["resources"]),i=o.createElement(Z,Object(r.e)({},n));return t?o.createElement(T.e,{resources:t},i):i}var te=ee,ne=(new h.t({name:"Knockout",factory:new h.e(ee)}),'<div class="TicketRedeem"><div class="TicketRedeem-signInAsText" data-bind="text:signInAsText"></div><div class="TicketRedeem-person" data-bind="component:{name:personaTagName,params:personaParams}"></div><div class="TicketRedeem-bodyText" data-bind="text:bodyText"></div></div>');Object(u.e)([{rawString:".TicketRedeem-person,.TicketRedeem-signInAsText{margin-bottom:10px}"}]);var re=n(222);Object(u.e)([{rawString:".od-Persona{box-sizing:border-box;box-shadow:none;margin:0;padding:0;font-size:.875rem;line-height:1;position:relative;width:100%}.od-Persona .od-Persona-imageArea{position:relative;display:inline-block;background-color:transparent;width:3rem;height:3rem;overflow:visible}[dir=ltr] .od-Persona .od-Persona-imageArea{margin-right:.5rem}[dir=rtl] .od-Persona .od-Persona-imageArea{margin-left:.5rem}.od-Persona .od-Persona-imageCircle{width:3rem;height:3rem;margin:0;border-radius:50%;overflow:hidden;position:absolute;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}[dir=ltr] .od-Persona .od-Persona-imageCircle{left:0}[dir=rtl] .od-Persona .od-Persona-imageCircle{right:0}[dir=ltr] .od-Persona .od-Persona-imageCircle{right:0}[dir=rtl] .od-Persona .od-Persona-imageCircle{left:0}.od-Persona .od-Persona-initials{border-radius:50%}.od-Persona .od-Persona-placeholder{color:"},{theme:"white",defaultValue:"#fff"},{rawString:';position:absolute;font-size:2.9375rem;top:.4375rem}[dir=ltr] .od-Persona .od-Persona-placeholder{right:0}[dir=rtl] .od-Persona .od-Persona-placeholder{left:0}[dir=ltr] .od-Persona .od-Persona-placeholder{left:0}[dir=rtl] .od-Persona .od-Persona-placeholder{right:0}.od-Persona .od-Persona-image{width:3rem;height:3rem;line-height:3rem}.od-Persona .od-Persona-image[src=""]{display:none}.od-Persona .od-Persona-presence{position:absolute;height:.75rem;width:.75rem;border-radius:50%;top:auto;bottom:-.375rem;border:.125rem solid '},{theme:"white",defaultValue:"#fff"},{rawString:"}[dir=ltr] .od-Persona .od-Persona-presence{left:auto}[dir=rtl] .od-Persona .od-Persona-presence{right:auto}[dir=ltr] .od-Persona .od-Persona-presence{right:-.125rem}[dir=rtl] .od-Persona .od-Persona-presence{left:-.125rem}.od-Persona .od-Persona-row{white-space:nowrap;clear:both;display:inline-block}.od-Persona.od-Persona-unresolved .od-Persona-image{display:none}.od-Persona .od-Persona-details{vertical-align:top;display:inline-block;margin-top:.25rem}.od-Persona .od-persona-link{display:inline-block;padding-bottom:.1875rem}.od-Persona .od-Persona-primaryText{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-weight:400;font-size:1.125rem;white-space:nowrap;max-width:100%;overflow:hidden;text-overflow:ellipsis;padding-bottom:.1875rem}.od-Persona .od-Persona-emailText,.od-Persona .od-Persona-optionalText,.od-Persona .od-Persona-secondaryText,.od-Persona .od-Persona-sharingRole-Text,.od-Persona .od-Persona-sharingSpinner,.od-Persona .od-Persona-tertiaryText{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-weight:400;font-size:.75rem;padding-bottom:.1875rem;white-space:nowrap;height:auto;overflow:hidden;text-overflow:ellipsis}.od-Persona .od-Persona-sharingRole-Text{margin:.125rem 0}.od-Persona .od-Persona-optionalText,.od-Persona .od-Persona-tertiaryText{display:none}.od-Persona .od-Persona-sharingRole{cursor:pointer;background:0 0;border:none;padding:0}.od-Persona .od-Persona-sharingRole .ms-Icon--ChevronDown{position:relative;top:.125rem}.od-Persona.od-Persona--mini{width:1.5rem;height:1.5rem;display:inline-block}.od-Persona.od-Persona--mini .od-Persona-image,.od-Persona.od-Persona--mini .od-Persona-imageArea,.od-Persona.od-Persona--mini .od-Persona-imageCircle{width:1.5rem;height:1.5rem;margin:0}.od-Persona.od-Persona--mini .od-Persona-details{display:none}.od-Persona.od-Persona--tiny{padding:0;display:inline-block}[dir=ltr] .od-Persona.od-Persona--tiny{margin-left:4px}[dir=rtl] .od-Persona.od-Persona--tiny{margin-right:4px}.od-Persona.od-Persona--tiny .od-Persona-image,.od-Persona.od-Persona--tiny .od-Persona-imageArea,.od-Persona.od-Persona--tiny .od-Persona-imageCircle{display:none}.od-Persona.od-Persona--tiny .od-Persona-presence{vertical-align:text-bottom;padding-top:0}.od-Persona.od-Persona--tiny .od-Persona-details{height:.875rem;margin-top:0;line-height:.875rem;overflow:visible}[dir=ltr] .od-Persona.od-Persona--tiny .od-Persona-details{padding-left:.9375rem}[dir=rtl] .od-Persona.od-Persona--tiny .od-Persona-details{padding-right:.9375rem}.od-Persona.od-Persona--tiny .od-Persona-presence{height:.625rem;width:.625rem;top:.625rem;border:0}[dir=ltr] .od-Persona.od-Persona--tiny .od-Persona-presence{right:auto}[dir=rtl] .od-Persona.od-Persona--tiny .od-Persona-presence{left:auto}.od-Persona.od-Persona--tiny .od-Persona-primaryText{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:';font-weight:400;font-size:.75rem;padding-top:.125rem}.od-Persona.od-Persona--tiny .od-Persona-optionalText,.od-Persona.od-Persona--tiny .od-Persona-secondaryText,.od-Persona.od-Persona--tiny .od-Persona-sharingRole-Text,.od-Persona.od-Persona--tiny .od-Persona-sharingSpinner,.od-Persona.od-Persona--tiny .od-Persona-tertiaryText{display:none}.od-Persona.od-Persona--tiny.od-Persona--comma{padding:0;background-color:transparent}.od-Persona.od-Persona--tiny.od-Persona--comma .od-Persona-primaryText:after{content:","}.od-Persona.od-Persona--xs .od-Persona-image,.od-Persona.od-Persona--xs .od-Persona-imageArea,.od-Persona.od-Persona--xs .od-Persona-imageCircle{width:2rem;height:2rem}.od-Persona.od-Persona--xs .od-Persona-imageArea{margin-bottom:0}[dir=ltr] .od-Persona.od-Persona--xs .od-Persona-imageArea{margin-right:.5rem}[dir=rtl] .od-Persona.od-Persona--xs .od-Persona-imageArea{margin-left:.5rem}.od-Persona.od-Persona--xs .od-Persona-image{line-height:2rem}.od-Persona.od-Persona--xs .od-Persona-placeholder{font-size:1.75rem;top:.25rem}.od-Persona.od-Persona--xs .od-Persona-presence{bottom:-.0625rem}[dir=ltr] .od-Persona.od-Persona--xs .od-Persona-presence{right:-.0625rem}[dir=rtl] .od-Persona.od-Persona--xs .od-Persona-presence{left:-.0625rem}[dir=ltr] .od-Persona.od-Persona--xs .od-Persona-details{padding-left:0}[dir=rtl] .od-Persona.od-Persona--xs .od-Persona-details{padding-right:0}[dir=ltr] .od-Persona.od-Persona--xs .od-Persona-details{padding-right:.25rem}[dir=rtl] .od-Persona.od-Persona--xs .od-Persona-details{padding-left:.25rem}[dir=ltr] .od-Persona.od-Persona--xs .od-Persona-details{margin-right:.25rem}[dir=rtl] .od-Persona.od-Persona--xs .od-Persona-details{margin-left:.25rem}.od-Persona.od-Persona--xs .od-Persona-primaryText{font-size:.875rem;padding-top:.1875rem}.od-Persona.od-Persona--xs .od-Persona-secondaryText{display:none}.od-Persona.od-Persona--sm .od-Persona-image,.od-Persona.od-Persona--sm .od-Persona-imageArea,.od-Persona.od-Persona--sm .od-Persona-imageCircle{width:2.5rem;height:2.5rem}[dir=ltr] .od-Persona.od-Persona--sm .od-Persona-imageArea{margin-left:.25rem}[dir=rtl] .od-Persona.od-Persona--sm .od-Persona-imageArea{margin-right:.25rem}.od-Persona.od-Persona--sm .od-Persona-image{line-height:2.5rem}.od-Persona.od-Persona--sm .od-Persona-placeholder{font-size:2.375rem;top:.3125rem}.od-Persona.od-Persona--sm .od-Persona-presence{bottom:-.0625rem;margin:0}[dir=ltr] .od-Persona.od-Persona--sm .od-Persona-presence{right:-.0625rem}[dir=rtl] .od-Persona.od-Persona--sm .od-Persona-presence{left:-.0625rem}.od-Persona.od-Persona--sm .od-Persona-primaryText{font-size:.875rem;padding:0}.od-Persona.od-Persona--sm .od-Persona-secondaryText{padding:0;margin-top:.3125rem}.od-Persona.od-Persona--lg .od-Persona-image,.od-Persona.od-Persona--lg .od-Persona-imageArea,.od-Persona.od-Persona--lg .od-Persona-imageCircle{width:4.5rem;height:4.5rem}.od-Persona.od-Persona--lg .od-Persona-imageArea{height:4.875rem}[dir=ltr] .od-Persona.od-Persona--lg .od-Persona-imageArea{margin-right:.75rem}[dir=rtl] .od-Persona.od-Persona--lg .od-Persona-imageArea{margin-left:.75rem}.od-Persona.od-Persona--lg .od-Persona-image{line-height:4.5rem;font-size:1.75rem}.od-Persona.od-Persona--lg .od-Persona-details{padding-top:.375rem}[dir=ltr] .od-Persona.od-Persona--lg .od-Persona-imageArea{margin-right:.625rem}[dir=rtl] .od-Persona.od-Persona--lg .od-Persona-imageArea{margin-left:.625rem}.od-Persona.od-Persona--lg .od-Persona-placeholder{font-size:4.25rem;top:.625rem}[dir=ltr] .od-Persona.od-Persona--lg .od-Persona-placeholder{left:-.3125rem}[dir=rtl] .od-Persona.od-Persona--lg .od-Persona-placeholder{right:-.3125rem}.od-Persona.od-Persona--lg .od-Persona-presence{height:1.25rem;width:1.25rem;bottom:.25rem;border-width:.1875rem}[dir=ltr] .od-Persona.od-Persona--lg .od-Persona-presence{right:-.125rem}[dir=rtl] .od-Persona.od-Persona--lg .od-Persona-presence{left:-.125rem}.od-Persona.od-Persona--lg .od-Persona-primaryText{font-weight:400;line-height:.75rem}.od-Persona.od-Persona--lg .od-Persona-tertiaryText{display:block}.od-Persona.od-Persona--lg .od-Persona-optionalText,.od-Persona.od-Persona--lg .od-Persona-secondaryText,.od-Persona.od-Persona--lg .od-Persona-sharingRole-Text,.od-Persona.od-Persona--lg .od-Persona-tertiaryText{line-height:.75rem;margin-top:.5rem;margin-bottom:0}.od-Persona.od-Persona--xl .od-Persona-image,.od-Persona.od-Persona--xl .od-Persona-imageArea,.od-Persona.od-Persona--xl .od-Persona-imageCircle{width:6.25rem;height:6.25rem}[dir=ltr] .od-Persona.od-Persona--xl .od-Persona-imageArea{margin-right:1.25rem}[dir=rtl] .od-Persona.od-Persona--xl .od-Persona-imageArea{margin-left:1.25rem}.od-Persona.od-Persona--xl .od-Persona-image{line-height:6.25rem;font-size:1.75rem}.od-Persona.od-Persona--xl .od-Persona-placeholder{font-size:5.9375rem;top:.75rem}.od-Persona.od-Persona--xl .od-Persona-presence{height:1.75rem;width:1.75rem;border-width:.25rem}.od-Persona.od-Persona--xl .od-Persona-primaryText{font-size:1.25rem;font-weight:300;margin-top:.125rem}.od-Persona.od-Persona--xl .od-Persona-secondaryText{padding-top:.4375rem}.od-Persona.od-Persona--xl .od-Persona-optionalText,.od-Persona.od-Persona--xl .od-Persona-tertiaryText{padding-top:.5rem;display:block}.od-Persona.od-Persona--xxl .od-Persona-image,.od-Persona.od-Persona--xxl .od-Persona-imageArea,.od-Persona.od-Persona--xxl .od-Persona-imageCircle{width:7.5rem;height:7.5rem}[dir=ltr] .od-Persona.od-Persona--xxl .od-Persona-imageArea{margin-right:1.25rem}[dir=rtl] .od-Persona.od-Persona--xxl .od-Persona-imageArea{margin-left:1.25rem}.od-Persona.od-Persona--xxl .od-Persona-image{line-height:7.5rem;font-size:1.75rem}.od-Persona.od-Persona--xxl .od-Persona-placeholder{font-size:5.9375rem;top:.75rem}.od-Persona.od-Persona--xxl .od-Persona-presence{height:1.75rem;width:1.75rem;border-width:.25rem}.od-Persona.od-Persona--xxl .od-Persona-primaryText{font-size:1.75rem;font-weight:300;margin-top:.125rem}.od-Persona.od-Persona--xxl .od-Persona-secondaryText{padding-top:.4375rem}.od-Persona.od-Persona--xxl .od-Persona-optionalText,.od-Persona.od-Persona--xxl .od-Persona-tertiaryText{padding-top:.5rem;display:block}.od-Persona.od-Persona--darkText .od-Persona-primaryText{color:'},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-Persona.od-Persona--darkText .od-Persona-optionalText,.od-Persona.od-Persona--darkText .od-Persona-secondaryText,.od-Persona.od-Persona--darkText .od-Persona-tertiaryText{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}"}]);Object(u.e)([{rawString:".ms-Presence{display:inline-block;width:.75rem;height:.75rem;z-index:1;margin:3px;border-radius:50%;border:2px solid "},{theme:"white",defaultValue:"#fff"},{rawString:";text-align:center;vertical-align:bottom}.ms-Presence.ms-Presence--Online{background-color:#7dbc00}.ms-Presence.ms-Presence--Busy{background-color:#e9001b}@media screen and (-ms-high-contrast:active){.ms-Presence.ms-Presence--Busy{background-color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.ms-Presence.ms-Presence--Busy{background-color:#37006e}}.ms-Presence.ms-Presence--DoNotDisturb{background-color:#eb0615}.ms-Presence.ms-Presence--BeRightBack{background-color:#f9ce15}.ms-Presence.ms-Presence--Away{background-color:#f9ce15}.ms-Presence.ms-Presence--Offline{background-color:#bd2eae}@media screen and (-ms-high-contrast:active){.ms-Presence.ms-Presence--Offline{background-color:"},{theme:"black",defaultValue:"#000"},{rawString:";box-shadow:0 0 0 1px "},{theme:"white",defaultValue:"#fff"},{rawString:" inset}}@media screen and (-ms-high-contrast:black-on-white){.ms-Presence.ms-Presence--Offline{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";box-shadow:0 0 0 1px "},{theme:"black",defaultValue:"#000"},{rawString:" inset}}.ms-Presence.ms-Presence--Hidden{background-color:#f1f1f1}.ms-Presence::before{font-size:8px;color:"},{theme:"white",defaultValue:"#fff"},{rawString:";line-height:.75rem;vertical-align:top;position:relative}@media screen and (-ms-high-contrast:active){.ms-Presence{border-color:"},{theme:"black",defaultValue:"#000"},{rawString:";box-shadow:0 0 0 1px #1aebff inset;color:"},{theme:"black",defaultValue:"#000"},{rawString:";background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.ms-Presence{border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";box-shadow:0 0 0 1px #37006e inset;color:"},{theme:"white",defaultValue:"#fff"},{rawString:";background-color:"},{theme:"black",defaultValue:"#000"},{rawString:"}}.od-Persona.od-Persona--lg .ms-Presence{width:1.25rem;height:1.25rem;border-width:3px}.od-Persona.od-Persona--lg .ms-Presence::before{line-height:1.25rem;font-size:14px}.od-Persona.od-Persona--xl .ms-Presence{width:1.75rem;height:1.75rem;border-width:4px}.od-Persona.od-Persona--xl .ms-Presence::before{line-height:1.75rem;font-size:21px}.od-focus--enabled a.ms-Presence{box-shadow:none}.od-focus--enabled .ms-Presence:focus:before{position:absolute;top:0;bottom:0;left:0;right:0;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:';content:"";border-radius:50%}'}]);var ie,se,oe,ue=n(218),ae=n(316),fe=n(76),le=n(29);(function(e){e[e.regularUser=0]="regularUser";e[e.externalUser=1]="externalUser";e[e.group=2]="group";e[e.application=3]="application";e[e.linkedinUser=4]="linkedinUser"})(ie||(ie={}));(function(e){e.graph="graph";e.sharepointSearch="sharepointSearch";e.substrate="substrate"})(se||(se={}));(function(e){e.unified="unifiedGroup";e.securityGroup="securityGroup";e.SPGroup="SPGroup";e.PublicDistributionList="PublicDistributionList";e.family="family"})(oe||(oe={}));var ce=(function(e){Object(r.r)(t,e);function t(){var n=e.call(this,t._Key,t._DataStoreCachingType)||this;n._MaxItems=200;n._Version=7;var r=window._sharingContextInfo;r&&(t._StorageKey="".concat(t._StorageKey).concat(r.webAbsoluteUrl));n._buffer=n.getValue(t._StorageKey);n._buffer&&n._buffer.version===n._Version||n._initializeBuffer();n._data={};for(var i=0;i<n._buffer.dataArray.length;i++)n._data[n._buffer.dataArray[i].email]=n._buffer.dataArray[i];return n}t.clear=function(){new fe.e(t._Key,t._DataStoreCachingType).remove(t._StorageKey)};t.isCacheEntryFresh=function(e,t){return e.name===t.name&&e.email===t.email&&e.job===t.job&&e.office===t.office&&e.department===t.department&&e.phone===t.phone};t.prototype.setItem=function(e){var n=this._data[e.email];if(n){if(t.isCacheEntryFresh(n,e))return;var r=this._buffer.dataArray.map(function(e){return e.userId}).indexOf(e.userId);this._buffer.dataArray[r]=e}else if(this._buffer.dataArray.length===this._MaxItems){this._buffer.index++;this._buffer.index>=this._MaxItems&&(this._buffer.index=0);var i=this._buffer.dataArray[this._buffer.index];delete this._data[i.email];this._buffer.dataArray[this._buffer.index]=e}else{this._buffer.dataArray.push(e);this._buffer.index++}this._data[e.email]=e;this.setValue(t._StorageKey,this._buffer)};t.prototype.getItems=function(e,t){for(var n=[],r=0;r<this._buffer.dataArray.length;r++){var i=(this._buffer.index-r+this._MaxItems)%this._MaxItems;!(this._buffer.dataArray[i].email&&this._buffer.dataArray[i].email.toLowerCase().indexOf(e.toLowerCase())>=0||this._buffer.dataArray[i].name&&this._buffer.dataArray[i].name.toLowerCase().indexOf(e.toLowerCase())>=0)||t&&this._buffer.dataArray[i].entityType===ie.externalUser||n.push(this._buffer.dataArray[i])}return n};t.prototype.containsItem=function(e){return!!this._data[e.email]};t.prototype._initializeBuffer=function(){this._buffer={};this._buffer.dataArray=[];this._buffer.index=-1;this._buffer.version=this._Version};t._Key="ClientPeoplePicker";t._StorageKey="MRU";t._DataStoreCachingType=le.e.local;return t})(fe.e),he=(function(){function e(e,t){var n=(this._dataSource=t.dataSource).getCapabilities().supportsMruCaching;n&&(this._mruCache=new ce);this.MaxCacheSuggestions=n?5:0}e.prototype.search=function(e,t){var n,r,i=this,s={cached:null,promise:null},o=t.useGraph,u=t.useSubstrate;!this._mruCache||t.groupID||o||u||(r=this._searchMruCache(e,t&&t.filterExternalUsers)).length>0&&(s.cached=r);s.promise=new v.t(function(s,o){n=i._dataSource.search(e,t).then(function(e){if(e)if(r){r.length>0&&(r=i._removeStaleCacheResults(r,e));var t=r.map(function(e){return e.userId});s(e.filter(function(e){return t.indexOf(e.userId)<0}))}else s(e)},function(e){o(e)})},function(){n&&n.cancel()});return s};e.prototype.resolve=function(e,t){var n=this;return this._dataSource.resolve(e,t).then(function(e){n._mruCache&&e.isResolved&&n.addToMruCache(e);return e})};e.prototype.getPersonaDetails=function(e){return this._dataSource.getPersonaDetails(e).then(function(e){return e})};e.prototype.sharePointSearch=function(e,t){return this._dataSource.sharePointSearch(e,t)};e.prototype.subscribePresence=function(e,t){return this._dataSource.subscribePresence(e,t)};e.prototype.addToMruCache=function(e){var t=this._mruCache;t&&e.rawPersonData&&e.rawPersonData.EntityData&&"UNVALIDATED_EMAIL_ADDRESS"!==e.rawPersonData.EntityData.PrincipalType&&t.setItem(e)};e.prototype.getPickerEntityInformation=function(e){return this._dataSource.getPickerEntityInformation(e)};e.prototype.getLivePersonaPickerHelper=function(){return this._dataSource.getLivePersonaPickerHelper&&this._dataSource.getLivePersonaPickerHelper()};e.prototype.canUseGraph=function(e){return this._dataSource.canUseGraph(e)};e.prototype._searchMruCache=function(e,t){var n=[],r=this._mruCache;if(r){n=r.getItems(e,t);var i=this.MaxCacheSuggestions;n.length>i&&(n=n.splice(0,i))}return n};e.prototype._removeStaleCacheResults=function(e,t){var n=e.map(function(e){return e.userId}),r=[];t.forEach(function(t){var i=n.indexOf(t.userId);if(i>-1){var s=e[i];ce.isCacheEntryFresh(s,t)&&r.push(s)}});return r};return e})(),pe=Object(ue.i)("PeoplePickerProvider",he,{dataSource:ae.e}),de=n(564),ve=n(13),me=(function(e){Object(r.r)(t,e);function t(t){var n=e.call(this)||this;n.strings=de;n.sip=f.isObservable(t.sip)?t.sip:f.observable(t.sip||"");n.presenceType=f.observable(0);n._dataProvider=n.resources.consume(pe);n.registerPresence(n.sip());n.isVisible=!!n._presenceDisposable;n._sipSubscriptionOld=n.sip.subscribe(function(e){n.unRegisterPresence(e)},n,"beforeChange");n._sipSubscriptionNew=n.sip.subscribe(function(e){n.registerPresence(e)},n);n.presenceClass=n.createComputed(n._computePresenceClass);n.presenceTypeText=n.createComputed(n._computePresenceTypeText);return n}t.prototype.dispose=function(){e.prototype.dispose.call(this);this.unRegisterPresence(this.sip());this._sipSubscriptionOld&&this._sipSubscriptionOld.dispose();this._sipSubscriptionNew&&this._sipSubscriptionNew.dispose()};t.prototype.registerPresence=function(e){var t=this;this._dataProvider&&e&&(this._presenceDisposable=this._dataProvider.subscribePresence(e,function(e){t._presenceCallback(e)}))};t.prototype.unRegisterPresence=function(e){this._presenceDisposable&&this._presenceDisposable.dispose()};t.prototype._presenceCallback=function(e){!this.isDisposed&&this.presenceType&&this.presenceType(e)};t.prototype._computePresenceTypeText=function(){var e="";switch(this.presenceType()){case 1:e=this.strings.online;break;case 2:e=this.strings.busy;break;case 3:e=this.strings.doNotDisturb;break;case 4:e=this.strings.beRightBack;break;case 5:e=this.strings.away;break;case 6:e=this.strings.offline}return e};t.prototype._computePresenceClass=function(){var e="";switch(this.presenceType()){case 1:e="ms-Presence--Online ".concat(Object(ve.g)("SkypeCheck"));break;case 2:e="ms-Presence--Busy";break;case 3:e="ms-Presence--DoNotDisturb ".concat(Object(ve.g)("SkypeMinus"));break;case 4:e="ms-Presence--BeRightBack";break;case 5:e="ms-Presence--Away ".concat(Object(ve.g)("SkypeClock"));break;case 6:e="ms-Presence--Offline";break;case 7:case 0:e="ms-Presence--Hidden";break;default:e="ms-Presence--Hidden"}return"ms-Presence "+e};return t})(re.e),ge=n(224);ge.e({tagName:"ms-presence",template:'<a data-bind="css:presenceClass,visible:isVisible,attr:{title:presenceTypeText,\'aria-label\':presenceTypeText}" class="od-Persona-presence"></a>',viewModel:me});Object(u.e)([{rawString:".od-Persona-image{display:inline-block;width:3.125rem;height:3.125rem;border-radius:50%;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:';font-size:1.3125rem;position:relative;overflow:hidden;text-align:center;vertical-align:middle}.od-Persona-image.ms-Icon{line-height:3.125rem}.od-Persona-image>img{display:none;position:absolute;left:0;top:0;width:100%;height:100%;-o-object-fit:cover;object-fit:cover}.od-Persona-image--isLoaded>img{display:block;border-radius:50%}.od-Persona-userInitials{font-family:"Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;position:absolute;font-size:.875rem;font-weight:400;color:'},{theme:"white",defaultValue:"#fff"},{rawString:";width:100%;height:100%;top:0;left:0;border-radius:50%}"}]);var ye,be=n(549),we=n(112),Ee=[],Se=(function(){function e(e,t,n){this.complete=!1;this.pending=!1;this.eventName="cookieToss";this._lastAttempt=0;this.domainRegex=e;this.iframeSrc=t;this.complete=n}e.initializeAuthenticators=function(t,n){if(n)if(window.$Config.aadClientId&&"live.com"===window.$Config.domain);else{for(var r=n.s,i=n.r,s=0;r&&s<r.length;s++)Ee.push(new e(t[s],r[s],!i[s]));n.c=function(e){Ee[e].onAuthComplete()};e.authenticate("https://livefilestore.com/");e.authenticate("https://1drv.com/")}};e.authenticate=function(e){for(var t,n=0;n<Ee.length;n++){var r=Ee[n];if(r.requiresAuth(e)){t=r.authenticate(e);break}}for(var i=[t||v.t.wrap(!0)],s=0,o=this._cookieCheckers;s<o.length;s++){var u=o[s];u.isApplicable(e)&&i.push(u.check(e))}return v.t.all(i).then(function(e){return e.reduce(function(e,t){return e&&t})})};e.registerCookieChecker=function(e){this._cookieCheckers.push(e)};e.prototype.requiresAuth=function(e){return this.domainRegex.test(e)};e.prototype.authenticate=function(e){var t=(new Date).getTime();if(t-this._lastAttempt>6e5){this._authPromise=null;this._lastAttempt=t}if(!this._authPromise){this._authPromise=new p.e;var n=document.createElement("IFRAME");n.src=this.iframeSrc;n.style.display="none";document.body.appendChild(n)}return this._authPromise.getPromise()};e.prototype.onAuthComplete=function(){this._authPromise.complete(!0)};e._cookieCheckers=[];return e})(),xe=n(287),Te=n(210),Ne=n(9),Ce=n(45);(function(e){e[e.none=0]="none";e[e.queue=1]="queue";e[e.server=2]="server"})(ye||(ye={}));var ke=ye,Le=Object(Te.e)({eventName:"ImageLoad,Qos,",shortEventName:"ImageLoad"},{loadType:{typeRef:ye,type:Ne.e.Enum}},Ce.e),Ae=(function(e){Object(r.r)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r._recordsByThumbnailKey={};r._bucketsByImageKey={};var i=r.observables;r.lastAccessedDate=i.create(new Date);var s=n.pruneThumbnailsExtenders,o=void 0===s?{rateLimit:{timeout:6e5}}:s;i.backgroundCompute(r._pruneThumbnails).extend(o);return r}t.prototype.getCoveragePercent=function(e,t){var n=De(e),r=De(t);return Math.sqrt(r/n)};t.prototype.register=function(e,t,n,r){void 0===n&&(n=t);void 0===r&&(r=!0);var i=this.lastAccessedDate;i(new Date);var s=_e(this.getCoveragePercent(e,n)),o=Me(e),u=Me(t),a=this._recordsByThumbnailKey,f=this._bucketsByImageKey,l=a[o]||{lastAccessed:void 0,buckets:{}};l.lastAccessed=i.peek();var c=l.buckets[s];if(!c||this.getCoveragePercent(c.size,n)>1){c&&delete f[c.key];c=l.buckets[s]={key:u,size:n,image:t,isLoaded:r,lastAccessed:i.peek()}}f[u]=c;a[o]=l};t.prototype.record=function(e){var t=this.lastAccessedDate;t(new Date);var n=Me(e),r=this._bucketsByImageKey,i=r[n];i?i.isLoaded=!0:r[n]={key:n,size:e,image:e,isLoaded:!0,lastAccessed:t.peek()}};t.prototype.isLoaded=function(e){var t=this.lastAccessedDate;t(new Date);var n=Me(e),r=this._bucketsByImageKey[n];r&&(r.lastAccessed=t.peek());return!!r&&r.isLoaded};t.prototype.retrieve=function(e,t,n){void 0===t&&(t=1);void 0===n&&(n=t);var r=Me(e),i=this._recordsByThumbnailKey[r],s=this.lastAccessedDate;s(new Date);if(i){var o=i.buckets;i.lastAccessed=s.peek();var u=_e(t),a=_e(n),f=-1/0,l=!1;for(var c in o){var h=Number(c);if(h<=u&&h>=a&&o[h].isLoaded){f=Math.max(f,h);l=!0}}var p=l&&o[f];return p&&p.image}};t.prototype._pruneThumbnails=function(){var e=this.lastAccessedDate().getTime();Pe(this._recordsByThumbnailKey,e);Pe(this._bucketsByImageKey,e)};return t})(C.t),Oe=Object(ue.i)("ThumbnailCache",Ae);function Me(e){var t=e.url,n=e.width,r=e.height;return JSON.stringify({url:t,width:n,height:r})}function _e(e){return Math.floor(Math.log(e)/Math.log(2)*4)}function De(e){return e.width*e.height}function Pe(e,t){for(var n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];t-e[i].lastAccessed.getTime()>432e5&&delete e[i]}}var He,Be,je,Fe=n(52),Ie=n(17),qe=!Ie.t.isActivated("C123FC1B-1706-4C97-AFF3-45C077654F1A","08/11/2022","Enable not pre-auth vroom style image preview"),Re=(function(e){Object(r.r)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._semaphore=new xe.e(16);r._thumbnailCache=n.thumbnailCache;return r}t.prototype.loadImage=function(e){var t=this,n=e.url,r=e.imageElement,i=void 0===r?document.createElement("img"):r,s=e.scenarioName,o=e.getContents,u={url:n,width:0,height:0},a=this._thumbnailCache,f=a.isLoaded(u),l=function(e){return Se.authenticate(e).then(function(){return t._waitForImageLoad(i,e,s)}).then(function(e){a.record(u);if(i.complete&&!e)return t._waitForTimeout(300)}).then(function(){var t=i.naturalWidth||i.width,n=i.naturalHeight||i.height;return{url:e,width:t,height:n}})};return qe&&o?this.trackPromise(o(void 0,n).then(function(e){var n=URL.createObjectURL(e);return f?l(n):t._semaphore.enqueue(function(){return l(n)})})):f?l(n):this._semaphore.enqueue(function(){return l(n)})};t.prototype._waitForImageLoad=function(e,t,n){var r,i,s,o=this.async,u=this.events,a=function(){s&&o.clearTimeout(s);u.off(e)},f=new p.e(function(){a();e.setAttribute("src","");t&&/^blob:/.test(t)&&URL.revokeObjectURL(t)}),l=t&&t.indexOf("&encodeFailures=1")>=0;u.onAll(e,{load:function(){a();if(l&&1===e.naturalWidth&&e.naturalHeight>6e4){var t=e.naturalHeight-6e4,n=406===t||412===t;i&&i.end({resultType:n?q.e.ExpectedFailure:q.e.Failure,resultCode:"".concat(t),error:"Encoded failure"});f.error(new Fe.e({code:"".concat(t),isExpected:n,message:"Server returned encoded failure ".concat(t)}))}else{i&&i.end({resultType:q.e.Success});f.complete(r)}},error:function(){a();i&&i.end({resultType:q.e.Failure});f.error(new Error("Image '".concat(t,"' failed to load")))}});s=o.setTimeout(function(){f.cancel()},3e4);n&&(i=new Le({name:n,loadType:ke.server}));e.setAttribute("src",t);r=!!e.complete;return this.trackPromise(f.getPromise())};t.prototype._waitForTimeout=function(e){var t,n=this.async,r=new p.e(function(){t&&n.clearTimeout(t)});t=n.setTimeout(function(){r.complete()},e);return r.getPromise()};t.dependencies=Object(r.e)(Object(r.e)({},C.t.dependencies),{thumbnailCache:Oe});return t})(C.t),Ue=Object(ue.i)("ImageLoader",Re),ze=(function(e){Object(r.r)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t)||this;r._debouncer=new d;r._imageLoader=r.resources.consume(Ue);var i=r.valueAccessor(),s=i.src,o=i.image,u=i.error,a=i.isLoaded,f=i.isError,l=i.actualSize,c=i.scenarioName,h=i.getContents;r._src=r.wrapObservable(s);r._image=r.wrapObservable(o);r._error=r.wrapObservable(u);r._scenarioName=c;r._getContents=h;var p=n.outputExtenders,v=void 0===p?{deferred:!0}:p;r.createComputed(r._computeLoadImage);r.createBackgroundComputed(function(){var e=r._image();a&&a(!!e);if(l){var t=void 0;if(e){t={width:e.width,height:e.height}}l(t)}o&&o(e)}).extend(v);r.createBackgroundComputed(function(){var e=r._error();u&&u(e);f&&f(!!e)}).extend(v);return r}t.prototype._computeLoadImage=function(){var e,t=this,n=this.unwrapObservable(this._src),r=this.unwrapObservable(this._getContents);this._image(void 0);this._scenarioName&&(e=new Le({name:this._scenarioName,loadType:ke.queue}));this._debouncer.debounce(this.trackPromise(this._imageLoader.loadImage({url:n,imageElement:this.element,scenarioName:this._scenarioName,getContents:r}))).then(function(n){t._image(n);t._error(void 0);e&&e.end({resultType:q.e.Success})},function(n){t._error(n);e&&e.end({resultType:n.isExpected?q.e.ExpectedFailure:q.e.Failure})})};return t})(c.t),We=n(5);(function(e){e[e.tiny=0]="tiny";e[e.extraExtraSmall=1]="extraExtraSmall";e[e.extraSmall=2]="extraSmall";e[e.small=3]="small";e[e.regular=4]="regular";e[e.large=5]="large";e[e.extraLarge=6]="extraLarge";e[e.size8=17]="size8";e[e.size10=9]="size10";e[e.size16=8]="size16";e[e.size24=10]="size24";e[e.size28=7]="size28";e[e.size32=11]="size32";e[e.size40=12]="size40";e[e.size48=13]="size48";e[e.size56=16]="size56";e[e.size72=14]="size72";e[e.size100=15]="size100";e[e.size120=18]="size120"})(He||(He={}));(function(e){e[e.none=0]="none";e[e.offline=1]="offline";e[e.online=2]="online";e[e.away=3]="away";e[e.dnd=4]="dnd";e[e.blocked=5]="blocked";e[e.busy=6]="busy"})(Be||(Be={}));(function(e){e[e.lightBlue=0]="lightBlue";e[e.blue=1]="blue";e[e.darkBlue=2]="darkBlue";e[e.teal=3]="teal";e[e.lightGreen=4]="lightGreen";e[e.green=5]="green";e[e.darkGreen=6]="darkGreen";e[e.lightPink=7]="lightPink";e[e.pink=8]="pink";e[e.magenta=9]="magenta";e[e.purple=10]="purple";e[e.black=11]="black";e[e.orange=12]="orange";e[e.red=13]="red";e[e.darkRed=14]="darkRed";e[e.transparent=15]="transparent";e[e.violet=16]="violet";e[e.lightRed=17]="lightRed";e[e.gold=18]="gold";e[e.burgundy=19]="burgundy";e[e.warmGray=20]="warmGray";e[e.coolGray=21]="coolGray";e[e.gray=22]="gray";e[e.cyan=23]="cyan";e[e.rust=24]="rust"})(je||(je={}));var Xe=[je.lightBlue,je.blue,je.darkBlue,je.teal,je.green,je.darkGreen,je.lightPink,je.pink,je.magenta,je.purple,je.orange,je.lightRed,je.darkRed,je.violet,je.gold,je.burgundy,je.warmGray,je.cyan,je.rust,je.coolGray],Ve=Xe.length;function $e(e){var t=e.primaryText,n=e.text,r=e.initialsColor;return"string"==typeof r?r:(function(e){switch(e){case je.lightBlue:return"#4F6BED";case je.blue:return"#0078D4";case je.darkBlue:return"#004E8C";case je.teal:return"#038387";case je.lightGreen:case je.green:return"#498205";case je.darkGreen:return"#0B6A0B";case je.lightPink:return"#C239B3";case je.pink:return"#E3008C";case je.magenta:return"#881798";case je.purple:return"#5C2E91";case je.orange:return"#CA5010";case je.red:return"#EE1111";case je.lightRed:return"#D13438";case je.darkRed:return"#A4262C";case je.transparent:return"transparent";case je.violet:return"#8764B8";case je.gold:return"#986F0B";case je.burgundy:return"#750B1C";case je.warmGray:return"#7A7574";case je.cyan:return"#005B70";case je.rust:return"#8E562E";case je.coolGray:return"#69797E";case je.black:return"#1D1D1D";case je.gray:return"#393939"}})(r=void 0!==r?r:(function(e){var t=je.blue;if(!e)return t;for(var n=0,r=e.length-1;r>=0;r--){var i=e.charCodeAt(r),s=r%8;n^=(i<<s)+(i>>8-s)}return t=Xe[n%Ve]})(n||t))}var Je,Ke=(function(e){Object(r.r)(t,e);function t(t){var n=e.call(this,t)||this;n.charsWithinParenthesisRegex=/\(([^)]*)\)/gi;n.excludedCharactersRegex=/\([^)]*\)|[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/gi;n.multipleSpacesRegex=/\s+/gi;n.isImageLoaded=f.observable(!1);n.addBindingHandlers({imageLoader:ze});n.person=f.isObservable(t.person)?t.person:f.observable(t.person);n.disablePictrueAlt=t.disablePictrueAlt;n.pictureAlt=n.createComputed(n._computePictureAlt);n._iconType=t.iconType;n.isNewHasAccessControlEnabled=We.ne(We.p);return n}t.prototype.getIconType=function(e){if(this._iconType)return this._iconType;switch(e?e.type:3){case 1:return"Contact";case 0:return"Mail";default:return"People"}};t.prototype.getInitial=function(e){var t="";if(!e)return t;var n=(e=(e=(e=(e=e.replace(this.charsWithinParenthesisRegex,"")).replace(this.excludedCharactersRegex,"")).replace(this.multipleSpacesRegex," ")).trim()).split(" ");if(n.length>=2){t+=n[0].charAt(0).toUpperCase();t+=n[n.length-1].charAt(0).toUpperCase()}else 0!==n.length&&(t+=n[0].charAt(0).toUpperCase());return t};t.prototype.getTextBoyColor=function(e){return $e({text:e})};t.prototype._computePictureAlt=function(){var e=we.n(be.o,f.utils.unwrapObservable(this.person().name));return this.disablePictrueAlt?"":e};return t})(re.e),Qe=ge.e({tagName:"od-persona-image",template:'<div class="od-Persona-image ms-Icon" role="img" data-bind="icon:true,class:\'ms-Icon--\'+getIconType(person().sharingInfo),css:{\'od-Persona-image--isLoaded\':isImageLoaded},attr:{\'aria-label\':person().name}">\x3c!--ko if:isNewHasAccessControlEnabled--\x3e<div class="od-Persona-userInitials" data-bind="style:{\'background-color\':getTextBoyColor(person().name)},text:getInitial(person().name)"></div>\x3c!--/ko--\x3e\x3c!--ko if:person().image--\x3e<img data-bind="imageLoader:{src:person().image,isLoaded:isImageLoaded,scenarioName:\'personaImage\'},attr:{alt:pictureAlt}">\x3c!--/ko--\x3e</div>',viewModel:Ke});n(271);(function(e){e[e.initialized=0]="initialized";e[e.executed=1]="executed";e[e.failed=2]="failed"})(Je||(Je={}));var Ge=Je;Object(u.e)([{rawString:".Beak-container{position:absolute;width:100%;height:100%}.Beak-container .Beak-arrow.Beak--themePrimary{background:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.Beak-container .Beak-arrow.Beak--white{background:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.Beak-container .Beak-arrow.Beak--neutralLighterAlt{background:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:"}.Beak-container .Beak-arrow.Beak--themeTertiary{background:"},{theme:"themeTertiary",defaultValue:"#71afe5"},{rawString:"}.Beak-arrow{box-shadow:0 0 5px 0 "},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:";width:16px;position:relative;transform:rotate(45deg);height:16px;transition:left 1s ease-in-out,right 1s ease-in-out}.Beak-arrow--centered{transform:translateX(-50%) rotate(45deg)!important}html[dir=ltr] .Beak-arrow--centered{left:50%}html[dir=rtl] .Beak-arrow--centered{right:50%}html[dir=rtl] .Beak-arrow--centered{transform:translateX(50%) rotate(45deg)!important}"}]);var Ye=n(310),Ze=n(257);function et(e,t,n){void 0===n&&(n=!0);for(;e&&e!==document.body;){if(Ye.e.hasClass(e,t))return e;e=Object(Ze.e)(e,n)}return null}var tt=n(49),nt=n(73),rt=n(105),it=n(160),st=n(383),ot={Small:"sm",Medium:"md",Large:"lg",XLarge:"xlg",XXLarge:"xxlg",XXXLarge:"xxxlg",XXXXLarge:"xxxxlg"},ut={Small:480,Medium:640,Large:1024,XLarge:1366,XXLarge:1920,XXXLarge:2560,XXXXLarge:1/0},at=new h.t({name:"".concat("ResponsiveUI",".breakpoints"),factory:new h.e(ut)}),ft=(function(e){Object(r.r)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._containerElement=t.containerElement||window;var i=r.observables;r._breakpoints=i.wrap(n.breakpoints);r.events.on(r._containerElement,"resize, orientationchange",r._onContainerResize);r.windowWidth=i.create(0);r.windowHeight=i.create(0);r.formFactorSize=i.pureCompute(r._computeFormFactorSize);r.isHamburgerVisible=i.pureCompute(r._computeIsHamburgerVisible);r.showLabels=i.pureCompute(r._computeShowLabels);r.cssClass=i.pureCompute(r._computeCssClass);r._onContainerResize();return r}t.reduceBreakpoints=function(e,t){return{Small:t,Medium:e.Small,Large:e.Medium,XLarge:e.Large,XXLarge:e.XLarge,XXXLarge:e.XXLarge,XXXXLarge:1/0}};t.determineWindowSize=function(e,t){void 0===t&&(t=ut);if(0===e)return"Medium";for(var n in ut)if(e<t[n])return n};t.determineCssClass=function(e){return ot[e]};t.getScrollbarWidth=function(){var e=document.createElement("div"),t=e.style;t.visibility="hidden";t.width="100px";t.msOverflowStyle="scrollbar";document.body.appendChild(e);var n=e.offsetWidth;t.overflow="scroll";var r=document.createElement("div");r.style.width="100%";e.appendChild(r);var i=r.offsetWidth;e.parentNode.removeChild(e);var s=n-i;this.getScrollbarWidth=function(){return s};return s};t.prototype.compareSize=function(e,t){var n=this._breakpoints();return n[e]-n[t]};t.prototype._onContainerResize=function(e){var t=this._containerElement,n=document.body,r=document.documentElement,i=t.clientWidth||r.clientWidth||t.innerWidth||n.clientWidth,s=t.clientHeight||r.clientHeight||t.innerHeight||n.clientHeight;this.windowWidth(i);this.windowHeight(s)};t.prototype._computeFormFactorSize=function(){var e=this._breakpoints(),n=this.windowWidth();return this._containerElement===window?t.determineWindowSize(n,e):"Medium"};t.prototype._computeCssClass=function(){return t.determineCssClass(this.formFactorSize())};t.prototype._computeShowLabels=function(){return this.compareSize(this.formFactorSize(),"Medium")>0};t.prototype._computeIsHamburgerVisible=function(){return this.windowWidth()<ut.Large};t.dependencies={breakpoints:at};t.DEFAULT_BREAKPOINTS=ut;t.MAC_SCROLL_BAR_WIDTH=8;return t})(C.t),lt=Object(ue.i)("ResponsiveUI",ft),ct=(function(e){Object(r.r)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._responsiveUI=n.resources.consume(lt);return n}t.calculateParentRect=function(e,t){var n=e,r=[];do{if("none"===n.style.display){r.push(n);n.style.display=""}else n=n.parentElement;t=Ye.e.calculateRect(e)}while(0===t.x&&n!==document.body);r.forEach(function(e){e.style.display="none"});return t};t.prototype.assignAlignment=function(e){var t=e.alignment;return t?"string"==typeof t?this.createObservable(rt.e[t]):this.wrapObservable(t):this.createObservable(rt.e.Left|rt.e.Top)};t.prototype.computePositioningStyles=function(e){var t=this,n=e.renderedTemplate,r=e.clientRect,i=e.style,s=e.contentStyle,o=e.trigger,u=e.hasExplicitAlignment,a=e.alignment,f=e.allowMenuNudging,l=e.left,c=e.top,h=e.beak,p=e.isScrollable,d=e.userOffset;this.createComputed(function(){var e=new it.e(l(),c()),v=new st.e(0,0,t._responsiveUI.windowWidth(),t._responsiveUI.windowHeight()),m="",g="";v=v.inflate(-4,-4);if(n()&&r()){var y=-parseFloat(""+Number(!!i().marginLeft)),b=-parseFloat(""+Number(!!i().marginRight)),w=r().translate(y,b);o();e=e.add(d());var E=a();u||(E=t._determineBestFitAlignment(w,E));e=t._transformMenuCoordinate(e,w,E);var S=void 0;if(0===Object.keys(i()).length){i({left:Math.floor(e.x)+"px",top:Math.floor(e.y)+"px"});S=new st.e(w.x+e.x,w.y+e.y,w.width,w.height)}else S=new st.e(w.x+parseInt(i().left,10),w.y+parseInt(i().top,10),w.width,w.height);var x=v.contains(new it.e(S.x,S.y)),T=v.contains(new it.e(S.x+S.width,S.y));if(!x||!T){var N=f?S.nudge(v):S;if(!v.contains(N)){m=(N=N.clip(v)).width+"px";g=N.height+"px";p(!0)}e=e.add(new it.e(N.x-S.x,N.y-S.y));i({left:Math.floor(e.x)+"px",top:Math.floor(e.y)+"px"})}p(!1);t.async.setTimeout(function(){h({})},200)}s({width:m,height:g})}).extend({deferred:!0})};t.prototype._determineBestFitAlignment=function(e,t){var n=t,r=e.getPoint();if(e.width<=document.body.clientWidth&&e.height<=document.body.clientHeight){var i=this._transformMenuCoordinate(r,e,n);(i.x<0||i.x+e.width>document.body.clientWidth)&&(n^=rt.e.Right);(i.y<0||i.y+e.height>document.body.clientHeight)&&(n^=rt.e.Bottom)}return n};t.prototype._transformMenuCoordinate=function(e,t,n){var r=new it.e(e.x,e.y);if(n){(n&rt.e.Right)===rt.e.Right?r.x-=t.width:(n&rt.e.Center)===rt.e.Center&&(r.x-=t.width/2);(n&rt.e.Bottom)===rt.e.Bottom?r.y-=t.height:(n&rt.e.VerticalCenter)===rt.e.VerticalCenter&&(r.y-=t.height/2)}return r};return t})(C.t),ht=n(204),pt=(function(){function e(){}e.init=function(t,n){var r,i=f.utils.unwrapObservable(n())||{},s=f.utils.unwrapObservable(i.anchorElement),o=i.isVisible,u=void 0===o?f.observable(!0):o,a=i.beakColorVariation,l=i.isBeakCenterAligned,c=void 0===l?f.observable(!1):l,h=i.beakSize,p=void 0===h?e.size:h;(s||(s=et(t,"beak-anchor")))&&f.computed(function(){f.utils.unwrapObservable(i.trigger);r&&f.removeNode(r);(r=document.createElement("div")).className="Beak-container";var n=document.createElement("div");n.className="Beak-arrow";var o=Ye.e.calculateRect(t),l=Ye.e.calculateRect(s);0===l.x&&(l=ct.calculateParentRect(s,l));var h,d,v=p/2,m=e.determineBeakDirection(o,l),g=0;if(0===m||1===m){g=l.getCenter().y-o.getTop();g=e.clamp(g,2*p,o.height-2*p)}else{g=tt.e.isRightToLeft?o.getRight()-l.getCenter().x:l.getCenter().x-o.getLeft();o.width>2&&(g=e.clamp(g,2*p,o.width-2*p))}switch(m){case 0:d=-v;h=g-p;break;case 1:d=o.width-p-v;h=g-p;break;case 2:d=g-p;h=-v;break;case 3:d=g-p;h=o.height-p-v}f.utils.unwrapObservable(c)?n.className+=" Beak-arrow--centered":tt.e.isRightToLeft?n.style.right=d+"px":n.style.left=d+"px";n.style.top=h+"px";switch(a){case nt.e.themePrimary:n.className+=" Beak--themePrimary";break;case nt.e.neutralLighterAlt:n.className+=" Beak--neutralLighterAlt";break;case nt.e.themeTertiary:n.className+=" Beak--themeTertiary";break;default:n.className+=" Beak--white"}r.appendChild(n);t.insertBefore(r,t.firstChild);r.style.display=u()?"":"none"},null,{disposeWhenNodeIsRemoved:t})};e.clamp=function(e,t,n){return Math.max(Math.min(e,n),t)};e.determineBeakDirection=function(e,t){var n=e.getCenter(),r=t.getCenter();return r.y>=e.getTop()&&r.y<e.getBottom()?r.x<n.x?0:1:r.y<n.y?2:3};e.after=["component"];e.size=ht.e;return e})(),dt=n(75),vt=n(511),mt=n(146),gt=n(170),yt=(function(e){Object(r.r)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=r.observables;r._activeElement=i.create({});r.activeElement=i.pureCompute(r._computeActiveElement);r.activeElement.equalityComparer=mt.t;r.isWindowActive=i.create(!0);r._isWithinWindowBlur=!1;r._platform=n.platFormDetection;var s=r.async.throttle(function(){r._activeElement({})},350),o=r._platform&&r._platform.isEdge,u=r._platform&&r._platform.isIE;if(o||u){var a=new MutationObserver(s);a.observe(document.body,{childList:!0,subtree:!0});r.scope.attach({dispose:function(){a&&a.disconnect()}})}r.events.onAll(window,{focus:r._onWindowFocus,blur:r._onWindowBlur},!1);r.events.onAll(document.body,{focus:r._onDocumentFocus,blur:r._onDocumentBlur},!0);return r}t.prototype._computeActiveElement=function(){this._activeElement();return document.activeElement};t.prototype._onWindowFocus=function(e){this.async.clearTimeout(this._windowBlurTimeout);this._isWithinWindowBlur=!1;this.isWindowActive(!0)};t.prototype._onDocumentFocus=function(e){if(!this._isWithinWindowBlur){this.isWindowActive(!0);var t=document.activeElement;this.async.clearTimeout(this._blurTimeout);window.__debugFocus&&console.log("[focus] active:",t);this._activeElement({})}};t.prototype._onWindowBlur=function(e){var t=this;this._isWithinWindowBlur=!0;this.isWindowActive(!1);this._windowBlurTimeout=this.async.setTimeout(function(){t._isWithinWindowBlur=!1},10)};t.prototype._onDocumentBlur=function(e){var t=this;if(!this._isWithinWindowBlur){this.isWindowActive(!0);var n=document.activeElement;this.async.clearTimeout(this._blurTimeout);if(n&&n!==document.body){window.__debugFocus&&console.log("[focus] blur:",n);this._activeElement({})}else{window.__debugFocus&&console.log("[focus] wait:",n);this._blurTimeout=this.async.setTimeout(function(){window.__debugFocus&&console.log("[focus] then blur:",document.activeElement,"from",n);t._activeElement({})},Ie.e.isActivated("759ADC51-E16E-4AA6-9DBD-E84CF7AACBA5","10/24/2022","Add grace period for detecting body focus")?0:10)}}};t.dependencies=Object(r.e)(Object(r.e)({},C.t.dependencies),{platFormDetection:gt.e});return t})(C.t),bt=Object(ue.i)("FocusTracker",yt,Object(r.e)(Object(r.e)({},C.t.dependencies),{platFormDetection:gt.e})),wt=(function(e){Object(r.r)(t,e);function t(t){var n,r,i,s=e.call(this,t)||this,o=t.valueAccessor();if((function(e){return"object"==typeof e})(o)){n=o.isBodyActive;r=o.activeElement;i=o.isDescendantOrSelfActive}else i=o;s._focusTracker=s.resources.consume(bt);var u=s.observables;if(i){var a=u.pureCompute(s._computeIsDescendantOrSelfActive);u.compute(function(){i(a())}).extend({deferred:!0})}if(n){var f=u.pureCompute(s._computeIsBodyActive);u.compute(function(){n(f())}).extend({deferred:!0})}if(r){var l=u.pureCompute(s._computeActiveElement);u.compute(function(){r(l())}).extend({deferred:!0})}return s}t.prototype._computeIsDescendantOrSelfActive=function(){var e=this.element,t=this._focusTracker.activeElement();return!!t&&(e===t||Object(vt.e)(e,t))};t.prototype._computeIsBodyActive=function(){var e=this._focusTracker.activeElement();return!e||e===document.body};t.prototype._computeActiveElement=function(){return this._focusTracker.activeElement()};return t})(c.t);var Et=(function(e){Object(r.r)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t)||this;r._parentScope=(function(e){var t,n=e;for(;!(t=f.utils.domData.get(n,"InteractionScopeBinding_scope"))&&n!==document.body&&Object(Ze.e)(n);)n=Object(Ze.e)(n);return n!==document.body&&t||void 0})(r.element);var i=r.valueAccessor(),s=i.isScope,o=void 0!==s&&s,u=i.isRoot,a=void 0!==u&&u;if(o){r._childScopes=f.observableArray();r._hasFocus=f.observable(!1);r._isRoot=a;r._isActive=r.createPureComputed(r._computeIsActive,{deferEvaluation:!0});r._isDescendantActive=r.createPureComputed(r._computeIsDescendantActive,{deferEvaluation:!0});r._scope={isActive:r._isActive,isDescendantActive:r._isDescendantActive,isDescendantOrSelfActive:r.createComputed(r._computeIsDescendantOrSelfActive),register:function(e){return r._registerScope(e)},_owner:r};f.utils.domData.set(r.element,"InteractionScopeBinding_scope",r._scope);var l=n.ChildFocusBinding,c=void 0===l?wt:l;new(r.managed(c))({element:r.element,bindingContext:r.bindingContext,allBindingsAccessor:r.allBindingsAccessor,valueAccessor:function(){return r._hasFocus}});r._parentScope&&r.addDisposable(r._parentScope.register(r._scope))}else if(r._parentScope){r._isActive=r._parentScope.isActive;r._isDescendantActive=r._parentScope.isDescendantActive}else{r._isActive=f.observable(!0);r._isDescendantActive=f.observable(!1)}i.isActive&&r.createComputed(function(){return i.isActive(r._isActive())});i.isDescendantActive&&r.createComputed(function(){return i.isDescendantActive(r._isDescendantActive())});return r}t.prototype._registerScope=function(e){var t=this;this._childScopes.push(e);return{dispose:function(){t._childScopes.remove(e)}}};t.prototype._computeIsDescendantOrSelfActive=function(){var e=this._hasFocus(),t=this._isDescendantActive();return e||t};t.prototype._computeIsActive=function(){var e=this._hasFocus(),t=this._isDescendantActive();return(this._isRoot||e)&&!t};t.prototype._computeIsDescendantActive=function(){for(var e=!1,t=0,n=this._childScopes();t<n.length;t++){n[t].isDescendantOrSelfActive()&&(e=!0)}return e};return t})(c.t);var St={INPUT:!0,TEXTAREA:!0},xt={A:!0,BUTTON:!0};var Tt={Left:"Right",Right:"Left"},Nt={Esc:!0};var Ct=(function(e){Object(r.r)(t,e);function t(n){var r=e.call(this,n)||this,i=r.valueAccessor();if(i instanceof Array)for(var s=function(e){return function(){return e}},o=function(e){new(r.managed(t))({element:r.element,valueAccessor:s(e),bindingContext:r.bindingContext,allBindingsAccessor:r.allBindingsAccessor})},u=0,a=i;u<a.length;u++){o(a[u])}else{if("object"!=typeof i)throw new Error("KeyboardBinding only accepts an object for input. See documentation.");var f=i.mappings&&i||{mappings:i},l=f.target||r.element,c=f.useCapture,h=void 0!==c&&c;r._options=f;r.events.on(l,"keydown",r._onKeyDown,h);r._isActive=f.isActive||r.observables.create(!1);new(r.managed(Et))({element:r.element,bindingContext:r.bindingContext,allBindingsAccessor:r.allBindingsAccessor,valueAccessor:function(){return{isActive:r._isActive}}})}return r}t.prototype._onKeyDown=function(e){var t=this._options,n=t.allowInputEvents,r=t.allowButtonEvents,i=t.context,s=void 0===i?this.bindingContext.$data:i,o=t.preventDefault,u=t.eventFilter,a=e.target,f=(function(e){var t;t=(function(e){var t;if(e>=65&&e<=91)t=String.fromCharCode(e);else switch(e){case 8:t="Backspace";break;case 9:t="Tab";break;case 13:t="Enter";break;case 27:t="Esc";break;case 32:t="Space";break;case 37:t="Left";break;case 38:t="Up";break;case 39:t="Right";break;case 40:t="Down";break;case 46:t="Delete";break;case 113:t="F2";break;case 117:t="F6";break;case 191:t="/";break;case 121:t="F10";break;default:t=""}return t})(e.keyCode);e.metaKey&&(t="Meta"+t);e.ctrlKey&&(t="Ctrl"+t);e.altKey&&(t="Alt"+t);e.shiftKey&&(t="Shift"+t);return t})(e),l=!r&&a!==this.element&&(function(e){return!!(e&&e.tagName in xt)})(a),c=!Nt[f]&&!n&&a!==this.element&&(function(e){var t=e;return!!(t&&(t.tagName in St||t.isContentEditable))})(a),h=t.target===document&&!this._isActive.peek(),p=(function(e,t){for(;e!==t&&t;){if(t.hasAttribute("data-suppresskeyboardbinding"))return!0;t=t.parentElement}return!1})(this.element,a);if(l||c||h||p)return!0;var d=(function(e,t){var n=!!e.useRtlMappings&&tt.e.isRightToLeft&&Tt[t]||t;return e.mappings[n]})(t,f);if(d){o&&e.preventDefault&&e.preventDefault();if(u&&!u(f,s,e))return!0;for(var v=0,m=d instanceof Array?d:[d];v<m.length;v++){if(!1===m[v].call(s,s,e)){dt.e.stopPropagation(e);return!1}}}return!0};return t})(c.t),kt=(function(e){Object(r.r)(t,e);function t(t){var n=e.call(this,t)||this,r=t.valueAccessor(),i=(function(e){return"object"==typeof e})(r)?r:{close:r},s=i.timeout,o=void 0===s?1e3:s,u=i.close,a=i.isAutomatic,f=void 0!==a&&a,l=i.isOpen,c=i.isEnabled,h=void 0===c||c,p=i.dismissOnResize,d=void 0!==p&&p,v=i.dismissOnScroll,m=void 0!==v&&v,g=i.useLocalEvents,y=void 0!==g&&g,b=i.disableEscape,w=void 0!==b&&b;n._options={timeout:o,close:u,isAutomatic:f,isOpen:l,dismissOnResize:d,dismissOnScroll:m,useLocalEvents:y,disableEscape:w};var E=n.observables;n._isAutomatic=E.wrap(f);n._isEnabled=E.wrap(h);n._isActive=E.create(!0);n._isOpenAndNotActive=E.pureCompute(n._computeIsOpenAndNotActive);E.backgroundCompute(n._computeDismissIfOpenAndNotActive).extend({rateLimit:{timeout:n._options.timeout,method:"notifyWhenChangesStop"}});n._options.isOpen&&E.backgroundCompute(n._computeDeactivateIfOpen);n.events.on(document,"click, mousemove, touchmove, pointermove, MSPointerMove, keydown",n._onEvent,!0);n.events.on(document,"click",n._onClick,!0);new(n.managed(Ct))({element:n.element,bindingContext:n.bindingContext,allBindingsAccessor:n.allBindingsAccessor,valueAccessor:function(){return{mappings:{Esc:function(e,t){return!!n._options.disableEscape||n._onEscape(t)}},target:n._options.useLocalEvents?void 0:document,useCapture:!n._options.useLocalEvents,allowInputEvents:!0,allowButtonEvents:!0,context:n.bindingContext.$data}}});n._options.dismissOnResize&&n.events.on(window,"resize",n._onResizeOrScroll,!0);n._options.dismissOnScroll&&n.events.on(window,"scroll",n._onResizeOrScroll,!0);return n}t.prototype._dismiss=function(){var e=this._options,t=e.isOpen,n=e.close;t&&t(!1);if(n){var r=this.bindingContext.$data;if(!1===n.call(r,r))return!1}return!0};t.prototype._onClick=function(e){if(!Lt(this.element,e)&&!(function(e){var t,n=e.target;return"none"===(null===(t=null==n?void 0:n.style)||void 0===t?void 0:t.display)})(e)){this._isActive(!1);this._isOpenAndNotActive.peek()&&this._isEnabled.peek()&&this._dismiss()}return!0};t.prototype._onEscape=function(e){if(Lt(this.element,e)){this._isActive(!1);if(this._isOpenAndNotActive.peek()&&this._isEnabled.peek()){e.stopImmediatePropagation();e.stopPropagation();this._dismiss();return!1}}return!0};t.prototype._onEvent=function(e){Lt(this.element,e)?this._isActive(!0):this._isActive(!1);return!0};t.prototype._onResizeOrScroll=function(e){if(!Lt(this.element,e)){this._isActive(!1);this._isOpenAndNotActive.peek()&&this._isEnabled.peek()&&this._dismiss()}return!0};t.prototype._computeDismissIfOpenAndNotActive=function(){this._isAutomatic()&&this._isOpenAndNotActive()&&this._isEnabled.peek()&&this._dismiss()};t.prototype._computeIsOpenAndNotActive=function(){var e=this._isActive(),t=this._options.isOpen;return(!t||t())&&!e};t.prototype._computeDeactivateIfOpen=function(){this._options.isOpen()&&this._isActive(!1)};return t})(c.t);function Lt(e,t){try{for(var n=t.target;n!==e&&Object(Ze.e)(n);)n=Object(Ze.e)(n);return n===e}catch(e){return!1}}var At=(function(){function e(){}e.init=function(e,t,n,r,i){t()(e)};return e})(),Ot=(function(e){Object(r.r)(t,e);function t(t){var n=e.call(this,t)||this,r=t.valueAccessor();n._callback=r.callback;n._delay=r.delay||400;n.events.on(n.element,"mouseenter",n._onMouseEnter);n.events.on(n.element,"mouseleave",n._onMouseLeave);return n}t.prototype._clearTimer=function(){if(this._timerID){this.async.clearTimeout(this._timerID);this._timerID=void 0}};t.prototype._onMouseEnter=function(e){this._clearTimer();this._timerID=this.async.setTimeout(this._onHoverTimer,this._delay)};t.prototype._onMouseLeave=function(e){this._clearTimer()};t.prototype._onHoverTimer=function(){this._timerID=void 0;this._callback&&this._callback()};return t})(c.t),Mt=(function(e){Object(r.r)(t,e);function t(t){var n=e.call(this,t)||this,r=t.valueAccessor();if(r){n._measureCallback=r.measure||r;n._parentRelative=r.parentRelative}n.createComputed(function(){if(n._measureCallback){f.utils.unwrapObservable(r.trigger);r.async?n.async.setImmediate(function(){n._updateMeasurement()}):n._updateMeasurement()}});return n}t.prototype._updateMeasurement=function(){var e=Ye.e.calculateRect(this.element);if(this._parentRelative&&this.element.parentElement){var t=Ye.e.calculateRect(this.element.parentElement);e=e.translate(t.getPoint().negate())}this._measureCallback(e)};return t})(c.t),_t=(function(e){Object(r.r)(t,e);function t(t,n){var i=e.call(this,t)||this,s=Object(r.e)(Object(r.e)({},t.props||{}),{hostViewModel:i});i.addBindingHandlers({react:G});i.reactBindingParams=Object(r.e)({props:s,error:t.error},(function(e){return"string"==typeof e.component})(t)?{componentPath:t.component,getModule:t.getComponentModule}:{componentType:t.component});return i}return t})(re.e);function Dt(e,t,n,i){return{tagName:e,template:'<div data-bind="react:reactBindingParams"></div>',viewModel:{createViewModel:function(e,s){return new(e.resources.injected(_t))(Object(r.e)(Object(r.e)({},"string"==typeof t?{component:t,getComponentModule:n}:{component:t}),{error:e.reactRenderError,props:Object(r.e)(Object(r.e)({},i||{}),e)}),s)}},synchronous:!0}}var Pt=Dt("ms-react-tooltip","./TooltipContainer",function(){return v.t.resolve(n.ee([2],615))},{calloutProps:{gapSpace:0},styles:{content:{fontSize:"0.75rem"}}});f.components.isRegistered(Pt.tagName)||f.components.register(Pt.tagName,Pt);var Ht,Bt=Pt,jt=n(69),Ft=(function(e){Object(r.r)(t,e);function t(t){var n=e.call(this,t)||this,r=n.valueAccessor();n.createComputed(function(){n.unwrapObservable(r.isTooltipDisabled);n._removeTooltip()});n.events.onAll(n.element,{mouseenter:n._insertTooltip,mouseleave:n._removeTooltip,focusin:n._insertTooltip,focusout:n._removeTooltip,click:n._removeTooltip,keydown:n._onKeyDown});n.addDisposable({dispose:function(){n._removeTooltip()}});return n}t.prototype._insertTooltip=function(e){var t=this;if(!(e&&e.relatedTarget&&this.element.contains(e.relatedTarget))){this._removeTooltip();var n=this.valueAccessor();if(n&&n.content&&!this.peekUnwrapObservable(n.isTooltipDisabled)&&this.peekUnwrapObservable(n.content)){var r=Ht=this._createTooltip(n);f.tasks.schedule(function(){Ht===r&&t.element.appendChild(Ht)})}}};t.prototype._createTooltip=function(e){var t=document.createElement("span"),n={content:this.peekUnwrapObservable(e.content),targetElement:this.element},r={component:{name:Bt.tagName,params:n}};f.applyBindingsToNode(t,r);return t};t.prototype._removeTooltip=function(e){if(!(e&&e.relatedTarget&&this.element.contains(e.relatedTarget))&&Ht){f.removeNode(Ht);Ht=null}};t.prototype._onKeyDown=function(e){if(e&&("Escape"===e.code||e.keyCode===jt.e.escape)){this._removeTooltip(e);e.stopPropagation()}};return t})(c.t),It=(function(){function e(){}e.init=function(e,t){var n=f.utils.unwrapObservable(t()),r=n.eventName||"dataChange",i=n.eventArgs,s=f.isObservable(n.data)?n.data:f.observable(),o=n.bubbleEvent||!1;s.subscribe(function(){dt.e.raise(e,r,i,o)})};return e})(),qt=n(100),Rt=n(338),Ut=n(239),zt=(function(e){Object(r.r)(t,e);function t(t){var n=e.call(this,t)||this,r=n.resources.consume(qt.s.optional);if(!r)return n;n.teachingBubbleProvider=r;n._value=n.valueAccessor();n._firstRunExperienceStatus=n.resources.consume(Rt.e);n._firstRunExperienceStatusKO=n.observables.create(n._firstRunExperienceStatus.get());n._firstRunExperienceStatus.subscribe(function(){n._firstRunExperienceStatusKO(n._firstRunExperienceStatus.get())});n.createBackgroundComputed(n._computeAddTeachingBubble);return n}t.prototype._computeAddTeachingBubble=function(){var e=this.unwrapObservable(this._value);if(e){var t=this.unwrapObservable(e.campaign);if(this._firstRunExperienceStatusKO()===Ut.e.notVisible&&t){this._campaign&&t.campaignGuid!==this._campaign.campaignGuid&&this.teachingBubbleProvider.currentBubble.get()&&this.teachingBubbleProvider.currentBubble.get().campaign===this._campaign&&this.teachingBubbleProvider.clearCurrentBubble();this._campaign=t;this.teachingBubbleProvider.addBubble({bubble:t,element:this.element})}}};return t})(c.t),Wt=n(127),Xt=n(266);function Vt(e){return e.charAt(0).toUpperCase()+e.slice(1)}var $t=(function(e){Object(r.r)(t,e);function t(t){var n=e.call(this,t)||this;n._insertNewElement();n.controlsDescendantBindings=!0;return n}t.prototype.dispose=function(){if(this._previousElement){f.cleanNode(this._previousElement);delete this._previousElement}e.prototype.dispose.call(this)};t.prototype._insertNewElement=function(){var e=this.valueAccessor(),t=this._createInputElement(e.isFolderUpload);this._applyBindings(t,e);f.virtualElements.setDomNodeChildren(this.element,[t]);this._previousElement=t};t.prototype._createInputElement=function(e){var t=document.createElement("input");t.type="file";t.tabIndex=-1;if(e){t.webkitdirectory=!0;t.directory=!0}else t.multiple=!0;return t};t.prototype._applyBindings=function(e,t){var n=this;f.applyBindingsToNode(e,{class:t.class,css:t.css,style:t.style,event:{change:function(e,r){t.onInputChange.call(e,r);n._insertNewElement()}}},this.bindingContext)};t.supportsVirtualElements=!0;return t})(c.t),Jt=n(550),Kt=n(551),Qt=((function(){function e(){}e.Search="Search"})(),(function(e){Object(r.r)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getBuckets=function(){return t.getBuckets(this.resources)};t.getBuckets=function(e){return e&&e.isExposed(Kt.t)?e.consume(Kt.t):f.observable([])};t.prototype.getLoggingContextData=function(){return t.getLoggingContextData(this.resources)};t.getLoggingContextData=function(e){var n=null;e&&e.isExposed(Kt.e)&&(n=e.consume(Kt.e));return n?n.get(t.getBuckets(e).peek()):{}};t.prototype.addBuckets=function(e){return t.addBuckets(this.resources,e)};t.addBuckets=function(e,t){if(e){var n=[];e.isExposed(Kt.t)&&(n=e.consume(Kt.t).peek());t.forEach(function(e){n.indexOf(e)<0&&n.push(e)});e.isExposed(Kt.t)||e.expose(Kt.t,f.observable(n))}};return t})(C.t)),Gt=0;var Yt=(function(e){Object(r.r)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,(function(e){e.id=e.id||"".concat(Gt++);return e})(t),n)||this;r.ActionInputType=Jt.e;r._defaultMenuOffset=new it.e(0,pt.size/2+4);r.addBindingHandlers({dismiss:kt,raiseEventOnChange:It,measure:Mt,longHover:Ot,element:At,teachingBubble:zt,fileInput:$t,tooltip:Ft,control:x});var i=r,s=i.observables,o=i.resources,u=n.engagement,a=void 0===u?o&&o.consume(Xt.e.optional):u,f=n.responsiveUI,l=void 0===f?o&&o.consume(lt.optional):f;r._isOpenRequested=r.createObservable(!1);r.isActive=r.createObservable(!1);r.isToggled=r.createObservable(!1);r.focused=r.createObservable(!1);r.menuFocus=r.createObservable(!1);r.fileInputElement=r.createObservable();var c=t.text,h=void 0===c?"":c,p=t.automateExperimentText,d=t.subtext,v=void 0===d?"":d,m=t.classSuffix,g=void 0===m?r.createObservable():m,y=t.collapsedText,b=void 0===y?r.createObservable():y,w=t.location,E=void 0===w?11:w,S=t.renderLabel,T=void 0===S?1:S,N=t.isCurrentView,C=void 0===N?null:N,k=t.hasIconOnly,L=void 0!==k&&k,A=t.positionIconRight,O=void 0!==A&&A,M=t.icon,_=t.iconUrl,D=t.iconSize,P=void 0===D?16:D,H=t.appIconName,B=t.ariaControls,j=t.ariaExpanded,F=t.ariaHasPopup,I=t.keys,q=void 0===I?[]:I,R=t.isToggleable,U=void 0!==R&&R,z=t.isHidden,W=void 0===z?r.createObservable():z,X=t.isDisabled,V=t.isInvisibleWhenDisabled,$=void 0!==V&&V,J=t.tooltip,K=void 0===J?null:J,Q=t.accessibleLabel,G=void 0===Q?"":Q,Y=t.prependTextToAccessibleLabel,Z=void 0===Y||Y,ee=t.sectionAccessibleLabel,te=void 0===ee?"":ee,ne=t.role,re=void 0===ne?"":ne,ie=t.teachingBubble,se=t.iconBadge,oe=t.isPermanent,ue=void 0!==oe&&oe,ae=t.state,fe=void 0===ae?r.createObservable(Ge.initialized):ae,le=t.requiredChildren,ce=void 0===le?0:le,he=t.collapseSingleChildCommands,pe=void 0===he||he,de=t.hasLineBreakBefore,ve=void 0!==de&&de,me=t.hasLineBreakAfter,ge=void 0!==me&&me,ye=t.action,be=t.callback,we=t.onCoachmarkOpen,Ee=t.menuAlignment,Se=void 0===Ee?r.createObservable(0):Ee,xe=t.menuOffset,Te=void 0===xe?r.createObservable(r._defaultMenuOffset):xe,Ne=t.isMenuBeakVisible,Ce=void 0===Ne?r.createObservable(!0):Ne,ke=t.payload,Le=t.enableRecoverFocusBinding,Ae=void 0!==Le&&Le,Oe=t.engagementName,Me=t.source,_e=t.experiment,De=t.isLastPivot,Pe=void 0!==De&&De,He=t.hasAnimation,Be=void 0!==He&&He,je=t.hidesMenuChevron,Fe=void 0!==je&&je,Ie=t.children,qe=void 0===Ie?r.observables.createArray():Ie,Re=t.isStrong,Ue=void 0===Re?r.createObservable(!1):Re,ze=t.hasDeferredChildren,We=void 0!==ze&&ze,Xe=t.hasDynamicText,Ve=void 0!==Xe&&Xe,$e=t.reportClickingTime,Je=t.beakColor,Ke=void 0===Je?nt.e.white:Je,Qe=t.isContentType,Ye=t.isIconOnly,Ze=t.onRenderIcon,et=t.overrideTabIndex,tt=t.isDecorative,rt=void 0!==tt&&tt;r.text=r.wrapObservable(h);r.automateExperimentText=r.wrapObservable(p);r.subtext=r.wrapObservable(v);r.commandClass=r.wrapObservable(g);r.collapsedText=b;0;r.isLabelVisible=2===T?l.showLabels:s.create(1===T);r.isToggleable=U;r.location=E;r.isPermanent=r.wrapObservable(ue);r.requiredChildren=ce;r.collapseSingleChildCommands=pe;r.hasLineBreakAfter=r.wrapObservable(ge);r.hasLineBreakBefore=r.wrapObservable(ve);r.action=ye;r.ariaControls=B;r.ariaExpanded=j;r.ariaHasPopup=F;r.callback=be;r.onCoachmarkOpen=we;r.hidesMenuChevron=Fe;r.isStrong=Ue;r.isClipped=r.createObservable(!1);r.hasDynamicText=Ve;r._reportClickingTime=$e;r.beakColor=Ke;r.isContentType=Qe;r.isIconOnly=!!Ye;r.onRenderIcon=Ze;r.isDecorative=rt;r._engagement=a;r.action&&r.action.inputType?r.inputType=r.createPureComputed(r._computeInputType):r.inputType=r.createObservable(Jt.e.none);r._initializeIcons(M,_,P,se,H);r.tooltip=r.wrapObservable(K);r.accessibleLabel=r.wrapObservable(G);r.prependTextToAccessibleLabel=Z;r.sectionAccessibleLabel=r.wrapObservable(te);r.role=re||(U?"menuitemcheckbox":"menuitem");ie&&(r.teachingBubble=r.wrapObservable(ie));X&&(r.isDisabled=X);r.isInvisibleWhenDisabled=$;r._isHidden=r.wrapObservable(W);r.bounds=r.createObservable();r.measurementReady=function(e){r.onMeasurementReady(e)};r.payload=ke;r.enableRecoverFocusBinding=Ae;r.keys=q;r.children=qe instanceof Array?r.observables.createArray(qe):qe;r.addDisposable(r.children.map({mappingWithDisposeCallback:function(e){e.parentCommand=r;return{mappedValue:e,dispose:function(){e.parentCommand=null}}}}));r.visibleChildren=r.addDisposable(r.children.filter(function(e){return e.isVisible()}));r.hasDeferredChildren=We;r.isToggled=r.createComputed(r._computeIsToggled);r.hasAnimation=Be;r.isVisible=r.createComputed(r._computeIsVisible);r.state=r.wrapObservable(fe);r.isCurrentView=C;r.isLastPivot=Pe;r.isCollapsed=r.createComputed(function(){return r.collapseSingleChildCommands&&1===r.visibleChildren().length});r.menuAlignment=r.wrapObservable(Se);r.menuOffset=r.wrapObservable(Te);r.isMenuBeakVisible=r.wrapObservable(Ce);r.targetCommand=r.createComputed(function(){if(r.isCollapsed()){return r.visibleChildren()[0]}return r});r.label=r.createComputed(r._computeLabel);r.computedAccessibleLabel=r.createPureComputed(function(){return r._computeAccessibleLabel()});r.hasIconOnly=r.wrapObservable(L);r.positionIconRight=O;r.isOpen=r.createComputed({read:function(){return r._isOpenRequested()&&(r.visibleChildren().length>0||!(!r.payload||!r.payload.control()))},write:function(e){r._isOpenRequested(e)},pure:!0});r.subscribe(r.isOpen,function(e){e||r.children().forEach(function(e){e.children().length>0&&e.isOpen(!1)})});var st=r.addDisposable(r.visibleChildren.filter(function(e){return e.isOpen()})),ot=r.createComputed(function(){return st().length>0});r.subscribe(ot,function(e){e||r.async.setImmediate(function(){document.activeElement&&document.activeElement!==document.body||r.focused(!0)})});r.tabindex=r.createObservable(0);r.createComputed(function(){if(!r.isOpen()&&r.focused()){r.tabindex(0);r.isActive(!0)}else r.isActive()||r.tabindex(et?0:-1)});r.isDisabled||(r.isDisabled=r.createComputed(function(){return r.targetCommand()!==r?r.targetCommand().isDisabled():r.requiredChildren>0?r.visibleChildren().length<r.requiredChildren:!(r.visibleChildren().length||r.action&&(r.action.isAvailable()||r.isToggleable&&r.action.isToggled())||r.callback)}));r.layoutChanged=r.createObservable();r.createComputed(function(){r.isLabelVisible();r.text();r.layoutChanged.notifySubscribers()});r.engagementName=Oe;r.source=r.wrapObservable(Me);r.experiment=_e;return r}t.prototype.getKey=function(){return this.id};t.prototype.hasVisibleChildren=function(){return this.visibleChildren().length>0};t.prototype.hasVisibleOrDeferredChildren=function(){return this.hasVisibleChildren()||this.hasDeferredChildren};t.prototype.onMeasurementReady=function(e){this.bounds(e)};t.prototype.onClick=function(e,t){var n,i=this,s=t&&t.type||"unknown",o=["CommandView",Vt(s)],u=!1;this._reportClickingTime&&this._reportClickingTime();if((0===this.location||this.isVisible.peek())&&!this.isDisabled.peek()){var a=this.isCollapsed.peek()?this.visibleChildren.peek()[0]:this,f=a.visibleChildren.peek().length&&(a.icon||a.text),l=a.action&&a.action.isAvailable.peek(),c=e.engagementName,h=e.source;if(c){o=[c,"Click"];h&&h.peek()&&(o[0]+=h.peek());n=o.join(".")}else if(f){var p=a.icon&&a.icon.peek(),d=p?p.toString():a.visibleChildren.peek()[0]&&a.visibleChildren.peek()[0].engagementName?a.visibleChildren.peek()[0].engagementName:"Unknown";o.splice(1,0,"Parent"+Vt(d));n=o.join(".")}else if(l){o.splice(1,0,Vt(a.action.name));n=o.join(".")}a.payload&&a.payload.control.peek()&&a.isOpen.peek()&&a.isOpen(!1);if(n){var v=this._engagement,m={name:n,isIntentional:!0,experiment:e.experiment,extraData:Object(r.e)({action:Vt(s),isCommand:!0},Qt.getLoggingContextData(this.resources))};v?v.logData(m):Wt.e.logData(m)}if(f){a.closeSiblingCommands();a.parentCommand?a.isOpen(!0):a.isOpen(!a.isOpen.peek());a.isOpen.peek()&&a.focused(!0);a.callback&&a.callback();u=!0}else if(l){if(!e.isDisabled||!e.isDisabled.peek()){if(a.fileInputElement.peek()&&a.action.isAvailable.peek()){a.fileInputElement.peek().click()}else{this.state(Ge.executed);a.action.execute(t).done(function(){i.state(Ge.initialized)},function(e){i.state(Ge.failed)})}"MoveCopy"===a.action.name&&e.isDisabled(!0)}u=!0}else if(a.callback){a.callback();u=!0}}this.isDisabled.peek()&&t.preventDefault();u&&t&&t.stopPropagation();return!u};t.prototype.onDismiss=function(){var e=this.visibleChildren.peek();(this.payload&&this.payload.control.peek()||e&&e.length)&&this.isOpen(!1)};t.prototype.onInputChange=function(e){var t=this.targetCommand();if(t&&t.action){t.action.execute(e);this.closeParentCommands()}};t.prototype.openMenu=function(){var e=this.visibleChildren();if(e&&e.length){this.isOpen(!0);return!0}return!1};t.prototype.getIcon=function(e){var t=e;this.icon&&this.icon()&&(t+=" "+this.icon().getClass());return t};t.prototype.getChevron=function(){var e=tt.e.isRightToLeft?"ChevronLeft":"ChevronRight";return Object(ve.g)(e)};t.prototype.getChevronDown=function(e){return Object(ve.g)("ChevronDown")};t.prototype.closeParentCommands=function(){for(var e=this.parentCommand;e;){e.isOpen(!1);e=e.parentCommand}};t.prototype.closeSiblingCommands=function(){var e=this;this.parentCommand&&this.parentCommand.children().forEach(function(t){t!==e&&t.isOpen(!1)})};t.prototype._initializeIcons=function(e,t,n,r,i){var s=this,o=this.createPureComputed(function(){return s.isCollapsed()?s.targetCommand().icon():void 0}),u=this.createPureComputed(function(){return s.isCollapsed()?s.targetCommand().iconUrl():void 0}),a=this.wrapObservable(e);this.icon=this.createPureComputed(function(){if(s.isCollapsed()){var e=o();if(e)return e;if(u())return}return a()});this.icon.equalityComparer=mt.t;var f=this.wrapObservable(t);this.iconUrl=this.createPureComputed(function(){if(s.isCollapsed()){if(o())return;return u()||f()}return f()});this.iconUrl.equalityComparer=mt.t;this.iconSize=this.wrapObservable(n);var l=this.wrapObservable(r);this.iconBadge=this.createPureComputed(function(){return s.isCollapsed()&&s.targetCommand().iconBadge()||l()});this.iconBadge.equalityComparer=mt.t;this.appIconName=i};t.prototype._computeIsToggled=function(){return this.isCurrentView?this.isCurrentView():!!this.action&&this.action.isToggled()};t.prototype._computeIsVisible=function(){return 0!==this.location&&(!this._isHidden()&&(this.requiredChildren>0?this.visibleChildren().length>=this.requiredChildren:!this.action||(this.isPermanent()||this.action.isAvailable()||this.isToggleable&&this.action.isToggled())))};t.prototype._computeLabel=function(){return this.isCollapsed()?this.targetCommand().collapsedText()||this.targetCommand().text():this.text()};t.prototype._computeAccessibleLabel=function(){var e,t=this.accessibleLabel(),n=this.sectionAccessibleLabel()||"",r=this.label(),i=t;e=i&&r&&i!==r&&this.prependTextToAccessibleLabel?r+". "+i:i||r||"";return n&&e?n+". "+e:e||n};t.prototype._computeInputType=function(){return this.action&&this.action.inputType&&this.action.inputType()||Jt.e.none};t.dependencies=Object(r.e)(Object(r.e)({},re.e.dependencies),{engagement:Xt.e,responsiveUI:lt.optional});return t})(re.e),Zt=Dt("ms-contextual-menu","./react/ReactContextualMenu",function(){return v.t.resolve(n.ee([1],616))});Zt.template='\x3c!--ko component:{name:\'od-overlay\',params:{alignToParent:false}}--\x3e<div role="application" data-bind="react:reactBindingParams"></div>\x3c!--/ko--\x3e';f.components.isRegistered(Zt.tagName)||f.components.register(Zt.tagName,Zt);var en=n(166),tn=n(513),nn=(function(e){Object(r.r)(t,e);function t(t){var n=e.call(this,t)||this;n.events.on(n.element,"contextmenu",n._onContextMenu);new(n.managed(Ct))({element:n.element,bindingContext:n.bindingContext,allBindingsAccessor:n.allBindingsAccessor,valueAccessor:function(){return{mappings:{ShiftF10:function(e,t){n._onContextMenu(t);return!0}},preventDefault:!0,context:n.bindingContext.$data}}});return n}t.createContextMenu=function(e,t,n,r){var i=null,s=t.anchorElement||et(e.target,t.rootElementClass);if(s&&t.items&&t.items.length>0){var o=void 0;if(t.anchorElement||e.clientX<=0&&e.clientY<=0||!e.clientX&&!e.clientY){var u=(t.anchorElement?t.anchorElement:e.target).getBoundingClientRect();o=new it.e(u.left,u.bottom)}else o=new it.e(e.clientX,e.clientY);var a=f.observable(o.x+"px"),l=f.observable(o.y+"px"),c=t.alignment||rt.e.Left|rt.e.Top;tt.e.isRightToLeft&&(c|=rt.e.Right);var h=null;if(t.boundingElementClass){var p=et(e.target,t.boundingElementClass);h=new st.e(p.getBoundingClientRect())}var d=document.createElement("div");d.style.position="absolute";d.style.top="0px";d.style.left="0px";i=d;document.body.appendChild(d);Object(tn.e)(d,s);r||(r=function(){if(i){f.removeNode(i);i=null}});var v={component:{name:"ms-contextual-menu",params:{items:t.items,left:a,top:l,alignment:f.observable(c),offset:f.observable(t.point||it.e.ORIGIN),launchEvent:e,target:e.target,bounds:h,hideIcons:t.shouldHideIcons,fromKeyboardEvent:0===e.pointerId,anchorElement:t.anchorElement,close:t.dismissOnClick?r:null,isOpen:t.isMenuOpen}}};f.applyBindingsToNode(d,v,n)}return i};t.prototype._onContextMenu=function(e){var n=this,r=f.utils.unwrapObservable(this.valueAccessor()),i=(r&&r.resources||l.e(this.bindingContext)).consume(en.n.optional),s=function(){if(t._contextMenu){f.removeNode(t._contextMenu);t._contextMenu=null}};s();var o=e.target,u=null,a=null,c=null;if(Ye.e.hasClass(o,"noContextMenu")||e.shiftKey&&e instanceof MouseEvent||!r)return!0;for(var h=r.anchorElement||et(o,r.rootElementClass);u!==h;){var p=f.dataFor(o);if(p){!c&&p.item&&(c=p.item);if(c)break}if((a=o?o.getAttribute("data-selection-index"):null)&&(c=i&&i.getItemByIndex(a)))break;u=o;o=Object(Ze.e)(o)}var d=!1,v=f.dataFor(o);if(i&&v){var m=null===i.maximumSelectedCount||void 0===i.maximumSelectedCount||i.maximumSelectedCount>0;if(!c||!i.isItemSelected(c)&&m){if(i.selectedCount()>0){i.clear();d=!0}else c&&(v.isSelected||a)&&(d=!0);if(d)var g=i.selection.subscribe(function(){g.dispose();h&&n._openMenu(e,r,s)});if(c&&(v.isSelected||a)){i.toggleItemSelected(c);i.setItemFocus(c)}}else c&&i.maximumSelectedCount<=0&&i.setItemFocus(c)}if(r){h&&!d&&this._openMenu(e,r,s);e.preventDefault();e.stopPropagation();return!1}return!0};t.prototype._openMenu=function(e,n,r){n.engagementSource&&this.resources.consume(Xt.e).logData({name:"RightClick.".concat(n.engagementSource,".Click"),isIntentional:!0});if(t._contextMenu){f.removeNode(t._contextMenu);t._contextMenu=null}t._contextMenu=t.createContextMenu(e,n,this.bindingContext,r)};return t})(c.t);function rn(e){return 8==(8&e.location)}var sn=(function(e){Object(r.r)(t,e);function t(t){var n=e.call(this,t)||this;n.items=t.items.filter(rn);n.rootElementClass=t.rootElementClass||null;n.boundingElementClass=t.boundingElementClass||null;n.shouldHideIcons=!!t.shouldHideIcons;n.engagementSource=t.engagementSource||null;n.alignment=t.alignment;n.point=t.point;n.anchorElement=t.anchorElement;n.isMenuOpen=t.isMenuOpen;var r=t.dismissOnClick,i=void 0===r||r;n.dismissOnClick=i;return n}return t})(C.t);Object(u.e)([{rawString:".od-LoadingSpinner{white-space:nowrap}.od-LoadingSpinner-loadingText{vertical-align:top}.od-LoadingSpinner-loadingGif{vertical-align:bottom}"}]);var on=n(565),un=(function(e){Object(r.r)(t,e);function t(t){var n=e.call(this,t)||this;t&&void 0!==t.loadingText?n.loadingText=t.loadingText:n.loadingText=on.e;n.addBindingHandlers({imageLoader:ze});n.isVisible=f.observable(!0);n.isImageLoaded=f.observable(!1);n.loadingImageUrl=window.require.toUrl("odsp-media/images/loading/loadingspinner.gif");return n}t.prototype.hideSpinner=function(){this.isVisible(!1)};return t})(re.e),an=ge.e({tagName:"ms-loadingSpinner",template:'<div class="od-LoadingSpinner" data-automationid="ms-loadingSpinner"><img class="od-LoadingSpinner-loadingGif" role="presentation" data-bind="click:hideSpinner,visible:isVisible,imageLoader:{src:loadingImageUrl,isLoaded:isImageLoaded}"><span class="od-LoadingSpinner-loadingText" data-bind="text:loadingText"></span></div>',viewModel:un,synchronous:!0}),fn=n(44),ln=Object(Te.e)({eventName:"Action,Qos,",shortEventName:"Action",samplingFeature:{ODB:!0,ODC:"ActionEventLogging",Fallback:!1}},{pageType:Ne.e.String,queryType:Ne.e.String,logStartEnd:Ne.e.Boolean},Ce.e),cn=n(217),hn=n(23),pn=n(11),dn=n(7),vn=n(361),mn=n(267),gn=(function(e){Object(r.r)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="BaseAction";var i=r,s=i.resources,o=i.observables,u=n.urlDataSource,a=void 0===u?s.consume(hn.c.optional):u,f=n.instrumentationProvider,l=void 0===f?s.consume(qt.r.optional):f;r._BaseAction_urlDataSource=a;r._BaseAction_instrumentationProvider=l;r.isQosLogged=!0;r.logStartEnd=!1;r.enableCustomerPromiseLogging=!1;r._executingInstanceCount=o.create(0);var c={deferEvaluation:!0};r.isAvailable=o.pureCompute(r._computeIsAvailable,c);r.isToggled=o.pureCompute(r._computeIsToggled,c);r.isExecuting=o.pureCompute(r._computeIsExecuting,c);return r}t.prototype.execute=function(e){var t,n,r=this,i=this.isQosLogged?this.onCreateQosEvent(e):void 0,s=i?this.getEngagement():void 0;try{if(i){this._logEngagementEvent(i.data.extraData,s);this.trackUserAction(this.name)}if(!(t=this.instrumentOnExecutionWithCustomerPromise(this.onExecute(e,i))))throw new Error("Action did not return a promise")}catch(e){y.e.log(e);n=e}if(t){this._executingInstanceCount(this._executingInstanceCount.peek()+1);t.then(function(e){r._executingInstanceCount(r._executingInstanceCount.peek()-1);i&&i.end(e)},function(t){r._executingInstanceCount(r._executingInstanceCount.peek()-1);t&&!v.t.isCanceled(t)&&y.e.log(t);i&&i.end(r.onCreateErrorEventArg(e,t,!1))})}else{i&&i.end(this.onCreateErrorEventArg(e,n,!0));t=v.t.reject(n)}return t};t.prototype.onCreateQosEvent=function(e){var t=this._BaseAction_urlDataSource;return new ln({name:this.name,pageType:t&&pn.e[t.getPageType()]||"",queryType:t&&dn.e[t.getQueryType()]||"",logStartEnd:this.logStartEnd})};t.prototype.onCreateErrorEventArg=function(e,t,n){return t&&v.t.isCanceled(t)?{resultType:q.e.ExpectedFailure,resultCode:"Canceled"}:t instanceof Fe.e?{resultType:t.isExpected?q.e.ExpectedFailure:q.e.Failure,resultCode:t.code,error:t.message,extraData:{CorrelationId:t.correlationId}}:{resultType:q.e.Failure,resultCode:n?"NoPromiseReturned":"PromiseFailed",error:t?"".concat(t.message||""):void 0}};t.prototype.onExecute=function(e,t){var n={resultType:q.e.Failure};return v.t.resolve(n)};t.prototype.instrumentOnExecutionWithCustomerPromise=function(e){var t=e;if(this.enableCustomerPromiseLogging){var n=this._BaseAction_urlDataSource,i=new vn.e({scenario:this.name,extraData:{pageType:n&&pn.e[n.getPageType()]||"",queryType:n&&dn.e[n.getQueryType()]||""}});t=e.then(function(e){var t=e.resultCode,n=e.resultType,s=e.error,o=e.extraData;i.end({resultType:n,errorCode:t,extraData:Object(r.e)(Object(r.e)({},o),{error:s})});return e}).catch(function(e){var t;if(v.t.isCanceled(e))t={resultType:q.e.ExpectedFailure,errorCode:"Canceled"};else{var n=Object(mn.e)(e),s=n.resultType,o=n.resultCode,u=n.error,a=n.extraData;t={resultType:s,errorCode:o,extraData:Object(r.e)(Object(r.e)({},a),{error:u})}}i.end(t);throw e})}return t};t.prototype.onIsAvailable=function(){return!0};t.prototype.onIsToggled=function(){return!1};t.prototype.getEngagement=function(){return this.resources.consume(Xt.e)};t.prototype.trackUserAction=function(e){var t=this._BaseAction_instrumentationProvider;if(t){var n=this.getEngagement();t.userExecuteAction({name:e,engagement:n})}};t.prototype._computeIsAvailable=function(){return!!this.onIsAvailable()};t.prototype._computeIsToggled=function(){return!!this.onIsToggled()};t.prototype._computeIsExecuting=function(){return this._executingInstanceCount()>0};t.prototype._logEngagementEvent=function(e,t){void 0===t&&(t=this.isQosLogged?this.getEngagement():void 0);if(t){var n=this._BaseAction_instrumentationProvider;t.logData({name:this.name,isIntentional:this.isExecutionIntentional,location:"NA",usageType:cn.e[cn.e.Click],currentPage:n&&n.currentPageName()||"NA",previousPage:n&&n.previousPageName()||"NA",extraData:Object(r.e)(Object(r.e)(Object(r.e)({},e||{}),n&&n.getEngagementData()||{}),{isAction:!0})})}};t.dependencies=Object(r.e)(Object(r.e)({},C.t.dependencies),{urlDataSource:hn.c,instrumentationProvider:qt.r.optional});return t})(C.t),yn=new h.t({name:"SharingProvider.key",loader:new ue.t(function(){return n.ee([5],612).then(function(e){return e.resourceKey})})}),bn=(function(e){Object(r.r)(t,e);function t(t){var n=e.call(this,t)||this;n.name="UpdatePermissions";n._item=t.item;n._person=t.person;n._role=t.role;n._isExecuting=t.isExecuting;n._callback=t.callback;n._expiration=t.expiration;return n}t.prototype.onExecute=function(e,t){var n=this;this._isExecuting&&this._isExecuting(!0);return v.t.resolve(this.resources.consumeAsync(yn)).then(function(e){return e.updatePermissions([n._person],n._item,n._role,n._expiration)}).then(function(e){n._callback(e.people[0]);n._isExecuting(!1);return{resultType:q.e.Success}},function(e){n._isExecuting(!1);return{resultType:q.e.Failure}})};return t})(gn);n(566);Object(u.e)([{rawString:".od-Confirmation-message{padding:0;box-sizing:border-box;box-shadow:none;margin:0;padding:0;font-size:.875rem}.od-Dialog.od-Dialog--close .od-ConfirmationDialog.od-Dialog-main .od-Dialog-content{line-height:1.25rem}.od-Dialog.od-Dialog--close .od-ConfirmationDialog.od-Dialog-main .od-Dialog-content .od-Dialog-button.od-Dialog-button--close{width:2rem;height:2rem;line-height:2rem}.od-Dialog.od-Dialog--close .od-ConfirmationDialog.od-Dialog-main .od-Dialog-content .od-Dialog-button.od-Dialog-button--close i.ms-Icon.ms-Icon--Cancel{font-size:1rem}.od-Dialog.od-Dialog--close .od-ConfirmationDialog.od-Dialog-main .od-Dialog-actions{height:2rem}.od-Dialog.od-Dialog--close .od-ConfirmationDialog.od-Dialog-main .od-Dialog-actions button.od-Dialog-action{height:2rem;font-size:.875rem}.od-Dialog.od-Dialog--close .od-ConfirmationDialog.od-Dialog-main .od-Dialog-actions button.od-Dialog-action .od-Button-label{font-size:.875rem}.od-Dialog.od-Dialog--close .od-ConfirmationDialog.od-Dialog-main #od-Dialog-title{font-size:1.25rem}"}]);var wn=(function(e){Object(r.r)(t,e);function t(t){var n=e.call(this,t)||this;n.message=t.message;return n}return t})(re.e),En=(ge.e({tagName:"ms-confirmation",template:'<div class="od-Confirmation"><p class="od-Confirmation-message" data-bind="text:message"></p></div>',viewModel:wn}),n(174),n(343),n(82),n(567),n(130));var Sn,xn=(function(e){Object(r.r)(t,e);function t(t){var n=e.call(this,t)||this;n.loadingSpinnerTagName=an.tagName;n.personaImageTagName=Qe.tagName;n.addBindingHandlers({tooltip:Ft,keyboard:Ct,element:At});n.updateSharingRole=function(e){if(e.sharingInfo.role===fn.e.None)n._removePerson(n.person());else{var t=n.person();t.sharingInfo=e.sharingInfo;n.person(t);n.updatingPermissions(!1)}};n._item=t.item;n.openContextMenu=t.openContextMenu||n.observables.create(!1);n.inputEvent=t.inputEvent||n.observables.create(null);n.sharingRoleElement=n.createObservable();n.disableTab=n.createObservable(t.disableTab);n.showEmail=Object(We.ne)(We.W);n.person=f.isObservable(t.person)?t.person:f.observable(t.person);n.updatingPermissions=f.observable(!1);n.nameEmail=n.person().email?we.n(be.i,n.person().name,n.person().email):n.person().name;n._removePerson=t.removePerson||function(e){};n.showName=void 0===t.showName||!!t.showName;n.showProfileLink=!!t.profileLinkOn;n.showPresence=!!t.showPresence;n._includeComma=!!t.includeComma;n._sharingRoleMenuRootElementClass=t.sharingRoleMenuRootElementClass||"od-Dialog-main";n._urlDataSource=n.resources.consume(hn.c);t.personaSize?n.personaSize=f.isObservable(t.personaSize)?t.personaSize:f.observable(t.personaSize):n.personaSize=f.observable(3);n.personaImageParams={person:n.person,disablePictrueAlt:t.disablePictrueAlt,iconType:t.iconType};n.createComputed(function(){if(n.openContextMenu()&&n.canChangePermissions()&&n.canManagePermissions()){var e=n._createContextMenuCommands(),t=n._createContextMenuHelper(e),r=n.inputEvent.peek();nn.createContextMenu(r,t,n);13===r.keyCode&&r.preventDefault();n.openContextMenu(!1)}});n.personaClass=n.createComputed(function(){var e=void 0===n.person().isResolved||n.person().isResolved?"":"od-Persona-unresolved ";n._includeComma&&(e+="od-Persona--comma ");e+="od-Persona";switch(n.personaSize()){case 7:return e+" od-Persona--mini";case 1:return e+" od-Persona--tiny";case 2:return e+" od-Persona--xs";case 3:return e+" od-Persona--sm";case 5:return e+" od-Persona--lg";case 6:return e+" od-Persona--xl";case 8:return e+" od-Persona--xxl";default:return e}});n.hasSharingInfo=n.createComputed(function(){return!!n.person().sharingInfo});var r=n.resources.isExposed(en.i)?n.resources.consume(en.i):null;n.personIsCurrentUser=n.createPureComputed(function(){return r&&n.person().userId&&n._urlDataSource.getOwnerId("",r()).toLowerCase()===n.person().userId.toLowerCase()},{deferEvaluation:!0});n.canChangePermissions=n.createPureComputed(function(){return!!n.person().sharingInfo&&n.person().sharingInfo.role!==fn.e.Owner&&!n.personIsCurrentUser()});n.canManagePermissions=n.createObservable(t.canManagePermissions);n.presenceVisible=n.createComputed(function(){return n.showPresence&&!!n.person().sip});n.tooltip=n.person().email;n.updatingText=be.l;n.person().providerName&&(n.tooltip+="\n"+n.person().providerName);return n}t.prototype.getSharingRole=function(e){return(function(e,t){if(e||t&&this._item){var n=(null==t?void 0:t.expiration)?Object(En.t)(new Date(t.expiration)):null;switch(e){case fn.e.View:return n?we.n(be.h,n):be.c;case fn.e.Edit:return n?we.n(be.r,n):be.n;case 6:return be.u;case fn.e.CoOwner:return be.t;case fn.e.Owner:return be.s;case fn.e.Custom:return t.customRole}}return""})(null==e?void 0:e.role,e)};t.prototype.onSharingRoleClick=function(e,t){this.resources.consume(Xt.e).logData({name:"UpdatePermissionsMenu.SharingDialog.Click",isIntentional:!0});var n=this._createContextMenuCommands(),r=this._createContextMenuHelper(n,t);nn.createContextMenu(t,r,this);return n};t.prototype._createContextMenuCommands=function(){var e,t=[],n="";if(Object(We.ne)(We.R)&&this._item.appMap&&"ms-word"===this._item.appMap){var r,i="";if(this.person().sharingInfo.role===fn.e.View){n=be.e;e=fn.e.Edit;i=be.a;r=fn.e.Review}else if(this.person().sharingInfo.role===fn.e.Review){n=be.e;e=fn.e.Edit;i=be.p;r=fn.e.View}else if(this.person().sharingInfo.role===fn.e.Edit){n=be.a;e=fn.e.Review;i=be.p;r=fn.e.View}t[0]=new Yt({text:n,isToggleable:!1,action:new(this.managed(bn))({person:this.person(),role:e,isExecuting:this.updatingPermissions,callback:this.updateSharingRole,expiration:this.person.peek().sharingInfo.expiration,item:this._item})});t[1]=new Yt({text:i,isToggleable:!1,action:new(this.managed(bn))({person:this.person(),role:r,isExecuting:this.updatingPermissions,callback:this.updateSharingRole,expiration:this.person.peek().sharingInfo.expiration,item:this._item})});t[2]=new Yt({text:be.f,isToggleable:!1,action:new(this.managed(bn))({person:this.person(),role:fn.e.None,isExecuting:this.updatingPermissions,callback:this.updateSharingRole,item:this._item})})}else{if(this.person().sharingInfo.role===fn.e.View){n=be.e;e=fn.e.Edit}else{n=be.p;e=fn.e.View}t[0]=new Yt({text:n,isToggleable:!1,action:new(this.managed(bn))({person:this.person(),role:e,isExecuting:this.updatingPermissions,callback:this.updateSharingRole,expiration:this.person.peek().sharingInfo.expiration,item:this._item})});t[1]=new Yt({text:be.f,isToggleable:!1,action:new(this.managed(bn))({person:this.person(),role:fn.e.None,isExecuting:this.updatingPermissions,callback:this.updateSharingRole,item:this._item})})}return t};t.prototype._createContextMenuHelper=function(e,t){return new sn({items:e,rootElementClass:this._sharingRoleMenuRootElementClass,anchorElement:t&&t.target||this.sharingRoleElement.peek()})};return t})(re.e),Tn=ge.e({tagName:"od-persona",template:'<div data-bind="tooltip:{content:nameEmail,\'aria-label\':person().name},css:personaClass"><div class="od-Persona-imageArea"><div class="od-Persona-imageCircle">\x3c!--ko component:{name:personaImageTagName,params:personaImageParams}--\x3e\x3c!--/ko--\x3e</div>\x3c!--ko if:presenceVisible--\x3e\x3c!--ko component:{name:\'ms-presence\',params:{sip:person().sip}}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div><div class="od-Persona-details">\x3c!--ko if:showProfileLink--\x3e\x3c!--ko if:person().profilePage--\x3e<a class="od-Persona-link od-Persona-primaryText" target="_blank" data-bind="attr:{href:person().profilePage},text:person().name"></a>\x3c!--/ko--\x3e\x3c!--ko ifnot:person().profilePage--\x3e<span class="od-Persona-link od-Persona-primaryText" data-bind="text:person().name"></span>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:!showProfileLink&&showName--\x3e<div class="od-Persona-primaryText od-persona-link" data-bind="text:person().name"></div>\x3c!--/ko--\x3e<div class="od-Persona-secondaryText" data-bind="visible:!!person().job,text:person().job"></div><div class="od-Persona-tertiaryText" data-bind="visible:!!person().department,text:person().department"></div><div class="od-Persona-optionalText" data-bind="visible:!!person().office,text:person().office"></div><div class="od-Persona-emailText" data-bind="visible:showEmail,text:person().email"></div>\x3c!--ko if:canChangePermissions()&&canManagePermissions()--\x3e<div class="od-Persona-sharingContainer" data-bind="visible:!updatingPermissions()&&getSharingRole(person().sharingInfo)&&personaSize()>3"><button class="od-Persona-sharingRole" aria-haspopup="true" data-bind="click:onSharingRoleClick,keyboard:{Space:onSharingRoleClick},attr:{\'aria-label\':getSharingRole(person().sharingInfo),tabindex:!disableTab?\'0\':\'-1\'},element:sharingRoleElement"><div class="od-Persona-sharingRole-Text"><span data-bind="text:getSharingRole(person().sharingInfo)"></span><span class="od-Persona-sharingRole-Chevron" data-bind="visible:!personIsCurrentUser()"><i class="ms-Icon ms-Icon--ChevronDown" data-bind="icon:true"></i></span></div></button></div>\x3c!--ko if:updatingPermissions()--\x3e<div class="od-Persona-sharingSpinner" data-bind="component:{name:loadingSpinnerTagName,params:{loadingText:updatingText}},visible:updatingPermissions()"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:hasSharingInfo&&(!canChangePermissions()||!canManagePermissions())--\x3e<div class="od-Persona-sharingRole-Text" data-bind="text:getSharingRole(person().sharingInfo)"></div>\x3c!--/ko--\x3e</div></div>',viewModel:xn}),Nn=(function(e){Object(r.r)(t,e);function t(t){var n=e.call(this,t)||this;n.signInAsText=t.signInAsText;n.bodyText=t.bodyText;n.personaTagName=Tn.tagName;n.personaParams={person:f.observable(t.person),personaSize:2};return n}return t})(re.e),Cn=(ge.e({tagName:"od-ticket-redeem",template:ne,viewModel:Nn,synchronous:!0}),Sn={automationName:"od-ticket-redeem",name:"TicketRedeem",template:ne,viewModelType:Nn},new h.t({name:Sn.name,factory:new b({template:Sn.template,automationName:Sn.automationName,viewModelType:Sn.viewModelType,dependencies:Sn.dependencies})})),kn=n(519),Ln=n(372),An=n(314);n(18),n(53),n(342);function On(e){return e.folder?a.o:e.photo?a.u:e.video?a.a:a.s}function Mn(e){return e.folder?a.t:e.photo?a.n:e.video?a.r:a.e}function _n(e){var t,n=e.resources.consume(hn.i).getIdentity();return{userId:n.id,name:n.email,email:"",image:null===(t=window.FilesConfig.SuiteNavConfig)||void 0===t?void 0:t.UserTileUrl}}var Dn=n(101),Pn=n(19),Hn=n(290),Bn={INPUT:!0,TEXTAREA:!0};function jn(e){var t;t=(function(e){var t;if(e>=65&&e<=91)t=String.fromCharCode(e);else switch(e){case 8:t="Backspace";break;case 9:t="Tab";break;case 13:t="Enter";break;case 27:t="Esc";break;case 32:t="Space";break;case 37:t="Left";break;case 38:t="Up";break;case 39:t="Right";break;case 40:t="Down";break;case 46:t="Delete";break;case 113:t="F2";break;case 191:t="/";break;case 121:t="F10";break;default:t=""}return t})(e.keyCode);e.metaKey&&(t="Meta"+t);e.ctrlKey&&(t="Ctrl"+t);e.altKey&&(t="Alt"+t);e.shiftKey&&(t="Shift"+t);return t}var Fn,In={},qn={keyboardManager:new((function(){function e(e){var t=this;this._shortcuts={};this.registerKeyboardShortcut=function(e){for(var n=e.keySequences,r={description:e.description,onExecute:e.onExecute},i=t._shortcuts,s=0,o=n;s<o.length;s++){var u=o[s];(i[u]||(i[u]=[])).push(r)}return function(){for(var e=0,t=n;e<t.length;e++){var s=t[e],o=i[s];if(o){var u=o.indexOf(r);u>-1&&(o.length>1?o.splice(u,1):delete i[s])}}}};this.registerActiveChild=function(e){var n=t._hasActiveChildren,r=t._parent;if(e){t._hasActiveChildren++;n||r&&r.registerActiveChild(!0);Hn.e.raise(t,"change")}else{t._hasActiveChildren--;t._hasActiveChildren||r&&r.registerActiveChild(!1);Hn.e.raise(t,"change")}};this.hasActiveChildren=function(){return t._hasActiveChildren>0};this.setIsActive=function(e){if(e!==t._isActive){t._isActive=e;var n=t._parent;n&&n.registerActiveChild(e);Hn.e.raise(t,"change")}};this._onFocusOrBlur=function(e,n){void 0===n&&(n=!0);var r=t._getActiveManager();if(r!==t._activeManager){t._activeManager&&t._activeManager.setIsActive(!1);t._activeManager=r;r.setIsActive(!0)}n&&setTimeout(function(){t._onFocusOrBlur(e,!1)},0)};this._onProcessKeys=function(e){if((t._isActive||t._isDefault)&&!t._hasActiveChildren){var n=e.target;if(!n||!(function(e){var t=e;return t&&(t.tagName in Bn||t.isContentEditable)})(n)){var i=jn(e),s=t._shortcuts[i];if(s)for(var o=0,u=Object(r.o)([],s,!0);o<u.length;o++){(0,u[o].onExecute)();e.preventDefault()}}}};var n=e.isDefault,i=void 0!==n&&n,s=e.id;In[s]=this;this._events=new Hn.e(this);this._isDefault=i;this._parent=e.parent;this._isActive=!1;this._hasActiveChildren=0;this._id=s;this._shortcuts={};this._events.on(document,"keydown",this._onProcessKeys);if(!this._parent){this._onFocusOrBlur();this._events.on(document,"focus",this._onFocusOrBlur,!0);this._events.on(document,"blur",this._onFocusOrBlur,!0)}}e.prototype.dispose=function(){var e=this._parent;e&&this._isActive&&e.registerActiveChild(!1);this._events.dispose();delete In[this._id]};e.prototype.getIsActive=function(){return this._isActive||this._isDefault};e.prototype._getActiveManager=function(){var e=document.activeElement;if(!document.activeElement)return this;var t=Object(U.e)(e,function(e){return e.hasAttribute("data-keyboard-zone-id")});if(t){var n=t.getAttribute("data-keyboard-zone-id");if(n){var r=In[n];if(r)return r}}return this};return e})())({isDefault:!0,id:"0"})},Rn=o.createContext(qn),Un=(function(e){Object(r.r)(t,e);function t(t){var n=e.call(this,t)||this;n._keyboardManager=t.keyboardManager;n.isActive=n.observables.create(n._keyboardManager.getIsActive());n.isDescendantActive=n.observables.create(n._keyboardManager.hasActiveChildren());n.isDescendantOrSelfActive=n.observables.pureCompute(function(){return n.isActive()||n.isDescendantActive()});n.events.on(n._keyboardManager,"change",function(){n.isActive(n._keyboardManager.getIsActive());n.isDescendantActive(n._keyboardManager.hasActiveChildren())});return n}t.prototype.register=function(e){var t=this,n=e.isDescendantOrSelfActive.subscribe(function(e){t._keyboardManager.registerActiveChild(e)});return{dispose:function(){n.dispose();t.events.dispose();t._keyboardManager.registerActiveChild(!1)}}};return t})(C.t);function zn(e){var t=this,n=e.hidden,u=e.item,l=e.onRedeemed,c=e.onSwitchAccount,h=e.onDismiss,p=Object(T.t)(),d=(function(){var e=o.useContext(Rn).keyboardManager,t=new Un({keyboardManager:e});o.useEffect(function(){return function(){return t.dispose()}},[]);return function(e){f.utils.domData.set(e,"InteractionScopeBinding_scope",t)}})(),v=On(u),m=Mn(u),g=a.f,y=_n({name:"WacRedeemDialog",resources:p}),b=o.useState(function(){return(function(e,t){return{definitionKey:e,params:t}})(Cn,{bodyText:m,signInAsText:g,person:y,resources:p})})[0],w=Object(o.useCallback)(function(){return Object(r.t)(t,void 0,void 0,function(){return Object(r.i)(this,function(e){return[2,p.consume(An.resourceKey).redeemPermissionToken({item:u}).then(l,h)]})})},[l,p,h]);return o.createElement(i.e,{minWidth:480,hidden:n,title:v,onDismiss:h},o.createElement(te,{specification:b,resources:p,onApplyBindings:d}),o.createElement(s.e,null,o.createElement(kn.e,{onClick:w,iconProps:{iconName:"Edit"},text:a.i}),o.createElement(Ln.e,{iconProps:{iconName:"BackToWindow"},onClick:c,text:a.l})))}(function(e){e[e.Skipped=0]="Skipped";e[e.Redeemed=1]="Redeemed";e[e.SwitchAccount=2]="SwitchAccount";e[e.Cancelled=3]="Cancelled"})(Fn||(Fn={}));function Wn(e){var t=e.redeemDialogHandleRef,n=e.item,r=e.callerCid,i=e.authKey,s=Object(o.useState)(!0),u=s[0],a=s[1],f=Object(Dn.t)().dispatcher,l=Object(o.useCallback)(function(){f.respond(Object(Pn.n)())},[f]),c=Object(o.useCallback)(function(){f.respond(Object(Pn.r)())},[f]),h=Object(o.useCallback)(function(){l();a(!1)},[a]),d=Object(o.useCallback)(function(){g.current&&g.current.resolve(Fn.Cancelled);a(!0);c()},[a,c]),m=Object(T.t)(),g=Object(o.useRef)(null),y=Object(o.useRef)("");Object(o.useImperativeHandle)(t,function(){return{redeem:function(t){var i=t.returnUrl;g.current&&g.current.cancel();if(!r){var s=(function(e,t){var n=Xn(e,t),r=encodeURIComponent(n);return e.signInUrl+"&ru="+r+"&wreply="+r})(e,i);window.open(s,"_top");return v.t.resolve(Fn.Skipped)}if(r.toLowerCase()===n.ownerId.toLowerCase()){window.location.href=i;return v.t.resolve(Fn.Skipped)}y.current=i;g.current=new p.e;h();return g.current.getPromise()}}},[m,h,n,r,i]);var b=Object(o.useCallback)(function(){g.current&&g.current.resolve(Fn.Redeemed);a(!0);c();if(y.current){var e=y.current;window.location.href=e}else;},[]),w=Object(o.useCallback)(function(){g.current&&g.current.resolve(Fn.SwitchAccount);a(!0);c();if(y.current){var t=y.current,n=(function(e,t){var n=Xn(e,t),r=encodeURIComponent(n);return e.autoRedeemSignOut+"&lru="+r})(e,t);window.location.href=n}else;},[n,r,i]);return o.createElement(zn,{hidden:u,item:n,onRedeemed:b,onSwitchAccount:w,onDismiss:d})}t.default=Object(o.forwardRef)(Wn);function Xn(e,t){return e.autoRedeemUrl+"?resid="+encodeURIComponent(e.item.id)+"&authkey="+encodeURIComponent(e.authKey)+"&ru="+encodeURIComponent(t)}}}]);
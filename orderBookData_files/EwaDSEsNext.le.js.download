'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[14],{1259:function(r,F,a){r=a(0);var c=a(7),b=a(15),e=a(27),f=a(89),d=a(14),h=a(84),l=a(421),k=a(81),t=a(8),n=a(64),z=a(462);class w{constructor(Z,ea){this.helpId=this.helpText=this.imageAltText=this.urlValue=this.longDescription=this.convertToDomainName=this.cardViewManager=null;this.$=ea;this.parentElement=Z}Kbh(){const Z=this.Lbh();z.a(this.$,243,242,0,ea=>{this.cardViewManager=ea;ea.H9f(this.parentElement,2,
Z)})}$bf(){this.cardViewManager&&this.cardViewManager.xLa(-1,-1,this.parentElement)}Lbh(){const Z={layoutId:"AutoDetectTooltip"};Z.description=this.longDescription;Z.convertToDomainName=this.convertToDomainName;Z.longDescription=this.longDescription;Z.urlValue=this.urlValue;Z.imageAltText=this.imageAltText;Z.helpText=this.helpText;Z.helpId=this.helpId;return Z}}Object(r.a)(w,"AutoDetectCardManager",null,[]);var m=a(31),u=a(195),y=a(30),v=a(227),C=a(19),x=a(51),B=a(1);class H extends k.a{constructor(Z,
ea,ra){super();this.fd=O=>{if(O.Mb.id===this.Tta.firstChild.id){O=this.Dwe;const da={};da.Id=O.Ppb;this.convertToLinkedEntityManager.Q4c(da,!0,O);this.Tta.removeChild(this.Tta.firstChild);return!0}return!1};this.Dwe=Z;this.convertToLinkedEntityManager=ea;this.Tta=document.createElement("div");this.Tta.className="clip16x16";this.tka=String.format('<input type="image" id="{0}" class="{1}" src="{2}" alt="Convert To Linked Entities Column Header Button">',y.a.yg("autodetectid"+this.Dwe.left),C.a.Vad,
x.a.qe(11));B.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&B.EwaSettings.isChangeGateEnabled("OfficeVSO:7188168_ReduceInnerHTMLUsageForAutoDetectColumnHeaderButton")?ra.Rh(this.Tta,this.tka):this.Tta.innerHTML=this.tka;Z=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");v.a.instance.ta(d.a.click,Z,this.fd)}get domElement(){return this.Tta}dispose(){if(this.Tta){const Z=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");v.a.instance.Ba(d.a.click,
Z,this.fd)}super.dispose()}static get m_g(){return"clip16x16"}}Object(r.a)(H,"AutoDetectColumnHeaderButton",k.a,[]);var I=a(1109),U=a(11),S=a(21),G=a(179);class D extends k.a{constructor(Z,ea,ra){super();this.htmlSanitizationHelper=null;this.$=Z;this.gridView=S.h(Z);this.convertToLinkedEntityManager=ea;this.htmlSanitizationHelper=ra;this.C3c=new G.a}dispose(){super.dispose()}Mnh(Z){for(let ea of this.gridView.Kha)for(let ra of ea){const O=ra,da=O.qt,xa=I.a(O.q4);this.EIg(Z,xa,da);O.IRd(xa)}}EIg(Z,
ea,ra){if(ea.length){var O=ra.length;ra[O-1]<Z.left||(ra=U.HelperMethods.Xu(new u.a(ra),0,O,Z.left,U.HelperMethods.sz),0>ra||!(ea=ea[ra]))||(this.gridView.rtl?ea.classList.add(m.a.hBh):ea.classList.add(m.a.gBh),this.C3c.hb(Z.left)||this.C3c.add(Z.left,new H(Z,this.convertToLinkedEntityManager,this.htmlSanitizationHelper)),Z=this.C3c.ma(Z.left).domElement,!ea.getElementsByClassName(H.m_g).length&&this.KMj(ea)&&ea.appendChild(Z))}}KMj(Z){const ea=parseInt(Z.style.width,10);var ra=document.querySelector(".ewrch-col-cellsel")?
"bold":"normal";ra=D.xdh(ra);Z=gridRenderer.CanvasRendererGlobals.measureTextWidth(this.htmlSanitizationHelper.I2h(Z.firstChild.innerHTML),ra,!0,B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1));return 18.4<ea-(ea/2+Z/2)?!0:!1}static xdh(Z){return`${"normal"} ${"normal"} ${Z} ${"10pt"}/${"normal"} ${'"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif'}`}}Object(r.a)(D,"AutoDetectColumnHeaderManager",k.a,[]);var E=a(431),N=a(24),M=a(65),L=a(140),aa=a(12),V=a(13),
P=a(145),ba=a(70);a.d(F,"a",function(){return Y});class Y extends k.a{constructor(Z,ea,ra,O,da){super();this.isMac=e.a.isMac;this.DYa=-1;this.w6b=null;this.sta=-1;this.hN=this.Ckc=this.oVd=this.d_=this.Ewe=!1;this.zT=null;this.Xg=()=>{this.xwa&&this.gridView&&this.KW()};this.uc=()=>{this.Yx()};this.fd=()=>{this.XHa();S.h(this.$).ag(!0,!1)};this.Gya=(ia,Ma)=>{Ma?(this.Vig(this.w6b),this.Eeb()):(ia=[29],this.gridView.Cb.Nj(ia),this.gridView.Cb.wk(null,ia),this.zT&&this.zT.$bf())};this.wj=()=>{this.r7a()&&
this.xh.hide();1===this.gridView.ha.Ke&&this.KW()};this.jR=()=>{const ia=this.gridView.ha.Ke;this.gridView.ha.qa.activeCell&&1===ia&&this.KW()};this.onKeyUp=ia=>this.oDb?this.d_?!1:17===ia.Ea.keyCode&&this.oVd?(this.hN?(this.Eeb(),this.Dda()):this.vMb(),!0):!1:this.d_=!1;this.onKeyDown=ia=>{if(!this.oDb)return this.d_=!1;this.oVd=!1;this.d_=ia.ctrlKey;switch(ia.Ea.keyCode){case 27:return this.hN?(this.Gya(null,!1),this.Dda()):this.zT&&(this.zT.$bf(),this.vMb()),!0;case 13:if(this.hN)return this.hN=
!1,this.XHa(),!0;break;case 17:return this.oVd=!0}return!1};const {AutoDetectActionButton:xa}=a(1371);this.$=Z;this.Qpb=B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AutoDetectRichTooltip",!1);ea||b.ULS.sendTraceTag(537166983,0,15,"AutoDetectManager: SVG icons are enabled, but svgIconProvider is null");this.convertToLinkedEntityManager=O;O.gIb();this.xh=new xa(Z,ea,this.fd,ra,"");this.RUg=new D(this.$,O,da);this.gridView=S.h(this.$);this.gridView.ha.rT(this.Xg);this.gridView.Vb.UYa(this.Xg);
this.gridView.Uu(this.jR);Z.nj(this.uc);Z.dC(this.wj);this.gridBlockManager=Object(h.a)(607,this.gridView.Ca);this.to=Z.frame.Lt;this.KW()}get jc(){return this.xh.domElement(1)}get oDb(){const Z=this.xh.domElement(Y.Gea);return Z?aa.DOMElementExtensions.isVisible(Z):!1}get xwa(){return this.$.isEditMode&&B.EwaSettings.ra(128)&&B.EwaSettings.ra(131)&&(new L.a(this.$.va)).Ph?!1:-1!==this.sta}dispose(){this.gridView&&this.gridView.ha.AR(this.Xg);if(this.$){const Z=this.$;Z.ol(this.uc);Z.zF(this.wj);
S.h(Z).my(this.jR)}f.a.Ja(this.xh);this.to=this.$=this.gridView=this.xh=null;super.dispose()}Yx(){this.Gya(null,!1);this.DYa=-1;this.xh.hide();this.eYj();this.hN=!1}Dda(){this.xh.getButton(Y.Gea).Ncb();this.hN=!1}vMb(){this.xh.getButton(Y.Gea).bIb();this.Vig(this.w6b);this.hN=!0;this.$.da.gb(211,Z=>{Z.gQa(V.a.instance.ga(1750))})}onAutoDetectUIShown(){if(this.xwa&&-1!==this.DYa)this.convertToLinkedEntityManager.onAutoDetectUIShown()}SUg(Z){var ea=new N.Range(1===Z.top?1:Z.top-1,Z.left,Z.bottom,Z.right,
!0,!1);ea=this.gridView.getRangeInformation(ea);for(const ra of ea)if(Object(l.a)(E.AutoDetectRange,ra)&&this.mhc(Z,!1,ra))return!0;return!1}XHa(){if(this.xwa&&-1!==this.DYa){this.xh.getButton(Y.Gea).bIb();var Z={};Z.Id=this.sta;Z.StringId=null;this.convertToLinkedEntityManager.Q4c(Z,!0,this.w6b);b.ULS.sendTraceTag(594612633,0,50,"AutoDetectManager.Convert (AssistedAutoConvertMenuConvertClicked)");Z=[Object(c.a)(new ba.a,{name:"Domain",int64:this.sta})];P.a("AssistedAutoConvertMenuConvertClicked",
void 0,void 0,Z);this.sta=-1}}kQh(){let Z=V.a.instance.ga(1746);if(-1!==this.sta){Z+=" ";try{Z+=this.convertToLinkedEntityManager.MCb(this.sta.toString())}catch(ea){b.ULS.sendTraceTag(537166982,0,10,`AutoDetectManager.GetButtonAccessibilityString: Could not obtain name from domain ${this.sta}`)}}Z+=" ";return Z=this.Qpb?Z+V.a.instance.ga(1749):Z+V.a.instance.ga(this.isMac?1748:1747)}Eeb(){this.Qpb&&(this.zT||(this.zT=new w(this.jc,this.$),this.zT.convertToDomainName=V.a.instance.ga(1751),this.zT.urlValue=
"https://support.content.office.net/en-us/media/758743e7-a2ca-42db-9f43-a45b05b1b077.png",this.zT.imageAltText=V.a.instance.ga(1753),this.zT.helpId="HID_DataTypes_Wolfram",this.zT.helpText=V.a.instance.ga(1752)),this.zT.longDescription=this.convertToLinkedEntityManager.gZd(this.DYa.toString()),this.zT.Kbh())}mhc(Z,ea,ra){if((new N.Range(ra.top,ra.left,ra.bottom===t.a.Vg?ra.bottom:ra.bottom+1,ra.right,!0,!1)).zd(Z)){if(ea){if(ra&&ra.Ppb!==this.DYa){this.DYa=ra.Ppb;Z=ra.Ppb.toString();ea=this.Qpb?"":
this.convertToLinkedEntityManager.gZd(Z);const O=this.convertToLinkedEntityManager.Ydi(Z);this.xh.Dgb(this.convertToLinkedEntityManager.MCb(Z),ea,O,Y.Gea)}this.sta=ra.Ppb;this.w6b=ra}return!0}return!1}KW(){if(this.convertToLinkedEntityManager){var Z=this.gridView.ha.Ke;if(this.gridBlockManager&&this.gridBlockManager.hld){var ea=this.gridView.ha.qa.activeCell,ra=!this.gridBlockManager.Ur(ea),O=this.gridView.getRangeInformation(this.gridView.hi);for(const da of O)if(Object(l.a)(E.AutoDetectRange,da))switch(O=
da,O.A4g){case 3:if(this.mhc(ea,!0,O)){if(1!==Z||ra){this.Yx();return}b.ULS.sendTraceTag(537166981,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");this.MKd();this.xh.VAa(ea,this.Gya);this.Ewe||(this.Ewe=!0,this.onAutoDetectUIShown());return}break;case 2:case 1:(B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.LoadClassifier",!1)||B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.PasteClassifier",!1))&&this.RUg.Mnh(O);break;default:b.ULS.sendTraceTag(537166980,
0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (Invalid LinkedEntityClassifierTrigger used)")}}this.Yx()}}Vig(Z){const ea=[29];this.gridView.Cb.wk(Z,ea);this.gridView.Cb.Qq(ea)}r7a(){return this.$.ea.isNamedObjectViewMode&&M.f(this.$.na)}MKd(){this.Qpb&&!this.Ckc&&this.to&&(this.to.ms(d.a.Sb,this.$.domElement,this.onKeyDown,!0),this.to.ms(d.a.Ld,this.$.domElement,this.onKeyUp,!0),this.Ckc=!0)}eYj(){this.Qpb&&this.Ckc&&this.to&&(this.to.ys(d.a.Sb,this.$.domElement,this.onKeyDown,!0),this.to.ys(d.a.Ld,
this.$.domElement,this.onKeyUp,!0),this.Ckc=!1)}static get Gea(){return 1}static tSh(Z){return V.a.instance.ga(1807)+n.a.space+Z}}Object(r.a)(Y,"AutoDetectManager",k.a,[])},1371:function(r,F,a){a.r(F);a.d(F,"AutoDetectActionButton",function(){return d});r=a(0);F=a(81);var c=a(1259),b=a(51),e=a(13),f=a(21);class d extends F.a{constructor(h,l,k,t,n){super();this.$=h;this.co=t.e6b(h,l,k,"",b.a.qe(11),n,"AutoDetectPointerDown",e.a.instance.ga(1807)+"...")}get $y(){return this.co.$y}dispose(){this.co.dispose();
this.$=null;super.dispose()}domElement(h){return this.co.domElement(h)}getButton(h){return this.co.getButton(h,!1)}Dgb(h,l,k,t){this.co.jUa(c.a.tSh(h),l,t);this.co.Rjg(k,l,t)}VAa(h,l){const k=f.h(this.$),t=k.ib.Ai(h);h=k.xg(h,t);const n=k.Rf(t).zn;if(h&&0<=h.x&&0<=h.y&&n.width>h.width+160){let z=h.bottomRight.x+this.$y,w=h.topLeft.y+this.$y,m=!1;z+160>n.bottomRight.x&&(z=h.topLeft.x-this.$y,m=!0);if(w<n.topLeft.y+this.$y){if(k.ib.EBa){this.hide();return}w=n.topLeft.y+this.$y}this.co.d9b(l,t);this.xp(z,
w,k.rtl,t,m)}else this.hide()}xp(h,l,k,t,n){this.co.xp(h,l,k,t,!1,n)}hide(){this.co.hide()}}Object(r.a)(d,"AutoDetectActionButton",F.a,[])},1479:function(r,F,a){a.r(F);r=a(0);var c=a(709),b=a(15),e=a(5),f=a(68),d=a(37),h=a(1),l=a(189),k=a(21),t=a(145);class n{constructor(L,aa){this.$=aa;this.convertToLinkedEntityManager=L}Hc(L,aa){switch(aa){case -1203788282:case 48568533:case -1662108744:return L=k.h(this.$),aa=this.convertToLinkedEntityManager.ZHi||7E3,(null===L||void 0===L?0:L.ha)&&L.ha.qa.ld.Oy>
aa?!0:!1;default:return!1}}executeCommand(L,aa,V){L=d.TaskExtensions.Tj();aa=aa.command;switch(aa){case -1203788282:this.convertToLinkedEntityManager.bah(V[f.a.Kc].toString());break;case 311599363:this.convertToLinkedEntityManager.convertLinkedEntityToText();break;case 439914789:this.convertToLinkedEntityManager.refreshLinkedEntitiesInRange();break;case 2127195269:this.convertToLinkedEntityManager.launchDisambiguationPaneForSearch();break;case -1662108744:this.convertToLinkedEntityManager.launchLinkedEntityDataTypeSelectorPane(V[f.a.Kc].toString());
break;case 1266950951:this.convertToLinkedEntityManager.Vyi();break;case 49813714:this.convertToLinkedEntityManager.convertToLinkedEntityFromAutoDetect();break;case -1081442996:this.convertToLinkedEntityManager.zPe();break;case 1702917262:this.convertToLinkedEntityManager.showHelpArticle(e.a.yZj);break;case -90814711:this.convertToLinkedEntityManager.showUntrustedImageBusinessBarIfNecessary();break;case 48568533:case -1027730316:if(48568533===aa||V[f.a.bqf]&&"ConvertToLinkedEntityGallery"===V[f.a.bqf].toString())b.ULS.sendTraceTag(559982275,
0,50,"ConvertToLinkedEntityCommandHandler.ExecuteCommand() - Expanding data types preview gallery"),t.a("ExpandDataTypeGallery");break;default:L=l.a(aa)}return L}wc(L,aa){switch(aa.command){case -1203788282:case 439914789:case 2127195269:case 49813714:return h.EwaSettings.ra(123);case -1081442996:case 1702917262:case -90814711:case 48568533:case -1027730316:case -1662108744:case 311599363:case 1266950951:return!0;default:return!1}}Nc(L,aa,V){return"PopulateConvertToLinkedEntityMenu"===aa&&h.EwaSettings.ra(123)?
this.convertToLinkedEntityManager.Nc(L,aa,V):!1}}Object(r.a)(n,"ConvertToLinkedEntityCommandHandler",null,[222]);var z=a(462);class w extends c.a{constructor(L){super(L)}hd(){z.a(this.$,271,272,this.Xa,L=>{this.$c([new n(L,this.$)])})}static ka(L){c.a.Md(273,new w(L))}}Object(r.a)(w,"ConvertToLinkedEntityCommandHandlerFactory",c.a,[]);var m=a(55);F=a(226);var u=a(772),y=a(50),v=a(422),C=a(712);class x extends F.a{constructor(L){super();this.$=L;this.Db()}create(){const L=y.GetServiceTaskFactory.create(this.$.da,
102,this.$.la,this.Xa),aa=y.GetServiceTaskFactory.Oa(this.$.da,5,4,this.Xa),V=y.GetServiceTaskFactory.Oa(this.$.da,388,387,this.Xa),P=h.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&h.EwaSettings.isChangeGateEnabled("OfficeVSO:7126083_ReduceInnerHTMLUsageForEnrichmentTaskPaneWrapper")?y.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Xa):m.Task.Sa(null),ba=y.GetServiceTaskFactory.Oa(this.$.da,257,258,this.Xa),Y=v.a(this.$);d.TaskExtensions.za(d.TaskExtensions.Fd([L,ba,
Y,aa,V,P],this.la),()=>{this.nb(Object(C.a)(this.$.da,271,()=>new u.ConvertToLinkedEntityManager(this.$,L.result,V.result,ba.result,Y.result,aa.result,P.result)))},this.$.la,3)}static ka(L){L.da.Ha(272,new x(L))}}Object(r.a)(x,"ConvertToLinkedEntityManagerFactory",F.a,[]);var B=a(239),H=a(263),I=a(33),U=a(250),S=a(12),G=a(719);const D=a(19).a.PAh;class E extends B.a{constructor(L,aa,V){super(L);this.Hv=0;this.Bs=!1;this.uc=()=>{this.Kg(!1)};this.$=aa;this.taskPaneManager=V;H.a(aa).Yh(this);this.$.nj(this.uc);
I.a.Ad(this.$)&&(this.isVisible=!1)}qT(L){this.get_events().addHandler("EnrichmentTaskPaneRemoved",L)}mW(L){this.get_events().removeHandler("EnrichmentTaskPaneRemoved",L)}kE(L){this.addHandler("EnrichmentTaskPaneVilibilityChanged",L)}BF(L){this.removeHandler("EnrichmentTaskPaneVilibilityChanged",L)}XNg(L){this.addHandler("EnrichmentTaskPaneOnFocus",L)}Skj(L){this.removeHandler("EnrichmentTaskPaneOnFocus",L)}get isVisible(){return super.isVisible}set isVisible(L){super.isVisible=L;this.raiseEvent("EnrichmentTaskPaneVilibilityChanged")}get Ff(){return this.isVisible}get Xd(){return U.a.Dsh}get Jh(){return 10}get ek(){return D}get AQ(){return this.titleText}get titleText(){return"Enrichment"}get Vp(){return 300}get isResizable(){return!1}get jc(){return this.domElement}get height(){return this.taskPaneManager.rO.offsetHeight}get FB(){return this.taskPaneManager.Vua(this.jc,
this.titleText,this.Vp,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1},this.Vp)}Cq(){return this.Bs}wt(){return this.Bs}IV(){}dispose(){this.$&&this.$.ol(this.uc);this.taskPaneManager=this.$=null;super.dispose()}ag(L,aa){aa||this.raiseEvent("EnrichmentTaskPaneOnFocus");return!aa}sh(L){return S.DOMElementExtensions.Af(this.jc,L)}rj(){}dk(){}Kg(L){this.Bs=L;const aa=this.taskPaneManager;this.isVisible=L;I.a.Ad(this.$)?L?this.taskPaneManager.q6("EnrichmentTaskPane",
this.FB):this.taskPaneManager.hideTaskPane("EnrichmentTaskPane"):(L&&0<aa.GD.length&&(!aa.Ch||10!==aa.Ch.taskPane.Jh||aa.isCollapsed)&&aa.hI(this,!0),aa.HB());L||(k.h(this.$).ag(!0,!1),this.$.qf())}TU(){return!1}static ka(L,aa){var V=L.Bb;let P=document.getElementById(V+e.a.WPe);P||(P=G.a("div",L.Bb+e.a.WPe,"cui-taskpane"),I.a.Ad(L)||(V=document.getElementById(V+e.a.AV),void 0!==V&&null!==V?V.appendChild(P):b.ULS.sendTraceTag(537166720,0,10,`EnrichmentTaskPane.Attach: couldn't find novTaskPaneBodyDiv. IsAppUnloading: ${L.YC}`)));
V=L.da;return V.Aa(257)||V.Ha(257,new E(P,L,aa))}}Object(r.a)(E,"EnrichmentTaskPane",B.a,[572,2,262,54]);class N extends F.a{constructor(L){super();this.Yg=this.$h=null;this.$=L;this.Db()}get pD(){this.$h||(this.$h=d.TaskExtensions.za(v.a(this.$),L=>{this.Yg=E.ka(this.$,L.result)},this.la,3));return this.$h}create(){const L=y.GetServiceTaskFactory.create(this.$.da,203,this.la,this.Xa),aa=y.GetServiceTaskFactory.create(this.$.da,155,this.la,this.Xa);d.TaskExtensions.za(d.TaskExtensions.ts(d.TaskExtensions.Fd([L,
aa],this.la),()=>this.pD,this.la),()=>{this.nb(this.Yg)},this.la,3)}dispose(){this.Yg=this.$h=this.$=null;super.dispose()}static ka(L){L.da.Ha(258,new N(L))}}Object(r.a)(N,"EnrichmentTaskPaneFactory",F.a,[]);var M=a(9);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.Enrichment");(()=>{M.a.Fa(L=>{N.ka(L);x.ka(L);w.ka(L)})})()},772:function(r,F,a){a.r(F);var c=a(0),b=a(15),e=a(89),f=a(268),d=a(4),h=a(30),l=a(843),k=a(136),t=a(83),n=a(38),z=a(19),w=a(5),m=a(166),u=a(1259),y=a(1262),
v=a(174),C=a(558),x=a(348),B=a(60);const H=(kb,jb,Wb,wc,Jc,zc=null)=>{zc=kb.Na(1,zc);return B.g(kb,"GetRichDataClassificationLabels",zc,jb,Wb,wc,Jc,4)},I=(kb,jb,Wb,wc,Jc,zc,gd,Va,Eb=null)=>{Eb=kb.Na(1,Eb);Eb.selectedRanges=jb;Eb.domainId=Wb;Eb.autodetect=wc;return B.g(kb,"ConvertToLinkedEntity",Eb,Jc,zc,gd,Va,4)},U=(kb,jb,Wb,wc,Jc,zc=null)=>{zc=kb.Na(1,zc);return B.g(kb,"OnAutoDetectUIShown",zc,jb,Wb,wc,Jc,4)},S=(kb,jb,Wb,wc,Jc,zc=null)=>{zc=kb.Na(1,zc);return B.g(kb,"GetLinkedEntityMetadata",zc,
jb,Wb,wc,Jc,4)},G=(kb,jb,Wb,wc,Jc,zc,gd=null)=>{gd=kb.Na(1,gd);gd.selectedRanges=jb;return B.g(kb,"ConvertLinkedEntityToText",gd,Wb,wc,Jc,zc,4)},D=(kb,jb,Wb,wc,Jc,zc,gd=null)=>{gd=kb.Na(1,gd);gd.selectedRanges=jb;return B.g(kb,"RefreshLinkedEntitiesInRange",gd,Wb,wc,Jc,zc,4)},E=(kb,jb,Wb,wc,Jc,zc,gd,Va,Eb,hc,Ab=null)=>{Ab=kb.Na(1,Ab);Ab.selectedRanges=jb;Ab.isChangeObject=Wb;Ab.isFloodgateEnabled=wc;Ab.isStarterData=Jc;Ab.starterDataDomainId=zc;return B.g(kb,"GetDataSelectorPaneData",Ab,gd,Va,Eb,
hc,4)},N=(kb,jb,Wb,wc,Jc,zc,gd,Va=null)=>{Va=kb.Na(9,Va);Va.activeCell=jb;Va.selectionIndex=Wb;return B.g(kb,"SelectLinkedEntityForDisambiguation",Va,wc,Jc,zc,gd,4)},M=(kb,jb,Wb,wc,Jc,zc,gd,Va,Eb,hc,Ab,Bb=null)=>{Bb=kb.Na(1,Bb);Bb.searchCell=jb;Bb.searchQuery=Wb;Bb.isFloodgateEnabled=wc;Bb.isStarterData=Jc;Bb.starterDataDomainId=zc;Bb.starterDataDomainIdString=gd;return B.g(kb,"LinkedEntitySearch",Bb,Va,Eb,hc,Ab,4)},L=(kb,jb,Wb,wc,Jc,zc,gd,Va,Eb=null)=>{Eb=kb.Na(1,Eb);Eb.cell=jb;Eb.starterDataDomainId=
Wb;Eb.starterDataDomainIdString=wc;return B.g(kb,"InsertStarterDataTable",Eb,Jc,zc,gd,Va,4)},aa=(kb,jb,Wb,wc,Jc,zc,gd,Va=null)=>{Va=kb.Na(1,Va);Va.activeCell=jb;Va.isBackward=Wb;return B.g(kb,"MoveToNextAmbiguousLinkedEntity",Va,wc,Jc,zc,gd,4)},V=(kb,jb,Wb,wc,Jc,zc,gd=null)=>{gd=kb.Na(9,gd);gd.activeCell=jb;return B.g(kb,"CancelSearchLinkedEntity",gd,Wb,wc,Jc,zc,4)},P=(kb,jb,Wb,wc,Jc,zc,gd,Va=null)=>{Va=kb.Na(1,Va);Va.selectedRanges=jb;Va.letyDomainId=Wb;return B.g(kb,"GetDataTypeSelectorData",Va,
wc,Jc,zc,gd,4)},ba=(kb,jb,Wb,wc,Jc,zc=null)=>{zc=kb.Na(1,zc);return B.g(kb,"GetErrorMessageForLinkedDataTypeRefresh",zc,jb,Wb,wc,Jc,4)},Y=(kb,jb,Wb,wc,Jc,zc=null)=>{zc=kb.Na(1,zc);return B.g(kb,"GetHasUntrustedImageUrls",zc,jb,Wb,wc,Jc,4)},Z=(kb,jb,Wb,wc,Jc,zc=null)=>{zc=kb.Na(1,zc);return B.g(kb,"LinkedEntitiesEnableUntrustedImages",zc,jb,Wb,wc,Jc,0)},ea=(kb,jb,Wb,wc,Jc,zc=null)=>{zc=kb.Na(1,zc);return B.g(kb,"LinkedEntityTryAutoRefresh",zc,jb,Wb,wc,Jc,0)};var ra=a(85),O=a(719),da=a(802);class xa{}
xa.Sdi="EnrichmentContentFrame";xa.width=320;Object(c.a)(xa,"EnrichmentConstants",null,[]);class ia{constructor(kb){this.messageType=0;this.messageType=kb}}Object(c.a)(ia,"EnrichmentResponseMessage",null,[]);class Ma extends ia{constructor(kb,jb){super(kb);this.messageContent=null;this.messageContent=jb}}Object(c.a)(Ma,"EnrichmentResponseMessageWithContent",ia,[]);class Ta extends Ma{constructor(kb,jb,Wb){super(kb,jb);this.telemetryJson=null;this.telemetryJson=Wb}}Object(c.a)(Ta,"EnrichmentResponseMessageWithContentAndTelemetryData",
Ma,[]);var Da=a(264),fa=a(14),ua=a(97),Fa=a(46),ca=a(86),ka=a(110),Ca=a(39),fb=a(79),yb=a(27),mb=a(108),nb=a(710),X=a(25);class R{constructor(kb,jb,Wb,wc,Jc){this.Tq=this.pk=this.nae=this.lae=this.Ov=this.Nu=null;this.dx=!1;this.ti=kb;this.Yd=jb;this.WO=Wb;this.Zb=wc;this.Ma=Jc;this.cqa=ka.KeyInputManager.Al(ca.a.Voa,0)}get ZMb(){return!0}get xub(){return d.AFrameworkApplication.fa.Wa("EnrichmentPaneUrl")}dispose(){this.ZMb&&this.Tq&&(this.ti.Ba(fa.a.click,this.Tq,Object(ra.a)(this,this.ll,"onClosePaneClick")),
this.Yd.Ba(fa.a.Ld,this.Tq,Object(ra.a)(this,this.MEf,"onKeyHide")));this.Tq=null;this.Ov&&(this.LYj(),this.Ov.parentNode.removeChild(this.Ov),this.Ov=null);this.Zb.pi("EnrichmentPaneId").yk(this.cqa)}show(kb,jb,Wb){this.Nu=kb;this.dx||(this.pk=this.f1a(),this.mna.appendChild(this.pk),this.egj(),this.Ma.Nb(X.a.zDe,mb.a.frame,Object(ra.a)(this,this.p9h,"handleEscapeKeyAction")),this.lSa(),this.dx=!0);this.Ov.src=this.xub&&this.xub.length?this.xub+"?culture="+jb.market+"&appName="+jb.applicationName+
"&themeId="+jb.themeId+"&featuresBitMask="+jb.featuresBitMask:R.oyf;this.lae=jb;this.nae=Wb;this.zeb()}bEc(kb,jb){kb=new Ta(2,kb,jb);this.msc(kb)}lSa(){const kb=this.Zb.pi("EnrichmentPaneId");kb.parent=Da.AFrame.kOa;this.ti.$nb("EnrichmentPaneId",this.pk);kb.bindAction(this.cqa,X.a.zDe)}W4f(){if(this.Ov){ua.FocusManager.Goa(this.Ov.contentWindow);const kb=new Ta(4,null,null);this.msc(kb)}}ll(){this.m4b();return!0}MEf(kb){kb=kb.Ea.keyCode;return kb===Sys.UI.Key.enter||kb===Sys.UI.Key.space?(this.m4b(),
!0):!1}m4b(){this.hide();if(this.Nu)this.Nu.onPaneClosed()}f1a(){const kb=O.a("div","EnrichmentPaneId","EnrichmentPane");this.ZMb&&kb.appendChild(this.V5c());this.Hhi(kb);return kb}V5c(){const kb=O.b("div","EnrichmentPaneHeaderId","EnrichmentPaneHeader"),jb=O.b("div","EnrichmentPaneTitleId","cui-taskPaneTitle EnrichmentPaneTitle");jb.innerText=CommonUIStrings.l_EnrichmentPaneTitle;jb.title=CommonUIStrings.l_EnrichmentPaneTitle;const Wb=da.a.pb("CloseEnrichmentPane","EnrichmentPaneCloseButton",CommonUIStrings.l_Close,
"ClosePaneGlyph_16x16x32",!1);this.ti.ta(fa.a.click,Wb,Object(ra.a)(this,this.ll,"onClosePaneClick"));this.Yd.ta(fa.a.Ld,Wb,Object(ra.a)(this,this.MEf,"onKeyHide"));kb.appendChild(jb);kb.appendChild(Wb);this.Tq=Wb;return kb}Hhi(kb){this.Ov=O.b("iframe","","EnrichmentFrame");kb.appendChild(this.Ov);this.Ov.id=xa.Sdi;this.Ov.setAttribute("role","presentation")}egj(){Fa.a.addHandler(this.Ov,"load",Object(ra.a)(this,this.oEf,"onIFrameLoad"));Fa.a.addHandler(this.Ov,"error",Object(ra.a)(this,this.xpc,
"onIFrameError"));$addHandler(window,"message",Object(ra.a)(this,this.pEf,"onIFrameMessage"))}LYj(){Fa.a.removeHandler(this.Ov,"load",Object(ra.a)(this,this.oEf,"onIFrameLoad"));Fa.a.removeHandler(this.Ov,"error",Object(ra.a)(this,this.xpc,"onIFrameError"));$removeHandler(window,"message",Object(ra.a)(this,this.pEf,"onIFrameMessage"))}Kjh(){this.Ov.src=R.oyf}hide(){this.jfc();this.Kjh()}p9h(kb,jb,Wb){if(1!==Wb&&(this.hide(),this.Nu))this.Nu.onPaneClosed();return 32}oEf(){}xpc(){}pEf(kb){kb=kb.rawEvent;
if(!this.Ov||-1!==this.Ov.src.indexOf(kb.origin)){try{var jb=Ca.a(kb.data)}catch(Wb){return}if(!nb.c(jb.messageType)){kb=window.g_badCastCallback;window.g_badCastCallback=null;switch(jb.messageType){case 2:this.msc(new Ta(1,Ca.c(this.lae),this.nae));break;case 1:this.msc(new Ma(0,this.IOh()));break;case 3:this.Nu&&this.Nu.selectEntity(jb.messageContent);break;case 5:this.Nu&&this.Nu.QEb(jb.messageContent);break;case 8:this.Nu&&(jb=Ca.a(jb.messageContent),0<jb.DomainId?this.Nu.PPd(jb.Query,jb.TelemetryJson,
jb.DomainId,jb.DomainIdString):this.Nu.searchEntity(jb.Query,jb.TelemetryJson));break;case 6:this.Nu&&this.Nu.cancelSearch();break;case 11:jb=Ca.a(jb.messageContent);jb=R.a6b("keydown","f6",ca.a.vRb,!0,!1,jb,!0,!1);this.Ov&&this.Ov.dispatchEvent(jb);break;case 12:if(Ca.a(jb.messageContent).keyCode===ca.a.ZF&&(jb=R.a6b("keydown","esc",ca.a.ZF,!0,!1,!1,!1,!1),this.Ov&&(this.Ov.dispatchEvent(jb),this.hide(),this.Nu)))this.Nu.onPaneClosed();break;case 13:this.Nu&&this.Nu.selectDataType(jb.messageContent);
break;case 14:this.Nu&&this.Nu.showHelpArticle(jb.messageContent);break;case 15:this.Nu&&this.Nu.showSurveyDialog(jb.messageContent);break;case 16:this.Nu&&(jb=Ca.a(jb.messageContent),this.Nu.insertTable(jb.DomainId,jb.DomainIdString))}window.g_badCastCallback=kb}}}IOh(){return Ca.c([2,1,3,5,8,6])}msc(kb){kb=Ca.c(kb);this.Ov.contentWindow.postMessage(kb,fb.a.Uaa(this.xub))}static a6b(kb,jb,Wb,wc,Jc,zc,gd,Va){yb.a.sw?(zc=String.format("{0} {1} {2}",zc?"Shift":"",gd?"Control":"",Va?"Alt":""),zc.trim(),
Wb=document.createEvent("KeyboardEvent"),Wb.initKeyboardEvent(kb,wc,Jc,window.self,jb,0,zc,!1,"en-US")):(jb={},jb.keyCode=Wb,jb.ctrlKey=gd,jb.shiftKey=zc,jb.altKey=Va,jb.bubbles=wc,jb.cancelable=Jc,Wb=new KeyboardEvent(kb,jb));return Wb}}R.oyf="about:blank";Object(c.a)(R,"EnrichmentPane",null,[639,2]);class wa extends R{constructor(kb){super(d.AFrameworkApplication.sa.wy,d.AFrameworkApplication.sa.Lt,d.AFrameworkApplication.sa.oea,d.AFrameworkApplication.sa.Le,d.AFrameworkApplication.rb);this.taskPane=
kb;this.taskPane.XNg(this.W4f)}get mna(){return this.taskPane.jc}zeb(){this.taskPane.isVisible||this.taskPane.Kg(!0)}jfc(){this.taskPane.Kg(!1)}dispose(){this.taskPane&&(this.taskPane.Skj(this.W4f),this.taskPane=null);super.dispose()}}Object(c.a)(wa,"EnrichmentTaskPaneWrapper",R,[]);class na{constructor(kb){this.Hy=null;this.lfa=kb}Yyi(kb,jb){this.Hy=kb;this.lfa&&this.lfa.show(this,jb,null)}bEc(kb,jb){this.lfa&&this.lfa.bEc(kb,jb)}ezb(){this.lfa&&this.lfa.hide()}dispose(){this.lfa&&(this.lfa.dispose(),
this.lfa=null)}selectEntity(kb){return this.Hy?this.Hy.selectEntity(kb):!1}searchEntity(kb,jb){this.Hy&&this.Hy.searchEntity(kb,jb)}PPd(kb,jb,Wb,wc){this.Hy&&this.Hy.PPd(kb,jb,Wb,wc)}QEb(kb){return this.Hy?this.Hy.QEb(kb):!1}onPaneClosed(){if(this.Hy)this.Hy.onPaneClosed()}cancelSearch(){this.Hy&&this.Hy.cancelSearch()}selectDataType(kb){this.Hy&&this.Hy.selectDataType(kb)}showHelpArticle(kb){this.Hy&&this.Hy.showHelpArticle(kb)}showSurveyDialog(kb){this.Hy&&this.Hy.showSurveyDialog(kb)}insertTable(kb,
jb){this.Hy&&this.Hy.insertTable(kb,jb)}}Object(c.a)(na,"EnrichmentManager",null,[638,2]);class Ba extends na{constructor(kb){super(kb)}dispose(){super.dispose()}}Object(c.a)(Ba,"ExcelEnrichmentManager",na,[]);var Ra=a(13);class qa{constructor(kb){this.campaignId=this.commentQuestion=null;this.isZeroBased=!1;this.ratingValuesAscending=this.ratingQuestion=this.aditionalDataRequested=null;this.showPrompt=this.showEmailRequest=!1;this.surveyType=0;this.title=null;this.campaignId=kb;this.commentQuestion=
Ra.a.instance.ob(199);this.isZeroBased=!1;this.aditionalDataRequested=["EmailAddress"];this.ratingQuestion=Ra.a.instance.ob(195);this.ratingValuesAscending=[Ra.a.instance.ob(196),Ra.a.instance.ob(197),Ra.a.instance.ob(198)];this.showPrompt=!1;this.showEmailRequest=!0;this.surveyType=4;this.title=Ra.a.instance.ob(194)}}Object(c.a)(qa,"FloodgateSurvey",null,[]);var La=a(24),Yb=a(68),mc=a(424),Zb=a(41),qb=a(376),Ha=a(193),Ya=a(33),Gb=a(94),Ja=a(29),Na=a(282),Qa=a(21);class Oa{constructor(){this.market=
this.appCorrelationId=this.sessionId=this.anid=this.applicationVersion=this.applicationName=null;this.featuresBitMask=this.themeId=0;this.disambiguationJson=this.uiLanguage=null}}Object(c.a)(Oa,"EnrichmentMessageContentAppProperties",null,[]);class bb{constructor(kb,jb,Wb,wc,Jc){this.Ota=this.zMe=!1;this.qdb=this.Pwa=!0;this.jHb=this.gNb=!1;this.Keb=null;this.prc=0;this.jR=()=>{(this.qdb||this.Ota)&&2!==this.prc&&(this.jHb||this.Bvd(!1))};this.Rc=()=>{b.ULS.sendTraceTag(537166944,0,15,"Session ID changed while ambiguous linked entities are present")};
this.FQi=zc=>{Ja.a.Wf(zc.Errors)?(zc=Ja.a.nc(zc.Errors),zc.includes("OperationSucceededWithAlert")?b.ULS.sendTraceTag(537166942,0,50,"Convert to Linked Entity failed with an alert"):b.ULS.sendTraceTag(36975687,0,10,`Failed to Convert to Linked Entity. errors: ${zc}`)):zc.Result&&(this.$.ea.ik(this.Rc),this.$.ea.Jj(this.Rc),zc=zc.Result,this.Keb=zc.SkydanceFeatureBitmask,this.Szd(zc),this.gNb=!0)};this.Xg=()=>{(this.qdb||this.Ota)&&this.Bvd(!1)};this.qpc=(zc,gd)=>{Ja.a.Wf(zc.Errors)?b.ULS.sendTraceTag(36975688,
0,10,`Failed to retrieve disambiguation data for Ambiguous Linked Entity. errors: ${Ja.a.nc(zc.Errors)}`):zc.Result&&(zc=zc.Result,zc.DisambiguationJson?(this.gNb=!1,this.V5f(gd),this.Keb=zc.SkydanceFeatureBitmask,gd=zc.DisambiguationJson,b.ULS.sendTraceTag(537166940,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Calling LaunchOrUpdateDisambiguationPane"),this.jHb=!1,this.Ypf(gd)):b.ULS.sendTraceTag(537166941,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Json is null"))};
this.oTi=(zc,gd)=>{Ja.a.Wf(zc.Errors)?(gd=Ja.a.nc(zc.Errors),b.ULS.sendTraceTag(36975689,0,10,`Failed to retrieve disambiguation data for search. errors: ${gd}`)):zc.Result&&(zc=zc.Result,zc.DisambiguationJson?(this.V5f(gd),this.Keb=zc.SkydanceFeatureBitmask,gd=zc.DisambiguationJson,b.ULS.sendTraceTag(537166938,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Calling LaunchOrUpdateDisambiguationPane"),this.jHb=!0,this.Ypf(gd)):b.ULS.sendTraceTag(537166939,0,
10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Json is null"))};this.UWi=zc=>{Ja.a.Wf(zc.Errors)?(zc=Ja.a.nc(zc.Errors),b.ULS.sendTraceTag(36975690,0,10,`Failed to move to the next ambiguous Linked Entity. errors: ${zc}`),this.qdb=!0):zc.Result&&(zc=zc.Result,this.Keb=zc.SkydanceFeatureBitmask,this.Szd(zc),this.gNb=!0)};this.OZi=zc=>{if(Ja.a.Wf(zc.Errors)){const gd=Ja.a.nc(zc.Errors);b.ULS.sendTraceTag(36975691,0,10,`Failed to select Linked Entity for Disambiguation.. errors: ${gd}`)}zc.Result?
(this.Szd(zc.Result),this.gNb=!0):this.Ssa()};this.cIf=zc=>{Ja.a.Wf(zc.Errors)?(zc=Ja.a.nc(zc.Errors),b.ULS.sendTraceTag(36975692,0,15,`Failed to retrieve data for searching in Disambiguation Pane.  Error id names: ${zc}`)):zc.Result?this.m9b.bEc(zc.Result,null):(b.ULS.sendTraceTag(537166927,0,50,"ConvertToLinkedEntityDisambiguationPane:OnSearchLinkedEntitySucceeded: Calling CloseDisambiguationPane"),this.Ssa())};this.BVi=zc=>{Ja.a.Wf(zc.Errors)?(zc=Ja.a.nc(zc.Errors),b.ULS.sendTraceTag(537166926,
0,15,`Failed to insert starter data table. Error id names: ${zc}`)):this.Ssa()};this.$=kb;this.gridView=Qa.h(this.$);this.gridView.ha.rT(this.Xg);this.gridView.Uu(this.jR);this.wQe=wc;this.convertToLinkedEntityManager=Jc;Ya.a.Ad(this.$)||Wb.GQ(jb);kb=new wa(jb);this.m9b=new Ba(kb);t.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(zc=>{zc.isFeatureEnabled("mso_sendASmile",!0).then(gd=>{this.Pwa=gd;return null})})}dispose(){this.$&&(this.gridView.ha.AR(this.Xg),
this.gridView.my(this.jR))}selectEntity(kb){const jb=Zb.o(this.gridView.ha.qa.activeCell,this.$),Wb=()=>new mc.a;qb.a(this.$.userOperationManager,(wc,Jc,zc)=>N(this.$.oa.xa,jb,kb,Na.b(wc,this.OZi),Jc,zc,null),wc=>new Ha.a(109,0,wc,void 0,Wb),null);return!0}searchEntity(kb,jb,Wb=!1,wc=0,Jc=null){b.ULS.sendTraceTag(38846755,0,50,`ConvertToLinkedEntityManager:SearchEntity() - Search attempted with TelemetryJSON: ${jb}`);const zc=Zb.o(this.gridView.ha.qa.activeCell,this.$);qb.a(this.$.userOperationManager,
(gd,Va,Eb)=>M(this.$.oa.xa,zc,kb,this.Pwa,Wb,wc,Jc,Na.b(gd,this.cIf),Va,Eb,null),gd=>new Ha.a(110,0,gd,16),null)}QEb(kb){const jb=Zb.o(this.gridView.ha.qa.activeCell,this.$);this.qdb=!1;qb.a(this.$.userOperationManager,(Wb,wc,Jc)=>aa(this.$.oa.xa,jb,kb,Na.b(Wb,this.UWi),wc,Jc,null),Wb=>new Ha.a(111,0,Wb,16),null);return!0}onPaneClosed(){this.Ota=!1;this.zMe=!0;this.prc=0;this.jHb=!1}cancelSearch(){const kb=this.fQd();kb&&qb.a(this.$.userOperationManager,(jb,Wb,wc)=>V(this.$.oa.xa,kb,Na.b(jb,this.cIf),
Wb,wc,null),jb=>new Ha.a(112,0,jb,16),null)}selectDataType(kb){b.ULS.sendTraceTag(537166977,0,50,"ConvertToLinkedEntityDisambiguationPane:SelectDataType: Calling CloseDisambiguationPane");this.Ssa();if(kb&&kb.length)if(kb=JSON.parse(kb))if(null==kb.domainId)b.ULS.sendTraceTag(537166946,0,10,"Data Selector Pane invoked SelectDataType without passing a DomainId");else{var jb={};jb.Id=kb.domainId;jb.StringId=kb.stringId;this.convertToLinkedEntityManager.convertToLinkedEntity(jb)}else b.ULS.sendTraceTag(537166947,
0,10,"Failed to parse the dataTypeJson from the Data Type Selector Pane");else b.ULS.sendTraceTag(537166976,0,10,"Recevied an empty dataTypeJson payload from the Data Type Selector Pane")}showHelpArticle(kb){const jb=new Gb.a(-859308420,Yb.a.zb,this.$.xc,9,null);this.$.Ia.Hb(jb,{[Yb.a.Pf]:"HelpID="+kb,["InputMethod"]:Yb.a.zb,["ShouldCanvasTakeFocus"]:!0,[Yb.a.Kc]:w.a.WU})}showSurveyDialog(kb){y.a.HNb(new qa(kb))}insertTable(kb,jb){const Wb=this.fQd();Wb&&qb.a(this.$.userOperationManager,(wc,Jc,zc)=>
L(this.$.oa.xa,Wb,kb,jb,Na.b(wc,this.BVi),Jc,zc,null),wc=>new Ha.a(259,0,wc,1),null)}Bvd(kb){this.launchOrCloseDisambiguationPane(kb)}launchDisambiguationPaneForSearch(){b.ULS.sendTraceTag(36975685,0,50,"ConvertToLinkedEntityManager:LaunchDisambiguationPaneForSearch() - Launch Disambiguation Pane For Search attempted");const kb=this.Puj();kb&&qb.a(this.$.userOperationManager,(jb,Wb,wc)=>E(this.$.oa.xa,kb,!0,this.Pwa,!1,null,Na.b(jb,this.oTi),Wb,wc,1),jb=>new Ha.a(114,0,jb,16),null)}launchLinkedEntityDataTypeSelectorPane(kb,
jb){qb.a(this.$.userOperationManager,(Wb,wc,Jc)=>P(this.$.oa.xa,kb,jb,Na.b(Wb,this.qpc),wc,Jc,2),Wb=>new Ha.a(233,0,Wb,16),null)}Syi(kb,jb){kb&&qb.a(this.$.userOperationManager,(Wb,wc,Jc)=>E(this.$.oa.xa,kb,!1,!1,!0,jb,Na.b(Wb,this.qpc),wc,Jc,2),Wb=>new Ha.a(257,0,Wb,16),null)}V5f(kb){kb&&(this.prc=kb)}Ypf(kb){var jb=new Gb.a(-90814711,Yb.a.zb,0,10,null);this.$.Ia.Hb(jb,null);this.Ota?this.m9b.bEc(kb,null):(jb=3,null!=this.Keb?jb=this.Keb:b.ULS.shipAssertTag(537166937,0,!1,"SkydanceFeatureBitmask was not set"),
(kb=this.wUh(kb,jb))||b.ULS.sendTraceTag(537166936,0,15,"LaunchOrUpdateDisambiguationPane: null appProperties"),this.wQe||b.ULS.sendTraceTag(537166935,0,15,"LaunchOrUpdateDisambiguationPane: null entitymanager"),this.m9b.Yyi(this.wQe,kb),this.Ota=!0)}Ssa(){this.Ota&&(b.ULS.sendTraceTag(537166934,0,100,"ConvertToLinkedEntityDisambiguationPane:CloseDisambiguationPane"),this.m9b.ezb(),this.Ota=!1,this.prc=0,this.jHb=!1)}Szd(kb){var jb=kb.Row+1;kb=kb.Column+1;0>jb||0>kb?(b.ULS.sendTraceTag(537166933,
0,50,"ConvertToLinkedEntityDisambiguationPane:MoveToAmbiguousLinkedEntity: Calling CloseDisambiguationPane"),this.Ssa(),this.$.ea.ik(this.Rc)):(jb=new La.Range(jb,kb,jb,kb,!0,!1),this.gridView.ha.updateSelection(jb,jb,60),this.qdb=!0)}wUh(kb,jb){const Wb=new Oa;Wb.applicationVersion=d.AFrameworkApplication.buildVersion;Wb.applicationName="ExcelWac";Wb.anid="00000000-0000-0000-0000-000000000000";Wb.sessionId=d.AFrameworkApplication.userSessionId;Wb.appCorrelationId=v.a.create().toString();var wc=C.a.NJ(d.AFrameworkApplication.lcid);
wc=wc?wc.name:null;Wb.uiLanguage=wc;Wb.market=this.bcc(wc);Wb.themeId=0;Wb.disambiguationJson=kb;jb<=x.a.sS?Wb.featuresBitMask=jb:b.ULS.sendTraceTag(537166932,0,10,"SkydanceFeaturesBitmask is too large for EnrichmentMessageContentAppProperties");return Wb}bcc(kb){kb=kb.split("-");return kb[kb.length-1]}launchOrCloseDisambiguationPane(kb){const jb=this.gridView.ha.qa.activeCell;if(this.fQd()&&jb)if(this.gridView.tb.iAb(jb)){if((!this.zMe||kb||this.gNb)&&!this.gridView.fb){kb&&(this.qdb=!0);var Wb=
Zb.q(jb,this.$);qb.a(this.$.userOperationManager,(wc,Jc,zc)=>E(this.$.oa.xa,Wb,!1,this.Pwa,!1,null,Na.b(wc,this.qpc),Jc,zc,1),wc=>new Ha.a(114,0,wc,16),null)}}else this.Ssa();else this.Ssa()}Uej(){if(this.Ota){var kb=this.gridView.ha.qa.activeCell;if(kb){var jb=Zb.q(kb,this.$);qb.a(this.$.userOperationManager,(Wb,wc,Jc)=>E(this.$.oa.xa,jb,!1,this.Pwa,!1,null,Na.b(Wb,this.qpc),wc,Jc,1),Wb=>new Ha.a(114,0,Wb,16),null)}else this.Ssa()}}fQd(){const kb=this.gridView.ha.qa;return kb.Hba()?Zb.o(kb.activeCell,
this.$):null}Puj(){const kb=this.gridView.ha.qa;return kb.Hba()?Zb.q(kb.activeCell,this.$):null}}Object(c.a)(bb,"ConvertToLinkedEntityDisambiguationPane",null,[2]);var Ga=a(7),tb=a(379),wb=a(1344),lb=a(51),db=a(727);class Pa{constructor(kb,jb,Wb){this.vqf=2;this.uqf="Size64by48";this.$=kb;this.Va=jb;this.convertToLinkedEntityManager=Wb}BMh(kb,jb){var {ConvertToLinkedEntityManager:Wb}=a(772);this.o0j();jb=this.Va.uq(jb).oE();let wc=0,Jc=0,zc=!1;for(var gd of kb.Categories){const Va=this.fNh(gd,wc);
Va&&(Jc===Wb.W8a&&(zc=!0),jb.MenuSectionList.push(Va),++wc);++Jc}zc&&wc<=Wb.wqf&&jb.MenuSectionList.splice(Wb.W8a,1);Wb=this.Va.Ec().v2b();gd=lb.a.qe(11);for(const Va of kb.LongButtons)this.convertToLinkedEntityManager.fHj(Va)&&this.xKg(Wb,Va,gd);0<Wb.ControlList.length&&jb.MenuSectionList.push(Wb);return jb}xKg(kb,jb,Wb){if(jb){var wc="Data.ConvertToLinkedEntityMenuItem_"+jb.Name,Jc=this.convertToLinkedEntityManager.nU(jb.DomainId);Jc&&(jb=Object(Ga.a)(new tb.a,{Id:wc,ExternalId:wc,Command:"-1662108744",
LabelText:jb.Name,Alt:jb.SuperTip,Visible:!0,MenuItemId:a(772).ConvertToLinkedEntityManager.e2a(jb.DomainId),Image16by16:Wb,Image16by16Class:this.yei(Jc.FontLocator)}),kb.ControlList.push(jb))}}aNh(kb,jb){return Object(Ga.a)(new wb.a,{Id:a(772).ConvertToLinkedEntityManager.rOe+kb.toString(),ExternalId:a(772).ConvertToLinkedEntityManager.rOe+kb.toString(),MenuItemId:a(772).ConvertToLinkedEntityManager.z9c+kb.toString(),Command:"-1203788282",QueryCommand:"QueryLinkedEntityGalleryButtons",Icon:this.sdf(jb.FontLocator),
LabelText:jb.Name,PreviewIconStyle:{["root"]:{["width"]:24,["min-width"]:24,["height"]:24}},Alt:this.Yfd(jb)})}TUg(kb){switch(kb){case "Animal":return db.a.kRg;case "Apple":return db.a.oSg;case "Atom":return db.a.NTg;case "Beaker":return db.a.JVg;case "Bridge":return db.a.hXg;case "Cat":return db.a.j2g;case "City":return db.a.x4g;case "Constellation":return db.a.o9g;case "Dog":return db.a.oph;case "Finance":return db.a.BVg;case "GradCap":return db.a.Z7h;case "HumanAnatomy":return db.a.Pdi;case "LocationPointer":return db.a.xBi;
case "Map":return db.a.t2i;case "MedicineNeedle":return db.a.dIi;case "Mountain":return db.a.tJi;case "Movie":return db.a.MJi;case "Music":return db.a.ZJi;case "OuterSpace":return db.a.X2i;case "Planet":return db.a.a6i;case "Satellite":return db.a.jsj;case "WolframGeneric":return db.a.drj;default:return db.a.aah}}yei(kb){if("PowerBIRibbon"!==kb)return z.a.Vad;switch(kb){case "AnimalRibbon":return z.a.eAh;case "AppleRibbon":return z.a.fAh;case "AtomRibbon":return z.a.gAh;case "BeakerRibbon":return z.a.hAh;
case "BridgeRibbon":return z.a.iAh;case "CenterMapRibbon":return z.a.jAh;case "CityRibbon":return z.a.kAh;case "CurrencyRibbon":return z.a.lAh;case "ExerciseRibbon":return z.a.mAh;case "FinanceRibbon":return z.a.QUe;case "FirstAidRibbon":return z.a.nAh;case "GlobeLightningRibbon":return z.a.oAh;case "GradCapRibbon":return z.a.pAh;case "HumanAnatomyRibbon":return z.a.qAh;case "LeafRibbon":return z.a.rAh;case "LocationPointerRibbon":return z.a.tAh;case "MapRibbon":return z.a.OUe;case "MountainRibbon":return z.a.uAh;
case "MovieRibbon":return z.a.vAh;case "MusicRibbon":return z.a.wAh;case "NotablePeopleRibbon":return z.a.xAh;case "OuterSpaceRibbon":return z.a.yAh;case "PartlySunnyWeatherRibbon":return z.a.zAh;case "PowerBIRibbon":return z.a.PUe;case "SatelliteRibbon":return z.a.AAh;case "WolframGenericRibbon":return z.a.sAh;case "YogaRibbon":return z.a.CAh;default:return z.a.NUe}}sdf(kb){switch(kb){case "AnimalRibbon":return"AnimalExcelDataTypes_24";case "AppleRibbon":return"AppleExcelDataTypes_24";case "AtomRibbon":return"AtomExcelDataTypes_24";
case "BeakerRibbon":return"BeakerExcelDataTypes_24";case "BridgeRibbon":return"BridgeExcelDataTypes_24";case "CenterMapRibbon":return"CenterMapExcelDataTypes_24";case "CityRibbon":return"CityExcelDataTypes_24";case "CurrencyRibbon":return"CurrencyExcelDataTypes_24";case "ExerciseRibbon":return"ExerciseExcelDataTypes_24";case "FinanceRibbon":return"Bank_32";case "FirstAidRibbon":return"FirstAidExcelDataTypes_24";case "GlobeLightningRibbon":return"GlobeLightning_24";case "GradCapRibbon":return"GradCapExcelDataTypes_24";
case "HumanAnatomyRibbon":return"HumanAnatomyExcelDataTypes_24";case "LeafRibbon":return"LeafExcelDataTypes_24";case "LocationPointerRibbon":return"LocationPointerExcelDataTypes_24";case "MapRibbon":return"OpenMap_24";case "MountainRibbon":return"MountainExcelDataTypes_24";case "MovieRibbon":return"MovieExcelDataTypes_24";case "MusicRibbon":return"MusicExcelDataTypes_24";case "NotablePeopleRibbon":return"NotablePeopleExcelDataTypes_24";case "OuterSpaceRibbon":return"OuterSpaceExcelDataTypes_24";case "PartlySunnyWeatherRibbon":return"PartlySunnyWeatherExcelDataTypes_24";
case "PowerBIRibbon":return"DataProtectionExcelDataTypes_24";case "SatelliteRibbon":return"SatelliteExcelDataTypes_24";case "WolframGenericRibbon":return"Lightning_24";case "YogaRibbon":return"YogaExcelDataTypes_24";default:return"ConvertToEntity_20"}}fNh(kb,jb){jb=this.Va.zC("ConvertToLinkedEntitySection_"+jb,this.vqf,this.uqf);var Wb=!1;for(var wc of kb.DomainIds){const Jc=this.convertToLinkedEntityManager.nU(wc);if(!Jc||Jc.DomainBlocked||!Jc.ShowInRibbon)continue;Wb=Jc.Name;const zc=a(772).ConvertToLinkedEntityManager.e2a(wc);
jb.Zt("Data.ConvertToLinkedEntityMenuItem_"+zc,-1203788282,"QueryLinkedEntityGalleryIcon",void 0,zc,this.sdf(Jc.FontLocator),void 0,void 0,this.Yfd(Jc),Wb);Wb=!0}if(!Wb)return null;wc=jb.s2b(!0);jb=this.Va.Ec();jb.title=kb.Name;kb=jb.v2b();kb.ControlList.push(wc);return kb}o0j(){this.vqf=5;this.uqf="Size112by64"}Yfd(kb){return kb.RibbonTooltipHeader?kb.RibbonTooltipHeader+"\n\n"+kb.RibbonTooltip:kb.RibbonTooltip}}Object(c.a)(Pa,"ConvertToLinkedEntityMenuRenderer",null,[606]);var ja=a(59),Ka=a(284),
ub=a(113),Kb=a(1),W=a(145),za=a(70);class Sa{constructor(kb,jb){this.Ald=this.Cld=!1;this.vYi=Wb=>{b.ULS.sendTraceTag(537166680,0,50,"OnReadRoamingStringSuccess called.");this.Cld=!0;if(Ja.a.Wf(Wb.Errors))b.ULS.sendTraceTag(537166679,0,10,`OnReadRoamingStringSuccess encountered an error. Errors: ${Ja.a.nc(Wb.Errors)}`);else{var wc=0,Jc=[],zc=!1;try{if(!Wb.Result)return;const gd=Wb.Result;if(!gd){b.ULS.sendTraceTag(537166678,0,50,"OnReadRoamingStringSuccess - Received an empty roamingXml.");return}Jc=
this.o4i(gd);if(!Jc||!Jc.length)return;wc=Jc.length;this.tIi(Jc);this.lAa.lZf();b.ULS.sendTraceTag(537166677,0,50,`OnReadRoamingStringSuccess MruCount:${this.lAa.Sbb.length}`);if(Kb.EwaSettings.isChangeGateEnabled("OfficeVSO:5199912_LinkedEntityMruWolfram")){for(const Va of this.lAa.Sbb)if(1===(Va.Id&1048320)>>8){zc=!0;break}b.ULS.sendTraceTag(537166676,0,50,`OnReadRoamingStringSuccess MruWolframAvailable:${zc}`)}}finally{b.ULS.sendTraceTag(537166675,0,50,`ParseRecentlyUsedLinkedDataTypes returned ${wc} data types.`),
Wb=[],Wb.push(Object(Ga.a)(new za.a,{name:"MruCount",int64:wc})),Wb.push(Object(Ga.a)(new za.a,{name:"MruWolframAvailable",bool:zc})),W.a("ReadRecentlyUsedLinkedDataTypes",void 0,void 0,Wb)}this.Ald&&(this.$ng(this.lAa.Sbb),this.Ald=!1)}};this.R1i=Wb=>{b.ULS.sendTraceTag(537166674,0,50,"OnWriteRoamingStringSuccess called.");Ja.a.Wf(Wb.Errors)?b.ULS.sendTraceTag(537166673,0,10,`OnWriteRoamingStringSuccess encountered an error. Errors: ${Ja.a.nc(Wb.Errors)}`):Wb.Result&&(Wb.Result||b.ULS.sendTraceTag(537166672,
0,15,"OnWriteRoamingStringSuccess - Failed to write to the roaming service."))};this.HHf=(Wb,wc,Jc)=>{Wb=ub.a.Pe(Wb.data);b.ULS.sendTraceTag(537166671,0,10,`OnRoamingOperationFailure: Encountered errors for ${Jc}. Errors: ${Ja.a.nc(Wb)}.`)};this.$=kb;this.lAa=jb}x1h(){!this.Cld&&this.$.ea.Xb&&(b.ULS.sendTraceTag(537166691,0,50,"GetRecentlyUsedLinkedDataTypesFromRoamingService - Invoking the GetRecentlyUsedDataTypes operation."),Ka.w(this.$.oa.xa,0,this.vYi,this.HHf,null,null))}$ng(kb){kb&&kb.length?
this.Cld?(kb=this.xwj(kb))?(b.ULS.sendTraceTag(537166688,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Invoking the WriteRecentlyUsedDataTypes operation."),Ka.C(this.$.oa.xa,0,kb,this.R1i,this.HHf,null,null)):b.ULS.sendTraceTag(537166689,0,15,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Created an empty serialized string."):this.Ald=!0:b.ULS.sendTraceTag(537166690,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Tried writing an empty list of data types.")}xwj(kb){if(!kb||
!kb.length)return b.ULS.sendTraceTag(537166687,0,15,"SerializeRecentlyUsedLinkedDataTypes - Received an empty list of data types."),null;var jb=[];for(const Wb of kb)kb={},kb.Id=Wb.Id,Wb.StringId&&(kb.StringId=Wb.StringId),jb.push(kb);jb="<DataTypes>"+ja.a.Dc(jb)+"</DataTypes>";return 1906<jb.length?(b.ULS.sendTraceTag(537166686,0,15,"SerializeRecentlyUsedLinkedDataTypes - Exceeded the MaxSize for ridExcelRecentlyUsedLinkedDataTypes."),null):jb}o4i(kb){if(!kb)return b.ULS.sendTraceTag(537166685,0,
15,"ParseRecentlyUsedLinkedDataTypes - Received an empty roamingXml."),null;if(!kb.startsWith("<DataTypes>")||!kb.endsWith("</DataTypes>"))return b.ULS.sendTraceTag(537166684,0,15,"ParseRecentlyUsedLinkedDataTypes - Received a string without a prefix/postfix."),null;kb=kb.substring(11,kb.length-12);if(!kb)return b.ULS.sendTraceTag(537166683,0,15,"ParseRecentlyUsedLinkedDataTypes - Created an empty substring."),null;let jb=[];try{jb=ja.a.Xh(kb)}catch(Wb){return b.ULS.sendTraceTag(537166682,0,10,`ParseRecentlyUsedLinkedDataTypes - Encountered an exception. Message: ${Wb.message}`),
null}b.ULS.sendTraceTag(537166681,0,50,`ParseRecentlyUsedLinkedDataTypes returned ${jb.length} data types.`);return jb}tIi(kb){const jb=this.lAa.Sbb,Wb=this.lAa.Tdj;if(jb.length!==Wb){for(let wc=0;wc<kb.length&&jb.length<Wb;++wc){const Jc=kb[wc];this.lAa.nU(Jc)&&!jb.includes(Jc)&&jb.push(Jc)}this.lAa.Sbb=jb}}}Object(c.a)(Sa,"LinkedDataTypeRoamingHandler",null,[]);var Wa=a(56),ab=a(50),ma=a(180),ha=a(37),eb=a(48),ta=a(28),ya=a(249),sb=a(22),Qb=a(100);a.d(F,"ConvertToLinkedEntityManager",function(){return oc});
class oc extends n.a{constructor(kb,jb,Wb,wc,Jc,zc,gd){super();this.Jmf=this.ntd=this.lud=this.esd=this.dsd=this.B7a=this.hpd=null;this.sFb=this.cld=0;this.qla=null;this.rpd=!1;this.ied=this.Mn=this.QOd=null;this.hs=0;this.oY=null;this.mLa=8;this.Z0c=this.tqf=this.Gif=this.hab=!1;this.dza=this.V_e=this.KXe=null;this.c_c=0;this.fVg=5;this.M1b=3E4;this.fgg=!1;this.w2=null;this.bua=Array(5);this.Lig=this.Q_d=!1;this.B_f=this.bwd=0;this.htmlSanitizationHelper=this.gee=null;this.Y$f=!0;this.Rc=(Va,Eb)=>
{Eb.Xb&&!Eb.ZBb&&this.showUntrustedImageBusinessBarIfNecessary()};this.pUi=Va=>{if(Va.Result){var Eb=Va.Result;if(Eb&&Eb.length){b.ULS.sendTraceTag(537166922,0,50,`OnGetRichDataClassificationLabelsSuccess: Received ${Eb.length} labels`);var hc=ab.GetServiceTaskFactory.Oa(this.$.da,274,275,0);ha.TaskExtensions.za(hc,()=>{hc.result.TZc(Eb,2)||b.ULS.sendTraceTag(537166921,0,10,"OnGetRichDataClassificationLabelsSuccess - Failed to apply the policy label.")},this.$.la,3)}}else b.ULS.sendTraceTag(537166923,
0,50,"OnGetRichDataClassificationLabelsSuccess: Received no result")};this.tf=()=>{this.uWj();this.e$h(this.$.ea.Qn.LinkedEntityAsyncRefreshStateId);this.K7a?this.jai(this.$.ea.Qn.RichDataClassificationLabelStateId):this.S6a&&this.c_d(!0)};this.LRi=()=>{this.Q_d=!0;this.Mn&&this.Mn.Uej()};this.HTi=Va=>{if(Va&&!ya.a(Va))try{Va.Result.HasUntrustedImageUrl&&(this.businessBar.ih(59,null),this.Lig=!0)}catch(Eb){b.ULS.sendTraceTag(574718945,0,10,`ConvertToLinkedEntityManager.OnGetHasUntrustedImageUrlsFromServerSuccess: GetHasUntrustedImageUrls encountered exception ${Eb}.`)}};
this.Vpf=()=>{if(!this.tqf&&this.zAb()&&!this.fqd())if(W.a("DataTabActive"),Wa.a.pg.OQ)if(document.querySelector("#ConvertToLinkedEntityGallery-previewExpandButton")){var Va=this.O5b();if(Va){var Eb={};Eb.InputMethod=Yb.a.zb;Eb.CalloutName=8;Eb.Target="[data-unique-id=Ribbon-ConvertToLinkedEntityGallery-previewExpandButton]";this.$.Ia.Hb(Va,Eb);this.tqf=!0}else b.ULS.sendTraceTag(537166880,0,10,"RibbonCommandInfo is null for LinkedEntityGalleryCallout")}else b.ULS.sendTraceTag(537166881,0,10,"Could not locate anchor for the LinkedEntityGalleryCallout");
else b.ULS.sendTraceTag(537166882,0,50,"ConvertToLinkedEntityManager:LaunchLinkedEntityGalleryCallout() - Attempted to launch linked entity gallery callout but callout not enabled")};this.GQi=Va=>{Ja.a.Wf(Va.Errors)||(this.K7a||this.c_d(!1),this.raiseEvent("LinkedEntityConverted"))};this.R_i=()=>{this.$.da.gb(211,Va=>{Va.readText(Ra.a.instance.ga(1812))})};this.dd=(Va,Eb)=>{b.ULS.sendTraceTag(537166867,0,50,"ConvertToLinkedEntityManager.OnWorkbookOpened called");Eb.nV?b.ULS.sendTraceTag(537166865,
0,15,"ConvertToLinkedEntityManager.OnWorkbookOpened called while rendering cached content"):(this.$.isEditMode?this.WBe():this.Joj(),this.Q_d&&this.zPe())};this.RTi=Va=>{this.X3b();if(Va.Result){var Eb=Va.Result;Va=Eb.DomainDataArray;if(this.qla=Eb.Ribbon){var hc={};hc.Name=Ra.a.instance.ga(1802);hc.DomainIds=this.lK;this.qla.Categories.splice(oc.W8a,0,hc)}0<Eb.MaximumCellsToConvert&&(this.gee=Eb.MaximumCellsToConvert);this.hs=2;Eb=!1;if(Va){b.ULS.sendTraceTag(39949271,0,50,`OnGetLinkedEntityServiceDomainsSuccess: Received ${Va.length} domains`);
this.MNa||(this.MNa=[]);hc=Ra.a.instance.ga(1799);const Ab=Ra.a.instance.ga(1801);for(const Bb of Va)Bb.DomainId?(this.MNa.push(Bb),Bb.DomainBlocked?(Va=!!Bb.DomainId.StringId,b.ULS.sendTraceTag(537166861,0,50,`Domain: ${Va?Bb.DomainId.Id.toString():Bb.Name} is telemetry only, do not show in menu (Has String ID: ${Va})`)):(this.mU.ia(oc.e2a(Bb.DomainId),Bb),Bb.Name===hc||268435456===Bb.DomainId.Id?this.KXe=Bb.DomainId.Id.toString():Bb.Name===Ab||536870912===Bb.DomainId.Id?this.V_e=Bb.DomainId.Id.toString():
268435712===Bb.DomainId.Id&&Bb.ShowInRibbon&&(this.Z0c=!0),Eb=!0)):b.ULS.sendTraceTag(537166862,0,10,"OnGetLinkedEntityServiceDomainsSuccess: DomainId is null.")}Eb||(this.MNa=null);this.zjg();this.QOd.x1h();this.fgg||(this.pWj(),this.fgg=!0)}else this.MNa=null,this.hs=3,-1<this.mLa&&window.setTimeout(()=>{this.gIb()},100*(8-this.mLa)),b.ULS.sendTraceTag(537166863,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received no result");this.tKd();this.gIe();this.Z0c&&this.Yjf&&ma.c(this.Vpf,this.$.la,500);
this.S6a&&!this.K7a&&this.c_d(!0)};this.QTi=Va=>{Va=ub.a.Pe(Va.data);b.ULS.sendTraceTag(34415007,0,15,`OnGetLinkedEntityServiceDomainsFailure [Errors: ${Ja.a.nc(Va)}].`);this.MNa=null;this.hs=3;this.hab=!0;this.tKd()};this.onContentReady=()=>{this.uhg()&&this.gridView.my(this.onContentReady);this.Y$f&&this.$.workbookContext.Options&1048576&&(this.businessBar.VKj(),this.Y$f=!1)};this.wj=()=>{this.X3b()};this.sWi=Va=>{if(ya.a(Va)){const Eb=ab.GetServiceTaskFactory.Oa(this.$.da,5,4,0);ha.TaskExtensions.za(Eb,
()=>{let Ab=null;if(null===Va||void 0===Va?0:Va.Errors)Ab=Va.Errors[0];Eb.result.C$f(Ab,null)},this.$.la,3);b.ULS.sendTraceTag(537166800,0,15,`ConvertToLinkedEntityManager.OnLinkedEntityTryAutoRefreshSuccessCore. LinkedEntityTryAutoRefresh returned with errors [Errors: ${Ja.a.nc(Va.Errors)}].`);const hc=Ja.a.Fz(Va.Errors,[-1100324317,-2133389873],"ConvertToLinkedEntityManager:OnLinkedEntityTryAutoRefreshSuccessCore");this.$.ea.Tn(hc)}};this.R0c=()=>{b.ULS.sendTraceTag(537166796,0,50,`ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck. Checking after a ${this.M1b} millisecond interval`);
this.fgf("Periodic auto-refresh check",this.VOi,this.UOi)};this.VOi=Va=>{ya.a(Va)?(b.ULS.sendTraceTag(537166795,0,15,`ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. LinkedEntityTryAutoRefresh returned with errors [Errors: ${Ja.a.nc(Va.Errors)}].`),++this.c_c):this.c_c=0;e.a.Ja(this.dza);this.c_c>=this.fVg?(b.ULS.sendTraceTag(537166794,0,10,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Failed too many consecutive times. Will stop trying to auto-refresh"),
this.dza=null):(b.ULS.sendTraceTag(537166793,0,50,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Re-creating periodicAutoRefreshCheckContext"),this.dza=eb.a.instance.create(this.R0c,this.M1b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck"))};this.UOi=Va=>{Va=ub.a.Pe(Va.data);f.a.lh(Va)?b.ULS.sendTraceTag(537166791,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed with an HTTP error"):b.ULS.sendTraceTag(537166792,0,15,`OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed [Errors: ${Ja.a.nc(Va)}].`);
e.a.Ja(this.dza);this.dza=eb.a.instance.create(this.R0c,this.M1b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")};this.sXi=Va=>{Va=!!Va.Result&&Va.Result;b.ULS.sendTraceTag(537166790,0,50,`OnNotifyFeatureLicensingStatusSuccess- operationSucceeded? = ${Va.toString()}`);Va?(b.ULS.sendTraceTag(537166789,0,50,`OnNotifyFeatureLicensingStatusSuccess- successful handshake duration = ${ta.a.Ya.ue.m-this.cld} ms, retry count = ${this.sFb}`),this.gIb()):this.OAc()};this.rXi=()=>{b.ULS.sendTraceTag(537166788,
0,15,"OnNotifyFeatureLicensingStatusFailed");this.OAc()};this.sTi=Va=>{Va.Result?(Va=Va.Result)?(this.FLd(),this.businessBar.C$f(null,Va)):b.ULS.sendTraceTag(537166725,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result"):b.ULS.sendTraceTag(537166726,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result")};this.$=kb;this.businessBar=zc;this.svgIconProvider=Wb;this.htmlSanitizationHelper=gd;this.MNa=[];this.lK=[];this.gridView=Qa.h(this.$);this.Gec=-1;this.Wqi=
Kb.EwaSettings.isChangeGateEnabled("OfficeVSO:4294127_LongButtonVisibleWhenAnyDomainOverrideShowsInRibbon");this.S6a=this.$.ra(387)&&this.$.ra(259);this.K7a=this.$.ra(586);this.Yjf=Kb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityGalleryTeachUIEnabled",!1);this.mU=new Qb.a;this.B9a=new Pa(kb,jb,this);wc&&(this.Mn=new bb(kb,wc,Jc,this,this));this.$.Lk(this.dd);m.a(this.$)&&m.a(this.$).Xxj(this);this.WBe();(this.S6a||this.K7a)&&this.$.ea.$t(this.tf);Kb.EwaSettings.ra(123)&&Kb.EwaSettings.ra(131)&&
(this.uhg()||this.gridView.Uu(this.onContentReady));this.$.dC(this.wj);this.$.ea.Jj(this.Rc);this.showUntrustedImageBusinessBarIfNecessary();this.QOd=new Sa(this.$,this)}dispose(){(this.S6a||this.K7a)&&this.$.ea.Av(this.tf);this.$.ea.ik(this.Rc);!this.w2&&Kb.EwaSettings.ra(123)&&Kb.EwaSettings.ra(131)&&this.gridView.my(this.onContentReady);this.Mn&&this.Mn.dispose();this.$.zF(this.wj);this.$.pl(this.dd);this.S6a&&(this.hpd=null);e.a.Ja(this.dza)}CNg(kb){this.addHandler("LinkedEntityConverted",kb)}Ckj(kb){this.removeHandler("LinkedEntityConverted",
kb)}get Tdj(){return 5}get Sbb(){return this.lK}set Sbb(kb){this.lK=kb}selectEntity(kb){return this.Mn?this.Mn.selectEntity(kb):!1}searchEntity(kb,jb){this.Mn&&this.Mn.searchEntity(kb,jb)}PPd(kb,jb,Wb,wc){this.Mn&&this.Mn.searchEntity(kb,jb,!0,Wb,wc)}QEb(kb){return this.Mn?this.Mn.QEb(kb):!1}onPaneClosed(){if(this.Mn)this.Mn.onPaneClosed()}cancelSearch(){this.Mn&&this.Mn.cancelSearch()}selectDataType(kb){this.Mn&&this.Mn.selectDataType(kb)}showHelpArticle(kb){this.Mn&&this.Mn.showHelpArticle(kb)}showSurveyDialog(kb){this.Mn&&
this.Mn.showSurveyDialog(kb)}insertTable(kb,jb){this.Mn&&this.Mn.insertTable(kb,jb)}jai(kb){this.$.isEditMode&&this.B_f!==kb&&d.AFrameworkApplication.fa.pa("SupportsPolicies")&&(this.B_f=kb,b.ULS.sendTraceTag(537166925,0,50,"HandleRichDataClassificationLabelStateIdChanged - Getting rich data classification labels"),H(this.$.oa.xa,this.pUi,null,null,null))}zPe(){this.$.userOperationManager.Jc(new Ha.a(589,0,(kb,jb,Wb)=>Z(this.$.oa.xa,Na.b(kb,this.LRi),jb,Wb,null),80),null)}showUntrustedImageBusinessBarIfNecessary(){this.Q_d||
this.Lig||!this.$.ea.Xb||this.Cvj()}Cvj(){this.$.userOperationManager.Jc(new Ha.a(588,0,(kb,jb,Wb)=>Y(this.$.oa.xa,Na.b(kb,this.HTi),jb,Wb,null),80),null)}c_d(kb){if(this.S6a&&null==this.hpd&&!this.K7a&&d.AFrameworkApplication.fa.pa("SupportsPolicies")&&null!=this.B7a&&this.B7a&&(!kb||this.$.workbookContext.Options&262144)){var jb=ab.GetServiceTaskFactory.Oa(this.$.da,274,275,0);ha.TaskExtensions.za(jb,()=>{this.hpd=jb.result.STf(2)},this.$.la,3)}}get tEb(){return this.bua.length}get ZHi(){return this.gee}bah(kb){(kb=
this.sph(kb))?this.convertToLinkedEntity(kb):b.ULS.sendTraceTag(537166920,0,10,"Could not convert key into domain ID")}convertToLinkedEntity(kb){b.ULS.sendTraceTag(34415004,0,50,`ConvertToLinkedEntityManager:ConvertToLinkedEntity() - conversion attempted  [ServiceEndpoint: ${kb.Id}].`);if(this.gridView){var jb=this.gridView.ha.qa.ld,Wb=jb.we(this.gridView.jQ);this.rpd&&this.jLg(kb);if(Wb){Wb=this.gridView.tb.cxa(Wb);if(!this.Laf(kb)&&this.glf(kb.Id)){b.ULS.sendTraceTag(537166918,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert to organization data type without curated data");
if(Wa.a.pg.OQ){jb=this.qfd();if(!jb){b.ULS.sendTraceTag(537166917,0,50,"CalloutAnchorElement is null for blankCellConvert");return}Wb=this.O5b();if(!Wb){b.ULS.sendTraceTag(537166916,0,50,"RibbonCommandInfo is null for blankCellConvert");return}var wc={["InputMethod"]:Yb.a.zb,CalloutName:3};wc.Target=jb;wc.RibbonButtonLabel=Kb.EwaSettings.isChangeGateEnabled("OfficeVSO:4244626_BlankCellCalloutRibbonButtonLabel")?this.o_f(kb):this.MCb(kb.Id.toString());wc.ExampleEntities=this.LVe(kb);this.$.Ia.Hb(Wb,
wc);return}b.ULS.sendTraceTag(537166915,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert to organization data without curated data, teaching callout not enabled")}if(this.glf(kb.Id)&&!kb.StringId)this.launchLinkedEntityDataTypeSelectorPane(oc.e2a(kb));else{if(Wb){b.ULS.sendTraceTag(537166914,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert an empty range");if(Kb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LaunchStarterDataForBlankCell",
!1)&&this.bQj(kb)){jb=Zb.r(this.gridView.ha.qa.selectedRanges,this.$);this.Mn.Syi(jb,kb);return}if(Wa.a.pg.OQ){jb=this.qfd();if(!jb){b.ULS.sendTraceTag(537166913,0,50,"CalloutAnchorElement is null for blankCellConvert");return}Wb=this.O5b();if(!Wb){b.ULS.sendTraceTag(537166912,0,50,"RibbonCommandInfo is null for blankCellConvert");return}wc={["InputMethod"]:Yb.a.zb,CalloutName:2};wc.Target=jb;wc.RibbonButtonLabel=this.o_f(kb);wc.ExampleEntities=this.LVe(kb);wc.BlankCellResourceId=this.iWg(kb);wc.HasBlankCellWalkthrough=
this.Zai(kb);wc.ServiceDomain=kb.Id;this.$.Ia.Hb(Wb,wc);return}b.ULS.sendTraceTag(537166883,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert a blank range, teaching callout not enabled")}this.Q4c(kb,!1,jb)}}}else b.ULS.shipAssertTag(537166919,0,!1,"grid view should not be null")}convertToLinkedEntityFromAutoDetect(){this.w2&&this.w2.XHa()}onAutoDetectUIShown(){qb.a(this.$.userOperationManager,(kb,jb,Wb)=>U(this.$.oa.xa,kb,jb,Wb,null),kb=>new Ha.a(230,0,kb,80),null)}Q4c(kb,
jb,Wb){const wc=Zb.q(Wb,this.$),Jc=()=>new mc.a;qb.a(this.$.userOperationManager,(zc,gd,Va)=>I(this.$.oa.xa,wc,kb,jb,Na.b(zc,this.GQi,this.R_i,this.Mn.FQi),gd,Va,null),zc=>new Ha.a(115,0,zc,void 0,Jc),null)}jLg(kb){if(this.rpd){var jb={};jb.Id=kb.Id;kb.StringId&&(jb.StringId=kb.StringId);if(!(0<this.lK.length&&this.lK[0].Id===jb.Id&&this.lK[0].StringId===jb.StringId)){kb=!1;this.lK.splice(0,0,jb);for(let Wb=1;Wb<this.lK.length;++Wb)if(this.lK[Wb].Id===jb.Id&&this.lK[Wb].StringId===jb.StringId){this.lK.splice(Wb,
1);kb=!0;break}for(;5<this.lK.length;)this.lK.splice(this.lK.length-1,1);this.qla.Categories[oc.W8a].DomainIds=this.lK;this.lZf();kb||this.QOd.$ng(this.lK)}}}convertLinkedEntityToText(){b.ULS.sendTraceTag(34719501,0,50,"ConvertToLinkedEntityManager:ConvertLinkedEntityToText() - conversion attempted");if(this.gridView){var kb=Zb.q(this.gridView.ha.qa.ld,this.$);qb.a(this.$.userOperationManager,(jb,Wb,wc)=>G(this.$.oa.xa,kb,jb,Wb,wc,null),jb=>new Ha.a(116,0,jb),null)}else b.ULS.shipAssertTag(537166879,
0,!1,"grid view should not be null")}refreshLinkedEntitiesInRange(){b.ULS.sendTraceTag(537166878,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange() - refresh attempted");if(Qa.h(this.$)){this.$.isEditMode||b.ULS.sendTraceTag(537166876,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange(): Refreshing selection during view mode");this.FLd();var kb=Zb.r(this.gridView.ha.qa.selectedRanges,this.$);qb.a(this.$.userOperationManager,(jb,Wb,wc)=>D(this.$.oa.xa,kb,jb,Wb,wc,null),
jb=>new Ha.a(248,0,jb),null)}else b.ULS.shipAssertTag(537166877,0,!1,"grid view should not be null")}fHj(kb){kb=this.nU(kb.DomainId);if(!kb||kb.DomainBlocked||Kb.EwaSettings.isChangeGateEnabled("OfficeVSO:4465309_NoCuratedDataNoLongButton")&&!kb.HasCuratedData)return!1;if(this.Wqi){for(let jb of this.mU)if(jb.value.DomainId.Id===kb.DomainId.Id&&jb.value.ShowInRibbon)return!0;return!1}return kb.ShowInRibbon}MFj(kb){return 2!==this.hs||!this.bua[kb]}launchDisambiguationPaneForSearch(){this.Mn&&this.Mn.launchDisambiguationPaneForSearch()}Nc(kb,
jb,Wb){if("PopulateConvertToLinkedEntityMenu"!==jb)return!1;this.ied=Wb.MenuId;if(0===this.hs||3===this.hs)return this.E6i(),!0;if(!this.qla)return b.ULS.sendTraceTag(537166873,0,10,"PopulateMenu: Encountered null ribbon section info"),!1;if(!this.mU)return b.ULS.sendTraceTag(537166872,0,10,"PopulateMenu: Encountered null domain collection"),!1;this.oY=this.oY||this.B9a.BMh(this.qla,Wb.MenuId);Wb.MenuItems=this.oY;return this.rpd=!0}E6i(){-1===this.Gec&&(this.gIb(),this.Gec=window.setInterval(()=>
{this.gIb()},2E3))}gIb(){this.$.ea.Xb&&2!==this.hs&&(this.mLa--,b.ULS.sendTraceTag(537166870,0,50,"ConvertToLinkedEntityManager:PopulateDomainData() - populating domains attempted."),this.hs=1,S(this.$.oa.xa,this.RTi,this.QTi,null,null))}fqd(){return this.$.isEditMode&&2!==this.hs&&(0<=this.mLa||!this.hab)}B0d(kb){d.AFrameworkApplication.rg?b.ULS.sendTraceTag(537166869,0,50,"UpdatePreviewGalleryVisibility bailed out on shutting down."):m.a(this.$)?(this.S0j(),kb&&this.$.qf()):b.ULS.sendTraceTag(537166868,
0,50,"UpdatePreviewGalleryVisibility bailed out on null RibbonManager.")}Joj(){this.sFb=0;this.mLa=8;this.hab=!1;this.hs=this.Gec=0;this.MNa=this.qla=null;this.X3b();for(let kb=0;kb<this.tEb;++kb)this.bua[kb]=null;this.zAb()&&this.B0d(!0)}X3b(){this.oY=null}zAb(){const kb=w.a.VIb,jb=m.a(this.$);return!!jb&&jb.pp.Lz===kb}zjg(){if(this.qla){let Wb=0;var kb=-1,jb=-1;let wc=0,Jc=0,zc=0,gd=0;const Va=[null,null,null,null,null];for(const Eb of this.qla.Categories){let hc=!1;for(const Ab of Eb.DomainIds){let Bb=
this.nU(Ab);Bb&&!Bb.DomainBlocked&&Bb.ShowInRibbon&&(Wb<this.tEb?(this.bua[Wb]=Ab,Jc===oc.W8a&&(-1===kb&&(kb=Wb),jb=Wb,gd=jb-kb+1),++Wb):Wb===this.tEb&&wc<gd&&Jc!==oc.W8a&&(Va[wc]=Ab,++wc),hc=!0)}hc&&++zc;++Jc}if(-1<kb&&zc<=oc.wqf){for(;jb>=kb;--jb)this.bua.splice(jb,1);for(kb=0;kb<gd;++kb)this.bua.splice(Wb+kb,0,Va[kb])}for(;Wb<this.tEb;)this.bua[Wb]=null,++Wb}}uhg(){const kb=Qa.h(this.$).Ca,jb=this.gridView.ha.Ke;if(kb&&kb.hld&&1===jb&&this.gridView.ha.qa.activeCell){const Wb=ab.GetServiceTaskFactory.Oa(this.$.da,
12,477,1);Kb.EwaSettings.isChangeGateEnabled("OfficeVSO:7252908_ConvertToLinkedEntityManagerInvalidOperationFix")?ha.TaskExtensions.za(Wb,()=>{this.w2=new u.a(this.$,this.svgIconProvider,Wb.result,this,this.htmlSanitizationHelper)},this.$.la,3):this.w2=new u.a(this.$,this.svgIconProvider,Wb.result,this,this.htmlSanitizationHelper);return!0}return!1}Vyi(){this.Mn&&this.Mn.Bvd(!0)}launchLinkedEntityDataTypeSelectorPane(kb){if(this.Mn)if(kb=this.h9c(kb))if(kb.DomainId.StringId)b.ULS.sendTraceTag(537166855,
0,10,"Domain with a string ID used when launching Data Type Selector pane");else{var jb=Zb.r(this.gridView.ha.qa.selectedRanges,this.$);this.Mn.launchLinkedEntityDataTypeSelectorPane(jb,kb.DomainId.Id)}else b.ULS.sendTraceTag(537166856,0,10,"Unknown domain used when launching Data Type Selector pane")}s9g(kb){const jb=this.xei(kb),Wb=h.a.yg(this.MCb(kb));kb=h.a.yg(this.gZd(kb));return oc.eMh(jb,lb.a.qe(11),Wb,kb)}gZd(kb){try{return this.zNe(parseInt(kb,10)).Description}catch(jb){}return Ra.a.instance.ga(1796)}MCb(kb){try{return this.zNe(parseInt(kb,
10)).Name}catch(jb){}return Ra.a.instance.ga(1782)}o_f(kb){try{return this.nU(kb).Name}catch(jb){}return this.MCb(kb.Id.toString())}iWg(kb){try{return this.nU(kb).BlankCellResourceId}catch(jb){}return null}Zai(kb){try{return this.nU(kb).HasBlankCellWalkthrough}catch(jb){}return!1}Laf(kb){try{const jb=oc.e2a(kb);if(this.mU.hb(jb))return this.mU.ma(jb).HasCuratedData}catch(jb){}return!1}bQj(kb){try{return this.nU(kb).SupportsStarterData}catch(jb){}return!1}glf(kb){return 268435968===kb}qfd(){return 2===
m.a(this.$).WN?"[data-unique-id=LinkedEntity_MLR]":"[data-unique-id=LinkedEntity]"}O5b(){return new Gb.a(-847286761,Yb.a.zb,this.$.xc,0,w.a.Q_)}gIe(){if(this.zAb()&&!this.fqd()&&!this.Gif&&Kb.EwaSettings.ra(387)&&this.Laf({Id:268435968,StringId:null}))if(b.ULS.sendTraceTag(537166819,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - tried to launch first org data teaching callout"),Wa.a.pg.OQ){const Wb=this.qfd();if(Wb){var kb=this.O5b();if(kb){var jb={["InputMethod"]:Yb.a.zb,
CalloutName:6};jb.Target=Wb;jb.ShouldCanvasTakeFocus=!0;this.$.Ia.Hb(kb,jb);this.Gif=!0}else b.ULS.sendTraceTag(537166817,0,10,"RibbonCommandInfo is null for firstOrgData")}else b.ULS.sendTraceTag(537166818,0,10,"CalloutAnchorElement is null for firstOrgData")}else b.ULS.sendTraceTag(537166816,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - Attempted to launch firstOrgData callout, teaching callout not enabled")}Ydi(kb){kb=this.h9c(kb);return kb?this.B9a.TUg(kb.SubdomainFontLocator):
(b.ULS.sendTraceTag(537166815,0,10,"ConvertToLinkedEntityManager.IconFromDomainFontLocator: Requested domain that doesn't exist in collection"),null)}mhc(kb){return this.w2?this.w2.SUg(kb):!1}mPh(){return this.w2?this.w2.kQh():""}cmi(){return this.w2?this.w2.oDb:!1}gUh(kb,jb){const Wb=this.cef(kb);if(0>Wb)b.ULS.sendTraceTag(537166813,0,10,`Unexpected menuItemKey for dynamic preview gallery button: ${kb}`);else if(kb=(kb=this.ANe(kb))?this.nU(kb):null)jb[l.a.GalleryButtonProps]=this.B9a.aNh(Wb,kb),
jb[l.a.Alt]=this.B9a.Yfd(kb)}lZf(){this.zjg();this.zAb()&&this.B0d(!0);this.X3b()}xei(kb){return kb===this.KXe?z.a.QUe:kb===this.V_e?z.a.OUe:z.a.NUe}LVe(kb){try{return this.nU(kb).ExampleEntities}catch(jb){}return Ra.a.instance.ga(1804)}tKd(){(0>this.mLa||this.hab)&&b.ULS.sendTraceTag(537166811,0,15,"RefreshFullGalleryIfOpened: Out of GetLinkedEntityServiceDomain retries");(2===this.hs||0>this.mLa||this.hab)&&window.clearInterval(this.Gec);this.fqd()?this.ied&&this.$.frame.Yw(this.ied):this.B0d(this.zAb())}Eb(kb){return this.$.Bb+
kb}S0j(){var kb=!0;const jb=Array(this.tEb),Wb=m.a(this.$)?m.a(this.$).pp:null;if(Wb){for(let wc=0;wc<jb.length;++wc)this.MFj(wc)?jb[wc]=!0:kb=jb[wc]=!1;Wb.j6f(["ConvertToLinkedEntityGallery"],kb);if(!kb)for(kb=0;kb<jb.length;++kb)jb[kb]&&Wb.j6f([this.fUh(kb)],!0)}else b.ULS.sendTraceTag(537166809,0,15,"UpdateLinkedEntityGalleryButtonsVisibility: ribbonUser should not be null")}nU(kb){const jb=oc.e2a(kb);if(this.mU.hb(jb))return this.mU.ma(jb);b.ULS.sendTraceTag(592729218,0,15,`No domain data for domain ID ${kb.Id} (Has String ID: ${!!kb.StringId})`);
return null}fUh(kb){return"ConvertToLinkedEntityPreview"+kb.toString()}t0d(){k.a.get_instance().Lj(10,()=>{this.gIe();this.Z0c&&this.Yjf&&ma.c(this.Vpf,this.$.la,500)})}uec(kb,jb){switch(kb){case "QueryLinkedEntityGalleryButtons":if(!jb[l.a.InnerHTML]){kb=jb[Yb.a.Kc].toString();const Wb=sb.a.equals(kb,Ra.a.instance.ga(1799),!0)||sb.a.equals(kb,Ra.a.instance.ga(1800),!0),wc=sb.a.equals(kb,Ra.a.instance.ga(1801),!0);Wb||wc||this.gUh(kb,jb)}break;case "QueryLinkedEntityMenuGalleryButtons":jb[l.a.InnerHTML]||
(jb[l.a.InnerHTML]=this.s9g(jb[Yb.a.Kc]))}return jb}sph(kb){var jb=this.ANe(kb);if(jb)return jb;if(jb=this.h9c(kb))return jb.DomainId;b.ULS.sendTraceTag(537166805,0,10,`Could not convert key into domain: ${kb}`);return null}zNe(kb){const jb={};jb.Id=kb;return this.nU(jb)}h9c(kb){return this.mU.hb(kb)?this.mU.ma(kb):null}cef(kb){if(!kb.startsWith(oc.z9c))return-1;const jb=parseInt(kb.substr(oc.z9c.length),10);return isNaN(jb)?(b.ULS.sendTraceTag(537166802,0,10,`Unexpected index in preview gallery button key: ${kb}`),
-1):jb}ANe(kb){kb=this.cef(kb);return 0>kb?null:this.bua[kb]}fgf(kb,jb,Wb){this.mU&&this.mU.count&&(b.ULS.sendTraceTag(537166801,0,50,`ConvertToLinkedEntityManager.InvokeLinkedEntityTryAutoRefresh. (${kb})`),kb=this.$.oa.xa.Wb(),this.$.ea.Xb&&ea(this.$.oa.xa,Na.b(this.sWi,jb),Wb,null,null,kb))}pWj(){this.fgf("Auto-refresh on load",null,null)}uWj(){this.mU&&this.mU.count&&(this.dza?b.ULS.sendTraceTag(537166799,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. A periodic auto-refresh check context already exists. No need to create another one"):
this.$.ea.Qn.HasAutoRefreshableLinkedEntityDomainsEver?(b.ULS.sendTraceTag(537166797,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book has auto-refreshable domains. Creating periodic auto refresh check context"),this.dza=eb.a.instance.create(this.R0c,this.M1b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")):b.ULS.sendTraceTag(537166798,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book doesn't have any auto-refreshable domains. Periodic auto refresh check context will NOT be created"))}OAc(){if(this.$.ea.Xb&&
null!=this.B7a&&null!=this.dsd&&null!=this.esd&&null!=this.lud&&null!=this.ntd)if(++this.sFb,12>=this.sFb){1===this.sFb&&(this.cld=ta.a.Ya.ue.m,b.ULS.sendTraceTag(537166752,0,50,"StartLinkedEntityDelayedHandshake - starting handshake."));const kb=this.$.oa.xa.Wb();Ka.u(this.$.oa.xa,this.Zzi,this.$zi(),this.sXi,this.rXi,null,kb)}else b.ULS.sendTraceTag(537166751,0,15,`StartLinkedEntityDelayedHandshake - Retry count expired - failed handshake duration ${ta.a.Ya.ue.m-this.cld} ms`),this.hab=!0,this.tKd()}WBe(){if(this.$.isEditMode)if(null!=
this.B7a)this.OAc();else{var kb=ta.a.Ya.ue.m,jb=[];t.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Wb=>{Wb.isFeatureEnabled("ExcelPowerBiPro",!1).then(wc=>{b.ULS.sendTraceTag(537166747,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPro"} takes ${ta.a.Ya.ue.m-kb} Millisecond.`);b.ULS.sendTraceTag(537166746,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPro"}] isEnabled=[${wc}]`);return this.B7a=wc}).then(()=>{jb.push(Wb.isFeatureEnabled("ExcelWolframAlpha",
!1).then(wc=>{b.ULS.sendTraceTag(590960588,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelWolframAlpha"} takes ${ta.a.Ya.ue.m-kb} Millisecond.`);b.ULS.sendTraceTag(537166743,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelWolframAlpha"}] isEnabled=[${wc}]`);return this.lud=wc}))}).then(()=>{jb.push(Wb.isFeatureEnabled("ExcelDisableStockGeographyDataTypes",!1).then(wc=>{b.ULS.sendTraceTag(537166741,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelDisableStockGeographyDataTypes"} takes ${ta.a.Ya.ue.m-
kb} Millisecond.`);b.ULS.sendTraceTag(537166740,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelDisableStockGeographyDataTypes"}] isEnabled=[${wc}]`);let Jc;const zc=[(Jc=new za.a,Jc.name="IsRestrictedByLicense",Jc.bool=wc,Jc)];W.a("SatoriStockGeographyLicensingRestrictions",void 0,void 0,zc);this.Jmf=wc&&Kb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StockGeographyLicensingCheck",!1);return wc}))}).then(()=>{jb.push(Wb.isFeatureEnabled("StockHistory",!1).then(wc=>
{b.ULS.sendTraceTag(537166739,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"StockHistory"} takes ${ta.a.Ya.ue.m-kb} Millisecond.`);b.ULS.sendTraceTag(537166738,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"StockHistory"}] isEnabled=[${wc}]`);return this.ntd=wc}))}).then(()=>{jb.push(Wb.isFeatureEnabled("ExcelPowerBiFree",!1).then(wc=>{b.ULS.sendTraceTag(537166736,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiFree"} takes ${ta.a.Ya.ue.m-kb} Millisecond.`);
b.ULS.sendTraceTag(537166735,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiFree"}] isEnabled=[${wc}]`);return this.dsd=wc}))}).then(()=>{jb.push(Wb.isFeatureEnabled("ExcelPowerBiPremiumPerUser",!1).then(wc=>{b.ULS.sendTraceTag(537166734,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPremiumPerUser"} takes ${ta.a.Ya.ue.m-kb} Millisecond.`);b.ULS.sendTraceTag(537166733,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPremiumPerUser"}] isEnabled=[${wc}]`);
return this.esd=wc}))}).then(()=>{Promise.all(jb).then(()=>{this.OAc()})})})}}get Zzi(){return"ExcelPowerBiPro ExcelWolframAlpha StockHistory ExcelPowerBiFree ExcelPowerBiPremiumPerUser ExcelDisableStockGeographyDataTypes".split(" ")}$zi(){return[this.B7a,this.lud,this.ntd,this.dsd,this.esd,this.Jmf]}FLd(){this.businessBar&&this.businessBar.Jka(58)&&this.businessBar.removeEntry(58)}e$h(kb){this.bwd!==kb&&this.businessBar&&((this.bwd=kb)?ba(this.$.oa.xa,this.sTi,null,null,null):this.FLd())}static eMh(kb,
jb,Wb,wc){kb=String.format('<span class="cui-img-32by32 cui-img-cont-float"><IMG class="{0}" src="{1}" alt="{2}" align="middle"></span>',kb,jb,wc);Wb=String.format('<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel" align="middle">{0}</p></div>',Wb);return String.format('<div mscui:controltype="GalleryButton" class="leg-gallerybutton">{0}{1}</div>',kb,Wb)}static e2a(kb){return kb.StringId?kb.Id.toString()+"."+kb.StringId:kb.Id.toString()}}oc.rOe="ConvertToLinkedEntityPreview";
oc.z9c="PreviewGalleryButtonIndex.";oc.W8a=0;oc.wqf=2;Object(c.a)(oc,"ConvertToLinkedEntityManager",n.a,[575,576,2,577])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.le.js.map/9ece4873ae20b7ee329c7de0e3fa5656/EwaDSEsNext.le.js.map
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[31],{1223:function(r,F,a){r=a(0);var c=a(85),b=a(15),e=a(146),f=a(40);class d{constructor(C){this.Yfa=this.Sfa=this.bga=this.aga=null;this.t$d=this.Oce=this.dx=this.HL=!1;this.URc=this.dde=null;this.Wce=0;this.mb=this.bde=null;this.q1=C;this.Yz=3;this.Yjb=!0}initialize(C,x,B){this.aga=this.Iid(C,x);this.bga=CommonUIStrings.l_SavingStatus;this.Sfa=CommonUIStrings.l_ReadOnlyStatus;this.Yfa=CommonUIStrings.l_ReviewModeStatus;
this.q1&&this.q1.execute(H=>{H.AXc(Object(c.a)(this,this.mQb,"updateToSavingStatus"))});this.dx=!0;this.mb=B;return!0}Eea(C,x){this.HL=C;this.Yz=x;this.kS(this.Yjb)}kS(C){!this.Yjb&&C&&(this.bde=new Date);this.Yjb=C;C=null;3===this.Yz&&(C=this.Yjb?this.aga:this.bga);this.Inh(C)}Iid(C,x){return C?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):x&&x.length?String.format(CommonUIStrings.l_SavedToStatus,x):CommonUIStrings.l_SavedStatus}mQb(){this.kS(!1)}WYh(){switch(this.Yz){case 1:return this.Sfa;
case 2:return this.Yfa;default:return null}}eoi(C){return this.Oce===this.HL&&this.Wce===this.Yz&&this.dde===C}O8c(C){appChrome.getHeaderApi().then(x=>{x.updateDocumentTitleStatus(this.HL,C,this.WYh(),this.bde,this.Yjb);this.t$d=!0;return null});this.URc=null}Inh(C){this.dx&&e.c()&&!this.eoi(C)&&(!this.t$d&&this.mb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.O8c(C):f.a.wNd()?(this.URc&&b.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),
this.URc=window.requestIdleCallback(()=>{this.O8c(C)})):window.requestAnimationFrame(()=>{this.O8c(C)}),this.Oce=this.HL,this.dde=C,this.Wce=this.Yz)}}Object(r.a)(d,"ReactSaveStatusUIHandler",null,[297]);var h=a(168);class l{constructor(C,x){this.ds=null;this.aga=CommonUIStrings.l_SavedStatus;this.bga=CommonUIStrings.l_SavingStatus;this.Sfa=CommonUIStrings.l_ReadOnlyStatus;this.Yfa=CommonUIStrings.l_ReviewModeStatus;this.qUb=x;this.q1=C;this.Yz=3;this.nra=!0}Et(){this.q1&&this.q1.execute(C=>{C.AXc(Object(c.a)(this,
this.mQb,"updateToSavingStatus"))});this.qUb.execute(C=>{this.ds=C})}Eea(C,x){this.Yz=x;3===x?this.kS(this.nra):2===x?this.l_d(this.Yfa):this.l_d(this.Sfa)}mQb(){this.kS(!1)}kS(C){this.nra=C;this.l_d(this.nra?this.aga:this.bga)}l_d(C){this.ds&&this.ds.jj(h.a.FXj,this.u9g(C))}u9g(C){const x={};x.StatusText=C;return x}}Object(r.a)(l,"SaveStatusPostMessageHandler",null,[297]);var k=a(91),t=a(125),n=a(57);class z{constructor(C,x,B,H){this.Yfa=this.Sfa=this.bga=this.aga=null;this.sEa=0;this.bE=this.GSc=
this.HCa=this.sHc=this.pFa=null;this.Od=C;this.D8=x;this.q1=B;this.Xi=H;this.gbe=!0;this.HL=!1;this.Yz=3;this.nra=!0}initialize(C,x){if(!this.Od)return!1;this.aga=this.Iid(C,x);this.bga=CommonUIStrings.l_SavingStatus;this.Sfa=CommonUIStrings.l_ReadOnlyStatus;this.Yfa=CommonUIStrings.l_ReviewModeStatus;this.Et();return!0}Iid(C,x){return C?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):x&&x.length?String.format(CommonUIStrings.l_SavedToStatus,x):CommonUIStrings.l_SavedStatus}Et(){this.D8&&
this.D8.execute(C=>{C.lOg(Object(c.a)(this,this.iJe,"createStatusAndModeElements"));C.eOg(Object(c.a)(this,this.kJj,"showHideSaveStatusElement"));C.oUj&&this.iJe(null,null)});this.q1&&this.q1.execute(C=>{C.AXc(Object(c.a)(this,this.mQb,"updateToSavingStatus"))})}Iv(){this.bE&&this.Od&&this.Od.XF(this.bE)}kJj(C,x){this.Eea("true"===x,this.Yz)}Eea(C,x){this.HL=C;this.Yz=x;this.sHc&&(this.sHc.style.display=this.HL||3===this.Yz||!this.pFa?"none":"");this.HCa&&(this.HCa.style.display=this.HL||3===this.Yz?
"none":"",this.HCa.innerText=1===this.Yz?this.Sfa:this.Yfa,this.HCa.title=1===this.Yz?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.GSc&&(this.GSc.style.display=this.HL||1===this.Yz||!this.pFa&&!this.HCa?"none":"");this.bE&&(this.bE.style.display=this.HL||1===this.Yz?"none":"",this.kS(this.nra),this.bE.title=CommonUIStrings.l_SaveStatusTooltip)}iJe(C,x){C=document.getElementById(k.CuiHelper.Hbf);x&&x.O6j||!C||""===this.aga||""===this.bga||""===this.Sfa||""===
this.Yfa||(this.pFa=document.getElementById(k.CuiHelper.m2b),this.sHc=k.CuiHelper.jta(C,"BreadcrumbAppModeDash","-",null,!1),this.HCa=k.CuiHelper.jta(C,"BreadcrumbAppModeStatus",1===this.Yz?this.Sfa:this.Yfa,null,!1),this.Bjg(this.HCa),this.GSc=k.CuiHelper.jta(C,"BreadcrumbSaveStatusDash","-",null,!1),this.bE=k.CuiHelper.jta(C,"BreadcrumbSaveStatus",this.aga,null,!1),this.Bjg(this.bE),this.Eea(this.HL,this.Yz))}mQb(){this.kS(!1)}kS(C){this.nra=C;this.T1j(this.nra?this.aga:this.bga)}T1j(C){!this.bE||
3!==this.Yz&&2!==this.Yz||(this.gbe&&!this.nra?(this.sEa=this.bE.offsetWidth<this.sEa?this.sEa:this.bE.offsetWidth,this.KZj(this.bga),this.gbe=!1):this.bE.innerText=C)}Bjg(C){C.style.direction=this.Xi?"rtl":"ltr";C.style.width="auto";C.style.textAlign=this.Xi?"right":"left";C.style.display=this.HL?"none":"";C.setAttribute("Unselectable","on")}KZj(C){this.bE&&(this.bE.style.width="",this.bE.innerText=C,this.sEa=this.bE.offsetWidth<this.sEa?this.sEa:this.bE.offsetWidth,C=t.a.OA(this.bE),this.bE.style.width=
this.sEa-n.a.qD(C.paddingLeft)-n.a.qD(C.paddingRight)+1+"px")}}Object(r.a)(z,"SaveStatusUIHandler",null,[297]);var w=a(4),m=a(95);class u{constructor(){this.HSc=this.GRc=this.nmb=this.$a=null}get name(){return"Common.App.SaveStatus"}Bh(C){this.$a=C;w.AFrameworkApplication.fa.pa("PostMessageEmbedded")&&w.AFrameworkApplication.hideHeaderEmbedded?this.$a.register(l,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").qc().yc(()=>new l(this.$a.Tb("Common.App.HostNotification.EditNotificationEventSource"),
this.$a.Tb("Postmessage.IHostPostmessenger"))):w.AFrameworkApplication.sa.Qa.Pmf||(w.AFrameworkApplication.sa.Qa.gs?this.$a.register(d,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").qc().yc(()=>new d(this.$a.Tb("Common.App.HostNotification.EditNotificationEventSource"))):this.$a.register(z,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").qc().yc(()=>new z(m.EventHandlerManager.instance,this.$a.Tb("Common.App.Header.HeaderEventSource"),
this.$a.Tb("Common.App.HostNotification.EditNotificationEventSource"),w.AFrameworkApplication.isRtl)))}init(){w.AFrameworkApplication.fa.ru(Object(c.a)(this,this.lB,"onFullAppSettingsReady"))}lB(){const C=w.AFrameworkApplication.fa,x=!!w.AFrameworkApplication.sa.Qa&&4===w.AFrameworkApplication.sa.Qa.Oj;if(C.pa("WordEditorAutoSaveImprovementIsEnabled")||C.pa("PptEditorSaveStatusInHeaderEnabled")||x&&C.pa("SimplifiedReactRibbonUxIsEnabled")||C.pa("ExcelSaveStatusInHeaderEnabled")||C.pa("VisioSaveStatusInHeaderEnabled"))w.AFrameworkApplication.fa.pa("PostMessageEmbedded")&&
w.AFrameworkApplication.hideHeaderEmbedded?(this.HSc=this.$a.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.HSc.Et():w.AFrameworkApplication.sa.Qa.Pmf||C.pa("PreventSaveStatusInitializationWithHiddenHeader")&&w.AFrameworkApplication.hideHeader||(w.AFrameworkApplication.sa.Qa.gs?(this.GRc=this.$a.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.GRc.initialize(C.pa("IsSkyDrive"),C.Wa("HostNameToIncludeInSavedStatus"),w.AFrameworkApplication.fa):(this.nmb=this.$a.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&
this.nmb.initialize(C.pa("IsSkyDrive"),C.Wa("HostNameToIncludeInSavedStatus")))}dispose(){this.nmb&&this.nmb.Iv()}}Object(r.a)(u,"PackageManager",null,[3,4]);var y=a(251);a.d(F,"a",function(){return v});const v=()=>{Type.registerNamespace("Common.App.SaveStatus");y.a.instance.ii(new u)}},1279:function(r,F,a){var c=a(9);r=a(0);var b=a(83),e=a(226),f=a(229),d=a(29),h=a(21);class l{constructor(z,w){this.Wie=this.ZMc=!1;this.Uya=(m,u)=>{(null===u||void 0===u?0:u.UG)&&d.a.kTg([u.UG])&&(this.sLb=!0)};this.Ao=
()=>{this.sLb=!1};this.Rc=(m,u)=>{f.b(u)&&this.Eea(!0);this.sLb=!1};this.dd=()=>{this.SM=this.$.SM;this.Eea()};this.KHf=()=>{this.kS()};this.PGf=()=>{this.SM=this.$.SM};this.uCd=()=>{h.h(this.$).Ca.Nw(this.uCd);this.SM=this.$.SM};this.i1f=w;this.$=z;this.$.userOperationManager.Zq(this.PGf);this.$.Lk(this.dd);this.$.ea.MOg(this.KHf);this.$.ea.Jj(this.Rc);this.$.W_b(this.Uya);this.$.ea.TL(this.Ao);this.Eea()}get Byi(){return this.$.ea?this.$.ea.Bpf:!1}get SM(){return this.ZMc}set SM(z){z?this.ZMc=!0:
h.h(this.$)&&h.h(this.$).Ca&&(h.h(this.$).Ca.E4()?this.ZMc=!1:h.h(this.$).Ca.Tv(this.uCd));this.kS()}get sLb(){return this.Wie}set sLb(z){this.Wie=z;this.kS()}dispose(){this.$&&(this.$.pl(this.dd),this.$.Xuc(this.Uya),this.$.userOperationManager&&this.$.userOperationManager.Un(this.PGf),this.$.ea&&(this.$.ea.Alj(this.KHf),this.$.ea.ik(this.Rc),this.$.ea.yR(this.Ao)),h.h(this.$)&&h.h(this.$).Ca&&h.h(this.$).Ca.Nw(this.uCd))}Eea(z=!1){z=!this.$.isEditMode||z;this.i1f.Eea(z,this.$.isEditMode?3:1);this.kS()}kS(){this.$.isEditMode&&
this.i1f.kS(!this.SM&&!this.Byi&&!this.sLb)}}Object(r.a)(l,"SaveStatusManager",null,[2]);var k=a(712);class t extends e.a{constructor(z){super();this.Pc=z;this.Db()}create(){const z=b.a.instance;z.Tb("Common.App.SaveStatus.ISaveStatusUIHandler").execute(w=>{const m=new l(this.Pc,w);z.register(l,"Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager").qc().yc(()=>m);w=Object(k.a)(this.Pc.da,300,()=>z.resolve("Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager"));this.nb(w)})}static ka(z){z.da.Ha(299,
new t(z))}}Object(r.a)(t,"SaveStatusFactory",e.a,[]);a.d(F,"a",function(){return n});const n=()=>{c.a.Fa(t.ka)}},1427:function(r,F,a){a.r(F);r=a(1223);a=a(1279);Type.registerNamespace("_Ewa");Object(r.a)();Object(a.a)()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.savestatus.js.map/f86fc381d6c8c8a91f452a908f49ce71/EwaDSEsNext.savestatus.js.map
/*
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <http://feross.org>
 @license  MIT
 ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[10],{1210:function(r,F,a){r=a(0);var c=a(15),b=a(85),e;(function(S){S[S.generalException=0]="generalException";S[S.invalidArgument=1]="invalidArgument";S[S.notAllowed=2]="notAllowed";S[S.apiNotAvailable=3]="apiNotAvailable";S[S.unresolvedPendingRequest=4]="unresolvedPendingRequest";S[S.timeout=5]="timeout";S[S.adalTimeout=6]="adalTimeout";S[S.userNotSignedIn=7]="userNotSignedIn";S[S.userAborted=8]="userAborted";
S[S.silentSignInFailed=9]="silentSignInFailed";S[S.invalidResourceUrl=10]="invalidResourceUrl";S[S.invalidGrant=11]="invalidGrant";S[S.connectionLost=12]="connectionLost";S[S.clientError=13]="clientError";S[S.serverError=14]="serverError"})(e||(e={}));Object(r.b)("ErrorCodes",e);a(1325);class f{constructor(S,G){this.requestCallback=this.requestParameters=null;this.requestParameters=S;this.requestCallback=G}}Object(r.a)(f,"OutstandingRequest",null,[]);class d{}d.yLi="AADSTS50058";d.invalidResourceUrl=
"AADSTS50001";d.tLi="AADSTS65001";d.JLi="AADSTS70011";d.userAborted="13002";d.l7i="Popup Window is null";d.k7i="Popup Window closed";d.adalTimeout="Token renewal operation failed due to timeout";d.VTj="tokenRevoked";Object(r.a)(d,"WopiHostErrorType",null,[]);var h=a(4),l=a(556),k=a(573),t=a(39),n=a(1324);class z{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(r.a)(z,"WopiIdentityInfo",null,[605]);class w{constructor(S,G,D){this.expiration=
this.authority=this.accessToken=null;this.accessToken=S;this.authority=G;this.expiration=D}}Object(r.a)(w,"WopiIdentityToken",null,[604]);var m=a(27),u=a(151),y=a(378),v=a(168),C=a(70),x=a(346);class B{constructor(S){this._initialized=!1;this.lab={};this.cBc={};this.mO=h.AFrameworkApplication.sa.HD;this.Amd=S}C2a(S){this._initialized||(S.$n(v.a.ANf),S.Dl(v.a.ANf,Object(b.a)(this,this.AYi,"onReceivedAccessToken")),this._initialized=!0)}getAccessToken(S,G,D=null){this.ZNa(S,G);return new Promise((E,
N)=>{if(this.cpd(G))if(G in this.lab)N("unresolvedPendingRequest");else{var M=window.setTimeout(()=>{c.ULS.sendTraceTag(37856032,344,10,t.c({["error"]:"Request timeout.",["callerId"]:G}));N("timeout")},12E4);this.Ped(S,G,D,(L,aa)=>{window.clearTimeout(M);L?E(L):(c.ULS.sendTraceTag(37856033,369,15,t.c({["error"]:e[aa]})),N(aa))})}else c.ULS.sendTraceTag(37856034,344,10,t.c({["error"]:"Caller is not allowed."})),N("notAllowed")})}getPrimaryIdentityInfo(S){return new Promise((G,D)=>{this.cpd(S)?this.z0h((E,
N)=>{E?G(E):(c.ULS.sendTraceTag(37856064,369,10,t.c({["error"]:N.toString()})),D(N))}):(c.ULS.sendTraceTag(37856065,344,10,t.c({["error"]:"Caller is not allowed."})),D("notAllowed"))})}getAuthContext(S){return new Promise((G,D)=>{const E=this.getAuthContextSync(S);E?G(E):D("notAllowed")})}getAuthContextSync(S){if(this.cpd(S)){const G=new n.a;G.upn=h.AFrameworkApplication.fa.Wa("UserPrincipalName");G.userId=h.AFrameworkApplication.fa.Wa("LoggableUserId");G.authority=h.AFrameworkApplication.fa.Wa("HostAuthAuthority");
G.tenantId=h.AFrameworkApplication.fa.Wa("TenantId");G.isAnonymous=h.AFrameworkApplication.fa.pa("IsAnonymousUser");G.supportsAuthToken=this.Hdi(S);S=h.AFrameworkApplication.fa.Wa("HostAuthType");G.authorityType="aad"===S.toLowerCase()?2:"msa"===S.toLowerCase()?1:0;return G}c.ULS.sendTraceTag(40751647,344,10,t.c({["error"]:"Caller is not allowed."}));return null}Hdi(S){const G=l.OAuthManagerSettings.kzb;return m.a.kxa?G&&l.OAuthManagerSettings.aeg?Array.contains(l.OAuthManagerSettings.aeg,S.toLowerCase()):
!1:G}Ped(S,G,D,E){var N=[];Array.add(N,Object.assign(new C.a,{name:"CallerId",string:G}));Array.add(N,Object.assign(new C.a,{name:y.a.lWd,string:S.correlationId}));u.a.sendTelemetryEvent(Object.assign(new x.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:N}));N=k.a.create().toString();const M="getAccessToken_"+N,L=this.mO.Gc("ComponentAttach",M);this.cBc[M]=L;const aa={};aa[y.a.mWd]=N;aa[y.a.lNj]=S.resource;aa[y.a.mNj]=S.scope;aa[y.a.dbg]=h.AFrameworkApplication.fa.Wa("HostAuthType");
aa[y.a.pNj]=h.AFrameworkApplication.fa.Wa("UserPrincipalName");aa[y.a.nNj]=S.silentLogin;aa[y.a.iNj]=S.options;aa[y.a.lWd]=S.correlationId;aa[y.a.jNj]=G;D&&(aa[y.a.addinName]=D.AddinName,aa[y.a.hNj]=D.AddinTrustId);this.Amd.execute(V=>{this.C2a(V);V.jj(v.a.getAuthToken,aa)});this.lab[N]=new f(S,E)}z0h(S){const G=h.AFrameworkApplication.fa.Wa("UserName"),D=h.AFrameworkApplication.fa.Wa("UserPrincipalName"),E=h.AFrameworkApplication.fa.Wa("LoggableUserIdSpace"),N=new z;N.email=D;N.displayName=G;switch(E){case "OrgIdPuid":N.authority=
"AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":N.authority="MicrosoftAccount";break;default:N.authority=E}S(N,null)}AYi(S){let G=null;try{let E=S.Values[y.a.mWd];const N=S.Values[y.a.gNj],M=S.Values[y.a.dbg],L=S.Values[y.a.oNj];let aa=null,V=null;const P=this.lab[E];if("undefined"!==typeof P&&P){var D=[];Array.add(D,Object.assign(new C.a,{name:y.a.lWd,string:P.requestParameters.correlationId}));u.a.sendTelemetryEvent(Object.assign(new x.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",
dataFields:D}));G=P.requestCallback;delete this.lab[E];"undefined"!==typeof N&&N&&N.length?V=new w(N,M,L):aa=e[this.DGi(S)];D="getAccessToken_"+E;D in this.cBc&&(this.cBc[D].stop(),delete this.cBc[D]);G(V,aa)}else c.ULS.sendTraceTag(37856066,344,10,t.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:E}))}catch(E){S=S.Values[y.a.mWd],S in this.lab&&delete this.lab[S],this.Ulc(),c.ULS.sendTraceTag(37856067,344,10,t.c({["error"]:E.message,["stack"]:E.stack})),G&&G(null,"generalException")}}cpd(S){var G=
h.AFrameworkApplication.E7h();S=S.toLowerCase();for(const D of G)if(S===D.toLowerCase())return!0;G=l.OAuthManagerSettings.PYc;for(let D in G)if(S===G[D].toLowerCase())return!0;return!1}DGi(S){S=S.Values[y.a.kNj];this.Ulc();c.ULS.sendTraceTag(39068821,344,15,t.c({["error"]:S}));return S?-1<S.indexOf(d.yLi)?9:-1<S.indexOf(d.l7i)||-1<S.indexOf(d.k7i)?12:-1<S.indexOf(d.invalidResourceUrl)?10:-1<S.indexOf(d.userAborted)?8:-1<S.indexOf(d.JLi)||-1<S.indexOf(d.tLi)||S===d.VTj?11:-1<S.indexOf(d.adalTimeout)?
6:0:13}ZNa(S,G){S=this.Mej(S.resource);c.ULS.sendTraceTag(39921882,344,50,t.c({["callerId"]:G,["resource"]:S}))}Ulc(){c.ULS.sendTraceTag(39068822,344,50,t.c({["userAgent"]:window.navigator.userAgent}))}Mej(S){return(S?S:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(r.a)(B,"WopiIdentityManager",null,[574]);var H=a(251);class I{constructor(){this.$a=null}get name(){return"Common.App.WopiIdentity"}Bh(S){this.$a=S;S.register(B,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").qc().yc(()=>
new B(S.Tb("Postmessage.IHostPostmessenger")))}init(){h.AFrameworkApplication.fa&&h.AFrameworkApplication.fa.ru(Object(b.a)(this,this.lB,"onFullAppSettingsReady"))}lB(){try{this.$a.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(S){c.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+S)}}dispose(){}static main(){H.a.instance.ii(new I)}}Object(r.a)(I,"WopiIdentityPackage",null,[3,4]);a.d(F,"a",function(){return U});const U=()=>{Type.registerNamespace("Common.App.WopiIdentity");
I.main()}},1215:function(r,F,a){a.r(F);r=a(0);var c=a(7),b=a(15),e=a(4),f=a(160),d=a(192),h=a(84),l=a(193),k=a(60),t=a(50),n=a(37),z=a(230),w=a(113),m=a(528);class u{constructor(Da){Da=Da.split("|");this.ix=Da[1];this.HTc=Da[2];this.$Wd=Da[3]}get solutionId(){return this.ix}get solutionVersion(){return this.HTc}get needToRestoreManifest(){return this.$Wd===OSF.StoreTypeEnum.Registry.toString()}}Object(r.a)(u,"AddinStoreInfo",null,[]);class y{}Object(r.a)(y,"CustomFunctionRegistrationInfos",null,[]);
var v=a(202),C=a(71);const x=(Da,fa,ua)=>B(Da,fa,v.a.none,C.a.current,ua),B=(Da,fa,ua,Fa,ca)=>{ua=Da.continueWith(()=>{fa(Da)},3,ua,Fa);ua.continueWith(()=>{b.ULS.sendTraceTag(537163463,0,10,ca)},4);return ua},H=(Da,fa,ua)=>I(Da,fa,v.a.none,C.a.current,ua),I=(Da,fa,ua,Fa,ca)=>{ua=Da.So(()=>fa(Da),3,ua,Fa);ua.continueWith(()=>{b.ULS.sendTraceTag(537163462,0,10,ca)},4);return n.TaskExtensions.DDc(ua)},U=(Da,fa,ua)=>S(Da,fa,v.a.none,C.a.current,ua),S=(Da,fa,ua,Fa,ca)=>{ua=Da.So(()=>fa(Da),3,ua,Fa);ua.continueWith(()=>
{b.ULS.sendTraceTag(537163461,0,10,ca)},4);return ua},G=(Da,fa,ua)=>D(Da,fa,v.a.none,C.a.current,ua),D=(Da,fa,ua,Fa,ca)=>{ua=Da.So(()=>fa(Da),3,ua,Fa);ua.continueWith(()=>{b.ULS.sendTraceTag(537163460,0,10,ca)},4);return n.TaskExtensions.DDc(ua)},E=(Da,fa,ua)=>N(Da,fa,v.a.none,C.a.current,ua),N=(Da,fa,ua,Fa,ca)=>{ua=Da.continueWith(()=>{fa(Da)},3,ua,Fa);ua.continueWith(()=>{b.ULS.sendTraceTag(537163459,0,10,ca)},4);return ua},M=(Da,fa)=>{U(a(1215).CustomFunctionsInstaller.y4e("CustomFunctionsRuntimeLogging"),
ua=>{if(ua.result&&window.console)switch(ua=L(Da.severity)+" "+Da.message+fa,Da.severity){case 2:window.console.log&&window.console.log(ua);break;case 0:window.console.info&&window.console.info(ua);break;case 1:window.console.error&&window.console.error(ua)}return!0},"CustomFunctionsInstaller::LogEvent failed due to GetLocalCacheItemSafeFromLocalStorage failed")},L=Da=>{switch(Da){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}};var aa=a(979);class V{}Object(r.a)(V,
"InstallationInfo",null,[]);class P{}Object(r.a)(P,"UninstallationInfo",null,[]);var ba=a(28),Y=a(94),Z=a(35),ea=a(29),ra=a(1),O=a(22),da=a(282),xa=a(799),ia=a(55);class Ma{constructor(Da,fa){this.eTc=Da;this._message=fa}get severity(){return this.eTc}get message(){return this._message}}Object(r.a)(Ma,"CustomFunctionLog",null,[]);a.d(F,"CustomFunctionsInstaller",function(){return Ta});class Ta{constructor(Da,fa,ua){this.Twa=!1;this.bF={};this.$=Da;this.lj=fa;this.wod().ona();this.indexedDB=ua;this.indexedDB.Fe()&&
(this.Twa=!0,this.indexedDB.initialize(Ta.Hzb,Ta.Izb))}get bV(){return this.lj.bV}wff(Da,fa,ua,Fa){if(Fa.invariantNamespace)for(let ca=0;ca<Fa.invariantNamespace.length;++ca){const ka=Fa.invariantNamespace.charAt(ca);if("."!==ka&&"_"!==ka&&"a">ka&&"z"<ka&&"A">ka&&"Z"<ka&&"0">ka&&"9"<ka)throw b.ULS.sendTraceTag(537163552,0,10,`CustomFunctionsInstaller::InstallAsync: InvariantNamespace validation failed. Character='${ka}', Position=${ca}.`),Error.create("InvariantNamespace validation failed");}return H(this.$_g(ua,
Fa.manifest),()=>H(this.HJd(Da),ca=>{let ka=ca.result;return(null===ka||void 0===ka?0:ka.isDynamicMetadata)?this.IKd(Da,fa,ka,!1,!1,!1):H(this.E7j(Da,fa,Fa),Ca=>{let fb;ka=(fb=new V,fb.addinId=ua,fb.locale=Fa.locale,fb.addinInvariantNamespace=Fa.invariantNamespace,fb.addinNamespace=Fa.namespace,fb.addinTitle=Fa.title,fb.isXllCompatible=Fa.isXllCompatible,fb.metadataContent=JSON.stringify(JSON.parse(Ca.result)),fb);return this.IKd(Da,fa,ka,!1,Ta.gFh(Fa.osfControl.getStoreType()),aa.a(this.$,Fa))},
"CustomFunctionsInstaller::InstallAsync failed due to XhrGetMetadataAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to ReadInstallationInfoAsync failed"),"CustomFunctionsInstaller::InstallAsync failed due to CacheManifestAsync failed")}yff(Da,fa,ua,Fa){if(!Ta.Wtd(ua))throw b.ULS.sendTraceTag(537163551,0,10,"CustomFunctionsInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),Error.create("Invalid Metadata JSON");return H(this.HJd(Da),ca=>{ca=ca.result;if(!ca&&(ca=Z.a.Fc(this.bV,
Da),!ca))throw b.ULS.sendTraceTag(537163550,0,10,`CustomFunctionsInstaller::InstallDynamicFunctionsAsync: Unexpected error, the addin with solutionId ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Da,fa,null)} hasn't been installed yet.`),Error.create("Customfunctions dynamic registration failed");ca.metadataContent=JSON.stringify(JSON.parse(ua));ca.isDynamicMetadata=!0;return this.IKd(Da,fa,ca,!0,!0,Fa)},"CustomFunctionsInstaller::InstallDynamicFunctionsAsync failed due to ReadInstallationInfoAsync failed")}Vhg(Da,
fa){this.lj.zia();const ua=Object(c.a)(new P,{solutionId:Da}),Fa=`CustomFunctionsInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Da,fa,null)}.`;return H(this.qLd(Da),()=>H(this.xLd(Da),()=>this.D_d(this.lj,Da,fa,ua),"CustomFunctionsInstaller.UninstallAsync failed due to RemoveManifestAsync failed"),Fa)}E7j(Da,fa,ua){const Fa=new f.a;OSF.OUtil.xhrGet(ua.metadataUrl,ca=>{ca?Fa.setResult(ca):Fa.setException(Error.create("Invalid manifest"))},
ca=>{b.ULS.sendTraceTag(537163548,0,10,`CustomFunctionsInstaller.XhrGetMetadataAsync: Failed to download Custom Functions metadata for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Da,fa,null)}. ErrorCode: ${ca}.`);Fa.rs()});return Fa.task}wod(){return H(this.xtc(),Da=>{const fa=Da.result;if(!fa.length)return ia.Task.Sa(!0);b.ULS.sendTraceTag(537163547,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");Da=new d.a;const ua=[];for(let Fa=
0;Fa<fa.length;Fa++){const ca=Object(h.a)(String,fa[Fa]);Da.add(U(this.HJd(ca),ka=>{if(ka=ka.result){const Ca=Z.a.Fc(this.bF,ka.addinId);Ca&&Ca===ka.metadataContent||(this.bF[ka.addinId]=ka.metadataContent,this.bV[ca]=ka,ua.push(ka))}return!0},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to ReadInstallationInfoAsync failed"))}return G(ia.Task.WhenAllEnumerable(Da),()=>{if(ua.length){let Fa;const ca=(Fa=new y,Fa.registrationInfos=ua,Fa);return this.T1b(this.lj,fa,ca)}b.ULS.sendTraceTag(537163546,
0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: There is no custom function to register from cache");return ia.Task.Sa(!0)},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to getInstallationInfoTasks failed")},"CustomFunctionsInstaller::InstallFromCacheAsync failed")}zff(){var Da=new f.a;new d.a;const fa=[],ua=[];Object.keys(this.bV).forEach(Fa=>{Fa=Object(h.a)(String,Fa);const ca=Z.a.Fc(this.bV,Fa);fa.push(ca);ua.push(Fa)});if(!ua.length)return Da.setResult(!0),Da.task;Da=Object(c.a)(new y,
{registrationInfos:fa});return this.T1b(this.lj,ua,Da)}xtc(){return U(this.whd(m.a.kZa),Da=>{Da=Da.result;return Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(Da||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(Da||"[]"):null},"CustomFunctionsInstaller::ReadSolutionIdsLowerCaseAsync failed due to GetLocalCacheItemSafeAsync failed")}aog(Da){return this.RRd(m.a.kZa,Sys.Serialization.JavaScriptSerializer.serialize(Da))}HJd(Da){return H(this.whd(m.a.H4a(Da)),fa=>{fa=fa.result||
"";return 0<fa.length?ia.Task.Sa(Sys.Serialization.JavaScriptSerializer.deserialize(fa,!0)):ia.Task.Sa(null)},"CustomFunctionsInstaller::ReadInstallationInfoAsync failed due to GetLocalCacheItemSafeAsync failed")}w7j(Da,fa){return H(this.$Pe(Da),()=>H(this.RRd(m.a.H4a(Da),Sys.Serialization.JavaScriptSerializer.serialize(fa)),()=>Ta.SRd(m.a.old,"true"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to SetLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to EnsureCacheEntryForAddinAsync failed")}qLd(Da){return H(this.UUf(Da),
()=>H(this.lVf(m.a.H4a(Da)),()=>H(this.xtc(),fa=>fa.result.length?ia.Task.Sa(!0):Ta.SRd(m.a.old,"false"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due update ReadSolutionIdsLowerCaseAsync failed"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}dSf(Da){return this.whd(m.a.G4a(Da))}Yng(Da,fa){return H(this.$Pe(Da),
()=>this.RRd(m.a.G4a(Da),fa),"CustomFunctionsInstaller::WriteManifestAsync failed due to EnsureCacheEntryForAddinAsync failed")}xLd(Da){return H(this.UUf(Da),()=>this.lVf(m.a.G4a(Da)),"CustomFunctionsInstaller::RemoveManifestAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}$Pe(Da){return H(this.xtc(),fa=>{fa=fa.result;const ua=Da.toLowerCase();if(fa.includes(ua))return ia.Task.Sa(!0);fa.push(ua);return this.aog(fa)},"CustomFunctionsInstaller::EnsureCacheEntryForAddinAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}UUf(Da){return H(this.xtc(),
fa=>{fa=fa.result;const ua=Da.toLowerCase();return fa.includes(ua)?(fa.splice(Array.indexOf(fa,ua),1),this.aog(fa)):ia.Task.Sa(!0)},"CustomFunctionsInstaller::RemoveCacheEntryForAddinSafeAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}$_g(Da,fa){if(ra.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix"))return Da=new OSF.AddinIdInfo(Da),Da.needToRestoreManifest()?this.Yng(Da.getSolutionId(),fa):ia.Task.Sa(!0);Da=new u(Da);return Da.needToRestoreManifest?this.Yng(Da.solutionId,
fa):ia.Task.Sa(!0)}$pj(Da){if(ra.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix")){const ua=new OSF.AddinIdInfo(Da);return ua.needToRestoreManifest()?U(this.dSf(ua.getSolutionId()),Fa=>{(Fa=Fa.result)&&OSF.OsfManifestManager.cacheManifestFromXml(ua.getSolutionId(),ua.getSolutionVersion(),Fa,this.$.ya.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):ia.Task.Sa(!0)}const fa=new u(Da);return fa.needToRestoreManifest?
U(this.dSf(fa.solutionId),ua=>{(ua=ua.result)&&OSF.OsfManifestManager.cacheManifestFromXml(fa.solutionId,fa.solutionVersion,ua,this.$.ya.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):ia.Task.Sa(!0)}lVf(Da){return this.Twa?this.indexedDB.o8c(Da):Ta.wij(Da)}RRd(Da,fa){return this.Twa?this.indexedDB.jdb(new xa.a(Da,fa)):Ta.SRd(Da,fa)}whd(Da){return this.Twa?this.indexedDB.zKa(Da):Ta.y4e(Da)}IKd(Da,fa,ua,Fa,ca,ka){const Ca=`CustomFunctionsInstaller.RegisterFunctionsAsync: Failed to register Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Da,
fa,null)}.`;return n.TaskExtensions.DDc(U(this.JKd(this.lj,Da,fa,ua,!1,Fa,ka),()=>ca?this.w7j(Da,ua):ia.Task.Sa(!0),Ca))}JKd(Da,fa,ua,Fa,ca,ka,Ca){if(!ka&&(ka=Z.a.Fc(this.bF,Fa.addinId))&&ka===Fa.metadataContent)return ia.Task.Sa(!0);this.bF[Fa.addinId]=Fa.metadataContent;this.bV[fa]=Fa;Ca||Da.CJb(fa);Da.zia();return H(this.Qfj(fa,ua,Fa),()=>this.qId(Fa.addinId,ca),"Failed to register functions for customfunction addin")}Qfj(Da,fa,ua){const Fa=new f.a,ca=this.WGa(ua);return this.J3(ka=>{M(Ta.ltb,
Da);(ka=ka.Result)&&204===ka.ResponseStatusCode?Fa.setResult(!0):(delete this.bF[ua.addinId],delete this.bV[Da],x(this.qLd(Da),()=>{x(this.xLd(Da),()=>{this.G9f()},"Failed to show customfunctions installation error info")},`CustomFunctionsInstaller: Failed to register Custom Functions for solution: ${Da}. Received status code ${ka?ka.ResponseStatusCode.toString():"Unknown"}.`),Fa.setResult(!1))},ka=>{ka=w.a.Pe(ka.data);b.ULS.sendTraceTag(537163544,0,10,`CustomFunctionsInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Da,
fa,null)}. Errors: ${ea.a.nc(ka)}.`);M(Ta.ktb,Da);delete this.bF[ua.addinId];delete this.bV[Da];Fa.setResult(!1)},ca,Fa,!0)}T1b(Da,fa,ua){const Fa=new f.a,ca=ba.a.Ya.ue.m;fa.forEach(Ca=>{Ca=Object(h.a)(String,Ca);Da.NBe(Ca)});Da.zia();const ka=this.b0c(ua);return this.J3(Ca=>{M(Ta.ltb,Sys.Serialization.JavaScriptSerializer.serialize(fa));Ca=Ca.Result;let fb=!0;var yb=Sys.Serialization.JavaScriptSerializer.deserialize(Ca.ResponseBody.toString());yb=Array.isArray(yb.value)?yb.value:null;const mb=new d.a;
for(let nb=0;nb<yb.length;nb++)if(!yb[nb]){fb=!1;const X=`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Received status code ${Ca.ResponseStatusCode}.`;mb.add(H(this.qLd(fa[nb]),()=>{delete this.bF[ua.registrationInfos[nb].addinId];delete this.bV[fa[nb]];return this.xLd(fa[nb])},X))}E(ia.Task.WhenAllEnumerable(mb),()=>{x(this.qId("",!1),()=>{b.ULS.sendTraceTag(537163542,0,50,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync takes ${ba.a.Ya.ue.m-
ca} Millisecond.`);fb?Fa.setResult(fb):E(this.G9f(),()=>{Fa.setResult(fb)},"Failed to show customfunctions installation error info")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to get registration information")},Ca=>{Ca=w.a.Pe(Ca.data);b.ULS.sendTraceTag(537163541,0,10,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Errors: ${ea.a.nc(Ca)}.`);
M(Ta.ktb,Sys.Serialization.JavaScriptSerializer.serialize(fa));for(Ca=0;Ca<ua.registrationInfos.length;Ca++)delete this.bF[ua.registrationInfos[Ca].addinId],delete this.bV[fa[Ca]];Fa.setResult(!1)},ka,Fa,!0)}D_d(Da,fa,ua,Fa){return H(this.HYj(Da,fa,ua,Fa),()=>this.qId(Fa.solutionId,!1),"Failed to unregister functions for customfunction addin")}HYj(Da,fa,ua,Fa){const ca=new f.a;Da.CJb(fa);(Da=Z.a.Fc(this.bV,fa))&&delete this.bF[Da.addinId];delete this.bV[fa];Fa=this.n0c(Fa);return this.J3(()=>{M(Ta.p7c,
fa);ca.setResult(!0)},ka=>{ka=w.a.Pe(ka.data);b.ULS.sendTraceTag(537163539,0,10,`CustomFunctionsInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(fa,ua,null)}. Errors: ${ea.a.nc(ka)}.`);M(Ta.o7c,fa);ca.setResult(!1)},Fa,ca,!1)}J3(Da,fa,ua,Fa,ca){const ka=this.$.userOperationManager,Ca=this.$.oa;let fb=null,yb=null,mb=null;const nb=()=>{if(ka.PHa()||0<Ca.xa.K3||0<Ca.Ok.K3)return!1;fb&&ka.Un(fb);yb&&Ca.ps(yb);
mb&&Ca.ny(mb);const X=ua.request;let R=0;ra.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?X.RequestFlags&1&&256!==(X.RequestFlags&256)||(R=16):R=X.RequestFlags&1?0:16;ka.KE(new l.a(507,0,(wa,na,Ba)=>{M(ca?Ta.n7c:Ta.q7c,X.RequestBody);return k.g(Ca.xa,"ExecuteRichApiRequest",ua,da.b(wa,Da),da.a(na,fa),Ba,null,0)},R|64));return!0};nb()||(fb=()=>{nb()},yb=()=>{nb()},mb=()=>{nb()},ka.Zq(fb),Ca.$q(yb),Ca.rx(mb));return Fa.task}WGa(Da){const fa={HttpMethod:"POST",
PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};fa.RequestBody=JSON.stringify(Da);fa.RequestFlags=1;ra.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(fa.RequestFlags|=256);Da=this.$.oa.xa.Na(1);Da.request=fa;return Da}b0c(Da){const fa={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};fa.RequestBody=JSON.stringify(Da);fa.RequestFlags=1;ra.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&
(fa.RequestFlags|=256);Da=this.$.oa.xa.Na(1);Da.request=fa;return Da}n0c(Da){const fa={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};fa.RequestBody=JSON.stringify(Da);fa.RequestFlags=1;ra.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(fa.RequestFlags|=256);Da=this.$.oa.xa.Na(1);Da.request=fa;return Da}qId(Da,fa){const ua=t.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1);return I(ua,()=>{ua.result.INd();return Da&&fa?
this.$pj(Da):ia.Task.Sa(!0)},this.$.la,z.a.instance,"CustomFunctionsInstaller::ProcessPostRegistrationActionsAsync failed due to create IFunctionInfoManager failed")}G9f(){const Da=new Y.a(1949669462,0,this.$.xc,0,null);return this.$.Ia.Hb(Da)}static y4e(Da){try{return ia.Task.Sa(localStorage.getItem(Da))}catch(fa){return b.ULS.sendTraceTag(537163537,0,50,`CustomFunctionsInstaller.GetLocalCacheItemSafe: Failed to get data from the localStorage. Reason: ${fa.message||"Unknown"}`),ia.Task.Sa(null)}}static SRd(Da,
fa){try{return localStorage.setItem(Da,fa),ia.Task.Sa(!0)}catch(ua){return b.ULS.sendTraceTag(537163536,0,50,`CustomFunctionsInstaller.SetLocalCacheItemSafe: Failed to set data into the localStorage. Reason: ${ua.message||"Unknown"}`),ia.Task.Sa(!1)}}static wij(Da){try{return localStorage.removeItem(Da),ia.Task.Sa(!0)}catch(fa){return b.ULS.sendTraceTag(537163535,0,50,`CustomFunctionsInstaller.RemoveLocalCacheItemSafeAsync: Failed to set data into the localStorage. Reason: ${fa.message||"Unknown"}`),
ia.Task.Sa(!1)}}static gFh(Da){return O.a.equals(Da,"registry",!0)||O.a.equals(Da,"uploadfiledevcatalog",!0)||e.AFrameworkApplication.userNameUnknown||e.AFrameworkApplication.limitedEdit}static Wtd(Da){if(!Da)return!1;try{JSON.parse(Da)}catch(fa){return!1}return!0}}Ta.Hzb="CustomFunctionCache";Ta.Izb="CustomFunction";Ta.n7c=new Ma(2,"CustomFunctions [Registration] [Begin] SolutionId=");Ta.ltb=new Ma(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");Ta.ktb=new Ma(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");
Ta.q7c=new Ma(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");Ta.p7c=new Ma(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");Ta.o7c=new Ma(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(r.a)(Ta,"CustomFunctionsInstaller",null,[807])},1218:function(r,F,a){a.r(F);r=a(0);var c=a(7),b=a(15),e=a(952),f=a(160),d=a(84),h=a(193),l=a(60),k=a(50),t=a(37),n=a(113),z=a(528),w=a(979);class m{constructor(M){M=M.split("|");this.ix=M[1];this.HTc=M[2];this.$Wd=
M[3]}get solutionId(){return this.ix}get solutionVersion(){return this.HTc}get needToRestoreManifest(){return this.$Wd===OSF.StoreTypeEnum.Registry.toString()}}Object(r.a)(m,"AddinStoreInfo",null,[]);class u{}Object(r.a)(u,"CustomFunctionRegistrationInfos",null,[]);const y=(M,L)=>{if(a(1218).CustomFunctionsLegacyInstaller.pxb("CustomFunctionsRuntimeLogging")&&window.console)switch(L=v(M.severity)+" "+M.message+L,M.severity){case 2:window.console.log&&window.console.log(L);break;case 0:window.console.info&&
window.console.info(L);break;case 1:window.console.error&&window.console.error(L)}},v=M=>{switch(M){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}};class C{}Object(r.a)(C,"InstallationInfo",null,[]);class x{}Object(r.a)(x,"UninstallationInfo",null,[]);var B=a(158),H=a(35),I=a(29),U=a(13),S=a(282),G=a(881),D=a(55);class E{constructor(M,L){this.eTc=M;this._message=L}get severity(){return this.eTc}get message(){return this._message}}Object(r.a)(E,"CustomFunctionLog",
null,[]);a.d(F,"CustomFunctionsLegacyInstaller",function(){return N});class N{constructor(M){this.bF={};this.$=M;this.wod().ona()}wff(M,L,aa,V){const P=new f.a;if(V.invariantNamespace)for(L=0;L<V.invariantNamespace.length;++L){const Y=V.invariantNamespace.charAt(L);if("."!==Y&&"_"!==Y&&"a">Y&&"z"<Y&&"A">Y&&"Z"<Y&&"0">Y&&"9"<Y)return b.ULS.sendTraceTag(537163530,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: InvariantNamespace validation failed. Character='${Y}', Position=${L}.`),P.setResult(!1),
P.task}N.cacheManifest(aa,V.manifest);let ba=N.IJd(M);(null===ba||void 0===ba?0:ba.isDynamicMetadata)?this.HKd(M,ba,P,!1,!1):OSF.OUtil.xhrGet(V.metadataUrl,Y=>{ba=Object(c.a)(new C,{addinId:aa,locale:V.locale,addinInvariantNamespace:V.invariantNamespace,addinNamespace:V.namespace,addinTitle:V.title,isXllCompatible:V.isXllCompatible,metadataContent:JSON.stringify(JSON.parse(Y))});this.HKd(M,ba,P,!1,w.a(this.$,V))},Y=>{b.ULS.sendTraceTag(537163528,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to download Custom Functions metadata for solution ${M}. ErrorCode: ${Y}.`);
P.setResult(!1)});return P.task}yff(M,L,aa,V){L=new f.a;if(!N.Wtd(aa))return b.ULS.sendTraceTag(537163527,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),L.setResult(!1),L.task;const P=N.IJd(M);if(!P)return b.ULS.sendTraceTag(537163526,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Unexpected error, could not read existing solution cache info."),L.setResult(!1),L.task;P.metadataContent=JSON.stringify(JSON.parse(aa));P.isDynamicMetadata=
!0;this.HKd(M,P,L,!0,V);return L.task}Vhg(M){const L=new f.a,aa=k.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);t.TaskExtensions.za(aa,()=>{const V=aa.result;V.zia();const P=Object(c.a)(new x,{solutionId:M});N.rLd(M);N.yLd(M);t.TaskExtensions.za(this.D_d(V,M,P),ba=>{B.b(ba)?L.setResult(ba.result):(ba.Hf?b.ULS.sendTraceTag(537163524,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${M}.`):ba.kh&&b.ULS.sendTraceTag(537163523,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Uninstall Custom Functions is canceled for solution: ${M}.`),
L.setResult(!1))},this.$.la,0)},this.$.la,3);return L.task}wod(){const M=new f.a,L=N.NJd();0<L.length&&b.ULS.sendTraceTag(537163522,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");const aa=[];L.forEach(P=>{P=Object(d.a)(String,P);if(P=N.IJd(P)){const ba=H.a.Fc(this.bF,P.addinId);ba&&ba===P.metadataContent||(this.bF[P.addinId]=P.metadataContent,aa.push(P))}});if(!aa.length)return M.setResult(!0),b.ULS.sendTraceTag(537163521,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: There is no custom function to register from cache"),
M.task;const V=k.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);t.TaskExtensions.za(V,()=>{const P=V.result,ba=Object(c.a)(new u,{registrationInfos:aa});t.TaskExtensions.za(this.T1b(P,L,ba),Y=>{B.b(Y)?M.setResult(Y.result):(Y.Hf?b.ULS.sendTraceTag(537163491,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Failed to register Custom Functions."):Y.kh&&b.ULS.sendTraceTag(537163490,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Registering Custom Functions is canceled."),
M.setResult(!1))},this.$.la,0)},this.$.la,3);return M.task}Zpj(M){M=new m(M);if(M.needToRestoreManifest){const L=N.tdj(M.solutionId);OSF.OsfManifestManager.cacheManifestFromXml(M.solutionId,M.solutionVersion,L,this.$.ya.UICultureTag)}}HKd(M,L,aa,V,P){const ba=k.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);t.TaskExtensions.za(ba,()=>{t.TaskExtensions.za(this.JKd(ba.result,M,L,!1,V,P),Y=>{B.b(Y)?((Y=Y.result)&&N.x7j(M,L),aa.setResult(Y)):(Y.Hf?b.ULS.sendTraceTag(537163488,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to register Custom Functions for solution: ${M}.`):
Y.kh&&b.ULS.sendTraceTag(537163487,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Registering Custom Functions is canceled for solution: ${M}.`),aa.setResult(!1))},this.$.la,0)},this.$.la,3)}JKd(M,L,aa,V,P,ba){if(!P&&(P=H.a.Fc(this.bF,aa.addinId))&&P===aa.metadataContent)return D.Task.Sa(!0);this.bF[aa.addinId]=aa.metadataContent;const Y=new f.a;ba||M.CJb(L);M.zia();M=this.WGa(aa);return this.J3(Z=>{y(N.ltb,L);const ea=Z.Result;204===ea.ResponseStatusCode?t.TaskExtensions.za(this.pId(Y,aa.addinId,
V),ra=>{ra.Hf?L?b.ULS.sendTraceTag(537163485,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${L}.`):b.ULS.sendTraceTag(537163484,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for addinId ${aa.addinId}.`):ra.kh&&(L?b.ULS.sendTraceTag(537163483,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for solution ${L}.`):
b.ULS.sendTraceTag(537163482,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for addinId ${aa.addinId}.`));Y.setResult(!1)},this.$.la,4):(Z=()=>{delete this.bF[aa.addinId];N.rLd(L);N.yLd(L);b.ULS.sendTraceTag(537163481,0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solution: ${L}. Received status code ${ea.ResponseStatusCode}.`);Y.setResult(!1)},Z=Object(c.a)(new G.a,{RLa:OSF.InfoType.Error,title:aa.addinTitle,
description:String.format(U.a.instance.ob(153),U.a.instance.ga(1891)),buttonText:U.a.instance.ga(4),mha:Z,pfc:!1,nia:Z,errorCode:OSF.ErrorStatusCodes.WAC_CustomFunctionsRegistrationError}),e.a.uUd(Z))},Z=>{Z=n.a.Pe(Z.data);b.ULS.sendTraceTag(537163480,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${L}. Errors: ${I.a.nc(Z)}.`);y(N.ktb,L);delete this.bF[aa.addinId];Y.setResult(!1)},M,Y,!0)}T1b(M,L,aa){const V=new f.a;L.forEach(ba=>
{ba=Object(d.a)(String,ba);M.NBe(ba)});M.zia();const P=this.b0c(aa);return this.J3(ba=>{y(N.ltb,Sys.Serialization.JavaScriptSerializer.serialize(L));ba=ba.Result;let Y=!0;var Z=Sys.Serialization.JavaScriptSerializer.deserialize(ba.ResponseBody.toString());Z=Array.isArray(Z.value)?Z.value:null;for(let ea=0;ea<Z.length;ea++)Z[ea]||(Y=!1,delete this.bF[aa.registrationInfos[ea].addinId],N.rLd(L[ea]),N.yLd(L[ea]),b.ULS.sendTraceTag(537163478,0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solutionId: ${L[ea]}. Received status code ${ba.ResponseStatusCode}.`));
t.TaskExtensions.za(this.pId(V,"",!1),ea=>{ea.Hf?b.ULS.sendTraceTag(537163477,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"):ea.kh&&b.ULS.sendTraceTag(537163476,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Batch register Custom Functions is canceled");V.setResult(!1)},this.$.la,4);V.setResult(Y)},ba=>{ba=n.a.Pe(ba.data);b.ULS.sendTraceTag(537163475,0,10,`CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions for solutionIds ${Sys.Serialization.JavaScriptSerializer.serialize(L)}. Errors: ${I.a.nc(ba)}.`);
y(N.ktb,Sys.Serialization.JavaScriptSerializer.serialize(L));for(const Y of aa.registrationInfos)delete this.bF[Y.addinId];V.setResult(!1)},P,V,!0)}D_d(M,L,aa){const V=new f.a;M.CJb(L);M=this.n0c(aa);return this.J3(()=>{y(N.p7c,L);t.TaskExtensions.za(this.pId(V,aa.solutionId,!1),P=>{P.Hf?L&&b.ULS.sendTraceTag(537163473,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${L}.`):P.kh&&L&&b.ULS.sendTraceTag(537163472,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Unregistering Custom Functions is canceled for solution ${L}.`);
V.setResult(!1)},this.$.la,4)},P=>{P=n.a.Pe(P.data);b.ULS.sendTraceTag(537163471,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${L}. Errors: ${I.a.nc(P)}.`);y(N.o7c,L);V.setResult(!1)},M,V,!1)}J3(M,L,aa,V,P){const ba=this.$.userOperationManager,Y=this.$.oa;let Z=null,ea=null,ra=null;const O=()=>{if(ba.PHa()||0<Y.xa.K3||0<Y.Ok.K3)return!1;Z&&ba.Un(Z);ea&&Y.ps(ea);ra&&Y.ny(ra);const da=aa.request;ba.KE(new h.a(507,0,(xa,ia,
Ma)=>{y(P?N.n7c:N.q7c,da.RequestBody);return l.g(Y.xa,"ExecuteRichApiRequest",aa,S.b(xa,M),S.a(ia,L),Ma,null,0)},(da.RequestFlags&1?0:16)|64));return!0};O()||(Z=()=>{O()},ea=()=>{O()},ra=()=>{O()},ba.Zq(Z),Y.$q(ea),Y.rx(ra));return V.task}WGa(M){const L={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};L.RequestBody=JSON.stringify(M);L.RequestFlags=1;M=this.$.oa.xa.Na(1);M.request=L;return M}b0c(M){const L={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",
RequestHeaders:null};L.RequestBody=JSON.stringify(M);L.RequestFlags=1;M=this.$.oa.xa.Na(1);M.request=L;return M}n0c(M){const L={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};L.RequestBody=JSON.stringify(M);L.RequestFlags=1;M=this.$.oa.xa.Na(1);M.request=L;return M}pId(M,L,aa){const V=k.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1);t.TaskExtensions.za(V,()=>{V.result.INd();L&&aa&&this.Zpj(L);M.setResult(!0)},this.$.la,3);return V}zff(){return D.Task.Sa(!0)}static NJd(){return(Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(N.pxb(z.a.kZa)||
"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(N.pxb(z.a.kZa)||"[]"):null)||[]}static bog(M){N.TRd(z.a.kZa,Sys.Serialization.JavaScriptSerializer.serialize(M))}static IJd(M){M=N.pxb(z.a.H4a(M))||"";return 0<M.length?Sys.Serialization.JavaScriptSerializer.deserialize(M,!0):null}static x7j(M,L){N.ZPe(M);N.TRd(z.a.H4a(M),Sys.Serialization.JavaScriptSerializer.serialize(L))}static rLd(M){N.TUf(M);N.mVf(z.a.H4a(M))}static tdj(M){return N.pxb(z.a.G4a(M))}static y7j(M,L){N.ZPe(M);N.TRd(z.a.G4a(M),
L)}static yLd(M){N.TUf(M);N.mVf(z.a.G4a(M))}static ZPe(M){const L=N.NJd();M=M.toLowerCase();L.includes(M)||(L.push(M),N.bog(L))}static TUf(M){const L=N.NJd();M=M.toLowerCase();L.includes(M)&&(L.splice(Array.indexOf(L,M),1),N.bog(L))}static cacheManifest(M,L){M=new m(M);M.needToRestoreManifest&&N.y7j(M.solutionId,L)}static pxb(M){try{return localStorage.getItem(M)}catch(L){return b.ULS.sendTraceTag(537163469,0,50,`CustomFunctionsLegacyInstaller.GetLocalStorageItemSafe: Failed to get data from the localStorage. Reason: ${L.message||
"Unknown"}`),null}}static TRd(M,L){try{localStorage.setItem(M,L)}catch(aa){b.ULS.sendTraceTag(537163468,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${aa.message||"Unknown"}`)}}static mVf(M){try{localStorage.removeItem(M)}catch(L){b.ULS.sendTraceTag(537163467,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${L.message||"Unknown"}`)}}static Wtd(M){if(!M)return!1;try{JSON.parse(M)}catch(L){return!1}return!0}}
N.n7c=new E(2,"CustomFunctions [Registration] [Begin] SolutionId=");N.ltb=new E(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");N.ktb=new E(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");N.q7c=new E(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");N.p7c=new E(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");N.o7c=new E(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(r.a)(N,"CustomFunctionsLegacyInstaller",null,[807])},
1258:function(r,F,a){r=a(0);var c=a(202),b=a(15);class e{}Object(r.a)(e,"AddinCommandsHost",null,[]);var f=a(1335),d=a(1419),h=a(880),l=a(60);const k=(H,I,U,S,G,D)=>{const E=H.Na(9);E.sharedInfo=I;return l.g(H,"InsertAgaveTaskpane",E,U,S,G,D,0)},t=(H,I,U,S,G,D,E=null)=>{E=H.Na(9,E);E.sharedInfo=I;return l.g(H,"ShowAgaveTaskpane",E,U,S,G,D,0)};var n=a(376),z=a(193),w=a(37),m=a(1),u=a(282),y=a(150);class v extends y.a{constructor(H){super();this.pe=this.oDa="AddInCommandsDialog";this.Ob=5;this.dialogWidth=
695;this.dialogHeight=438;this.E9g="100%";this.B9g="408px";this.C9g="15px";this.D9g="0";this.hBg=H}get containerDiv(){return this.Mh}Iw(){super.Iw();this.Mh.style.width=this.E9g;this.Mh.style.height=this.B9g;this.Mh.style.marginTop=this.C9g;this.Mh.style.padding=this.D9g}CD(){super.CD();this.lb.style.width=String.format("{0}px",this.dialogWidth);this.lb.style.height=String.format("{0}px",this.dialogHeight)}dispose(){super.dispose();this.hBg()}}Object(r.a)(v,"AddInCommandsDialog",y.a,[]);var C=a(55),
x=a(71);y=a(100);a.d(F,"a",function(){return B});class B extends e{constructor(H,I,U,S=null,G=null){super();this.$=H;this.Jd=I;this.ownerAddinInfo=U;this.Sd=G;this.$cb=S||C.Task.Sa(!0)}w9g(){const H=this.$cb;this.$cb=C.Task.Sa(!0);return H}disposeHost(H){this.Jd.DQa(H)}setOwnerAddinEToken(H){this.ownerAddinInfo.eToken=H}showTaskpane(H,I,U){b.ULS.sendTraceTag(537170642,220,50,"ShowTaskpane action called.");let S=null,G=!1,D=(new f.a("m_excelWebRenderer_ewaCtl_",this.ownerAddinInfo.solutionId,new h.a,
!0)).aKe(H.solutionId.substr(this.ownerAddinInfo.solutionId.length));S=I.getSharedRuntimeForTaskpane("Workbook",D);G=!!S&&1===S.LifeTime;this.Jd.QBe(G?this.ownerAddinInfo.solutionId:H.solutionId,G?S:null,null)||(this.wsf(G,!0),this.$cb=this.uod(H,S,(E,N)=>{E?(G&&(E.PrimaryMarketplace.SolutionId=this.ownerAddinInfo.solutionId,E.SharedRuntime=S),E.WebExtensionOsfControlType=3,this.Jd.eIa(E),U(E.InstanceId,N),this.wsf(G,!1),m.EwaSettings.isChangeGateEnabled("OfficeVSO:6085876_TelemetryForActiveAddinSuccessOnExcelWacEnabled")&&
b.ULS.sendTraceTag(524818146,220,50,"ShowTaskpane: succeed to call.")):(b.ULS.sendTraceTag(17306640,220,10,"ShowTaskpane: instance id is null."),U(null,N))}))}getSettings(H,I){let U=this.Jd.Baa(H.solutionId);U?I(this.Jd.gZ(U).OsfPropertyBag):this.$cb=this.uod(H,null,S=>{S?I(S.OsfPropertyBag):b.ULS.sendTraceTag(537170641,220,10,"GetSettings: insertData is null.")})}showDialog(H,I,U){b.ULS.sendTraceTag(537170640,220,50,"ShowDialog action called.");const S=this.$.oa.xa,G=E=>{const N=E.Result,M=N?N.AgaveData:
null;M?(this.Jd.WIe(M,()=>{const L=new v(()=>{this.disposeHost(M.InstanceId)});L.initializeAndShow("",null,null);return L.containerDiv}),U(M.InstanceId,0)):(b.ULS.sendTraceTag(537170638,220,10,"ShowDialog: instance id is null."),U(null,E.Errors?E.Errors[0].ErrorCause:5001))},D=B.nta(H,this.ownerAddinInfo);this.$cb=n.a(this.$.userOperationManager,(E,N,M)=>k(S,D,u.b(E,G),N,M,null),E=>new z.a(500,0,E,64),this.Sd)}createUILessSandbox(H,I,U){b.ULS.sendTraceTag(537170637,220,50,"UILess action called.");
const S=I.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"),G=!!S&&1===S.LifeTime;(I=this.Jd.LHh(G?this.ownerAddinInfo.solutionId:H.solutionId,G?S:null))?U(I,0):this.$cb=this.uod(H,S,(D,E)=>{D?(G?(D.PrimaryMarketplace.SolutionId=this.ownerAddinInfo.solutionId,D.SharedRuntime=S,D.TaskpaneVisible=!1,D.WebExtensionOsfControlType=3,this.Jd.eIa(D)):(D.WebExtensionOsfControlType=4,this.Jd.WIe(D,()=>{B.cgb.ia(D.InstanceId,new d.a);return B.cgb.ma(D.InstanceId).Z$})),U(D.InstanceId,E)):(b.ULS.sendTraceTag(537170636,
220,10,"UILess: instance id is null."),U(null,E))})}uod(H,I,U){let S=null;const G=this.$.oa.xa,D=aa=>{const V=aa.Result;(S=V?V.AgaveData:null)||U(null,aa.Errors?aa.Errors[0].ErrorCause:5001)},E=B.nta(H,this.ownerAddinInfo);I&&(b.ULS.sendTraceTag(537170634,220,50,"Shared runtime agave is inserted."),E.SharedRuntimeId=I.Resid);let N=500;var M=(aa,V,P)=>k(G,E,u.b(aa,D),V,P,null);let L=0;void 0===E.IsToBePersisted||null===E.IsToBePersisted||E.IsToBePersisted||(N=538,M=(aa,V,P)=>{b.ULS.sendTraceTag(537170633,
220,50,"Web Method ShowAgaveTaskpane is called, StoreType {0}, StoreId {1}, SolutionId {2}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(this.ownerAddinInfo.solutionId,this.ownerAddinInfo.storeType,this.ownerAddinInfo.assetId,null,null,this.ownerAddinInfo.storeId));return t(G,E,u.b(aa,D),V,P,null)},L=16);L|=64;M=n.a(this.$.userOperationManager,M,aa=>new z.a(N,0,aa,L),this.Sd);return w.TaskExtensions.ts(M,()=>S?this.nwd(G,S.InstanceId,(aa,V)=>{if(aa){I||(S.PrimaryMarketplace.MarketplaceType=H.storeType);
H.assetId?H.assetId.toLowerCase().startsWith("wa")?S.AssetMarketplace={SolutionId:H.assetId,SolutionVersion:H.version,MarketplaceType:OSF.StoreType.OMEX,MarketplaceRef:H.assetStoreId}:(S.AssetMarketplace=null,b.ULS.sendTraceTag(512325019,344,10,"WACExcelAddinCommandsHost: AssetId is not a valid value")):S.AssetMarketplace=null;S.OwnerAddinSolutionId=this.ownerAddinInfo.solutionId;S.OwnerAddinStoreType=this.ownerAddinInfo.storeType;S.OsfPropertyBag=[];for(V=0;V<aa.Settings.length;V++){const P=[];P[0]=
aa.Settings[V].Name;P[1]=aa.Settings[V].Value;S.OsfPropertyBag[V]=P}U(S,0)}else U(null,V.Errors?V.Errors[0].ErrorCause:5001)}):C.Task.Sa(!1),c.a.none,3,x.a.current)}nwd(H,I,U){const S=G=>{U(G.Result,G)};return n.a(this.$.userOperationManager,(G,D,E)=>{G=u.b(G,S);const N=H.Na(1);N.controlId=I;return l.g(H,"DdaLoadSettings",N,G,D,E,null,0)},G=>new z.a(501,0,G,80),this.Sd)}wsf(H,I){var U;H&&(null===(U=window.performance)||void 0===U?0:U.memory)&&b.ULS.sendTraceTag(537170630,220,50,`Shared runtime memory usage: before=${I}, jsHeapSizeLimit=${window.performance.memory.jsHeapSizeLimit}, totalJSHeapSize=${window.performance.memory.totalJSHeapSize}, usedJSHeapSize=${window.performance.memory.usedJSHeapSize}`)}static showUILessDialog(H){B.cgb.hb(H)&&
B.cgb.ma(H).initializeAndShowWithTitle()}static hideUILessDialog(H){B.cgb.hb(H)&&B.cgb.ma(H).hide()}static nta(H,I){const U={};U.SolutionId=H.solutionId;U.Version=H.version;U.StoreType=I.storeType;U.StoreId=H.storeId;U.AssetId=H.solutionId;U.AssetStoreId="omex";U.TargetType=1;U.Width=350;U.OwnerAddinSolutionId=I.solutionId;U.OwnerAddinStoreType=I.storeType;U.SharedRuntimeId=null;U.Preload=!1;return U}}B.cgb=new y.a;Object(r.a)(B,"WACExcelAddinCommandsHost",e,[])},1264:function(r,F,a){var c=a(9);r=
a(0);var b=a(709),e=a(15),f=a(104),d=a(4),h=a(1326),l=a(1),k=a(189),t=a(55);class n{constructor(y,v,C){this.otb=null;this.$=y;v?(e.ULS.sendTraceTag(537163346,0,50,"DataFromPictureCommandHandler.constructor - AugmentationLoopManager and UploaderCreator instantiated."),this.otb=new h.a(y,v,C)):e.ULS.sendTraceTag(537163347,0,10,"DataFromPictureCommandHandler.constructor - Failed to instantiate AugmentationLoopManager.")}Hc(){return!1}executeCommand(y,v,C){y=!1;switch(v.command){case 73979048:this.otb&&
this.otb.q8i(v,f.a.instance,d.AFrameworkApplication.fa,C),y=!0}return y?t.Task.Sa(!0):k.a(v.command)}wc(y,v){return 73979048===v.command&&l.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)}Nc(){return!1}dispose(){this.otb&&this.otb.dispose()}}Object(r.a)(n,"DataFromPictureCommandHandler",null,[222,2]);var z=a(37),w=a(50);class m extends b.a{constructor(y){super(y)}hd(){const y=w.GetServiceTaskFactory.Oa(this.$.da,328,327,1),v=w.GetServiceTaskFactory.Oa(this.$.da,
484,485,1);z.TaskExtensions.za(z.TaskExtensions.Fd([y,v],this.$.la),()=>{this.$c([new n(this.$,y.result,v.result)])},this.$.la,3)}static ka(y){b.a.Md(452,new m(y))}}Object(r.a)(m,"DataFromPictureCommandHandlerFactory",b.a,[]);a.d(F,"a",function(){return u});const u=()=>{c.a.Fa(y=>{m.ka(y)})}},1324:function(r,F,a){a.d(F,"a",function(){return c});r=a(0);class c{constructor(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=
this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}static lPh(b){switch(b){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}}}Object(r.a)(c,"WopiAuthContext",null,[636])},1325:function(r,F,a){a.d(F,"a",function(){return c});r=a(0);class c{}c.uKf="OneDriveWOPI";Object(r.a)(c,"HostApplicationType",null,[])},1326:function(r,F,a){(function(c){a.d(F,"a",function(){return B});var b=a(0),e=a(15),f=a(174),d=a(84),
h=a(1332),l=a(38),k=a(252),t=a(41),n=a(376),z=a(193),w=a(60),m=a(94),u=a(13),y=a(21),v=a(39),C=a(1333),x=a(1);class B extends l.a{constructor(H,I,U){super();this.Dei=h.a.getTypeName();this.uzb=this.RT=this.Sd=null;this.imageHeight=this.imageWidth=0;this.OLa=this.errorMessage=this.tableData=null;this.Kmd=0;this.GVc=!1;this.gKe=S=>{if(S){var G={};if(({ht:G}=v.d(this.Vjh(S.data))).returnValue&&(S=Object(d.a)(Object,G),"."===S.DataFromPictureWildcard))if(S.SessionId!==this.OLa)e.ULS.sendTraceTag(523805139,
0,10,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(e.ULS.sendTraceTag(523805138,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - Message Received from SDX pane"),S.CmdType){case "ACK":this.GVc=!0;this.Vdg.stop();e.ULS.sendTraceTag(523805137,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - SDX pane launched.");this.Fvj();0<this.errorMessage.length?
this.Q2f():0<this.tableData.length&&this.h3f();break;case "insert_html":const E=this.$.oa.xa;G={};var D=y.h(this.$).ha.qa.ld.clone();G.PasteId=f.a.create().toString();G.DestinationRanges=t.s(t.v(D,this.$));D=S.Parameters.split("|",3);x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveCCforDataFromPictureXLO",!1)||e.ULS.sendTraceTag(523805136,0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - LCC:${D[0]}|${D[1]}|${D[2]}.`);D=S.Parameters.indexOf("|");D=S.Parameters.indexOf("|",
D+1);D=S.Parameters.indexOf("|",D+1);G.SourceHtml=S.Parameters.substring(D+1);G.CopyOperationId=null;const N=E.Na(1,E.Wb());N.pasteHtmlParameters=G;n.a(this.$.userOperationManager,(M,L,aa)=>w.g(E,"pasteHtmlContent",N,M,L,aa,null,64),M=>new z.a(204,0,M,1),null);this.Kmd++;e.ULS.sendTraceTag(523805135,0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - Number of pastes to workbook per Session ID:${this.Kmd.toString()}`)}}};this.Cei=(S,G)=>{if(S=G.BG)if(!G.parentPath||1>=G.parentPath.length||
G.parentPath[1]!==this.OLa)e.ULS.sendTraceTag(523805124,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - SessionID of received annotation does not match current Session ID.");else{e.ULS.sendTraceTag(523805123,0,50,"DataFromPictureManager.ImageToTableAnnotationHandler() - Annotation Received.");G=S.errorCode;switch(G){case null:case -1:this.errorMessage=u.a.instance.ga(2272);break;case 1:this.errorMessage=u.a.instance.ga(2273);break;case 2:this.errorMessage=u.a.instance.ga(2274)}0<this.errorMessage.length&&
e.ULS.sendTraceTag(523805122,0,10,`DataFromPictureManager.ImageToTableAnnotationHandler() - ErrorCode:${G?G.toString():"null"}.`);this.vte.stop();this.tableData=S.html;this.GVc&&(0<this.errorMessage.length?this.Q2f():0<this.tableData.length&&this.h3f())}else e.ULS.sendTraceTag(523805125,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - Received annotation is null.")};this.$=H;this.augmentationLoopManager=I;this.uploaderCreator=U;this.initialize()}dispose(){window.removeEventListener("message",
this.gKe,!1);this.augmentationLoopManager.unregister("DataFromPicture");super.dispose()}T_i(H,I){e.ULS.sendTraceTag(523805146,0,50,"DataFromPictureManager.onSuccessfulFileLoad - Start function.");let U=new Image;U.onload=()=>{var S=document.createElement("canvas");S.width=U.width;S.height=U.height;const G=S.getContext("2d");try{G.drawImage(U,0,0,U.width,U.height)}catch(N){e.ULS.sendTraceTag(523805145,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't draw to canvas. ex.Message: ${N.message}`);
return}let D;try{D=S.toDataURL("image/jpeg")}catch(N){e.ULS.sendTraceTag(523805144,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg. ex.Message: ${N.message}`);return}S=D.split(",");if(2>S.length)e.ULS.sendTraceTag(523805143,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg.");else{S=S[1];try{var E=window.self.atob(S)}catch(N){e.ULS.sendTraceTag(523805142,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't convert image to byte string. ex.Message: ${N.message}`);
return}28E5<E.length?(e.ULS.sendTraceTag(523805141,0,15,"DataFromPictureManager.onSuccessfulFileLoad - Image exceeds max size limit."),I.SIj()):(this.Orj(this.Sd,this.RT,S,U.width,U.height),URL.revokeObjectURL(U.src),U=null,e.ULS.sendTraceTag(523805140,0,50,"DataFromPictureManager.onSuccessfulFileLoad - End function."))}};U.src=H}q8i(H,I,U,S){this.Sd=H;this.RT=S;this.uploaderCreator.ohi(this.$,I,U,S,this)}Orj(H,I,U,S,G){this.OLa=f.a.create().toString();this.Kmd=0;this.uzb=U;this.imageWidth=S;this.imageHeight=
G;this.errorMessage=this.tableData="";this.GVc=!1;this.Vdg=this.$.Jb.zg("LoadResource","DataFromPictureTaskpaneLaunch");this.Vdg.start();this.B2i(H,I);this.vte=this.$.Jb.zg("LoadResource","DataFromPictureAnnotation");this.vte.start();this.Y2j()}Y2j(){if(this.uzb.length){var H=window.self.atob(this.uzb);var I=new Uint8Array(H.length);for(let U=0;U<H.length;U++)I[U]=H.charCodeAt(U);this.augmentationLoopManager.X2j(I,this.OLa,this.imageWidth,this.imageHeight)}else e.ULS.sendTraceTag(523805134,0,10,"DataFromPictureManager.UploadImageToAugmentationLoop - imageDataBase64 is empty")}B2i(H,
I){I.SessionID=this.OLa;I.DataFromPictureAssetId="FA000000050";I.LoadDataFromPictureTaskpane=!0;H=new m.a(-859308420,H.method,H.mode,H.Ve,H.tabName);this.$.Ia.Hb(H,I)}c$c(H){try{const I=c.from(H,"utf16le").toString("base64");return C.a.XHa(this.OLa,I)}catch(I){return e.ULS.sendTraceTag(523805133,0,10,"DataFromPictureManager.encodeAndEncrypt - Buffer can't encode message."),""}}Vjh(H){try{const I=C.a.XHa(this.OLa,H);return c.from(I,"base64").toString("utf16le")}catch(I){return e.ULS.sendTraceTag(523805132,
0,50,"DataFromPictureManager.decryptAndDecode - Buffer can't decode message."),""}}Fvj(){if(this.uzb.length){var H=k.a(this.$).Baa("FA000000050"),I={["DataFromPictureWildcard"]:"."};I.imageData=this.c$c(this.uzb);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(H,"onCustomMessage",I,U=>{U&&e.ULS.sendTraceTag(523805130,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed .")})}else e.ULS.sendTraceTag(523805131,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed no image Data.")}h3f(){if(this.tableData.length){var H=
k.a(this.$).Baa("FA000000050"),I={["DataFromPictureWildcard"]:"."};I.tableHtml=this.c$c(this.tableData);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(H,"onCustomMessage",I,U=>{U&&e.ULS.sendTraceTag(523805128,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed.")})}else e.ULS.sendTraceTag(523805129,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed, No Table Data.")}Q2f(){if(this.errorMessage.length){var H=
k.a(this.$).Baa("FA000000050"),I={["DataFromPictureWildcard"]:"."};I.errorMessage=this.c$c(this.errorMessage);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(H,"onCustomMessage",I,U=>{U&&e.ULS.sendTraceTag(523805126,0,10,"DataFromPictureManager.sendErrorMessageToTaskPane() - Attempted to send ErrorMessage to Pane - Failed .")})}else e.ULS.sendTraceTag(523805127,0,10,"DataFromPictureManager.sendErrorToTaskPane() - Attempted to send ErrorMessage to Pane - Failed, No valid error message.")}initialize(){window.addEventListener("message",
this.gKe,!1);this.augmentationLoopManager.register(this.augmentationLoopManager.a4a().Kdb("DataFromPicture").Hdb(()=>{}).activateAnnotation({annotationType:this.Dei,iz:!1,zV:this.Cei}).build())}}Object(b.a)(B,"DataFromPictureManager",l.a,[734])}).call(this,a(1327).Kog)},1327:function(r,F,a){(function(c){function b(){try{var G=new Uint8Array(1);G.__proto__={__proto__:Uint8Array.prototype,m9j:function(){return 42}};return"function"===typeof G.subarray&&0===G.subarray(1,1).byteLength}catch(D){return!1}}
function e(G,D){if((f.JO?2147483647:1073741823)<D)throw new RangeError("Invalid typed array length");f.JO?(G=new Uint8Array(D),G.__proto__=f.prototype):(null===G&&(G=new f(D)),G.length=D);return G}function f(G,D,E){if(!(f.JO||this instanceof f))return new f(G,D,E);if("number"===typeof G){if("string"===typeof D)throw Error("If encoding is specified then the first argument must be a string");return l(this,G)}return d(this,G,D,E)}function d(G,D,E,N){if("number"===typeof D)throw new TypeError('"value" argument must not be a number');
if("undefined"!==typeof ArrayBuffer&&D instanceof ArrayBuffer){D.byteLength;if(0>E||D.byteLength<E)throw new RangeError("'offset' is out of bounds");if(D.byteLength<E+(N||0))throw new RangeError("'length' is out of bounds");D=void 0===E&&void 0===N?new Uint8Array(D):void 0===N?new Uint8Array(D,E):new Uint8Array(D,E,N);f.JO?(G=D,G.__proto__=f.prototype):G=k(G,D);D=G}else if("string"===typeof D){N=G;G=E;if("string"!==typeof G||""===G)G="utf8";if(!f.iif(G))throw new TypeError('"encoding" must be a valid string encoding');
E=z(D,G)|0;N=e(N,E);D=N.write(D,G);D!==E&&(N=N.slice(0,D));D=N}else D=t(G,D);return D}function h(G){if("number"!==typeof G)throw new TypeError('"size" argument must be a number');if(0>G)throw new RangeError('"size" argument must not be negative');}function l(G,D){h(D);G=e(G,0>D?0:n(D)|0);if(!f.JO)for(var E=0;E<D;++E)G[E]=0;return G}function k(G,D){var E=0>D.length?0:n(D.length)|0;G=e(G,E);for(var N=0;N<E;N+=1)G[N]=D[N]&255;return G}function t(G,D){if(f.isBuffer(D)){var E=n(D.length)|0;G=e(G,E);if(0===
G.length)return G;D.copy(G,0,0,E);return G}if(D){if("undefined"!==typeof ArrayBuffer&&D.buffer instanceof ArrayBuffer||"length"in D)return(E="number"!==typeof D.length)||(E=D.length,E=E!==E),E?e(G,0):k(G,D);if("Buffer"===D.type&&I(D.data))return k(G,D.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");}function n(G){if(G>=(f.JO?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(f.JO?2147483647:
1073741823).toString(16)+" bytes");return G|0}function z(G,D){if(f.isBuffer(G))return G.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(G)||G instanceof ArrayBuffer))return G.byteLength;"string"!==typeof G&&(G=""+G);var E=G.length;if(0===E)return 0;for(var N=!1;;)switch(D){case "ascii":case "latin1":case "binary":return E;case "utf8":case "utf-8":case void 0:return v(G).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*
E;case "hex":return E>>>1;case "base64":return x(G).length;default:if(N)return v(G).length;D=(""+D).toLowerCase();N=!0}}function w(G,D,E){var N=!1;if(void 0===D||0>D)D=0;if(D>this.length)return"";if(void 0===E||E>this.length)E=this.length;if(0>=E)return"";E>>>=0;D>>>=0;if(E<=D)return"";for(G||(G="utf8");;)switch(G){case "hex":G=D;D=E;E=this.length;if(!G||0>G)G=0;if(!D||0>D||D>E)D=E;N="";for(E=G;E<D;++E)G=N,N=this[E],N=16>N?"0"+N.toString(16):N.toString(16),N=G+N;return N;case "utf8":case "utf-8":return y(this,
D,E);case "ascii":G="";for(E=Math.min(this.length,E);D<E;++D)G+=String.fromCharCode(this[D]&127);return G;case "latin1":case "binary":G="";for(E=Math.min(this.length,E);D<E;++D)G+=String.fromCharCode(this[D]);return G;case "base64":return 0===D&&E===this.length?H.TZe(this):H.TZe(this.slice(D,E));case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":D=this.slice(D,E);E="";for(G=0;G<D.length;G+=2)E+=String.fromCharCode(D[G]+256*D[G+1]);return E;default:if(N)throw new TypeError("Unknown encoding: "+
G);G=(G+"").toLowerCase();N=!0}}function m(G,D,E,N,M){if(0===G.length)return-1;"string"===typeof E?(N=E,E=0):2147483647<E?E=2147483647:-2147483648>E&&(E=-2147483648);E=+E;isNaN(E)&&(E=M?0:G.length-1);0>E&&(E=G.length+E);if(E>=G.length){if(M)return-1;E=G.length-1}else if(0>E)if(M)E=0;else return-1;"string"===typeof D&&(D=f.from(D,N));if(f.isBuffer(D))return 0===D.length?-1:u(G,D,E,N,M);if("number"===typeof D)return D&=255,f.JO&&"function"===typeof Uint8Array.prototype.indexOf?M?Uint8Array.prototype.indexOf.call(G,
D,E):Uint8Array.prototype.lastIndexOf.call(G,D,E):u(G,[D],E,N,M);throw new TypeError("val must be string, number or Buffer");}function u(G,D,E,N,M){function L(ba,Y){return 1===aa?ba[Y]:ba.Ddj(Y*aa)}var aa=1,V=G.length,P=D.length;if(void 0!==N&&(N=String(N).toLowerCase(),"ucs2"===N||"ucs-2"===N||"utf16le"===N||"utf-16le"===N)){if(2>G.length||2>D.length)return-1;aa=2;V/=2;P/=2;E/=2}if(M)for(N=-1;E<V;E++)if(L(G,E)===L(D,-1===N?0:E-N)){if(-1===N&&(N=E),E-N+1===P)return N*aa}else-1!==N&&(E-=E-N),N=-1;
else for(E+P>V&&(E=V-P);0<=E;E--){V=!0;for(N=0;N<P;N++)if(L(G,E+N)!==L(D,N)){V=!1;break}if(V)return E}return-1}function y(G,D,E){E=Math.min(G.length,E);for(var N=[];D<E;){var M=G[D],L=null,aa=239<M?4:223<M?3:191<M?2:1;if(D+aa<=E)switch(aa){case 1:128>M&&(L=M);break;case 2:var V=G[D+1];128===(V&192)&&(M=(M&31)<<6|V&63,127<M&&(L=M));break;case 3:V=G[D+1];var P=G[D+2];128===(V&192)&&128===(P&192)&&(M=(M&15)<<12|(V&63)<<6|P&63,2047<M&&(55296>M||57343<M)&&(L=M));break;case 4:V=G[D+1];P=G[D+2];var ba=G[D+
3];128===(V&192)&&128===(P&192)&&128===(ba&192)&&(M=(M&15)<<18|(V&63)<<12|(P&63)<<6|ba&63,65535<M&&1114112>M&&(L=M))}null===L?(L=65533,aa=1):65535<L&&(L-=65536,N.push(L>>>10&1023|55296),L=56320|L&1023);N.push(L);D+=aa}G=N.length;if(G<=U)N=String.fromCharCode.apply(String,N);else{E="";for(D=0;D<G;)E+=String.fromCharCode.apply(String,N.slice(D,D+=U));N=E}return N}function v(G,D){D=D||Infinity;for(var E,N=G.length,M=null,L=[],aa=0;aa<N;++aa){E=G.charCodeAt(aa);if(55295<E&&57344>E){if(!M){if(56319<E){-1<
(D-=3)&&L.push(239,191,189);continue}else if(aa+1===N){-1<(D-=3)&&L.push(239,191,189);continue}M=E;continue}if(56320>E){-1<(D-=3)&&L.push(239,191,189);M=E;continue}E=(M-55296<<10|E-56320)+65536}else M&&-1<(D-=3)&&L.push(239,191,189);M=null;if(128>E){if(0>--D)break;L.push(E)}else if(2048>E){if(0>(D-=2))break;L.push(E>>6|192,E&63|128)}else if(65536>E){if(0>(D-=3))break;L.push(E>>12|224,E>>6&63|128,E&63|128)}else if(1114112>E){if(0>(D-=4))break;L.push(E>>18|240,E>>12&63|128,E>>6&63|128,E&63|128)}else throw Error("Invalid code point");
}return L}function C(G){for(var D=[],E=0;E<G.length;++E)D.push(G.charCodeAt(E)&255);return D}function x(G){var D=H,E=D.tTj;G=(G.trim?G.trim():G.replace(/^\s+|\s+$/g,"")).replace(S,"");if(2>G.length)G="";else for(;0!==G.length%4;)G+="=";return E.call(D,G)}function B(G,D,E,N){for(var M=0;M<N&&!(M+E>=D.length||M>=G.length);++M)D[M+E]=G[M];return M}var H=a(1329);a(1330);var I=a(1331);F.Kog=f;F.F8j=function(G){+G!=G&&(G=0);return f.Pse(+G)};F.m8j=50;f.JO=void 0!==c.JO?c.JO:b();F.w9j=f.JO?2147483647:1073741823;
f.from=function(G,D,E){return d(null,G,D,E)};f.JO&&(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0}));f.Pse=function(G){h(G);return e(null,G)};f.QQg=function(G){return l(null,G)};f.isBuffer=function(G){return!(null==G||!G.Ryg)};f.compare=function(G,D){if(!f.isBuffer(G)||!f.isBuffer(D))throw new TypeError("Arguments must be Buffers");if(G===D)return 0;
for(var E=G.length,N=D.length,M=0,L=Math.min(E,N);M<L;++M)if(G[M]!==D[M]){E=G[M];N=D[M];break}return E<N?-1:N<E?1:0};f.iif=function(G){switch(String(G).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};f.concat=function(G,D){if(!I(G))throw new TypeError('"list" argument must be an Array of Buffers');if(0===G.length)return f.Pse(0);var E;if(void 0===D)for(E=D=
0;E<G.length;++E)D+=G[E].length;D=f.QQg(D);var N=0;for(E=0;E<G.length;++E){var M=G[E];if(!f.isBuffer(M))throw new TypeError('"list" argument must be an Array of Buffers');M.copy(D,N);N+=M.length}return D};f.byteLength=z;f.prototype.Ryg=!0;f.prototype.toString=function(){var G=this.length|0;return 0===G?"":0===arguments.length?y(this,0,G):w.apply(this,arguments)};f.prototype.equals=function(G){if(!f.isBuffer(G))throw new TypeError("Argument must be a Buffer");return this===G?!0:0===f.compare(this,
G)};f.prototype.compare=function(G,D,E,N,M){if(!f.isBuffer(G))throw new TypeError("Argument must be a Buffer");void 0===D&&(D=0);void 0===E&&(E=G?G.length:0);void 0===N&&(N=0);void 0===M&&(M=this.length);if(0>D||E>G.length||0>N||M>this.length)throw new RangeError("out of range index");if(N>=M&&D>=E)return 0;if(N>=M)return-1;if(D>=E)return 1;D>>>=0;E>>>=0;N>>>=0;M>>>=0;if(this===G)return 0;var L=M-N,aa=E-D,V=Math.min(L,aa);N=this.slice(N,M);G=G.slice(D,E);for(D=0;D<V;++D)if(N[D]!==G[D]){L=N[D];aa=
G[D];break}return L<aa?-1:aa<L?1:0};f.prototype.includes=function(G,D,E){return-1!==this.indexOf(G,D,E)};f.prototype.indexOf=function(G,D,E){return m(this,G,D,E,!0)};f.prototype.lastIndexOf=function(G,D,E){return m(this,G,D,E,!1)};f.prototype.write=function(G,D,E,N){if(void 0===D)N="utf8",E=this.length,D=0;else if(void 0===E&&"string"===typeof D)N=D,E=this.length,D=0;else if(isFinite(D))D|=0,isFinite(E)?(E|=0,void 0===N&&(N="utf8")):(N=E,E=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");
var M=this.length-D;if(void 0===E||E>M)E=M;if(0<G.length&&(0>E||0>D)||D>this.length)throw new RangeError("Attempt to write outside buffer bounds");N||(N="utf8");for(M=!1;;)switch(N){case "hex":D=Number(D)||0;N=this.length-D;E?(E=Number(E),E>N&&(E=N)):E=N;N=G.length;if(0!==N%2)throw new TypeError("Invalid hex string");E>N/2&&(E=N/2);for(N=0;N<E;++N){M=parseInt(G.substr(2*N,2),16);if(isNaN(M))break;this[D+N]=M}return N;case "utf8":case "utf-8":return B(v(G,this.length-D),this,D,E);case "ascii":return B(C(G),
this,D,E);case "latin1":case "binary":return B(C(G),this,D,E);case "base64":return B(x(G),this,D,E);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":N=G;M=this.length-D;for(var L=[],aa=0;aa<N.length&&!(0>(M-=2));++aa){var V=N.charCodeAt(aa);G=V>>8;V%=256;L.push(V);L.push(G)}return B(L,this,D,E);default:if(M)throw new TypeError("Unknown encoding: "+N);N=(""+N).toLowerCase();M=!0}};f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this.K8j||this,0)}};var U=4096;
f.prototype.slice=function(G,D){var E=this.length;G=~~G;D=void 0===D?E:~~D;0>G?(G+=E,0>G&&(G=0)):G>E&&(G=E);0>D?(D+=E,0>D&&(D=0)):D>E&&(D=E);D<G&&(D=G);if(f.JO)D=this.subarray(G,D),D.__proto__=f.prototype;else{E=D-G;D=new f(E,void 0);for(var N=0;N<E;++N)D[N]=this[N+G]}return D};f.prototype.Ddj=function(G){if(0!==G%1||0>G)throw new RangeError("offset is not uint");if(G+2>this.length)throw new RangeError("Trying to access beyond buffer length");return this[G]<<8|this[G+1]};f.prototype.copy=function(G,
D,E,N){E||(E=0);N||0===N||(N=this.length);D>=G.length&&(D=G.length);D||(D=0);0<N&&N<E&&(N=E);if(N===E||0===G.length||0===this.length)return 0;if(0>D)throw new RangeError("targetStart out of bounds");if(0>E||E>=this.length)throw new RangeError("sourceStart out of bounds");if(0>N)throw new RangeError("sourceEnd out of bounds");N>this.length&&(N=this.length);G.length-D<N-E&&(N=G.length-D+E);var M=N-E;if(this===G&&E<D&&D<N)for(N=M-1;0<=N;--N)G[N+D]=this[N+E];else if(1E3>M||!f.JO)for(N=0;N<M;++N)G[N+D]=
this[N+E];else Uint8Array.prototype.set.call(G,this.subarray(E,E+M),D);return M};f.prototype.fill=function(G,D,E,N){if("string"===typeof G){"string"===typeof D?(N=D,D=0,E=this.length):"string"===typeof E&&(N=E,E=this.length);if(1===G.length){var M=G.charCodeAt(0);256>M&&(G=M)}if(void 0!==N&&"string"!==typeof N)throw new TypeError("encoding must be a string");if("string"===typeof N&&!f.iif(N))throw new TypeError("Unknown encoding: "+N);}else"number"===typeof G&&(G&=255);if(0>D||this.length<D||this.length<
E)throw new RangeError("Out of range index");if(E<=D)return this;D>>>=0;E=void 0===E?this.length:E>>>0;G||(G=0);if("number"===typeof G)for(N=D;N<E;++N)this[N]=G;else for(G=f.isBuffer(G)?G:v((new f(G,N)).toString()),M=G.length,N=0;N<E-D;++N)this[N+D]=G[N%M];return this};var S=/[^+\/0-9A-Za-z-_]/g}).call(this,a(1328))},1328:function(r){var F=function(){return this}();try{F=F||(new Function("return this"))()}catch(a){"object"===typeof window&&(F=window)}r.exports=F},1329:function(r,F){function a(f){var d=
f.length;if(0<d%4)throw Error("Invalid string. Length must be a multiple of 4");f=f.indexOf("=");-1===f&&(f=d);return[f,f===d?0:4-f%4]}F.byteLength=function(f){f=a(f);var d=f[1];return 3*(f[0]+d)/4-d};F.tTj=function(f){var d=a(f);var h=d[0];d=d[1];var l=new e(3*(h+d)/4-d),k=0,t=0<d?h-4:h,n;for(n=0;n<t;n+=4)h=b[f.charCodeAt(n)]<<18|b[f.charCodeAt(n+1)]<<12|b[f.charCodeAt(n+2)]<<6|b[f.charCodeAt(n+3)],l[k++]=h>>16&255,l[k++]=h>>8&255,l[k++]=h&255;2===d&&(h=b[f.charCodeAt(n)]<<2|b[f.charCodeAt(n+1)]>>
4,l[k++]=h&255);1===d&&(h=b[f.charCodeAt(n)]<<10|b[f.charCodeAt(n+1)]<<4|b[f.charCodeAt(n+2)]>>2,l[k++]=h>>8&255,l[k++]=h&255);return l};F.TZe=function(f){for(var d=f.length,h=d%3,l=[],k=0,t=d-h;k<t;k+=16383){for(var n=l,z=n.push,w,m=f,u=k+16383>t?t:k+16383,y=[],v=k;v<u;v+=3)w=(m[v]<<16&16711680)+(m[v+1]<<8&65280)+(m[v+2]&255),y.push(c[w>>18&63]+c[w>>12&63]+c[w>>6&63]+c[w&63]);w=y.join("");z.call(n,w)}1===h?(f=f[d-1],l.push(c[f>>2]+c[f<<4&63]+"==")):2===h&&(f=(f[d-2]<<8)+f[d-1],l.push(c[f>>10]+c[f>>
4&63]+c[f<<2&63]+"="));return l.join("")};var c=[],b=[],e="undefined"!==typeof Uint8Array?Uint8Array:Array;for(r=0;64>r;++r)c[r]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[r],b["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(r)]=r;b[45]=62;b[95]=63},1330:function(r,F){F.read=function(a,c,b,e,f){var d=8*f-e-1;var h=(1<<d)-1,l=h>>1,k=-7;f=b?f-1:0;var t=b?-1:1,n=a[c+f];f+=t;b=n&(1<<-k)-1;n>>=-k;for(k+=d;0<k;b=256*b+a[c+f],f+=t,k-=8);d=b&(1<<-k)-1;
b>>=-k;for(k+=e;0<k;d=256*d+a[c+f],f+=t,k-=8);if(0===b)b=1-l;else{if(b===h)return d?NaN:Infinity*(n?-1:1);d+=Math.pow(2,e);b-=l}return(n?-1:1)*d*Math.pow(2,b-e)};F.write=function(a,c,b,e,f,d){var h,l=8*d-f-1,k=(1<<l)-1,t=k>>1,n=23===f?Math.pow(2,-24)-Math.pow(2,-77):0;d=e?0:d-1;var z=e?1:-1,w=0>c||0===c&&0>1/c?1:0;c=Math.abs(c);isNaN(c)||Infinity===c?(c=isNaN(c)?1:0,e=k):(e=Math.floor(Math.log(c)/Math.LN2),1>c*(h=Math.pow(2,-e))&&(e--,h*=2),c=1<=e+t?c+n/h:c+n*Math.pow(2,1-t),2<=c*h&&(e++,h/=2),e+
t>=k?(c=0,e=k):1<=e+t?(c=(c*h-1)*Math.pow(2,f),e+=t):(c=c*Math.pow(2,t-1)*Math.pow(2,f),e=0));for(;8<=f;a[b+d]=c&255,d+=z,c/=256,f-=8);e=e<<f|c;for(l+=f;0<l;a[b+d]=e&255,d+=z,e/=256,l-=8);a[b+d-z]|=128*w}},1331:function(r){var F={}.toString;r.exports=Array.isArray||function(a){return"[object Array]"==F.call(a)}},1332:function(r,F,a){a.d(F,"a",function(){return b});r=a(0);F=a(736);var c=a(713);class b extends F.a{constructor(){super();this.html=this.errorDescription=this.errorCode=null;this.H_=Object.assign(new c.a,
{T_:b.getTypeName(),B_:b.Kd()})}static getTypeName(){return"AugLoop_ImageToTable_DetectedHtmlTableAnnotation"}static Kd(){return["AugLoop_Core_Annotation"]}}Object(r.a)(b,"DetectedHtmlTableAnnotation",F.a,[])},1333:function(r,F,a){a.d(F,"a",function(){return c});r=a(0);class c{static XHa(b,e){if(!(b&&e&&b.length&&e.length)||256<b.length)return"";const f=Array(256),d=Array(256);let h,l=0,k=0;let t,n="";for(h=0;256>h;h++)f[h]=h;for(h=0;256>h;h++){var z=b.charCodeAt(h%b.length);if(256<=z)return"";l=
(l+f[h]+z)%256;z=f[h];f[h]=f[l];f[l]=z}for(h=0;256>h;h++)d[h]=f[256-h-1];l=h=0;for(b=0;b<e.length;b++){h=(h+1)%256;l=(l+f[h])%256;z=f[h];f[h]=f[l];f[l]=z;z=e.charCodeAt(b);if(256<=z)return"";t=z^f[(f[h]+f[l])%256];k=(k+d[h])%256;z=d[h];d[h]=d[k];d[k]=z;n+=String.fromCharCode(t^f[(d[h]+d[k])%256])}return n}}Object(r.a)(c,"RC4A",null,[])},1335:function(r,F,a){a.d(F,"a",function(){return b});r=a(0);a(15);var c=a(4);class b{constructor(e,f,d,h){this.elb=e;c.AFrameworkApplication.fa.pa("AddInCommandsMissingTabIsEnabled")&&
d.QYh();this.ix=f;this.RDg=h}get bFb(){return this.elb}get solutionId(){return this.ix}get WTd(){return this.RDg}pKa(e){e=this.bFb+this.solutionId+e;return this.WTd?(e in b.n0b||(b.n0b[e]="AddinControl"+b.BPg++),b.n0b[e]):e}aKe(e){if(this.WTd){const d=b.n0b;for(let h in d){var f=h;if(e===d[h])return f.substr(this.bFb.length+this.solutionId.length)}}return e}f8e(e){e=this.bFb+this.solutionId+e;return this.WTd?(e in b.gYc||(b.gYc[e]="AddinTab"+b.MPg++),b.gYc[e]):e}}b.n0b={};b.gYc={};b.MPg=0;b.BPg=0;
Object(r.a)(b,"DefaultRibbonNamingProvider",null,[834])},1343:function(r,F,a){a.d(F,"a",function(){return c});r=a(0);var c;(function(b){b[b.myAddins=0]="myAddins";b[b.adminManaged=1]="adminManaged";b[b.popular=2]="popular"})(c||(c={}));Object(r.b)("AddinCollectionType",c)},1390:function(r,F,a){a.r(F);r=a(0);var c=a(15),b=a(84),e;(function(w){w[w.none=0]="none";w[w.testEvent=1]="testEvent";w[w.test1Event=2]="test1Event";w[w.worksheetDataChangedEvent=10]="worksheetDataChangedEvent";w[w.worksheetActivatedEvent=
11]="worksheetActivatedEvent";w[w.worksheetDeactivatedEvent=12]="worksheetDeactivatedEvent";w[w.worksheetAddedEvent=13]="worksheetAddedEvent";w[w.worksheetSelectionChangedEvent=14]="worksheetSelectionChangedEvent";w[w.worksheetDeletedEvent=15]="worksheetDeletedEvent";w[w.worksheetCalculatedEvent=16]="worksheetCalculatedEvent";w[w.worksheetFilteredEvent=17]="worksheetFilteredEvent";w[w.worksheetFormatChangedEvent=18]="worksheetFormatChangedEvent";w[w.worksheetRowSortedEvent=19]="worksheetRowSortedEvent";
w[w.worksheetColumnSortedEvent=20]="worksheetColumnSortedEvent";w[w.worksheetSingleClickedEvent=21]="worksheetSingleClickedEvent";w[w.worksheetRowHiddenChangedEvent=22]="worksheetRowHiddenChangedEvent";w[w.worksheetFormulaChangedEvent=23]="worksheetFormulaChangedEvent";w[w.worksheetProtectionChangedEvent=24]="worksheetProtectionChangedEvent";w[w.worksheetNameChangedEvent=25]="worksheetNameChangedEvent";w[w.worksheetVisibilityChangedEvent=26]="worksheetVisibilityChangedEvent";w[w.worksheetMovedEvent=
27]="worksheetMovedEvent";w[w.worksheetNavigationObjectChangedEvent=28]="worksheetNavigationObjectChangedEvent";w[w.worksheetRowHeightChangedEvent=29]="worksheetRowHeightChangedEvent";w[w.workbookFormulaReferenceStyleChangedEvent=30]="workbookFormulaReferenceStyleChangedEvent";w[w.chartAddedEvent=50]="chartAddedEvent";w[w.chartActivatedEvent=51]="chartActivatedEvent";w[w.chartDeactivatedEvent=52]="chartDeactivatedEvent";w[w.chartDeletedEvent=53]="chartDeletedEvent";w[w.tableSelectionChangedEvent=
100]="tableSelectionChangedEvent";w[w.tableDataChangedEvent=101]="tableDataChangedEvent";w[w.tableAddedEvent=102]="tableAddedEvent";w[w.tableDeletedEvent=103]="tableDeletedEvent";w[w.tableFilteredEvent=104]="tableFilteredEvent";w[w.agaveVisualUpdateEvent=150]="agaveVisualUpdateEvent";w[w.customFunctionExecutionBeginEvent=200]="customFunctionExecutionBeginEvent";w[w.customFunctionExecutionEndEvent=201]="customFunctionExecutionEndEvent";w[w.commentAddedEvent=250]="commentAddedEvent";w[w.commentDeletedEvent=
251]="commentDeletedEvent";w[w.commentChangedEvent=252]="commentChangedEvent";w[w.invocationMessage=1E3]="invocationMessage";w[w.cancellationMessage=1001]="cancellationMessage";w[w.metadataMessage=1002]="metadataMessage";w[w.visualSelectionChangedEvent=2E3]="visualSelectionChangedEvent";w[w.visualChangeEvent=2001]="visualChangeEvent";w[w.visualTrackerModelChangedEvent=2002]="visualTrackerModelChangedEvent";w[w.shapeSelectionChangedEvent=2100]="shapeSelectionChangedEvent";w[w.shapeActivatedEvent=2101]=
"shapeActivatedEvent";w[w.shapeDeactivatedEvent=2102]="shapeDeactivatedEvent";w[w.shapeAddedEvent=2103]="shapeAddedEvent";w[w.shapeDeletedEvent=2104]="shapeDeletedEvent";w[w.workbookAutoSaveSettingChangedEvent=2200]="workbookAutoSaveSettingChangedEvent";w[w.wacOperationEvent=2201]="wacOperationEvent";w[w.recordingStateChangedEvent=2202]="recordingStateChangedEvent";w[w.workbookActivatedEvent=2203]="workbookActivatedEvent";w[w.workbookNavigationObjectChangedEvent=2204]="workbookNavigationObjectChangedEvent";
w[w.ribbonCommandExecutedEvent=2300]="ribbonCommandExecutedEvent";w[w.linkedDataTypeRefreshRequestCompletedEvent=2500]="linkedDataTypeRefreshRequestCompletedEvent";w[w.linkedDataTypeRefreshModeChangedEvent=2501]="linkedDataTypeRefreshModeChangedEvent";w[w.linkedDataTypeLinkedDataTypeAddedEvent=2502]="linkedDataTypeLinkedDataTypeAddedEvent";w[w.linkedWorkbookWorkbookLinksChangedEvent=2600]="linkedWorkbookWorkbookLinksChangedEvent";w[w.linkedWorkbookRefreshCompletedEvent=2601]="linkedWorkbookRefreshCompletedEvent";
w[w.rangePickerSelectionChangedEvent=2700]="rangePickerSelectionChangedEvent";w[w.rangePickerDeactivatedEvent=2701]="rangePickerDeactivatedEvent";w[w.lineageActivityUpdateAvailableEvent=2800]="lineageActivityUpdateAvailableEvent";w[w.lineageActivityFilterUpdatedEvent=2801]="lineageActivityFilterUpdatedEvent";w[w.lineageActivityLoadCompletedEvent=2802]="lineageActivityLoadCompletedEvent";w[w.pivotTableAddedEvent=2900]="pivotTableAddedEvent";w[w.pivotTableDeletedEvent=2901]="pivotTableDeletedEvent";
w[w.namedItemAddedEvent=3E3]="namedItemAddedEvent";w[w.namedItemDeletedEvent=3001]="namedItemDeletedEvent";w[w.guidedReapplyManagerUpdateAvailableEvent=3100]="guidedReapplyManagerUpdateAvailableEvent";w[w.vbaRecorderRecordingChangedEvent=3200]="vbaRecorderRecordingChangedEvent";w[w.externalCodeServiceDiagnosticsNewEntryEvent=3300]="externalCodeServiceDiagnosticsNewEntryEvent";w[w.externalCodeServiceDiagnosticsFilterUpdatedEvent=3301]="externalCodeServiceDiagnosticsFilterUpdatedEvent";w[w.rangeValuesPreviewDismissedEvent=
3400]="rangeValuesPreviewDismissedEvent";w[w.appRuntimeVisibilityChangedEvent=65539]="appRuntimeVisibilityChangedEvent";w[w.beforeCloseNotifiactionCancelledEvent=65540]="beforeCloseNotifiactionCancelledEvent";w[w.augmentationLoopAnnotationAddedEvent=65541]="augmentationLoopAnnotationAddedEvent"})(e||(e={}));Object(r.b)("MessageType",e);var f=a(776),d=a(252),h=a(749),l=a(59),k=a(37),t=a(158),n=a(1);a.d(F,"DdaEventDispatch",function(){return z});class z{constructor(w){this.DA=null;this.Qfg={};this.Sfg=
{};this.Rcd={};this.gBd={};this.Tkd=(m,u)=>{m=this.$.Jb.Gc("Task","DdaEventDispatch.HandleServerEvent");u=u.o3f;for(let x=0;x<u.length;x++)switch(u[x].EventType){case 2:var y=u[x],v={};v.Name=y.Name;v.BindingType=y.BindingType;v.ColCount=y.ColCount;v.RowCount=y.RowCount;this.Rva(y.InstanceId,OSF.DDA.EventDispId.dispidBindingDataChangedEvent,v,null);break;case 4:this.Rva(u[x].InstanceId,OSF.DDA.EventDispId.dispidSettingsChangedEvent,null,null);break;case 8:if(y=u[x],y.InstanceId){v=Array(y.Entries.length);
for(var C=0;C<y.Entries.length;C++)v[C]=z.odc(y.Entries[C],y.IsRemoteOverride);0<y.Entries.length&&1===y.Entries[0].Category?this.E9i(y.InstanceId,v):y.InstanceId&&this.Rva(y.InstanceId,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,v)}else{this.Rcd={};this.gBd={};for(v=0;v<y.Entries.length;v++)this.MMe(y.Entries[v],y.IsRemoteOverride);y=JSON.stringify(this.Rcd);v=JSON.stringify(this.gBd);C=JSON.stringify(this.Qfg);const B=JSON.stringify(this.Sfg);c.ULS.sendTraceTag(537170593,0,50,`Number of Fired event: ${y}, Number of Not Fired event: ${v}, Total Number of Fired event: ${C}, Total Number of Not Fired event: ${B}`)}}m.stop()};
this.NLb=(m,u)=>{this.Rva(m,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,u)};this.$=w;this.Ixc=this.Tkd}U_b(w){w&&(this.zia(),this.DA.push(w))}Suc(w){this.DA&&(Array.remove(this.DA,w),this.DA.length||(this.$.wantServerEvents=!1,this.$.Glj(this.Ixc),this.DA=null))}E9i(w,m){const u=Object(b.a)(h.DdaFacade,d.a(this.$));k.TaskExtensions.za(u.o_h(w),y=>{if(t.b(y)){var v=y.result;y=u.pn(v);if(v)if(y.Uic)this.Rva(v,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,m);else if(y.V6b)for(v=0;v<m.length;v++)y.V6b.push(m[v]);
else y.V6b=m}else y.Hf?c.ULS.sendTraceTag(537170591,0,10,"DdaEventDispatch.HandleServerEvent: Failed to get or create Custom Functions sandbox."):y.kh&&c.ULS.sendTraceTag(537170590,0,10,"DdaEventDispatch.HandleServerEvent: Getting or creating Custom Functions sandbox is cancelled.")},this.$.la,0)}b$i(w,m){const u=Object(b.a)(h.DdaFacade,d.a(this.$)),y=u.kOh(w);y?OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(y,m,this.NLb):u.Yah(w,m)}MMe(w,m){let u=!1;const y=parseInt(w.Type,
10);var v=w.Target;const C=Object(b.a)(h.DdaFacade,d.a(this.$));if((v=C.Zh.t_h(y,v))&&0<Object.keys(v).length){u=!0;for(let B in v)if(v=B,C.Zh.h1b(v)){const H=Array(1);H[0]=z.odc(w,m);if(n.EwaSettings.isChangeGateEnabled("OfficeVSO:5379862_RichApiEventsTriggerSource")){var x=H[0][3];if(void 0!==x&&null!==x&&(x=Object(b.a)(Object,l.a.Xh(x)))&&void 0!==x.triggerControlId&&null!==x.triggerControlId&&void 0!==x.triggerSource&&null!==x.triggerSource){let I=!1;m?(x.triggerSource="Unknown",I=!0):C.Eoh(x.triggerControlId,
v)&&(x.triggerSource="ThisLocalAddin",I=!0);I&&(H[0][3]=l.a.Dc(x))}}this.Rva(v,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,H)}}u?(this.Yfc(e[y],this.Rcd),this.Yfc(e[y],this.Qfg)):(this.Yfc(e[y],this.gBd),this.Yfc(e[y],this.Sfg))}zia(){this.DA||(this.DA=[],this.$.Jre(this.Ixc),this.$.wantServerEvents=!0)}Yfc(w,m){w in m||(m[w]=0);m[w]+=1}GJ(w,m,u){const y={};y.Target=m;y.Category=65536;y.Type=w;y.Message=u;y.Id=-1;this.MMe(y,!1)}aIh(w,m){const u={Target:"",Category:2,Type:1E3};u.Message=m;u.Id=
0;m=Array(1);m[0]=z.odc(u,!1);this.b$i(w,m)}pac(w,m,u,y){const v={};v.Target=u;v.Category=65536;v.Type=m;v.Message=y;v.Id=-1;m=Array(1);m[0]=z.odc(v,!1);this.Rva(w,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,m)}$Hh(w,m){this.Rva(w,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,m)}Rva(w,m,u,y){if(this.DA){var v=Object(b.a)(h.DdaFacade,d.a(this.$));if(!v||m!==OSF.DDA.EventDispId.dispidBindingDataChangedEvent&&m!==OSF.DDA.EventDispId.dispidSettingsChangedEvent||v.Zh.h1b(w)){w=new f.a(m,w,
u,y);for(let C=0,x=this.DA.length;C<x;C++)(m=this.DA[C])&&m(w)}}}static odc(w,m){const u=Array(6);u[0]=w.Category;u[1]=w.Type;u[2]=w.Target;u[3]=w.Message;u[4]=w.Id;u[5]=m;return u}}Object(r.a)(z,"DdaEventDispatch",null,[])},1419:function(r,F,a){a.d(F,"a",function(){return b});r=a(0);F=a(150);var c=a(88);class b extends F.a{constructor(){super(void 0,void 0,void 0,!0);this.oDa="AddinCommandsUILessDialog";this.EUc="WACDialogTitleText";this.pX="0";this.iG=380;this.n1=190;this.pe=this.oDa;this.Ob=5;
this.Uug=String.format("{0}px",this.iG);this.oX=String.format("{0}px",this.n1);this.Eaf=this.pt=!1;this.Iw()}Iw(){super.Iw();this.Mh.style.width=this.Uug;this.Mh.style.height=this.oX;this.Mh.style.padding=this.pX}ry(e){this.CD();document.getElementById(this.Fh(this.EUc)).innerText=e}CD(){super.CD();this.lb.style.width=String.format("{0}px",this.iG);this.lb.style.height=String.format("{0}px",this.n1);this.lb.removeAttribute(c.a.Cd);this.lb.removeAttribute(c.a.ZL)}hide(){this.gzb()}get Z$(){return this.Mh}initializeAndShowWithTitle(){this.initializeAndShow(CommonUIStrings.l_NotificationUITitle,
null,null)}}Object(r.a)(b,"AddinCommandsUILessDialog",F.a,[868])},1451:function(r,F,a){a.r(F);var c=a(512),b=a(973),e=a(1210),f=a(9),d=a(0),h=a(226),l=a(192),k=a(591);class t{constructor(){this.thb=null}get HVg(){this.thb||(this.thb=new l.a,this.thb.add(12),this.thb.add(11));return this.thb}hmi(J){return this.HVg.contains(J.operation)}UXj(J){const Ia=[],Db=J.payload;for(const cc of Db.batchedOperations)Ia.push(new k.a(J.operation,cc));return Ia}}Object(d.a)(t,"MacroRecorderBatchedEventList",null,
[]);var n=a(15),z=a(59),w=a(123),m=a(648);class u{equals(J,Ia){return J===Ia}getHashCode(J){return J}zja(J){return J}}Object(d.a)(u,"UserOperationNameComparer",null,[21,22]);class y{static C7h(){y.Oc||(y.Oc=new m.a(new u),y.Oc.add(507),y.Oc.add(10),y.Oc.add(576),y.Oc.add(563),y.Oc.add(564),y.Oc.add(565),y.Oc.add(566),y.Oc.add(567),y.Oc.add(568),y.Oc.add(569),y.Oc.add(570),y.Oc.add(571),y.Oc.add(572),y.Oc.add(573),y.Oc.add(574),y.Oc.add(575),y.Oc.add(501),y.Oc.add(520),y.Oc.add(1),y.Oc.add(1002),y.Oc.add(129),
y.Oc.add(198),y.Oc.add(500),y.Oc.add(519),y.Oc.add(538),y.Oc.add(1E3),y.Oc.add(1003),y.Oc.add(144),y.Oc.add(502),y.Oc.add(505),y.Oc.add(179),y.Oc.add(205),y.Oc.add(134),y.Oc.add(230),y.Oc.add(103),y.Oc.add(110),y.Oc.add(112),y.Oc.add(113),y.Oc.add(124),y.Oc.add(133),y.Oc.add(154),y.Oc.add(162),y.Oc.add(168),y.Oc.add(172),y.Oc.add(201),y.Oc.add(222),y.Oc.add(227),y.Oc.add(513),y.Oc.add(534),y.Oc.add(539),y.Oc.add(545),y.Oc.add(600),y.Oc.add(547),y.Oc.add(555),y.Oc.add(558),y.Oc.add(562),y.Oc.add(585),
y.Oc.add(1001),y.Oc.add(1005),y.Oc.add(1008),y.Oc.add(1010),y.Oc.add(1011),y.Oc.add(1012),y.Oc.add(1018),y.Oc.add(1029),y.Oc.add(252),y.Oc.add(253),y.Oc.add(258),y.Oc.add(101),y.Oc.add(102),y.Oc.add(108),y.Oc.add(257),y.Oc.add(119),y.Oc.add(120),y.Oc.add(123),y.Oc.add(126),y.Oc.add(127),y.Oc.add(130),y.Oc.add(140),y.Oc.add(159),y.Oc.add(160),y.Oc.add(165),y.Oc.add(166),y.Oc.add(167),y.Oc.add(169),y.Oc.add(189),y.Oc.add(223),y.Oc.add(214),y.Oc.add(228),y.Oc.add(233),y.Oc.add(247),y.Oc.add(504),y.Oc.add(511),
y.Oc.add(512),y.Oc.add(525),y.Oc.add(533),y.Oc.add(537),y.Oc.add(542),y.Oc.add(544),y.Oc.add(548),y.Oc.add(550),y.Oc.add(551),y.Oc.add(552),y.Oc.add(554),y.Oc.add(577),y.Oc.add(584),y.Oc.add(586),y.Oc.add(587),y.Oc.add(588),y.Oc.add(592),y.Oc.add(1009),y.Oc.add(1016),y.Oc.add(1017));return y.Oc}}y.Oc=null;Object(d.a)(y,"MacroRecorderUnrecognizedEventList",null,[]);class v{constructor(J,Ia,Db){this.svb=null;this.OFi=(cc,rc)=>{this.C8f()&&this.Ocd(rc)};this.Cuf=Ia;this.Buf=Db;this.$=J;this.$.NQ&&this.$.aOg(this.OFi);
J.da.Ha(297,this)}init(J){this.$.NQ&&(J?this.svb=J:n.ULS.sendTraceTag(537155424,0,10,"MacroRecorderEventHandler.Init failed because the function passed in is null."))}Ocd(J){if(this.C8f())try{if(this.Buf.hmi(J)){var Ia=this.Buf.UXj(J);for(const Db of Ia)this.nYe(Db)}else this.nYe(J)}catch(Db){Ia=`MacroRecorderEventHandler.FireMacroRecorderEvent: Error: ${w.a(J.operation)}, Exception: ${Db.stack}`;n.ULS.sendTraceTag(537155423,0,10,Ia);try{this.YHh(J)}catch(cc){}}}nYe(J){var Ia=this.Cuf.E4e(J,!0);Ia?
(this.svb(Ia.eventId,z.a.Dc(J.payload)),n.ULS.sendTraceTag(537155422,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${Ia.eventId}`)):(Ia=this.Cuf.E4e(J,!1))?n.ULS.sendTraceTag(537155421,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${Ia.eventId}, but failed to match filters`):y.C7h().contains(J.operation)||(this.svb(0,z.a.Dc(J.operation)),J=`MacroRecorderEventHandler.FireMacroRecorderEvent: Unrecognized: ${w.a(J.operation)}`,n.ULS.sendTraceTag(537155420,0,50,J))}YHh(J){this.svb(222,
z.a.Dc(J.operation))}C8f(){return this.$.Vka&&this.svb&&this.$.zba?!0:!1}}Object(d.a)(v,"MacroRecorderEventHandler",null,[810]);var C=a(1);class x{constructor(){this.GKc=this.HKc=this.EQc=this.aVc=null}get operations(){this.EQc||(this.EQc=new l.a,this.Yb());return this.EQc}get ZEc(){this.aVc||(this.aVc=new l.a,this.Yf());return this.aVc}get WWe(){this.GKc||(this.GKc=new l.a);return this.GKc}get featureGates(){this.HKc||(this.HKc=new l.a,this.nwa());return this.HKc}Yf(){}nwa(){}kd(J){this.ZEc.add(J)}Qb(J){this.operations.contains(J)||
this.operations.add(J)}Ynb(){this.featureGates.add(585)}Noe(J){this.WWe.add(J)}}Object(d.a)(x,"MacroRecorderEventBase",null,[]);class B extends x{constructor(){super()}get eventId(){return 130}Yb(){this.Qb(100)}}Object(d.a)(B,"AccessibilityCheckRunEvent",x,[]);class H extends x{constructor(){super()}get eventId(){return 160}Yb(){this.Qb(241)}Yf(){this.kd(J=>J.addToPrintArea)}}Object(d.a)(H,"AddedToPrintAreaEvent",x,[]);class I extends x{constructor(){super()}get eventId(){return 65}Yb(){this.Qb(516)}}
Object(d.a)(I,"AutoFilterToggledEvent",x,[]);class U extends x{constructor(){super()}get eventId(){return 118}Yb(){this.Qb(502)}Yf(){this.kd(J=>!(J.V4a().FirstColumn===J.V4a().LastColumn&&J.V4a().FirstRow===J.V4a().LastRow))}}Object(d.a)(U,"AutoSumEvent",x,[]);class S extends x{constructor(J,Ia){super();this.mfa=J;this.D4j=Ia}get eventId(){return this.mfa}Yb(){this.Qb(529);this.Qb(594)}Yf(){this.kd(J=>this.D4j.includes(J.Rhd()))}}Object(d.a)(S,"ChartPropertyAppliedEventBase",x,[]);class G extends S{constructor(){super(84,
[348,349,350,351,352,353,354,355,356,357,372,373,374,375])}}Object(d.a)(G,"ChartAxisChangedEvent",S,[]);class D extends S{constructor(){super(80,[-104,-103,300,301,302,303,304,305,306,307,308,309,310,311])}}Object(d.a)(D,"ChartAxisTitleChangedEvent",S,[]);class E extends S{constructor(){super(82,[200,201,202,203,204,205,206,207,208,209,210])}}Object(d.a)(E,"ChartDataLabelsChangedEvent",S,[]);class N extends S{constructor(){super(76,[-100])}}Object(d.a)(N,"ChartDataSelectedEvent",S,[]);class M extends S{constructor(){super(83,
[500,501,502])}}Object(d.a)(M,"ChartDataTableChangedEvent",S,[]);var L=a(553),aa=a(421),V=a(84);class P extends x{constructor(){super()}}Object(d.a)(P,"RichApiRequestExecutedEventBase",x,[]);class ba{constructor(J,Ia,Db){this.response=this.request=this.eventId=this.source=null;J&&(this.source=J.source,this.eventId=J.eventId,this.request=Ia,this.response=Db)}get isValid(){return!(void 0===this.source||null===this.source)&&!(void 0===this.eventId||null===this.eventId)&&!0}}Object(d.a)(ba,"MacroRecorderRichApiRequestExecutedPayload",
null,[162]);class Y extends P{constructor(){super()}get eventId(){return 117}uw(J){Y.J6||(Y.J6=new m.a(L.a.Oi()),Y.J6.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),Y.J6.add("fa000000014"));return!!J&&Y.J6.contains(J.toLowerCase())}Yb(){this.Qb(507);this.Qb(10);this.Qb(576)}Yf(){this.kd(J=>Object(aa.a)(ba,J)&&(J=Object(V.a)(ba,J),J.isValid&&this.uw(J.source))?(n.ULS.sendTraceTag(537155427,0,50,`[RichApiRecorder]: A ChartFormatRichApiRequestExecutedEvent is matched! eventId: ${J.eventId}`),!0):!1)}}Y.J6=
null;Object(d.a)(Y,"ChartFormatRichApiRequestExecutedEvent",P,[]);class Z extends S{constructor(){super(85,[328,329,330,331,332,333,334,335])}}Object(d.a)(Z,"ChartGridlinesChangedEvent",S,[]);class ea extends x{constructor(){super()}get eventId(){return 66}Yb(){this.Qb(528)}}Object(d.a)(ea,"ChartInsertedEvent",x,[]);class ra extends S{constructor(){super(81,[100,101,102,103,104,105,106])}}Object(d.a)(ra,"ChartLegendChangedEvent",S,[]);class O extends S{constructor(){super(75,[-101])}}Object(d.a)(O,
"ChartRowColumnSwitchedEvent",S,[]);class da extends S{constructor(){super(79,[0,1,2,-102])}}Object(d.a)(da,"ChartTitleChangedEvent",S,[]);class xa extends S{constructor(){super(78,[-105,-106,-107,-108,-109,-110,-111,-112,-113,-114,-127,-116,-117,-118,-119,-120,-121,-122,-123,-125,-124,-126,-216,-217,-218,-219,-221,-222,-220,-129,-130,-131])}}Object(d.a)(xa,"ChartTypeChangedEvent",S,[]);class ia extends x{constructor(){super()}get eventId(){return 131}Yb(){this.Qb(521)}}Object(d.a)(ia,"ConnectorFloatingObjectResizedEvent",
x,[]);class Ma extends x{constructor(){super()}get eventId(){return 129}Yb(){this.Qb(109)}}Object(d.a)(Ma,"EntitySelectedEvent",x,[]);class Ta extends x{constructor(){super()}get eventId(){return 49}Yb(){this.Qb(149);this.Qb(147)}}Object(d.a)(Ta,"FindCellEvent",x,[]);class Da extends x{constructor(){super()}get eventId(){return 96}Yb(){this.Qb(122)}}Object(d.a)(Da,"FloatingObjectAltTextAppliedEvent",x,[]);class fa extends x{constructor(){super()}get eventId(){return 93}Yb(){this.Qb(522)}}Object(d.a)(fa,
"FloatingObjectDeletedEvent",x,[]);class ua extends x{constructor(){super()}get eventId(){return 94}Yb(){this.Qb(524)}}Object(d.a)(ua,"FloatingObjectMovedAndResizedEvent",x,[]);class Fa extends x{constructor(){super()}get eventId(){return 95}Yb(){this.Qb(523)}}Object(d.a)(Fa,"FloatingObjectRotatedEvent",x,[]);class ca extends x{constructor(){super()}get eventId(){return 100}Yb(){this.Qb(543)}}Object(d.a)(ca,"GroupDetailsShownOrHiddenEvent",x,[]);class ka extends x{constructor(){super()}get eventId(){return 154}Yb(){this.Qb(125)}}
Object(d.a)(ka,"HyperlinksRemovedFromRangeEvent",x,[]);class Ca extends P{constructor(){super()}get eventId(){return 125}uw(J){Ca.J6||(Ca.J6=new m.a(L.a.Oi()),Ca.J6.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),Ca.J6.add("fa000000005"));return!!J&&Ca.J6.contains(J.toLowerCase())}Yb(){this.Qb(507);this.Qb(10);this.Qb(576)}Yf(){this.kd(J=>Object(aa.a)(ba,J)?(J=Object(V.a)(ba,J),J.isValid&&this.uw(J.source)):!1)}}Ca.J6=null;Object(d.a)(Ca,"IdeasRichApiRequestExecutedEvent",P,[]);class fb extends x{constructor(){super()}get eventId(){return 136}Yb(){this.Qb(115)}}
Object(d.a)(fb,"LinkedEntityConvertedEvent",x,[]);class yb extends x{constructor(){super()}get eventId(){return 148}Yb(){this.Qb(114)}}Object(d.a)(yb,"LinkedEntityDisambiguationPaneToggledEvent",x,[]);class mb extends x{constructor(){super()}get eventId(){return 127}Yb(){this.Qb(119)}}Object(d.a)(mb,"MovedToEdgeEvent",x,[]);class nb extends x{constructor(){super()}get eventId(){return 135}Yb(){this.Qb(191)}nwa(){this.Ynb()}}Object(d.a)(nb,"NamedSheetViewCreatedEvent",x,[]);class X extends x{constructor(){super()}get eventId(){return 166}Yb(){this.Qb(200)}nwa(){this.Ynb()}}
Object(d.a)(X,"NamedSheetViewDeletedEvent",x,[]);class R extends x{constructor(){super()}get eventId(){return 133}Yb(){this.Qb(192)}nwa(){this.Ynb()}}Object(d.a)(R,"NamedSheetViewExitedEvent",x,[]);class wa extends x{constructor(){super()}get eventId(){return 162}Yb(){this.Qb(199)}nwa(){this.Ynb()}}Object(d.a)(wa,"NamedSheetViewRenamedEvent",x,[]);class na extends x{constructor(){super()}get eventId(){return 167}Yb(){this.Qb(195)}nwa(){this.Ynb()}}Object(d.a)(na,"NamedSheetViewSwitchedEvent",x,[]);
class Ba extends x{constructor(){super()}get eventId(){return 99}Yb(){this.Qb(174)}}Object(d.a)(Ba,"OutlineLevelSetEvent",x,[]);class Ra extends x{constructor(){super()}get eventId(){return 156}Yb(){this.Qb(244)}}Object(d.a)(Ra,"PageBreakInsertedEvent",x,[]);class qa extends x{constructor(){super()}get eventId(){return 157}Yb(){this.Qb(245)}}Object(d.a)(qa,"PageBreakRemovedEvent",x,[]);class La extends x{constructor(){super()}get eventId(){return 158}Yb(){this.Qb(246)}}Object(d.a)(La,"PageBreaksAllResetEvent",
x,[]);class Yb extends x{constructor(){super()}get eventId(){return 112}Yb(){this.Qb(503)}Yf(){this.kd(J=>!!J.pasteParameters.ClientEstimationFloatingObjectId&&2===J.pasteParameters.CopyPasteTargetType&&!J.isFromCurrentSession)}}Object(d.a)(Yb,"PasteArtOtherWorkbookEvent",x,[]);class mc extends x{constructor(){super()}get eventId(){return 52}Yb(){this.Qb(503)}Yf(){this.kd(J=>!!J.pasteParameters.ClientEstimationFloatingObjectId&&2===J.pasteParameters.CopyPasteTargetType&&J.isFromCurrentSession)}}Object(d.a)(mc,
"PasteArtSameWorkbookEvent",x,[]);class Zb extends x{constructor(){super()}get eventId(){return 110}Yb(){this.Qb(204)}}Object(d.a)(Zb,"PasteHtmlEvent",x,[]);class qb extends x{constructor(){super()}get eventId(){return 35}Yb(){this.Qb(506)}}Object(d.a)(qb,"PasteRangeEvent",x,[]);class Ha extends x{constructor(){super()}get eventId(){return 111}Yb(){this.Qb(503)}Yf(){this.kd(J=>1===J.pasteParameters.CopyPasteTargetType)}}Object(d.a)(Ha,"PasteShadowWorkbookRangeEvent",x,[]);class Ya extends x{constructor(){super()}get eventId(){return 42}Yb(){this.Qb(180)}}
Object(d.a)(Ya,"PasteStringEvent",x,[]);class Gb extends x{constructor(){super()}get eventId(){return 134}Yb(){this.Qb(220)}}Object(d.a)(Gb,"PendingMergeEvent",x,[]);class Ja extends x{constructor(){super()}get eventId(){return 122}Yb(){this.Qb(510)}}Object(d.a)(Ja,"PictureInsertedEvent",x,[]);class Na extends x{constructor(){super()}get eventId(){return 153}Yb(){this.Qb(161)}}Object(d.a)(Na,"PivotDrillToggledEvent",x,[]);class Qa extends x{constructor(J,Ia){super();this.mfa=J;this.opType=Ia}get eventId(){return this.mfa}Yb(){this.Qb(225)}Yf(){this.kd(J=>
J.opType===this.opType)}}Object(d.a)(Qa,"PivotTableSettingsChangedEventBase",x,[]);class Oa extends Qa{constructor(){super(171,4)}}Object(d.a)(Oa,"PivotTableAllItemLabelsRepeatedEvent",Qa,[]);class bb extends Qa{constructor(){super(184,17)}}Object(d.a)(bb,"PivotTableAltTextDescriptionChangedEvent",Qa,[]);class Ga extends Qa{constructor(){super(183,16)}}Object(d.a)(Ga,"PivotTableAltTextTitleChangedEvent",Qa,[]);class tb extends Qa{constructor(){super(173,6)}}Object(d.a)(tb,"PivotTableAutoFitColumnWidthsOnRefreshToggledEvent",
Qa,[]);class wb extends Qa{constructor(){super(172,5)}}Object(d.a)(wb,"PivotTableBlankLineAfterEachItemToggledEvent",Qa,[]);class lb extends Qa{constructor(){super(170,3)}}Object(d.a)(lb,"PivotTableColumnGrandTotalShownEvent",Qa,[]);class db extends x{constructor(){super()}get eventId(){return 98}Yb(){this.Qb(132)}}Object(d.a)(db,"PivotTableCreatedEvent",x,[]);class Pa extends Qa{constructor(){super(177,10)}}Object(d.a)(Pa,"PivotTableDisplayErrorStringToggledEvent",Qa,[]);class ja extends Qa{constructor(){super(178,
11)}}Object(d.a)(ja,"PivotTableDisplayNullStringToggledEvent",Qa,[]);class Ka extends Qa{constructor(){super(179,12)}}Object(d.a)(Ka,"PivotTableErrorStringChangedEvent",Qa,[]);class ub extends Qa{constructor(){super(174,7)}}Object(d.a)(ub,"PivotTableExpandCollapseButtonsShownEvent",Qa,[]);class Kb extends Qa{constructor(){super(187,20)}}Object(d.a)(Kb,"PivotTableIndentChangedEvent",Qa,[]);class W extends Qa{constructor(){super(176,9)}}Object(d.a)(W,"PivotTableItemsWithNoDataOnColumnsShownEvent",Qa,
[]);class za extends Qa{constructor(){super(175,8)}}Object(d.a)(za,"PivotTableItemsWithNoDataOnRowsShownEvent",Qa,[]);class Sa extends Qa{constructor(){super(186,19)}}Object(d.a)(Sa,"PivotTableLayoutTypeSetEvent",Qa,[]);class Wa extends Qa{constructor(){super(180,13)}}Object(d.a)(Wa,"PivotTableNullStringChangedEvent",Qa,[]);class ab extends x{constructor(){super()}get eventId(){return 149}Yb(){this.Qb(219)}}Object(d.a)(ab,"PivotTablePivotLocationChangedEvent",x,[]);class ma extends x{constructor(){super()}get eventId(){return 102}Yb(){this.Qb(145)}}
Object(d.a)(ma,"PivotTablePivotedEvent",x,[]);class ha extends Qa{constructor(){super(182,15)}}Object(d.a)(ha,"PivotTableRefreshDataOnLoadToggledEvent",Qa,[]);class eb extends x{constructor(){super()}get eventId(){return 104}Yb(){this.Qb(50)}Yf(){this.kd(J=>!!J.pivotTableId&&!!J.pivotTableName)}}Object(d.a)(eb,"PivotTableRefreshedEvent",x,[]);class ta extends Qa{constructor(){super(168,1)}}Object(d.a)(ta,"PivotTableRenamedEvent",Qa,[]);class ya extends Qa{constructor(){super(169,2)}}Object(d.a)(ya,
"PivotTableRowGrandTotalShownEvent",Qa,[]);class sb extends Qa{constructor(){super(181,14)}}Object(d.a)(sb,"PivotTableSaveSourceDataWithFileToggledEvent",Qa,[]);var Qb=a(612);class oc extends x{constructor(){super()}get eventId(){return 155}Yb(){this.Qb(131)}Yf(){this.kd(J=>{J=Object(V.a)(Qb.a,J);return!!J&&!!J.uKa()&&!!J.hierarchyName})}}Object(d.a)(oc,"PivotTableSortedEvent",x,[]);class kb extends Qa{constructor(){super(185,18)}}Object(d.a)(kb,"PivotTableSubTotalsVisibilitySettingSetEvent",Qa,[]);
class jb extends x{constructor(){super()}get eventId(){return 206}Yb(){this.Qb(560)}}Object(d.a)(jb,"PivotValueFieldSettingAppliedEvent",x,[]);class Wb extends x{constructor(){super()}get eventId(){return 161}Yb(){this.Qb(243)}}Object(d.a)(Wb,"PrintAreaClearedEvent",x,[]);class wc extends x{constructor(){super()}get eventId(){return 159}Yb(){this.Qb(241)}Yf(){this.kd(J=>!J.addToPrintArea)}}Object(d.a)(wc,"PrintAreaSetEvent",x,[]);class Jc extends x{constructor(){super()}get eventId(){return 57}Yb(){this.Qb(517)}}
Object(d.a)(Jc,"RangeAutoFilterClearedEvent",x,[]);class zc extends x{constructor(J,Ia){super();this.mfa=J;this.u1d=Ia}get eventId(){return this.mfa}Yb(){this.Qb(11)}Yf(){this.kd(J=>16===J.mZ().ValidMembers);this.kd(J=>J.mZ().Font.ValidMembers===this.u1d)}}Object(d.a)(zc,"RangeFontFormattedEventBase",x,[]);class gd extends zc{constructor(){super(3,4)}}Object(d.a)(gd,"RangeBoldedEvent",zc,[]);class Va extends x{constructor(){super()}get eventId(){return 2}Yb(){this.Qb(11)}Yf(){this.kd(J=>128===J.mZ().ValidMembers)}}
Object(d.a)(Va,"RangeBorderedEvent",x,[]);class Eb{}Eb.dab="Table";Eb.Vqc="Sheet";Object(d.a)(Eb,"MacroRecorderEventConstants",null,[]);class hc extends x{constructor(){super()}get eventId(){return 113}Yb(){this.Qb(208)}Yf(){this.kd(J=>J.getParameters().FilterType===Eb.Vqc)}}Object(d.a)(hc,"RangeCheckedItemsFilteredEvent",x,[]);class Ab extends x{constructor(){super()}get eventId(){return 109}Yb(){this.Qb(105)}}Object(d.a)(Ab,"RangeConditionalFormattingCreatedEvent",x,[]);class Bb extends x{constructor(){super()}get eventId(){return 124}Yb(){this.Qb(221)}}
Object(d.a)(Bb,"RangeConditionalFormattingRuleDeletedEvent",x,[]);class ec extends x{constructor(){super()}get eventId(){return 29}Yb(){this.Qb(508)}Yf(){this.kd(J=>3===J.mt()||1===J.mt()||4===J.mt())}}Object(d.a)(ec,"RangeContentClearedEvent",x,[]);class Qd extends x{constructor(){super()}get eventId(){return 40}Yb(){this.Qb(104)}}Object(d.a)(Qd,"RangeCopiedCutCellsInsertedEvent",x,[]);class dc extends x{constructor(){super()}get eventId(){return 114}Yb(){this.Qb(209)}Yf(){this.kd(J=>J.getParameters().FilterType===
Eb.Vqc)}}Object(d.a)(dc,"RangeCustomFilteredEvent",x,[]);class dd extends x{constructor(){super()}get eventId(){return 106}Yb(){this.Qb(121)}}Object(d.a)(dd,"RangeDataValidationChangedEvent",x,[]);class jd extends zc{constructor(){super(4,64)}}Object(d.a)(jd,"RangeDoubleUnderlinedEvent",zc,[]);class md extends x{constructor(){super()}get eventId(){return 69}Yb(){this.Qb(190)}}Object(d.a)(md,"RangeDuplicatesRemovedEvent",x,[]);class vd extends x{constructor(){super()}get eventId(){return 1}Yb(){this.Qb(527);
this.Qb(12)}}Object(d.a)(vd,"RangeEditedEvent",x,[]);class wd extends x{constructor(){super()}get eventId(){return 164}Yb(){this.Qb(255)}Yf(){this.kd(J=>4===J.actionType)}}Object(d.a)(wd,"RangeExternalLinksBrokeAllLinksEvent",x,[]);class Pd extends x{constructor(){super()}get eventId(){return 119}Yb(){this.Qb(255)}Yf(){this.kd(J=>3===J.actionType)}}Object(d.a)(Pd,"RangeExternalLinksBrokeLinkEvent",x,[]);class ic extends x{constructor(){super()}get eventId(){return 205}Yb(){this.Qb(256)}nwa(){this.Noe("Microsoft.Office.Excel.WebExternalLinksChangeSourceMacroRecorder")}}
Object(d.a)(ic,"RangeExternalLinksChangeSourceEvent",x,[]);class cd extends x{constructor(){super()}get eventId(){return 163}Yb(){this.Qb(553)}Yf(){this.kd(J=>1===J.actionType)}}Object(d.a)(cd,"RangeExternalLinksRefreshedAllEvent",x,[]);class Hd extends x{constructor(){super()}get eventId(){return 77}Yb(){this.Qb(553)}Yf(){this.kd(J=>0===J.actionType)}}Object(d.a)(Hd,"RangeExternalLinksRefreshedEvent",x,[]);class he extends x{constructor(){super()}get eventId(){return 165}Yb(){this.Qb(224)}}Object(d.a)(he,
"RangeExternalLinksSetAutoRefreshEvent",x,[]);class Lb extends x{constructor(){super()}get eventId(){return 5}Yb(){this.Qb(11)}Yf(){this.kd(J=>64===J.mZ().ValidMembers)}}Object(d.a)(Lb,"RangeFillColoredEvent",x,[]);class Ic extends x{constructor(){super()}get eventId(){return 59}Yb(){this.Qb(155)}}Object(d.a)(Ic,"RangeFilledEvent",x,[]);class Ob extends x{constructor(){super()}get eventId(){return 115}Yb(){this.Qb(176)}Yf(){this.kd(J=>J.JU().AutoFilterType===Eb.Vqc&&!!J.JU().CriteriaType)}}Object(d.a)(Ob,
"RangeFilterAppliedEvent",x,[]);class Kc extends x{constructor(){super()}get eventId(){return 58}Yb(){this.Qb(176)}Yf(){this.kd(J=>J.JU().AutoFilterType===Eb.Vqc&&!J.JU().CriteriaType)}}Object(d.a)(Kc,"RangeFilterClearedEvent",x,[]);class Ac extends x{constructor(){super()}get eventId(){return 41}Yb(){this.Qb(518)}}Object(d.a)(Ac,"RangeFilterReappliedEvent",x,[]);class Yc extends x{constructor(){super()}get eventId(){return 86}Yb(){this.Qb(150)}}Object(d.a)(Yc,"RangeFlashFilledEvent",x,[]);class td extends zc{constructor(){super(6,
32)}}Object(d.a)(td,"RangeFontColoredEvent",zc,[]);class $d extends zc{constructor(){super(7,8)}}Object(d.a)($d,"RangeFontItalicizedEvent",zc,[]);class be extends zc{constructor(){super(8,1)}}Object(d.a)(be,"RangeFontNamedEvent",zc,[]);class ke extends zc{constructor(){super(9,2)}}Object(d.a)(ke,"RangeFontSizedEvent",zc,[]);class Pe extends x{constructor(){super()}get eventId(){return 74}Yb(){this.Qb(215)}}Object(d.a)(Pe,"RangeFormattedAsTableEvent",x,[]);class Dd extends x{constructor(){super()}get eventId(){return 97}Yb(){this.Qb(188)}}
Object(d.a)(Dd,"RangeGroupedOrUngroupedEvent",x,[]);class ge extends x{constructor(){super()}get eventId(){return 60}Yb(){this.Qb(11)}Yf(){this.kd(J=>2===J.mZ().ValidMembers)}}Object(d.a)(ge,"RangeHorizontallyAlignedEvent",x,[]);class ne extends x{constructor(){super()}get eventId(){return 43}Yb(){this.Qb(526)}}Object(d.a)(ne,"RangeHyperlinkAppliedEvent",x,[]);class ce extends x{constructor(){super()}get eventId(){return 63}Yb(){this.Qb(11)}Yf(){this.kd(J=>256===J.mZ().ValidMembers)}}Object(d.a)(ce,
"RangeIndentChangedEvent",x,[]);class we extends x{constructor(){super()}get eventId(){return 53}Yb(){this.Qb(156)}Yf(){this.kd(J=>2===J.mt()||5===J.mt()||6===J.mt()||7===J.mt())}}Object(d.a)(we,"RangeMergedEvent",x,[]);class ve extends x{constructor(){super()}get eventId(){return 107}Yb(){this.Qb(216)}}Object(d.a)(ve,"RangeNamedCellStyleAppliedEvent",x,[]);class Re extends x{constructor(){super()}get eventId(){return 12}Yb(){this.Qb(11)}Yf(){this.kd(J=>32===J.mZ().ValidMembers)}}Object(d.a)(Re,"RangeNumberFormattedEvent",
x,[]);var rf=a(975);class We extends x{constructor(){super()}get eventId(){return 108}Yb(){this.Qb(141)}Yf(){this.kd(J=>Object(aa.a)(rf.a,J))}}Object(d.a)(We,"RangeSortedEvent",x,[]);class Ye extends zc{constructor(){super(10,128)}}Object(d.a)(Ye,"RangeStrikedThroughEvent",zc,[]);class bf extends zc{constructor(){super(11,16)}}Object(d.a)(bf,"RangeUnderlinedEvent",zc,[]);class Ve extends x{constructor(){super()}get eventId(){return 61}Yb(){this.Qb(11)}Yf(){this.kd(J=>1===J.mZ().ValidMembers)}}Object(d.a)(Ve,
"RangeVerticallyAlignedEvent",x,[]);class Za extends x{constructor(){super()}get eventId(){return 62}Yb(){this.Qb(11)}Yf(){this.kd(J=>8===J.mZ().ValidMembers)}}Object(d.a)(Za,"RangeWrapTextToggledEvent",x,[]);class Xb extends x{constructor(){super()}get eventId(){return 103}Yb(){this.Qb(51)}}Object(d.a)(Xb,"RefreshedAllEvent",x,[]);class ib extends x{constructor(){super()}get eventId(){return 47}Yb(){this.Qb(148)}}Object(d.a)(ib,"ReplaceAllEvent",x,[]);class Rb extends x{constructor(){super()}get eventId(){return 91}Yb(){this.Qb(532)}Yf(){this.kd(J=>
95!==J.getShapeType()&&96!==J.getShapeType()&&97!==J.getShapeType()&&98!==J.getShapeType()&&100!==J.getShapeType()&&102!==J.getShapeType()&&103!==J.getShapeType())}}Object(d.a)(Rb,"ShapeInsertedEvent",x,[]);class lc extends x{constructor(){super()}get eventId(){return 92}Yb(){this.Qb(531)}}Object(d.a)(lc,"ShapeStyleSetEvent",x,[]);var nc=a(830);class Oc extends x{constructor(J,Ia){super();this.mfa=J;this.u1d=Ia}get eventId(){return this.mfa}Yb(){this.Qb(581)}Yf(){this.kd(J=>Object(aa.a)(nc.a,J)&&
4===J.getShapeTextFormat().ValidMembers);this.kd(J=>Object(aa.a)(nc.a,J)&&J.getShapeTextFormat().Font.ValidMembers===this.u1d)}}Object(d.a)(Oc,"ShapeTextFontFormattedEventBase",x,[]);class Ib extends Oc{constructor(){super(193,4)}}Object(d.a)(Ib,"ShapeTextBoldedEvent",Oc,[]);var gc=a(977);class Fc extends x{constructor(){super()}get eventId(){return 191}Yb(){this.Qb(581)}Yf(){this.kd(J=>Object(aa.a)(gc.a,J))}}Object(d.a)(Fc,"ShapeTextChangedEvent",x,[]);class Vc extends Oc{constructor(){super(196,
32)}}Object(d.a)(Vc,"ShapeTextFontColorChangedEvent",Oc,[]);class ed extends Oc{constructor(){super(197,1)}}Object(d.a)(ed,"ShapeTextFontNameChangedEvent",Oc,[]);class Sd extends Oc{constructor(){super(198,2)}}Object(d.a)(Sd,"ShapeTextFontSizeChangedEvent",Oc,[]);class Zd extends x{constructor(){super()}get eventId(){return 199}Yb(){this.Qb(581)}Yf(){this.kd(J=>Object(aa.a)(nc.a,J)&&2===J.getShapeTextFormat().ValidMembers)}}Object(d.a)(Zd,"ShapeTextHorizontallyAlignedEvent",x,[]);class pa extends Oc{constructor(){super(194,
8)}}Object(d.a)(pa,"ShapeTextItalicizedEvent",Oc,[]);class zb extends Oc{constructor(){super(195,16)}}Object(d.a)(zb,"ShapeTextUnderlinedEvent",Oc,[]);class Vb extends x{constructor(){super()}get eventId(){return 200}Yb(){this.Qb(581)}Yf(){this.kd(J=>Object(aa.a)(nc.a,J)&&1===J.getShapeTextFormat().ValidMembers)}}Object(d.a)(Vb,"ShapeTextVerticallyAlignedEvent",x,[]);class xc extends x{constructor(){super()}get eventId(){return 13}Yb(){this.Qb(138)}}Object(d.a)(xc,"SheetAddedEvent",x,[]);var Sc=a(8);
class Jd extends x{constructor(){super()}get eventId(){return 142}Yb(){this.Qb(237)}Yf(){this.kd(J=>!!J.insertDeleteMultiRangeParameters);this.kd(J=>!J.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(J=>{J=J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0>J.DeltaColumn&&!J.DeltaRow&&(!!J.InsertDeleteRange.FirstRow||J.InsertDeleteRange.LastRow!==Sc.a.eB)||!J.DeltaColumn&&0>J.DeltaRow&&(!!J.InsertDeleteRange.FirstColumn||J.InsertDeleteRange.LastColumn!==Sc.a.dy)})}}Object(d.a)(Jd,
"SheetCellsDeletedEvent",x,[]);class ye extends x{constructor(){super()}get eventId(){return 143}Yb(){this.Qb(237)}Yf(){this.kd(J=>!!J.insertDeleteMultiRangeParameters);this.kd(J=>!J.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(J=>{J=J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0<J.DeltaColumn&&!J.DeltaRow&&(!!J.InsertDeleteRange.FirstRow||J.InsertDeleteRange.LastRow!==Sc.a.eB)||!J.DeltaColumn&&0<J.DeltaRow&&(!!J.InsertDeleteRange.FirstColumn||J.InsertDeleteRange.LastColumn!==
Sc.a.dy)})}}Object(d.a)(ye,"SheetCellsInsertedEvent",x,[]);class pe extends x{constructor(){super()}get eventId(){return 139}Yb(){this.Qb(237)}Yf(){this.kd(J=>!!J.insertDeleteMultiRangeParameters);this.kd(J=>!J.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(J=>0>J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(J=>!J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.kd(J=>!J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);
this.kd(J=>J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===Sc.a.eB)}}Object(d.a)(pe,"SheetColumnDeletedEvent",x,[]);class re extends x{constructor(){super()}get eventId(){return 138}Yb(){this.Qb(237)}Yf(){this.kd(J=>!!J.insertDeleteMultiRangeParameters);this.kd(J=>!J.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(J=>0<J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(J=>!J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);
this.kd(J=>!J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);this.kd(J=>J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===Sc.a.eB)}}Object(d.a)(re,"SheetColumnInsertedEvent",x,[]);class He extends x{constructor(){super()}get eventId(){return 14}Yb(){this.Qb(137)}}Object(d.a)(He,"SheetDeletedEvent",x,[]);class ze extends x{constructor(){super()}get eventId(){return 137}Yb(){this.Qb(185)}}Object(d.a)(ze,"SheetDirectionChangedEvent",
x,[]);class ef extends x{constructor(){super()}get eventId(){return 54}Yb(){this.Qb(139)}}Object(d.a)(ef,"SheetDuplicatedEvent",x,[]);class $a extends x{constructor(){super()}get eventId(){return 15}Yb(){this.Qb(207)}}Object(d.a)($a,"SheetNameEditedEvent",x,[]);class Nb extends x{constructor(){super()}get eventId(){return 90}Yb(){this.Qb(151)}}Object(d.a)(Nb,"SheetPaneFrozenEvent",x,[]);class qc extends x{constructor(){super()}get eventId(){return 120}Yb(){this.Qb(226)}}Object(d.a)(qc,"SheetPrintSettingsSavedEvent",
x,[]);var Lc=a(876);class sd extends x{constructor(){super()}get eventId(){return 215}Yb(){this.Qb(507)}nwa(){this.Noe("Microsoft.Office.Excel.SheetProtectionMacroRecording")}Yf(){this.kd(J=>Object.getType(J)===Lc.a)}}Object(d.a)(sd,"SheetProtectionPausedResumedEvent",x,[]);class Fd extends x{constructor(){super()}get eventId(){return 64}Yb(){this.Qb(557)}}Object(d.a)(Fd,"SheetReorderedEvent",x,[]);class Td extends x{constructor(){super()}get eventId(){return 141}Yb(){this.Qb(237)}Yf(){this.kd(J=>
!!J.insertDeleteMultiRangeParameters);this.kd(J=>!J.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(J=>!J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(J=>0>J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.kd(J=>!J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);this.kd(J=>J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===Sc.a.dy)}}Object(d.a)(Td,
"SheetRowDeletedEvent",x,[]);class ue extends x{constructor(){super()}get eventId(){return 140}Yb(){this.Qb(237)}Yf(){this.kd(J=>!!J.insertDeleteMultiRangeParameters);this.kd(J=>!J.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(J=>!J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(J=>0<J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.kd(J=>!J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);
this.kd(J=>J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===Sc.a.dy)}}Object(d.a)(ue,"SheetRowInsertedEvent",x,[]);class Ae extends x{constructor(){super()}get eventId(){return 39}Yb(){this.Qb(135)}}Object(d.a)(Ae,"SheetRowsColumnsAutoFitEvent",x,[]);class Le extends x{constructor(){super()}get eventId(){return 36}Yb(){this.Qb(136)}}Object(d.a)(Le,"SheetRowsColumnsResizedEvent",x,[]);class df extends x{constructor(){super()}get eventId(){return 68}Yb(){this.Qb(183)}}
Object(d.a)(df,"SheetShowGridlinesToggledEvent",x,[]);class Oe extends x{constructor(){super()}get eventId(){return 67}Yb(){this.Qb(184)}}Object(d.a)(Oe,"SheetShowHeadingsToggledEvent",x,[]);class cf extends x{constructor(){super()}get eventId(){return 89}Yb(){this.Qb(213)}}Object(d.a)(cf,"SheetSpellCheckedEvent",x,[]);class vf extends x{constructor(){super()}get eventId(){return 70}Yb(){this.Qb(515)}}Object(d.a)(vf,"SheetTabColoredEvent",x,[]);class hf extends x{constructor(){super()}get eventId(){return 71}Yb(){this.Qb(157)}}
Object(d.a)(hf,"SheetVisibilityChangedEvent",x,[]);class Mf extends x{constructor(){super()}get eventId(){return 126}Yb(){this.Qb(239)}}Object(d.a)(Mf,"SheetsVisibilityChangedEvent",x,[]);class xf extends x{constructor(){super()}get eventId(){return 188}Yb(){this.Qb(203)}}Object(d.a)(xf,"SlicerInsertedEvent",x,[]);class sc extends x{constructor(){super()}get eventId(){return 189}Yb(){this.Qb(173)}Yf(){this.kd(J=>!J.clearFilter)}}Object(d.a)(sc,"SlicerSelectionAppliedEvent",x,[]);class ad extends x{constructor(){super()}get eventId(){return 190}Yb(){this.Qb(173)}Yf(){this.kd(J=>
J.clearFilter)}}Object(d.a)(ad,"SlicerSelectionClearedEvent",x,[]);class gb extends x{constructor(){super()}get eventId(){return 27}Yb(){this.Qb(208)}Yf(){this.kd(J=>J.getParameters().FilterType===Eb.dab)}}Object(d.a)(gb,"TableCheckedItemsFilteredEvent",x,[]);class Hb extends x{constructor(){super()}get eventId(){return 144}Yb(){this.Qb(237)}Yf(){this.kd(J=>!!J.insertDeleteMultiRangeParameters);this.kd(J=>J.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(J=>0>J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);
this.kd(J=>!J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(d.a)(Hb,"TableColumnDeletedEvent",x,[]);class ac extends x{constructor(){super()}get eventId(){return 145}Yb(){this.Qb(237)}Yf(){this.kd(J=>!!J.insertDeleteMultiRangeParameters);this.kd(J=>J.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(J=>0<J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(J=>!J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}
Object(d.a)(ac,"TableColumnInsertedEvent",x,[]);var Ec=a(976);class pd extends x{constructor(){super()}get eventId(){return 121}Yb(){this.Qb(141)}Yf(){this.kd(J=>Object(aa.a)(Ec.a,J))}}Object(d.a)(pd,"TableColumnSortedEvent",x,[]);class Bd extends x{constructor(){super()}get eventId(){return 105}Yb(){this.Qb(193)}}Object(d.a)(Bd,"TableConvertedToRangeEvent",x,[]);class de extends x{constructor(){super()}get eventId(){return 16}Yb(){this.Qb(206)}}Object(d.a)(de,"TableCreatedEvent",x,[]);class Jb extends x{constructor(){super()}get eventId(){return 30}Yb(){this.Qb(209)}Yf(){this.kd(J=>
J.getParameters().FilterType===Eb.dab)}}Object(d.a)(Jb,"TableCustomFilteredEvent",x,[]);class tc extends x{constructor(){super()}get eventId(){return 25}Yb(){this.Qb(187)}Yf(){this.kd(J=>1===J.options.OperationType)}}Object(d.a)(tc,"TableCustomSortedEvent",x,[]);class fd extends x{constructor(){super()}get eventId(){return 28}Yb(){this.Qb(176)}Yf(){this.kd(J=>J.JU().AutoFilterType===Eb.dab);this.kd(J=>0===J.JU().CriteriaType)}}Object(d.a)(fd,"TableFilterClearedEvent",x,[]);class Ad extends x{constructor(){super()}get eventId(){return 32}Yb(){this.Qb(176)}Yf(){this.kd(J=>
J.JU().AutoFilterType===Eb.dab);this.kd(J=>{const Ia=new l.a;Ia.add(1);Ia.add(2);Ia.add(8);Ia.add(9);Ia.add(10);Ia.add(11);Ia.add(12);Ia.add(13);Ia.add(14);Ia.add(15);Ia.add(16);Ia.add(17);Ia.add(18);Ia.add(19);Ia.add(20);Ia.add(21);Ia.add(22);Ia.add(23);Ia.add(24);Ia.add(25);Ia.add(26);Ia.add(27);Ia.add(28);Ia.add(29);Ia.add(30);Ia.add(31);Ia.add(32);Ia.add(33);Ia.add(34);Ia.add(35);Ia.add(36);Ia.add(37);Ia.add(38);Ia.add(39);return Ia.contains(J.JU().CriteriaType)})}}Object(d.a)(Ad,"TableItemFilteredEvent",
x,[]);class me extends x{constructor(){super()}get eventId(){return 101}Yb(){this.Qb(217)}}Object(d.a)(me,"TableRenamedEvent",x,[]);class Vd extends x{constructor(){super()}get eventId(){return 73}Yb(){this.Qb(211)}}Object(d.a)(Vd,"TableResizedEvent",x,[]);class oe extends x{constructor(){super()}get eventId(){return 44}Yb(){this.Qb(514)}}Object(d.a)(oe,"TableRowColumnRearrangedEvent",x,[]);class Me extends x{constructor(){super()}get eventId(){return 146}Yb(){this.Qb(237)}Yf(){this.kd(J=>!!J.insertDeleteMultiRangeParameters);
this.kd(J=>J.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(J=>!J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(J=>0>J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(d.a)(Me,"TableRowDeletedEvent",x,[]);class cb extends x{constructor(){super()}get eventId(){return 147}Yb(){this.Qb(237)}Yf(){this.kd(J=>!!J.insertDeleteMultiRangeParameters);this.kd(J=>J.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(J=>!J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);
this.kd(J=>0<J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(d.a)(cb,"TableRowInsertedEvent",x,[]);class Mb extends x{constructor(){super()}get eventId(){return 26}Yb(){this.Qb(177)}Yf(){this.kd(J=>J.JU().AutoFilterType===Eb.dab)}}Object(d.a)(Mb,"TableSortedEvent",x,[]);class kc extends x{constructor(){super()}get eventId(){return 87}Yb(){this.Qb(212)}}Object(d.a)(kc,"TableStyleAppliedEvent",x,[]);class Uc extends x{constructor(){super()}get eventId(){return 88}Yb(){this.Qb(196)}}
Object(d.a)(Uc,"TableStyleOptionToggledEvent",x,[]);class qd extends x{constructor(){super()}get eventId(){return 31}Yb(){this.Qb(210)}Yf(){this.kd(J=>J.getParameters().FilterType===Eb.dab)}}Object(d.a)(qd,"TableTop10FilteredEvent",x,[]);class va extends x{constructor(){super()}get eventId(){return 207}Yb(){this.Qb(238)}}Object(d.a)(va,"TextToColumnsEvent",x,[]);class rb extends x{constructor(){super()}get eventId(){return 128}Yb(){this.Qb(559)}}Object(d.a)(rb,"ValuesSortedEvent",x,[]);class fc extends x{constructor(){super()}get eventId(){return 55}Yb(){this.Qb(197)}}
Object(d.a)(fc,"WorkbookCalculationModeSetEvent",x,[]);class Nc extends x{constructor(){super()}get eventId(){return 34}Yb(){this.Qb(181)}Yf(){this.kd(J=>!!J.parentCommentId)}}Object(d.a)(Nc,"WorkbookCommentRepliedEvent",x,[]);class hd extends x{constructor(){super()}get eventId(){return 33}Yb(){this.Qb(181)}Yf(){this.kd(J=>!J.parentCommentId)}}Object(d.a)(hd,"WorkbookCommentedEvent",x,[]);class xd extends x{constructor(){super()}get eventId(){return 56}Yb(){this.Qb(128)}}Object(d.a)(xd,"WorkbookRecalculatedEvent",
x,[]);class ae extends x{constructor(){super()}get eventId(){return 46}Yb(){this.Qb(171)}}Object(d.a)(ae,"WorkbookRedoEvent",x,[]);class Wd extends x{constructor(){super()}get eventId(){return 45}Yb(){this.Qb(170)}}Object(d.a)(Wd,"WorkbookUndoEvent",x,[]);class Ne extends x{constructor(){super()}get eventId(){return 116}Yb(){this.Qb(507);this.Qb(576);this.Qb(10)}Yf(){this.kd(J=>{if(Object(aa.a)(ba,J)&&(J=Object(V.a)(ba,J),void 0!==J.source&&null!==J.source&&void 0!==J.eventId&&null!==J.eventId))return n.ULS.sendTraceTag(537155426,
0,50,`[RichApiRecorder]: received a valid but unhandled event: source: ${J.source}; eventId: ${J.eventId}.`),!0;n.ULS.sendTraceTag(537155425,0,50,"[RichApiRecorder]: an invalid event was ignored.");return!1})}}Object(d.a)(Ne,"DefaultRichApiRequestExecutedEvent",x,[]);class Ue extends x{constructor(){super()}get eventId(){return 216}Yb(){this.Qb(1022)}}Object(d.a)(Ue,"TablelAltTextEditedEvent",x,[]);class xe extends x{constructor(){super()}get eventId(){return 217}Yb(){this.Qb(263)}}Object(d.a)(xe,
"FloatingObjectZOrderChangedEvent",x,[]);var Ze=a(978);class tf extends x{constructor(){super()}get eventId(){return 192}Yb(){this.Qb(507)}Yf(){this.kd(J=>Object(aa.a)(Ze.a,J)?!0:!1)}}Object(d.a)(tf,"VisualPropertySetEvent",x,[]);class Of extends S{constructor(){super(219,[510])}}Object(d.a)(Of,"ChartSeriesDeletedEvent",S,[]);class bg extends x{get eventId(){return 220}Yb(){this.Qb(1027)}}Object(d.a)(bg,"ChartDataChangedEvent",x,[]);class pf extends S{constructor(){super(221,[512])}}Object(d.a)(pf,
"ChartSeriesDataChangedEvent",S,[]);class Ua{constructor(J){this.xb=null;this.$=J}get macroRecorderEvents(){this.xb||(this.xb=new l.a,this.xb.add(new vd),this.xb.add(new Va),this.xb.add(new gd),this.xb.add(new jd),this.xb.add(new Lb),this.xb.add(new td),this.xb.add(new $d),this.xb.add(new be),this.xb.add(new ke),this.xb.add(new Ye),this.xb.add(new bf),this.xb.add(new Re),this.xb.add(new xc),this.xb.add(new He),this.xb.add(new $a),this.xb.add(new de),this.xb.add(new Hb),this.xb.add(new ac),this.xb.add(new Me),
this.xb.add(new cb),this.xb.add(new re),this.xb.add(new pe),this.xb.add(new ue),this.xb.add(new Td),this.xb.add(new tc),this.xb.add(new Mb),this.xb.add(new gb),this.xb.add(new fd),this.xb.add(new ec),this.xb.add(new Jb),this.xb.add(new qd),this.xb.add(new Ad),this.xb.add(new hd),this.xb.add(new Nc),this.xb.add(new qb),this.xb.add(new Le),this.xb.add(new Jd),this.xb.add(new ye),this.xb.add(new Ae),this.xb.add(new Qd),this.xb.add(new Ac),this.xb.add(new ne),this.xb.add(new Ya),this.xb.add(new oe),this.xb.add(new ae),
this.xb.add(new Wd),this.xb.add(new ib),this.xb.add(new Ta),this.xb.add(new mc),this.xb.add(new we),this.xb.add(new ef),this.xb.add(new fc),this.xb.add(new xd),this.xb.add(new Jc),this.xb.add(new Kc),this.xb.add(new Ic),this.xb.add(new ge),this.xb.add(new Ve),this.xb.add(new Za),this.xb.add(new ce),this.xb.add(new Fd),this.xb.add(new I),this.xb.add(new ea),this.xb.add(new Oe),this.xb.add(new df),this.xb.add(new md),this.xb.add(new hf),this.xb.add(new vf),this.xb.add(new Vd),this.xb.add(new Pe),this.xb.add(new O),
this.xb.add(new N),this.xb.add(new Hd),this.xb.add(new xa),this.xb.add(new da),this.xb.add(new D),this.xb.add(new ra),this.xb.add(new E),this.xb.add(new M),this.xb.add(new G),this.xb.add(new Z),this.xb.add(new Yc),this.xb.add(new kc),this.xb.add(new Uc),this.xb.add(new cf),this.xb.add(new Nb),this.xb.add(new Rb),this.xb.add(new lc),this.xb.add(new fa),this.xb.add(new ua),this.xb.add(new Fa),this.xb.add(new Da),this.xb.add(new Dd),this.xb.add(new db),this.xb.add(new Ba),this.xb.add(new ca),this.xb.add(new me),
this.xb.add(new ma),this.xb.add(new Xb),this.xb.add(new eb),this.xb.add(new Bd),this.xb.add(new dd),this.xb.add(new ve),this.xb.add(new We),this.xb.add(new Ab),this.xb.add(new Zb),this.xb.add(new Ha),this.xb.add(new Yb),this.xb.add(new hc),this.xb.add(new dc),this.xb.add(new Ob),this.xb.add(new U),this.xb.add(new Ja),this.xb.add(new Pd),this.xb.add(new qc),this.xb.add(new pd),this.xb.add(new Bb),this.xb.add(new Mf),this.xb.add(new mb),this.xb.add(new rb),this.xb.add(new Ma),this.xb.add(new B),this.xb.add(new ia),
this.xb.add(new R),this.xb.add(new Gb),this.xb.add(new nb),this.xb.add(new fb),this.xb.add(new ze),this.xb.add(new yb),this.xb.add(new ab),this.xb.add(new Na),this.xb.add(new ka),this.xb.add(new oc),this.xb.add(new Ra),this.xb.add(new qa),this.xb.add(new La),this.xb.add(new wc),this.xb.add(new H),this.xb.add(new Wb),this.xb.add(new wa),this.xb.add(new cd),this.xb.add(new wd),this.xb.add(new he),this.xb.add(new X),this.xb.add(new na),this.xb.add(new ta),this.xb.add(new ya),this.xb.add(new lb),this.xb.add(new Oa),
this.xb.add(new wb),this.xb.add(new tb),this.xb.add(new ub),this.xb.add(new za),this.xb.add(new W),this.xb.add(new Pa),this.xb.add(new ja),this.xb.add(new Ka),this.xb.add(new Wa),this.xb.add(new sb),this.xb.add(new ha),this.xb.add(new Ga),this.xb.add(new bb),this.xb.add(new kb),this.xb.add(new Sa),this.xb.add(new Kb),this.xb.add(new xf),this.xb.add(new sc),this.xb.add(new ad),this.xb.add(new Fc),this.xb.add(new Ib),this.xb.add(new pa),this.xb.add(new zb),this.xb.add(new Vc),this.xb.add(new ed),this.xb.add(new Sd),
this.xb.add(new Zd),this.xb.add(new Vb),this.xb.add(new ic),this.xb.add(new jb),this.xb.add(new va),this.xb.add(new sd),this.xb.add(new Ue),this.xb.add(new xe),this.xb.add(new tf),this.xb.add(new Of),this.xb.add(new pf),this.xb.add(new bg),C.EwaSettings.isChangeGateEnabled("OfficeVSO:4825267_RemoveDisabledEvents")&&this.Zhj());return this.xb}E4e(J,Ia){let Db=this.F4e(J,this.macroRecorderEvents,Ia);Db||(Db=this.F4e(J,Ua.w7h(),Ia),!Db&&this.gkf(J,Ua.QKe,Ia)&&(Db=Ua.QKe));return Db}F4e(J,Ia,Db){const cc=
new l.a;for(let rc of Ia)this.gkf(J,rc,Db)&&cc.add(rc);return 1===cc.count?cc.ma(0):1<cc.count?Ua.CPh(cc):null}gkf(J,Ia,Db){const cc=Ua.H2i(J,Ia);return Db?cc&&Ua.i5j(J,Ia):cc}Zhj(){const J=new l.a;for(let Ia of this.xb){let Db=!1;for(let cc of Ia.featureGates)if(!C.EwaSettings.ra(cc)){J.add(Ia);Db=!0;break}if(!Db)for(let cc of Ia.WWe)if(!C.EwaSettings.getBooleanFeatureGate(cc,!1)){J.add(Ia);break}}for(let Ia of J)this.xb.remove(Ia)}static w7h(){Ua.pEb||(Ua.pEb=new l.a,Ua.pEb.add(new Y),Ua.pEb.add(new Ca));
return Ua.pEb}static H2i(J,Ia){return Ia.operations.contains(J.operation)}static i5j(J,Ia){Ia=Ia.ZEc;if(!Ia.count)return!0;let Db=!0;for(let cc of Ia)if(!cc(J.payload)){Db=!1;break}return Db}static CPh(J){let Ia=J.ma(0);for(let Db of J)Db.ZEc.count>Ia.ZEc.count&&(Ia=Db);return Ia}}Ua.pEb=null;Ua.QKe=new Ne;Object(d.a)(Ua,"MacroRecorderEventList",null,[]);class xb extends h.a{constructor(J){super();this.$=J;this.Db()}create(){this.nb(this.$.da.Aa(297)||new v(this.$,new Ua(this.$),new t))}static ka(J){J.da.Ha(298,
new xb(J))}}Object(d.a)(xb,"MacroRecorderEventHandlerFactory",h.a,[]);var Ub=a(1264),uc=a(7),Qc=a(559);class ld{constructor(){this.Ztg=new l.a}get I2b(){return this.Ztg}d_h(J){n.ULS.sendTraceTag(17306645,220,50,"Context menu id: {0}",J);const Ia=new l.a;for(let Db of this.I2b)for(let cc of Db.EFb)cc.id===J&&Ia.add(cc);return Ia}Aoe(J){this.I2b.add(J)}Uhj(J){for(let Ia of this.I2b)if(Ia.Hse===J.Hse){this.I2b.remove(Ia);break}}static fnh(J,Ia,Db=null){J=ld.jSh(J);0<J.length&&(ld.jyc(J,!1),Db&&Db(Ia,
J))}static jSh(J){const Ia=[];if(J&&J.EFb&&0<J.EFb.count)for(let Db of J.EFb)if(Db.controls&&0<Db.controls.count)for(let cc of Db.controls)if(cc.menuItems&&0<cc.menuItems.count)for(let rc of cc.menuItems)Array.add(Ia,rc.id);return Ia}static jyc(J,Ia){if(J.length){var Db=[];for(const cc of J)Db.push(appChrome.actions.updateControlEnabledDisabledState(cc,Ia));appChrome.api.dispatch(Db)}}}Object(d.a)(ld,"ContextMenuExtensibilityCache",null,[838,839]);var Md=a(1490),Kd=a(85),Cd=a(4),le=a(881),Ke=a(827);
class sf{OYa(J,Ia=null){if(J=Ke.a.O3a(J)){appChrome.addInApi.dispatchActionsToInstallAddIn(J,Ia);for(const Db of J.tabs)if(Db.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(J,()=>{});break}}}ILd(J){(J=Ke.a.O3a(J))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(J)}static nnh(J,Ia,Db=null){J=sf.h2h(J);0<J.length&&(sf.jyc(J,!1),Db&&Db(Ia,J))}static h2h(J){const Ia=[];if(J&&(J=J.KV,J.Ks&&0<J.Ks.count))for(let Db of J.Ks)if(Db.groups&&0<Db.groups.length)for(const cc of Db.groups)if(cc.controls&&
0<cc.controls.length)for(const rc of cc.controls)Array.add(Ia,rc.id);return Ia}static jyc(J){if(J.length){var Ia=[];for(const Db of J)Ia.push(appChrome.actions.updateControlEnabledDisabledState(Db,!0));appChrome.api.dispatch(Ia)}}}Object(d.a)(sf,"OneLineRibbonExtensibilityManager",null,[853]);var vb=a(952);class Pb{constructor(){this.g5d=this.BGc=null}get JVc(){return this.BGc||(this.BGc=OfficeExt.DefaultControlActionBinder.retrieveActionContext)}set JVc(J){this.BGc=J}get iVg(){return this.g5d||(this.g5d=
OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}getTaskPaneControlIdFromSolutionIdRuntimeId(J,Ia){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromSolutionIdRuntimeId(J,Ia)}qkd(J,Ia,Db,cc,rc,Tc=null,bd=null){n.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",J);if((J=Ia.Ria(rc.ownerAddinInfo.storeType,rc.ownerAddinInfo.solutionId))&&J.oB&&!J.oB.getIsUpgrading())if(Ia=null,0<J.oB.getNotificationParams().length&&(Ia=this.xye(J.oB.getNotificationParams()[0]))&&
2147758681===Ia.errorCode&&(J.isUpgraded=!0),2!==J.oB.getStatus()&&(1!==J.oB.getStatus()||Ia&&2147758681===Ia.errorCode))Ia&&this.p9f(J,Ia,bd);else try{Db.setOwnerAddinEToken(J.oB.getEToken()),rc.action(Db,cc.Mca),Tc&&Tc()}catch(nd){n.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",Cd.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?nd.stack:nd.message)),vb.a.sUd(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}}p9f(J,
Ia,Db=null){const cc=J.oB;if(1===cc.getNotificationParams().length||Ia.pfc){const rc=Ia.mha,Tc=Ia.nia;Ia.mha=()=>{cc.removeFirstNotification();if(0<cc.getNotificationParams().length){const bd=this.xye(cc.getNotificationParams()[0]);this.p9f(J,bd)}2147758681===Ia.errorCode&&(sf.nnh(J.Do,cc,Object(Kd.a)(this,this.zef,"initUpgradeStateDetectTask")),ld.fnh(J.jsb,cc,Object(Kd.a)(this,this.zef,"initUpgradeStateDetectTask")));rc&&rc()};Ia.nia=()=>{Tc&&Tc();Db&&Db()};vb.a.uUd(Ia)}}zef(J,Ia){let Db=null;Db=
()=>{J.getIsUpgrading()?window.setTimeout(Db,1E3):J.getUpgradingFailed()?sf.jyc(Ia,!0):Cd.AFrameworkApplication.sa.updateCommandUI()};window.setTimeout(Db,1E3)}xye(J){const Ia=new le.a;Ia.RLa=J.infoType;Ia.id=J.id;Ia.title=J.title;Ia.description=J.description;Ia.buttonText=J.buttonTxt;Ia.mha=J.buttonCallback;Ia.pfc=J.highPriority;Ia.nia=J.dismissCallback;Ia.errorCode=J.errorCode;Ia.Edf=J.iframeNotificationUrl;return Ia}}Object(d.a)(Pb,"AddinCommandsActionHandler",null,[830]);var pc=a(83),Gc=a(160),
id=a(709),yd=a(5),Gd=a(752),Xd=a(710);class je{constructor(J,Ia){this.Va=J;this.W9g=Ia}GMh(J){if(void 0!==J&&null!==J&&J===yd.a.aGe)J="ContextMenuCell";else return null;const Ia=this.Va.Ec();this.XLh(Ia,J);return Ia}XLh(J,Ia){Ia=this.W9g.d_h(Ia);for(let Db of Ia){Ia=Db.controls;for(let cc of Ia)this.KLh(J,cc)}}KLh(J,Ia){var Db=Ia.WT[Gd.a.id];const cc=Ia.WT[Gd.a.MUa],rc=Ia.WT[Gd.a.QUa];let Tc="Image16by16",bd=Ia.WT[Gd.a.NUa];Xd.c(rc)&&(Tc="None");0<Ia.menuItems.count?(Db=this.Va.$v(Db,Db,cc,798637440),
Db.nMb(Tc,rc,null),this.EMh(Db.menu,Ia),J.buttons.push(Db)):J.buttons.push(this.Va.$Ha(Db,cc,bd,rc,Tc,null,!1))}EMh(J,Ia){const Db=this.Va.Ec();for(let cc of Ia.menuItems){Ia=cc.Ila[Gd.a.id];const rc=cc.Ila[Gd.a.MUa],Tc=cc.Ila[Gd.a.QUa];let bd="Image16by16";const nd=cc.Ila[Gd.a.NUa];Xd.c(Tc)&&(bd="None");Ia=this.Va.$Ha(Ia,rc,nd,Tc,bd,null,!1);Db.buttons.push(Ia)}J.rc.push(Db)}}Object(d.a)(je,"AddInCommandsContextMenuExtensibilityHandler",null,[812]);var Se=a(877);class Te{constructor(){this.gi=null;
this.visible=!1}}Object(d.a)(Te,"AddinStatusCommandValues",null,[]);class Af{static V$i(J){const Ia=new Te;Ia.gi=J.iZa;Ia.visible=Ia.gi?!0:!1;return Ia}static Yzc(J,Ia,Db,cc,rc){const Tc=document.getElementById(Db);Tc?Af.yJj(J,Ia,Tc,cc,rc):n.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",Db))}static yJj(J,Ia,Db,cc,rc){Db?J.iZa===CommonUIStrings.l_ErrorLoadingAddInsTitle?vb.a.jIj(Ia,Db,cc,rc):J.iZa===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&vb.a.DJj(Ia,
Db):n.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))}}Object(d.a)(Af,"AddinCommandsStatusHandler",null,[]);var Aa=a(38),Cb=a(229),Tb=a(13);class yc extends Aa.a{constructor(J,Ia){super();this.agaveCommandManager=this.statusBarManager=null;this.RCe=()=>{this.DF&&this.DF.uCe()};this.W9e=()=>{this.raiseEvent("LAC")};this.Rc=(Db,cc)=>{!Db.Xb&&Cb.b(cc)&&this.statusBarManager&&(this.statusBarManager.yF(this),this.statusBarManager=null)};this.DF=Ia;this.$=
J;this.COj=J.Bb+"OfficeAddinLabel-Medium14";this.$.da.gb(29,Db=>{this.statusBarManager=Db;Db.$I(this)});this.$.ea.Jj(this.Rc);this.DF.ILg(this.W9e);this.$.da.gb(206,Db=>{this.agaveCommandManager=Db;Db.jNg(this.RCe)})}pq(J){this.addHandler("LAC",J)}Lq(J){this.removeHandler("LAC",J)}Tr(J,Ia){if("QueryAddinLabel"!==J)return!1;Ia[Se.a.LabelText]!==this.DF.iZa&&(J=Af.V$i(this.DF),Ia[Se.a.LabelText]=J.gi,Ia[Se.a.Visible]=J.visible,window.setTimeout(()=>{this.Yzc()},0));return!0}un(){return!0}Yzc(){this.$&&
Af.Yzc(this.DF,this.$.domElement,this.COj,Tb.a.instance.ga(332),Tb.a.instance.ga(333))}dispose(){this.$.ea.ik(this.Rc);this.DF.bjj(this.W9e);this.agaveCommandManager&&(this.agaveCommandManager.okj(this.RCe),this.agaveCommandManager=null);this.statusBarManager&&(this.statusBarManager.yF(this),this.statusBarManager=null);this.DF=this.$=null;super.dispose()}}Object(d.a)(yc,"AddinCommandsStatusBarManager",Aa.a,[200,201]);var Hc=a(1334),la=a(731),sa=a(151),bc=a(122),Wc=a(109),zd=a(573),fe=a(136);class qe{constructor(){this.hZa=
null}setErrorMessageForAddin(J,Ia){this.hZa||(this.hZa={});this.hZa[J]=Ia}CUh(J){return this.hZa&&J in this.hZa?this.hZa[J]:null}}Object(d.a)(qe,"AddinCommandsErrorManager",null,[]);var De=a(334),If=a(98);class Bf{constructor(){this.Rp=this.MN=0;this.bYc=null;this.Wsc=this.KCc=0;this.Kpa=this.lLc=this.TGc=this.e5b=this.kja=this.C9=null}get aYc(){this.TGc||(this.TGc=new l.a);return this.TGc}get hed(){this.lLc||(this.lLc=new l.a);return this.lLc}get QHa(){this.Kpa||(this.Kpa=new l.a);return this.Kpa}}
Object(d.a)(Bf,"AddinCommandsListLoaderContext",null,[]);var Jf=a(832);class Pf{}Object(d.a)(Pf,"AppsForOfficeEntitlementQueryInfo",null,[]);var Yf=a(39);const ng=J=>{const Ia={};Ia.solutionId=J.solutionId;Ia.version=J.version;Ia.storeType=J.storeType;Ia.storeId=J.storeId;Ia.assetId=J.assetId;Ia.assetStoreId=J.assetStoreId;Ia.targetType=J.targetType;Ia.requireConsent=J.requireConsent||!1;Ia.isAddinCommands=!0;Ia.addinCommandsActionType=0;return Ia};class yg{constructor(J,Ia){this.entitlement=J;this.metadata=
Ia}hfg(){const J=ng(this.entitlement);J.targetType=this.targetType;return J}get solutionId(){return this.entitlement.solutionId}get version(){return this.entitlement.version}get storeType(){return this.entitlement.storeType}get storeId(){return this.entitlement.storeId}get assetId(){return this.entitlement.assetId}get assetStoreId(){return this.entitlement.assetStoreId}get targetType(){return-1!==this.entitlement.targetType?this.entitlement.targetType:this.metadata.targetType}get eToken(){return this.entitlement.eToken}get requireConsent(){return this.entitlement.requireConsent}get installTimeInMS(){return this.entitlement.installTimeInMS}}
Object(d.a)(yg,"AddinEntitlementEx",null,[]);var Fg=a(259),Kf=a(30);class Gg{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(d.a)(Gg,"AddinAbstract",null,[]);class Cg extends Sys.EventArgs{constructor(){super();this.Do=this.fk=null}}Object(d.a)(Cg,"InsertionParamEventArgs",Sys.EventArgs,[]);class Dg{constructor(J,Ia,Db,cc=null){this.$Kb=Cd.AFrameworkApplication.fa.Wa("RoamingServiceHandlerWebServiceBase");this.appName=J;this.TDa=Ia;this.Ajb=Db;this.Llb=cc}p$b(J){this.cWe(J,
"getAddinTeachingCalloutSettings",Object(Kd.a)(this,this.e4,"getRequestSuccessCallback"),Object(Kd.a)(this,this.JM,"getRequestFailureCallback"))}bEh(){const J=new l.a;J.add(this.appName);this.cWe(J,"getTeachingCalloutSettingsForAddinBetterEntryPoint",Object(Kd.a)(this,this.V1h,"getRequestSuccessCallbackForBEP"),Object(Kd.a)(this,this.JM,"getRequestFailureCallback"))}cWe(J,Ia,Db,cc){const rc=new Sys.StringBuilder(this.$Kb);rc.append("RoamingServiceHandler.ashx?action=");rc.append(Ia);rc.append("&");
rc.append(this.nid(J));rc.append("&");rc.append(Cd.AFrameworkApplication.vi);Cd.AFrameworkApplication.Bd.Jm(rc.toString(),1,null,null,!0,2,Db,cc,null)}a3a(J){this.hWe(J,"saveAddinTeachingCalloutSettings")}gEh(J){this.hWe(J,"saveTeachingCalloutSettingsForAddinBetterEntryPoint")}hWe(J,Ia){const Db=new Sys.StringBuilder(this.$Kb);Db.append("RoamingServiceHandler.ashx?action=");Db.append(Ia);Db.append("&");Db.append(Cd.AFrameworkApplication.vi);Ia=Db.toString();J=Yf.c(J);Cd.AFrameworkApplication.Bd.Jm(Ia,
2,J,null,!0,4,null,Object(Kd.a)(this,this.HN,"postRequestFailureCallback"),null)}e4(J){let Ia=!1,Db=null;try{if(0<J.data.de.length){const cc=Object(V.a)(Object,Yf.a(J.data.de)),rc=cc?cc[this.appName]:null;rc&&(Db=Object(V.a)(Object,Yf.a(rc.toString())))}Ia=!0}catch(cc){this.JM(null)}Ia&&this.TDa&&this.TDa(Db)}V1h(J){let Ia=!1,Db=null;try{if(0<J.data.de.length){const cc=Object(V.a)(Object,Yf.a(J.data.de));Db=Object(V.a)(String,cc[this.appName])||null}Ia=!0}catch(cc){this.JM(null)}Ia&&this.TDa&&(J=
{},J.Platforms=Db,this.TDa(J))}JM(J){this.Ajb&&this.Ajb(J?J.data:null)}HN(J){this.Llb&&this.Llb(J?J.data:null)}nid(J){const Ia=new Sys.StringBuilder("requestedsettings=");for(let Db=0;Db<J.count;Db++)Ia.append(J.ma(Db)),Db<J.count-1&&Ia.append(";");return Ia.toString()}}Object(d.a)(Dg,"AddinTeachingUIRoamingRequestHandler",null,[]);class Hg extends Sys.EventArgs{constructor(J){super();this.solutionId=J.solutionId;this.assetId=J.assetId;this.storeType=J.storeType;this.storeId=J.storeId;this.assetStoreId=
J.assetStoreId;this.targetType=J.targetType;this.width=J.width;this.height=J.height;this.displayName=J.displayName;this.version=J.version}}Object(d.a)(Hg,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);var Lf=a(346);class vg{constructor(J){this.lZa=this.fk=null;this.Hda=!1;this.Kpa=this.IRb=this.Mma=this.Ng=this.jX=this.XN=null;this.Pa=J}get appName(){return Cd.AFrameworkApplication.fa.Wa("WebAppShortName")}get Kob(){this.jX||(this.jX=new Dg(this.appName,Object(Kd.a)(this,this.e4,
"getRequestSuccessCallback"),Object(Kd.a)(this,this.JM,"getRequestFailureCallback"),Object(Kd.a)(this,this.HN,"postRequestFailureCallback")));return this.jX}get Zra(){this.IRb||(this.IRb=new l.a);return this.IRb}set Zra(J){this.IRb=J}get QHa(){this.Kpa||(this.Kpa=new l.a);return this.Kpa}set QHa(J){this.Kpa=J}EWc(J,Ia){window.addEventListener?(this.fk=J,this.lZa=Ia,window.addEventListener("LaunchAddinTaskpane",Object(Kd.a)(this,this.IDd,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",
Object(Kd.a)(this,this.aGb,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(Kd.a)(this,this.XFb,"onCloseButtonClickedEventHandler"),!0),window.addEventListener("FGWebSurfaceEvent",Object(Kd.a)(this,this.QFb,"onCampaignLaunchedHandler"),!0)):n.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")}OZd(J,Ia,Db,cc){this.Ng=J;this.Zra=Ia;this.QHa=Db;this.Mma=cc;n.ULS.sendTraceTag(0,220,50,"Calls into TriggerTeachingCallout with addin entitlements: command addins: {0}, content addins: {1}",
Ia?Ia.count.toString():"null",Db?Db.count.toString():"null");0<this.Zra.count||0<this.QHa.count?(J=new l.a,J.add(this.appName),this.Kob.p$b(J)):this.Mma(new l.a,null)}IDd(){const J=new Fg.ScriptSharpLegacyMap;this.lZa&&this.lZa.tabs&&!this.lZa.tabs[0].isOfficeTab&&J.ia("SDX.FeatureFlags","NonOfficeTab");this.sla(vg.PU(this.fk),"ClickOnLaunch",J);this.Ela();this.lZa?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.lZa,()=>{const Ia=new Cg;Ia.fk=this.fk;this.Pa.raiseEvent(la.a.yvd,Ia)}):
n.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}XFb(){this.sla(vg.PU(this.fk),"ClickOnClose");this.Ela()}aGb(){this.sla(vg.PU(this.fk),"ClickOnDismiss");this.Ela()}QFb(J){if(J&&(J=J.detail)&&J.id&&this.wpd(J.id)){const Ia=(J.action||"").toLowerCase();if(J.success&&"opened"===Ia)this.sla(vg.PU(this.fk),"CampaignLaunched"),n.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming."),this.Ela(),window.removeEventListener&&
window.removeEventListener("FGWebSurfaceEvent",Object(Kd.a)(this,this.QFb,"onCampaignLaunchedHandler"),!0);else{let Db;try{Db=JSON.stringify(J),n.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+Db)}catch(cc){Db="id : "+J.id+" telemetryEventName: "+J.telemetryEventName,n.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+Db+" Error: "+(cc?cc.toString():""))}}}}wpd(J){J=Kf.a.Yk(J);return-1!==J.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==J.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||
-1!==J.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==J.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==J.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==J.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}oAa(J){if(this.appName){const Ia={},Db={};Db.LastTeachingUIShowTime=(new Date).toUTCString();Db.AddinHasShown=J;Ia[this.appName]=Yf.c(Db);this.Kob.a3a(Ia);n.ULS.sendTraceTag(539530527,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else n.ULS.sendTraceTag(539530528,
220,10,"Fail to save roaming service since AppName is null")}Ela(){if(!this.Hda){const J=window.g_roamingAddinList;J&&(this.oAa(J),this.Hda=!0)}}e4(J){J?this.mNb(J)?(n.ULS.sendTraceTag(527523845,220,50,"should show teaching UI"),this.XN="AddinHasShown"in J&&J.AddinHasShown?J.AddinHasShown.toString():null,this.Wrb()):(n.ULS.sendTraceTag(538248466,220,50,"Not Show TeachingUI this time"),this.Mma(this.Zra,null)):(n.ULS.sendTraceTag(527523844,220,50,"userSettings is null"),this.XN=null,this.Wrb())}JM(J){n.ULS.sendTraceTag(539530529,
220,10,"GET data from Roaming Settings Service with status: {0}, fallback",J?J.httpStatus:-1);this.Mma(this.Zra,null)}HN(J){n.ULS.sendTraceTag(539530530,220,10,"failed to POST data to Roaming Settings Service with status: {0}",J?J.httpStatus:-1)}Wrb(){const J=this.w8c();0===J.targetType?(J.solutionId?this.NId(J):this.sla(null,"NoSolutionId"),this.zkg(J),this.Mma(this.Zra,null)):this.Mma(this.Zra,J);n.ULS.sendTraceTag(528023563,220,50,"Show teaching callout for: {0}",J.addinId)}NId(J){const Ia=new Pf;
Ia.callbackFunc=Db=>{if(Db.errorCode){this.sla(J.solutionId,"FailToGetAppDetails");var cc=window.g_roamingAddinList;cc&&this.oAa(cc)}else if(Db.value)for(cc of Db.value)if(Db=cc[1],Db===J.solutionId){const rc={};rc.solutionId=Db;rc.assetId=cc[5];rc.storeType=cc[12];rc.storeId=cc[11];rc.assetStoreId=cc[6];rc.targetType=cc[3];rc.width=cc[7];rc.height=cc[8];rc.displayName=cc[0];rc.version=cc[4];n.ULS.sendTraceTag(0,220,50,"Raise a teaching callout event for content addin: {0}.",J.solutionId);cc=new Hg(rc);
this.Pa.raiseEvent(la.a.yUd,cc);break}};Ia.storeType=OSF.StoreTypeEnum.PrivateCatalog;Ia.fromInsertDialog=!1;Ia.refresh=!1;this.Ng.queryEntitlementDetails(Ia)}mNb(J){if("LastTeachingUIShowTime"in J){if(J=+new Date-+new Date(J.LastTeachingUIShowTime.toString()),J<Cd.AFrameworkApplication.fa.FM("AddinShowTeachingUIIntervalInMS",864E5))return n.ULS.sendTraceTag(538248467,220,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",J),!1}else n.ULS.sendTraceTag(527523846,220,50,"userSetting has no date key");
return!0}w8c(){let J=new De.a(new Gg,0),Ia=new De.a(new Gg,0),Db=0,cc=0,rc=0;var Tc=new l.a;for(var bd of this.Zra)Tc.add(bd);for(let nd of this.QHa)Tc.add(nd);for(let nd of Tc)if(!("excatalog"!==nd.storeType||Xd.c(nd.installTimeInMS)||!nd.installTimeInMS||nd.installTimeInMS<=Cd.AFrameworkApplication.fa.FM("DateTimeInMSForNewAddin",16409952E5))){Tc=vg.mwb(nd);if(this.XN&&(bd=this.XN.split(","),0<bd.length&&Array.contains(bd,Tc))){rc++;n.ULS.sendTraceTag(528345032,220,50,"This addin has shown teaching UI before");
continue}Tc.startsWith("private_")?(J=vg.p4e(nd,J),cc++):(Ia=vg.p4e(nd,Ia),Db++)}n.ULS.sendTraceTag(528345033,220,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",cc,Db,rc);return 0<Ia.value?Ia.key:0<J.value?J.key:Object.assign(new Gg,{addinId:null,targetType:-1,solutionId:null})}sla(J,Ia,Db=null){J={["AppTeachingUICalloutAction"]:Ia,["SDX.Id"]:J,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};if(Db)for(let cc of Db.keys)J[cc]=
Db.ma(cc);sa.a.sendTelemetryEvent(Object.assign(new Lf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:bc.a.Mi(J)}))}zkg(J){J&&(window.g_roamingAddinList=this.XN?this.XN+","+J.addinId:J.addinId)}static PU(J){return Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,J.storeType,J.assetId,null,null,J.storeId)}static p4e(J,Ia){return Ia.value<J.installTimeInMS?new De.a(Object.assign(new Gg,{addinId:vg.mwb(J),targetType:J.targetType,solutionId:J.solutionId}),J.installTimeInMS):
Ia}static mwb(J){return Telemetry.PrivacyRules.IsPrivateAddin(J.storeType,J.assetId,null,null,J.storeId)?"private_"+J.installTimeInMS:J.solutionId}}Object(d.a)(vg,"PrivateCatalogTeachingCalloutHandler2",null,[]);var rg=a(79);const lh=()=>{const J=rg.a.uZ(window.location.href.toLowerCase(),"wdomexsrctype");return!!J&&"4"===J},$g=()=>rg.a.uZ(window.location.href.toLowerCase(),"wdtpl"),Tg=()=>{const J=rg.a.uZ(window.location.href.toLowerCase(),"wdomexsrctype");return!!J&&"1"===J};var mh=a(831),Qg=a(696);
class Vg{constructor(J){this.Ir=null;this.Vt=J}get_current(){if(!this.Ir)throw Error.argumentOutOfRange();return this.Ir.data}moveNext(){if(!this.Ir)return this.Ir=this.Vt,!!this.Vt;if(!this.Ir.next)return!1;this.Ir=this.Ir.next;return!0}Anc(){if(!this.Ir)return this.Ir=this.Vt,!!this.Vt;if(!this.Ir.previous)return!1;this.Ir=this.Ir.previous;return!0}reset(){this.Ir=this.Vt}}Object(d.a)(Vg,"ListEnumerator",null,[0]);class og{constructor(J,Ia,Db){this.next=Db;this.previous=Ia;this.data=J}}Object(d.a)(og,
"ListNode",null,[]);class wf{constructor(){this.kA=this.fq=null;this._count=0}add(J){this.fq?this.kA=this.kA.next=new og(J,this.kA,null):this.fq=this.kA=new og(J,null,null);this._count=this.count+1}insert(J,Ia){if(J>this.count||0>J)throw Error.argumentOutOfRange("pos");if(J===this.count)this.add(Ia);else{for(var Db=this.fq;0!==J--;)Db=Db.next;J=new og(Ia,Db.previous,Db);J.previous?J.previous.next=J:this.fq=J;J.next?J.next.previous=J:this.kA=J;this._count=this.count+1}}remove(J){let Ia=this.fq;for(;Ia&&
Ia.data!==J;)Ia=Ia.next;if(!Ia)return!1;Ia.previous?Ia.previous.next=Ia.next:this.fq=Ia.next;Ia.next?Ia.next.previous=Ia.previous:this.kA=Ia.previous;this._count=this.count-1;return!0}clear(){let J=this.fq,Ia;for(this.kA=this.fq=null;J;)Ia=J.next,J.previous=null,J.next=null,J=Ia;this._count=0}indexOf(J){let Ia=this.fq,Db=0;for(;Ia&&Ia.data!==J;)Ia=Ia.next,Db++;return Ia?Db:-1}ma(J){return this.at(J).data}get count(){return this._count}getEnumerator(){return new Vg(this.fq)}[Symbol.iterator](){return Object(Qg.a)(this.getEnumerator())}mcc(J){J=
this.at(J);return new Vg(J)}toArray(){const J=Array(this.count);let Ia=0;for(let Db of this)J[Ia]=Db,Ia++;return J}at(J){let Ia=this.fq,Db=0;for(;Db!==J;){if(!Ia)throw Error.argumentOutOfRange("pos");Ia=Ia.next;Db++}return Ia}}Object(d.a)(wf,"List",null,[1]);class oa extends Sys.EventArgs{constructor(J){super();this.properties=J}}Object(d.a)(oa,"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);class ob{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(d.a)(ob,
"MiniAddinInfo",null,[]);class jc{constructor(J,Ia,Db){this.Pa=new If.a;this.context=new Bf;this.lUc=this.$Vd=this.hGa=this.XN=this.jX=null;this.contextActivationMgr=J;this.CPg=Ia;this.iGa=Db;this.appName=Cd.AFrameworkApplication.fa.Wa("WebAppShortName")}get OOb(){this.lUc||(this.lUc=new vg(this.Pa));return this.lUc}GLg(J){this.Pa.addHandler(la.a.Fob,J)}aPg(J){this.Pa.addHandler(la.a.yUd,J)}pXj(J){null!==J&&(this.context.MN=J[la.a.iP],this.context.Rp=J[la.a.VL],this.context.KCc=this.context.Wsc=0,
J=la.a.jGa in J?J[la.a.jGa]:0,-1!==this.context.MN&&0!==this.context.Rp&&(this.context.C9=new wf,this.context.kja=new wf,this.context.e5b=new wf,this.context.bYc=this.CPg.createAddinDataProvider(mh.a(this.context.MN),this.contextActivationMgr),this.context.bYc?this.context.bYc.getEntitlementsAsync(this.contextActivationMgr.Mca,!0,J,Ia=>{this.tWi(Ia)}):n.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.MN)))}tWi(J){if(J&&0<J.length){this.context.KCc=J.length;const Db=
Cd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")?$g():null;for(let cc=0;cc<J.length;cc++){const rc=J[cc];if(Cd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")&&Tg()&&rc&&rc.storeType&&"omex"===rc.storeType.toLowerCase()&&rc.assetId&&Db&&rc.assetId.toLowerCase()===Db.toLowerCase()){var Ia={["SDX_AppInstallOrigin"]:"DeeplinkUser",["SDX_Id"]:jc.PU(rc)};sa.a.sendTelemetryEvent(Object.assign(new Lf.a,{name:"Office.Extensibility.Host.AppInstall",
dataFields:bc.a.Mi(Ia)}))}!rc||1!==rc.targetType&&-1!==rc.targetType?this.zoc():(Ia={},Cd.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(Ia.solutionId=rc.solutionId,Ia.version=rc.version):(Ia.marketplaceId=rc.solutionId,Ia.marketplaceVersion=rc.version),Ia.storeType=rc.storeType,Ia.storeId=rc.storeId,Ia.targetData=rc,jc.POb?this.contextActivationMgr.isAddinCommandsExAsync(Ia,Object(Kd.a)(this,this.PVi,"onIsAddinCommandsExCompleted")):
this.contextActivationMgr.isAddinCommandsAsync(Ia,(Tc,bd,nd)=>{Tc?(bd&&this.context.C9.add(nd.targetData),10===this.context.MN&&(Tc=nd.targetData,bd=Tc.targetType,Xd.c(nd.targetTypeForExp)||(bd=nd.targetTypeForExp,Tc.targetType=bd),this.context.kja.add(Tc),0===bd&&this.context.e5b.add(Tc))):(nd=nd.targetData,n.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(nd.solutionId,nd.storeType,nd.assetId,null,null,nd.storeId),nd.storeType));
this.zoc()}))}}else this.zoc()}zoc(){var J;(J=this.context).Wsc=J.Wsc+1;this.context.Wsc>=this.context.KCc&&(this.iGa.F3f(this.context.MN,!1),0<this.context.KCc&&10===this.context.MN&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(J=!1,Cd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")&&lh()&&(J=this.rCi()),this.EBi(),Cd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",
!1)&&!J?jc.POb?this.OOb.OZd(this.contextActivationMgr,this.context.aYc,this.context.QHa,(Ia,Db)=>{const cc=new l.a;for(let rc of Ia)Ia=rc.hfg(),Db&&Db.solutionId===rc.solutionId&&(Ia.showCallout=!0,this.OOb.zkg(Db)),cc.add(Ia);this.Mma(cc)}):this.rOh(this.context.C9):this.o_b(this.context.C9)):this.o_b(this.context.C9))}o_b(J){if(jc.POb)this.Mma(this.s8g(this.context.aYc));else{var Ia=new l.a;if(J)for(let Db of this.context.C9)Ia.add(ng(Db));this.context.C9&&1>this.context.C9.count&&Jf.a.agb(la.a.Gob,
"false",this.context.MN);J={["ack2"]:Ia};J[la.a.iP]=this.context.MN;J[la.a.VL]=this.context.Rp;this.Pa.raiseEvent(la.a.Fob,new oa(J),this)}}s8g(J){const Ia=new l.a;if(J)for(let Db of J)Ia.add(Db.hfg());return Ia}Mma(J){J&&J.count||Jf.a.agb(la.a.Gob,"false",this.context.MN);J={["ack2"]:J};J[la.a.iP]=this.context.MN;J[la.a.VL]=this.context.Rp;this.Pa.raiseEvent(la.a.Fob,new oa(J),this)}oAa(J){if(this.appName){const Ia={},Db={};Db.LastTeachingUIShowTime=(new Date).toUTCString();Db.AddinHasShown=J;Ia[this.appName]=
Yf.c(Db);this.jX&&(this.jX.a3a(Ia),n.ULS.sendTraceTag(539530527,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service"))}else n.ULS.sendTraceTag(539530528,306,10,"Fail to save roaming service since AppName is null")}rOh(J){(this.hGa=J)?(J=new l.a,J.add(this.appName),this.jX=new Dg(this.appName,Object(Kd.a)(this,this.e4,"getRequestSuccessCallback"),Object(Kd.a)(this,this.JM,"getRequestFailureCallback"),Object(Kd.a)(this,this.HN,"postRequestFailureCallback")),
this.jX.p$b(J)):(J={["ack2"]:new l.a},J[la.a.iP]=this.context.MN,J[la.a.VL]=this.context.Rp,this.Pa.raiseEvent(la.a.Fob,new oa(J),this))}e4(J){J?this.mNb(J)?(n.ULS.sendTraceTag(527523845,306,50,"should show teaching UI"),this.XN="AddinHasShown"in J&&J.AddinHasShown?J.AddinHasShown.toString():null,this.Wrb()):(n.ULS.sendTraceTag(538248466,306,50,"Not Show TeachingUI this time"),this.o_b(this.hGa)):(n.ULS.sendTraceTag(527523844,306,50,"userSettings is null"),this.XN=null,this.Wrb())}JM(J){n.ULS.sendTraceTag(539530529,
306,10,"GET data from Roaming Settings Service with status: {0}, fallback",J?J.httpStatus:-1);this.o_b(this.hGa)}HN(J){n.ULS.sendTraceTag(539530530,306,10,"failed to POST data to Roaming Settings Service with status: {0}",J?J.httpStatus:-1)}Wrb(){const J=this.w8c();0===J.targetType?(J.solutionId?(this.$Vd=J.solutionId,this.NId()):this.sla("NoSolutionId"),J.addinId&&(window.g_roamingAddinList=this.XN?this.XN+","+J.addinId:J.addinId),this.Zoe(null)):this.Zoe(J.addinId);n.ULS.sendTraceTag(528023563,
306,50,"Show teaching callout for: {0}",J.addinId)}NId(){const J=new Pf;J.callbackFunc=Ia=>{if(Ia.errorCode){this.sla("FailToGetAppDetails");var Db=window.g_roamingAddinList;Db&&this.oAa(Db)}else if(Ia.value)for(Db of Ia.value)if(Ia=Db[1],Ia===this.$Vd){const cc={};cc.solutionId=Ia;cc.assetId=Db[5];cc.storeType=Db[12];cc.storeId=Db[11];cc.assetStoreId=Db[6];cc.targetType=Db[3];cc.width=Db[7];cc.height=Db[8];cc.displayName=Db[0];cc.version=Db[4];Db=new Hg(cc);this.Pa.raiseEvent(la.a.yUd,Db);break}};
J.storeType=OSF.StoreTypeEnum.PrivateCatalog;J.fromInsertDialog=!1;J.refresh=!1;this.contextActivationMgr.queryEntitlementDetails(J)}mNb(J){if("LastTeachingUIShowTime"in J){if(J=+new Date-+new Date(J.LastTeachingUIShowTime.toString()),J<Cd.AFrameworkApplication.fa.FM("AddinShowTeachingUIIntervalInMS",864E5))return n.ULS.sendTraceTag(538248467,306,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",J),!1}else n.ULS.sendTraceTag(527523846,306,50,"userSetting has no date key");return!0}w8c(){let J=
new De.a(new ob,0),Ia=new De.a(new ob,0),Db=0,cc=0,rc=0;var Tc=new wf;if(0<this.context.C9.count)for(var bd of this.context.C9)Tc.add(bd);if(0<this.context.e5b.count)for(let nd of this.context.e5b)Tc.add(nd);for(let nd of Tc)if(!("excatalog"!==nd.storeType||Xd.c(nd.installTimeInMS)||!nd.installTimeInMS||nd.installTimeInMS<=Cd.AFrameworkApplication.fa.FM("DateTimeInMSForNewAddin",16409952E5))){Tc=jc.mwb(nd);if(this.XN&&(bd=this.XN.split(","),0<bd.length&&Array.contains(bd,Tc))){rc++;n.ULS.sendTraceTag(528345032,
306,50,"This addin has shown teaching UI before");continue}Tc.startsWith("private_")?(J.value<nd.installTimeInMS&&(J=new De.a(Object.assign(new ob,{addinId:Tc,targetType:nd.targetType,solutionId:nd.solutionId}),nd.installTimeInMS)),cc++):(Ia.value<nd.installTimeInMS&&(Ia=new De.a(Object.assign(new ob,{addinId:Tc,targetType:nd.targetType,solutionId:nd.solutionId}),nd.installTimeInMS)),Db++)}n.ULS.sendTraceTag(528345033,306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",
cc,Db,rc);return 0<Ia.value?Ia.key:0<J.value?J.key:Object.assign(new ob,{addinId:null,targetType:-1,solutionId:null})}Zoe(J){const Ia=new l.a;for(let Db of this.hGa){const cc=ng(Db);if(J){const rc=jc.mwb(Db);J===rc&&(cc.showCallout=!0,window.g_roamingAddinList=this.XN?this.XN+","+J:J)}Ia.add(cc)}this.hGa&&1>this.hGa.count&&Jf.a.agb(la.a.Gob,"false",this.context.MN);J={["ack2"]:Ia};J[la.a.iP]=this.context.MN;J[la.a.VL]=this.context.Rp;this.Pa.raiseEvent(la.a.Fob,new oa(J),this)}rCi(){if(jc.POb)return this.sCi(this.context.hed);
var J=!1;if(this.context.kja&&1>this.context.kja.count)return J;const Ia=$g();if(!Ia)return J;for(let Db of this.context.kja)if(Db.storeId&&Db.storeId.toLowerCase()===Ia.toLowerCase()||Db.assetId&&Db.assetId.toLowerCase()===Ia.toLowerCase())J={["SDX_Id"]:jc.PU(Db),["SDX_TargetType"]:Xd.c(Db.targetType)?"":Db.targetType.toString()},sa.a.sendTelemetryEvent(Object.assign(new Lf.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:bc.a.Mi(J)})),J=!0;return J}EBi(){if(jc.POb)this.FBi(this.context.hed);
else if(!(this.context.kja&&1>this.context.kja.count))if(this.iGa.akf()){var J=this.iGa.i6e();J?(J=this.U1e(this.context.kja,J),n.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(J=this.U1e(this.context.kja,null),n.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.iGa.e6f(J)}else n.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}U1e(J,Ia){const Db={};let cc=!1;for(let rc of J)if(J=jc.PU(rc))!Ia||J in Ia||(this.h_(rc,J),n.ULS.sendTraceTag(527523849,
306,50,"New addin detected,log to AppInstall")),"private"===J.toLowerCase()?cc||(cc=!0,Db[J]=null):Db[J]=null;return Db}h_(J,Ia){var Db=J.installTimeInMS?(new Date(J.installTimeInMS)).toISOString():"";Db={["SDX.Id"]:Ia,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:Xd.c(J.targetType)?"":J.targetType.toString(),["SDX.AdminDeploymentTime"]:Db};sa.a.sendTelemetryEvent(Object.assign(new Lf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:bc.a.Mi(Db)}));1===J.targetType&&(J={["SDX.Id"]:Ia,
["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},sa.a.sendTelemetryEvent(Object.assign(new Lf.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:bc.a.Mi(J)})))}sCi(J){let Ia=!1;if(J&&1>J.count)return Ia;const Db=$g();if(!Db)return Ia;for(let cc of J)if(cc.storeId&&cc.storeId.toLowerCase()===Db.toLowerCase()||cc.assetId&&cc.assetId.toLowerCase()===Db.toLowerCase())J={["SDX_Id"]:jc.l6e(cc),["SDX_TargetType"]:Xd.c(cc.targetType)?"":cc.targetType.toString()},sa.a.sendTelemetryEvent(Object.assign(new Lf.a,
{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:bc.a.Mi(J)})),Ia=!0;return Ia}FBi(J){if(!(J&&1>J.count))if(this.iGa.akf()){var Ia=this.iGa.i6e();Ia?(J=this.V1e(J,Ia),n.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(J=this.V1e(J,null),n.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.iGa.e6f(J)}else n.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}V1e(J,Ia){const Db={};let cc=!1;for(let rc of J)if(J=jc.l6e(rc))!Ia||J in
Ia||(this.zEi(rc,J),n.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===J.toLowerCase()?cc||(cc=!0,Db[J]=null):Db[J]=null;return Db}zEi(J,Ia){var Db=J.installTimeInMS?(new Date(J.installTimeInMS)).toISOString():"";Db={["SDX.Id"]:Ia,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:Xd.c(J.targetType)?"":J.targetType.toString(),["SDX.AdminDeploymentTime"]:Db};sa.a.sendTelemetryEvent(Object.assign(new Lf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:bc.a.Mi(Db)}));
1===J.targetType&&(J={["SDX.Id"]:Ia,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},sa.a.sendTelemetryEvent(Object.assign(new Lf.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:bc.a.Mi(J)})))}PVi(J,Ia,Db,cc){J?(-1===cc.targetType&&(cc.targetType=Db.targetTypeForExp),J=new yg(Db.targetData,cc),Ia&&this.context.aYc.add(J),10===this.context.MN&&(this.context.hed.add(J),0===J.targetType&&this.context.QHa.add(J))):(Ia=Db.targetData,n.ULS.sendTraceTag(542978528,220,
15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Ia.solutionId,Ia.storeType,Ia.assetId,null,null,Ia.storeId),Ia.storeType));this.zoc()}sla(J){J={["AppTeachingUICalloutAction"]:J,["SDX.Id"]:this.$Vd,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};sa.a.sendTelemetryEvent(Object.assign(new Lf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:bc.a.Mi(J)}))}static get POb(){return Cd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",
!1)}static PU(J){return Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,J.storeType,J.assetId,null,null,J.storeId)}static l6e(J){return Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,J.storeType,J.assetId,null,null,J.storeId)}static mwb(J){return Telemetry.PrivacyRules.IsPrivateAddin(J.storeType,J.assetId,null,null,J.storeId)?"private_"+J.installTimeInMS:J.solutionId}}Object(d.a)(jc,"AddInCommandsListLoader",null,[]);class Bc{constructor(J){this.tBg=J}get Mca(){return this.tBg}insertOsfControl(J){return this.Mca.insertOsfControl(J)}getManifestInvaildErrorString(){return this.Mca.getManifestInvaildErrorString()}isAddinCommandsAsync(J,
Ia){this.Mca.isAddinCommandsAsync(J,Ia)}isAddinCommandsExAsync(J,Ia){this.Mca.isAddinCommandsExAsync(J,Ia)}ownerAddinControlRecreated(J,Ia){this.Mca.ownerAddinControlRecreated(J,Ia)}queryEntitlementDetails(J){this.Mca.queryEntitlementDetails(J)}}Object(d.a)(Bc,"ContextActivationMgrWrapper",null,[831]);class ud{createAddinDataProvider(J,Ia){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(J,Ia.Mca)}static get instance(){ud.La||(ud.La=new ud);return ud.La}}ud.La=null;Object(d.a)(ud,
"OSFAddinDataProviderFactory",null,[832]);class Ud{constructor(){this.Ver=1}}Object(d.a)(Ud,"CacheItem",null,[]);class ie{constructor(J){this.pEa=J}zl(J){const Ia=this.pEa.getItem(J);if(Ia){let Db=new Ud;try{Db=Sys.Serialization.JavaScriptSerializer.deserialize(Ia,!0)}catch(cc){return this.pEa.removeItem(J),null}return Db.Data?Db.Data:Db.data}return null}BQa(J){this.pEa.removeItem(J)}}Object(d.a)(ie,"AppsDataCacheManager",null,[857]);var Be=a(798);class ff{constructor(){new ie(Be.a.instance)}F3f(J,
Ia){J=la.a.a3e()+J;Be.a.instance.setItem(J,Ia.toString())}i6e(){var J=la.a.m6e();n.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",J);J=Be.a.instance.getItem(J);return Yf.a(J)}e6f(J){const Ia=la.a.m6e();n.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",Ia);Be.a.instance.setItem(Ia,Yf.c(J))}akf(){return!!Be.a.instance.localStorage}static get instance(){ff.La||(ff.La=new ff);return ff.La}}ff.La=null;Object(d.a)(ff,"AddInCommandsCacheManager",null,[835]);class of{constructor(J){this.YBc=
null;this.Hda=!1;this.Pa=new If.a;this.aLb=this.vpa=null;this.contextActivationMgr=J;window.addEventListener&&(window.addEventListener("LaunchBEPCallout",Object(Kd.a)(this,this.eYi,"onPrimaryButtonClickedEventHandler"),!0),window.addEventListener("DismissBEPCallout",Object(Kd.a)(this,this.aGb,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseBEPCallout",Object(Kd.a)(this,this.XFb,"onCloseButtonClickedEventHandler"),!0))}get appName(){Xd.b(this.vpa)&&(this.vpa=Cd.AFrameworkApplication.fa.Wa("WebAppShortName"));
return this.vpa}ANg(J){this.Pa.addHandler(la.a.Upf,J)}OZd(){this.contextActivationMgr.queryStoreDisabled("omex",J=>{J?n.ULS.sendTraceTag(509686157,344,50,"Store is disabled for current user"):this.SVj()})}SVj(){this.YBc=new Dg(this.appName,Object(Kd.a)(this,this.e4,"getRequestSuccessCallback"),Object(Kd.a)(this,this.JM,"getRequestFailureCallback"),Object(Kd.a)(this,this.HN,"postRequestFailureCallback"));this.YBc.bEh()}e4(J){this.mNb(J)&&(n.ULS.sendTraceTag(509690977,344,50,"should show teaching UI"),
this.mVd())}JM(J){n.ULS.sendTraceTag(509690976,344,10,"Failed to GET data from Roaming Settings with status: {0}",J?J.httpStatus:-1)}HN(J){n.ULS.sendTraceTag(509690975,344,10,"Failed to POST data to Roaming Settings with status: {0}",J?J.httpStatus:-1)}mNb(J){if(!J)n.ULS.sendTraceTag(509690974,344,50,"userSettings is null");else if("Platforms"in J&&(this.aLb=Object(V.a)(String,J.Platforms),!Xd.b(this.aLb)&&(J=this.aLb.split(","),0<J.length&&Array.contains(J,"Web"))))return n.ULS.sendTraceTag(509690973,
344,50,"callout has shown for this platform"),!1;return!0}mVd(){const J=pc.a.instance.Tb("Common.ISystemInitiatedFeedback");if(J){var Ia=this.hOh();Xd.b(Ia)?n.ULS.sendTraceTag(509686979,344,50,"activity name is empty"):J.execute(Db=>{Db.logActivity(Ia,null)})}else n.ULS.sendTraceTag(509690972,344,50,"Error resolving ISystemInitiatedFeedback Future")}eYi(){this.h_("ClickOnLaunch");this.sPd();this.Pa.raiseEvent(la.a.Upf)}XFb(){this.h_("ClickOnClose");this.sPd()}aGb(){this.h_("ClickOnDismiss");this.sPd()}hOh(){let J;
switch(this.appName){case "Word":J="WordShowCalloutForBEPHomeTab";break;case "Excel":J="ExcelShowCalloutForBEPHomeTab";break;case "PowerPoint":J="PPTShowCalloutForBEPHomeTab";break;default:J=""}return J}h_(J){J={["AppTeachingUICalloutAction"]:J,["AppTeachingUICalloutGoal"]:"BetterEntryPoint"};sa.a.sendTelemetryEvent(Object.assign(new Lf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:bc.a.Mi(J)}))}sPd(){if(!this.Hda)if(Xd.b(this.appName))n.ULS.sendTraceTag(509690970,344,10,"Fail saving to roaming service since AppName is null");
else{const J={};J[this.appName]=this.aLb?this.aLb+",Web":"Web";this.YBc&&(this.YBc.gEh(J),n.ULS.sendTraceTag(509690971,344,50,"Initiating call to save Roaming Settings for current user"));this.Hda=!0}}}Object(d.a)(of,"BetterEntryTeachingCalloutLauncher",null,[]);class sg{constructor(J,Ia,Db,cc,rc,Tc){this.Rp=J;this.fk=Ia;this.vW=Db;this.displayName=rc;this.Rof=Tc}}Object(d.a)(sg,"PostLaunchAddinCommandsParameters",null,[]);class nh{constructor(J,Ia,Db){this.Hda=!1;this.jX=null;this.Za=J;this.Ujb=
Ia;this.lhb=Db}EWc(){window.addEventListener?(window.addEventListener("LaunchAddinTaskpane",Object(Kd.a)(this,this.IDd,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(Kd.a)(this,this.aGb,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(Kd.a)(this,this.XFb,"onCloseButtonClickedEventHandler"),!0),window.addEventListener("FGWebSurfaceEvent",Object(Kd.a)(this,this.QFb,"onCampaignLaunchedHandler"),!0)):n.ULS.sendTraceTag(525112601,
220,15,"AddEventListenerForTeachingCallout failed to get Window")}IDd(){const J={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:nh.PU(this.Ujb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};this.lhb&&this.lhb.tabs&&!this.lhb.tabs[0].isOfficeTab&&(J["SDX.FeatureFlags"]="NonOfficeTab");sa.a.sendTelemetryEvent(Object.assign(new Lf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:bc.a.Mi(J)}));this.Ela();this.lhb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.lhb,
()=>{const Ia=new Cg;Ia.fk=this.Ujb;this.Za.raiseEvent(la.a.yvd,Ia)}):n.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}XFb(){const J={["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:nh.PU(this.Ujb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};sa.a.sendTelemetryEvent(Object.assign(new Lf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:bc.a.Mi(J)}));this.Ela()}aGb(){const J=
{["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:nh.PU(this.Ujb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};sa.a.sendTelemetryEvent(Object.assign(new Lf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:bc.a.Mi(J)}));this.Ela()}QFb(J){if(J&&(J=J.detail)&&J.id&&this.wpd(J.id)){const Db=(J.action||"").toLowerCase();if(J.success&&"opened"===Db){var Ia={["AppTeachingUICalloutAction"]:"CampaignLaunched",["SDX.Id"]:nh.PU(this.Ujb),
["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};sa.a.sendTelemetryEvent(Object.assign(new Lf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:bc.a.Mi(Ia)}));n.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming.");this.Ela();window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",Object(Kd.a)(this,this.QFb,"onCampaignLaunchedHandler"),!0)}else try{Ia=JSON.stringify(J),n.ULS.sendTraceTag(523321995,
220,15,"Campaign launch failure. Event:"+Ia)}catch(cc){Ia="id : "+J.id+" telemetryEventName: "+J.telemetryEventName,n.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+Ia+" Error: "+(cc?cc.toString():""))}}}wpd(J){J=Kf.a.Yk(J);return-1!==J.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==J.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==J.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==J.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==J.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||
-1!==J.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}oAa(J){const Ia=Cd.AFrameworkApplication.fa.Wa("WebAppShortName");if(Ia){const Db={},cc={};cc.LastTeachingUIShowTime=(new Date).toUTCString();cc.AddinHasShown=J;Db[Ia]=Yf.c(cc);this.jX=new Dg(Ia,null,null,Object(Kd.a)(this,this.HN,"postRequestFailureCallback")),this.jX.a3a(Db),n.ULS.sendTraceTag(523535564,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else n.ULS.sendTraceTag(523535565,
220,10,"Fail to save roaming service since AppName is null")}Ela(){if(!this.Hda){const J=window.g_roamingAddinList;J&&(this.oAa(J),this.Hda=!0)}}HN(J){n.ULS.sendTraceTag(523535566,220,10,"failed to POST data to Roaming Settings Service with status: {0}",J?J.httpStatus:-1)}static PU(J){return Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,J.storeType,J.assetId,null,null,J.storeId)}}Object(d.a)(nh,"PrivateCatalogTeachingCalloutHandler",null,[]);class Ah{constructor(J){this.Bce=null;this.rae=
J}get txa(){return this.Bce}OYa(J,Ia=null){this.rae.OYa(J,Ia);this.Bce=J}ILd(J){this.rae.ILd(J)}}Object(d.a)(Ah,"RibbonExtensibilityManagerWithChangeDetection",null,[853]);var fh=a(833),Oh=a(100);class Eg{static R3e(J){const Ia=new l.a;if(Eg.bFe)for(var Db of Eg.bFe)Ia.add(Db);Db=null;switch(J){case "Workbook":Db=Eg.e7j;break;case "Document":Db=Eg.$oh;break;case "Presentation":Db=Eg.K8i}if(Db)for(const cc of Db)Ia.add(cc);return Ia}}Eg.bFe=["PrimaryCommandSurface","ContextMenu"];Eg.e7j=null;Eg.$oh=
null;Eg.K8i=null;Object(d.a)(Eg,"ExtensionPointType",null,[]);class gh{constructor(J){this.Cfe=null;if(Xd.c(J))throw n.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");this.Fsg=J}get EFb(){return this.Cfe||(this.Cfe=new l.a)}get Hse(){return this.Fsg}}Object(d.a)(gh,"ContextMenuExtensibility",null,[841]);class hh{constructor(J,Ia=null,Db=0){if(Xd.c(J))throw n.ULS.sendTraceTag(9041814,220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),
Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");this.mBg=J;this.BEg=Ia;this.hxg=Db}get KV(){return this.mBg}get startedNode(){return this.BEg}get ENh(){return this.hxg}}Object(d.a)(hh,"RibbonExtensibility",null,[870]);class Ig{constructor(J){this.hwg=J.entitlement}get entitlement(){return this.hwg}createActionContext(J,Ia){J={};J.ownerAddinInfo=this.entitlement;J.action=Ia;return J}}Object(d.a)(Ig,"AddInCommandsContextProvider",null,[]);class se{constructor(J,Ia,
Db){this.A4d=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=J;this.eventBuilder=Ia;this.contextMenuBuilder=Db}get addinInfo(){return this.A4d}ych(J){return new Ig(J)}createActionBuilder(J,Ia){return OfficeExt.DefaultControlActionBinder.createActionBuilder(J,Ia.entitlement,Ia.manifest)}startApplyAddin(J){this.A4d=J;const Ia=this.ych(J);this.actionBuilder=this.createActionBuilder(Ia,J)}endApplyAddin(){}Jed(J,Ia,Db=0){return this.ribbonBuilder.Ks&&
0<this.ribbonBuilder.Ks.count?new hh(this.TMh(J,Ia),this.addinInfo.startedNode,Db):null}u_e(){var J=null;if(this.contextMenuBuilder.enc&&0<this.contextMenuBuilder.enc.count){J||(J=this.addinInfo.entitlement.solutionId);J=new gh(J);for(let Ia of this.contextMenuBuilder.enc)J.EFb.add(Ia);return J}return null}TMh(J,Ia){return this.ribbonBuilder.Ks&&0<this.ribbonBuilder.Ks.count?new Ke.a(this.ribbonBuilder.Ks,J,Ia):null}}Object(d.a)(se,"AddinCommandsBuilder",null,[]);class K{constructor(J,Ia,Db,cc,rc,
Tc,bd){this.gTa=new Oh.a;this.Rp=J;this.Ng=Ia;this.Mo=Db;this.ribbonManager=cc;this.contextMenuManager=rc;this.DF=Tc;this.Pga=bd;this.mO=Cd.AFrameworkApplication.sa.HD}mDb(J,Ia,Db,cc,rc,Tc,bd){const nd=(Ed,Yd,Ie,Qe)=>{rc(Ed,Yd,Ie,Qe);Ed=fh.a[this.Rp]+Yd.assetId;({value:Yd}=this.gTa.Fc(Ed)).returnValue&&(Yd.stop(),this.gTa.remove(Ed))};if(0!==this.Rp&&J){n.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",J.count);4===this.Rp&&(n.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",
cc)),this.J4g(J,cc),Tc());for(let Ed of J)if(J=Ed,n.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.Mo.PM,Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,J.ownerAddinStoreType||J.storeType,J.assetId,null,null,J.storeId))),this.zmg(J))if(bd&&J.requireConsent)bd(J,Yd=>{try{if(this.mO){const Qe=fh.a[this.Rp]+Yd.solutionId,nf=this.mO.Gc("ComponentAttach",Qe);this.gTa.ia(Qe,nf)}const Ie=this.DF.Ria(Yd.storeType,Yd.solutionId);6!==this.Rp&&(Ie&&(this.V3b(Ie),Ie.oB.purge(!1)),
this.Ng.insertOsfControl(this.pIb(Yd,Ia,Db,nd)),Ie&&this.Ng.ownerAddinControlRecreated(Yd.solutionId,Yd.storeType))}catch(Ie){n.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.Mo.PM,Telemetry.PrivacyRules.GetPrivacyCompliantId(Yd.solutionId,Yd.ownerAddinStoreType||Yd.storeType,Yd.assetId,null,null,Yd.storeId),Yd.version,Yd.storeType,Yd.storeId,Ie.message)),nd(!1,Yd,null,null)}});
else try{if(this.mO){const Ie=fh.a[this.Rp]+J.solutionId,Qe=this.mO.Gc("ComponentAttach",Ie);this.gTa.ia(Ie,Qe)}const Yd=this.DF.Ria(J.storeType,J.solutionId);6!==this.Rp&&(Yd&&(this.V3b(Yd),Yd.oB.purge(!1)),this.Ng.insertOsfControl(this.pIb(J,Ia,Db,nd)),Yd&&this.Ng.ownerAddinControlRecreated(J.solutionId,J.storeType))}catch(Yd){n.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.Mo.PM,
Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,J.ownerAddinStoreType||J.storeType,J.assetId,null,null,J.storeId),J.version,J.storeType,J.storeId,Yd.message)),nd(!1,J,null,null)}else nd(!1,J,null,null)}}Wyi(J,Ia,Db,cc,rc,Tc){const bd=(nd,Ed,Yd,Ie)=>{Tc(nd,Ed,Yd,Ie);nd=fh.a[this.Rp]+Ed.solutionId;({value:Ed}=this.gTa.Fc(nd)).returnValue&&(Ed.stop(),this.gTa.remove(nd))};if(6===this.Rp&&J)if(n.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.Mo.PM,Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,
J.ownerAddinStoreType||J.storeType,J.assetId,null,null,J.storeId))),this.zmg(J))try{if(this.mO){const Ed=fh.a[this.Rp]+J.solutionId,Yd=this.mO.Gc("ComponentAttach",Ed);this.gTa.ia(Ed,Yd)}const nd=this.DF.Ria(J.storeType,J.solutionId);nd||bd(!1,J,null,null);Cd.AFrameworkApplication.sa&&Cd.AFrameworkApplication.sa.Qa.delayInstallAddInIsEnabled?this.S_e(J,Ia,cc,rc,Db,Ed=>{bd(Ed,J,Db,nd.displayName)}):(this.S_e(J,Ia,cc,rc,Db),bd(!0,J,Db,nd.displayName))}catch(nd){n.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",
this.Mo.PM,Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,J.ownerAddinStoreType||J.storeType,J.assetId,null,null,J.storeId),J.version,J.storeType,J.storeId,nd.message)),bd(!1,J,null,null)}else bd(!1,J,null,null)}PNi(J,Ia,Db,cc,rc,Tc){if(Tc)if(Tc._isAddinCommandsManifest(this.Mo.PM))try{Cd.AFrameworkApplication.sa&&Cd.AFrameworkApplication.sa.Qa.delayInstallAddInIsEnabled?this.R_e(J,Ia,Db,rc,Tc,bd=>{cc(bd,J,Tc,Tc.getDefaultDisplayName())}):(this.R_e(J,Ia,Db,rc,Tc),cc(!0,J,Tc,Tc.getDefaultDisplayName()))}catch(bd){n.ULS.sendTraceTag(17586257,
220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.Mo.PM,Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,J.ownerAddinStoreType||J.storeType,J.assetId,null,null,J.storeId),J.version,J.storeType,J.storeId,bd.message)),cc(!1,J,Tc,Tc.getDefaultDisplayName())}else n.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",
this.Mo.PM,Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,J.ownerAddinStoreType||J.storeType,J.assetId,null,null,J.storeId),J.version,J.storeType,J.storeId)),cc(!1,J,null,null);else n.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.Mo.PM,Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,J.ownerAddinStoreType||J.storeType,J.assetId,null,null,J.storeId),J.version,J.storeType,J.storeId)),
cc(!1,J,null,null)}pIb(J,Ia,Db,cc){const rc={},Tc=document.createElement("div");Tc.setAttribute("visible","false");rc.div=Tc;rc.id=J.solutionId;rc.solutionId=J.solutionId;rc.version=J.version;rc.storeType=J.storeType;rc.storeId=J.storeId;rc.assetId=J.assetId;rc.assetStoreId=J.assetStoreId;rc.isvirtualOsfControl=!0;rc.virtualOsfControlActivationCallback=(bd,nd)=>{const Ed=this.DF.Ria(J.storeType,J.solutionId);Ed&&(Ed.isUpgraded&&(J.isUpgraded=!0),this.V3b(Ed));this.PNi(J,Ia,Db,cc,bd,nd)};rc.reason=
3===this.Rp?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;return rc}R_e(J,Ia,Db,cc,rc,Tc=null){const bd={};bd.solutionId=cc.getSolutionId();bd.version=cc.getVersion();bd.storeType=cc.getStoreType();bd.storeId=cc.getStoreId();bd.assetId=cc.getAssetId();bd.assetStoreId=cc.getAssetStoreId();bd.targetType=cc.getOsfControlType();let nd=null,Ed=null;if(Cd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1))nd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.Mo.PM,this.Mo.formFactor)).parseExtensions(bd,rc,this.Pga),Ed=Eg.R3e(this.Mo.PM);else try{nd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.Mo.PM,this.Mo.formFactor)).parseExtensions(bd,rc,this.Pga),Ed=Eg.R3e(this.Mo.PM)}catch(Ie){throw n.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+Ie.message),Ie;}if(Ed&&0<Ed.count){if(Cd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1)){var Yd=Ia(J);Ia=Db(J);Db=!!Cd.AFrameworkApplication.fa&&Cd.AFrameworkApplication.fa.pa("AddinCommandsMultipleCustomTabsEnabled");Yd=new se(Yd,null,Ia);for(let Ie of Ed)Yd.commandSurface=Ie,nd.apply(Yd,this.Pga,Db)}else try{let Ie=Ia(J),Qe=Db(J),nf=!!Cd.AFrameworkApplication.fa&&Cd.AFrameworkApplication.fa.pa("AddinCommandsMultipleCustomTabsEnabled");Yd=new se(Ie,null,Qe);for(let xg of Ed)Yd.commandSurface=xg,nd.apply(Yd,this.Pga,nf)}catch(Ie){throw n.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+
Ie.message),Ie;}if(OSF.OUtil.checkFlight(14))try{let Ie=Yd.Jed(J.solutionId,rc.getDefaultDisplayName()),Qe=Yd.u_e();Ie&&this.ribbonManager.OYa(Ie,Tc);Qe&&this.contextMenuManager.Aoe(Qe);this.DF.gpe(cc,Ie,Qe,rc.getDefaultDisplayName());n.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",rc.getDefaultDisplayName())}catch(Ie){throw OfficeExt.DevConsole.log(Ie),n.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+Ie.message),Ie;}else try{let Ie=Yd.Jed(J.solutionId,
rc.getDefaultDisplayName()),Qe=Yd.u_e();Ie&&this.ribbonManager.OYa(Ie);Qe&&this.contextMenuManager.Aoe(Qe);this.DF.gpe(cc,Ie,Qe,rc.getDefaultDisplayName());n.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",rc.getDefaultDisplayName())}catch(Ie){throw n.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+Ie.message),Ie;}}}S_e(J,Ia,Db,cc,rc,Tc=null){const bd={};bd.solutionId=J.solutionId;bd.version=J.version;bd.storeType=J.storeType;bd.storeId=J.storeId;bd.assetId=
J.assetId;bd.assetStoreId=J.assetStoreId;bd.targetType=J.targetType;const nd=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.Mo.PM,this.Mo.formFactor);try{const Ed=Ia.getManifest(),Yd=nd.parse(bd,Ed,rc,this.Pga,Ia.getSharedRuntimeId(),Ia),Ie=Db(J),Qe=cc(J),nf=new se(Ie,null,Qe);nf.commandSurface="PrimaryCommandSurface";Yd.apply(nf,this.Pga,!0);if(nf.ribbonBuilder.Ks&&0<nf.ribbonBuilder.Ks.count){const xg=nf.Jed(J.solutionId,Ia.getManifest().getDefaultDisplayName(),1);Cd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",
!1)?this.ribbonManager.OYa(xg,Tc):xg&&this.ribbonManager.OYa(xg,Tc);this.DF.OJg(Ia,xg,rc,Ia.getManifest().getDefaultDisplayName());n.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",Ia.getManifest().getDefaultDisplayName())}}catch(Ed){n.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",Ia.getManifest().getDefaultDisplayName(),Ed.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(Ed)}}V3b(J){J.Do&&this.ribbonManager.ILd(J.Do);
J.jsb&&this.contextMenuManager.Uhj(J.jsb);this.DF.Chj(J.oB.getStoreType(),J.oB.getSolutionId())}J4g(J,Ia){Ia=mh.a(Ia);for(let Db of this.DF.l6a){if(Db.oB.getStoreType()!==Ia)continue;let cc=!0;for(let rc of J){const Tc=rc;if(Tc&&Db.Xlf(Tc.storeType,Tc.solutionId)){cc=!1;break}}cc&&(this.V3b(Db),Db.oB.purge(!1))}}zmg(J){return!!J&&!!J.solutionId&&!!J.version&&!!J.storeType&&!!J.storeId}}Object(d.a)(K,"AddInCommandsIntegration",null,[]);class A{constructor(J,Ia,Db,cc,rc,Tc,bd,nd=null){this.Za=new If.a;
this.VGc=J;this.Zug=Ia;this.Gl=Db;this.Ole=cc;this.zXa=rc;this.tsg=Tc;this.JRb=bd;this.dBg=nd;this.Vyg=Cd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled");this.VMc=Cd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")}HLg(J){this.Za.addHandler(la.a.$re,J)}zNg(J){this.Za.addHandler(la.a.yvd,J)}$Og(J){this.Za.addHandler(la.a.x9f,J)}OLg(J){this.Za.addHandler(la.a.b_c,J)}pzi(J,Ia,Db){const cc=Db[la.a.Eob],
rc=void 0===Db[la.a.VL]?0:Db[la.a.VL];if(cc&&0!==rc)if(0>=cc.count&&4!==rc)this.GNf(new sg(rc,null,null,Ia,null,!0));else{var Tc=cc.count,bd=new Ah(new sf),nd=void 0===Db[la.a.iP]?-1:Db[la.a.iP],Ed=new K(rc,this.Gl,this.VGc,bd,this.Zug,this.zXa,this.JRb),Yd=jg=>this.Ole.YYg(jg.solutionId,this.JRb,this.VGc,J),Ie=jg=>this.Ole.hYg(jg.solutionId),Qe=(jg,ag,eg)=>{Tc--;eg=new sg(rc,ag,bd,Ia,eg,0>=Tc);if(jg&&ag)this.GNf(eg);else{if(3===rc||ag&&ag.isUpgraded)jg="",ag&&(jg=Telemetry.PrivacyRules.GetPrivacyCompliantId(ag.solutionId,
ag.ownerAddinStoreType||ag.storeType,ag.assetId,null,null,ag.storeId)),ag={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"onAddinCompletedBase.fail",["SDX_Id"]:jg},sa.a.sendTelemetryEvent(Object.assign(new Lf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:bc.a.Mi(ag)}));this.FNf(eg)}Tc||Cd.AFrameworkApplication.sa.updateCommandUI()},nf=(jg,ag,eg,pg)=>{Qe(jg,ag,pg)},xg=()=>{this.tBd();0>=cc.count&&4===rc&&this.zXa.rRd()};6===rc?(nd=Db[la.a.VIa],Db=Db[la.a.WIa],Ed.Wyi(cc.ma(0),
nd,Db,Yd,Ie,(jg,ag,eg,pg)=>{Qe(jg,ag,pg)})):Ed.mDb(cc,Yd,Ie,nd,nf,xg,this.dBg)}else sa.a.sendTelemetryEvent(Object.assign(new Lf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:bc.a.Mi({["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"LaunchOneLineRibbonAddinCommands.fail",["SDX_Id"]:""})})),n.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.VGc.PM)),this.FNf(new sg(rc,null,null,Ia,null,!0))}FNf(J){this.tBd(J);this.n$f(!1,
J)}GNf(J){const Ia=J.fk;let Db=null;null!==Ia&&(Db=Ia.storeType,Db=Db.toLowerCase());if(J&&"omex"===Db&&(3===J.Rp||Ia.isUpgraded)){var cc={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Ia.solutionId,Ia.ownerAddinStoreType||Ia.storeType,Ia.assetId,null,null,Ia.storeId)};sa.a.sendTelemetryEvent(Object.assign(new Lf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:bc.a.Mi(cc)}))}this.tBd(J);cc=this.VMc&&Tg()&&"omex"===
Db&&!!J.vW&&!!Ia.solutionId&&2===J.Rp&&Ia.solutionId.toLowerCase()===$g().toLowerCase();var rc="omex"===Db&&!!J.vW&&(3===J.Rp&&"hardcodedpreinstall"!==Db||Ia.isUpgraded);const Tc=Cd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableLaunchCDAddIn",!1)&&"excatalog"===Db&&3===J.Rp;if(rc||cc||Tc)cc=new Cg,cc.fk=Ia,cc.Do=J.vW.txa,this.Za.raiseEvent(la.a.b_c,cc);this.Vyg&&(cc=lh(),rc=$g(),cc&&Ia&&"excatalog"===Ia.storeType&&J.vW&&5===J.Rp&&rc&&(Ia.storeId&&Ia.storeId.toLowerCase()===
rc.toLowerCase()||Ia.assetId&&Ia.assetId.toLowerCase()===rc.toLowerCase())&&(cc=new Cg,cc.fk=Ia,cc.Do=J.vW.txa,this.Za.raiseEvent(la.a.b_c,cc),n.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event.")));Ia&&(ff.instance.F3f(mh.b(Db),!0),"uploadfiledevcatalog"===Db&&(cc=this.tsg.createAddinDataProvider(Db,this.Gl))&&cc.localCacheAddinCommands(this.Gl.Mca,Ia.solutionId,Ia.version,Ia.storeId),Jf.a.agb(la.a.Gob,"true",mh.b(Db)));this.n$f(!0,J)}n$f(J,Ia){J?Cd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",
!1)&&Ia.vW&&5===Ia.Rp&&Ia.vW.txa&&void 0!==Ia.fk.showCallout&&null!==Ia.fk.showCallout&&Ia.fk.showCallout?(Cd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",!1)?(new vg(this.Za)).EWc(Ia.fk,Ke.a.O3a(Ia.vW.txa)):(new nh(this.Za,Ia.fk,Ke.a.O3a(Ia.vW.txa))).EWc(),J=new Cg,J.Do=Ia.vW.txa,J.fk=Ia.fk,this.Za.raiseEvent(la.a.x9f,J)):3!==Ia.Rp?Ia.Rof&&this.zXa.rRd():Ia.vW&&Ia.vW.txa&&"hardcodedpreinstall"!==Ia.fk.storeType&&vb.a.lIj(Ia.displayName,
Ia.vW.txa,Ia.fk.isAutoLaunched):3===Ia.Rp?Ia.fk&&"uploadfiledevcatalog"===Ia.fk.storeType.toLowerCase()?(Ia=this.JRb.CUh(Ia.fk.solutionId),vb.a.sUd(Ia?Ia:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):this.zXa.M4f():Ia.Rof&&this.zXa.rRd()}tBd(J=null){var Ia=J?J.fk:null;const Db=new Cg;if(Db.fk=Ia){var cc=this.zXa.Ria(Ia.storeType,Ia.solutionId,6===J.Rp?1:0);if(cc&&cc.Do){Db.Do=cc.Do;var rc=this.VMc?$g():null;rc=this.VMc&&Tg()&&!!Ia.solutionId&&!!rc&&Ia.solutionId.toLowerCase()===
rc.toLowerCase()&&2===J.Rp;if(3===J.Rp&&"hardcodedpreinstall"!==Ia.storeType||rc)J="",cc.Do.KV&&cc.Do.KV.Ks&&(cc=cc.Do.KV.Ks.ma(0))&&(J=cc.id),Ia={["SDX_CommandPlacement"]:J,["SDX_PinningAction"]:"Pinning",["SDX_PinningActionErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Ia.solutionId,Ia.ownerAddinStoreType||Ia.storeType,Ia.assetId,null,null,Ia.storeId)},sa.a.sendTelemetryEvent(Object.assign(new Lf.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:bc.a.Mi(Ia)}))}}this.Za.raiseEvent(la.a.$re,
Db)}}Object(d.a)(A,"LaunchAddinCommandsHandler",null,[840]);class Q{}Q.MUa="Alt";Q.NUa="Command";Q.id="Id";Q.QUa="Image16by16";Q.tRb="LabelText";Q.RUa="Title";Q.GROUP="Group";Q.v3d="Groups";Q.ehb="Controls";Q.button="Button";Q.Faa="FlyoutAnchor";Q.LARGE="Large";Q.SMALL="Small";Object(d.a)(Q,"AddinDataNodeConstants",null,[]);var Ea=a(379);a(567);var hb=a(562);a(146);class Fb{constructor(J,Ia){this.vEa=this.b7d=null;if(Xd.c(J)||Xd.c(Ia))throw n.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),
Error.create("ControlDefinition id or type should not be null or undefined");this.gvg=Ia;this._id=J;this.WT[Q.id]=this._id}get id(){return this._id||""}get WT(){return this.b7d||(this.b7d={})}get controlType(){return this.gvg||""}get menuItems(){return this.vEa||(this.vEa=new l.a)}}Object(d.a)(Fb,"ControlDefinition",null,[837]);class Sb{constructor(J){this.jee=null;if(Xd.c(J))throw n.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");
this._id=J;this.Ila[Q.id]=this._id}get Ila(){return this.jee||(this.jee={})}get id(){return this._id||""}}Object(d.a)(Sb,"MenuItemDefinition",null,[869]);class Dc{constructor(J){this.Mpa=null;if(Xd.c(J))throw n.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=J}get id(){return this._id}get controls(){return this.Mpa||(this.Mpa=new l.a)}}Object(d.a)(Dc,"OfficeMenuDefinition",
null,[836]);var Rc=a(25);class $c{constructor(J,Ia,Db){this.DI=this.DVa=null;this.dQc=J;this.tVa=Ia;this.TUa=Db;this.BAg=new l.a}get Lnc(){return this.dQc}get Jrb(){return this.tVa}get IVc(){return this.TUa}addButton(J){n.ULS.sendTraceTag(17085952,220,50,"ContextMenu button actiontype: {0}.",J.actionType);this.DI=new Fb(this.zsa(J.id),Q.button);this.DI.WT[Q.tRb]=J.label;this.DI.WT[Q.MUa]=J.label;this.DI.WT[Q.QUa]=J.icon["16"];this.aqb(this.DI.WT[Q.id],J.action);this.SFa(this.DI.WT);this.DVa.controls.add(this.DI);
this.DI=null}startBuildMenu(J){if(Xd.c(this.DVa))this.DVa=new Dc(J.id);else{const Ia=this.zsa(J.id);this.DI=new Fb(Ia,Q.Faa);this.A_a(this.DI.WT,J);this.DI.WT[Q.QUa]=J.icon["16"];this.DI.WT[Q.NUa]=Rc.a.alwaysEnabled}}addMenuItem(J){n.ULS.sendTraceTag(17085953,220,50,"ContextMenu menu item actiontype: {0}.",J.actionType);const Ia=new Sb(this.zsa(J.id));this.A_a(Ia.Ila,J);J.icon&&(Ia.Ila[Q.QUa]=J.icon["16"]);this.aqb(Ia.Ila[Q.id],J.action);this.SFa(Ia.Ila);this.DI.menuItems.add(Ia)}endBuildMenu(){Xd.c(this.DI)?
(this.enc.add(this.DVa),this.DVa=null):(this.DVa.controls.add(this.DI),this.DI=null)}get enc(){return this.BAg}aqb(J,Ia){this.IVc.bindAction(J,Ia)}SFa(J){this.Jrb.SFa(J)}zsa(J){return this.Lnc.pKa(J)}A_a(J,Ia){J[Q.tRb]=Ia.label;J[Q.MUa]=Ia.label}}Object(d.a)($c,"ContextMenuExtensibilityCreator",null,[863,855]);class Od{constructor(J){this.elb=J}get bFb(){return this.elb}pKa(J){return this.bFb+J}}Object(d.a)(Od,"DefaultContextMenuNamingProvider",null,[862]);var Rd=a(1335);class te{bindAction(J,Ia){OfficeExt.DefaultControlActionBinder.bindAction(J,
Ia)}}Object(d.a)(te,"DefaultUIControlActionBinder",null,[861]);class Ee{constructor(J){this.bDa=J}get command(){return this.bDa}SFa(J){J[Q.NUa]=this.command}}Object(d.a)(Ee,"DefaultUIControlCommandBinder",null,[856]);var Fe=a(32);class Ge{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}}Object(d.a)(Ge,"AddInControl",null,[]);class zf{constructor(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=
null}}Object(d.a)(zf,"AddInGroup",null,[]);class af{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=null}}Object(d.a)(af,"AddInMenuItem",null,[]);class jf{constructor(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}}Object(d.a)(jf,"AddInTab",null,[]);class qf{constructor(J,Ia,Db,cc,rc,Tc){this.GRb=new l.a;this.rib=this.afa=this.EVa=null;this.dQc=J;this.TUa=
Ia;this.tVa=Db;this.ix=cc;this.JRb=rc;this.c9d=Tc}get Lnc(){return this.dQc}get Ks(){return this.GRb}get IVc(){return this.TUa}get Jrb(){return this.tVa}startBuildTab(J){const Ia=J.isOfficeTab?J.id:this.Lnc.f8e(J.id),Db=J.isOfficeTab?null:J.label;this.EVa=Object.assign(new jf,{id:Ia,title:Db,isOfficeTab:J.isOfficeTab,visible:J.visible,groups:[],tabType:J.tabType,insertBefore:J.insertBefore,insertAfter:J.insertAfter,autoFocus:J.autoFocus})}startBuildGroup(J){const Ia=this.zsa(J.id);this.afa=Object.assign(new zf,
{id:Ia,mlrId:J.mlrId,title:J.label,controls:[],groupType:0})}addNativeGroup(J){this.afa=Object.assign(new zf,{id:J.id,mlrId:J.mlrId,title:J.label,controls:[],groupType:1});this.EVa.groups.push(this.afa)}addButton(J){const Ia=this.zsa(J.id);Ia&&(this.aqb(Ia,J.action),n.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",J.actionType),J=Object.assign(new Ge,{id:Ia,title:J.label,iconLocation:this.fhd(J),enabled:J.enabled,controlType:0,attributes:this.A_a()}),this.c9d.loe(new Fe.a(Ia,
this.Jrb.command.toString())),this.afa.controls.push(J))}addNativeControl(J){J.id&&(n.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",J.actionType),J=Object.assign(new Ge,{id:J.id,title:"",iconLocation:"",enabled:J.enabled,controlType:2,attributes:this.A_a()}),this.afa.controls.push(J))}startBuildMenu(J){const Ia=this.zsa(J.id);Ia&&(this.rib=Object.assign(new Ge,{id:Ia,title:J.label,iconLocation:this.fhd(J),controlType:1,attributes:{},menuItems:[]}))}addMenuItem(J){const Ia=
this.zsa(J.id);Ia&&(this.aqb(Ia,J.action),n.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",J.actionType),J=Object.assign(new af,{id:Ia,title:J.label,iconLocation:this.fhd(J),enabled:J.enabled,attributes:this.A_a()}),this.c9d.loe(new Fe.a(Ia,this.Jrb.command.toString())),this.rib.menuItems.push(J))}endBuildMenu(){Xd.c(this.rib.id)||this.afa.controls.push(this.rib);this.rib=null}endBuildGroup(){Xd.c(this.afa.id)||this.EVa.groups.push(this.afa);this.afa=null}endBuildTab(){Xd.c(this.EVa.id)||
this.GRb.add(this.EVa);this.EVa=null}A_a(){const J={};this.SFa(J);return J}fhd(J){return J.icon["80"]?J.icon["80"]:J.icon["32"]}SFa(J){this.Jrb.SFa(J)}zsa(J){return this.Lnc.pKa(J)}aqb(J,Ia){this.IVc.bindAction(J,Ia)}}Object(d.a)(qf,"OneLineRibbonExtensibilityCreator",null,[854,855]);class lf{constructor(J,Ia){this.elb=J;this.TUa=new te;this.tVa=new Ee(Ia)}hYg(J){J=new Od(J);return new $c(J,this.tVa,this.TUa)}YYg(J,Ia,Db,cc){Db=new Rd.a(this.elb,J,Db,!0);return new qf(Db,this.TUa,this.tVa,J,Ia,cc)}}
Object(d.a)(lf,"UIExtensibilityFactory",null,[833]);var gf=a(94),Hf=a(880),qg=a(22),Cf=a(37),fg=a(68),tg=a(50);class Jg{constructor(J){this.gGa=this.lGa=this.fk=this.Do=null;this.dVf=0;this.hWi=()=>{if(this.fk&&this.gGa){const Ia=new gf.a(Rc.a.j2,0,0,2,null);this.addinUICommandHandler.executeCommand(0,Ia,{["SourceControlId"]:this.gGa},null);n.ULS.sendTraceTag(537170697,220,50,"Launch addin command has been triggered")}};this.mIj=(Ia,Db)=>{Ia=null;if(Db)if(Ia=Db,this.fk=Ia.fk,(this.Do=Ia.Do)&&this.Do.KV&&
this.Do.KV.Ks&&(this.lGa=this.Do.KV.Ks.ma(0)),this.lGa&&this.lGa.id)if(this.lGa.isOfficeTab)if(Db=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),Ia=this.fk.solutionId,Ia in Db?this.gGa=Db[Ia]:(Db=Jg.GetPrivacyCompliantId(this.fk),n.ULS.sendTraceTag(537170695,220,15,`Failed to get button id from controlIdMap for add-in: ${Db}`),this.gGa=this.qOh(this.Do)),this.gGa)if(qg.a.contains(this.lGa.id,yd.a.fW,!0))appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(Ke.a.O3a(this.Do),
()=>{this.Q$f(this.pid(this.gGa))});else{if(Db=this.$.Ia)Db.Rre(this.lJf),n.ULS.sendTraceTag(537170693,220,50,"ShowCalloutOnAddin registered a tab switched event")}else n.ULS.sendTraceTag(537170694,220,10,"Failed to get button id for addin"),Db={["AppTeachingUICalloutAction"]:"NoEnabledButtonFound",["SDX.Id"]:Jg.GetPrivacyCompliantId(this.fk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},sa.a.sendTelemetryEvent(Object(uc.a)(new Lf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:bc.a.Mi(Db)})),this.H5();else this.S$f(this.pid(this.lGa.id),0);else n.ULS.sendTraceTag(537170696,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),Db={["AppTeachingUICalloutAction"]:"NoTabFound",["SDX.Id"]:Jg.GetPrivacyCompliantId(this.fk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},sa.a.sendTelemetryEvent(Object(uc.a)(new Lf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:bc.a.Mi(Db)})),this.H5();
else this.H5()};this.lJf=()=>{if(qg.a.contains(this.lGa.id,appChrome.selectors.getSelectedTabId(),!0)){var Ia=this.$.Ia;Ia&&Ia.cXf(this.lJf);this.Q$f(this.pid(this.gGa))}};this.jWi=()=>{var Ia={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:Jg.OUa(this.vC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};sa.a.sendTelemetryEvent(Object(uc.a)(new Lf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:bc.a.Mi(Ia)}));this.H5();let Db=
{};Db[fg.a.Pf]=this.vC;Ia={};Ia.solutionId=this.vC.solutionId;Ia.assetId=this.vC.assetId;Ia.assetStoreId=this.vC.assetStoreId;Ia.height=0!=this.vC.height?this.vC.height:600;Ia.storeId=this.vC.storeId;Ia.storeType=this.vC.storeType;Ia.targetType=this.vC.targetType;Ia.width=0!=this.vC.width?this.vC.width:600;Ia.displayName=this.vC.displayName;Ia.version=this.vC.version;Ia.isAddinCommands=!1;Db[la.a.D9]=Ia;let cc=new gf.a(-741808261,0,0,2,null);Cf.TaskExtensions.za(tg.GetServiceTaskFactory.Oa(this.$.da,
374,375,1),rc=>{rc=rc.result;null!=rc&&rc.insertAgave(Db,cc)},this.$.la,3)};this.PPi=()=>{let Ia={["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:Jg.OUa(this.vC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};sa.a.sendTelemetryEvent(Object(uc.a)(new Lf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:bc.a.Mi(Ia)}));this.H5()};this.lRi=()=>{let Ia={["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:Jg.OUa(this.vC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};sa.a.sendTelemetryEvent(Object(uc.a)(new Lf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:bc.a.Mi(Ia)}));this.H5()};this.HN=Ia=>{n.ULS.sendTraceTag(522981591,306,10,`failed to POST data to Roaming Settings Service with status: ${Ia?Ia.httpStatus:-1}`)};this.$=J.$;this.addinUICommandHandler=J;this.appName=Cd.AFrameworkApplication.fa.Wa("WebAppShortName")||"Excel";this.GPg=Cd.AFrameworkApplication.fa.vd("AddinMaxDOMElementDetectionTimesForTeachingUI",
10)}static GetPrivacyCompliantId(J){return Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,J.storeType,J.assetId,null,null,J.storeId)}static OUa(J){return Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,J.storeType,J.assetId,null,null,J.storeId)}Wgj(J){this.vC=J;window.addEventListener&&(window.addEventListener("LaunchContentAddin",this.jWi,!0),window.addEventListener("DismissCallout",this.lRi,!0),window.addEventListener("CloseCallout",this.PPi,!0))}pid(J){return"[id="+J+"]"}S$f(J,
Ia){Ia>this.GPg?(window.clearTimeout(this.dVf),this.R$f("[data-unique-id='pivotOverflowButton']"),n.ULS.sendTraceTag(537170692,220,50,"ShowTeachingCalloutWithPoll did not find the DOM element in time")):document.querySelector("button"+J)?this.R$f(J):this.dVf=window.setTimeout(()=>{this.S$f(J,Ia+1)},1E3)}Q$f(J){var Ia=document.querySelector("button[data-unique-id='RightPaddle']");if(Ia)J={["AppTeachingUICalloutAction"]:"RightPaddlePresent",["SDX.Id"]:Jg.GetPrivacyCompliantId(this.fk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"},sa.a.sendTelemetryEvent(Object(uc.a)(new Lf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:bc.a.Mi(J)}));else if(Ia=document.querySelector("button"+J),!Ia||"none"===window.getComputedStyle(Ia).display)if(Ia=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!Ia){Ia={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Jg.GetPrivacyCompliantId(this.fk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};
sa.a.sendTelemetryEvent(Object(uc.a)(new Lf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:bc.a.Mi(Ia)}));n.ULS.sendTraceTag(537170691,220,15,"ShowTeachingCallout failed to get an anchorElement");this.H5();return}this.pgg(Ia,"ShowTeachingUIForAddinButton")}R$f(J){J=document.querySelector("button"+J);if(!J&&(J=document.querySelector("button[data-unique-id='pivotOverflowButton']"),!J)){J={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Jg.GetPrivacyCompliantId(this.fk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};sa.a.sendTelemetryEvent(Object(uc.a)(new Lf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:bc.a.Mi(J)}));n.ULS.sendTraceTag(537170690,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");this.H5();return}this.pgg(J,"ShowTeachingUIForAddinTab")}pgg(J,Ia){J.setAttribute("lpp-id","latestAddin");const Db=pc.a.instance.Tb("Common.ISystemInitiatedFeedback");Db&&J?(Db.execute(cc=>{cc.logActivity(Ia,null)}),J={["AppTeachingUICalloutAction"]:"Show",
["SDX.Id"]:Jg.GetPrivacyCompliantId(this.fk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},sa.a.sendTelemetryEvent(Object(uc.a)(new Lf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:bc.a.Mi(J)})),n.ULS.sendTraceTag(537170688,220,50,"ShowTeachingCalloutToAddinTab triggered an LPP activity")):(n.ULS.sendTraceTag(537170689,220,15,"ShowTeachingCalloutToAddinTab failed to get a sifFuture"),J={["AppTeachingUICalloutAction"]:"NoSifFutureObject",
["SDX.Id"]:Jg.GetPrivacyCompliantId(this.fk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},sa.a.sendTelemetryEvent(Object(uc.a)(new Lf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:bc.a.Mi(J)})),this.H5())}qOh(J){if(!J)return null;J=J.KV;if((null===J||void 0===J?0:J.Ks)&&0<J.Ks.count)for(let Ia of J.Ks)if(Ia.groups&&0<Ia.groups.length)for(const Db of Ia.groups)if(Db.controls&&0<Db.controls.length)for(const cc of Db.controls){if(cc.attributes&&
0===cc.controlType&&cc.enabled)return cc.id;if(cc.menuItems)for(const rc of cc.menuItems)if(rc.attributes&&rc.enabled)return cc.id}return null}HKj(){var J=document.querySelector("button[data-unique-id = 'Ribbon-InsertAppsForOffice']");if(J&&"none"!==window.getComputedStyle(J).display)n.ULS.sendTraceTag(527286666,220,15,"Callout show on OfficeAddin Button");else{J=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']");if(null==J){J={["AppTeachingUICalloutAction"]:"NoAnchor",
["SDX.Id"]:Jg.OUa(this.vC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};sa.a.sendTelemetryEvent(Object(uc.a)(new Lf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:bc.a.Mi(J)}));n.ULS.sendTraceTag(527286668,220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");this.H5();return}n.ULS.sendTraceTag(527286667,220,15,"Callout show on Overflow button")}const Ia=pc.a.instance.Tb("Common.ISystemInitiatedFeedback");null==
Ia||null==J?(J={["AppTeachingUICalloutAction"]:"NoSifFutureObject",["SDX.Id"]:Jg.OUa(this.vC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},sa.a.sendTelemetryEvent(Object(uc.a)(new Lf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:bc.a.Mi(J)})),n.ULS.sendTraceTag(527286665,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture"),this.H5()):(Ia.execute(Db=>{Db.logActivity("ShowTeachingUIForContentAddin",null)}),J={["AppTeachingUICalloutAction"]:"Show",
["SDX.Id"]:Jg.OUa(this.vC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},sa.a.sendTelemetryEvent(Object(uc.a)(new Lf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:bc.a.Mi(J)})),n.ULS.sendTraceTag(527286664,220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity"))}oAa(J){const Ia={},Db={};Db.LastTeachingUIShowTime=(new Date).toUTCString();Db.AddinHasShown=J;Ia[this.appName]=Yf.c(Db);this.Kob=new Dg(this.appName,null,null,
this.HN),this.Kob.a3a(Ia),n.ULS.sendTraceTag(522981592,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}H5(){if(!this.Hda){const J=window.g_roamingAddinList;J&&(this.oAa(J),this.Hda=!0)}}}Object(d.a)(Jg,"AddinTeachingCalloutHandler",null,[]);var Ph=a(1258),Yh=a(425),Qh=a(11),Zh=a(189),fi=a(43),Ag=a(21),Wg=a(55);class ah{constructor(J,Ia,Db,cc,rc,Tc,bd=null){this.disposed=!1;this.vOi=(nd,Ed)=>{if(Ed)if(Ed)if(nd=Ed.fk){if(Tg()||lh()){const Ie=
this.$.ea.workbookContext.WebExtensions;if(Ie){let Qe=!1;for(var Yd of Ie)if(Yd.PrimaryMarketplace.SolutionId.toLowerCase()===nd.solutionId.toLowerCase()){Qe=!0;break}if(!Qe){n.ULS.sendTraceTag(512258444,220,15,"Not find add-in persisted in the template file.");return}}else{n.ULS.sendTraceTag(512258443,220,15,"Has no add-in persisted in the file.");return}}Ed=Ed.Do;Yd=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();if(nd.solutionId in Yd)Ed=Yd[nd.solutionId];else if(Ed=
this.nSh(Ed),void 0===Ed||null===Ed){n.ULS.sendTraceTag(528098434,220,15,"addinCommandControlId is NullOrUndefined");return}Yd=new gf.a(Rc.a.j2,0,0,2,null);this.executeCommand(0,Yd,{["SourceControlId"]:Ed},null);nd.isAutoLaunched=!0}else n.ULS.sendTraceTag(528098435,220,15,"insertionParam is null");else n.ULS.sendTraceTag(528098436,220,15,"agaveParams is null");else n.ULS.sendTraceTag(528098437,220,15,"No args for OnAutoLaunchAddin event")};this.sff=(nd,Ed)=>{"Insert"==Ed.tabName&&(nd=this.$.Ia,null!=
nd&&(nd.cXf(this.sff),n.ULS.sendTraceTag(527286662,220,50,"Remove insertTabSwitched handler")),this.OOb.HKj())};this.iWi=(nd,Ed)=>{nd=null;Ed&&(nd=Ed);(null===nd||void 0===nd?0:nd.Do)&&this.kBj(nd.Do);this.$.qf();C.EwaSettings.ra(86)&&nd&&nd.fk&&this.hVg(nd.fk)};this.$=J;n.ULS.shipAssertTag(537170659,0,!(void 0===Ia||null===Ia),`AddinUICommandHandler constructor error - ddaFacade param should not be null, stack: ${fi.a.e3()}`);this.Jd=Ia;this.$Fe=Db;this.m0b=cc;this.E9=rc;this.Hob=Tc;this.Mo=new Hf.a;
this.Pga=new qe;this.Rbd=bd;Hc.a.jzb=Hc.a.SVe;this.$7c=new l.a;this.V1a=new l.a}dispose(){void 0!==this.Hob&&null!==this.Hob&&(this.Hob.dispose(),this.Hob=null);this.Jd=this.$=null;this.disposed=!0}uFj(J,Ia){switch(J){case Rc.a.j2:J=this.dFj(Ia);break;default:J=!1}return J}Hc(){return!1}executeCommand(J,Ia,Db){J=Cf.TaskExtensions.Tj();Ia=Ia.command;switch(Ia){case 843847158:break;case -2025863019:vb.a.sUd(Db[la.a.cYc].toString(),()=>{Ag.h(this.$).focus()});break;case -1777565636:Ph.a.showUILessDialog(Db[la.a.Job].toString());
this.Jd.AIj(Db[la.a.Job].toString());break;case 1592314317:Ph.a.hideUILessDialog(Db[la.a.Job].toString());this.Jd.Dci(Db[la.a.Job].toString());break;case Rc.a.j2:J=this.qkd(Db);break;case Rc.a.lDb:this.mDb(Db);break;case Rc.a.uR:this.P$i(Db);break;case Rc.a.jna:this.jna(Db);break;case Rc.a.tUd:this.Hob.Yzc();break;case Rc.a.refreshAddinCommands:this.Oej();break;case 1949669462:this.E9.M4f(!0);break;case -1014260128:J=this.executeDynamicAddInCommandsAPI(Db);break;case Rc.a.Ufb:this.Ufb();break;default:J=
Zh.a(Ia)}return J}wc(J,Ia){J=!1;switch(Ia.command){case 843847158:case -2025863019:case -1777565636:case 1592314317:case Rc.a.uR:case Rc.a.jna:case Rc.a.tUd:case Rc.a.refreshAddinCommands:case 1949669462:case Rc.a.lDb:case -1014260128:case Rc.a.Ufb:J=!0;break;case Rc.a.j2:J=!Cd.AFrameworkApplication.protectedFile}return J}Nc(){return!1}nSh(J){if(!J)return n.ULS.sendTraceTag(528098432,220,10,"Failed to get button id for addin"),null;if((J=J.KV)&&J.Ks&&0<J.Ks.count)for(let Ia of J.Ks){if(Ia.groups&&
1===Ia.groups.length){J=Ia.groups[0];if(J.controls&&1===J.controls.length){const Db=J.controls[0];if(Db.attributes&&!Db.controlType&&Db.enabled)return Db.id}J.controls&&n.ULS.sendTraceTag(528098403,220,15,"It has multiple buttons")}Ia.groups&&n.ULS.sendTraceTag(528098402,220,15,"It has multiple groups")}return null}P$i(J){J&&la.a.iP in J?this.uR(J[la.a.iP],!0):n.ULS.sendTraceTag(509686151,220,10,"queryAddinDetailsWithActionData: invalid actionData.")}uR(J,Ia=!1){this.Jd?(n.ULS.sendTraceTag(509686149,
220,50,"QueryAddinDetails: providerType: {0}, refreshRequired: {1}",J,Ia),this.Jd.uR(J,Ia)):n.ULS.sendTraceTag(509686150,220,10,"QueryAddinDetails: abort because ddaFacadeService is null..")}Oej(){if(this.E9.Nlc()){this.E9.uCe();var J=this.gfd();if(J&&0<J.count)for(let Ia of J)J={[la.a.iP]:Ia,[la.a.VL]:4,[la.a.jGa]:(new Date).getTime()},this.jna(J)}else Cd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&(n.ULS.sendTraceTag(509686148,
220,50,"refreshAllAddinCommands: LoadingCompleteForAllProviders() returns {0}",this.E9.Nlc()),this.uR(10,!0),this.uR(0,!0))}jna(J){n.ULS.sendTraceTag(537170657,220,50,`Launch AddinCommands entitlements list, LaunchOperationType ${J[la.a.VL]}, DataProvider ${J[la.a.iP]}.`);this.E9.uxj();window.setTimeout(()=>{if(void 0===this.Jd||null===this.Jd)n.ULS.sendTraceTag(537170656,220,10,`AddinUICommandHandler RetrieveAddInCommandsEntitlementsList error - DdaFacadeService should not be null, stack: ${fi.a.e3()}`);
else{const Ia=new jc(new Bc(this.Jd.Ng),ud.instance,ff.instance);Ia.GLg((Db,cc)=>{Cd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.uR(J[la.a.iP]);this.mDb(cc.properties)});Cd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&Ia.aPg((Db,cc)=>{null==cc?sa.a.sendTelemetryEvent(Object(uc.a)(new Lf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:bc.a.Mi({["AppTeachingUICalloutAction"]:"InvalidEventArgs",
["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"})})):(this.OOb=new Jg(this),this.OOb.Wgj(cc),Db=this.$.Ia,null!=Db&&(Db.Rre(this.sff),n.ULS.sendTraceTag(527286663,220,50,"Register tab switched event")))});Ia.pXj(J)}},0)}Ufb(){if(this.fmi)if(void 0===this.Jd||null===this.Jd)n.ULS.sendTraceTag(509686154,220,10,"DdaFacadeService should not be null");else{const J=new of(this.Jd.Ng);J.ANg(()=>{this.bzi()});J.OZd()}}get fmi(){return!C.EwaSettings.ra(174)&&this.$.ea.wg.get(27)&&
this.$.lP}bzi(){const J=document.getElementById("InsertAddInFlyout");if(null===J||void 0===J||"none"===window.getComputedStyle(J).display){const Ia=document.getElementById("RibbonOverflowMenu-overflow");null!=Ia?(Ia.onclick=function(){const Db=new Wc.a(0,1,500,()=>{const cc=document.getElementsByName("Add-ins")[0];null!=cc&&(cc.click(),n.ULS.sendTraceTag(509445257,341,50,"Launch flyout in overflow"))});Cd.AFrameworkApplication.ji.fg(Db);Ia.onclick=function(){}},Ia.click()):n.ULS.sendTraceTag(509677591,
220,10,"Cannot find flyout button on ribbon or overflow button")}else J.click(),n.ULS.sendTraceTag(509677590,220,50,"Launch flyout")}mDb(J){if(!this.disposed){n.ULS.sendTraceTag(537170655,220,50,`LaunchOperationType ${J[la.a.VL]}.`);try{if(C.EwaSettings.ra(174)){const Db=J[la.a.Eob];if(Db&&0<Db.count){const cc=Db.count;for(let rc=cc-1;0<=rc;rc--){const Tc=Db.ma(rc);OSF.OsfControl.isFirstPartyStoreString(Tc.storeType)||Db.remove(Db.ma(rc))}if(Db.count<cc){const rc=tg.GetServiceTaskFactory.Oa(this.$.da,
5,4,0);Cf.TaskExtensions.za(rc,()=>{rc.result.ih(36,null)},this.$.la,3)}if(!Db.count)return}}if(void 0===this.Jd||null===this.Jd)n.ULS.sendTraceTag(537170654,220,10,`LaunchAddinCommands error - this.DdaFacadeService should not be null, stack: ${fi.a.e3()}`);else{var Ia=null;Ia=Cd.AFrameworkApplication.fa.pa("HostInstallAddInsIsEnabled")?new A(this.Mo,this.$Fe,new Bc(this.Jd.Ng),new lf(this.$.Bb,Rc.a.j2),this.E9,ud.instance,this.Pga,(Db,cc)=>{const rc={};rc.InstanceId=zd.a.create().toString();rc.PrimaryMarketplace=
{};rc.PrimaryMarketplace.SolutionId=Db.solutionId;rc.PrimaryMarketplace.SolutionVersion=Db.version;rc.PrimaryMarketplace.MarketplaceType=Db.storeType;rc.PrimaryMarketplace.MarketplaceRef=Db.storeId;rc.WebExtensionType=1;this.Jd.NKj(rc,()=>{cc(Db)})}):new A(this.Mo,this.$Fe,new Bc(this.Jd.Ng),new lf(this.$.Bb,Rc.a.j2),this.E9,ud.instance,this.Pga);Ia.OLg(this.vOi);Ia.HLg(this.iWi);if(Cd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",
!1)){const Db=new Jg(this);Ia.zNg(Db.hWi);Ia.$Og(Db.mIj)}this.$.da.Aa(53).pp&&fe.a.get_instance().Lj(5,null).continueWith(()=>{this.disposed||Ia.pzi(this.Rbd,this.$.domElement,J)})}}catch(Db){n.ULS.sendTraceTag(537170653,220,10,`LaunchAddinCommands error message : ${Db.message}.`)}}}qkd(J){const Ia=Cf.TaskExtensions.Tj();J=J[this.Mo.Sha];const Db=this.m0b.JVc(J),cc=new Ph.a(this.$,this.Jd,Db.ownerAddinInfo,Ia);return this.V9e(Ia,J,Db,cc)}V9e(J,Ia,Db,cc){this.m0b.qkd(Ia,this.E9,cc,new Bc(this.Jd.Ng),
Db,()=>{J=cc.w9g()},()=>{Ag.h(this.$).focus()});return J}hVg(J){const Ia=Cf.TaskExtensions.Tj();var Db=this.Jd.Baa(J.solutionId);if(Db){var cc=this.Jd.gZ(Db);if(Qh.HelperMethods.ow(cc)&&0!==cc.SharedRuntime.State)return}cc=this.m0b.iVg;const rc=J.solutionId in cc?cc[J.solutionId]:null;if(rc){const Tc=this.m0b.JVc(rc),bd=new Ph.a(this.$,this.Jd,Tc.ownerAddinInfo,Ia),nd=Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,null!==Tc.ownerAddinInfo?Tc.ownerAddinInfo.storeType:J.storeType,J.assetId,
null,null,J.storeId);cc=Ed=>{if(Ed){const Yd={};for(const Ie of Ed)Yd[Ie[0]]=Ie[1];(Ed=la.a.Zre in Yd?Yd[la.a.Zre]:null)&&"true"===Ed.toLowerCase()&&(n.ULS.sendTraceTag(537170652,220,50,`Auto-Show AddinCommands TaskPane, StoreType ${J.storeType}, StoreId ${J.storeId}, SolutionId ${nd}.`),this.V9e(Ia,rc,Tc,bd))}};n.ULS.sendTraceTag(537170651,220,50,`Check Auto-Show AddinCommands TaskPane, StoreType ${J.storeType}, StoreId ${J.storeId}, SolutionId ${nd}.`);if(Db)cc(this.Jd.gZ(Db).OsfPropertyBag);else if(Db=
this.$.ea.workbookContext.WebExtensions)for(const Ed of Db)if((1===Ed.WebExtensionType?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent)===J.targetType&&Ed.PrimaryMarketplace.MarketplaceType.toLowerCase()===J.storeType.toLowerCase()&&Ed.PrimaryMarketplace.MarketplaceRef.toLowerCase()===J.storeId.toLowerCase()&&Ed.PrimaryMarketplace.SolutionId.toLowerCase()===J.solutionId.toLowerCase()){cc(Ed.OsfPropertyBag);break}}}MXd(J,Ia,Db=!1){J&&(!Db||Ia||this.$7c.contains(J)||this.$7c.add(J),(Db=
this.V1a.contains(J))&&Ia&&this.V1a.remove(J),Db||Ia||this.V1a.add(J))}kBj(J){if((J=J.KV)&&J.Ks)for(let Ia of J.Ks)if(Ia.groups)for(const Db of Ia.groups)if(Db.controls)for(const cc of Db.controls)if(this.MXd(cc.id,cc.enabled,!0),1===cc.controlType&&cc.menuItems)for(const rc of cc.menuItems)this.MXd(rc.id,rc.enabled,!0)}gfd(){const J=new l.a;C.EwaSettings.ra(52)&&(this.$.ea.wg.get(27)&&(J.add(0),J.add(16)),this.$.ea.wg.get(33)&&J.add(1),J.add(8));return J}executeDynamicAddInCommandsAPI(J){let Ia=
!0;if(void 0===J||null===J||void 0===J[la.a.gub]||null===J[la.a.gub])return Wg.Task.Sa(!1);switch(J[la.a.gub]){case 1:Ia=this.A_j(J);break;case 2:Ia=this.oBj(J);break;case 4:this.V1a.clear();this.V1a.addRange(this.$7c);break;case 3:Ia=this.installContextualTab(J);break;default:Ia=!1}return Wg.Task.Sa(Ia)}dFj(J){return J&&this.Mo.Sha in J?(J=J[this.Mo.Sha])?this.V1a.contains(J):!1:!1}A_j(J){var Ia=null;let Db=null,cc=null,rc=!0;void 0!==J[la.a.v3]&&null!==J[la.a.v3]&&void 0!==J[this.Mo.Sha]&&null!==
J[this.Mo.Sha]&&void 0!==J[la.a.u3]&&null!==J[la.a.u3]&&(Ia=J[la.a.v3],Db=J[la.a.R8b],cc=J[this.Mo.Sha],rc=J[la.a.u3]);if(!Ia||!cc)return n.ULS.sendTraceTag(537170649,220,15,"UpdateControlEnableState failed to get solutionId or controlId."),!1;J=(new Rd.a(this.$.Bb,Ia,this.Mo,!0)).pKa(cc);Ia={DynamicAddinCommandsApiName:"UpdateControlEnableState"};Ia.AssetId=Db;Ia.MaskedTabId=J;Ia.IsToEnable=rc;n.ULS.sendTraceTag(537170648,220,50,z.a.Dc(Ia));this.MXd(J,rc);Yh.a.WI.updateCommandUI();return!0}oBj(J){var Ia,
Db,cc=null,rc=null;let Tc=null;var bd=null;let nd=!0;void 0!==J[la.a.x9c]&&null!==J[la.a.x9c]&&void 0!==J[la.a.v3]&&null!==J[la.a.v3]&&void 0!==J[this.Mo.Sha]&&null!==J[this.Mo.Sha]&&void 0!==J[la.a.u3]&&null!==J[la.a.u3]&&(cc=J[la.a.x9c],rc=J[la.a.v3],Tc=J[la.a.R8b],bd=J[this.Mo.Sha],nd=J[la.a.u3]);if(!cc||!rc||!bd)return n.ULS.sendTraceTag(537170647,220,15,"SetRibbonTabVisible failed to get storeType or solutionId or tabId."),!1;J=(new Rd.a(this.$.Bb,rc,this.Mo,!0)).f8e(bd);bd={DynamicAddinCommandsApiName:"SetRibbonTabVisible"};
bd.StoreType=cc;bd.AssetId=Tc;bd.MaskedTabId=J;bd.IsToShow=nd;n.ULS.sendTraceTag(537170646,220,15,z.a.Dc(bd));cc=this.E9.Ria(cc,rc,1);rc=!1;if(null===(Db=null===(Ia=null===cc||void 0===cc?void 0:cc.Do)||void 0===Ia?void 0:Ia.KV)||void 0===Db?0:Db.Ks)for(let Ed of cc.Do.KV.Ks)if(Ed.id===J){rc=!0;break}if(!rc)return n.ULS.sendTraceTag(537170645,220,15,"SetRibbonTabVisible failed to get contextual tabs"),!1;Ia=[];nd?appChrome.selectors.getSelectedTabId()!==J&&Ia.push(appChrome.actions.activateRibbonTab(J)):
(appChrome.selectors.getSelectedTabId()===J&&Ia.push(appChrome.actions.setCurrentTab(yd.a.fW)),Ia.push(appChrome.actions.deactivateRibbonTab(J)));appChrome.api.dispatch(Ia);return!0}installContextualTab(J){let Ia=null,Db=null,cc=null;var rc=null;if(void 0!==J[la.a.v3]&&null!==J[la.a.v3]&&void 0!==J[la.a.u3]&&null!==J[la.a.u3]){const Tc=J[la.a.u3];Ia=J[la.a.v3];void 0!==Tc[la.a.VIa]&&null!==Tc[la.a.VIa]&&void 0!==Tc[la.a.WIa]&&null!==Tc[la.a.WIa]&&(Db=Tc[la.a.VIa],cc=Tc[la.a.WIa],rc=Tc[la.a.y9c])}if(!(Ia&&
cc&&Db&&rc))return n.ULS.sendTraceTag(537170644,220,15,"InstallContextualTab failed to invalid parameters"),!1;J=this.E9.Ria(rc.PrimaryMarketplace.MarketplaceType,rc.PrimaryMarketplace.SolutionId,1);if(null===J||void 0===J?0:J.Do)return n.ULS.sendTraceTag(537170643,220,15,"InstallContextualTab was called multiple times"),!1;J={};J.solutionId=rc.PrimaryMarketplace.SolutionId;J.version=rc.PrimaryMarketplace.SolutionVersion;J.storeType=rc.PrimaryMarketplace.MarketplaceType;J.storeId=rc.PrimaryMarketplace.MarketplaceRef;
rc.AssetMarketplace?(J.assetId=rc.AssetMarketplace.SolutionId,J.assetStoreId=rc.AssetMarketplace.MarketplaceRef):(J.assetId=null,J.assetStoreId=null);J.targetType=rc.WebExtensionOsfControlType;J.width=rc.TaskpaneWidth;J.height=0;J.isAddinCommands=!0;rc=new l.a;rc.add(J);J={};J[la.a.Eob]=rc;J[la.a.VL]=6;J[la.a.VIa]=Db;J[la.a.WIa]=cc;this.mDb(J);return!0}}Object(d.a)(ah,"AddinUICommandHandler",null,[781,222,2]);var wi=a(69),xi=a(605),Bh=a(18),Oi=a(16);class oh extends id.a{constructor(J){super(J);this.handler=
null;this.zHg=()=>{n.ULS.sendTraceTag(38410434,0,50,`AddinUICommandHandlerFactory.ActivateFeature, isEditMode [${this.$.isEditMode}] ShowCommandUI [${!!(this.$.qd&16384)}]`);const Ia=new Gc.a;this.$.da.gb(53,Yd=>{n.ULS.sendTraceTag(38410435,0,50,"AddinUICommandHandlerFactory.ActivateFeature success to get service IRibbonManager");Ia.setResult(Yd)});const Db=Ia.task,cc=new ld,rc=Md.a.getInstance(),Tc=new yc(this.$,rc),bd=tg.GetServiceTaskFactory.create(this.$.da,203,this.la,this.Xa),nd=this.vfj(cc),
Ed=tg.GetServiceTaskFactory.Oa(this.$.da,349,350,this.Xa);return Cf.TaskExtensions.za(Cf.TaskExtensions.Fd([Db,bd,nd,Ed],this.la),()=>{n.ULS.sendTraceTag(38942482,0,50,"AddinUICommandHandlerFactory.ActivateFeature, ContinueWith after realated task finished.");Cf.TaskExtensions.za(tg.GetServiceTaskFactory.create(this.$.da,106,this.la,this.Xa),Yd=>{this.handler=new ah(this.$,Yd.result,cc,new Pb,rc,Tc,pc.a.instance.mg("Common.IExternalUICommandDefinitionMapping"));n.ULS.sendTraceTag(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");
this.$c([this.handler]);this.$.da.Ha(198,this.handler)},this.la,3)},this.la,3)};this.Ijh=()=>{void 0!==this.handler&&null!==this.handler?(this.$.Ia.hcb(this.handler),this.$.da.jU(198),this.handler=null):n.ULS.sendTraceTag(42341715,0,50,"AddinUICommandHandlerFactory.DeactivateFeature: handler is not defined, it might have never been activated.");this.$.da.jU(204);Oi.a(Bh.a,20,this.$.da,198)}}hd(){n.ULS.sendTraceTag(38410432,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync");wi.a(this.$).add(Object(uc.a)(new xi.a,
{gzc:()=>{const J=this.$.ea.zH&&this.$.ea.Xb&&!!(this.$.qd&16384)&&this.$.isEditMode;this.$.ea.Xb&&n.ULS.sendTraceTag(38410433,0,50,`AddinUICommandHandlerFactory.CreateCommandHandlersAsync FeatureActivator: shouldActivate [${J}] IsSessionFullyLoaded [${this.$.ea.zH}] IsSessionActive [${this.$.ea.Xb}] ShowCommandUI [${!!(this.$.qd&16384)}] IsEditMode [${this.$.isEditMode}]`);return J},BZb:this.zHg,f7b:this.Ijh,g3a:2}))}vfj(J){const Ia=tg.GetServiceTaskFactory.create(this.$.da,102,this.la,this.Xa);
return Cf.TaskExtensions.za(Ia,()=>{n.ULS.sendTraceTag(38942483,0,50,"AddinUICommandHandlerFactory.RegisterContextMenuExtensibilityService ribbonControlManagerTask finished.");this.$.da.Ha(204,new je(Ia.result,J))},this.la,3)}static ka(J){id.a.Md(199,new oh(J))}}Object(d.a)(oh,"AddinUICommandHandlerFactory",id.a,[]);var Pi=a(1215),yi=a(1218),Xc=a(712),Ld=a(204),bh=a(187),Xi=a(105);class $h extends h.a{constructor(J){super();this.$=J;this.Db()}create(){let J;if(C.EwaSettings.ra(355)){const Ia=tg.GetServiceTaskFactory.create(this.$.da,
106,this.$.la,this.Xa);let Db;Db=C.EwaSettings.isChangeGateEnabled("OfficeVSO:7476522_IDBNewService2")?Object(Ld.c)(bh.a.resolve(Xi.i)):tg.GetServiceTaskFactory.create(this.$.da,396,this.$.la,this.Xa);Cf.TaskExtensions.za(Wg.Task.aG(Ia,Db),()=>{this.nb(Object(Xc.a)(this.$.da,278,()=>new Pi.CustomFunctionsInstaller(this.$,Ia.result,Db.result)))},this.$.la,3)}else J=Object(Xc.a)(this.$.da,278,()=>new yi.CustomFunctionsLegacyInstaller(this.$)),this.nb(J)}static ka(J){J.da.Ha(279,new $h(J))}}Object(d.a)($h,
"CustomFunctionsInstallerFactory",h.a,[]);var gi=a(89),Yi=a(48),hi=a(44);class Qi{constructor(J,Ia){this.hQa=this.iQa=null;this.sgg=(Db,cc)=>{let rc=null,Tc=null,bd=null;cc?(Object(aa.a)(231,cc)?(rc=cc.qGa,bd=cc.instanceId):Object(aa.a)(295,cc)&&(rc=cc.get_element(),bd=cc.instanceId),rc)?(Tc=Object(V.a)(797,Db),Tc)?this.CSf(bd,rc,Tc)||bd in this.hQa||(this.iQa[bd]=0,this.hQa[bd]=Yi.a.instance.yC(()=>{10<=this.iQa[bd]||this.CSf(bd,rc,Tc)?(delete this.iQa[bd],this.hQa[bd].dispose(),delete this.hQa[bd]):
this.iQa[bd]+=1},500,hi.a.sQg,!0,!1)):n.ULS.sendTraceTag(537170624,0,10,"The AgaveOnSelectedReadoutEvent raised from a null object."):n.ULS.sendTraceTag(537170625,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."):n.ULS.sendTraceTag(537170626,0,10,"Invalid parameter for ReadoutSelection")};this.ariaLiveNotifier=J;this.$=Ia;this.QZc=!1;this.$.da.Ha(224,this)}ka(J){this.QZc?n.ULS.sendTraceTag(537170629,0,10,"The instance AgaveOnSelectedReadoutHandler should not attach multiple times."):
(this.QZc=!0,this.hQa={},this.iQa={},J?J.sMg(this.sgg):n.ULS.sendTraceTag(537170628,0,10,"The AgaveOnSelectedReadoutHandler should not attach to a null object."))}detach(J){if(J){J.Gjj(this.sgg);J=this.hQa;for(let Ia in J)gi.a.Ja(J[Ia]);this.iQa=this.hQa=null;this.QZc=!1}else n.ULS.sendTraceTag(537170627,0,10,"The AgaveOnSelectedReadoutHandler should not detach from a null object.")}CSf(J,Ia,Db){if(this.Jli(Db,J))return!1;J=Ia.querySelector("iframe");if(!J)return n.ULS.sendTraceTag(537170595,0,10,
"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;J=J.title;if(!J||!J.length)return n.ULS.sendTraceTag(537170594,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;this.ariaLiveNotifier.readText(J);return!0}Jli(J,Ia){return(J=J.Ng.getOsfControl(Ia))?J.getPageStatus()!==OSF.OsfControlPageStatus.Ready:!0}}Object(d.a)(Qi,"AgaveOnSelectedReadoutHandler",null,[798]);class ii extends h.a{constructor(J){super();this.$=J;this.Db()}create(){const J=
this.$.da;Cf.TaskExtensions.za(tg.GetServiceTaskFactory.Oa(J,211,212,this.Xa),Ia=>{Ia=J.Aa(224)||new Qi(Ia.result,this.$);this.nb(Ia)},this.la,3)}static ka(J){J.da.Ha(225,new ii(J))}}Object(d.a)(ii,"AgaveOnSelectedReadoutHandlerFactory",h.a,[]);var zg=a(749),ji=a(51);const Ri=(J,Ia)=>ji.a.mwd(65,()=>window.OfficeExtension&&!!window.OfficeExtension.WacRuntime,Cd.AFrameworkApplication.fa.vd("MaxRetriesForLoadingScript",0),J,Ia);var Zi=a(241);class Hh{constructor(J,Ia,Db){this.iframe=J;this.onSuccess=
Ia;this.onError=Db;$addHandler(window,"message",Object(Kd.a)(this,this.daf,"handleResponse"))}daf(J){try{if(J&&J.rawEvent&&J.rawEvent.origin&&this.iframe&&this.iframe.id){var Ia=this.ULf(J.rawEvent.origin);const Db=this.ULf(document.domain);if(L.a.Oi().equals(Db,Ia))if(J.rawEvent.source&&J.rawEvent.source.frameElement&&J.rawEvent.source.frameElement.id&&L.a.Oi().equals(J.rawEvent.source.frameElement.id,this.iframe.id)){Ia=null;try{Ia=JSON.parse(J.rawEvent.data)}catch(cc){n.ULS.sendTraceTag(39112971,
344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",cc.message)}Ia?(Ia.statusCode!==Zi.a.IO||void 0!==Ia.error&&Ia.error?(n.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",Ia.statusCode,Ia.error),this.onError()):(n.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),this.onSuccess(Ia.authorizationCode?Ia.authorizationCode:
Ia.signInUrl)),$removeHandler(window,"message",Object(Kd.a)(this,this.daf,"handleResponse")),this.iframe?document.body.contains(this.iframe)?document.body.removeChild(this.iframe):n.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):n.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):n.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else n.ULS.sendTraceTag(51451614,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");
else n.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else n.ULS.sendTraceTag(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(Db){n.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",Db.message)}}ULf(J){let Ia="";try{J&&(Ia=-1<J.indexOf("//")?J.split("/")[2]:J.split("/")[0])&&(Ia=Ia.split(":")[0],Ia=Ia.split("?")[0])}catch(Db){n.ULS.sendTraceTag(51451615,
344,10,"Failed to parse host name from url: {0}",Db.message)}return Ia}static ka(J,Ia,Db){new Hh(J,Ia,Db)}}Object(d.a)(Hh,"ResponseHandler",null,[]);var ki=a(255);class ch{constructor(J){this.EFa=J}tryAuthenticate(J,Ia){this.Hab(ch.iyg,()=>{J()},Ia)}tryAuthorize(J,Ia){this.Hab(ch.ptg,J,Ia)}getSignInUrl(J,Ia){this.Hab(ch.kke,J,Ia)}signOut(J,Ia){this.Hab(ch.lEg,J,Ia)}Hab(J,Ia,Db){var cc=new ki.QueryStringBuilder("AuthenticationProxyHandler.aspx");cc.Zi("responseType",J);Cd.AFrameworkApplication.JYa(cc);
cc=String.format("{0}{1}&{2}",this.EFa,cc.toString(),Cd.AFrameworkApplication.vi);const rc=document.createElement("iframe");rc.setAttribute("id","privateCatalogIframe");rc.setAttribute("name","privateCatalogIframe");rc.setAttribute("style","display: none");L.a.Oi().equals(J,ch.kke)||rc.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");Hh.ka(rc,Ia,Db);rc.setAttribute("src",cc);document.body.appendChild(rc)}}ch.ptg="authcode";ch.iyg="identitytoken";
ch.kke="signinurl";ch.lEg="signout";Object(d.a)(ch,"AuthenticationProxy",null,[]);class Df{}Df.getUserId="getUserId";Df.getLastStoreUpdate="laststoreupdate";Df.getEntitlement="getEntitlements";Df.getEToken="getEToken";Df.getManifest="getManifest";Df.getAppState="getAppState";Df.getKilledApps="getRemovedAddins";Df.getAppDetails="getAppDetails";Df.removeApps="removeAddin";Df.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";Df.getPrivateCatalogAddIns="getAddIns";Df.getPrivateCatalogManifests=
"getAppManifests";Df.isStoreDisabled="isStoreDisabled";Object(d.a)(Df,"S2SWebRequestActions",null,[]);var Ih=a(576);class Rh{getUserId(J,Ia){const Db=new l.a;Db.add(new De.a("corr",J));this.AW(Df.getUserId,Db,1,Ia)}getLastStoreUpdate(J,Ia,Db){const cc=new l.a;cc.add(new De.a("lc",J));cc.add(new De.a("corr",Ia));this.AW(Df.getLastStoreUpdate,cc,1,Db)}getEntitlement(J,Ia,Db,cc){J=new l.a;J.add(new De.a("av",Ia));J.add(new De.a("corr",Db));this.AW(Df.getEntitlement,J,1,cc)}getEToken(J,Ia,Db,cc,rc,Tc){const bd=
new l.a;bd.add(new De.a("cmu",J));bd.add(new De.a("cmf",Ia));bd.add(new De.a("assetid",Db));bd.add(new De.a("expver",cc));bd.add(new De.a("corr",rc));this.AW(Df.getEToken,bd,1,Tc)}getManifest(J,Ia,Db,cc){const rc=new l.a;rc.add(new De.a("cmu",J));rc.add(new De.a("assetid",Ia));rc.add(new De.a("corr",Db));this.AW(Df.getManifest,rc,1,cc)}getAppState(J,Ia,Db){const cc=new l.a;cc.add(new De.a("ma",J));cc.add(new De.a("corr",Ia));this.AW(Df.getAppState,cc,1,Db)}getKilledApps(J,Ia){const Db=new l.a;Db.add(new De.a("corr",
J));this.AW(Df.getKilledApps,Db,1,Ia)}getAppDetails(J,Ia,Db,cc){const rc=new l.a;rc.add(new De.a("cmo",J));rc.add(new De.a("corr",Db));this.sendWithBody(Df.getAppDetails,rc,Ia,2,cc,!1)}removeApps(J,Ia,Db){const cc=new l.a;cc.add(new De.a("corr",Ia));this.sendWithBody(Df.removeApps,cc,J,2,Db,!1)}getLastPrivateCatalogUpdate(J,Ia,Db,cc,rc,Tc){const bd=new l.a;bd.add(new De.a("catalog","privatecatalog"));bd.add(new De.a("clientCode",J));bd.add(new De.a("clientVersion",Ia));bd.add(new De.a("corr",rc));
J=String.format("authorizationCode={0}&refreshToken={1}",Db?Kf.a.hf(Db):"",cc?Kf.a.hf(cc):"");this.sendWithBody(Df.getLastPrivateCatalogUpdate,bd,J,2,Tc,!0)}getPrivateCatalogAddIns(J,Ia,Db,cc,rc,Tc){const bd=new l.a;bd.add(new De.a("catalog","privatecatalog"));bd.add(new De.a("clientCode",J));bd.add(new De.a("clientVersion",Ia));bd.add(new De.a("corr",rc));J=String.format("authorizationCode={0}&refreshToken={1}",Db?Kf.a.hf(Db):"",cc?Kf.a.hf(cc):"");this.sendWithBody(Df.getPrivateCatalogAddIns,bd,
J,2,Tc,!0)}getPrivateCatalogManifests(J,Ia,Db,cc,rc){const Tc=new l.a;Tc.add(new De.a("catalog","privatecatalog"));Tc.add(new De.a("corr",cc));J=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",Kf.a.hf(J),Ia?Kf.a.hf(Ia):"",Db?Kf.a.hf(Db):"");this.sendWithBody(Df.getPrivateCatalogManifests,Tc,J,2,rc,!0)}isStoreDisabled(J,Ia){const Db=new l.a;Db.add(new De.a("corr",J));this.AW(Df.isStoreDisabled,Db,2,Ia)}AW(J,Ia,Db,cc){this.sendWithBody(J,Ia,null,Db,cc,!1)}sendWithBody(J,Ia,Db,
cc,rc,Tc){const bd=new ki.QueryStringBuilder("AddinServiceHandler.ashx");bd.Zi("action",J);bd.Zi("app",Ih.a[Cd.AFrameworkApplication.sa.Qa.Oj]);for(let nd of Ia)bd.Zi(nd.key,nd.value);Ia=String.format("{0}{1}&{2}",Cd.AFrameworkApplication.sa.Qa.t_,bd.toString(),Cd.AFrameworkApplication.vi);Cd.AFrameworkApplication.Bd.Jm(Ia,cc,Db,null,!1,2,nd=>{let Ed=null,Yd=null;nd&&nd.data&&(nd.data.responseHeaders["X-BlockedForMinor"]&&"1"===nd.data.responseHeaders["X-BlockedForMinor"].toString()&&(nd.data.httpStatus=
451),Ed=nd.data.de,Yd=nd.data.responseHeaders);rc(nd.data.httpStatus,Ed,Yd)},nd=>{var Ed=null;let Yd=null;Tc&&nd&&nd.data&&nd.data.de&&(Ed=nd.data.de,Yd=nd.data.responseHeaders);rc(nd.data.httpStatus,Ed,Yd);if(Cd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",!0)){Ed={message:"AddinServiceHandler request failed"};Ed.code=nd.data.httpStatus;Ed.action=J;if(nd.data.request||nd.data.request.get_headers())Ed["X-UserSessionId"]=nd.data.request.get_headers()["X-UserSessionId"];
408===nd.data.httpStatus||503===nd.data.httpStatus?n.ULS.sendTraceTag(538784582,220,10,JSON.stringify(Ed)):n.ULS.sendTraceTag(18392345,220,50,JSON.stringify(Ed))}else n.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",nd.data.httpStatus)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+J,void 0,void 0,void 0,["X-UserKey"])}}Object(d.a)(Rh,"S2SWebRequestManager",null,[]);class th extends h.a{constructor(J){super();this.BSf=this.ddaFacade=null;this.$=J;J.da.Ha(106,this);
this.Db()}get Jd(){return this.ddaFacade||(this.ddaFacade=new zg.DdaFacade(this.$,this.BSf))}create(){n.ULS.sendTraceTag(537170507,0,50,"DdaFacadeServiceFactory:Create.");Cd.AFrameworkApplication.disableWholeAppsForOfficeFeature?n.ULS.sendTraceTag(537170506,0,50,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [${Cd.AFrameworkApplication.disableWholeAppsForOfficeFeature}]`):C.EwaSettings.ra(359)?pc.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(J=>
{J.isFeatureEnabled("mso_officeStore",!0).then(Ia=>{zg.DdaFacade.p5b=Ia;this.fIe();return null})}):this.fIe()}fIe(){const J=tg.GetServiceTaskFactory.Oa(this.$.da,224,225,this.Xa),Ia=ji.a.mwd(64,()=>!(void 0===window.OSF||null===window.OSF),this.$.ya.MaxRetriesForLoadingScript,this.$.la,this.Xa,106),Db=Ri(this.la,this.Xa);Cf.TaskExtensions.za(Cf.TaskExtensions.Fd([J,Ia,Db],this.$.la),()=>{"undefined"===typeof OfficeExt||"undefined"===typeof OSF?n.ULS.sendTraceTag(537170505,0,15,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService. OfficeExt/OSF shouldn't be undefined. Stack: ${fi.a.e3()}`):
this.hgi();n.ULS.sendTraceTag(537170504,0,50,"DdaFacadeServiceFactoryError.Create: DdaFacadeService created");this.BSf=J.result;this.nb(this.Jd);n.ULS.sendTraceTag(537170503,0,50,"VSO#2693929: ServiceCreatedEvent is registered.")},this.la,3)}hgi(){C.EwaSettings.ra(63)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new Rh);this.$.$d.get(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new Rh,new ch(Cd.AFrameworkApplication.fa.appSettings.WebServiceBase),C.EwaSettings.ra(70),C.EwaSettings.ra(378));
OfficeExt.MosRequestHandler.init&&OfficeExt.MosRequestHandler.init(new Rh);OfficeExt.ProxyBasedCatalogService.initRequestHandler&&OfficeExt.ProxyBasedCatalogService.initRequestHandler(new Rh)}dispose(){gi.a.Ja(this.ddaFacade);this.$=this.ddaFacade=null;super.dispose()}static ka(J){new th(J)}}Object(d.a)(th,"DdaFacadeServiceFactory",h.a,[]);var Sh=a(33),Th=a(462);class wh{constructor(J,Ia,Db,cc,rc,Tc){this.$=J;this.agaveCommandManager=Tc}Nc(J,Ia,Db){switch(Ia){case "PopulateAddInGallery":return 32===
Cd.AFrameworkApplication.rb.Vd(Rc.a.eNf,2,Db);default:return!1}}Hc(J,Ia){return 619219938===Ia?!this.agaveCommandManager.ITd():!1}wc(J,Ia,Db,cc){let rc=!1;switch(Ia.command){case Rc.a.plc:rc=!!Db;break;case Rc.a.ulc:rc=!!Db;break;case -684355545:rc=!0;break;case -741808261:rc=!!Db;break;case -859308420:rc=!!cc&&1===cc.zx;break;case 418618014:rc=1===J&&!!cc&&1===cc.zx;break;case -167264441:rc=Sh.a.sif(this.$)&&1===J&&!!cc&&1===cc.zx;break;case -515602470:Ia=C.EwaSettings.ra(217)&&2===J;rc=(1===J||
Ia)&&!!cc&&1===cc.zx;break;case 2086613372:rc=C.EwaSettings.ra(217)&&2===J&&!!cc&&1===cc.zx;break;case -1336341324:rc=C.EwaSettings.ra(417)&&1===J&&!!cc&&1===cc.zx;break;case 451940422:rc=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AnalyzeDataInAutoFilter",!1)&&1===J&&!!cc&&1===cc.zx;break;case -1444574190:case -336193495:rc=1===J&&!!cc&&1===cc.zx;break;case 1296389134:rc=1===J&&!!cc&&1===cc.zx;break;case -1473679467:rc=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",
!1)&&1===J&&!!cc&&1===cc.zx;break;case 1221897806:rc=C.EwaSettings.ra(155)&&2===J;break;case 1172793074:case 1930653487:rc=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&2===J;break;case -1753056834:rc=!0;break;case 932597253:rc=!0;break;case 301511274:rc=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavigationPaneWeb",!1);break;case 515196233:rc=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammer",!1)&&this.$.isEditMode;
break;case 1723441034:rc=this.$.isEditMode&&this.$.ea.SMb}return rc}executeCommand(J,Ia,Db){let cc=Cf.TaskExtensions.Tj();const rc=Ia.command;switch(Ia.command){case -1473679467:Th.a(this.$,488,489,1,Tc=>{cc=Tc.gji(Db.SourceControlId,Ia)});break;case Rc.a.plc:this.agaveCommandManager.a$h(Db.SourceControlId);break;case Rc.a.ulc:this.agaveCommandManager.c$h(Db.SourceControlId);break;case 1296389134:this.agaveCommandManager.NNj(Db.SourceControlId,Db.LabelText);break;case -684355545:this.agaveCommandManager.e1c();
break;case -741808261:cc=this.agaveCommandManager.insertAgave(Db,Ia);Th.a(this.$,488,489,1,Tc=>{Tc.ZHg(Db)});break;case -1336341324:C.EwaSettings.ra(417)&&(cc=this.agaveCommandManager.Ekd(Db,J,Ia));break;case 1172793074:C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&(cc=this.agaveCommandManager.Ekd(Db,J,Ia));break;case -859308420:case -515602470:case -167264441:case 2086613372:case -336193495:case -1444574190:case 451940422:case 418618014:case 1221897806:case 1930653487:case -1753056834:case 932597253:case 301511274:case 515196233:case 1723441034:cc=
this.agaveCommandManager.Ekd(Db,J,Ia);break;default:cc=Zh.a(rc)}return cc}}Object(d.a)(wh,"AgaveCommandHandler",null,[222]);class li{}Object(d.a)(li,"Selection",null,[]);var mf=a(1340),Eh=a(1339),dh=a(1341),cg=a(1420),Ug=a(1336);class mi{}Object(d.a)(mi,"SmartLookupApplicationInterface",null,[]);class ai{}Object(d.a)(ai,"ApplicationProperties",null,[]);class ni{}Object(d.a)(ni,"EnterpriseUserInfo",null,[]);class oi{}Object(d.a)(oi,"FeatureGates",null,[]);class pi{constructor(J,Ia,Db=!0){this.RTj=
9E5;this.UTj=3E5;this.Sxd=null;this.rtf="";this.Pxd=0;this.rtb=Date.now;this.Rxa=J;this.q9a=Ia;Db&&this.dfd()}I3h(){const J=this.rtb();if(J<this.Pxd+this.RTj)return J>this.Pxd+this.UTj&&this.dfd(),this.rtf;this.dfd();return""}dfd(){this.Sxd=this.Sxd||new Promise(J=>{this.J3h().then(Ia=>{this.rtf=Ia;this.Pxd=this.rtb();this.Sxd=null;J(Ia)})})}J3h(){return this.q9a&&this.q9a.length?new Promise(J=>{this.Rxa.AO("SmartLookup",this.q9a).then(Ia=>{Ia.IsSuccess?Ia.Token||(J(""),n.ULS.sendTraceTag(51446545,
1313,15,"SmartLookupManager - The AAD token is empty")):(n.ULS.sendTraceTag(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+Ia.ErrorCode+": "+Ia.ErrorMessage),J(""));J(Ia.Token)}).catch(Ia=>{Ia=Yf.c(Ia);n.ULS.sendTraceTag(51446546,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+Ia);J("")})}):(n.ULS.sendTraceTag(51446543,1313,10,"SmartLookupManager - Missing service endpoint: "),Promise.resolve(""))}}Object(d.a)(pi,"SmartLookupAuthenticationManager",
null,[847]);class Uh{static vUh(){switch(Object(V.a)(String,Cd.AFrameworkApplication.Rb.AudienceGroup)||""){case "Dogfood":if(Cd.AFrameworkApplication.fa){let J=Cd.AFrameworkApplication.fa.Wa("UserPrincipalName");J=Kf.a.Yk(J);const Ia=Cd.AFrameworkApplication.fa.Gp("SmartLookupINTEnabledForSKITeam")?Cd.AFrameworkApplication.fa.kw("SmartLookupINTEnabledForSKITeam"):[];return 0<=Array.indexOf(Ia,J)?"INT":"EDOG"}return"EDOG";default:return"PROD"}}static i3h(){switch(Cd.AFrameworkApplication.fa.pa("IntentSvcEnableEdogSourceLocationOverride")?
"EDOG":Cd.AFrameworkApplication.fa.pa("IntentSvcEnableProdSourceLocationOverride")?"PROD":Cd.AFrameworkApplication.fa.pa("IntentSvcEnableIntSourceLocationOverride")?"INT":Uh.vUh()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}}}Object(d.a)(Uh,"Utils",null,[]);var zi=a(558),Jh=
a(174);class Vh{constructor(J){n.ULS.sendTraceTag(41521353,1313,50,"SmartLookupManager - Initialize");this.Ytf=Cd.AFrameworkApplication.fa.pa("IsTellMeUpSellEnterpriseEnabled");this.dFi=Cd.AFrameworkApplication.fa.Wa("SmartLookupApprovedOriginPattern");this.q9a=Cd.AFrameworkApplication.fa.Wa("SmartLookupShredderServiceEndpoint");this.IFi=rg.a.QJ(Cd.AFrameworkApplication.fa.Wa("AppCatalogUrl")||"");this.p9a=new oi;this.p9a.EnableAllTabV2=!0;this.p9a.EnableIntentService=!0;this.p9a.EnableInDocumentSearch=
Cd.AFrameworkApplication.fa.pa("SmartLookupEnableInDocumentSearch");this.p9a.EnableLocalSearch=Cd.AFrameworkApplication.fa.pa("SmartLookupEnableLocalSearch");this.p9a.IntentServiceEndpoint=Uh.i3h();this.DFi=new pi(J,this.q9a)}get approvedOriginPattern(){return this.dFi}XOh(){return Promise.resolve(this.YOh())}YOh(){const J=new ai;J.anid="";J.applicationVersion=Cd.AFrameworkApplication.buildVersion;J.appCorrelationId=Jh.a.create().toString();J.themePlatform=Vh.k6j;J.lcid=Cd.AFrameworkApplication.lcid;
J.launchUtcTime=(new Date).toUTCString();J.featureGates=this.p9a;var Ia=zi.a.NJ(Cd.AFrameworkApplication.lcid);Ia=Ia?Ia.name:null;J.market=this.bcc(Ia);J.uiLanguage=Ia;J.sessionId=Cd.AFrameworkApplication.userSessionId;J.themeId=0;J.parentalControl=Vh.V3i;const Db=new ni;Db.CountryCode=this.bcc(Ia);Db.ServiceEndpoint=this.q9a;Db.IsGoLocal=!1;Db.IsEnabled=this.Ytf;Db.IsEnterpriseEnabled=this.Ytf;Db.TenantRoot=this.IFi;J.enterpriseUserInfo=Db;J.accessToken=this.DFi.I3h();return J}bcc(J){J=J.split("-");
return J[J.length-1]}}Vh.k6j="web";Vh.V3i="yes";Object(d.a)(Vh,"SmartLookupManager",null,[824]);class Fh extends Aa.a{constructor(J){super();this.$=J;this.isFirstLaunch=!1}Nc(){return!1}Hc(){return!1}wc(J,Ia){J=C.EwaSettings.ra(127);return-983891024===Ia.command&&J}executeCommand(J,Ia){J=Cf.TaskExtensions.Tj();-983891024===Ia.command&&this.Xyi();return J}Xyi(){var J=new Vh(null);const Ia={};var Db=Ag.h(this.$).Pb(null).originalText;Db=Object(uc.a)(new li,{neighborhood:Db,mentionStart:0,mentionLength:Db?
Db.length:0});const cc=Object(uc.a)(new mi,{selection:Db,entryPoint:0});J.XOh().then(Tc=>{Tc.applicationName=Fh.appName;Tc.isFirstLaunch=this.isFirstLaunch;Tc.themeId=5;Ia[Fh.smartLookupApplicationInterface]=JSON.stringify(cc);Ia[Fh.LRg]=JSON.stringify(Tc);this.isFirstLaunch=!1});J=new mf.a("ExcelOnline","Web","en-Us");Db=new Eh.a("FA000000006",OSF.StoreType.FirstParty,OSF.StoreType.FirstParty,"1.0.0.0");const rc=new dh.a;rc.optionalProperties[cg.a.Wk]=Tb.a.instance.ga(1809);rc.optionalProperties[cg.a.taskPaneWidth]=
350;rc.optionalProperties[cg.a.sourceLocationOverrideResourceId]="WAC.PROD.URL";rc.kr=Ia;Ug.a.instance.Cxa(Db,"Taskpane","SmartLookupSDXTaskpane",J,rc)}}Fh.LRg="AppProperties";Fh.appName="Excel";Fh.smartLookupApplicationInterface="SmartLookupApplicationInterface";Object(d.a)(Fh,"SmartLookupCommandHandler",Aa.a,[222]);class Ai extends id.a{constructor(J){super(J)}hd(){Th.a(this.$,374,375,this.Xa,J=>{this.$c([new wh(this.$,null,null,null,null,J),new Fh(this.$)])})}static ka(J){id.a.Md(76,new Ai(J))}}
Object(d.a)(Ai,"AgaveCommandHandlerFactory",id.a,[]);var Bi=a(1342),rh=a(108);class xh{constructor(){this.Jd=null;this.pbb=(J,Ia,Db,cc,rc)=>{if(2===Db){J=rc?rc:{};Ia=J.callback;Db=J.refresh?J.refresh:!1;if(!Ia)return 16;Cd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType")&&null!=J.storeType?this.Jd.eQf(Ia,Db,J.storeType):this.Jd.fda(Ia,Db)}return 32};this.Rtc=(J,Ia,Db,cc,rc)=>{if(2===Db){J=rc?rc:{};Ia=J.Observer;if(!Ia)return n.ULS.sendTraceTag(509686147,
220,10,"registerAddinDetailObserver: invalid actionData: {0}",JSON.stringify(J)),16;if(!this.Jd||!this.Jd.r2)return n.ULS.sendTraceTag(509671006,220,10,"registerAddinDetailObserver: ddaFacadeService or its addinDetailsProvider is null, abort the operation, actionData: {0}",JSON.stringify(J)),16;this.Jd.r2.Utc(Ia)}return 32};this.xgj=(J,Ia,Db,cc,rc)=>{2===Db&&(J=rc?rc.callback:null)&&this.Jd.rMg(J);return 32};this.fji=(J,Ia,Db,cc,rc)=>{2===Db&&this.Jd.bqc(null,OSF.AgaveHostAction.InsertAgave,rc);return 32}}initialize(J){xh.initialized||
(this.Jd=J,this.Ag(),xh.initialized=!0)}Ag(){Cd.AFrameworkApplication.rb.Oe(Rc.a.pbb,rh.a.frame,this.pbb,96);Cd.AFrameworkApplication.rb.Oe(Rc.a.Rtc,rh.a.frame,this.Rtc,96);Cd.AFrameworkApplication.rb.Nb(Rc.a.lfj,rh.a.frame,this.xgj);C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RegisterInsertOfficeAddinCommand",!1)&&Cd.AFrameworkApplication.rb.Oe(Rc.a.pff,rh.a.frame,this.fji,96)}static get instance(){xh.La||(xh.La=new xh);return xh.La}}xh.La=null;xh.initialized=!1;Object(d.a)(xh,"AgaveCommandActor",
null,[]);var ph=a(1386),uh=a(1338),bi=a(1343),ci=a(111),Ch;(function(J){J[J.OK=0]="OK";J[J.notReady=1]="notReady";J[J.storeDisabled=2]="storeDisabled";J[J.invokeFailure=3]="invokeFailure"})(Ch||(Ch={}));Object(d.b)("AddinDetailsQueryError",Ch);class Wh{constructor(J){this.MSc=J}next(J){this.MSc=(9301*this.MSc+49297)%233280;return Math.floor(this.MSc/233280*J)}}Object(d.a)(Wh,"Random",null,[]);var Ci=a(983),Si=a(582);class qi{constructor(){this.InsertionPoint=this.GalleryButtons=this.Title=this.SectionId=
null}}Object(d.a)(qi,"GallerySectionProps",null,[]);var Di=a(1344),kg=a(175);class ri{constructor(J,Ia,Db,cc,rc){this.yjb={};this.tLc={};this.cUb=0;this.Yge=!1;this.Ma=J;this.spa=Ia;this.HWb=null;this.Tzg=Db;this.Vzg=cc;this.xDg=rc;this.spa.Utc(Object(Kd.a)(this,this.fgj,"registerIcons"));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("InsertAddInFlyout",!1));appChrome.addInApi.loadOfficeAddInIcons()}get hGe(){return this.tLc}fgj(J,Ia){if(Ia.gY)for(J=0;J<Ia.gY.length;J++)appChrome.addInApi.registerAddinIcon("AddinFlyoutControl"+
Ia.gY[J].solutionId,Ia.gY[J].iconUrl);else n.ULS.sendTraceTag(509687429,220,10,"addinDetails is null which will lead to no icons registered")}D5i(J){const Ia=[];var Db=new Wh((new Date).getDate());for(var cc=0;8>cc;cc++)Array.add(Ia,Db.next(J.count));Db=0;for(let rc of J){cc=!1;for(const Tc of Ia)if(Db===Tc){cc=!0;break}Db++;if(cc){let Tc;(Tc=rc.addinInfo).AUP=20*Tc.AUP}else if(1===rc.addinInfo.priority){let Tc;(Tc=rc.addinInfo).AUP=4*Tc.AUP}else if(2===rc.addinInfo.priority){let Tc;(Tc=rc.addinInfo).AUP=
2*Tc.AUP}}J.Sc((rc,Tc)=>rc.addinInfo.AUP<Tc.addinInfo.AUP?1:-1);return J}P$(J,Ia){const Db={};Db.width=J;Db.height=Ia;Db.backgroundColor="transparent";return Db}M5c(){return{flexDirection:"column"}}f6c(){return{"margin-top":"4px","max-width":"96px",height:"32px","font-size":"12px",overflow:"hidden",display:"-webkit-box","-webkit-line-clamp":"2","-webkit-box-orient":"vertical","white-space":"normal","word-break":"break-word","text-overflow":"ellipsis"}}jWh(){const J={},Ia={},Db={};Ia.root={marginTop:"12px",
marginLeft:"16px",marginRight:"16px",marginBottom:"20px",width:"100%",padding:0};Ia.inner={margin:"-4px"};Db.root=this.P$(100,100);Db.flexContainer=this.M5c();Db.label=this.f6c();J.galleryButtonInExpanded=Db;J.galleryStack=Ia;return J}iNh(){return Object.assign(new Di.a,{Id:"AddinFlyoutMoreButton",ExternalId:"AddinFlyoutMoreButton",Icon:"QuickSearchNoCategories_16",Command:this.xDg,LabelText:CommonUIStrings.l_AddinsFlyoutSeeAllButtonText,FullIconStyle:{root:{"max-width":"16px","max-height":"16px",
"min-width":"16px","min-height":"16px",border:"1px solid #E0E0E0","border-radius":"6px",padding:"15px 15px 15px 15px",overflow:"hidden"}},Alt:CommonUIStrings.l_AddinsPickerGalleryButtonMoreArialText})}dMh(J,Ia,Db){return Object.assign(new Di.a,{Id:Db,ExternalId:Db,Icon:"AddinFlyoutControl"+Ia.solutionId,Command:J===CommonUIStrings.l_PopularAddins?this.Tzg:this.Vzg,LabelText:Ia.displayName,FullIconStyle:{root:{width:"32px",height:"32px","border-radius":"6px",overflow:"hidden",padding:"7px",border:"1px solid #E0E0E0"}},
Alt:Ia.displayName})}J6i(J,Ia,Db){const cc=Object.assign(new qi,{SectionId:J,Title:J,GalleryButtons:[]});for(let rc=0;rc<Db;rc++)Array.add(cc.GalleryButtons,this.dMh(J,Ia[rc],this.yjb[Ia[rc].solutionId]));return cc}q1h(){var J=[];const Ia=this.spa.lwb(0);Array.addRange(J,Ia.gY);const Db=this.spa.lwb(1);Array.addRange(J,Db.gY);let cc=J.length;Cd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)&&n.ULS.sendTraceTag(509687428,220,15,"The MRU list number is {0}, myAddins: {1}|{2}, adminManaged: {3}|{4}",
cc,Ch[Ia.errorCode],Ia.gY.length,Ch[Db.errorCode],Db.gY.length);J.sort((Ie,Qe)=>{Ie=kg.d(Ie.displayName);Qe=kg.d(Qe.displayName);return Kf.a.localeCompare(Ie,Qe)});const rc=6<cc;rc&&(cc=5);for(var Tc=0;Tc<cc;Tc++)if(!(J[Tc].solutionId in this.yjb)){var bd="AddinGalleryButton"+this.cUb.toString();this.yjb[J[Tc].solutionId]=bd;this.tLc[bd]=J[Tc].solutionId;this.cUb++}Tc=[];bd=null;if(this.HWb)Tc=this.HWb;else if(bd=this.spa.lwb(2),0===bd.errorCode){Tc=bd.gY;for(var nd=0;nd<Tc.length;nd++)Tc[nd].solutionId in
this.yjb||(bd="AddinGalleryButton"+this.cUb.toString(),this.yjb[Tc[nd].solutionId]=bd,this.tLc[bd]=Tc[nd].solutionId,this.cUb++)}bd=!0;Tc.length||(bd=!1);nd=0;if(bd&&(nd=J.length?3>=J.length?9:6:12,Tc=this.ISg(Tc,J),nd>Tc.length&&(nd=Tc.length),Cd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)&&!this.Yge)){var Ed="",Yd="";for(let Ie=0;Ie<Tc.length&&Ie<nd;Ie++)Ed+=Tc[Ie].displayName,Ed+=",",Yd+=Tc[Ie].solutionId,Yd+=",";n.ULS.sendTraceTag(509673818,
220,15,"The popular list number is {0}, addin name list:{1}, addin solution id list:{2}",nd,Ed,Yd);this.Yge=!0}Ed=Object.assign(new Qc.a,{Id:"FooterSection",ControlsId:"FooterSection.Controls",ControlList:[]});Yd=Object.assign(new Ea.a,{ExternalId:"InsertMoreAddInsFromFooter",AriaDescription:CommonUIStrings.l_AddinsPickerFooterButtonMoreArialText});Array.add(Ed.ControlList,Yd);appChrome.api.dispatch(appChrome.actions.setControlLabel("InsertMoreAddInsFromFooter",CommonUIStrings.l_AddinPickerButtonMore));
Ed=Object.assign(new hb.a,{Id:"Ribbon.AddinPicker",MenuSectionList:[],MenuFooterSection:Ed,UpdateDynamically:!0});2!==Ia.errorCode||J.length?3===Ia.errorCode||3===Db.errorCode?(n.ULS.sendTraceTag(509687426,220,10,"dataProvider invoke error hit"),J=this.x_e("Common",CommonUIStrings.l_AddinPickerGeneralError),Array.add(Ed.MenuSectionList,J)):(0<cc&&this.VGe(Ed,J,cc,"MRUAddins",CommonUIStrings.l_MyAddinSection,rc),bd&&this.VGe(Ed,Tc,nd,"PopularAddins",CommonUIStrings.l_PopularAddins)):(n.ULS.sendTraceTag(509687427,
220,10,"store disabled hit"),J=this.x_e("StoreDisabled",CommonUIStrings.l_AddinPickerDisableError),Array.add(Ed.MenuSectionList,J));return Ed}x_e(J,Ia){const Db=Object.assign(new Qc.a,{Id:"ErrorSection",ControlsId:"ErrorSection.Controls",ControlList:[]});J=Object.assign(new Ci.a,{Id:"ErrorView",ExternalId:"ReloadAddInPicker",IconName:J,Label:Ia});Array.add(Db.ControlList,J);return Db}ISg(J,Ia){var Db=new l.a;for(var cc=0;cc<J.length;cc++)Db.add(J[cc]);if(!this.HWb){8>Db.count&&(Db=this.D5i(Db));cc=
[];for(var rc of Db)Array.add(cc,rc);this.HWb=cc}for(Db=0;Db<J.length;Db++)for(rc=0;rc<Ia.length;rc++)if(J[Db].solutionId.toLowerCase()===Ia[rc].solutionId.toLowerCase()){Array.remove(J,J[Db--]);break}return J}VGe(J,Ia,Db,cc,rc,Tc=!1){const bd=Object.assign(new Qc.a,{Id:cc+"Section",ControlsId:cc+"Section.Controls",ControlList:[]});cc=Object.assign(new Si.a,{Id:cc+"GalleryControl",ExternalId:cc+"GalleryControl",GalleryStyle:this.jWh(),Width:3,Type:4,GallerySections:[]});Array.add(J.MenuSectionList,
bd);Array.add(bd.ControlList,cc);J=this.J6i(rc,Ia,Db);Tc&&Array.add(J.GalleryButtons,this.iNh());cc.GallerySections.push(J)}N6i(J){if(J)try{J.MenuItems=this.q1h()}catch(Ia){n.ULS.sendTraceTag(509687425,220,10,"GetReactGalleryMenu hit exception "+(Ia?Ia.toString():""))}else n.ULS.sendTraceTag(509687424,220,10,"PopulateMenu menuProps is null")}dispose(){}}Object(d.a)(ri,"AppsFlyoutGenerator",null,[2]);var si=a(356),$i=a(353),Ei=a(1262),ih=a(150),Rg=a(185);class Kh extends ih.a{constructor(J,Ia,Db,cc){super();
this.oX="calc(100% - 46px)";this.k8="15px";this.pX="0";this.Jib="WACDialogPanel";this.iG=695;this.Kib=462;this.n1="80%";this.xhb=350;this.Cpa="100%";this.IS=null;this.Ob=5;this.pe="AddinInstallDialog";this.itg=J;this.BX=Ia;this.$Fg=Db;this.jBg=cc}Iw(){super.Iw();this.Mh.style.width=this.Cpa;this.Mh.style.height=this.oX;this.Mh.style.marginTop=this.k8;this.Mh.style.padding=this.pX;document.getElementById(this.Fh("WACDialogButtonPanel")).style.display="none";this.Cha.setAttribute("tabindex","0");$addHandler(this.Cha,
"keyup",Object(Kd.a)(this,this.onKeyUp,"onKeyUp"));const J=document.createElement("iframe");J.setAttribute("id","InstallAddinDialog");J.setAttribute("src","about:blank");J.setAttribute("width","100%");J.setAttribute("height","100%");J.setAttribute("marginHeight","0");J.setAttribute("marginWidth","0");J.setAttribute("frameBorder","0");J.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin ms-allow-popups allow-popups");const Ia=String.format("https://inclient.store.office.com/gyro/clientstore/flyoutdetails/{0}?client={1}&ui={2}&rs={2}",
this.itg,this.BX,this.$Fg);J.setAttribute("src",Ia);this.IS=J;$addHandler(J,"load",Object(Kd.a)(this,this.onLoad,"onLoad"));$addHandler(window,"message",Object(Kd.a)(this,this.onMessage,"onMessage"));this.Mh.appendChild(J);this.Mh.appendChild(this.wdh())}wdh(){const J=document.createElement("div");J.setAttribute("tabindex","0");$addHandler(J,"focus",Object(Kd.a)(this,this.DWi,"onLoopPivotFocus"));return J}onKeyUp(J){13!==J.keyCode&&32!==J.keyCode||this.hide()}DWi(){this.Cha.focus()}onLoad(){this.IS.focus()}onMessage(J){J=
J.rawEvent;if(J.source===this.IS.contentWindow&&(J=(J=J.data)?J.split("|"):null)&&0<J.length&&("REFRESH_REQUIRED"===J[0]||"PRELOAD_MANIFEST"===J[0])){Be.a.instance.setItem("refreshRequired","true");const Ia={};Ia.solutionId=J[1];Ia.version=Kh.DLi(J[3]);Ia.storeType=J[4];Ia.storeId=J[5];Ia.assetId=J[6];Ia.targetType=Kh.w4i(J[2]);Ia.assetStoreId=J[7];Ia.width=parseInt(J[8]);Ia.height=parseInt(J[9]);this.jBg(Ia)}}Pma(){this.Mh.style.width=this.Cpa;this.Mh.style.height=this.oX;this.Mh.style.marginTop=
this.k8;this.Mh.style.padding=this.pX;this.iG>Rg.a.I_?(this.lb.style.width=String.format("{0}px",Rg.a.I_),this.lb.style.overflowX="scroll",Cd.AFrameworkApplication.isRtl?this.lb.style.right="0":this.lb.style.left="0"):(this.lb.style.width=String.format("{0}px",this.iG),this.lb.style.overflowX="hidden");this.lb.offsetHeight>Rg.a.G_||this.Kib+50>Rg.a.G_?(this.lb.style.height=String.format("{0}px",Rg.a.G_),this.lb.style.overflowY="scroll",this.lb.style.top="0",Cd.AFrameworkApplication.isRtl?this.lb.style.right=
"0":this.lb.style.left="0",this.Mh.style.minHeight=String.format("{0}px",this.xhb)):(this.lb.style.overflowY="hidden",this.lb.style.top="10%",this.lb.style.height=this.n1);this.p$()}p$(){if(this.lb){var J=this.lb.style.zIndex;this.lb.style.zIndex="-9999";if(this.iG>Rg.a.I_)Cd.AFrameworkApplication.isRtl?this.lb.style.marginRight="0":this.lb.style.marginLeft="0";else{const Ia=String.format("{0}px",Math.floor(-this.lb.offsetWidth/2));Cd.AFrameworkApplication.isRtl?this.lb.style.marginRight=Ia:this.lb.style.marginLeft=
Ia;Cd.AFrameworkApplication.isRtl?this.lb.style.right="50%":this.lb.style.left="50%"}this.lb.style.zIndex=String(J)}else n.ULS.sendTraceTag(509871430,306,10,"_divMessageBox is null in CenterDialog()")}CD(){super.CD();const J=document.getElementById(this.Fh(this.Jib));J.style.width=String.format("{0}px",this.iG);J.style.height=this.n1}get Z$(){return this.Mh}dispose(){super.dispose();$removeHandler(window,"message",Object(Kd.a)(this,this.onMessage,"onMessage"))}static w4i(J){switch(J){case "1":return 0;
case "2":return 1;default:return 0}}static DLi(J){const Ia=J.split(".");for(let Db=0;Db<4-Ia.length;Db++)J+=".0";return J}}Object(d.a)(Kh,"AddinInstallDialog",ih.a,[]);var lg=a(19),ti=a(348);class Fi{constructor(){this.bYd=this.WBc=null;this.Hv=0;this.UBc=null}}Object(d.a)(Fi,"FirstPartyAddinTaskpaneOverrides",null,[]);class ui{constructor(){this.addressWithSheet=this.address=this.sheetName=this.sheetId=null;this.columnIndex=this.columnCount=this.rowIndex=this.rowCount=0;this.isSheetEmpty=!1;this.selectionType=
null}}Object(d.a)(ui,"IdeasSelectionContext",null,[]);class vi extends ui{constructor(){super();this.hasTableHeaders=this.isPivotTable=this.isTable=!1;this.tableName=null;this.userSelectedPivotTable=!1}}Object(d.a)(vi,"IdeasTableSelectionContext",ui,[]);class Gi{constructor(){this.sheetName=null;this.lastRow=this.firstRow=this.lastColumn=this.firstColumn=0}}Object(d.a)(Gi,"AutoFilterRange",null,[]);class Hi{constructor(){this.autoFilterType=this.autoFilterRange=null;this.id=this.itemIndex=0}}Object(d.a)(Hi,
"IdeasAutoFilterSource",null,[]);class Ii{constructor(J,Ia){this.selection=J;this.tables=Ia}}Object(d.a)(Ii,"IdeasXLIMTableBoundaries",null,[]);var Bg=a(60);const Ji=(J,Ia,Db,cc,rc,Tc,bd=null)=>{bd=J.Na(9,bd);bd.sharedInfo=Ia;return Bg.g(J,"ShowAgaveTaskpane",bd,Db,cc,rc,Tc,0)};var eh=a(982),Lh=a(65),Ti=a(127),Dh=a(41),Xh=a(376),Mh=a(193),Ki=a(167),Li=a(569),Tf=a(282),T=a(106),Xa=a(128),pb=a(52);class $b extends ih.a{constructor(){super();this.oX="calc(100% - 46px)";this.k8="15px";this.pX="0";this.Jib=
"WACDialogPanel";this.iG=695;this.Kib=462;this.n1="80%";this.xhb=350;this.Cpa="100%";this.Ob=5;this.pe="AppsForOfficeInsertionDialog";this.mKc=!!Cd.AFrameworkApplication.fa&&Cd.AFrameworkApplication.fa.pa("OfficeAddinEnableInsertDialogAccessibilityFix")}Iw(){super.Iw();this.Mh.style.width=this.Cpa;this.Mh.style.height=this.oX;this.Mh.style.marginTop=this.k8;this.Mh.style.padding=this.pX}Pma(){this.Mh.style.width=this.Cpa;this.Mh.style.height=this.oX;this.Mh.style.marginTop=this.k8;this.Mh.style.padding=
this.pX;this.iG>Rg.a.I_?(this.lb.style.width=String.format("{0}px",Rg.a.I_),this.lb.style.overflowX="scroll",Cd.AFrameworkApplication.isRtl?this.lb.style.right="0":this.lb.style.left="0"):(this.lb.style.width=String.format("{0}px",this.iG),this.lb.style.overflowX="hidden");this.lb.offsetHeight>Rg.a.G_||this.Kib+50>Rg.a.G_?(this.lb.style.height=String.format("{0}px",Rg.a.G_),this.lb.style.overflowY="scroll",this.lb.style.top="0",Cd.AFrameworkApplication.isRtl?this.lb.style.right="0":this.lb.style.left=
"0",this.mKc||(this.lb.style.marginTop="-48px"),this.Mh.style.minHeight=String.format("{0}px",this.xhb)):(this.lb.style.overflowY="hidden",this.lb.style.top="10%",this.lb.style.height=this.n1);this.p$()}p$(){if(this.lb){var J=this.lb.style.zIndex;this.lb.style.zIndex="-9999";if(this.iG>Rg.a.I_)Cd.AFrameworkApplication.isRtl?this.lb.style.marginRight="0":this.lb.style.marginLeft="0";else{const Ia=String.format("{0}px",Math.floor(-this.lb.offsetWidth/2));Cd.AFrameworkApplication.isRtl?this.lb.style.marginRight=
Ia:this.lb.style.marginLeft=Ia;Cd.AFrameworkApplication.isRtl?this.lb.style.right="50%":this.lb.style.left="50%"}this.lb.style.zIndex=String(J)}else n.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")}CD(){super.CD();const J=document.getElementById(this.Fh(this.Jib));J.style.width=String.format("{0}px",this.iG);J.style.height=this.n1}get Z$(){return this.Mh}}Object(d.a)($b,"AppsForOfficeInsertionDialog",ih.a,[174]);class vc extends ih.a{constructor(){super();this.oX="calc(100% - 46px)";
this.k8="15px";this.pX="0";this.Jib="WACDialogPanel";this.iG=695;this.Kib=462;this.n1="80%";this.xhb=350;this.Cpa="100%";this.Ob=5;this.pe="SDXDialog"}Iw(){super.Iw();this.Mh.style.width=this.Cpa;this.Mh.style.height=this.oX;this.Mh.style.marginTop=this.k8;this.Mh.style.padding=this.pX}Pma(){this.Mh.style.width=this.Cpa;this.Mh.style.height=this.oX;this.Mh.style.marginTop=this.k8;this.Mh.style.padding=this.pX;this.iG>Rg.a.I_?(this.lb.style.width=String.format("{0}px",Rg.a.I_),this.lb.style.overflowX=
"scroll",Cd.AFrameworkApplication.isRtl?this.lb.style.right="0":this.lb.style.left="0"):(this.lb.style.width=String.format("{0}px",this.iG),this.lb.style.overflowX="hidden");this.lb.offsetHeight>Rg.a.G_||this.Kib+50>Rg.a.G_?(this.lb.style.height=String.format("{0}px",Rg.a.G_),this.lb.style.overflowY="scroll",this.lb.style.top="0",Cd.AFrameworkApplication.isRtl?this.lb.style.right="0":this.lb.style.left="0",this.Mh.style.minHeight=String.format("{0}px",this.xhb)):(this.lb.style.overflowY="hidden",
this.lb.style.top="10%",this.lb.style.height=this.n1);this.p$()}p$(){if(this.lb){var J=this.lb.style.zIndex;this.lb.style.zIndex="-9999";if(this.iG>Rg.a.I_)Cd.AFrameworkApplication.isRtl?this.lb.style.marginRight="0":this.lb.style.marginLeft="0";else{const Ia=String.format("{0}px",Math.floor(-this.lb.offsetWidth/2));Cd.AFrameworkApplication.isRtl?this.lb.style.marginRight=Ia:this.lb.style.marginLeft=Ia;Cd.AFrameworkApplication.isRtl?this.lb.style.right="50%":this.lb.style.left="50%"}this.lb.style.zIndex=
String(J)}else n.ULS.sendTraceTag(524892188,306,10,"_divMessageBox is null in CenterDialog()")}CD(){super.CD();const J=document.getElementById(this.Fh(this.Jib));J.style.width=String.format("{0}px",this.iG);J.style.height=this.n1}get Z$(){return this.Mh}}Object(d.a)(vc,"SDXDialog",ih.a,[]);var Pc=a(980),Zc=a(145),od=a(429),Cc;(function(J){J[J.Valid=2]="Valid";J[J.Invalid=4]="Invalid";J[J.All=6]="All"})(Cc||(Cc={}));Object(d.b)("MetadataState",Cc);var kd=a(345);class rd extends Aa.a{constructor(J,
Ia,Db,cc,rc){super();this.KAa={};this.Xcd={};this.mza=this.jZa=this.sdxDialog=this.EZ=null;this.acb=!1;this.Cob=0;this.HMj=new Map([["InsertAddInsFromBackstage","Backstage"],["InsertAppsForOffice","Ribbon"],["LaunchAddinDialogFromTellMe","TellMe"],["TeachingCallout","TeachingCallout"],["AddinFlyoutMoreButton","AddinFlyoutSeeAll"],["InsertMoreAddInsFromFooter","InsertMoreAddInsFromFooter"]]);this.EZj=(Tc,bd)=>{bd.Dob===bi.a.myAddins&&(this.Cob|=1);bd.Dob===bi.a.adminManaged&&(this.Cob|=2);this.ITd()&&
appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("InsertAddInFlyout",!1))};this.H$h=()=>!Cd.AFrameworkApplication.fa.pa("AppsForOfficeThirdPartyIsDisabled")&&Cd.AFrameworkApplication.lP&&this.c1b&&this.JBe()?32:8;this.B$h=(Tc,bd,nd,Ed,Yd)=>{if(2!==nd)return this.JBe()?32:8;this.c1b.N6i(Yd);return 32};this.b$h=(Tc,bd,nd,Ed,Yd)=>{if(2!==nd)return 32;Tc=Yd[Pc.a.evb];bd=Yd[Pc.a.Pha];nd=Yd[Pc.a.xma];Yd=new ph.a;Yd.zgc=nd.optionalProperties.InstanceToken;Yd.sourceLocationOverrideResourceId=
nd.optionalProperties[cg.a.sourceLocationOverrideResourceId];Yd.hB=nd.kr;Yd.Pha=bd;bd=null!=Yd.zgc?Yd.zgc:(new zd.a(Jh.a.create(),1)).toString();nd=null!=Yd.hB?Yd.hB:{};Ed={};Ed.id=bd;Ed.solutionId=Tc.getId();Ed.version=Tc.JCa;Ed.storeType=Tc.getStoreType();Ed.storeId=Tc.getStoreId();Ed.assetId=null;Ed.assetStoreId=null;Ed.settings=nd;Ed.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;Ed.osfControlType=OSF.OsfControlType.ContainerLevel;Ed.sourceLocationOverrideResourceId=Yd.sourceLocationOverrideResourceId;
Ed.featureGates=Cd.AFrameworkApplication.fa.b3e(Tc.getId());this.tlc(Yd,Ed);return 32};this.nDb=(Tc,bd,nd,Ed,Yd)=>{2===nd&&(this.EZ=new $b,this.EZ.initializeAndShow("",null,null),Tc=Yd.CommandValueId,bd=[],bd.push(Yd.SourceControlId),bd.push(Tc),bd.push(null),this.Jd.Zpf(this.EZ.Z$,bd));return 32};this.c$h=Tc=>{if(Tc)if(Tc=this.c1b.hGe[Tc])if(Tc=this.nXh(Tc)){var bd={[la.a.D9]:Tc,[fg.a.Pf]:rd.nta(Tc)},nd=new gf.a(-741808261,0,this.$.xc,0,"");this.$.Ia.Hb(nd,bd);C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MRUAddinInstalledTelemetryEnabled",
!0)&&(Tc=Telemetry.PrivacyRules.GetPrivacyCompliantId(Tc.solutionId,Tc.storeType,Tc.assetId,null,null,Tc.storeId),sa.a.sendTelemetryEvent(Object(uc.a)(new Lf.a,{name:"Office.Extensibility.Host.InstallMRUAddinFromFlyout",dataFields:bc.a.Mi({SolutionId:Tc})})))}else n.ULS.sendTraceTag(509681666,220,10,"Get add-in entitlement fails.");else n.ULS.sendTraceTag(509642528,220,10,"SolutionId is null.");else n.ULS.sendTraceTag(509642529,220,10,"Control id is null.")};this.a$h=Tc=>{if(Tc)if(Tc=this.c1b.hGe[Tc]){var bd=
this.Jd.Ng;bd=bd?bd.getAppUILocale()||"en-US":"en-US";this.jZa=new Kh(Tc,"wac_excel",bd,nd=>{this.Jd.bqc("installAddinFromFlyout",OSF.AgaveHostAction.ClickTrust,nd);const Ed=new gf.a(-741808261,0,this.$.xc,0,null),Yd={[la.a.D9]:nd,[fg.a.Pf]:rd.nta(nd)};this.$.Ia.Hb(Ed,Yd);C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PopularAddinInstalledTelemetryEnabled",!0)&&(nd=Telemetry.PrivacyRules.GetPrivacyCompliantId(nd.solutionId,nd.storeType,nd.assetId,null,null,nd.storeId),sa.a.sendTelemetryEvent(Object(uc.a)(new Lf.a,
{name:"Office.Extensibility.Host.InstallPopularAddinFromFlyout",dataFields:bc.a.Mi({SolutionId:nd})})))});this.jZa.initializeAndShow("",null,null)}else n.ULS.sendTraceTag(509642526,220,10,"Solution id is null.");else n.ULS.sendTraceTag(509642527,220,10,"Control id is null.")};this.tlc=(Tc,bd)=>{this.sdxDialog=new vc;this.sdxDialog.initializeAndShow("",null,null);bd.div=this.sdxDialog.Z$;Tc={};Tc.InstanceId=bd.id;Tc.WebExtensionType=2;Tc.PrimaryMarketplace={};Tc.PrimaryMarketplace.SolutionId=bd.solutionId;
Tc.PrimaryMarketplace.MarketplaceType=bd.storeType;Tc.PrimaryMarketplace.MarketplaceRef=bd.storeId;Tc.PrimaryMarketplace.SolutionVersion=bd.version;Tc.SrcLocationOverrideResourceId=bd.sourceLocationOverrideResourceId;Tc.WebExtensionOsfControlType=6;this.KAa[bd.solutionId]=bd.settings;Tc.OsfPropertyBag=this.hnc([],bd.solutionId);this.Jd.eIa(Tc);this.Jd.Ng.insertOsfControl(bd)};this.tai=(Tc,bd,nd,Ed,Yd)=>{if(2!==nd)return 32;Tc=Yd[Pc.a.evb];nd=Yd[Pc.a.Pha];Yd=Yd[Pc.a.xma];bd=new ph.a;bd.zgc=Yd.optionalProperties.InstanceToken;
bd.Wk=Yd.optionalProperties[cg.a.Wk];bd.sO=Yd.optionalProperties[cg.a.sO];cg.a.taskPaneWidth in Yd.optionalProperties&&(bd.taskPaneWidth=Yd.optionalProperties[cg.a.taskPaneWidth]);bd.sourceLocationOverrideResourceId=Yd.optionalProperties[cg.a.sourceLocationOverrideResourceId];bd.hB=Yd.kr;bd.onTaskPaneClose=Yd.optionalProperties[cg.a.onTaskPaneClose];bd.Pha=nd;nd=new gf.a(-859308420,0,2,0,"");Ed=Tc.getStoreType()===OSF.StoreType.Sdx;const Ie=new eh.a;Ie.r4=Yd.optionalProperties.HeaderCssClass||lg.a.S2a;
Ie.Bfb=Yd.optionalProperties.TitleCssClass;this.p7(nd,Tc.getId(),bd,Ed,Ie);return 32};this.cai=(Tc,bd,nd,Ed,Yd)=>{if(2!==nd)return 32;Tc=Yd[Pc.a.evb].getId();Yd=Yd[Pc.a.xma].optionalProperties[cg.a.sourceLocationOverrideResourceId];return Tc?(this.Jd.Ng.refreshOsfControl(Tc,Yd),32):8};this.y7i=Tc=>{Tc=Tc.Result;if(Tc=null===Tc?null:Tc.SolutionId)this.Jd.Coe(Tc),T.a(this.$).tna(3,Tc)};this.ENf=(Tc,bd)=>{var nd;const Ed=(Tc=Tc.Result)?Tc.AgaveData:null;if(Ed){var Yd=Telemetry.PrivacyRules.GetPrivacyCompliantId(Ed.PrimaryMarketplace.SolutionId,
Ed.PrimaryMarketplace.MarketplaceType,null===(nd=null===Ed||void 0===Ed?void 0:Ed.AssetMarketplace)||void 0===nd?void 0:nd.SolutionId,null,null,Ed.PrimaryMarketplace.MarketplaceRef);n.ULS.shipAssertTag(537170434,0,Ed.TaskpaneWidth===rd.Dkh,`Taskpane width is ${Ed.TaskpaneWidth}, assetId is ${Yd}.`);if(nd=this.Xcd[Ed.PrimaryMarketplace.SolutionId])nd.WBc&&(Ed.TaskpaneTitle=nd.WBc),nd.UBc&&(Ed.TaskpaneIconId=nd.UBc),nd.bYd&&(Ed.TaskpaneButtonTooltip=nd.bYd),0<nd.Hv&&(Ed.TaskpaneWidth=nd.Hv);bd&&(Ed.FocusOnIframeWhenLoaded=
bd.focusOnIframeWhenLoaded,bd.width&&(Ed.TaskpaneWidth=bd.width),Ed.TaskpaneIconCssClass=bd.ek,Ed.TaskpaneHeaderCssClass=bd.r4,Ed.TaskpaneTitleCssClass=bd.Bfb,Ed.IsFirstPartyOptOutAppContextOptmization=bd.isFirstPartyOptOutAppContextOptmization);this.KAa[Ed.PrimaryMarketplace.SolutionId]&&(Ed.OsfPropertyBag=this.hnc(Ed.OsfPropertyBag,Ed.PrimaryMarketplace.SolutionId));Li.a(Ed)||(Ed.WebExtensionOsfControlType=1);Ed&&(this.Jd.Coe(Tc.SolutionId),this.Jd.eIa(Ed))}else n.ULS.sendTraceTag(593285650,220,
10,"AgaveCommandHandler.PostInsertAgaveTaskpaneSuccess: failed to return valid response.")};this.tFh=Tc=>{Tc&&(this.gcd.wof(Tc),this.TAe())};this.INf=Tc=>{Tc=Tc.toDataURL("image/jpeg");const bd=this.Jd.Baa(rd.Tbf+"."+rd.aec),nd={};nd.screenshot=Tc;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(bd,"onScreenshot",nd,()=>{})};this.t9h=(Tc,bd,nd,Ed,Yd)=>{if(2!==nd)return 32;if(ci.a.lh(Yd)||Yd[Pc.a.nFe]!==uh.a.action)return 8;bd=Yd[Pc.a.xma];return bd?(Tc=(Tc=this.s_h(Yd))?this.Jd.Baa(Tc):null)?
(Yd=this.Jd.Vah(Yd[Pc.a.Pha],bd.optionalProperties[cg.a.HVc]),C.EwaSettings.isChangeGateEnabled("OfficeVSO:5295210_SdxTaskpaneTitleOverrideNew")&&(nd=this.Jd.gZ(Tc),nd.TaskpaneTitle!==bd.optionalProperties[cg.a.Wk]&&(nd.TaskpaneTitle=bd.optionalProperties[cg.a.Wk],nd.TaskpaneIconCssClass=bd.optionalProperties.IconCssClass,nd.TaskpaneIconUrl=bd.optionalProperties.TaskPaneIconUrl,nd.TaskpaneIconId=bd.optionalProperties.TaskPaneIconId,C.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")?
(bd=this.Jd.Ng,bd.changeIframeTitle(Tc,nd.TaskpaneTitle),nd=bd.getOsfControl(Tc),bd.raiseOsfControlStatusChange(nd)):(bd=this.Jd.Ng.getOsfControl(Tc),this.Jd.Ng.raiseOsfControlStatusChange(bd)))),OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Tc,Yd,this.NLb),32):8:8};this.NLb=(Tc,bd)=>{this.Jd.VHh(Tc,bd)};this.RKd=()=>{Cf.TaskExtensions.c3(tg.GetServiceTaskFactory.Oa(this.$.da,20,404,1),Tc=>{Tc.result.XKa()},this.$.la)};this.$=J;this.viewBlockContainerHelpers=Db;this.Jd=Ia;this.gcd=
cc;this.hh=rc;this.dYc&&(this.r2=this.Jd.r2,null!==this.r2?(appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("InsertAddInFlyout",!1)),this.r2.Utc(this.EZj),this.c1b=new ri(this.hh,this.r2,Rc.a.plc.toString(),Rc.a.ulc.toString(),"1296389134")):n.ULS.sendTraceTag(509642525,220,10,"addinDetailsProvider is null"));this.hh.Nb(Rc.a.Q9f,rh.a.frame,this.tai);this.hh.Nb(Rc.a.TZf,rh.a.frame,this.cai);this.hh.Nb(Rc.a.VVe,rh.a.frame,this.t9h);this.hh.Nb(Rc.a.tlc,rh.a.frame,this.b$h);
this.hh.Nb(Rc.a.nDb,rh.a.frame,this.nDb);this.hh.Nb(Rc.a.cQf,rh.a.frame,this.H$h);this.hh.Nb(Rc.a.eNf,rh.a.frame,this.B$h)}get dYc(){return Cd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)&&Cd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)}ITd(){return 0!==this.Cob&&this.$.lP}JBe(){let J=this.r2.lwb(bi.a.myAddins);if(J.errorCode!==Ch.notReady)return!0;J=this.r2.lwb(bi.a.adminManaged);
return J.errorCode!==Ch.notReady}jNg(J){this.addHandler(rd.bFd,J)}okj(J){this.removeHandler(rd.bFd,J)}dispose(){gi.a.Ja(this.EZ);this.EZ=null;this.acb&&(this.$.ea.Cn(this.RKd),this.acb=!1);super.dispose()}e1c(){this.EZ&&this.EZ.hide();this.jZa&&this.jZa.hide()}NNj(J,Ia){var Db;if(J){this.raiseEvent(rd.bFd);const cc=J.split("|");this.fDi(J,Ia,cc);this.EZ=new $b;this.EZ.initializeAndShow("",null,null);this.Jd.Zpf(this.EZ.Z$,cc);C.EwaSettings.isChangeGateEnabled("OfficeVSO:7163330_LogAddinInstallOriginEnabledForExcel")&&
(window[rd.DPg]=null!==(Db=this.HMj.get(J))&&void 0!==Db?Db:"Unknown")}}Ekd(J,Ia,Db){var cc=Cf.TaskExtensions.Tj();if(-515602470===Db.command||-167264441===Db.command||-336193495===Db.command||2086613372===Db.command||-1444574190===Db.command||-1336341324===Db.command||451940422===Db.command)cc=this.Q9h(J,Ia,Db);418618014===Db.command&&(Ia=new ph.a,Ia.Wk=Tb.a.instance.ga(1822),cc=this.p7(Db,rd.oci,Ia,!0));if((Db.tabName===this.$.Bb+yd.a.s_f||Db.tabName===yd.a.Q_)&&2===Db.Ve||-1!==Array.indexOf("A0 A1 Help ContactSupport WhatsNew GiveFeedback".split(" "),
J[fg.a.Kc])||J[fg.a.Kc]===yd.a.WU)return this.J$e(J,Db);if(7===Db.Ve&&J.SourceControlId===this.$.Bb+yd.a.$dc)return J.MenuItemId=yd.a.PJd,this.J$e(J,Db);1221897806===Db.command&&(cc=this.z9f(Db,"Format"));if(1930653487===Db.command||1172793074===Db.command)cc=this.z9f(Db,"Data");-1753056834===Db.command&&(cc=this.wJj(Db));932597253===Db.command&&(n.ULS.sendTraceTag(537170445,0,50,"InsertPowerBIPivotTable - addin launch requested"),Zc.c(932597253,!0),Ia=new ph.a,Ia.Wk=Tb.a.instance.ga(2162),Ia.sourceLocationOverrideResourceId=
C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIUseDevURL",!1)?rd.I7i:rd.K7i,Ia.focusOnIframeWhenLoaded=!0,Ia.taskPaneWidth=rd.Adf,cc={},cc.LaunchSource=Object(V.a)(String,J.SourceControlId),cc.LaunchMode="Default",Ia.hB=cc,cc=this.p7(Db,rd.J7i,Ia,!0));301511274===Db.command&&(cc=this.HJj(Db));if(515196233===Db.command){Ia=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerEnableTaskPaneFeedback",!1);cc=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerEnableClosePaneFeedback",
!1);var rc=this.$.da.Aa(465);rc&&(rc.acf(),Ia||cc)&&(rc.Hii(),cc&&rc.Mzj(10===Db.Ve));rc=new ph.a;rc.Wk=Tb.a.instance.ga(2236);const Tc={};Tc.SourceUILocation=si.a[Db.Ve];if(Ia||cc)Tc.SessionID=this.$.ea.sessionId,Ia&&this.sRd(Tc);rc.hB=Tc;Ia=new eh.a;Ia.r4=lg.a.S2a;cc=this.p7(Db,rd.I2i,rc,!0,Ia,void 0,rc.Wk)}1723441034===Db.command&&(Ia=new ph.a,Ia.Wk=Tb.a.instance.ga(2248),Ia.focusOnIframeWhenLoaded=!0,Ia.taskPaneWidth=rd.z$i,cc=new eh.a,cc.r4=lg.a.twh,cc=this.p7(Db,od.b,Ia,!0,cc));C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",
!1)&&J.LoadDataFromPictureTaskpane&&(Ia={},cc=new ph.a,cc.Wk=Tb.a.instance.ga(2275),Ia.SessionID=J.SessionID,cc.hB=Ia,cc.focusOnIframeWhenLoaded=!0,cc=this.p7(Db,J.DataFromPictureAssetId,cc,!0));return cc}insertAgave(J,Ia){var Db=Cf.TaskExtensions.Tj();const cc=this.$;let rc;var Tc=J[la.a.D9];rc=J[fg.a.Pf];let bd=null;eh.a.key in J&&(bd=J[eh.a.key]);this.EZ&&this.EZ.hide();this.jZa&&this.jZa.hide();if(!rc||!Tc)return n.ULS.sendTraceTag(537170444,220,10,"Inserting addin needs inserted agave parameters"),
Db;this.$.d5&&yd.a.soa in J&&(rc.EnabledInViewMode=J[yd.a.soa]);J=this.LRh(Ia.command);if(!rc.EnabledInViewMode&&!cc.Us(null,!1,J))return Db;let nd=void 0===rc.IsToBePersisted||null===rc.IsToBePersisted||rc.IsToBePersisted?0:16;if(1===rc.TargetType)Db=this.yji(rc,Tc,Ia,bd,nd);else{Tc=Ag.h(cc);Db=this.viewBlockContainerHelpers.Rgb(Tc);const Ed=cc.ea.isNamedObjectViewMode?cc.na.sheetName:cc.na.name;let Yd,Ie,Qe,nf;Db?(Tc=Db.fe,Yd=Tc.De.top,Ie=Tc.De.left,Qe=Db.zI.x,nf=Db.zI.y):(Yd=Ie=1,Db=this.viewBlockContainerHelpers.$Ka(Tc),
Qe=Db.x,nf=Db.y);const xg=this.$.oa.xa.Wb();nd|=64;Db=Xh.a(this.$.userOperationManager,(jg,ag,eg)=>{var pg=cc.oa.xa,Og=Yd,Mg=Ie,Pg=Qe,Nh=nf;jg=Tf.b(jg,this.y7i);const ei=pg.Na(9,xg);ei.sharedInfo=rc;ei.sheetName=Ed;ei.positionRow=Og;ei.positionCol=Mg;ei.positionOffsetX=Pg;ei.positionOffsetY=Nh;return Bg.g(pg,"InsertWebExtension",ei,jg,ag,eg,null,0)},jg=>new Mh.a(534,0,jg,nd),Ia)}return Db}r9g(){var J=pc.a.instance.Tb("Common.App.ICustomerFeedbackUiWrapper");if(!C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OcvFeedbackvNextEnabled",
!1)){var Ia=pc.a.instance.Tb("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager");this.gcd?this.gcd.okb?this.TAe():Ia.instance.i9c(this.tFh):n.ULS.sendTraceTag(537170443,1302,15,"feedbackFormManager is undefined")}Ia={};Cd.AFrameworkApplication.fa.Xoe(Ia);J=J.instance.getContext(Ia);Ia={};"telemetryGroup"in J&&(Ia=J.telemetryGroup);Ia.processSessionId=J.sessionId;Ia.officeBuild=J.build;J.telemetryGroup=Ia;J.feedbackType=-1;J.userVoiceEnabled=!1;"disableIncludeScreenshot"in J||(J.disableIncludeScreenshot=
!1);"screenshot"in J||(J.screenshot=!1);J.disableScreenshotPreview=!1;J.includeScreenshotSelectedDefault=!0;return J}VNf(J){if(!this.mza&&C.EwaSettings.getBooleanFeatureGate(rd.hei,!1)){var Ia=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?"Insights.Https.PPE.Bundle":"Insights.Https.Bundle";Ia=this.qye(Ia);const Db=new eh.a;Db.ek=lg.a.Vub;Db.r4=lg.a.LSe;Db.Bfb=lg.a.Cad;this.mza=this.Swc(Ia,null,!1,null,Db);Xa.b(this.$).rd(Ti.a.X7i,{["Location"]:J?si.a[J.Ve]:0,["InputMethod"]:J?
$i.a[J.method]:0},void 0,!0);C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PassXlimTableBoundariesToIdeas",!1)&&this.NZd()}}sRd(J){const Ia=this.$.ea.wg.get(17);pc.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Db=>{Db.isFeatureEnabled("mso_sendASmile",Ia).then(cc=>{J.FeedbackEnabled=Ia&&cc;return null})})}z9f(J,Ia){const Db=Ag.h(this.$),cc=new ph.a;var rc={};rc.ActiveTab=Ia;rc.DatapaneFlighting=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",
!1);rc.AceFlighting=!0;rc.ThemeColorsFlighting=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&C.EwaSettings.isChangeGateEnabled("OfficeVSO:5732064_ThemeColorsInChartsTaskpaneEnabled");rc.UOMirror=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UOMirror",!1);rc.FormatTaskPaneAceButtonDark=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneAceButtonDark",!1);rc.FormatTaskPaneBetterFeedbackButton=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterFeedbackButton",
!1);rc.FormatTaskPaneBetterScrollbar=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterScrollbar",!1);rc.FormatTaskPaneUXImprovePhase2=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneUXImprovePhase2",!1);this.sRd(rc);rc.startTimeMs=Date.now();rc.UserSessionId=this.$.ya.UserSessionId;(Ia=Db.ha.Ra.Wn)&&(rc.SubSelection=Ia);n.ULS.sendTraceTag(592524688,0,50,`Chart task pane launched. UserSessionId: ${rc.UserSessionId}, UILocation: ${void 0===J.Ve||
null===J.Ve?"Null":si.a[J.Ve]}, SubSelection: ${Ia||"ChartRoot"}`);cc.hB=rc;cc.Wk=Tb.a.instance.ga(983);rc=new eh.a;rc.r4=lg.a.S2a;return this.p7(J,rd.q3g,cc,!0,rc)}wJj(J){const Ia=new ph.a;Ia.hB={};Ia.Wk=Tb.a.instance.ga(1808);Ia.sO=rd.xqf;const Db=new eh.a;Db.r4=lg.a.S2a;return this.p7(J,rd.xqf,Ia,!0,Db,void 0,Ia.Wk)}HJj(J){const Ia=new ph.a;Ia.hB={};Ia.Wk=Tb.a.instance.ga(2186);const Db=new eh.a;Db.r4=lg.a.Vxh;Db.Bfb=lg.a.PSe;return this.p7(J,rd.LKi,Ia,!0,Db)}J$e(J,Ia){const Db=rd.Tbf;var cc=J[fg.a.Kc].toString();
const rc={},Tc=new ph.a;Tc.Wk=Tb.a.instance.ga(9);switch(cc){case "A0":rc.query=(J[fg.a.Pf]||"").split("|").slice(2,ti.a.sS).join("|");break;case "A1":rc.query=J.CommandValueId;break;case "Help":rc.gwdropdownflightinfo=C.EwaSettings.ra(222);rc.query="";break;case yd.a.PJd:C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?(Tc.Wk=Tb.a.instance.ga(1774),Tc.sourceLocationOverrideResourceId=rd.aec,rc.feedback=this.r9g()):rc.query=cc;break;case "HelpArticle":rc.query=
J[fg.a.Pf];break;case "ContactSupport":rc.query=cc;Tc.sourceLocationOverrideResourceId=rd.z9g;break;case "ShowTraining":case "WhatsNew":rc.query=cc;break;default:return Wg.Task.Sa(!0)}Tc.hB=rc;cc=new eh.a;cc.r4=lg.a.S2a;return this.p7(Ia,Db,Tc,!1,cc,J[yd.a.soa]||!1)}qye(J){const Ia={};Ia.SolutionId=rd.R5a;Ia.Version="0.0.0.0";Ia.StoreType=OSF.StoreType.Sdx;Ia.StoreId=OSF.StoreType.Sdx;Ia.AssetId=null;Ia.AssetStoreId=null;Ia.Height=0;Ia.Width=0;Ia.TargetType=OSF.OsfControlTarget.TaskPane;Ia.IsToBePersisted=
!1;Ia.SourceLocationOverrideResourceId=J;Ia.SharedRuntimeId=J;return Ia}Q9h(J,Ia,Db){function cc(){bd.LaunchMode="Default";C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?rc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":rc.sourceLocationOverrideResourceId="Insights.Https.Bundle";rc.Wk=Tb.a.instance.ga(1821);rc.sO=rd.K0b;rc.ek=lg.a.Vub;Tc.ek=lg.a.Vub}const rc=new ph.a,Tc=new eh.a,bd={};this.mza&&this.sRd(bd);bd.LaunchSource="";bd.StartTimeMs=Date.now();
bd.CorrelationId=Jh.a.create().toString();rc.hB=bd;rc.focusOnIframeWhenLoaded=!0;rc.taskPaneWidth=rd.Adf;Tc.r4=lg.a.LSe;Tc.Bfb=lg.a.Cad;switch(Db.command){case -1444574190:let Yd;bd.LaunchMode="RecommendedPivotTables";bd.SelectionContext="";bd.LaunchSource="PivotTableHandRaise"===Object(V.a)(String,J.SourceControlId)?"PivotTableHandRaise":"InsertPivotTable";if(this.$&&C.EwaSettings.isChangeGateEnabled("OfficeVSO:4618462_PassSourceSelectionToIdeas")&&J.SourceSelection){var nd=J.SourceSelection.split(",")[0];
Ia=C.EwaSettings.isChangeGateEnabled("OfficeVSO:4701499_IdeasSelectionIndexing")?-1:0;if(({sheetName:nd,vRf:Yd,range:Ed}=Dh.Y(nd,this.$.va)).returnValue&&!Ag.h(this.$).tb.b5(Ed))J=this.$.va.getItemByName(nd),bd.SelectionContext=JSON.stringify(Object(uc.a)(new ui,{address:Yd,addressWithSheet:nd+"!"+Ed.RC(!1),sheetId:Lh.d(J),sheetName:nd,isSheetEmpty:!1,columnCount:Ed.width,rowCount:Ed.height,columnIndex:Ed.left+Ia,rowIndex:Ed.top+Ia,selectionType:"Continuous"}));else if((J=this.$.yb.getItemByName(Object(V.a)(String,
J.SourceSelection)))&&Lh.n(J)){var Ed=Ki.a(J,!0);nd=this.$.va.getItemByName(J.sheetName);bd.SelectionContext=JSON.stringify(Object(uc.a)(new vi,{tableName:J.name,hasTableHeaders:Ki.d(J),isPivotTable:!1,isTable:!0,userSelectedPivotTable:!1,address:Ed.RC(!1),addressWithSheet:nd.name+"!"+Ed.RC(!1),sheetId:Lh.d(nd),sheetName:nd.name,isSheetEmpty:!1,columnCount:Ed.width,rowCount:Ed.height,columnIndex:Ed.left+Ia,rowIndex:Ed.top+Ia,selectionType:"Continuous"}))}}C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",
!1)?rc.sourceLocationOverrideResourceId="RecommendPivotTables.PPE.Bundle":rc.sourceLocationOverrideResourceId="RecommendPivotTables.Bundle";rc.Wk=Tb.a.instance.ga(1820);rc.sO=rd.R5i;rc.ek=lg.a.fVe;Tc.ek=lg.a.fVe;break;case -336193495:bd.LaunchMode="RecommendedCharts";C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?rc.sourceLocationOverrideResourceId="RecommendCharts.PPE.Bundle":rc.sourceLocationOverrideResourceId="RecommendCharts.Bundle";rc.Wk=Tb.a.instance.ga(1819);
rc.sO=rd.Vdj;rc.ek=lg.a.gVe;Tc.ek=lg.a.gVe;break;case -1336341324:if(!C.EwaSettings.ra(417))return Wg.Task.Sa(!1);bd.LaunchMode="NL";rc.sO=rd.K0b;C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?rc.sourceLocationOverrideResourceId="IdeasNL.PPE.Bundle":rc.sourceLocationOverrideResourceId="IdeasNL.Bundle";switch(C.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:rc.Wk=Tb.a.instance.ga(1824);bd.NLLaunchModeBrandingCandidatesIndex=
1;break;case 2:rc.Wk=Tb.a.instance.ga(1825);bd.NLLaunchModeBrandingCandidatesIndex=2;break;default:rc.Wk=Tb.a.instance.ga(1823),bd.NLLaunchModeBrandingCandidatesIndex=0}break;case 2086613372:if(!C.EwaSettings.ra(217))return Wg.Task.Sa(!1);bd.LaunchMode="ChartDesigner";bd.LaunchSelectionMode=Ia.toString();C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?rc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":rc.sourceLocationOverrideResourceId="Insights.Https.Bundle";
rc.Wk=Tb.a.instance.ga(1826);rc.sO=rd.K0b;break;case 451940422:bd.LaunchSource="AutoFilter";Ed=JSON.parse(J.CommandValueId);bd.AutoFilterSource=JSON.stringify(Object.assign(new Hi,{autoFilterRange:{sheetName:Ed.AutoFilterRange.SheetName,firstColumn:Ed.AutoFilterRange.FirstColumn,lastColumn:Ed.AutoFilterRange.LastColumn,firstRow:Ed.AutoFilterRange.FirstRow,lastRow:Ed.AutoFilterRange.LastRow},autoFilterType:Ed.AutoFilterType,itemIndex:Ed.ItemIndex,id:Ed.Id}));cc();break;case -167264441:bd.LaunchMode=
"ExcelIntelligence";bd.TableName=J.TableName;C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?rc.sourceLocationOverrideResourceId="RecommendCharts.PPE.Bundle":rc.sourceLocationOverrideResourceId="RecommendCharts.Bundle";rc.Wk=Tb.a.instance.ga(1821);rc.sO=rd.K0b;rc.ek=lg.a.Vub;Tc.ek=lg.a.Vub;break;default:C.EwaSettings.ra(217)&&(bd.LaunchSelectionMode=Ia.toString()),C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PassXlimTableBoundariesToIdeas",!1)&&(bd.XlimTableBoundaries=
this.K4h()),cc()}C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?rc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":rc.sourceLocationOverrideResourceId="Insights.Https.Bundle";return this.mza?this.mza.So(()=>this.I2f(bd,rc)):this.Jhi(Db,rc,Tc,bd)}Jhi(J,Ia,Db,cc){this.mza=this.Swc(this.qye(Ia.sourceLocationOverrideResourceId),Ia,!1,J,Db,!1);return C.EwaSettings.isChangeGateEnabled("OfficeVSO:6256725_NoActionMsgOnFirstInstance")?(cc.NoActionMsgOnFirstInstance=
!0,this.KAa[rd.R5a]=cc,this.mza):this.mza.So(()=>this.I2f(cc,Ia))}I2f(J,Ia){const Db=this.Jd.Baa(this.Jd.R3a(rd.R5a,Ia.sourceLocationOverrideResourceId));if(Db){this.KAa[rd.R5a]=J;const cc=this.hnc(this.Jd.gZ(Db).OsfPropertyBag,rd.R5a);this.Jd.gZ(Db).OsfPropertyBag=cc}this.Cxa(rd.R5a,"LaunchIdeasAction",J,Ia);return Wg.Task.Sa(!0)}nXh(J){if(this.r2){if(J=this.r2.lOh(J)){const Ia={};Ia.solutionId=J.solutionId;Ia.version=J.version;Ia.storeType=J.storeType;Ia.storeId=J.storeId;Ia.assetId=J.assetId;Ia.assetStoreId=
J.assetStoreId;Ia.targetType=J.targetType;Ia.displayName=J.displayName;Ia.width=J.width;Ia.height=J.height;return Ia}n.ULS.sendTraceTag(509642524,0,10,"Get addinDetail fail.");return null}n.ULS.sendTraceTag(509642523,0,10,"No addinDetailManager instance.");return null}p7(J,Ia,Db=null,cc=!1,rc=null,Tc=!1,bd=null){Cf.TaskExtensions.Tj();Db||(Db=new ph.a);const nd={};nd.SolutionId=Ia;nd.Version="0.0.0.0";nd.StoreType=cc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;nd.StoreId=cc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;
nd.AssetId=null;nd.AssetStoreId=null;nd.Height=0;nd.Width=0;nd.TargetType=OSF.OsfControlTarget.TaskPane;nd.IsToBePersisted=!1;nd.SourceLocationOverrideResourceId=Db.sourceLocationOverrideResourceId;if(Db.Wk||bd)this.Xcd[Ia]=Object(uc.a)(new Fi,{WBc:Db.Wk,bYd:bd,UBc:Db.sO});C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)?(Db.hB||(Db.hB={}),Db.hB.ShowFeedback=this.$.isFeedbackEnabled,this.KAa[Ia]=Db.hB):Db.hB&&(this.KAa[Ia]=
Db.hB);Ia={};Ia[fg.a.Pf]=nd;bd={};bd.solutionId=nd.SolutionId;bd.version=nd.Version;bd.storeType=nd.StoreType;bd.storeId=nd.StoreId;bd.assetId=nd.AssetId;bd.assetStoreId=nd.AssetStoreId;bd.height=nd.Height;bd.targetType=nd.TargetType;bd.width=nd.Width;bd.isAddinCommands=!cc;Ia[la.a.D9]=bd;rc||(rc=new eh.a);rc.focusOnIframeWhenLoaded=Db.focusOnIframeWhenLoaded;rc.width=Db.taskPaneWidth;Ia[eh.a.key]=rc;Ia[yd.a.soa]=Tc;return this.insertAgave(Ia,J)}yji(J,Ia,Db,cc,rc){const Tc=(Yd,Ie)=>{var Qe=Yd.SolutionId;
var nf=OSF.OsfControl.isFirstPartyStoreString(Yd.StoreType);nf&&Yd.SourceLocationOverrideResourceId&&(Qe=this.Jd.R3a(Qe,Yd.SourceLocationOverrideResourceId));var xg=this.Jd.QBe(Qe,null,Yd.SharedRuntimeId);nf&&(C.EwaSettings.ra(263)&&xg&&(nf=this.Jd.Baa(Qe))&&(Qe=null,Qe=this.hnc(this.Jd.gZ(nf).OsfPropertyBag,Yd.SolutionId),(nf=this.Jd.Ng.getOsfControl(nf))&&nf.setSettings(Qe)),Yd.SharedRuntimeId&&xg||this.Jd.Ng.refreshOsfControl(Yd.SolutionId,Yd.SourceLocationOverrideResourceId));if(!xg){const jg=
this.$.oa.xa.Wb();let ag=519;xg=(eg,pg,Og)=>{var Mg=this.$.oa.xa;eg=Tf.b(eg,this.ENf);const Pg=Mg.Na(9,jg);Pg.sharedInfo=Yd;return Bg.g(Mg,"InsertAgaveTaskpane",Pg,eg,pg,Og,cc,0)};void 0===Yd.IsToBePersisted||null===Yd.IsToBePersisted||Yd.IsToBePersisted||(ag=538,xg=(eg,pg,Og)=>{const Mg=Telemetry.PrivacyRules.GetPrivacyCompliantId(Yd.SolutionId,Yd.StoreType,Yd.AssetId,null,null,Yd.StoreId);n.ULS.sendTraceTag(537170442,220,50,`Web Method ShowAgaveTaskpane is called, StoreType ${Yd.StoreType}, StoreId ${Yd.StoreId}, SolutionId ${Mg}.`);
return Ji(this.$.oa.xa,Yd,Tf.b(eg,this.ENf),pg,Og,cc,jg)});rc|=64;return Xh.a(this.$.userOperationManager,xg,eg=>new Mh.a(ag,0,eg,rc),Ie)}return Cf.TaskExtensions.Yaa()},bd=Yd=>{var Ie=Telemetry.PrivacyRules.GetPrivacyCompliantId(Yd.solutionId,Yd.storeType,Yd.assetId,null,null,Yd.storeId);n.ULS.sendTraceTag(537170440,220,50,`Insert addincommands for ${Ie} from ${Yd.storeType}.`);Ie={};const Qe=new l.a;Qe.add(Yd);Ie[la.a.Eob]=Qe;Ie[la.a.VL]=3;Yd=new gf.a(Rc.a.lDb,0,this.$.xc,0,null);return this.$.Ia.Hb(Yd,
Ie)};if(!C.EwaSettings.ra(52)||J.StoreId===OSF.StoreType.FirstParty)return Tc(J,Db,cc);if(Ia.isAddinCommands)return bd(Ia);const nd=new Gc.a,Ed={};Ed.solutionId=J.SolutionId;Ed.version=J.Version;Ed.storeType=J.StoreType;Ed.storeId=J.StoreId;Ed.targetData=J;C.EwaSettings.ra(92)&&(Ed.clearCache=!0);this.Jd.Ng.isAddinCommandsAsync(Ed,(Yd,Ie,Qe)=>{nd.setResult(Ie);Yd||(Yd=Qe.targetData,Ie=Telemetry.PrivacyRules.GetPrivacyCompliantId(Yd.SolutionId,Yd.StoreType,Yd.AssetId,null,null,Yd.StoreId),n.ULS.sendTraceTag(537170438,
220,10,`Judging AddinCommands failed for ${Ie} from ${Yd.StoreType} during addin inserting`))});return Cf.TaskExtensions.ts(nd.task,Yd=>Yd.result?bd(Ia):Tc(J,Db,cc),this.$.la)}hnc(J,Ia){if(!this.KAa[Ia])return J;const Db={};if(J)for(const rc of J)Db[rc[0]]=rc[1];J=this.KAa[Ia];for(var cc of Object.keys(J))cc===rd.vFh&&C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?Db[cc]=Sys.Serialization.JavaScriptSerializer.serialize(J[cc]):Db[cc]=Sys.Serialization.JavaScriptSerializer.serialize(J[cc].toString());
cc=Object.keys(Db).length;cc=Array(cc);J=0;for(const rc of Object.keys(Db))cc[J]=[rc,Db[rc].toString()],J++;return cc}fDi(J,Ia,Db){const cc=this.$.ya.UserSessionId,rc=this.$.ya.UICultureTag,Tc=this.$.ya.UICultureTagLcid,bd=this.$.ya.WacHostId;let nd="",Ed="";5<=Db.length&&(nd=Db[3],Ed=Db[4]);this.gDi(nd,Ed,J,Ia,rc,Tc,cc,bd)}gDi(J,Ia,Db,cc,rc,Tc,bd,nd){const Ed={};Ed.a=bd;Ed.b=Db;Ed.c=cc;Ed.d=J;Ed.e=Ia;Ed.f=rc;Ed.g=Tc;Ed.h=nd;pb.b().Se(36,Ed)}TAe(){if(Ei.a.Lyf())n.ULS.sendTraceTag(537170433,1302,15,
"OBF is undefined");else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(this.INf);return}catch(J){n.ULS.sendTraceTag(537170432,1302,15,"Failed to use createScreenshot "+(J?J.toString():null))}try{OfficeBrowserFeedback.html2canvas(document.body,null)().then(this.INf)}catch(J){n.ULS.sendTraceTag(537170403,1302,15,"Failed to use html2canvas"+(J?J.toString():null))}}}Swc(J,Ia=null,Db=!1,cc=null,rc=null,Tc=!0){var bd=J.SolutionId;let nd=Wg.Task.Sa(!1);J&&bd&&J.SharedRuntimeId&&(cc=cc||
new gf.a(-859308420,0,2,0,""),bd={},bd.solutionId=J.SolutionId,bd.version=J.Version,bd.storeType=J.StoreType,bd.storeId=J.StoreId,bd.assetId=J.AssetId,bd.assetStoreId=J.AssetStoreId,bd.height=J.Height,bd.targetType=J.TargetType,bd.width=0,bd.isAddinCommands=!1,bd.sharedRuntimeId=J.SharedRuntimeId,J.Preload=Tc,rc=rc?rc:new eh.a,rc.width=0,Ia&&(rc.focusOnIframeWhenLoaded=Ia.focusOnIframeWhenLoaded,Tc=new Fi,Ia.Wk&&(Tc.WBc=Ia.Wk),0<Ia.taskPaneWidth&&(Tc.Hv=Ia.taskPaneWidth),Ia.sO&&(Tc.UBc=Ia.sO),this.Xcd[J.SolutionId]=
Tc),Ia={},Ia[fg.a.Pf]=J,Ia[la.a.D9]=bd,Ia[eh.a.key]=rc,Ia[yd.a.soa]=Db,nd=this.insertAgave(Ia,cc));return nd}Cxa(J,Ia,Db,cc=null){if(J&&Ia){J=new Eh.a(J,OSF.StoreType.Sdx,OSF.StoreType.Sdx,"1.0.0.0");const rc=new mf.a("ExcelOnline","Web",this.$.ya.UICultureTag),Tc=new dh.a;Tc.optionalProperties[cg.a.HVc]=Db;cc&&(cc.sourceLocationOverrideResourceId&&(Tc.optionalProperties[cg.a.sourceLocationOverrideResourceId]=cc.sourceLocationOverrideResourceId),cc.Wk&&(Tc.optionalProperties[cg.a.Wk]=cc.Wk),cc.ek&&
(Tc.optionalProperties.IconCssClass=cc.ek),cc.ZXd&&(Tc.optionalProperties.TaskPaneIconUrl=cc.ZXd),cc.sO&&(Tc.optionalProperties.TaskPaneIconId=cc.sO));Ug.a.instance.Cxa(J,uh.a.action,Ia,rc,Tc)}}s_h(J){if(!ci.a.lh(J)){var Ia=J[Pc.a.evb];if(Ia&&(Ia=Ia.getId(),J=J[Pc.a.xma],Ia&&J))return this.R3a(Ia,J.optionalProperties[cg.a.sourceLocationOverrideResourceId])}return null}R3a(J,Ia=null){return J&&Ia?`${J}.${Ia}`:J}LRh(J){switch(J){case 1172793074:case 1221897806:case 1930653487:return 2;case -515602470:case 2086613372:return C.EwaSettings.ra(217)?
1023:1;case 1723441034:return 1023;case -859308420:return 1023;case 515196233:return 1023;default:return 1}}NZd(){this.$.ea.Zf?this.RKd():(this.$.ea.Dk(this.RKd),this.acb=!0)}K4h(){var J=this.$.da.Aa(20);if(!J)return this.NZd(),"";J=J.XKa();if(!J)return this.NZd(),"";var Ia=this.$.va.getItemByName(this.$.ea.isNamedObjectViewMode?this.$.na.sheetName:this.$.na.name);Ia=Lh.d(Ia);var Db=Ag.h(this.$).ha.qa.selectedRanges;const cc=[];for(const Tc of Db){Db=new kd.a(Tc,Ia);var rc=J.Sxb(Db,Cc.Valid);Db=[];
if(rc)for(const bd of rc)(rc=bd.table.pA)&&(rc=rc.range.toString())&&Db.push(rc);Db=new Ii(Tc.toString(),Db);cc.push(Db)}return JSON.stringify(cc)}}rd.hei="Microsoft.Office.Excel.IdeasXLOPreload";rd.bFd="IDS";rd.Tbf="FA000000012";rd.R5a="FA000000005";rd.oci="HelloWorld";rd.q3g="FA000000014";rd.aec="Help.GiveFeedback.Url";rd.z9g="Help.ContactSupport.Url";rd.vFh="feedback";rd.xqf="FA000000066";rd.K7i="PowerBi.Url";rd.I7i="PowerBi.DevUrl";rd.J7i="FA000000054";rd.LKi="FA000000064";rd.I2i="FA000000075";
rd.K0b="AnalyzeDataTaskPane";rd.Vdj="RecommendedChartsTaskPane";rd.R5i="PivotTableTaskPane";rd.Dkh=350;rd.Adf=320;rd.z$i=320;rd.DPg="g_InstallOrigin";rd.nta=J=>{const Ia={};Ia.Version=J.version;Ia.AssetId=J.assetId;C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?Ia.AssetStoreId=J.assetStoreId:Ia.AssetStoreId=null!==J.assetStoreId?J.assetStoreId.toString():null;Ia.StoreType=J.storeType;Ia.Height=J.height;Ia.SolutionId=J.solutionId;Ia.StoreId=J.storeId;Ia.TargetType=
J.targetType;Ia.Width=1===Ia.TargetType?0:J.width;Ia.SharedRuntimeId=J.sharedRuntimeId;return Ia};Object(d.a)(rd,"AgaveCommandManager",Aa.a,[800,801]);class Id extends h.a{constructor(J){super();this.$=J;this.Db()}create(){const J=this.$.da,Ia=tg.GetServiceTaskFactory.create(J,106,this.la,this.Xa),Db=tg.GetServiceTaskFactory.create(J,104,this.la,this.Xa),cc=ji.a.loadScript(35,0,this.Xa,void 0,void 0,375);Cf.TaskExtensions.za(Cf.TaskExtensions.Fd([Db,Ia,cc],this.la),()=>{let rc=null;C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",
!1)&&(rc=pc.a.instance.Tb("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").instance);xh.instance.initialize(Ia.result);const Tc=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PreloadRaceCondition6395242",!0)?Object(Xc.a)(this.$.da,374,()=>new rd(this.$,Ia.result,Db.result,rc,Cd.AFrameworkApplication.rb)):new rd(this.$,Ia.result,Db.result,rc,Cd.AFrameworkApplication.rb);J.Ha(206,Tc);this.nb(J.Aa(374)||J.Ha(374,Tc))},this.la,3);pc.a.instance.register(Bi.a,"Common.Utils.AriaNotifier").as("Common.Utils.IAriaNotifier").qc().yc(()=>
new Bi.a(this.$.eu))}static ka(J){J.da.Ha(375,new Id(J))}}Object(d.a)(Id,"AgaveCommandManagerFactory",h.a,[]);var Nd=a(564);class ee{constructor(){this.initialized=!1;this.agaveCommandManager=this.Jd=this.H0a=null;this.UT={}}initialize(J){C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&!this.initialized&&this.Trj(J)}gji(J,Ia){let Db=Cf.TaskExtensions.Tj();if(this.initialized&&J&&0<J.length){let cc=this.zOh(J);J in this.UT&&(Db=this.agaveCommandManager.insertAgave(cc,
Ia))}return Db}ZHg(J){this.initialized&&(J=J[fg.a.Pf]||{},!J.SolutionId||J.SolutionId in this.UT||this.Jd.fda(Ia=>{this.fda(Ia)},!0))}Y$h(J){this.initialized&&(J=J||"")&&0<J.length&&J in this.UT&&(delete this.UT[J],this.Jd.fda(Ia=>{this.fda(Ia)},!0))}zOh(J){return J in this.UT?this.UT[J]:{}}fda(J){var Ia=!1;if(J&&!J.errorCode){if(J.value)for(const Db of J.value)J=Db[1],Db[3]==OSF.OsfControlTarget.InContent&&J&&0<J.length&&!(J in this.UT)&&(Ia={NoReporting:!1,IsSystemInitiated:!1},Ia.description=Db[2],
Ia.iconUrl=Db[9],Ia[la.a.D9]={solutionId:Db[1],version:Db[4],storeType:Db[12],storeId:Db[11],assetId:Db[5],assetStoreId:Db[6],targetType:Db[3],width:Db[7],height:Db[8],displayName:Db[0],id:Db[1]},Ia[fg.a.Pf]={SolutionId:Db[1],Version:Db[4],StoreType:Db[12],StoreId:Db[11],AssetId:Db[5],AssetStoreId:Db[6],TargetType:Db[3],Width:Db[7],Height:Db[8],Id:Db[1]},this.UT[J]=Ia,Ia=!0);Ia&&this.sch()}}sch(){let J=[];for(const Ia in this.UT)J.push({id:Ia,controlType:0,title:this.UT[Ia][la.a.D9].displayName});
if(0<J.length){for(const Ia in this.UT)appChrome.addInApi.registerAddinIcon("AddinIcon_"+Ia,this.UT[Ia].iconUrl);this.B4g();appChrome.addInApi.dispatchActionsToInstallAddIn({tabs:[{id:ee.Syf,isOfficeTab:!0,groups:[{id:ee.Aff,title:ee.Bff,controls:J}]}]});for(const Ia in this.UT)this.H0a.addCommandToMaps(Object(uc.a)(new Fe.a(Ia,"-1473679467"),{legacyControlId:Ia}))}}B4g(){appChrome.addInApi.dispatchActionsToRemoveAddIn({tabs:[{id:ee.Syf,isOfficeTab:!0,groups:[{id:ee.Aff,title:ee.Bff,controls:[]}]}]})}Trj(J){const Ia=
tg.GetServiceTaskFactory.Oa(J.da,374,375,1),Db=tg.GetServiceTaskFactory.create(J.da,106,J.la,1);Cf.TaskExtensions.za(Cf.TaskExtensions.Fd([Ia,Db],J.la),()=>{this.agaveCommandManager=Ia.result;this.H0a=pc.a.instance.mg("Common.IExternalUICommandDefinitionMapping")||new Nd.a(J.Bb,J);Cd.AFrameworkApplication.rb.Nb(Rc.a.PUf,rh.a.frame,(cc,rc,Tc,bd,nd)=>{this.Y$h(nd)});this.Jd=Db.result;this.Jd.fda(cc=>{this.fda(cc)},!0);this.initialized=!0},J.la,3)}}ee.Syf="tabinsert";ee.Aff="installedContentAddins";
ee.Bff=Tb.a.instance.ga(2284);Object(d.a)(ee,"AgaveCommandRibbon",null,[796]);class Ce extends h.a{constructor(J){super();this.$=J;this.Db()}create(){if(C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)){const J=this.$.da,Ia=new ee;Ia.initialize(this.$);this.nb(J.Aa(488)||J.Ha(488,Ia))}}static ka(J){J.da.Ha(489,new Ce(J))}}Object(d.a)(Ce,"AgaveCommandRibbonFactory",h.a,[]);var Je=a(1325),$e=a(746);class Qf{constructor(){this.o9d=this.J8d=
this.ffa=null;this.Pjb=0}get displayName(){return this.ffa}set displayName(J){this.ffa=J}get email(){return this.J8d}set email(J){this.J8d=J}get federationProvider(){return this.o9d}set federationProvider(J){this.o9d=J}get identityType(){return this.Pjb}set identityType(J){this.Pjb=J}getTypeName(){return"Microsoft.Authentication.OfficeIdentityInfo"}invokePropertyGet(J){switch(J){case 4:return this.displayName;case 3:return this.email;case 2:return this.federationProvider;case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J,Ia){switch(J){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,0,"string");return;case 2:this.federationProvider=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,0,"string");return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,
0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,Ia){this.invokePropertySet(J,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,Ia){J=this.invokeMethod(J,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}static Ddh(J){const Ia=new Qf;Ia.displayName=J.displayName;Ia.email=J.email;
switch(J.authority){case Je.a.uKf:Ia.identityType=1;break;default:Ia.identityType=0}Ia.federationProvider="";return Ia}}Object(d.a)(Qf,"OfficeIdentityInfo",null,[]);class Sf{static get CQe(){return Sf.lwg}static ncc(J){return J in Sf.CQe?Sf.CQe[J].toString():J}}Sf.map=null;Sf.lwg={["GeneralException"]:$e.a.generalException,["AccessDenied"]:$e.a.DVc,["ApiNotAvailable"]:$e.a.apiNotAvailable,["UserNotSignedIn"]:$e.a.userNotSignedIn,["UserAborted"]:$e.a.userAborted,["UnsupportedUserIdentity"]:$e.a.xZj,
["InvalidResourceUrl"]:$e.a.invalidResourceUrl,["InvalidGrant"]:$e.a.invalidGrant,["AddinIsAlreadyRequestingToken"]:$e.a.FPg,["ResourceNotAllowed"]:$e.a.Jpj,["ClientError"]:$e.a.clientError,["ServerError"]:$e.a.serverError};Object(d.a)(Sf,"SingleSignOnErrorCodeMap",null,[]);class kf{constructor(J,Ia){this.xRb=J;this.Pjb=Ia}get accessToken(){return this.xRb}set accessToken(J){this.xRb=J}get tokenIdenityType(){return this.Pjb}set tokenIdenityType(J){this.Pjb=J}getTypeName(){return"Microsoft.Authentication.SingleSignOnToken"}invokePropertyGet(J){switch(J){case 2:return this.accessToken;
case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J,Ia){switch(J){case 2:this.accessToken=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,0,"string");return;case 3:this.tokenIdenityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokePropertySetAsync(J,Ia){this.invokePropertySet(J,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,Ia){J=this.invokeMethod(J,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}}Object(d.a)(kf,"SingleSignOnToken",null,[]);class gg{constructor(){this.d5d=null;this.aje=this.kXb=this.RD="";this.mke=!0;this.options=null}get authChallenge(){return this.d5d}set authChallenge(J){this.d5d=
J}get correlationId(){return this.RD}set correlationId(J){this.RD=J}get policy(){return null}set policy(J){}get resource(){return this.kXb}set resource(J){this.kXb=J}get scope(){return this.aje}set scope(J){this.aje=J}get silentLogin(){return this.mke}set silentLogin(J){this.mke=J}getTypeName(){return"Microsoft.Authentication.TokenParameters"}invokePropertyGet(J){switch(J){case 3:return this.authChallenge;case 7:return this.correlationId;case 4:return this.policy;case 2:return this.resource;case 5:return this.scope;
case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J,Ia){switch(J){case 3:this.authChallenge=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,0,"string");return;case 7:this.correlationId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,
0,"string");return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,0,"string");return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,0,"string");return;case 6:this.silentLogin=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,Ia){this.invokePropertySet(J,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokeMethodAsync(J,Ia){J=this.invokeMethod(J,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}}Object(d.a)(gg,"TokenParameters",null,[643]);class Wf{constructor(J,Ia){this.jib=Ia;this.fA=J}get roamingSettings(){return null}getAccessToken(J){const Ia=this.jib.getOsfControl(this.fA),Db=Ia.getManifest(),cc=Db.getMarketplaceID();this.ZNa(J,cc);return OfficeExtension.WacRuntime.Utility.createPromise((rc,Tc)=>{Ia.isFirstParty()&&this.jib._enableFirstPartySSO?this.bmi(Db,J)?pc.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAccessToken(J,
cc).then(bd=>{rc(bd)},bd=>{Tc(bd)}):Tc($e.a.DVc):Tc($e.a.apiNotAvailable)}).then(rc=>{let Tc;switch(rc.authority){case Je.a.uKf:Tc=1;break;default:Tc=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new kf(rc.accessToken,Tc))},rc=>{this.logErrorResponse(J,cc,rc);return rc?OfficeExtension.WacRuntime.Utility.createPromise((Tc,bd)=>{bd(OfficeExtension.WacRuntime.Utility.createRichApiException(rc,Sf.ncc(rc)))}):OfficeExtension.WacRuntime.Utility.createPromise((Tc,bd)=>{bd(OfficeExtension.WacRuntime.Utility.createRichApiException($e.a.generalException,
Sf.ncc($e.a.generalException)))})})}getAuthContext(){return null}getPrimaryIdentityInfo(){const J=this.jib.getOsfControl(this.fA);J.getManifest();const Ia=J.getManifest().getMarketplaceID();return OfficeExtension.WacRuntime.Utility.createPromise((Db,cc)=>{pc.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getPrimaryIdentityInfo(Ia).then(rc=>{Db(rc)},rc=>{cc(rc.toString())})}).then(Db=>{Db=Qf.Ddh(Db);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Db)},Db=>Db?OfficeExtension.WacRuntime.Utility.createPromise((cc,
rc)=>{rc(OfficeExtension.WacRuntime.Utility.createRichApiException(Db,Sf.ncc(Db)))}):OfficeExtension.WacRuntime.Utility.createPromise((cc,rc)=>{rc(OfficeExtension.WacRuntime.Utility.createRichApiException($e.a.generalException,Sf.ncc($e.a.generalException)))}))}getTypeName(){return"Microsoft.Authentication.AuthenticationService"}invokePropertyGet(J){switch(J){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,Ia){this.invokePropertySet(J,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,Ia){switch(J){case 1:return this.QNh(Ia);case 3:return this.jPh();case 2:return this.y0h()}J=this.invokeMethod(J,
Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}QNh(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,gg);return this.getAccessToken(J)}jPh(){return this.getAuthContext()}y0h(){return this.getPrimaryIdentityInfo()}bmi(J,Ia){let Db=!1;const cc=J.getWebApplicationAuthorizations();J=null;for(const rc of cc)if(rc.getResource().toLowerCase()===Ia.resource.toLowerCase()){J=rc;Db=!0;break}if(!Db)return!1;Ia=Ia.scope.split(" ,+");for(const rc of Ia)if(rc&&rc.length){Ia=
!1;for(const Tc of J.getScopes())rc.toLowerCase()===Tc.toLowerCase()&&(Ia=!0);if(!Ia)return!1}return!0}ZNa(J,Ia){J=this.Eyf(J.resource);n.ULS.sendTraceTag(538572831,369,50,"{0}",{["manifestId"]:Ia,["resource"]:J})}logErrorResponse(J,Ia,Db){J=this.Eyf(J.resource);n.ULS.sendTraceTag(538572830,369,10,"{0}",{["manifestId"]:Ia,["resource"]:J,["error"]:Db})}Eyf(J){return J.replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(d.a)(Wf,"AuthenticationService",null,[]);class mg{create(J,
Ia){return new Wf(J,Ia)}}Object(d.a)(mg,"AuthenticationServiceFactory",null,[]);var Ng=a(161),Kg=a(865),ug=a(981),qh=a(963);class ig{}ig.generalException="generalException";ig.invalidArgument="invalidArgument";ig.notAllowed="notAllowed";ig.apiNotAvailable="apiNotAvailable";ig.unresolvedPendingRequest="unresolvedPendingRequest";ig.timeout="timeout";ig.adalTimeout="adalTimeout";ig.userNotSignedIn="userNotSignedIn";ig.userAborted="userAborted";ig.silentSignInFailed="silentSignInFailed";ig.invalidResourceUrl=
"invalidResourceUrl";ig.invalidGrant="invalidGrant";ig.connectionLost="connectionLost";ig.clientError="clientError";ig.serverError="serverError";Object(d.a)(ig,"WopiHostErrorCodes",null,[]);var uf=a(556);class Zf{}Object(d.a)(Zf,"OAuthCallerMetadata",null,[]);var Xe=a(27);class Gf{constructor(J){this.Rxa=J;this.cwg=Cd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}mHg(J,Ia,Db,cc,rc,Tc){if(!this.Rxa)return cc=new ug.a,cc.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,
Promise.resolve(cc);const bd=new Zf;bd.AddinName=rc;bd.AddinTrustId=Tc;let nd=-1;Tc=null;if(cc&&this.Fjf())Tc=this.Rxa.ahg(la.a.nCc,J,cc,Gf.n6e(rc),bd);else{const Ed=Date.now();Tc=this.Rxa.AO(la.a.nCc,J,bd).then(Yd=>{nd=Date.now()-Ed;const Ie=(Ia||Db)&&"login_required"===Yd.ErrorCode;return(Ia&&("interaction_required"===Yd.ErrorCode||"consent_required"===Yd.ErrorCode||"invalid_grant"===Yd.ErrorCode)||Ie)&&this.Fjf()?this.Rxa.ahg(la.a.nCc,J,null,Gf.n6e(rc),bd):Promise.resolve(Yd)})}return Tc.then(Ed=>
{const Yd=new ug.a;Ed.IsSuccess?(Yd.token=Ed.Token,Ed.Telemetry&&(Yd.LTa=Ed.Telemetry.fromCache,Yd.expiresOn=Ed.Telemetry.expiresOn)):(Yd.errorCode=this.CGi(Ed),Yd.fYd=this.X3i(Ed));return Yd}).catch(()=>{const Ed=new ug.a;Ed.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(Ed)}).then(Ed=>{Ed.bha="OauthManager";0<=nd&&(Ed.dyb=nd);return Ed})}Doi(J){const Ia=(Cd.AFrameworkApplication.fa.Wa(Cd.AFrameworkApplication.J7)||"").toLowerCase();return(Xe.a.kxa||"teams"===
Ia&&uf.OAuthManagerSettings.kzb)&&!Gf.hoi(J)||!this.Rxa||!this.Rxa.v6a()?!1:!0}Fjf(){return this.cwg||1!==qh.a.Abc()}CGi(J){switch(J.ErrorCode){case "UserCancelled":case "interaction_required":J=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case "consent_required":case "invalid_grant":J=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":J=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":J=
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;break;case "invalid_resource":J=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":J=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:J=J.ErrorCode===ig.userAborted?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:J.ErrorCode===ig.silentSignInFailed?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:J.ErrorCode===ig.invalidResourceUrl?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:
J.ErrorCode===ig.invalidGrant?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:J.ErrorCode===ig.connectionLost?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return J}X3i(J){let Ia="";(J=RegExp("AADSTS(\\d+)").exec(J.ErrorMessage))&&1<J.length&&(Ia=J[1]);return Ia}static n6e(J){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,J)}static hoi(J){if(!J)return!1;J=J.toLowerCase();for(const Ia of Kg.AppsForOfficeSingleSignOnManager.vYe)if(Ia===
J)return!0;return!1}}Object(d.a)(Gf,"AppsforOfficeTokenFromOauthManager",null,[167]);class Ef{constructor(J){this.KFi=J}static Hoa(){if(Cd.AFrameworkApplication.fa.pa("AppForOfficeSSOV2IsEnabled")){var J=null;try{J=pc.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(Ia){n.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+Ia)}J=new Gf(J);Ef.La=new Ef(J)}}static getInstance(){Ef.jae||(Ef.Hoa(),Ef.jae=!0);return Ef.La}}Ef.La=null;Ef.jae=!1;Object(d.a)(Ef,"AppsForOfficeOauthManagerFactory",
null,[147]);var dg=a(1324),Vf=a(135);class Nf{constructor(J,Ia,Db,cc){this.menuItemId=J;this.KF=Ia;this.gPj=Db;this.fGh=cc}}Object(d.a)(Nf,"NewDocumentParameters",null,[]);const Rf=J=>{var Ia=J.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}","{df562add-0bb3-47cb-9780-0bd6c054e5e8}",3,0);var Db=Ia.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);Db.addParameter("shortcuts","String[]",1,null,0);Ia.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",
0);Db=Ia.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);Db.addParameter("shortcuts","Object",1,null,0);Ia=J.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}","{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);Db=Ia.addMethod("GetSharedFilePickerResponse",1,"Object",1,1,"SharedFilePickerResponse",0);Db.addParameter("pickerCustomizationJsonString","String",1,null,0);Ia=J.addType("Microsoft.ExcelServices.WacWorkbook","{79eea901-609d-4204-a8f6-9f40f367a679}",
"",3,0);Db=Ia.addMethod("CreateAndOpenWorkbook",1,"Void",0,1,"CreateAndOpenWorkbook",0);Db.addParameter("base64File","String",1,null,0);Ia=J.addType("Microsoft.ExcelServices.AppRuntimeService","{21351f4a-8ee5-42e7-9776-62f23a567703}","",3,0);Ia.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Db=Ia.addMethod("SetAppRuntimeState",1,"Void",0,1,"SetAppRuntimeState",0);Db.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);Ia=
J.addType("Microsoft.ExcelServices.CustomFunctionManager","{158db0d2-762c-449f-9917-b7c4778971ef}","{1a8cbe28-44d1-4b9a-9cd2-69311e909c1a}",3,0);Ia.addProperty("Status",2,"Microsoft.ExcelServices.CustomFunctionEngineStatus",2,!0,null,0);Db=Ia.addMethod("Register",1,"Void",0,0,"Register",0);Db.addParameter("metadata","String",1,null,0);Db.addParameter("javascript","String",1,null,0);Ia=J.addType("Microsoft.ExcelServices.CustomFunctionEngineStatus","{22864d76-d53e-416b-b496-23e5bb38ebd0}","",2,0);Ia.addProperty("Enabled",
1,"Boolean",1,!1,null,0);Ia.addProperty("NativeRuntime",3,"Boolean",1,!1,null,0);Ia.addProperty("StreamingEnabled",2,"Boolean",1,!1,null,0);Ia=J.addEnumType("Microsoft.Authentication.IdentityType");Ia.addEnumField("OrganizationAccount",0);Ia.addEnumField("MicrosoftAccount",1);Ia=J.addEnumType("Microsoft.Authentication.AuthorityType");Ia.addEnumField("External",0);Ia.addEnumField("Msa",1);Ia.addEnumField("Aad",2);Ia=J.addType("Microsoft.Authentication.OfficeIdentityInfo","{4c070280-74b4-4850-adfd-178c6c287817}",
"{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0);Ia.addProperty("DisplayName",4,"String",1,!1,null,0);Ia.addProperty("Email",3,"String",1,!1,null,0);Ia.addProperty("FederationProvider",2,"String",1,!1,null,0);Ia.addProperty("IdentityType",1,"Microsoft.Authentication.IdentityType",1,!1,null,0);Ia=J.addType("Microsoft.Authentication.AuthContext","{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);Ia.addProperty("AppId",4,"String",1,!1,null,0);Ia.addProperty("Authority",
2,"String",1,!1,null,0);Ia.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",1,!1,null,0);Ia.addProperty("IsAnonymous",5,"Boolean",1,!1,null,0);Ia.addProperty("TenantId",6,"String",1,!1,null,0);Ia.addProperty("Upn",1,"String",1,!1,null,0);Ia=J.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}","{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);Ia.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",3,!0,
null,0);Db=Ia.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",4);Db.addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null,0);Ia.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",2,1,"AuthContext",0);Ia.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",2,1,"PrimaryIdentityInfo",4);Ia=J.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}","{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",
2,0);Ia.addProperty("AuthChallenge",3,"String",1,!1,null,0);Ia.addProperty("CorrelationId",7,"String",1,!1,null,0);Ia.addProperty("Policy",4,"String",1,!1,null,0);Ia.addProperty("Resource",2,"String",1,!1,null,0);Ia.addProperty("Scope",5,"String",1,!1,null,0);Ia.addProperty("SilentLogin",6,"Boolean",1,!1,null,0);Ia=J.addType("Microsoft.Authentication.SingleSignOnToken","{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0);Ia.addProperty("AccessToken",2,"String",1,
!1,null,0);Ia.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null,0);Ia=J.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0);Ia.addProperty("Id",1,"String",1,!0,null,0);Ia.addProperty("Value",2,"Object",1,!1,null,0);Ia=J.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}","",3,0);Db=Ia.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",0);Db.addParameter("id",
"String",1,null,0);Db=Ia.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",3,1,"ItemOrNullObject",0);Db.addParameter("id","String",1,null,0);Ia=J.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}","{43a4559c-806b-4e89-914e-da9256212148}",3,0);Ia.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Db=Ia.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);Db.addParameter("appRuntimeState",
"Microsoft.AppRuntime.AppRuntimeState",1,null,0);Ia=J.addEnumType("Microsoft.AppRuntime.AppRuntimeState");Ia.addEnumField("Inactive",0);Ia.addEnumField("Background",1);Ia.addEnumField("Visible",2);Ia=J.addEnumType("Microsoft.AppRuntime.Visibility");Ia.addEnumField("Hidden",1);Ia.addEnumField("Visible",2);Ia=J.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}","{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);Ia.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",
3,!0,null,0);Db=Ia.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);Db.addParameter("jsonCreate","String",1,null,0);Db=Ia.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);Db.addParameter("jsonUpdate","String",1,null,0);Db=Ia.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);Db.addParameter("id","String",1,null,0);Db=Ia.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);Db.addParameter("id","String",1,null,
0);Ia.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Ia=J.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);Ia.addProperty("Id",2,"String",1,!0,null,0);Db=Ia.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",0);Db.addParameter("visibility","Boolean",1,null,0);Ia.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Ia=J.addType("Microsoft.DynamicRibbon.RibbonButton","{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);Ia.addProperty("Enabled",3,"Boolean",
1,!1,null,0);Ia.addProperty("Id",2,"String",1,!0,null,0);Ia.addProperty("Label",4,"String",1,!0,null,0);Db=Ia.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);Db.addParameter("enabled","Boolean",1,null,0);Ia.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Ia=J.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);Ia.addMethod("GetCount",3,"Int32",1,1,"Count",0);Db=Ia.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);Db.addParameter("key",
"String",1,null,0);Ia.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Ia.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0);Ia=J.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");Ia.addEnumField("Unknown",0);Ia.addEnumField("Basic",1);Ia.addEnumField("Premium",2);Ia=J.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0);Db=Ia.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",
1,1,"FeatureTier",0);Db.addParameter("feature","String",1,null,0);Db.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);Db=Ia.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",0);Db.addParameter("feature","String",1,null,0);Db=Ia.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);Db.addParameter("feature","String",1,null,0);Db.addParameter("fallbackValue","Boolean",1,null,0);Ia.addMethod("IsFreemiumUpsellEnabled",
3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);Db=Ia.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);Db.addParameter("experienceId","String",1,null,0);Db=Ia.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",4);Db.addParameter("feature","String",1,null,0);Ia=J.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);Ia.addProperty("Id",5,"String",1,!0,null,0);Ia.addMethod("_RegisterStateChange",6,"Void",
0,1,"_RegisterStateChange",0);Ia.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);Ia=J.addType("Microsoft.InternalService.AddinInternalService","{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",3,0);Ia.addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);Ia=J.addType("Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification","{d689e1c3-2ec7-4e8d-9327-7d6703cde2c5}","{bc4e14a3-3463-425f-8e52-07b578e4c4b7}",
3,0);Ia.addMethod("Disable",3,"Void",0,1,"Disable",0);Ia.addMethod("Enable",2,"Void",0,1,"Enable",0);Ia.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0)};var $f=a(190);class Xg{constructor(J,Ia){this.vAg=J;this.RAg=Ia}createAndOpenWorkbook(J){if(J&&J.length>this.vAg)throw n.ULS.sendTraceTag(538572821,0,15,"Too large base64 stream size:{0}",J.length),OfficeExtension.WacRuntime.Utility.createRichApiException($e.a.invalidArgument,$f.a.ga(1768));const Ia=new Nf("blank","agave",J?"streamBase64":"streamEmpty",
J);let Db=null;return OfficeExtension.WacRuntime.Utility.createPromise((cc,rc)=>{const Tc=new Vf.StandardDialog;Tc.Ob=4;Tc.Wl(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,bd=>{2===bd||0===bd?rc("Cancelled"):(Db=window.open(""),this.RAg.create(cc,rc,Ia).h1a())})}).then(cc=>{if(!cc)throw OfficeExtension.WacRuntime.Utility.createRichApiException($e.a.generalException,$f.a.ga(1764));try{Db.top.location.href=cc}catch(rc){n.ULS.sendTraceTag(538572820,0,10,
"CreateWorkbook API - exception while trying to change Window.Top.Location.Href, isChrome:{0}, exception:{1}",Xe.a.cp,rc),n.ULS.sendTraceTag(538572819,0,50,"CreateWorkbook API: calling self Window.Location.Replace instead of Window.Top.Location.Replace"),Db.location.replace(cc)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},cc=>{if("Cancelled"===cc)throw OfficeExtension.WacRuntime.Utility.createRichApiException($e.a.eFd,$f.a.ga(1767));Db.close();this.rSj();return null})}getTypeName(){return"Microsoft.ExcelServices.WacWorkbook"}invokePropertyGet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,Ia){this.invokePropertySet(J,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,Ia){switch(J){case 1:return this.nbh(Ia)}J=this.invokeMethod(J,
Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}nbh(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");return this.createAndOpenWorkbook(J)}rSj(){throw OfficeExtension.WacRuntime.Utility.createRichApiException($e.a.generalException,$f.a.ga(1764));}}Object(d.a)(Xg,"WacWorkbook",null,[]);const Xf=(J,Ia)=>{console.log("InternalTestPreviewExecution.PreviewExecutionMethod: typeof(objectId)="+typeof J+", objectId="+J+", value="+Ia);return null},Mi=J=>{J.add("InternalTest",
"PreviewExecutionMethod",Xf)};var jh=a(252),Uf=a(744),Ui=a(745);class wg{constructor(J){this.jb=J}get $(){return this.jb}}Object(d.a)(wg,"RichApiPreviewExecutionContext",null,[]);var Sg=a(24),Yg=a(987),hg=a(213),Lg=a(215),kh=a(87),vh=a(12);class Gh extends Lg.a{constructor(J,Ia,Db,cc,rc){super(J,"Select Data");this.htmlSanitizationHelper=this.bqb=null;this.qKe=Ia;this.Q7c=Db;this.htmlSanitizationHelper=rc;this.callback=cc}get kc(){return"DdaBindingPrompt"}start(J,Ia){let Db="<div class='"+kh.a.gvh+
" "+lg.a.jo+"'><label for='{1}'>{0}</label></div>\r\n<div><input type='text' id='{1}' maxlength='388' class='"+kh.a.Px+"' /></div>";Db=String.format(Db,Kf.a.yg(this.Q7c.DdaBindingsMethod.PromptText.substr(0,200)),"bindingText");C.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&C.EwaSettings.isChangeGateEnabled("OfficeVSO:7126095_ReduceInnerHTMLUsageForDdaBindingPrompt")&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.Rh(this.Fb,Db):this.Fb.innerHTML=Db;this.bqb=
vh.DOMElementExtensions.getElementById(this.Fb,"bindingText");J=Ia?J.m3a(Ia,this.Q7c.DdaBindingsMethod.BindingId):null;(null===J||void 0===J?0:J.IsValidRef)?(Ia=new Sg.Range(J.Reference.FirstRow+1,J.Reference.FirstColumn+1,J.Reference.LastRow+1,J.Reference.LastColumn+1,!1,!1),this.bqb.value=J.Reference.SheetName+"!"+Ia):(J=Ag.h(this.$).ha,this.bqb.value=Lh.f(this.$.na)||!J.qa.Tg?"":J.fia);this.initialize();this.kg()}$p(){this.s2c();this.addButton(0);this.addButton(1);super.$p()}setFocus(){vh.DOMElementExtensions.setFocus(this.bqb)}validate(){return!0}commit(){let J=
this.bqb.value.trim();const Ia=J.indexOf("!");-1!==Ia&&(J=this.C3h(J.substring(0,Ia))+J.substr(Ia));this.qKe.addBinding(this.Q7c,J,0,this.callback);return!0}Gsa(){this.qKe.$P.zf(Uf.a.internalError,this.callback);super.Gsa()}C3h(J){J=qg.a.trimStart(J.trim(),"=");return J.length?J.startsWith("'")&&J.endsWith("'")?J:Qh.HelperMethods.B9b(J):""}}Object(d.a)(Gh,"DdaBindingPrompt",Lg.a,[]);class di{constructor(J){this.ea=J}zf(J,Ia){if(Ia){const Db={};Db.Error=J;Db.Version=this.ea.se;Ia(Db)}}eKa(J,Ia){this.zf(J,
Ia)}cH(J,Ia){this.zf(Uf.a.UZe(J.Errors[0].MessageId),Ia)}kv(J){J&&J(this.KP())}KP(){const J={Error:0};J.Version=this.ea.se;return J}}Object(d.a)(di,"DdaErrorGenerator",null,[]);var Zg=a(249);class Ni{constructor(J,Ia,Db){this.$=J;this.$P=Ia;this.Uz=Db}kAd(J,Ia){const Db=J.DdaGoToByIdMethod.GoToType,cc=J.DdaGoToByIdMethod.SelectionMode,rc=J.DdaGoToByIdMethod.Id.toString().trim(),Tc=bd=>{const nd=this.$.va.getItemByName(bd.SheetName);(null===nd||void 0===nd?0:nd.visible)?(Ag.h(this.$).qg(bd,null,null,
null,3,"DdaNavigator.NavigateTo",void 0,void 0,void 0,void 0,!0),this.$P.kv(Ia)):this.$P.zf(Uf.a.W1g,Ia)};0===Db?this.BKi(rc,cc,J.DdaMethod.ControlId,Tc,Ia):1===Db?this.FKi(rc,cc,Tc,Ia):this.$P.zf(Uf.a.uZj,Ia)}BKi(J,Ia,Db,cc,rc){this.Uz.ddaGetBinding(Db,J,Tc=>{if(!Zg.a(Tc)&&Tc.Result&&Tc.Result.Reference){Tc=Tc.Result;var bd={};bd.SheetName=Tc.Reference.SheetName;bd.FirstRow=Tc.Reference.FirstRow;bd.FirstColumn=Tc.Reference.FirstColumn;bd.LastRow=Tc.Reference.LastRow;bd.LastColumn=Tc.Reference.LastColumn;
Ni.qYc(bd,Ia);1!==Tc.BindingType?cc(bd):this.Uz.ddaGetBindingData(Db,J,1,0,2,0,0,-1,-1,nd=>{Zg.a(nd)||!nd.Result?this.$P.cH(nd,rc):(nd=nd.Result,2!==Ia&&(bd.FirstRow-=nd.Headers.length,0>bd.FirstRow&&(bd.FirstRow=0)),cc(bd))},rc)}else this.$P.eKa(Uf.a.Uag,rc)},rc)}FKi(J,Ia,Db,cc){var rc=Dh.z(J);rc?(rc=Dh.v(rc,this.$),Ni.qYc(rc,Ia),Db(rc)):this.$.ea.isNamedObjectViewMode&&this.$.yb.Gk(J)?this.$.yb.na=this.$.yb.getItemByName(J):(rc=Tc=>{Zg.a(Tc)||!Tc.Result?this.$.va.contains(J)?(Tc={},Tc.SheetName=
J,Tc.FirstRow=0,Tc.FirstColumn=0,Tc.LastRow=0,Tc.LastColumn=0,Db(Tc)):this.$P.eKa(Uf.a.Uag,cc):(Tc=Tc.Result,Ni.qYc(Tc,Ia),Db(Tc))},this.$.va.na?this.Uz.parseRangeForGoto(J,this.$.va.na.name,rc,cc):this.Uz.parseRange(J,rc,cc))}static qYc(J,Ia){J.LastRow=2===Ia?J.FirstRow:J.LastRow;J.LastColumn=2===Ia?J.FirstColumn:J.LastColumn}}Object(d.a)(Ni,"DdaNavigator",null,[]);const gj=(J,Ia,Db,cc,rc,Tc)=>{const bd=J.Na(1);bd.request=Ia;return Bg.g(J,"ExecuteRichApiRequest",bd,Db,cc,rc,Tc,0)};var hj=a(296),
Vi;(function(J){J[J.unsupported=0]="unsupported";J[J.surface=1]="surface";J[J.combo=2]="combo";J[J.column=3]="column";J[J.column3D=4]="column3D";J[J.bar=5]="bar";J[J.bar3D=6]="bar3D";J[J.line=7]="line";J[J.line3D=8]="line3D";J[J.pie=9]="pie";J[J.pie3D=10]="pie3D";J[J.scatter=11]="scatter";J[J.bubble=12]="bubble";J[J.area=13]="area";J[J.area3D=14]="area3D";J[J.doughnut=15]="doughnut";J[J.radar=16]="radar";J[J.stock=17]="stock";J[J.waterfall=18]="waterfall";J[J.funnel=19]="funnel";J[J.treemap=20]="treemap";
J[J.sunburst=21]="sunburst";J[J.boxWhisker=22]="boxWhisker";J[J.histogram=23]="histogram";J[J.pareto=24]="pareto";J[J.regionMap=25]="regionMap";J[J.noVisibleSeries=26]="noVisibleSeries";J[J.complexDataSource=27]="complexDataSource";J[J.pivotChart=28]="pivotChart"})(Vi||(Vi={}));Object(d.b)("ChartCategory",Vi);class aj{constructor(J,Ia){this.source=J;this.eventId=Ia}}Object(d.a)(aj,"MacroRecorderEventData",null,[]);class sh{constructor(J,Ia,Db){this.parentName=J;this.$=Ia;this.request=Db}T1h(J){var Ia;
if(void 0===J||null===J||void 0===J.RequestBody||null===J.RequestBody)return null;const Db=JSON.parse(J.RequestBody);if(void 0!==J.ActiveChartId&&null!==J.ActiveChartId){Db.ActiveChartId=J.ActiveChartId;const cc=Ag.h(this.$).ha.Ra.dc;if(null===(Ia=null===cc||void 0===cc?void 0:cc.floatingObject)||void 0===Ia?0:Ia.Wc)Db.ActiveChartType=Vi[cc.floatingObject.Wc.ChartCategory]}void 0!==J.SheetMultiRange&&null!==J.SheetMultiRange&&(Db.SheetName=J.SheetMultiRange.SheetName);return Db}e2h(J){if(void 0===
J||null===J||void 0===J.Result||null===J.Result)return null;J=J.Result;return void 0===J.ResponseBody||null===J.ResponseBody||J.ResponseBody[0].startsWith('{"Error":')?null:JSON.parse(J.ResponseBody.join(""))}fti(J){return!!J&&!(void 0===J.eventId||null===J.eventId)&&0<J.eventId.length}Vj(J){return()=>{if(this.$.zba){const Ia=this.hZg(this.request);if(this.fti(Ia)){const Db=this.T1h(this.request),cc=this.e2h(J);if(Db&&!ci.a.isEmpty(Db)&&cc&&!ci.a.isEmpty(cc))return n.ULS.sendTraceTag(537163164,0,
50,"[RichApiRecorder]: Creating a MacroRecorderRichApiRequestExecutedPayload object."),new ba(Ia,Db,cc);n.ULS.sendTraceTag(537163163,0,50,`[RichApiRecorder]: Failed due to bad data: ${`requestInfo: ${Db?"(not null)":"(null)"}; responseInfo: ${cc?"(not null)":"(null)"}`}`)}}return new ba(null,null,null)}}hZg(J){const Ia=this.gti(J.SolutionId),Db=sh.z1h(J);if(Db&&Ia)return n.ULS.sendTraceTag(537163162,0,50,`[RichApiRecorder][${this.parentName}]: ${({["recorderEventId"]:Db,["request.SolutionId"]:J.SolutionId})}`),
new aj(J.SolutionId,Db);J=JSON.stringify({["recorderEventId"]:Db,["isRecorderAwareAddin"]:Ia,["request.SolutionId"]:J.SolutionId});n.ULS.sendTraceTag(537163161,0,50,`[RichApiRecorder][${this.parentName}]: ${J}`);return null}gti(J){if(!J)return!1;J=J.toLowerCase();return sh.z7h().contains(J)}static z7h(){sh.Jza||(sh.Jza=new m.a(L.a.Oi()),sh.Jza.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),sh.Jza.add("fa000000005"),sh.Jza.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),sh.Jza.add("fa000000014"),sh.Jza.add("c5daabb3-e185-4e8c-adfc-1a7b7283fb6f"));
return sh.Jza}static z1h(J){let Ia=null;var Db=RegExp('"Name":"EnableOfficeScriptRecording".*?Arguments":\\[.*?"(.*?)"',"mi");if(Db.test(J.RequestBody))Ia=Db.exec(J.RequestBody)[1];else{J=J.RequestHeaders;if(!J)return Ia;Db=Sc.a.hNi.toLowerCase();for(let cc=0;cc<J.length;cc++)if(J[cc].Name.toLowerCase()===Db){Ia=J[cc].Value;break}}return Ia}}sh.Jza=null;Object(d.a)(sh,"DdaRichApiRequestRecorder",null,[]);class ij extends hj.a{constructor(J,Ia,Db,cc,rc,Tc,bd,nd){super(10,0,Ia,nd);this.Nmb=Db;this.ejb=
cc;this.n3=rc;this.zFa=Tc;this.request=bd;this.POd=new sh("10",J,bd)}get OEc(){return this.zFa}get Kt(){return this.Nmb}get xaa(){return this.ejb}D2(J){return super.D2(J)||this.Q0g(J)}Vj(){return this.POd.Vj(this.od)}Dfb(){const J={OperationType:3};J.RichApiRequest=this.request;return J}Q0g(J){return(Ia,Db,cc)=>gj(J,this.request,Tf.b(Ia,this.Nmb),Tf.a(Db,this.ejb),cc,this.n3)}}Object(d.a)(ij,"DdaRichApiRequestBatchOperation",hj.a,[]);class jj extends Mh.a{constructor(J,Ia,Db,cc){super(576,0,Db,cc);
this.POd=new sh("576",J,Ia)}Vj(){return this.POd.Vj(this.od)}}Object(d.a)(jj,"DdaRichApiRequestOperation",Mh.a,[]);class kj{constructor(J,Ia){this.XH=(Db,cc)=>{this.$P.eKa(Uf.a.internalError,cc)};this.$=J;this.$P=Ia}ddaAddBinding(J,Ia,Db,cc,rc,Tc,bd){this.DJ((nd,Ed,Yd)=>{var Ie=this.$.oa.xa,Qe=this.wja();nd=Tf.b(nd,Tc);Ed=Tf.a(Ed,this.XH);const nf=Ie.Na(9);nf.controlId=J;nf.bindingId=Ia;nf.bindingType=Db;nf.currentSheetName=Qe;nf.formula=cc;nf.options=rc;return Bg.g(Ie,"DdaAddBinding",nf,nd,Ed,Yd,
bd,0)},bd,563)}ddaReleaseBinding(J,Ia,Db,cc){this.DJ((rc,Tc,bd)=>{var nd=this.$.oa.xa;rc=Tf.b(rc,Db);Tc=Tf.a(Tc,this.XH);const Ed=nd.Na(9);Ed.controlId=J;Ed.bindingId=Ia;return Bg.g(nd,"DdaReleaseBinding",Ed,rc,Tc,bd,cc,0)},cc,564)}ddaGetBinding(J,Ia,Db,cc){this.DJ((rc,Tc,bd)=>{var nd=this.$.oa.xa;rc=Tf.b(rc,Db);Tc=Tf.a(Tc,this.XH);const Ed=nd.Na(1);Ed.controlId=J;Ed.bindingId=Ia;return Bg.g(nd,"DdaGetBinding",Ed,rc,Tc,bd,cc,0)},cc,565,16)}ddaGetAllBindings(J,Ia,Db){this.DJ((cc,rc,Tc)=>{var bd=this.$.oa.xa;
cc=Tf.b(cc,Ia);rc=Tf.a(rc,this.XH);const nd=bd.Na(1);nd.controlId=J;return Bg.g(bd,"DdaGetAllBindings",nd,cc,rc,Tc,Db,0)},Db,566,16)}ddaGetBindingData(J,Ia,Db,cc,rc,Tc,bd,nd,Ed,Yd,Ie){this.DJ((Qe,nf,xg)=>{var jg=this.$.oa.xa,ag=this.wja();Qe=Tf.b(Qe,Yd);nf=Tf.a(nf,this.XH);const eg=jg.Na(1);eg.controlId=J;eg.bindingId=Ia;eg.coerceType=Db;eg.valueFormat=cc;eg.filterType=rc;eg.startRow=Tc;eg.startCol=bd;eg.rowCount=nd;eg.colCount=Ed;eg.currentSheetName=ag;return Bg.g(jg,"DdaGetBindingData",eg,Qe,nf,
xg,Ie,0)},Ie,567,16)}ddaSetBindingData(J,Ia,Db,cc,rc,Tc,bd){this.DJ((nd,Ed,Yd)=>{var Ie=this.$.oa.xa,Qe=this.wja();nd=Tf.b(nd,Tc);Ed=Tf.a(Ed,this.XH);const nf=Ie.Na(9);nf.controlId=J;nf.bindingId=Ia;nf.startRow=Db;nf.startCol=cc;nf.currentSheetName=Qe;nf.bindingData=rc;return Bg.g(Ie,"DdaSetBindingData",nf,nd,Ed,Yd,bd,0)},bd,568)}ddaGetSelectedData(J,Ia,Db,cc,rc,Tc,bd){this.DJ((nd,Ed,Yd)=>{var Ie=this.$.oa.xa,Qe=this.wja();nd=Tf.b(nd,Tc);Ed=Tf.a(Ed,this.XH);const nf=Ie.Na(1);nf.controlId=J;nf.coerceType=
Ia;nf.valueFormat=Db;nf.filterType=cc;nf.currentSheetName=Qe;nf.formula=rc;return Bg.g(Ie,"DdaGetSelectedData",nf,nd,Ed,Yd,bd,0)},bd,569,16)}ddaSetSelectedData(J,Ia,Db,cc,rc){this.DJ((Tc,bd,nd)=>{var Ed=this.$.oa.xa,Yd=this.wja();Tc=Tf.b(Tc,cc);bd=Tf.a(bd,this.XH);const Ie=Ed.Na(9);Ie.controlId=J;Ie.currentSheetName=Yd;Ie.formula=Ia;Ie.bindingData=Db;return Bg.g(Ed,"DdaSetSelectedData",Ie,Tc,bd,nd,rc,0)},rc,570)}ddaLoadSettings(J,Ia,Db){this.DJ((cc,rc,Tc)=>{var bd=this.$.oa.xa;cc=Tf.b(cc,Ia);rc=Tf.a(rc,
this.XH);const nd=bd.Na(1);nd.controlId=J;return Bg.g(bd,"DdaLoadSettings",nd,cc,rc,Tc,Db,0)},Db,501,16)}ddaSaveSettings(J,Ia,Db,cc,rc){this.DJ((Tc,bd,nd)=>{var Ed=this.$.oa.xa;Tc=Tf.b(Tc,cc);bd=Tf.a(bd,this.XH);const Yd=Ed.Na(9);Yd.controlId=J;Yd.settings=Ia;Yd.overwriteIfStale=Db;return Bg.g(Ed,"DdaSaveSettings",Yd,Tc,bd,nd,rc,0)},rc,571)}ddaAddRowsColumns(J,Ia,Db,cc,rc,Tc){this.DJ((bd,nd,Ed)=>{var Yd=this.$.oa.xa,Ie=this.wja();bd=Tf.b(bd,rc);nd=Tf.a(nd,this.XH);const Qe=Yd.Na(9);Qe.controlId=J;
Qe.bindingId=Ia;Qe.isRow=Db;Qe.currentSheetName=Ie;Qe.bindingData=cc;return Bg.g(Yd,"DdaAddRowsColumns",Qe,bd,nd,Ed,Tc,0)},Tc,572)}ddaDeleteAllDataValues(J,Ia,Db,cc){this.DJ((rc,Tc,bd)=>{var nd=this.$.oa.xa,Ed=this.wja();rc=Tf.b(rc,Db);Tc=Tf.a(Tc,this.XH);const Yd=nd.Na(9);Yd.controlId=J;Yd.bindingId=Ia;Yd.currentSheetName=Ed;return Bg.g(nd,"DdaDeleteAllDataValues",Yd,rc,Tc,bd,cc,0)},cc,573)}ddaClearBindingFormats(J,Ia,Db,cc){this.DJ((rc,Tc,bd)=>{var nd=this.$.oa.xa,Ed=this.wja();rc=Tf.b(rc,Db);Tc=
Tf.a(Tc,this.XH);const Yd=nd.Na(9);Yd.controlId=J;Yd.bindingId=Ia;Yd.currentSheetName=Ed;return Bg.g(nd,"DdaClearBindingFormats",Yd,rc,Tc,bd,cc,0)},cc,574)}ddaSetBindingFormats(J,Ia,Db,cc,rc,Tc){this.DJ((bd,nd,Ed)=>{var Yd=this.$.oa.xa,Ie=this.wja();bd=Tf.b(bd,rc);nd=Tf.a(nd,this.XH);const Qe=Yd.Na(9);Qe.controlId=J;Qe.bindingId=Ia;Qe.currentSheetName=Ie;Qe.bindingData=Db;Qe.isSetFormats=cc;return Bg.g(Yd,"DdaSetBindingFormats",Qe,bd,nd,Ed,Tc,0)},Tc,575)}parseRange(J,Ia,Db){this.DJ((cc,rc,Tc)=>{const bd=
this.$.oa.xa.Wb();return Bg.v(this.$.oa.xa,J,-1,Tf.b(cc,Ia),Tf.a(rc,this.XH),Tc,Db,bd)},Db,162,16)}parseRangeForGoto(J,Ia,Db,cc){this.DJ((rc,Tc,bd)=>{const nd=this.$.oa.xa.Wb();return Bg.w(this.$.oa.xa,J,Ia,Tf.b(rc,Db),Tf.a(Tc,this.XH),bd,cc,nd)},cc,562,16)}executeRichApiRequest(J,Ia,Db){C.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(J.RequestFlags&=8191);if(C.EwaSettings.ra(233))this.mEh(this.$.oa.xa.Wb(),Ia,()=>{this.$P.eKa(Uf.a.internalError,Db)},Db,J);
else{let cc=zg.DdaFacade.Qhd(J);!C.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.qb.uv||cc&16?(cc|=64,this.$.userOperationManager.KE(new jj(this.$,J,(rc,Tc,bd)=>gj(this.$.oa.xa,J,Tf.b(rc,Ia),Tf.a(Tc,this.XH),bd,Db),cc))):(this.$P.eKa(Uf.a.RFc,Db),n.ULS.sendTraceTag(537163160,0,50,"Write operation is not allowed"))}}wja(){return this.$.ea.isNamedObjectViewMode?this.$.na.sheetName:this.$.activeItemName}DJ(J,Ia,Db,cc=0){!C.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||
!this.$.qb.uv||cc&16?this.$.userOperationManager.KE(new Mh.a(Db,0,J,cc|64)):(this.$P.eKa(Uf.a.RFc,Ia),n.ULS.sendTraceTag(537163159,0,50,"Write operation is not allowed"))}mEh(J,Ia,Db,cc,rc){let Tc=zg.DdaFacade.Qhd(rc);if(!C.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.qb.uv||Tc&16){var bd=this.$.Jb.Gc("UserAction","Rich Api request");this.$.userOperationManager.Jc(new ij(this.$,J,Ia,Db,cc,bd,rc,Tc|64),null)}else this.$P.eKa(Uf.a.RFc,cc),n.ULS.sendTraceTag(537163158,
0,50,"Write operation is not allowed")}}Object(d.a)(kj,"DdaWebServiceHelper",null,[]);class bj{constructor(J,Ia,Db,cc){this.UFh=J;this.fileSize=Ia;this.GLj=cc}}Object(d.a)(bj,"DocumentFile",null,[]);class yh{}yh.generalException="GeneralException";yh.zRg="ApiNotFound";yh.eFd="OperationCancelled";yh.invalidArgument="InvalidArgument";Object(d.a)(yh,"ErrorCodes",null,[]);class cj{replaceShortcuts(){return Promise.reject("ReplaceShortcuts method is not overridden")}getShortcuts(){return Promise.reject("GetShortcuts method is not overridden")}checkShortcutsInUse(){return Promise.reject("CheckShortcutsInUse method is not overridden")}}
Object(d.a)(cj,"WacApiDelegates",null,[]);var yj=a(620);class Wi extends cj{constructor(J,Ia){super();this.ymf=(Db,cc)=>{Db=Wi.G$g(Db,cc);if(!yj.a(this.$,Db))return!0;Db=this.$.shortcutKeyManager.G7e(Db);return!!Db&&0<Db.length};this.addinId=J;this.$=Ia}replaceShortcuts(J){return OfficeExt.ShortcutKeyDispatchManager.replaceShortcuts(this.addinId,J,this.ymf)}getShortcuts(){return OfficeExt.ShortcutKeyDispatchManager.getShortcuts(this.addinId)}checkShortcutsInUse(J){return OfficeExt.ShortcutKeyDispatchManager.checkShortcutsInUse(J,
this.ymf)}static meh(J,Ia){const Db=document.createEvent("KeyboardEvent");if(Xe.a.iF)Db.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,!!(J&8),!!(J&32),!!(J&4),!!(J&256));else{const cc=[];J&4&&cc.push("Shift");J&8&&cc.push("Control");J&32&&cc.push("Alt");Db.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,cc.join(" "),!1,"en-US")}J=new Sys.UI.DomEvent(Db);J.keyCode=Ia;return J}static G$g(J,Ia){if(Xe.a.Cf)switch(Ia){case 189:Ia=173;break;case 187:Ia=61;break;case 186:Ia=59}return Wi.meh(J,
Ia)}}Object(d.a)(Wi,"ExcelWacApiDelegates",cj,[]);class zh{constructor(J){this.SIa={};this.wHi=J}VIg(J,Ia){this.Iec(J)||(this.SIa[J]={});if(this.goi(J))return n.ULS.sendTraceTag(537163157,344,50,`App ${J} has reach the limit of number of cached files.`),Uf.a.fIi;this.SIa[J][Ia.UFh.toString()]=Ia;return Uf.a.success}XTh(J,Ia){let Db=null;this.Iec(J)&&(Db=this.SIa[J][Ia.toString()]);Db||n.ULS.sendTraceTag(537163156,344,15,`File cache for [agave:${J}, fileHandler:${Ia}] doesn't exist`);return Db}Iec(J){return J in
this.SIa}uhj(J,Ia){if(this.Iec(J)){const Db=this.SIa[J];delete Db[Ia.toString()];1>Object.keys(Db).length&&delete this.SIa[J];return Ia.toString()in Db?Uf.a.internalError:Uf.a.success}return Uf.a.internalError}goi(J){return this.Iec(J)?Object.keys(this.SIa[J]).length>=this.wHi:!1}static getInstance(J){return J.da.Aa(200)||J.da.Ha(200,new zh(zh.xHi))}static mLi(){return++zh.d0g}}zh.YGi=4194304;zh.xHi=1;zh.d0g=0;Object(d.a)(zh,"GetFileApiHelper",null,[]);class lj{constructor(J){this.fA=J}notifyActionHandlerReady(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.fA)}getTypeName(){return"Microsoft.InternalService.AddinInternalService"}invokePropertyGet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,Ia){this.invokePropertySet(J,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){switch(J){case 1:return this.SLi()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,Ia){J=this.invokeMethod(J,
Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}SLi(){this.notifyActionHandlerReady();return null}}Object(d.a)(lj,"AddinInternalService",null,[]);class mj{constructor(J,Ia){this.EI=Ia;this.fA=J}getAppRuntimeState(){return this.EI.getAppRuntimeState(this.fA)?2:1}setAppRuntimeState(J){switch(J){case 2:J=!0;break;case 1:J=!1;break;default:throw OfficeExtension.WacRuntime.Utility.createRichApiException($e.a.invalidArgument,$f.a.ga(1768));}this.EI.setAppRuntimeState(this.fA,J)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimeService"}invokePropertyGet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,Ia){this.invokePropertySet(J,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J,Ia){switch(J){case 2:return this.ZOh();case 1:return this.kxj(Ia)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,
Ia){J=this.invokeMethod(J,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}ZOh(){return this.getAppRuntimeState()}kxj(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"int");this.setAppRuntimeState(J);return null}}Object(d.a)(mj,"AppRuntimeService",null,[]);var dj=a(988);class nj{constructor(J,Ia,Db,cc){this.ix=J;this.m1=Db;this.Gy=cc.Ng.getOsfControl(Ia)}disable(){try{if(!$f.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.hHe();
if(!this.Wlf())return this.iHe();this.m1.yYj(this.ix)}catch(J){return n.ULS.sendTraceTag(538572829,0,15,"BeforeDocumentCloseNotification.Disable() Failed. reason: {0}",J.message||"Unknown"),this.fHe()}return null}enable(){try{if(!$f.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.hHe();if(!this.Wlf())return this.iHe();this.m1.qfj(this.ix)}catch(J){return n.ULS.sendTraceTag(538572828,0,15,"BeforeDocumentCloseNotification.Enable() Failed. reason: {0}",
J.message||"Unknown"),this.fHe()}return null}_OnAccess(){}getTypeName(){return"Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification"}invokePropertyGet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,Ia){this.invokePropertySet(J,
Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){switch(J){case 1:return this.CCa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,Ia){switch(J){case 3:return this.jnh();case 2:return this.$rh()}J=this.invokeMethod(J,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}jnh(){return this.disable()}$rh(){return this.enable()}CCa(){this._OnAccess();return null}hHe(){return dj.a($e.a.notImplemented,
$f.a.ga(1769))}iHe(){return dj.a($e.a.sharedRuntimeNotAvailable,$f.a.ga(1773))}fHe(){return dj.a($e.a.generalException,$f.a.ga(1764))}Wlf(){const J=this.Gy.getSharedRuntimeId();return!!J&&0<J.length}}Object(d.a)(nj,"BeforeDocumentCloseNotification",null,[]);class oj{constructor(){this.Nke=this.Vee=this.cA=!1}get enabled(){return this.cA}set enabled(J){this.cA=J}get nativeRuntime(){return this.Vee}set nativeRuntime(J){this.Vee=J}get streamingEnabled(){return this.Nke}set streamingEnabled(J){this.Nke=
J}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionEngineStatus"}invokePropertyGet(J){switch(J){case 1:return this.enabled;case 3:return this.nativeRuntime;case 2:return this.streamingEnabled}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J,Ia){switch(J){case 1:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,
0,"boolean");return;case 3:this.nativeRuntime=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,0,"boolean");return;case 2:this.streamingEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ia,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,Ia){this.invokePropertySet(J,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokeMethodAsync(J,Ia){J=this.invokeMethod(J,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}}Object(d.a)(oj,"CustomFunctionEngineStatus",null,[]);class pj{constructor(J,Ia,Db){this.Hyg=J;this.Iyg=Ia;this.CCg=Db}get status(){const J=new oj;J.enabled=this.Hyg;J.streamingEnabled=this.Iyg;J.nativeRuntime=!1;return J}register(J){return OfficeExtension.WacRuntime.Utility.createPromise(this.CCg(J))}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionManager"}invokePropertyGet(J){switch(J){case 2:return this.status}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,Ia){this.invokePropertySet(J,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,Ia){switch(J){case 1:return this.igj(Ia)}J=this.invokeMethod(J,
Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}igj(J){const Ia=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,1,"string");return this.register(Ia,J)}}Object(d.a)(pj,"CustomFunctionManager",null,[]);var zj=a(962);class qj{constructor(J,Ia,Db,cc){this.Q5d="";this.LTb=0;this.MO=J;this._id=Ia;this.fA=Db;this.EI=cc}get id(){return this._id}_RegisterStateChange(){this.LTb||this.MO.execute(J=>
{this.Q5d=J.Oza(this._id,Ia=>{this.EI.ZHh(this.fA,this._id,JSON.stringify(Ia))})});this.LTb++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}_UnregisterStateChange(){this.LTb--;this.LTb||this.MO.execute(J=>{J.mLd(this._id,this.Q5d)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.Licensing.LicenseFeature"}invokePropertyGet(J){switch(J){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,Ia){this.invokePropertySet(J,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,Ia){switch(J){case 6:return this.gsg();case 7:return this.isg()}J=
this.invokeMethod(J,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}gsg(){return this._RegisterStateChange()}isg(){return this._UnregisterStateChange()}}Object(d.a)(qj,"LicenseFeature",null,[]);class rj{constructor(J,Ia){this.MO=pc.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.fA=J;this.EI=Ia;this.uBg=this.EI.Ng.getOsfControl(this.fA)}getFeatureTier(J,Ia){return OfficeExtension.WacRuntime.Utility.createPromise(Db=>{const cc=1===Ia?1:2===
Ia?2:0;this.MO.execute(rc=>{rc.getFeatureTier(J,cc).then(Tc=>{Db(this.lYh(Tc))},()=>{Db(Ia)})})})}getLicenseFeature(J){J=new qj(this.MO,J,this.fA,this.EI);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}isFeatureEnabled(J,Ia){return OfficeExtension.WacRuntime.Utility.createPromise(Db=>{this.MO.execute(cc=>{cc.isFeatureEnabled(J,Ia).then(rc=>{Db(rc)},()=>{Db(Ia)})})})}isFreemiumUpsellEnabled(){return OfficeExtension.WacRuntime.Utility.createPromise(J=>{this.MO.execute(Ia=>{Ia=
Ia.isFreemiumUpsellEnabled();J(Ia)})})}launchUpsellExperience(J){if(this.uBg.isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(()=>{this.MO.execute(Ia=>{Ia.launchUpsellExperience(J)})});throw OfficeExtension.WacRuntime.Utility.createRichApiException($e.a.DVc,"");}_TestFireStateChangedEvent(){}getTypeName(){return"Microsoft.Office.Licensing.License"}invokePropertyGet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,Ia){this.invokePropertySet(J,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J,Ia){switch(J){case 6:return this.hsg(Ia)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,Ia){switch(J){case 2:return this.RUh(Ia);case 5:return this.kYh(Ia);
case 1:return this.Toi(Ia);case 3:return this.Dpi();case 4:return this.xzi(Ia)}J=this.invokeMethod(J,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}RUh(J){const Ia=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,1,"int");return this.getFeatureTier(Ia,J)}kYh(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");return this.getLicenseFeature(J)}Toi(J){const Ia=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,
0,"string");J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,1,"boolean");return this.isFeatureEnabled(Ia,J)}Dpi(){return this.isFreemiumUpsellEnabled()}xzi(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");return this.launchUpsellExperience(J)}hsg(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");this._TestFireStateChangedEvent(J);return null}lYh(J){switch(J){case 1:return 1;case 2:return 2;default:return 0}}}Object(d.a)(rj,"License",
null,[]);var Aj=a(158);const Bj=(J,Ia,Db)=>cc=>(rc,Tc)=>{Cf.TaskExtensions.za(tg.GetServiceTaskFactory.create(Ia.da,279,Ia.la,1),bd=>{bd=bd.result;let nd=!1;var Ed=Db.Ng.getOsfControl(J);let Yd=null;Ed&&(Yd=Ed.getStoreType(),(Ed=Ed.getManifest())&&Ed.getSharedRuntimeForCustomFunctions("Workbook")&&(nd=!0));Cf.TaskExtensions.za(bd.yff(J,Yd,cc,nd),Ie=>{Aj.b(Ie)?Ie.result?rc(null):Tc(OfficeExtension.WacRuntime.Utility.createRichApiException($e.a.invalidArgument,Tb.a.instance.ga(1768))):Tc(OfficeExtension.WacRuntime.Utility.createRichApiException($e.a.generalException,
Tb.a.instance.ga(1764)))},Ia.la,3)},Ia.la,3)};class sj{constructor(J){if(!J)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.qyd=J}areShortcutsInUse(J){return OfficeExtension.WacRuntime.Utility.createPromise((Ia,Db)=>{this.qyd.checkShortcutsInUse(J).then(cc=>{Ia(cc)}).catch(cc=>{Db(cc)})})}getShortcuts(){return OfficeExtension.WacRuntime.Utility.createPromise((J,Ia)=>{this.qyd.getShortcuts().then(Db=>{J(Db)}).catch(Db=>{Ia(Db)})})}replaceShortcuts(J){return OfficeExtension.WacRuntime.Utility.createPromise((Ia,
Db)=>{this.qyd.replaceShortcuts(J).then(()=>{Ia(null)}).catch(cc=>{Db(cc)})})}getTypeName(){return"Microsoft.Office.ActionService"}invokePropertyGet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,Ia){this.invokePropertySet(J,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokeMethodAsync(J,Ia){switch(J){case 3:return this.mTg(Ia);case 1:return this.G3h();case 2:return this.Omj(Ia)}J=this.invokeMethod(J,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}mTg(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"Array<string>");return this.areShortcutsInUse(J)}G3h(){return this.getShortcuts()}Omj(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"any");return this.replaceShortcuts(J)}}Object(d.a)(sj,"ActionService",
null,[]);var Cj=a(519);class tj{constructor(){this.ura=null}t3h(){this.ura||(this.ura=Cj.a.Rq(pc.a.instance.Tb("Common.App.SharedFilePicker.ISharedFilePicker")));return this.ura}getSharedFilePickerResponse(J){return OfficeExtension.WacRuntime.Utility.createPromise((Ia,Db)=>{try{const cc=this.t3h();Wg.Task.WAA.call(null,cc).continueWith(()=>{const rc=cc.result;if(rc){let Tc={};({ht:Tc}=Yf.d(J)).returnValue?rc.zgd(Tc).then(bd=>{bd&&0<bd.length?Ia(bd):Db(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",
"The picker returned null or an empty array."))}).catch(bd=>{Db(bd)}):Db(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else Db(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker is resolved as null."))})}catch(cc){Db(cc)}})}getTypeName(){return"Microsoft.Office.SharedFilePicker"}invokePropertyGet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,Ia){this.invokePropertySet(J,Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,Ia){switch(J){case 1:return this.s3h(Ia)}J=this.invokeMethod(J,
Ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}s3h(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");return this.getSharedFilePickerResponse(J)}}Object(d.a)(tj,"SharedFilePicker",null,[]);class uj{createInstance(J,Ia){switch(J){case "Microsoft.Office.ActionService":return new sj(Ia);case "Microsoft.Office.SharedFilePicker":return new tj}return null}}Object(d.a)(uj,"WacApiHost",null,[]);class vj{constructor(J,Ia,Db,cc,rc){this.iVc=null;this.TRb=
J;this.fA=Ia;this.EI=Db;this.jb=cc;this.GGg=rc}hostName(){return"ExcelOnline"}appId(){return this.TRb}createInstance(J){switch(J){case "Microsoft.Authentication.AuthenticationService":return pc.a.instance.resolve("Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").create(this.fA,this.EI.Ng);case "Microsoft.Authentication.TokenParameters":return new gg;case "Microsoft.ExcelServices.CustomFunctionManager":J=this.jb.ra(114);var Ia=this.jb.ra(115);return new pj(J,Ia,Bj(this.TRb,
this.jb,this.EI));case "Microsoft.AppRuntime.AppRuntimeService":return new mj(this.fA,this.EI);case "Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification":return J=jh.a(this.jb),new nj(this.TRb,this.fA,J,this.EI);case "Microsoft.DynamicRibbon.DynamicRibbon":return J=jh.a(this.jb),new zj.DynamicRibbon(this.TRb,this.fA,this.EI,J,J.pn(this.fA).sl);case "Microsoft.Office.Licensing.License":return new rj(this.fA,this.EI);case "Microsoft.InternalService.AddinInternalService":return new lj(this.fA);
default:if(this.iVc||(this.iVc=new uj),Ia=this.iVc.createInstance(J,this.GGg))return Ia}n.ULS.sendTraceTag(537163155,0,10,`Typename: ${J} is an invalid parameter for the RichApiHost.CreateInstance method.`);throw OfficeExtension.WacRuntime.Utility.createRichApiException($e.a.generalException,$e.a.generalException);}}Object(d.a)(vj,"RichApiHost",null,[]);var Dj=a(387),wj=a(28),Ej=a(120),ej=a(35),Fj=a(101),Gj=a(286),Hj=a(45),Ij=a(253),Jj=a(6),Kj=a(73);class yf{constructor(J,Ia,Db,cc){this.htmlSanitizationHelper=
this.rangePicker=null;this.$=J;this.Jd=Ia;this.htmlSanitizationHelper=cc;this.Ce=new di(J.ea);this.Uz=new kj(J,this.Ce);this.sxf=Db;this.I$b=new Map}get $P(){return this.Ce}dispose(){this.$=this.I$b=null}Hc(){return!1}Nc(){return!1}executeCommand(J,Ia,Db){J=Ia.command;switch(J){case 451041795:this.Ce.zf(Db[fg.a.Pf],Db[fg.a.n3]);break;case 974713501:this.i$h(Db[fg.a.Pf],Db[fg.a.n3]);break;case 1237877382:this.Ce.kv(Db[fg.a.n3]);break;default:return Zh.a(J)}return Wg.Task.Sa(!0)}wc(J,Ia,Db){if(J=!!Db)switch(Ia.command){case 974713501:case 1237877382:case 451041795:break;
default:J=!1}return J}i$h(J,Ia){var Db;const cc=J.DdaMethod;"undefined"===typeof cc.DispatchId?this.Ce.zf(Uf.a.internalError,Ia):yf.Xni(J)||this.$.qd&1?(cc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromPromptMethod?(new Gh(this.$,this,J,Ia,this.htmlSanitizationHelper)).start(this.Jd,J.DdaMethod.ControlId):cc.DispatchId===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod?this.T2h(J,Ia):cc.DispatchId===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod?this.LBj(J,Ia):cc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod?
this.addBinding(J,this.Tfd(J.DdaMethod.ControlId),0,Ia):cc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingDataMethod?this.EPh(J,Ia):cc.DispatchId===OSF.DDA.MethodDispId.dispidSetBindingDataMethod?this.vxj(J,Ia):cc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingMethod?this.DPh(J,Ia):cc.DispatchId===OSF.DDA.MethodDispId.dispidReleaseBindingMethod?this.thj(J,Ia):cc.DispatchId===OSF.DDA.MethodDispId.dispidGetAllBindingsMethod?this.DOh(J,Ia):cc.DispatchId===OSF.DDA.MethodDispId.dispidLoadSettingsMethod?
this.nwd(J,Ia):cc.DispatchId===OSF.DDA.MethodDispId.dispidSaveSettingsMethod?this.saveSettings(J,Ia):cc.DispatchId===OSF.DDA.MethodDispId.dispidAddRowsMethod?(J.DdaAddRowsColumns.IsRow=!0,this.Bpe(J,Ia)):cc.DispatchId===OSF.DDA.MethodDispId.dispidAddColumnsMethod?(J.DdaAddRowsColumns.IsRow=!1,this.Bpe(J,Ia)):cc.DispatchId===OSF.DDA.MethodDispId.dispidClearAllRowsMethod?this.Xkh(J,Ia):cc.DispatchId===OSF.DDA.MethodDispId.dispidClearFormatsMethod?this.N4g(J,Ia):cc.DispatchId===OSF.DDA.MethodDispId.dispidSetFormatsMethod?
(J.DdaSetBindingFormats.IsSetFormats=!0,this.V3f(J,Ia)):cc.DispatchId===OSF.DDA.MethodDispId.dispidSetTableOptionsMethod?(J.DdaSetBindingFormats.IsSetFormats=!1,this.V3f(J,Ia)):cc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod?this.addBinding(J,J.DdaBindingsMethod.ItemName,J.DdaBindingsMethod.FailOnCollision?2:1,Ia):cc.DispatchId===OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod?this.VUh(Ia):cc.DispatchId===OSF.DDA.MethodDispId.dispidNavigateToMethod?this.kAd(J,Ia):cc.DispatchId===
OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod?this.executeRichApiRequest(J,Ia):cc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod?this.UTh(J,Ia):cc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod?this.VTh(J,Ia):cc.DispatchId===OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod?this.vhj(J,Ia):cc.DispatchId===OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod?(OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(J.DdaMethod.ControlId,J),this.Ce.kv(Ia)):
cc.DispatchId===OSF.DDA.MethodDispId.dispidMessageParentMethod?C.EwaSettings.ra(23)?this.Ce.zf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ia):this.CIi(J,Ia):cc.DispatchId===OSF.DDA.MethodDispId.dispidSendMessageMethod?C.EwaSettings.ra(23)?this.Ce.zf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ia):this.yIi(J,Ia):cc.DispatchId===OSF.DDA.MethodDispId.dispidGetAccessTokenMethod?this.getAccessToken(J,Ia):cc.DispatchId===OSF.DDA.MethodDispId.dispidGetAuthContextMethod?
this.getAuthContext(J,Ia):this.Ce.zf(Uf.a.iFd,Ia),C.EwaSettings.isChangeGateEnabled("OfficeVSO:5649666_AddLogForExcelOnlineCommonAPIUsage")&&cc.DispatchId!==OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(J=this.Jd.gZ(J.DdaMethod.ControlId),Ia="",J&&(Ia=zg.DdaFacade.getSolutionId(J,this.$),Ia=Telemetry.PrivacyRules.GetPrivacyCompliantId(Ia,J.OwnerAddinStoreType||J.PrimaryMarketplace.MarketplaceType,null===(Db=J.AssetMarketplace)||void 0===Db?void 0:Db.SolutionId,null,null,J.PrimaryMarketplace.MarketplaceRef)),
n.ULS.sendTraceTag(537163224,344,50,`DDA method Id: ${cc.DispatchId}, AppID: ${Ia}`))):this.Ce.zf(Uf.a.qNe,Ia)}EPh(J,Ia){J.DdaGetBindingData.CoerceType=yf.r4b(J.DdaGetBindingData.CoerceType);J.DdaGetBindingData.FilterType=yf.FXe(J.DdaGetBindingData.FilterType);J.DdaGetBindingData.ValueFormat=yf.tmg(J.DdaGetBindingData.ValueFormat);if(this.ikc(J.DdaGetBindingData.CoerceType,Ia)){if(J.DdaGetBindingData){const Db=J.DdaGetBindingData;0===Db.FilterType&&(Db.FilterType=2);Db.StartCol|=0;Db.StartRow|=0;
Db.ColCount=void 0===Db.ColCount?-1:Db.ColCount;Db.RowCount=void 0===Db.RowCount?-1:Db.RowCount}this.Uz.ddaGetBindingData(J.DdaMethod.ControlId,J.DdaGetBindingData.BindingId,J.DdaGetBindingData.CoerceType,J.DdaGetBindingData.ValueFormat,J.DdaGetBindingData.FilterType,J.DdaGetBindingData.StartRow,J.DdaGetBindingData.StartCol,J.DdaGetBindingData.RowCount,J.DdaGetBindingData.ColCount,Db=>{if(Zg.a(Db)||!Db.Result)this.Ce.cH(Db,Ia);else{const cc=this.Ce.KP();cc.Data=yf.oye(Db.Result);Ia(cc)}},Ia)}}vxj(J,
Ia){J.DdaSetBindingData.CoerceType=yf.r4b(J.DdaSetBindingData.CoerceType);if(this.ikc(J.DdaSetBindingData.CoerceType,Ia)){var Db=yf.c0c(J.DdaSetBindingData.CoerceType,J.DdaSetBindingData.Data);yf.chc(Db)?this.Ce.zf(Uf.a.ADc,Ia):(1===Db.CoerceType&&(Db.CellFormat||(Db.CellFormat=J.DdaSetBindingData.CellFormat),Db.TableOptions||(Db.TableOptions=J.DdaSetBindingData.TableOptions)),J.DdaSetBindingData&&(J.DdaSetBindingData.StartCol|=0,J.DdaSetBindingData.StartRow|=0),this.Uz.ddaSetBindingData(J.DdaMethod.ControlId,
J.DdaSetBindingData.BindingId,J.DdaSetBindingData.StartRow,J.DdaSetBindingData.StartCol,Db,cc=>{Zg.a(cc)?this.Ce.cH(cc,Ia):this.Ce.kv(Ia)},Ia))}}T2h(J,Ia){J.DdaGetBindingData.CoerceType=yf.r4b(J.DdaGetBindingData.CoerceType);J.DdaGetBindingData.ValueFormat=yf.tmg(J.DdaGetBindingData.ValueFormat);J.DdaGetBindingData.FilterType=yf.FXe(J.DdaGetBindingData.FilterType);if(this.ikc(J.DdaGetBindingData.CoerceType,Ia)){var Db=this.Tfd(J.DdaMethod.ControlId);Db?this.Uz.ddaGetSelectedData(J.DdaMethod.ControlId,
J.DdaGetBindingData.CoerceType,J.DdaGetBindingData.ValueFormat,J.DdaGetBindingData.FilterType,Db,cc=>{if(Zg.a(cc))this.Ce.cH(cc,Ia);else{const rc=this.Ce.KP();rc.Data=yf.oye(cc.Result);Ia(rc)}},Ia):this.Ce.zf(Uf.a.o7e,Ia)}}UTh(J,Ia){const Db=J[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()],cc=J[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()],rc=J.DdaMethod.ControlId,Tc=zh.getInstance(this.$);if(0>=cc)n.ULS.sendTraceTag(537163221,344,15,"Invalid slice size. It should be greater than 0."),
this.Ce.zf(Uf.a.xki,Ia);else if(cc>zh.YGi)n.ULS.sendTraceTag(537163220,344,15,"Invalid slice size. It should be not greater than 4MB."),this.Ce.zf(Uf.a.g2e,Ia);else{var bd=null;switch(Db){case 1:bd="Compressed";break;case 0:bd="Text";break;case 2:bd="Pdf";break;default:n.ULS.sendTraceTag(537163219,344,15,`Requested file type ${Db} is not supported.`);this.Ce.zf(Uf.a.sXe,Ia);return}if("Text"===bd)n.ULS.sendTraceTag(537163218,344,15,`Requested file type ${bd} is not supported.`),this.Ce.zf(Uf.a.sXe,
Ia);else{C.EwaSettings.isChangeGateEnabled("OfficeVSO:4182305_AddWholeWorkbookPrintOptionToGetFileAPI")?(J=new Sys.StringBuilder,J.append(Yg.a(this.$,bd)),"Pdf"===bd&&hg.a.Mk(J,Sc.a.kQf,"WholeWorkbook"),J=J.toString()):J=Yg.a(this.$,bd);var nd=null,Ed=new XMLHttpRequest;Ed.onreadystatechange=()=>{if(4===Ed.readyState)if(200===Ed.status){var Yd=Ed.response;if(Yd){nd=new Uint8Array(Yd);Yd=this.Ce.KP();var Ie=nd.length,Qe=zh.mLi(),nf={},xg=0;for(let jg=0;jg<Ie;jg+=cc){const ag=[],eg=jg+cc<Ie?jg+cc:Ie;
for(let pg=0,Og=jg;Og<eg;pg++,Og++)ag[pg]=nd[Og];nf[(xg++).toString()]=ag}nf=new bj(Qe,Ie,cc,nf);nf=Tc.VIg(rc,nf);nf!==Uf.a.success?this.Ce.zf(nf,Ia):(Yd[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=Qe,Yd[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=Ie,n.ULS.sendTraceTag(537163216,344,50,`GetFileAsync get file successfully for file type ${bd}, the file size is ${Ie}`),Ia(Yd))}else n.ULS.sendTraceTag(537163217,344,15,`Request is successful, but respone have no data for file type ${bd}.`),
this.Ce.zf(Uf.a.internalError,Ia)}else 500===Ed.status?this.Ce.zf(Uf.a.UZe(parseInt(Ed.statusText,10)),Ia):(n.ULS.sendTraceTag(537163215,344,15,`Request failed to obtain the file for type ${bd}.`),this.Ce.zf(Uf.a.UKi,Ia))};Ed.open("GET",J,!0);Ed.responseType="arraybuffer";Ed.setRequestHeader("If-Modified-Since","0");Ed.send(null)}}}VTh(J,Ia){var Db=J[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],cc=J[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];J=J.DdaMethod.ControlId;(Db=
zh.getInstance(this.$).XTh(J,Db))?(Db=Db.GLj,0>cc||cc>=Object.keys(Db).length?this.Ce.zf(Uf.a.gfi,Ia):(cc=Db[cc.toString()],Db=this.Ce.KP(),Db[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=cc,Db[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=cc.length,Ia(Db))):this.Ce.zf(Uf.a.internalError,Ia)}vhj(J,Ia){var Db=J[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];J=J.DdaMethod.ControlId;Db=zh.getInstance(this.$).uhj(J,Db);Db===Uf.a.success?this.Ce.kv(Ia):this.Ce.zf(Db,
Ia)}LBj(J,Ia){J.DdaSetBindingData.CoerceType=yf.r4b(J.DdaSetBindingData.CoerceType);if(this.ikc(J.DdaSetBindingData.CoerceType,Ia)){var Db=this.Tfd(J.DdaMethod.ControlId);if(Db){var cc=yf.c0c(J.DdaSetBindingData.CoerceType,J.DdaSetBindingData.Data),rc=Ag.h(this.$).ha;1===cc.CoerceType&&(!cc.Data&&rc.qa.h5&&(cc.Headers||(cc.Headers=[]),cc.Headers.length||cc.Headers.push([]),cc.Headers[0].length||cc.Headers[0].push("")),yf.chc(cc)||(cc.CellFormat||(cc.CellFormat=J.DdaSetBindingData.CellFormat),cc.TableOptions||
(cc.TableOptions=J.DdaSetBindingData.TableOptions)));if(yf.chc(cc))this.Ce.zf(Uf.a.ADc,Ia);else{var Tc=rc.qa.ld.clone(),bd=rc.qa.activeCell.clone();this.Uz.ddaSetSelectedData(J.DdaMethod.ControlId,Db,cc,nd=>{var Ed;if(Zg.a(nd))this.Ce.cH(nd,Ia);else{nd=Tc.clone();const Yd=cc.Headers?cc.Headers[0].length:cc.Data[0].length;1!==cc.CoerceType||cc.Data?1===cc.CoerceType&&(null===(Ed=cc.TableOptions)||void 0===Ed?0:Ed.length)&&0==cc.TableOptions[0]?(nd.top+=1,nd.bottom=nd.top+cc.Data.length-1):nd.bottom=
nd.top+cc.Data.length-(1===cc.CoerceType?0:1):nd.bottom=nd.top+1;nd.right=nd.left+Yd-1;Ed=nd.contains(bd)?bd:nd.topLeft;rc.updateSelection(nd,Ed,0);this.Ce.kv(Ia)}},Ia)}}else this.Ce.zf(Uf.a.PAe,Ia)}}addBinding(J,Ia,Db,cc){Ia?this.Uz.ddaAddBinding(J.DdaMethod.ControlId,J.DdaBindingsMethod.BindingId,J.DdaBindingsMethod.BindingType,Ia,Db,rc=>{if(Zg.a(rc))this.Ce.cH(rc,cc);else{const Tc=this.Ce.KP();Tc.Bindings=Array(1);Tc.Bindings[0]=this.Jd.X1b(rc.Result);cc(Tc)}},cc):this.Ce.zf(Uf.a.Ruj,cc)}DPh(J,
Ia){this.Uz.ddaGetBinding(J.DdaMethod.ControlId,J.DdaBindingsMethod.BindingId,Db=>{if(Zg.a(Db)||!Db.Result)this.Ce.cH(Db,Ia);else{const cc=this.Ce.KP();cc.Bindings=Array(1);cc.Bindings[0]=this.Jd.X1b(Db.Result);Ia(cc)}},Ia)}VUh(J){const Ia=this.Ce.KP(),Db={};Db[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=this.$.workbookContext.ClientUrl;Ia[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=Db;J(Ia)}thj(J,Ia){this.Uz.ddaReleaseBinding(J.DdaMethod.ControlId,J.DdaBindingsMethod.BindingId,
Db=>{Zg.a(Db)?this.Ce.cH(Db,Ia):this.Ce.kv(Ia)},Ia)}DOh(J,Ia){this.Uz.ddaGetAllBindings(J.DdaMethod.ControlId,Db=>{if(Zg.a(Db))this.Ce.cH(Db,Ia);else{const cc=this.Ce.KP();if(Db.Result){Db=Db.Result;cc.Bindings=Array(Db.length);for(let rc=0;rc<Db.length;rc++)cc.Bindings[rc]=this.Jd.X1b(Db[rc])}else cc.Bindings=null;Ia(cc)}},Ia)}nwd(J,Ia){this.Uz.ddaLoadSettings(J.DdaMethod.ControlId,Db=>{if(Zg.a(Db))this.Ce.cH(Db,Ia);else{const cc=this.Ce.KP();cc.Properties=Db.Result;Ia(cc)}},Ia)}saveSettings(J,Ia){const Db=
{Settings:[]};for(let cc=0;cc<J.DdaSettingsMethod.Properties.length;cc++){const rc={};rc.Name=J.DdaSettingsMethod.Properties[cc][0];rc.Value=J.DdaSettingsMethod.Properties[cc][1];Db.Settings[cc]=rc}this.Uz.ddaSaveSettings(J.DdaMethod.ControlId,Db,J.DdaSettingsMethod.OverwriteIfStale,cc=>{Zg.a(cc)?this.Ce.cH(cc,Ia):this.Ce.kv(Ia)},Ia)}Bpe(J,Ia){const Db=yf.c0c(1,J.DdaAddRowsColumns.Data);yf.chc(Db)?this.Ce.zf(Uf.a.ADc,Ia):this.Uz.ddaAddRowsColumns(J.DdaMethod.ControlId,J.DdaAddRowsColumns.BindingId,
J.DdaAddRowsColumns.IsRow,Db,cc=>{Zg.a(cc)?this.Ce.cH(cc,Ia):this.Ce.kv(Ia)},Ia)}Xkh(J,Ia){this.Uz.ddaDeleteAllDataValues(J.DdaMethod.ControlId,J.DdaBindingsMethod.BindingId,Db=>{Zg.a(Db)?this.Ce.cH(Db,Ia):this.Ce.kv(Ia)},Ia)}N4g(J,Ia){this.Uz.ddaClearBindingFormats(J.DdaMethod.ControlId,J.DdaClearBindingFormats.BindingId,Db=>{Zg.a(Db)?this.Ce.cH(Db,Ia):this.Ce.kv(Ia)},Ia)}V3f(J,Ia){const Db={},cc=J.DdaSetBindingFormats.IsSetFormats;cc?Db.CellFormat=J.DdaSetBindingFormats.CellFormat:Db.TableOptions=
J.DdaSetBindingFormats.TableOptions;this.Uz.ddaSetBindingFormats(J.DdaMethod.ControlId,J.DdaSetBindingFormats.BindingId,Db,cc,rc=>{Zg.a(rc)?this.Ce.cH(rc,Ia):this.Ce.kv(Ia)},Ia)}executeRichApiRequest(J,Ia){var Db;const cc=J.ArrayData,rc={},Tc=Ag.h(this.$).ha;if(cc){if("WacPartition"===cc[0]){this.RDh(J,Ia);return}const Qe=Object(V.a)(zg.DdaFacade,jh.a(this.$));if("SetOsfControlContainerReadyForCustomFunctions"===cc[0]){var bd=Qe.pn(J.DdaMethod.ControlId);bd&&(bd.Uic=!0,bd.CPf())}rc.HttpMethod=cc[1];
rc.PathAndQuery=cc[2];rc.RequestHeaders=yf.H3e(cc[3]);rc.RequestBody=cc[4];rc.AppPermission=cc[5];bd=cc[6];rc.RequestFlags=bd;var nd=0;if(Lh.i(this.$.na))switch(Tc.Ke){case 1:nd=2;break;case 2:nd=3;break;case 128:nd=4;break;default:nd=1}var Ed=null;Tc.Ra.zA&&(Ed=Tc.Ra.zA.Hi);rc.SheetMultiRange=Dh.r(Tc.qa.selectedRanges,this.$);rc.ActiveCell=Dh.v(Tc.qa.activeCell,this.$);rc.ActiveChartId=Ed;rc.SelectionState=nd;nd=this.Jd.gZ(J.DdaMethod.ControlId);rc.InstanceId=nd?nd.InstanceId:"";if(nd&&nd.PrimaryMarketplace){let nf;
if(nd.PrimaryMarketplace.MarketplaceType!==OSF.StoreType.InMemory)nf=nd.PrimaryMarketplace.SolutionId,Ed=nd.PrimaryMarketplace.MarketplaceType;else{if(!nd.OwnerAddinSolutionId){n.ULS.sendTraceTag(512325018,344,10,"executeRichApiRequest: No OwnerAddinSolutionId for AppCommand");this.Ce.zf(Uf.a.bAb,Ia);return}if(!nd.OwnerAddinStoreType){n.ULS.sendTraceTag(512325017,344,10,"executeRichApiRequest: No OwnerAddinStoreType for AppCommand");this.Ce.zf(Uf.a.bAb,Ia);return}nf=nd.OwnerAddinSolutionId;Ed=nd.OwnerAddinStoreType}let xg=
Telemetry.PrivacyRules.GetPrivacyCompliantId(nf,Ed,null===(Db=nd.AssetMarketplace)||void 0===Db?void 0:Db.SolutionId,null,null,nd.PrimaryMarketplace.MarketplaceRef);rc.CompliantSolutionId=xg;rc.SolutionId=nf;rc.MarketplaceType=Ed;rc.SolutionVersion=nd.PrimaryMarketplace.SolutionVersion;rc.StoreLocation=nd.PrimaryMarketplace.MarketplaceRef}else rc.SolutionId=rc.MarketplaceType="",rc.CompliantSolutionId="";rc.IsEventsEnabled=void 0===Qe||null===Qe||Qe.Zh.h1b(rc.InstanceId);rc.RequestGuid=Jh.a.create().toString();
Db=rc.RequestBody.length;if(C.EwaSettings.isChangeGateEnabled("OfficeVSO:4444309_RichApiPayloadSizeLimit")&&Db>this.$.ya.ExcelRichApiMaxAllowedRequestPayloadSize){this.Ce.zf(Uf.a.ioj,Ia);n.ULS.sendTraceTag(537163213,0,50,`Request payload size:${Db} exceeded the limit`);return}C.EwaSettings.isChangeGateEnabled("OfficeVSO:5079365_RichApiPreviewExecution")&&bd&4096&&(Db=new wg(this.$),OfficeExtension.WacRuntime.RichApi.previewExecute(Db,Mi,cc),rc.RequestBody=cc[4])}const Yd=yf.R6e(rc.RequestHeaders);
yf.bGd++;const Ie=wj.a.Ya.Ub;C.EwaSettings.isChangeGateEnabled("OfficeVSO:4316383_RichApiLogRequestBodySize")&&rc&&rc.RequestBody&&n.ULS.sendTraceTag(537163212,0,50,`Richapi json request body size is ${rc.RequestBody.length}`);this.Uz.executeRichApiRequest(rc,Qe=>{var nf;this.a3f(Ie,!0,Qe.ServerCorrelationId);let xg=null,jg=null;var ag=Qe.ServerCorrelationId;if(null===(nf=null===Qe||void 0===Qe?void 0:Qe.Errors)||void 0===nf?0:nf[0])xg=Qe.Errors[0].MessageIdName,jg=Qe.Errors[0].Description,C.EwaSettings.isChangeGateEnabled("OfficeVSO:4513856_NotShowApiExceptionOnUI")&&
Kj.a(this.$).gd.RL(Qe.Errors[0].MessageId);if(Zg.a(Qe)||!Qe.Result)this.e9a(ag,Yd,"Server error",xg,jg),this.Ce.cH(Qe,Ia);else{let pg=null;if(C.EwaSettings.ra(233))if((nf=Qe.Result)&&nf.length){for(let Pg=0;Pg<nf.length;Pg++)if(nf[Pg].RequestGuid===rc.RequestGuid){pg=nf[Pg];break}pg||this.Ce.cH(Qe,Ia)}else pg=Qe.Result;else pg=Qe.Result;if(!xg&&pg&&pg.ResponseBody&&pg.ResponseBody[0])if(Qe=pg.ResponseBody[0],Qe.startsWith('{"Error":')){1<pg.ResponseBody.length&&(Qe=Qe.substring(0,Qe.indexOf("}")+
1),Qe+="}");try{var eg=z.a.Xh(Qe);eg.Error&&this.e9a(ag,Yd,"Pipeline error",eg.Error.Code,eg.Error.Message)}catch(Pg){this.e9a(ag,Yd,"Json deserialize error",null,"Error info cannot be deserialized.")}}else this.e9a(ag,Yd);else this.e9a(ag,Yd,"Server error",xg,jg);const Og=(ag=pg.SheetMultiRange)?ag.SheetName:null;eg=pg.ActiveChartId;const Mg=pg.SelectionState;Qe=5===Mg&&!!ag||6===Mg||7===Mg||8===Mg;if(C.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")&&this.$.qb.uv&&
Qe)this.Ce.zf(Uf.a.RFc,Ia),n.ULS.sendTraceTag(537163211,0,50,`${Mg.toString()} is not allowed`);else if(5===Mg&&ag){if(this.$.va&&Og)if(this.$.va.Gk(Og))this.cWc(Og);else{let Pg=null;Pg=()=>{this.$.va.Gk(Og)&&(n.ULS.sendTraceTag(537163210,0,50,"Sheets item add event handler called"),this.cWc(Og),this.$.va.WJb(Pg))};this.$.va.qob(Pg);if(C.EwaSettings.isChangeGateEnabled("OfficeVSO:3973943_RichApiFixSheetActivateOnNewWorkbookEnabled")){let Nh=null;Nh=()=>{this.$.va.Gk(Og)&&(this.cWc(Og),this.$.va.bna(Nh))};
this.$.va.Nga(Nh)}}}else if(6===Mg||7===Mg||8===Mg||9===Mg){if(ag){const Pg=Dh.g(ag.Ranges);if(Og&&Dh.bb(Pg,!0))if(C.EwaSettings.isChangeGateEnabled("OfficeVSO:4211161_RichApiUpdateSelectionWithoutExistsWorksheet")&&!this.$.va.Gk(Og)){let Nh=null;Nh=()=>{this.Ekg(Tc,Pg,Og,Mg);this.$.va.bna(Nh)};this.$.va.Nga(Nh)}else this.Ekg(Tc,Pg,Og,Mg)}7===Mg?(eg="38.{"+kg.e(eg)+"}",T.a(this.$).tna(0,eg,!0)):8===Mg&&T.a(this.$).tna(2,eg,!0);9===Mg&&(this.$.ya.ApiCallToSetPageLayout=!0)}pg.PostProcessActions?(ag=
z.a.Xh(pg.PostProcessActions),this.D7i(ag).then(()=>{this.sdb(pg,Ia);this.Pcd(J.DdaMethod.ControlId,rc);return Promise.resolve(null)},Pg=>{this.sdb(pg,Ia,Pg);return Promise.reject(Pg)})):this.sdb(pg,Ia)}},Qe=>{this.a3f(Ie,!1,null);this.e9a(null,Yd,"Web service error");Ia(Qe)})}Pcd(J,Ia){const Db=Object(V.a)(zg.DdaFacade,jh.a(this.$));(null===Db||void 0===Db?0:Db.OOd)&&Db.pn(J)&&yf.EFj(Ia.RequestHeaders)&&(n.ULS.sendTraceTag(537163209,0,50,`ExecuteRichApiRequest(PostProcess): fire a RecordingStateChanged event to ControlId: ${J}; SolutionId: ${Ia.SolutionId}.`),
Db.OOd.hth(J))}RDh(J,Ia){var Db=this.Jd.gZ(J.DdaMethod.ControlId);const cc=zg.DdaFacade.getSolutionId(Db,this.$);var rc=null;rc=zg.DdaFacade.Xua(Db,this.$);rc=new Wi(rc,this.$);rc=new vj(cc,J.DdaMethod.ControlId,this.Jd,this.$,rc);const Tc={ResponseHeaders:[]};Tc.ResponseBody=Array(1);Db=yf.H3e(J.ArrayData[3]);const bd=yf.R6e(Db);Db=new Xg(this.$.ya.CreateWorkbookMaxAllowedBase64Size,this.sxf);OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(rc,Rf,Db,J.ArrayData).then(nd=>{if(!nd)return this.dxd(!1,
"The rich api executor call failed",bd),n.ULS.sendTraceTag(537163208,0,10,"The rich api executor call failed"),Tc.ResponseStatusCode=500,this.sdb(Tc,Ia),null;this.dxd(!0,"The rich api executor call succeeded",bd);Tc.ResponseStatusCode=nd[0];Tc.ResponseBody[0]=nd[2];this.sdb(Tc,Ia);return null},nd=>{Tc.ResponseStatusCode=400;Tc.ResponseBody[0]=nd.toString();this.dxd(!1,"The rich api executor call failed",bd);n.ULS.sendTraceTag(537163207,0,10,`A Excel Rich API batch execution was failed, AppId:${cc}`);
this.sdb(Tc,Ia);return null})}a3f(J,Ia,Db){yf.bGd--;J=Ej.a(wj.a.Ya,J);n.ULS.sendTraceTag(36763356,0,50,`Rich Api perf log -- total milliseconds used:${J}, requests pending:${yf.bGd}, request result:${Ia?"success":"false"}, server correlationid: ${Db}.`)}sdb(J,Ia,Db=null){const cc=Array(3);cc[0]=J.ResponseStatusCode;cc[1]=yf.m4h(J.ResponseHeaders);const rc=[];var Tc=!1;if(Db&&J.ResponseBody){const bd=z.a.Xh(J.ResponseBody.join(""));bd.Error||(Tc={},Tc.Error=Db,Tc.TraceIds=bd.TraceIds,Tc.ProcessedResults=
{},Tc.ProcessedResults.Results=bd.Results,rc[0]=z.a.Dc(Tc),Tc=!0)}cc[2]=Tc?rc:J.ResponseBody;J=this.Ce.KP();J.Data=cc;Ia(J)}kAd(J,Ia){(new Ni(this.$,this.Ce,this.Uz)).kAd(J,Ia)}CIi(J,Ia){n.ULS.sendTraceTag(537163206,0,50,"MessageParent API called!");const Db=J[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],cc=J[la.a.eYc],rc=J[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];J=this.$.da.Aa(232).R1a.DIi(J.DdaMethod.ControlId,Db,cc,rc);J===Uf.a.success?this.Ce.kv(Ia):(n.ULS.sendTraceTag(537163205,
0,10,"MessageParent API Failed!"),this.Ce.zf(J,Ia))}yIi(J,Ia){n.ULS.sendTraceTag(537163204,0,50,"MessageChild API called!");const Db=J[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],cc=J[la.a.eYc],rc=J[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];this.$.da.Aa(232).R1a.Lvj(J.DdaMethod.ControlId,Db,cc,rc);this.Ce.kv(Ia)}getAccessToken(J,Ia){n.ULS.sendTraceTag(537163203,0,50,"GetAccessToken API called!");const Db=(rc,Tc)=>{var bd;if(rc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)rc=this.Ce.KP(),
rc[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=Tc.accessToken,Ia(rc);else{Tc=this.Jd.gZ(J.DdaMethod.ControlId);let nd=null!==Tc.OwnerAddinStoreType?Tc.OwnerAddinStoreType:Tc.PrimaryMarketplace.MarketplaceType;n.ULS.sendTraceTag(537163202,0,10,`${({["errorCode"]:rc.toString(),["appId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(zg.DdaFacade.getSolutionId(Tc,this.$),nd,null===(bd=Tc.AssetMarketplace)||void 0===bd?void 0:bd.SolutionId,null,null,Tc.PrimaryMarketplace.MarketplaceRef),
["storeType"]:nd})}.`);this.Ce.zf(rc,Ia)}},cc=!C.EwaSettings.ra(23);Cf.TaskExtensions.za(tg.GetServiceTaskFactory.create(this.$.da,137,this.$.la,1),rc=>{const Tc=this.Jd.Ng,bd=Ef.getInstance();Kg.AppsForOfficeSingleSignOnManager.getInstance(Tc,rc.result,bd).getAccessToken(J.DdaMethod.ControlId,cc,J,Db)},this.$.la)}getAuthContext(J,Ia){Cf.TaskExtensions.za(tg.GetServiceTaskFactory.create(this.$.da,137,this.$.la,1),()=>{var Db=this.Jd.Ng.getOsfControl(J.DdaMethod.ControlId);if(Db.isFirstParty()){Db=
Db.getManifest();var cc=Db.getMarketplaceID(),rc=Db.getWebApplicationId(),Tc=Db.getWebApplicationMsaId();pc.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(cc).then(bd=>{const nd=this.Ce.KP(),Ed={};Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=rc;Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=Tc||rc;Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=bd.upn;Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=bd.userId;
Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=bd.authority;Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=dg.a.lPh(bd.authorityType);Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=bd.isAnonymous;Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=bd.tenantId;Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=bd.supportsAuthToken;nd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Ed;
Ia(nd)},bd=>{const nd=this.Ce.KP(),Ed={},Yd=new dg.a;Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=rc;Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=Tc||rc;Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Yd.upn;Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Yd.userId;Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Yd.authority;Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Yd.authorityType;Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=
Yd.isAnonymous;Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Yd.tenantId;Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=bd;Ed[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Yd.supportsAuthToken;nd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Ed;nd.Error=1;Ia(nd)})}},this.$.la)}Kni(J){const Ia=Ag.h(this.$).ha;return 16===Ia.Ke&&!!Ia.Ra.dc&&!!Ia.Ra.dc.floatingObject&&qg.a.equals(Ia.Ra.dc.floatingObject.id,J,!0)}Tfd(J){const Ia=
Ag.h(this.$).ha;return Ia.qa.Tg?1===Ia.Ke||this.Kni(J)?Ia.fia:null:null}ikc(J,Ia){return 1!==J&&2!==J&&3!==J?(this.Ce.zf(Uf.a.gEe,Ia),!1):!0}dxd(J,Ia,Db){const cc={};cc.a=this.$.ya.UserSessionId;cc.b=J;cc.c=Ia;cc.d=null;cc.e=Db;pb.b().Se(37,cc)}e9a(J,Ia,Db=null,cc=null,rc=null){const Tc={};J&&(Tc.ServerCorrelationId=J);void 0!==Ia&&null!==Ia&&(Tc.Source=Ia);Db&&(Tc.ErrorType=Db);cc&&(Tc.MessageId=cc);rc&&(Tc.StatusDescription=rc);C.EwaSettings.isChangeGateEnabled("OfficeVSO:6144055_EUIIDataInDbxheTag")&&
cc&&"ExternalDataRefreshFailed"===cc&&(Tc.StatusDescription="");n.ULS.sendTraceTag(50688452,0,50,z.a.Dc(Tc))}D7i(J){let Ia=new Promise(Db=>{Db(null)});for(let Db=0;Db<J.length;Db++)Ia=this.C7i(Ia,J[Db]);return Ia}C7i(J,Ia){return Object(Ng.a)(this,void 0,void 0,function*(){if(!Ia)return n.ULS.sendTraceTag(537163201,0,10,"Null PostProcessAction."),J.then(()=>Promise.reject(yf.T3a(yh.generalException,Tb.a.instance.ga(1764),null)));switch(Ia.actionType){case 1:case 2:J=J.then(()=>{const rc=Object(V.a)(zg.DdaFacade,
jh.a(this.$));if(rc.pn(Ia.controlId))switch(rc.Zh.r9h(Ia),Ia.messageType){case 14:case 100:rc.NOd.D1b(Ia);break;case 11:case 12:rc.$qj.Kpb(Ia);break;case 51:case 52:rc.Yqj.Kpb(Ia);break;case 2101:case 2102:rc.Zqj.Kpb(Ia);break;case 2E3:rc.arj.D1b(Ia);break;case 2201:this.$.Vka&&rc.OOd.gUg(Ia);break;case 2203:rc.brj.hUg(Ia);break;case 2700:C.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&rc.MOd.D1b(Ia);break;case 65541:rc.LOd.fUg(Ia)}else n.ULS.sendTraceTag(537163171,0,10,`OsfControl with instanceId[${Ia.controlId}] doesn't exist.`);
return Promise.resolve(null)});break;case 3:J=J.then(()=>{this.c9h(Ia);return Promise.resolve(null)});break;case 15:C.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&(J=J.then(()=>{this.S$h(Ia);return Promise.resolve(null)}));break;case 4:J=J.then(()=>{if(C.EwaSettings.ra(102)){var rc=Ag.h(this.$).ha.qa.activeCell;rc.top!==Ia.row+1&&rc.left!==Ia.column+1&&(rc=Dh.v(Sg.Range.Mc(Ia.row+1,Ia.column+1),this.$),Ag.h(this.$).qg(rc,null,null,null,3,"DdaMethodHandler.ShowCard"));Th.a(this.$,
243,242,0,Tc=>{Tc.yeb(Ia.row+1,Ia.column+1,1,!1,!1)})}return Promise.resolve(null)});break;case 7:J=J.then(()=>{Object(V.a)(zg.DdaFacade,jh.a(this.$)).Zh.xPe(Ia.controlId,Ia.isEnableEvents);return Promise.resolve(null)});break;case 5:J=J.then(()=>this.jih(Ia));break;case 6:J=J.then(()=>this.C2i(Ia));break;case 8:J=J.then(()=>{C.EwaSettings.isChangeGateEnabled("OfficeVSO:5333368_ClearBeforeCloseRegistrationsInWorkbookCloseApi")&&Object(V.a)(zg.DdaFacade,jh.a(this.$)).M4g();const rc=new Ij.a(Jj.a.Kj,
5,null);Hj.a(this.$).vr(rc);return Promise.resolve(null)});break;case 9:J=J.then(()=>this.zxj(Ia));break;case 10:J=J.then(()=>this.l7j(Ia));break;case 11:J=J.then(()=>this.k7j());break;case 12:J=J.then(()=>this.h7j());break;case 13:J=J.then(()=>this.i7j(Ia));break;case 14:J=J.then(()=>this.j7j(Ia));break;case 16:J=J.then(()=>Promise.resolve(Ia));break;case 17:J=J.then(()=>this.Qtj(Ia,Object(V.a)(zg.DdaFacade,jh.a(this.$))));break;case 18:Ag.h(this.$).focus();break;case 19:this.$9e(Ia.entryType,!1,
Ia.options);break;case 20:this.$9e(Ia.entryType,!0,Ia.options);break;case 21:const Db=jh.a(this.$);J=J.then(()=>Db.LOd.K8h(Ia));break;case 22:const cc=jh.a(this.$);J=J.then(()=>cc.LOd.L8h(Ia));break;case 23:this.Jd.z_f.vai(Ia.worksheetId,Ia.anchorCell,Ia.values);break;case 24:this.Jd.z_f.M9h(Ia.worksheetId);break;default:J=J.then(()=>Promise.reject(yf.T3a(yh.zRg,Tb.a.instance.ga(1765),null)))}return J})}S$h(J){var Ia=Object(V.a)(zg.DdaFacade,jh.a(this.$)).pn(J.controlId);if(Ia&&!(0===J.operationType^
!Ia.Gda)){Ag.h(this.$).Dzb=!0;switch(J.operationType){case 0:var Db=new Gj.a(document.createElement("input"));Db.text=J.range;Ia.qii(Ag.h(this.$).Gg.Ggh(Db,new Dj.a(this.$)));Ia.Gda.startEdit(!0);break;case 1:Ia.DVf();this.rangePicker=null;break;case 2:Ia.Gda.Vkg(J.range);break;case 3:Ia.Gda.Vkg(J.startingRange);Ia=J.expandSelection;Db=J.getNextDataRegionCell;let cc=0;switch(J.keyboardDirectionValue){case 2:cc=38;J=Ia&&Db?105288353:Ia?-31900117:Db?542791952:137938150;break;case 3:cc=40;J=Ia&&Db?-1297307319:
Ia?-1603798598:Db?1713663844:-798660877;break;case 0:cc=37;J=Ia&&Db?-403586027:Ia?2039316657:Db?-2012742350:-1470715894;break;case 1:cc=39;J=Ia&&Db?784916030:Ia?589730764:Db?1324884057:-1231471547;break;default:J=1461300262}Ia=this.a6b("keydown",cc,Ia,Db);Ag.h(this.$).cLb(Ia,new gf.a(J,1,0,8,null))}Ag.h(this.$).Dzb=!1}}a6b(J,Ia,Db,cc){const rc=document.createEvent("KeyboardEvent");if(Xe.a.iF)rc.initKeyboardEvent(J,!1,!1,window.self,"A",0,cc,!1,Db,!1);else{let Tc="";Db&&(Tc+="Shift");cc&&(Tc+=0<Tc.length?
" Control":"Control");rc.initKeyboardEvent(J,!1,!1,window.self,"A",0,Tc,!1,"en-US")}J=new Sys.UI.DomEvent(rc);J.keyCode=Ia;return J}c9h(J){switch(J.operationType){case 1:Cf.TaskExtensions.za(tg.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1),Ia=>{Ia.result.INd()},this.$.la,3);break;case 2:if(J=Object(V.a)(zg.DdaFacade,jh.a(this.$)).pn(J.controlId))J.Uic=!0,J.CPf()}}jih(J){const Ia=J.fileBase64;return Ia&&Ia.length>this.$.ya.CreateWorkbookMaxAllowedBase64Size?Promise.reject(yf.T3a(yh.invalidArgument,
Tb.a.instance.ga(1768),"Application.CreateWorkbook")):(new Promise((Db,cc)=>{const rc=new Vf.StandardDialog;rc.Ob=4;rc.Wl(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,Tc=>{2!==Tc&&0!==Tc||cc(yf.T3a(yh.eFd,Tb.a.instance.ga(1767),"Application.CreateWorkbook"));Tc=new Nf("blank","agave",Ia?"streamBase64":"streamEmpty",Ia);this.sxf.create(Db,cc,Tc).h1a()})})).then(Db=>{this.I$b.set(J.fakeFileId,Db);return Promise.resolve(null)},Db=>Db?Promise.reject(Db):
Promise.reject(yf.T3a(yh.generalException,Tb.a.instance.ga(1764),"Application.CreateWorkbook")))}C2i(J){return new Promise((Ia,Db)=>{if(this.I$b.has(J.fakeFileId)){const cc=this.I$b.get(J.fakeFileId);Db=new Vf.StandardDialog;Db.Ob=4;Db.Wl(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,rc=>{1===rc&&Qh.HelperMethods.gf(cc,void 0,void 0,"DdaMethodHandler.fileUrl");Ia(null)})}else Db(yf.T3a(yh.generalException,Tb.a.instance.ga(1764),"Document.Open"))})}zxj(J){return new Promise(Ia=>
{Object(V.a)(zg.DdaFacade,jh.a(this.$)).A_f=J.runtimeCalculationMode;const Db=this.$.da.Aa(268);Db&&Db.mBd(3===J.runtimeCalculationMode);Ia(null)})}l7j(J){Sh.a.wCb(this.$)&&this.$.da.Aa(331).tdb(0,J.urlStr,!0,!0,null);return Promise.resolve(null)}k7j(){Sh.a.wCb(this.$)&&this.$.da.Aa(331).tdb(1,null,!0,!0,null);return Promise.resolve(null)}h7j(){Sh.a.wCb(this.$)&&this.$.da.Aa(331).uPe();return Promise.resolve(null)}i7j(J){Sh.a.wCb(this.$)&&this.$.da.Aa(331).tdb(5,J.urlStr,!0,!0,null);return Promise.resolve(null)}j7j(J){if(Sh.a.wCb(this.$)){const Ia=
this.$.da.Aa(331);for(const Db of Ia.waa)Db.IsActive&&Db.HostEditUrl&&Db.UrlStr===J.hostEditUrlStr&&Qh.HelperMethods.gf(Db.HostEditUrl,"_blank")}return Promise.resolve(null)}Qtj(J,Ia){const Db=Ui.a.RK;J=z.a.Xh(J.payload);const cc={};"eventId"in J&&"payload"in J&&(cc.eventId=J.eventId,cc.payload=J.payload);Ia.GJ(2201,Db,z.a.Dc(cc));return Promise.resolve(null)}$9e(J,Ia,Db){const cc=this.$.da.Aa(5);cc&&(J=this.iQh(J))&&(Ia?cc.removeEntry(J):cc.mpe(J,Db))}iQh(J){switch(J){case 0:return 64;case 1:if(C.EwaSettings.isChangeGateEnabled("OfficeVSO:7109926_MsFormsBusinessBarApi"))return 69}}cWc(J){J=
Object(V.a)(Fj.a,this.$.va.getItemByName(J));(null===J||void 0===J?0:J.visible)&&J.activate(!0)}Ekg(J,Ia,Db,cc){var rc=J.qa.es;const Tc=rc<Ia.length&&Ia[rc].contains(J.qa.activeCell);J=Tc?J.qa.activeCell:Ia[0].topLeft;rc=Tc?rc:0;Ag.h(this.$).l4(Ia,rc,Db,null,J,null,null,3,"DdaMethodHandler.UpdateSelection",void 0,void 0,void 0,6===cc)}static get Bjh(){yf.Vpa||(yf.Vpa={},yf.Vpa[Microsoft.Office.WebExtension.CoercionType.Table]=1,yf.Vpa[Microsoft.Office.WebExtension.CoercionType.Text]=2,yf.Vpa[Microsoft.Office.WebExtension.CoercionType.Matrix]=
3,yf.Vpa[Microsoft.Office.WebExtension.CoercionType.Html]=4,yf.Vpa[Microsoft.Office.WebExtension.CoercionType.Ooxml]=5);return yf.Vpa}static get Ejh(){yf.vib||(yf.vib={},yf.vib[Microsoft.Office.WebExtension.FilterType.All]=1,yf.vib[Microsoft.Office.WebExtension.FilterType.OnlyVisible]=2);return yf.vib}static get Fjh(){yf.wib||(yf.wib={},yf.wib[Microsoft.Office.WebExtension.ValueFormat.Unformatted]=2,yf.wib[Microsoft.Office.WebExtension.ValueFormat.Formatted]=1);return yf.wib}static H3e(J){if(!J||
!J.length)return null;const Ia=Array(J.length/2);for(let Db=0;Db<J.length/2;Db++)Ia[Db]={},Ia[Db].Name=J[2*Db],Ia[Db].Value=J[2*Db+1];return Ia}static m4h(J){if(!J||!J.length)return null;const Ia=Array(2*J.length);for(let Db=0;Db<J.length;Db++)Ia[2*Db]=J[Db].Name,Ia[2*Db+1]=J[Db].Value;return Ia}static fdd(J){if(!J||!J.length)return null;const Ia=Array(J.length);for(let Db=0,cc=J.length;Db<cc;Db++){const rc=J[Db].length;if(rc){Ia[Db]=Array(rc);for(let Tc=0;Tc<rc;Tc++)Ia[Db][Tc]=null==J[Db][Tc]?null:
J[Db][Tc].toString()}else return null}return Ia}static r4b(J){return"string"===typeof J?ej.a.aq(yf.Bjh,J,0):J}static FXe(J){return"string"===typeof J?ej.a.aq(yf.Ejh,J,0):J}static tmg(J){return"string"===typeof J?ej.a.aq(yf.Fjh,J,0):J}static Xni(J){switch(J.DdaMethod.DispatchId){case 68:case 74:case 70:case 77:case 80:case 64:case 75:case 81:return!0}return!1}static c0c(J,Ia){const Db={};Db.CoerceType=J;1===Db.CoerceType?(Db.Data=yf.fdd(Ia.Rows),Db.Headers=yf.fdd(Ia.Headers)):Db.Data=yf.fdd(Ia);return Db}static oye(J){return 1===
J.CoerceType?{["Headers"]:J.Headers,["Rows"]:J.Data}:J.Data}static chc(J){return 1===J.CoerceType?!J.Data&&!J.Headers:!J.Data}static R6e(J){let Ia="Unknown";if(!J)return Ia;for(let Db=0;Db<J.length;Db++)if(J[Db].Name.toLowerCase()===Sc.a.crj){Ia=J[Db].Value;break}return Ia}static EFj(J){if(!J)return!1;const Ia=Sc.a.iNi.toLowerCase();for(let Db=0;Db<J.length;Db++)if(J[Db].Name.toLowerCase()===Ia)return!0;return!1}static T3a(J,Ia,Db){const cc={};cc.Code=J;cc.Message=Ia;cc.Location=Db;cc.ActionIndex=
0;return cc}}yf.Vpa=null;yf.vib=null;yf.wib=null;yf.bGd=0;Object(d.a)(yf,"DdaMethodHandler",null,[222,2]);class fj extends id.a{constructor(J){super(J)}hd(){const J=tg.GetServiceTaskFactory.create(this.$.da,106,this.la,this.Xa),Ia=tg.GetServiceTaskFactory.create(this.$.da,165,this.la,this.Xa),Db=Ri(this.la,this.Xa),cc=C.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&C.EwaSettings.isChangeGateEnabled("OfficeVSO:7126095_ReduceInnerHTMLUsageForDdaBindingPrompt")?tg.GetServiceTaskFactory.Oa(this.$.da,
498,499,this.Xa):Wg.Task.Sa(null);Cf.TaskExtensions.za(Cf.TaskExtensions.Fd([J,Ia,Db,cc],this.la),()=>{const Tc=J.result,bd=pc.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory");this.$c([new yf(this.$,Tc,bd,cc.result)])},this.la,3);const rc=pc.a.instance;Cf.TaskExtensions.za(tg.GetServiceTaskFactory.create(this.$.da,137,this.$.la,this.Xa),()=>{rc.register(mg,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").qc().yc(()=>new mg)},this.$.la)}static ka(J){id.a.Md(82,
new fj(J))}}Object(d.a)(fj,"DdaCommandHandlerFactory",id.a,[]);Type.registerNamespace("Microsoft.AppRuntime");Type.registerNamespace("Microsoft.InternalService");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Agave");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.WebExtension");Type.registerNamespace("_Ewa");c.a.Bi("");c.a.Bi(".ewa-wx-disabled-div{position:absolute;height:100%;width:100%}.ewa-wx-container-div{position:relative}.ewa-ptp-nov2-flex .ewa-wx-container-div{flex:1}");
Object(b.a)();Type.registerNamespace("Common.App.AppsForOfficeCommon");Object(e.a)();(()=>{f.a.Fa(J=>{xb.ka(J)})})();Type.registerNamespace("Common.App.AppsForOfficeCommon");Object(Ub.a)();Type.registerNamespace("CommandUI.AddInCommands");(()=>{f.a.Fa(J=>{C.EwaSettings.ra(52)&&oh.ka(J)})})();(()=>{f.a.Fa(J=>{C.EwaSettings.ra(114)&&$h.ka(J)})})();f.a.Fa(ii.ka);f.a.Fa(th.ka);Type.registerNamespace("Common.App.AppsForOfficeOauth");Type.registerNamespace("Common.App.SmartLookup");(()=>{f.a.Fa(J=>{Ai.ka(J);
Id.ka(J);Ce.ka(J)})})();f.a.Fa(fj.ka)},1490:function(r,F,a){r=a(0);var c=a(192),b=a(98);class e{constructor(){this.sOe=this.displayName=this.jsb=this.Do=this.oB=null;this.isUpgraded=!1}Xlf(d,h){return this.oB.getStoreType().toLowerCase()===d.toLowerCase()&&this.oB.getSolutionId().toLowerCase()===h.toLowerCase()}}Object(r.a)(e,"AddinCommandsResourceItem",null,[]);a.d(F,"a",function(){return f});class f{constructor(){this.UGc=null;this.ILc=0;this.mNc=!1;this.Za=new b.a;this.Ayg=new c.a}ILg(d){this.Za.addHandler("AddinCommandsLoadingMessageChanged",
d)}bjj(d){this.Za.removeHandler("AddinCommandsLoadingMessageChanged",d)}get iZa(){return this.UGc}Udb(d){d!==this.UGc&&(this.UGc=d,this.Za.raiseEvent("AddinCommandsLoadingMessageChanged"))}uxj(){this.ILc++;this.iZa||this.Udb(CommonUIStrings.l_LoadingAddInsTitle)}rRd(){this.ILc--;this.Nlc()&&(this.mNc?this.iZa!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.Udb(CommonUIStrings.l_ErrorLoadingAddInsTitle):this.Udb(null))}M4f(d=!1){this.mNc=!0;this.Udb(d?CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg:
CommonUIStrings.l_ErrorLoadingAddInsTitle)}uCe(){this.mNc=!1;this.Nlc()?this.Udb(null):this.Udb(CommonUIStrings.l_LoadingAddInsTitle)}Nlc(){return 0>=this.ILc}get l6a(){return this.Ayg}Ria(d,h,l=0){for(let k of this.l6a)if(k.Xlf(d,h)&&(!k.Do||k.Do.ENh===l))return k;return null}gpe(d,h,l,k){const t=new e;t.oB=d;t.Do=h;t.jsb=l;t.displayName=k;this.l6a.add(t)}OJg(d,h,l,k){const t=new e;t.oB=d;t.Do=h;t.jsb=null;t.sOe=l;t.displayName=k;this.l6a.add(t)}Chj(d,h){let l=0;for(let k of this.l6a)k.oB.getStoreType()===
d&&k.oB.getSolutionId()===h?this.l6a.removeAt(l):l++}static getInstance(){f.La||(f.La=new f);return f.La}}f.La=null;Object(r.a)(f,"AddinCommandsResourceManager",null,[])},744:function(r,F,a){a.d(F,"a",function(){return b});r=a(0);var c=a(35);class b{static get AIi(){return b.ree||(b.ree={["-2002156328"]:b.gEe,["-1954750170"]:b.o7e,["317650254"]:b.x6g,["-1005263101"]:b.qki,["1353664579"]:b.cvj,["159671765"]:b.rki,["1446690022"]:b.g2e,["1150069548"]:b.ADc,["-1409306331"]:b.PAe,["338507772"]:b.hKe,["-457159301"]:b.r3i,
["-1037701970"]:b.cjh,["-1893322318"]:b.wki,["965579896"]:b.ejh,["93287890"]:b.djh,["358088857"]:b.jyj,["-1223650923"]:b.hKe,["2007306190"]:b.A2g,["1549955423"]:b.nxe,["-1275974171"]:b.vki,["382101082"]:b.F2i,["-898776235"]:b.fKi,["335464256"]:b.WJi,["1677378049"]:b.uki,["-261992848"]:b.rYj,["-980820954"]:b.nxe,["-931375837"]:b.E2i,["929186550"]:b.Eqh,["-982144310"]:b.y$i,["-785741187"]:b.oki,["2125217573"]:b.yki,["299124955"]:b.pki,["1669853884"]:b.orj,["-1515932330"]:b.y6g,["314621024"]:b.YJh,["-300049690"]:b.E2g,
["14766835"]:b.nDj,["-1251992761"]:b.qNe,["-2087635043"]:b.invalidOrTimedOutSession,["2100961153"]:b.invalidOrTimedOutSession,["-1218744139"]:b.invalidSheetName,["-1468309555"]:5006,["-315732528"]:b.invalidOrTimedOutSession,["611268539"]:b.invalidOrTimedOutSession,["1531005923"]:5006,["1593924569"]:5006,["299476328"]:b.NFa,["49173765"]:b.NFa,["-907155566"]:b.NFa,["-1201603824"]:b.NFa,["1541165282"]:b.NFa,["-1347753427"]:b.NFa,["134912532"]:b.NFa,["1780971550"]:b.responsePayloadSizeLimitExceeded})}static UZe(e){return c.a.aq(b.AIi,
e.toString(),b.internalError)}}b.success=0;b.gEe=1E3;b.o7e=1001;b.x6g=1002;b.qki=1003;b.cvj=1004;b.rki=1005;b.g2e=1008;b.sXe=1009;b.invalidSheetName=1014;b.ADc=2E3;b.PAe=2001;b.hKe=2002;b.r3i=2003;b.cjh=2004;b.wki=2005;b.ejh=2007;b.djh=2008;b.jyj=2009;b.A2g=2014;b.Ruj=3E3;b.nxe=3002;b.vki=3004;b.F2i=3005;b.fKi=3006;b.WJi=3007;b.uki=3008;b.rYj=3009;b.E2i=3010;b.nDj=4002;b.iFd=5E3;b.internalError=5001;b.qNe=5002;b.bAb=5004;b.uZj=5007;b.gfi=5008;b.invalidOrTimedOutSession=5012;b.RFc=5016;b.NFa=5102;
b.ioj=5103;b.responsePayloadSizeLimitExceeded=5104;b.W1g=7001;b.Uag=7002;b.Eqh=8E3;b.y$i=8001;b.oki=8010;b.yki=8011;b.pki=8012;b.orj=8020;b.y6g=8021;b.YJh=8022;b.E2g=8023;b.fIi=11E3;b.UKi=11001;b.xki=11002;b.ree=null;Object(r.a)(b,"DdaErrorIds",null,[])},745:function(r,F,a){a.d(F,"a",function(){return e});r=a(0);var c=a(15),b=a(111);class e{constructor(){this.aLd=0;this.kW={};this.bta={}}t_h(f,d){return this.kW[e.f0c(f,d)]}xPe(f,d){d||void 0!==this.bta[f]&&null!==this.bta[f]?d&&void 0!==this.bta[f]&&
null!==this.bta[f]&&delete this.bta[f]:this.bta[f]=1}h1b(f){return void 0===this.bta[f]||null===this.bta[f]}r9h(f){const d=e.f0c(f.messageType,f.targetId);1===f.actionType?this.X$h(f.controlId,f.messageType,d):2===f.actionType&&this.Kai(f.controlId,f.messageType,d)}gij(f){if(f){var d=Object.keys(this.kW);if(!(void 0===d||null===d||0>=d.length))for(const h of d)d=this.kW[h],d[f]&&(delete d[f],Object.keys(d).length||delete this.kW[h])}}KQ(f,d){f=e.f0c(f,d);f=this.kW[f];return!!f&&0<Object.keys(f).length}Gbi(){return!b.a.isEmpty(this.kW)}Tmf(){return 0<
this.aLd}HUh(){const f=[],d=this.kW;for(let k in d){var h=k,l=d[k];for(let t in l){l=t;const n={};n.eventType=parseInt(h.split("#")[0],10);n.targetId=h.split("#")[1];n.addinId=l;f.push(n)}}return f}X$h(f,d,h){if(this.kW[h])h=this.kW[h],h[f]=h[f]?h[f]+1:1;else{let l={};l[f]=1;this.kW[h]=l}100===d&&this.aLd++}Kai(f,d,h){if(this.kW[h]){const l=this.kW[h];if(f){const k=l[f];1===k?(delete l[f],Object.keys(l).length||delete this.kW[h]):l[f]=k-1;100===d&&this.aLd--}else c.ULS.sendTraceTag(537170459,0,50,
`The OsfControl[${f}] doesn't register event with key[${h}].`)}else c.ULS.sendTraceTag(537170460,0,50,`The event with key[${h}] that will be unregistered doesn't exist.`)}static f0c(f,d){return String.format("{0}#{1}",f,d)}}e.RK="Workbook";Object(r.a)(e,"RichApiEventRegistration",null,[])},746:function(r,F,a){a.d(F,"a",function(){return c});r=a(0);class c{}c.generalException="GeneralException";c.invalidArgument="InvalidArgument";c.notImplemented="NotImplemented";c.DVc="AccessDenied";c.notSupported=
"NotSupported";c.apiNotAvailable="ApiNotAvailable";c.notAllowed="NotAllowed";c.eFd="OperationCancelled";c.userNotSignedIn="UserNotSignedIn";c.userAborted="UserAborted";c.xZj="UnsupportedUserIdentity";c.invalidResourceUrl="InvalidResourceUrl";c.invalidGrant="InvalidGrant";c.FPg="AddinIsAlreadyRequestingToken";c.Jpj="ResourceNotAllowed";c.clientError="ClientError";c.serverError="ServerError";c.r$g="ControlIdNotFound";c.yqj="RibbonApiNotAvailable";c.hostRestartNeeded="HostRestartNeeded";c.invalidRibbonDefinition=
"InvalidRibbonDefinition";c.sharedRuntimeNotAvailable="SharedRuntimeNotAvailable";Object(r.a)(c,"ErrorCodes",null,[])},749:function(r,F,a){a.r(F);var c=a(0),b=a(7),e=a(15),f=a(1336),d=a(85),h=a(98);class l{constructor(pa,zb,Vb){this._id=pa;this.vsg=zb;this.Dug=Vb;this.hgf=OfficeExt.CommandInvokeMode.Default}get id(){return this._id}get EPg(){return this.vsg}get b7g(){return this.Dug}execute(pa,zb,Vb){Vb=Vb||{};Vb.commandMode=this.hgf;zb.invokeAppCommand(this.EPg,this.b7g,Vb,()=>{pa.YWi(this.id)})}}
Object(c.a)(l,"AddinNativeActionBase",null,[97]);class k extends l{constructor(pa,zb){super(1,pa,zb);this.hgf=OfficeExt.CommandInvokeMode.ExclusiveForNew}}Object(c.a)(k,"AddinTakeSnapshotAction",l,[]);class t{Zah(pa){return new l(3,pa,this.oOh().getNativeActionName(3))}oOh(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()}}Object(c.a)(t,"AddinNativeActionManager",null,[76]);var n=a(150);class z{invokeAppCommand(pa,zb,Vb,xc){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(pa,
zb,Vb,xc)}static getInstance(){z.La||(z.La=new z);return z.La}}z.La=null;Object(c.a)(z,"OSFAddinCommandsRuntimeManager",null,[77]);var w=a(4),m=a(185),u=a(27);class y extends n.a{constructor(pa,zb,Vb){super();this.i9=null;this.EUc="WACDialogTitleText";this.pX="0";this.k8="15px";this.Tug="0px";this.oX="calc(100% - 30px)";this.Sug="100%";this.The=0;this.Za=new h.a;this.xsg=new t;this.Ob=5;this.pe=this.oDa=Vb;this.ZJc=pa;this.Z7d=zb;this.mKc=!!w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.pa("OfficeAddinEnableInsertDialogAccessibilityFix")}WNg(pa){this.Za.addHandler("OnDialogClosedEventKey",
pa)}iAj(){this.xEa=null}Iw(){super.Iw();this.Mh.style.width="100%";this.Mh.style.height=this.Rec?this.oX:this.Sug;this.Mh.style.marginTop=this.Rec?this.k8:this.Tug;this.Mh.style.padding=this.pX}CD(){super.CD();this.lb.style.width=String.format("{0}px",this.ZJc*window.innerWidth/100);this.lb.style.height=String.format("{0}px",this.Z7d*window.innerHeight/100);this.lb.style.minWidth="0px";this.mKc&&w.AFrameworkApplication.isRtl&&100===this.ZJc&&(this.lb.style.right="0px",this.lb.style.marginRight="0px");
this.i9=document.getElementById(this.Fh(this.EUc));this.i9.style.position="absolute";this.i9.style.whiteSpace="nowrap";this.i9.style.textOverflow="ellipsis";w.AFrameworkApplication.isRtl?(this.i9.style.right="14px",this.i9.style.left="44px"):(this.i9.style.right="44px",this.i9.style.left="14px")}ry(pa){super.ry(pa);this.i9&&this.i9.setAttribute("title",pa)}get Z$(){return this.Mh}ONd(){this.lb.style.width=String.format("{0}px",this.ZJc*window.innerWidth/100);this.lb.style.height=String.format("{0}px",
this.Z7d*window.innerHeight/100);this.lb.style.overflowY="hidden";this.lb.style.overflowX="hidden";this.lb.style.marginTop="";this.lb.style.top="";u.a.V4&&w.AFrameworkApplication.isRtl?(this.lb.style.right="",this.lb.style.marginRight=""):(this.lb.style.left="",this.lb.style.marginLeft="")}hide(){this.xsg.Zah(this.oDa).execute(this,z.getInstance(),{});this.The=window.setTimeout(()=>{this.Za.raiseEvent("OnDialogClosedEventKey",this.oDa);m.a.prototype.hide.call(this)},500)}YWi(pa){3===pa&&(window.clearTimeout(this.The),
this.Za.raiseEvent("OnDialogClosedEventKey",this.oDa),super.hide())}}Object(c.a)(y,"AppsForOfficeDialog",n.a,[57,58]);class v{constructor(){this.dialog=this.pe=null}}Object(c.a)(v,"DialogInfo",null,[]);class C{}C.url="url";C.height="height";C.width="width";C.Q8c="displayInIframe";C.ofc="hideTitle";Object(c.a)(C,"DialogSettings",null,[]);class x{constructor(){this.height=this.width=0;this.pe=this.controlId=this.pageUrl=null;this.ofc=this.Q8c=!1}}Object(c.a)(x,"DisplayDialogParams",null,[]);class B extends Sys.EventArgs{constructor(pa,
zb,Vb=null,xc="",Sc=""){super();this.controlId=pa;this.messageType=zb;this.messageContent=Vb;this.messageOrigin=xc;this.targetOrigin=Sc}}Object(c.a)(B,"OnMessageDialogEventArgs",Sys.EventArgs,[]);class H extends Sys.EventArgs{constructor(pa,zb,Vb=null,xc="",Sc=""){super();this.controlId=pa;this.messageType=zb;this.messageContent=Vb;this.messageOrigin=xc;this.targetOrigin=Sc}}Object(c.a)(H,"OnMessageParentEventArgs",Sys.EventArgs,[]);var I=a(39),U=a(30),S=a(174),G=a(100);class D{constructor(pa){this.Za=
new h.a;this.Gl=pa}dOg(pa){this.Za.addHandler("OnMessageParentEventKey",pa)}cOg(pa){this.Za.addHandler("OnMessageDialogEventKey",pa)}showDialog(pa,zb,Vb,xc){if(D.X7.hb(zb))e.ULS.sendTraceTag(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control."),Vb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else try{const ze=I.b(pa),ef=ze[C.url];if(this.Gl.getOsfControl(zb).checkAppDomains(ef)){var Sc=new x;Sc.width=ze[C.width];Sc.height=ze[C.height];Sc.pageUrl=ef;Sc.Q8c=
ze[C.Q8c];Sc.ofc=ze[C.ofc];Sc.controlId=zb;Sc.pe=S.a.create().toString();var Jd=new v;Jd.pe=Sc.pe;var ye=this.Gl.getOsfControl(Sc.controlId).getManifest().getDefaultDisplayName(),pe=this.Gl.getOsfControl(Sc.controlId).getStoreType().toLowerCase();pa=null;pa=(4===w.AFrameworkApplication.sa.Qa.Oj&&"hardcodedpreinstall"===pe||"sdxcatalog"===pe)&&Sc.ofc?this.createAndShowAppsForOfficeDialog(Sc.width,Sc.height,Sc.pe,!0,ye):this.createAndShowAppsForOfficeDialog(Sc.width,Sc.height,Sc.pe,!1,ye);var re=this.Gl.getOsfControl(Sc.controlId),
He=re.getManifest();zb={};zb.id=Sc.pe;zb.solutionId=re.getSolutionId();zb.version=re.getVersion();zb.storeType=pe;zb.storeId=re.getStoreId();zb.assetId=re.getAssetId();zb.assetStoreId=re.getAssetStoreId();zb.ownerAddinSolutionId=re.getOwnerAddinSolutionId();zb.ownerAddinStoreType=re.getOwnerAddinStoreType();zb.appDomains=He.getAppDomains();zb.dialogUrl=ef;zb.osfControlType=1;zb.agaveName=ye;zb.div=pa.Z$;e.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(zb.solutionId,
zb.ownerAddinStoreType||zb.storeType,zb.assetId,null,null,zb.storeId),U.a.Yu(Sc.pageUrl));this.Gl.insertDialogControl(zb);pa.WNg(Object(d.a)(this,this.gRi,"onDialogClosed"));Jd.dialog=pa;D.X7.ia(Sc.controlId,Jd);xc&&xc(zb);Vb(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else e.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),Vb(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(ze){e.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",
ze.message),Vb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}DIi(pa,zb,Vb,xc){w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",!1)||""===xc&&(xc=Vb);try{const Sc=this.pKa(pa);Sc&&this.Za.raiseEvent("OnMessageParentEventKey",new H(Sc,OSF.DialogMessageType.DialogMessageReceived,zb,Vb,xc))}catch(Sc){return e.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",Sc.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}Erb(pa,
zb){if(D.X7.hb(pa))try{const Vb=D.X7.ma(pa);Vb.dialog&&Vb.dialog.hide();this.Gl.purgeDialogControl(Vb.pe);D.X7.remove(pa);zb(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(Vb){e.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",Vb.message),zb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else e.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),zb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}Lvj(pa,
zb,Vb,xc){w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",!1)||""===xc&&(xc=Vb);if(D.X7.hb(pa)&&(pa=D.X7.ma(pa),pa.dialog))try{this.Za.raiseEvent("OnMessageDialogEventKey",new B(pa.pe,OSF.DialogMessageType.DialogParentMessageReceived,zb,Vb,xc))}catch(Sc){e.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",Sc.message)}}pKa(pa){let zb=null;for(let Vb of D.X7)if(Vb.value.pe===pa){zb=Vb.key;
break}return zb}gRi(pa,zb){if(pa=this.pKa(zb))this.Gl.purgeDialogControl(zb),D.X7.remove(pa),this.Za.raiseEvent("OnMessageParentEventKey",new H(pa,OSF.DialogMessageType.DialogClosed,null,null,"*"))}createAndShowAppsForOfficeDialog(pa,zb,Vb,xc,Sc){pa=new y(pa,zb,Vb);Sc=xc?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,Sc);xc&&(pa.Rec=!1,pa.pt=!1);pa.initializeAndShow(Sc,null,null);pa.iAj();return pa}static i7h(){return D.X7}static getInstance(pa){D.La||(D.La=new D(pa));return D.La}}
D.La=null;D.X7=new G.a;Object(c.a)(D,"AppsForOfficeDialogManager",null,[34]);var E=a(865),N=a(697),M=a(553),L=a(192),aa=a(381),V=a(1343);class P{constructor(){this.Peb=null;this.errorCode=0;this.failure=null}}Object(c.a)(P,"AddinCollection",null,[]);class ba extends Sys.EventArgs{constructor(pa,zb){super();this.Dob=pa;this.gY=zb}}Object(c.a)(ba,"AddinDetailsRefreshedEventArgs",Sys.EventArgs,[]);class Y{constructor(pa){this.errorCode=pa;this.gY=[];this.failure=null}}Object(c.a)(Y,"GetAddinDetailsResult",
null,[]);var Z=a(731),ea=a(834);class ra{}Object(c.a)(ra,"GetEntitlementDetailsParameters",null,[]);var O=a(179);class da{constructor(pa,zb){this.Za=new h.a;this.W7=new N.a(M.a.Oi());this.Xz=new aa.a;this.VTc=new O.a;this.VTc.add(OSF.StoreTypeEnum.MarketPlace,0);this.VTc.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.mb=pa;this.Gl=zb;this.hqe(Object(d.a)(this,this.QNi,"onAddinDetailsRefreshed"))}get Ng(){return this.Gl.value}get EGd(){return this.mb.Wa("PopularAddinDetailsJsonString")}lwb(pa){if(!this.$od(pa))return pa=
Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:V.a[pa]}),Object.assign(new Y(1),{failure:pa});if(this.Xz.ma(pa).failure)return Object.assign(new Y(this.Xz.ma(pa).errorCode),{failure:this.Xz.ma(pa).failure});e.ULS.shipAssertTag(509870082,220,!!this.Xz.ma(pa).Peb,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",pa);const zb=new Y(0);for(let Vb of this.Xz.ma(pa).Peb)this.W7.hb(Vb)&&Array.add(zb.gY,this.W7.ma(Vb));return zb}lOh(pa){return this.W7.hb(pa)?
this.W7.ma(pa):null}Utc(pa){if(pa){this.hqe(pa);for(let Vb of this.Xz.keys)if(this.$od(Vb)&&!this.Xz.ma(Vb).failure){e.ULS.shipAssertTag(509870081,220,!!this.Xz.ma(Vb).Peb,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",Vb);var zb=[];for(let xc of this.Xz.ma(Vb).Peb)Array.add(zb,this.W7.ma(xc));zb=new ba(Vb,zb);pa(null,zb)}}}uR(pa,zb=!1){0!==pa&&10!==pa?e.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",ea.a[pa]):this.O$i(pa,
Object(d.a)(this,this.kYi,"onQueryAddinDetailsCompleted"),zb)}hqe(pa){this.Za.addHandler(Z.a.ase,pa)}kYi(pa,zb,Vb){if(Vb)if(da.QDi(pa,Vb,window.performance.now()-zb),0===Vb.errorCode){let Sc;if(Vb.value){let Jd=0;Sc=Array(Vb.value.length);Vb.value.forEach(ye=>{Sc[Jd++]=ye})}else Sc=[];this.Vxf(pa,Sc)}else if(-1===Vb.errorCode||10===Vb.errorCode)this.Vxf(pa,[]);else{var xc={};xc.collectionType=V.a[pa];xc.invokeResultCode=Vb.errorCode;xc["queryResult.Value"]=Vb.value?String.format("Length: {0}",Vb.value.length):
"null";xc.queryStart=zb;xc.queryDuration=window.performance.now()-zb;this.Xz.ia(pa,Object.assign(new P(pa),{errorCode:3,failure:Error.create("QueryAddinDetails hit an invocation failure",xc)}));e.ULS.sendTraceTag(512231324,220,10,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",V.a[pa],this.Xz.ma(pa).failure.toString(),JSON.stringify(this.Xz.ma(pa).failure))}else xc={},xc.collectionType=V.a[pa],xc.queryResult=Vb?"not null":"null",
xc.queryStart=zb,xc.queryDuration=window.performance.now()-zb,this.Xz.ia(pa,Object.assign(new P(pa),{errorCode:3,failure:Error.create("QueryAddinDetails hit an invocation failure",xc)})),e.ULS.sendTraceTag(512231323,220,10,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",V.a[pa],this.Xz.ma(pa).failure.toString(),JSON.stringify(this.Xz.ma(pa).failure))}ald(pa){const zb={};zb.collectionType=V.a[pa];this.Xz.ia(pa,Object.assign(new P(pa),
{errorCode:2,failure:Error.create("The store is disabled.",zb)}));e.ULS.sendTraceTag(510253056,220,10,"Fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",V.a[pa],this.Xz.ma(pa).failure.toString(),JSON.stringify(this.Xz.ma(pa).failure))}O$i(pa,zb,Vb=!1){e.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",pa);pa!==OSF.StoreTypeEnum.MarketPlace&&pa!==OSF.StoreTypeEnum.PrivateCatalog?e.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",
pa):(this.$od(2)||this.queryStoreDisabled(0,(xc,Sc)=>{Sc?this.ald(2):(xc=window.performance.now(),zb(2,xc,this.g0h()))}),this.queryStoreDisabled(pa,(xc,Sc)=>{if(xc===OSF.StoreTypeEnum.MarketPlace&&Sc)this.ald(0);else if(xc===OSF.StoreTypeEnum.PrivateCatalog&&Sc)this.ald(1);else{var Jd=window.performance.now();this.Ng.getEntitlementDetails(Object.assign(new ra,{storeType:xc,refresh:Vb}),ye=>{zb(this.VTc.ma(xc),Jd,ye)})}}))}Vxf(pa,zb){pa=new ba(pa,zb);this.Za.raiseEvent(Z.a.ase,pa)}QNi(pa,zb){pa=Object.assign(new P(zb.Dob),
{Peb:new L.a});var Vb=zb.gY;for(const xc of Vb)Vb=xc.solutionId,this.W7.hb(Vb)?this.W7.ia(Vb,this.nIi(this.W7.ma(Vb),zb.Dob,xc)):this.W7.add(Vb,xc),pa.Peb.add(Vb);this.Xz.ia(zb.Dob,pa)}$od(pa){return this.Xz.hb(pa)?!!this.W7:!1}get oTg(){return!this.mb.pa("AreThirdPartyAddInsAllowed")||this.mb.pa("AppsForOfficeThirdPartyIsDisabled")}get Zqi(){return!this.mb.pa("AppsForOfficeAllowExternalMarketplace")}queryStoreDisabled(pa,zb){if(this.oTg)zb(pa,!0);else if(pa===OSF.StoreTypeEnum.MarketPlace&&this.Zqi)zb(pa,
!0);else{const Vb=da.xTj(pa);if(Vb){const xc=window.performance.now();this.Ng.queryStoreDisabled(Vb,Sc=>{e.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",pa,Sc,xc,window.performance.now()-xc);zb(pa,Sc)})}else zb(pa,!1)}}nIi(pa,zb,Vb){if(!pa)return Vb;if(!Vb)return pa;if(2===zb)return pa.addinInfo=Vb.addinInfo,pa;Vb.addinInfo=pa.addinInfo;return Vb}g0h(){const pa=JSON.parse(this.EGd);return da.gZg(pa)}static QDi(pa,zb,Vb){const xc=
{};xc.AddinCollectionType=V.a[pa];xc.ErrorCode=zb.errorCode;xc.AddinCount=zb.value?zb.value.length:0;e.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; fields: {1}",Vb,JSON.stringify(xc))}static gZg(pa){const zb={errorCode:0};zb.value=pa;return zb}static xTj(pa){return pa===OSF.StoreTypeEnum.MarketPlace?"omex":pa===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}}Object(c.a)(da,"AddinDetailsManager",null,[814]);var xa=a(831),ia=a(1335),Ma=a(1419),
Ta=a(952),Da=a(176),fa=a(1342),ua=a(121),Fa=a(83),ca=a(360),ka=a(89),Ca=a(648),fb=a(84),yb=a(421),mb=a(552),nb=a(160),X=a(38),R=a(5),wa=a(880),na=a(1258),Ba=a(81);class Ra{constructor(){this.command=0;this.properties=null}}Object(c.a)(Ra,"DdaRequestInfo",null,[]);var qa=a(744),La=a(68);class Yb extends Ba.a{constructor(pa,zb){super();this.requests=[];this.disposed=this.n3b=!1;this.$f=()=>{if(!this.disposed){this.grid.Vb.$l(this.$f);this.n3b=!1;const Vb=this.requests;this.requests=[];for(let xc of Vb)this.ddaFacade.VJ(xc.command,
xc.properties)}};this.ddaFacade=pa;this.grid=zb}Okh(pa,zb){this.disposed||(this.n3b||(this.grid.Vb.Km(this.$f),this.n3b=!0),this.requests.push(Object(b.a)(new Ra,{command:pa,properties:zb})))}dispose(){if(!this.disposed){this.disposed=!0;this.n3b&&this.grid.Vb.$l(this.$f);var pa=this.requests;this.requests=null;for(let zb of pa)(pa=zb.properties?zb.properties[La.a.n3]:null)&&this.ddaFacade.zf(qa.a.bAb,pa);this.ddaFacade=this.grid=null;super.dispose()}}static e7g(pa,zb){var Vb=!1;974713501===pa&&(zb=
(pa=zb?zb[La.a.Pf]:null)?pa.DdaMethod:null)&&zb.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(Vb=pa.ArrayData,Vb=!!Vb&&64===(Vb[6]&64));return Vb}}Object(c.a)(Yb,"DdaCellEditDelayRequestHandler",Ba.a,[]);var mc=a(776);class Zb extends mc.a{constructor(pa,zb,Vb,xc,Sc,Jd,ye){super(pa,zb,Vb);this.messageType=0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=xc;this.messageContent=Sc;this.messageOrigin=Jd;this.targetOrigin=ye}}Object(c.a)(Zb,"DialogMessageReceivedEventArgs",
mc.a,[]);class qb extends mc.a{constructor(pa,zb,Vb,xc,Sc,Jd,ye){super(pa,zb,Vb);this.messageType=0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=xc;this.messageContent=Sc;this.messageOrigin=Jd;this.targetOrigin=ye}}Object(c.a)(qb,"DialogParentMessageReceivedEventArgs",mc.a,[]);var Ha=a(1),Ya=a(21);class Gb{constructor(pa){this.Ng=this.fZc=null;this.OWi=(zb,Vb)=>{this.handlers.hb(Vb.controlId)&&(zb=new Zb(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,Vb.controlId,
null,Vb.messageType,Vb.messageContent,Vb.messageOrigin,Vb.targetOrigin),this.handlers.ma(Vb.controlId)(zb),Vb.messageType===OSF.DialogMessageType.DialogClosed&&this.handlers.remove(Vb.controlId))};this.NWi=(zb,Vb)=>{this.jnc.hb(Vb.controlId)&&(zb=new qb(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,Vb.controlId,null,Vb.messageType,Vb.messageContent,Vb.messageOrigin,Vb.targetOrigin),this.jnc.ma(Vb.controlId)(zb))};this.handlers=new G.a;this.jnc=new G.a;this.Eg=pa;this.R1a.dOg(this.OWi);
this.R1a.cOg(this.NWi)}get R1a(){this.fZc||(this.fZc=D.getInstance(this.contextActivationMgr));return this.fZc}get contextActivationMgr(){!this.Ng&&this.Eg&&(this.Ng=this.Eg.Ng);return this.Ng}addHandler(pa,zb,Vb,xc){if(Ha.EwaSettings.ra(23))this.Eg.zf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Vb);else{e.ULS.sendTraceTag(537170502,0,50,"DialogMessageReceivedEventManager.AddHandler called!");const Sc=Jd=>{Jd===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(this.handlers.ia(pa,
zb),this.Eg.kv(Vb)):(e.ULS.sendTraceTag(537170501,0,10,"DialogMessageReceivedEventManager.AddHandler failed!"),this.Eg.zf(Jd,Vb))};this.handlers.hb(pa)?Sc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.showDialog(pa,xc,Sc)}}GJg(pa,zb,Vb){Ha.EwaSettings.ra(23)?this.Eg.zf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Vb):(e.ULS.sendTraceTag(537170500,0,50,"DialogMessageReceivedEventManager.AddMessageChildHandler called!"),this.jnc.ia(pa,zb),this.Eg.kv(Vb))}removeHandler(pa,
zb){Ha.EwaSettings.ra(23)?this.Eg.zf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,zb):this.handlers.hb(pa)?(e.ULS.sendTraceTag(537170499,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.R1a.Erb(pa,Vb=>{this.handlers.remove(pa);Vb===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?this.Eg.kv(zb):(e.ULS.sendTraceTag(537170498,0,10,"DialogMessageReceivedEventManager.RemoveHandler failed!"),this.Eg.zf(Vb,zb))})):this.Eg.zf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,
zb)}yij(pa,zb){Ha.EwaSettings.ra(23)?this.Eg.zf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,zb):(e.ULS.sendTraceTag(537170497,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.jnc.remove(pa),this.Eg.kv(zb))}showDialog(pa,zb,Vb){try{Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6254758_ExitCellEditModeDialogAPI")&&Ya.h(this.Eg.$).fb&&Ya.h(this.Eg.$).Fo(!0),this.R1a.showDialog(zb,pa,Vb,xc=>{this.Eg.VJg(this.a_g(xc))})}catch(xc){e.ULS.sendTraceTag(537170496,0,10,
`DialogMessageReceivedEventManager: show dialog failed. Exception message: ${xc.message}`),Vb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}a_g(pa){const zb={};zb.InstanceId=pa.id;zb.WebExtensionType=pa.osfControlType===OSF.OsfControlTarget.InContent?0:1;zb.PrimaryMarketplace={};zb.PrimaryMarketplace.SolutionId=pa.solutionId;zb.PrimaryMarketplace.SolutionVersion=pa.version;zb.PrimaryMarketplace.MarketplaceRef=pa.storeId;zb.PrimaryMarketplace.MarketplaceType=pa.storeType;zb.OwnerAddinSolutionId=
pa.ownerAddinSolutionId;zb.OwnerAddinStoreType=pa.ownerAddinStoreType;return zb}static ka(pa){if(!pa.$.da.Aa(232)){const zb=new Gb(pa);pa.$.da.Ha(232,zb)}}}Object(c.a)(Gb,"DialogMessageReceivedEventManager",null,[852]);class Ja{constructor(pa,zb){this.DA=null;this.mfa=pa;this.aFg=zb}U_b(pa){pa&&(this.DA||(this.DA=[]),this.DA.push(pa))}Suc(pa){this.DA&&Array.remove(this.DA,pa)}get eventId(){return this.mfa}get targetId(){return this.aFg}get ubi(){return 0<this.DA.length}WGi(pa){return this.eventId!==
pa.dispid?!1:this.eventId===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||this.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent?this.targetId===pa.ddaBinding.Name:!0}S2b(pa){this.DA&&Array.forEach(this.DA,zb=>{zb(pa)})}Wma(){this.DA=[]}}Object(c.a)(Ja,"DdaEventRegistration",null,[]);class Na{constructor(pa){this.EE=null;this.hwa=!1;this.Uc=()=>{this.EE.forEach(zb=>{zb.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&zb.S2b(new mc.a(zb.eventId,"",null))})};this.Eg=
pa}invokeDdaMethod(pa,zb){const Vb={};Vb[La.a.Pf]=pa;Vb[La.a.n3]=zb;this.Eg.VJ(974713501,Vb)}registerDdaEventAsync(pa,zb,Vb,xc,Sc){Na.PAb(pa)?(Na.Wpd(pa)&&this.nmd(),this.EE||(this.EE=[]),zb=this.ovb(pa,Vb),zb||(zb=new Ja(pa,Vb),this.EE.push(zb)),zb.U_b(xc),this.Eg.kv(Sc)):this.Eg.zf(-1,Sc)}unregisterDdaEventAsync(pa,zb,Vb,xc,Sc){Na.PAb(pa)?((pa=this.ovb(pa,Vb))&&pa.Suc(xc),this.Eg.kv(Sc)):this.Eg.zf(-1,Sc)}nmd(){this.hwa||(Ya.h(this.Eg.$).ha.UL(this.Uc),this.hwa=!0)}ovb(pa,zb){if(!this.EE)return null;
for(let Vb=0;Vb<this.EE.length;Vb++){const xc=this.EE[Vb];if(xc.eventId===pa&&xc.targetId===zb)return xc}return null}static PAb(pa){return pa===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static Wpd(pa){return pa===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}}Object(c.a)(Na,"EmbeddingPage",null,[823]);var Qa=a(182);class Oa extends mc.a{constructor(pa,zb,Vb,xc,Sc,Jd,ye,pe){super(pa,zb,Vb);this.columnCount=this.rowCount=this.startColumn=this.startRow=0;this.startColumn=Jd-xc.Reference.FirstColumn;
this.columnCount=pe;pa=Math.max(Sc,xc.Reference.FirstRow);Sc=Math.min(Sc+ye-1,xc.Reference.LastRow);pa>Sc?this.startRow=this.rowCount=void 0:(this.startRow=pa-xc.Reference.FirstRow,this.rowCount=Sc-pa+1)}getStartRow(){return this.startRow}getStartColumn(){return this.startColumn}getRowCount(){return this.rowCount}getColumnCount(){return this.columnCount}}Object(c.a)(Oa,"DdaBindingSelectionEventArgs",mc.a,[]);var bb=a(206),Ga=a(24),tb=a(41),wb=a(50),lb=a(422),db=a(33),Pa=a(37),ja=a(569),Ka=a(114),
ub=a(51),Kb=a(94),W=a(12),za=a(11),Sa=a(106);class Wa{}Wa.uzh="ewa-wx-disabled-div";Wa.tzh="ewa-wx-container-div";Wa.MSe="ewa-ptp-nov2-flex";Object(c.a)(Wa,"CssClassNames",null,[]);const ab=Wa.uzh,ma=Wa.tzh;class ha extends Qa.a{constructor(pa,zb,Vb,xc=!1){super();this.wdb=0;this.EE=null;this.hwa=!1;this.Jsc=null;this.lU=0;this.W6b=this.GVa=this.DJc=this.c5d=null;this.Hbe=!1;this.FQc=this.Gda=this.o2d=null;this.Uc=()=>{this.enabled&&(this.Vvj(),this.Jsc=tb.d(Ya.h(this.$).ha.qa.selectedRanges))};this.i$e=
Sc=>{Sc.controlId===this.Nd.InstanceId&&Array.forEach(this.EE,Jd=>{Jd.WGi(Sc)&&Jd.S2b(Sc)})};this.Azf=Sc=>{if((Sc=Object(fb.a)(231,Sc))&&!Sc.wt())if(!this.Nd||OSF.OsfControl.isFirstPartyStoreString(this.Nd.PrimaryMarketplace.MarketplaceType)||this.$.lP){Sc.$e=this.Nd;Sc.lj=this.Eg;this.o2d=Sc;this.wyc(Sc.qGa);const Jd=Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&db.a.Ad(this.$)&&za.HelperMethods.ow(this.Nd)&&this.Nd.Preload&&!this.Nd.TaskpaneVisible;Jd?Sc.ADd():
Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5550690_FixHiddenStartupStateUnderReactPaneInfra")?(Sc.ADd(),(this.Nd.SharedRuntime&&1===this.Nd.SharedRuntime.LifeTime||this.Nd.SharedRuntimeId)&&!this.Nd.TaskpaneVisible&&Sc.Kg(!1)):((this.Nd.SharedRuntime&&1===this.Nd.SharedRuntime.LifeTime||this.Nd.SharedRuntimeId)&&!this.Nd.TaskpaneVisible&&Sc.Kg(!1),Sc.ADd());this.u6a||(db.a.Ad(this.$)?Jd||Sc.q6():lb.a(this.$).result.hI(Sc,!0));this.$.da.Aa(77).SVf(this.Azf);this.W9=Object(fb.a)(263,Sc)}else e.ULS.sendTraceTag(537170464,
0,50,"Taskpane web add-in disabled by doc IRM")};this.onFloatingObjectControlAdded=(Sc,Jd)=>{3===Jd.control.floatingObject.type&&Jd.control.floatingObject.sl.InstanceId===this.X0.WebExtensionId&&(this.W9=Object(fb.a)(263,Jd.control),this.wyc(Jd.control.Hd.firstChild),Sa.a(this.$).Kuc(this.onFloatingObjectControlAdded))};this.jb=pa.$;this.Eg=pa;this.Nd=Vb;this.Nd.InstanceId=Vb.SrcLocationOverrideResourceId?pa.R3a(Vb.InstanceId,Vb.SrcLocationOverrideResourceId):Vb.InstanceId;this.vh=zb;this.X0={};this.X0.WebExtensionId=
Vb.InstanceId;this.eLf="osfControl_"+Vb.InstanceId;this.G8c="disabled_"+Vb.InstanceId;this.X0.BindingData=Vb.BindingData;this.u6a=this.Eg.u6a(Vb.InstanceId);this.Ugc=this.Eg.Ugc(Vb.InstanceId);this.gge=Vb.WebExtensionOsfControlType;this.AOf=xc}get controlId(){return this.Nd.InstanceId}qii(pa){this.Gda||(this.Gda=pa)}DVf(){this.Gda&&(this.Gda.dispose(),this.Gda=null)}get controlType(){return this.Nd.WebExtensionType}get ownerAddinSolutionId(){return this.Nd.OwnerAddinSolutionId}get $(){return this.jb}get enabled(){return!this.lU}get hy(){return this.FQc}get XT(){return this.Nd.SrcLocationOverrideResourceId?
this.Eg.R3a(this.Nd.PrimaryMarketplace.SolutionId,this.Nd.SrcLocationOverrideResourceId):this.Nd.PrimaryMarketplace.SolutionId}get sourceLocationOverrideResourceId(){return this.Nd.SrcLocationOverrideResourceId}get sl(){return this.Nd}get W9(){return this.c5d}set W9(pa){this.c5d=pa}get osfControlType(){return this.gge}get Bta(){return this.DJc}set Bta(pa){this.DJc=pa}get V6b(){return this.GVa}set V6b(pa){this.GVa=pa}get focusOnIframeWhenLoaded(){return this.Nd.FocusOnIframeWhenLoaded}get Uic(){return this.Hbe}set Uic(pa){this.Hbe=
pa}Lnd(){if(!OSF.OsfControl.isFirstPartyStoreString(this.Nd.PrimaryMarketplace.MarketplaceType)&&Ha.EwaSettings.ra(174)){const zb=wb.GetServiceTaskFactory.Oa(this.$.da,5,4,0);Pa.TaskExtensions.za(zb,()=>{zb.result.ih(36,null)},this.la,3);return this}if(1===this.Nd.WebExtensionType)Pa.TaskExtensions.za(lb.a(this.$),zb=>{zb.result.Dsb(this.$.da,77,5,this.Azf,1)},this.la,3);else{var pa=this.MXe();const zb=Sa.a(this.$);pa||(pa={Type:3},pa.Id=this.X0.WebExtensionId,pa.WebExtensionData=this.Nd,pa.ContentHtml=
"<div/>",pa.Version=0,pa.AbsoluteLeft=0,pa.AbsoluteTop=0,pa.AbsoluteRight=0,pa.AbsoluteBottom=0,pa.Width=0,pa.Height=0,pa.ZOrder=0,pa.OriginDeltaX=0,pa.OriginDeltaY=0,pa=new bb.a(pa),zb.J5b(pa,null),pa=zb.pr(pa.Fg()));pa?(this.wyc(pa.Hd.firstChild),this.W9=Object(fb.a)(263,pa)):zb.K_b(this.onFloatingObjectControlAdded)}return this}tef(pa){this.wyc(pa);return this}Yoc(){this.AOf||this.Eg.Ng.purgeOsfControl(this.controlId,!1);this.Shg(!0);const pa=this.MXe();pa&&Sa.a(this.$).deleteFloatingObject(pa);
this.Eg.Zh.gij(this.controlId);this.Eg.Zh.xPe(this.controlId,!0);this.FQc=null}MDd(pa){this.X0=pa}invokeDdaMethod(pa,zb){if(Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled){var Vb={};Vb[La.a.Pf]=pa;Vb[La.a.n3]=zb;this.Eg.VJ(974713501,Vb)}else this.Eg.zf(qa.a.bAb,zb)}xfj(pa,zb,Vb,xc){if(Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled)if(!ha.iph(pa)||void 0!==zb&&null!==zb&&void 0!==this.m3a(zb)&&null!==this.m3a(zb))if(e.ULS.sendTraceTag(36444195,
0,50,`eventId: ${pa}, targetId: ${zb}`),ha.Shf(pa)&&this.rdi(),ha.Wpd(pa)&&this.nmd(),ha.Qhf(pa))Ha.EwaSettings.ra(23)?this.Eg.zf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,xc):this.Eg.$.da.Aa(232).addHandler(this.controlId,Vb,xc,zb);else if(ha.Rhf(pa))Ha.EwaSettings.ra(23)?this.Eg.zf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,xc):this.Eg.$.da.Aa(232).GJg(this.controlId,Vb,xc);else{ha.Phf(pa)&&this.k$e(-1777565636,xc);this.EE||(this.EE=[]);var Sc=this.ovb(pa,
zb);Sc||(Sc=new Ja(pa,zb),this.EE.push(Sc));Sc.Wma();Sc.U_b(Vb);this.Eg.kv(xc);pa===OSF.DDA.EventDispId.dispidRichApiMessageEvent&&this.GVa&&(this.W6b=Vb)}else this.Eg.zf(3002,xc);else this.Eg.zf(-1,xc)}BYj(pa,zb,Vb,xc){ha.Qhf(pa)?Ha.EwaSettings.ra(23)?this.Eg.zf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,xc):this.Eg.$.da.Aa(232).removeHandler(this.controlId,xc):ha.Rhf(pa)?Ha.EwaSettings.ra(23)?this.Eg.zf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,xc):this.Eg.$.da.Aa(232).yij(this.controlId,
xc):(ha.Phf(pa)&&this.k$e(1592314317,xc),zb=this.ovb(pa,zb),this.enabled?(zb&&(zb.Suc(Vb),zb.ubi||Array.remove(this.EE,zb),this.EE.length?ha.Shf(pa)&&this.Thg(!1):this.Shg(!1)),this.Eg.kv(xc)):this.Eg.zf(-1,xc))}ka(pa){W.DOMElementExtensions.getElementById(pa,this.eLf)||pa.appendChild(W.DOMElementExtensions.vf(this.hy))}showHide(pa){W.DOMElementExtensions.setVisible(this.hy,pa)}resize(pa,zb){W.DOMElementExtensions.Jv(this.hy,pa);W.DOMElementExtensions.yI(this.hy,zb)}lMe(pa){if(!this.lU&&!W.DOMElementExtensions.getElementById(this.hy,
this.G8c)&&this.hy){const zb=document.createElement("div");zb.id=this.G8c;zb.className=ab;zb.style.backgroundImage="url("+ub.a.current.qo(102)+")";zb.style.opacity=pa?"1":"0";zb.style.backgroundRepeat="no-repeat";zb.style.backgroundPosition="center";this.hy.insertBefore(zb,this.hy.firstChild)}this.lU++}Xrh(){0<this.lU&&this.lU--;this.lU||(W.DOMElementExtensions.vf(W.DOMElementExtensions.getElementById(this.hy,this.G8c)),this.hwa&&!tb.Q(this.Jsc,Ya.h(this.$).ha.qa.selectedRanges)&&this.Uc(null,null))}m3a(pa){if(!this.X0||
!this.X0.BindingData)return null;for(let zb=0;zb<this.X0.BindingData.length;zb++)if(this.X0.BindingData[zb].Name===pa)return this.X0.BindingData[zb];return null}getDefaultIconUrl(){const pa=this.J5e();return pa?pa.getDefaultIconUrl():null}getDefaultDisplayName(){if(this.Nd.TaskpaneTitle)return this.Nd.TaskpaneTitle;const pa=this.J5e();return pa?pa.getDefaultDisplayName():null}CPf(){if(this.GVa&&this.W6b){const pa=new mc.a(OSF.DDA.EventDispId.dispidRichApiMessageEvent,this.controlId,null,this.GVa);
this.W6b(pa);this.W6b=this.GVa=null}}Kg(pa){this.o2d&&this.o2d.Kg(pa)}Wxj(){this.$.ea.isNamedObjectViewMode&&this.Dsi()&&(this.$.da.Aa(34).Vxj(this.hy),this.showHide(!1));if(this.Eg.A6j){if(!this.AOf){const pa={};pa.div=this.hy;pa.id=this.Nd.InstanceId;pa.solutionId=this.Nd.PrimaryMarketplace.SolutionId;pa.version=this.Nd.PrimaryMarketplace.SolutionVersion;pa.storeId=this.Nd.PrimaryMarketplace.MarketplaceRef;pa.storeType=this.Nd.PrimaryMarketplace.MarketplaceType;pa.ownerAddinSolutionId=this.Nd.OwnerAddinSolutionId;
pa.ownerAddinStoreType=this.Nd.OwnerAddinStoreType;this.Nd.AssetMarketplace?(pa.assetId=this.Nd.AssetMarketplace.SolutionId,pa.assetStoreId=this.Nd.AssetMarketplace.MarketplaceRef):(pa.assetId=null,pa.assetStoreId=null);pa.settings=this.Nd.OsfPropertyBag;Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5022710_EnableAgaveInitReasonControlActivation")?pa.reason=this.u6a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:this.Ugc?Microsoft.Office.WebExtension.InitializationReason.Inserted:
Microsoft.Office.WebExtension.InitializationReason.ControlActivation:pa.reason=this.u6a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:Microsoft.Office.WebExtension.InitializationReason.Inserted;pa.osfControlType=0===this.Nd.WebExtensionType?OSF.OsfControlTarget.InContent:OSF.OsfControlTarget.TaskPane;pa.isForUILessAction=4===this.Nd.WebExtensionOsfControlType;pa.sourceLocationOverrideResourceId=this.Nd.SrcLocationOverrideResourceId;pa.focusOnIframeWhenLoaded=this.Nd.FocusOnIframeWhenLoaded;
ja.a(this.Nd)&&(pa.featureGates=w.AFrameworkApplication.fa.b3e(pa.solutionId));pa.hostInfoFlags=0;this.Bta&&(pa.hostInfoFlags|=2);za.HelperMethods.ow(this.Nd)&&(pa.hostInfoFlags|=1);this.$.lP||(e.ULS.sendTraceTag(537170466,0,50,"Content web add-in disabled by doc IRM"),pa.hostInfoFlags|=4);Ha.EwaSettings.ra(553)&&(pa.hostInfoFlags|=8);Ha.EwaSettings.ra(52)&&Ha.EwaSettings.ra(92)&&!this.DJc&&(pa.virtualOsfControlActivationCallback=()=>{this.Eg.NEd(this.Nd)});pa.sharedRuntimeId=this.Nd.SharedRuntime?
this.Nd.SharedRuntime.Resid:this.Nd.SharedRuntimeId;!za.HelperMethods.ow(this.Nd)||this.Nd.Preload||ja.a(this.Nd)||this.Eg.Ng.getOsfControl(a(749).DdaFacade.getSolutionId(this.Nd,this.$))||(Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5707326_FixBackgroundAppCrashInViewMode")?this.$.isEditMode&&this.Eg.NEd(this.Nd):this.Eg.NEd(this.Nd));pa.initialDisplayMode=this.Nd.TaskpaneVisible?2:1;Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")&&(pa.titleOverride=this.sl.TaskpaneTitle);
this.Eg.Ng.insertOsfControl(pa)}this.lU=0}else this.lMe(!0)}Shg(pa){this.Thg(pa);this.kYj()}rdi(){this.wdb||this.vh.U_b(this.i$e);this.wdb++}Thg(pa){0<this.wdb&&(pa?this.wdb=0:this.wdb--,this.wdb||this.vh.Suc(this.i$e))}nmd(){if(!this.hwa){const pa=Ya.h(this.$).ha;this.Jsc=tb.d(Ya.h(this.$).ha.qa.selectedRanges);pa.UL(this.Uc);this.hwa=!0}}kYj(){this.hwa&&(Ya.h(this.$).ha.zR(this.Uc),this.hwa=!1)}Suj(pa){var zb=new Ga.Range(pa.Reference.FirstRow+1,pa.Reference.FirstColumn+1,pa.Reference.LastRow+1,
pa.Reference.LastColumn+1,!1,!1);1===pa.BindingType&&(pa.HasHeaders&&--zb.top,pa.HasTotals&&(zb.bottom+=1));var Vb=Ya.h(this.$).ha.qa.selectedRanges;pa=zb.$zb(this.Jsc);Vb=zb.$zb(Vb);return(zb=zb.we(Ya.h(this.$).ha.qa.activeRange))&&(Ka.e(pa)&&!Ka.e(Vb)||!Ka.e(pa)&&!Ka.e(Vb)&&!tb.Q(pa,Vb))?zb:null}Vvj(){Array.forEach(this.EE,pa=>{if(pa.eventId!==OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&pa.eventId!==OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||this.Eg.Zh.h1b(this.controlId))if(pa.eventId===
OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)pa.S2b(new mc.a(pa.eventId,this.controlId,null));else if(pa.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent){const zb=this.m3a(pa.targetId);if((null===zb||void 0===zb?0:zb.IsValidRef)&&(this.$.ea.isNamedObjectViewMode?this.$.yb.na.sheetName:this.$.va.na.name)===zb.Reference.SheetName){const Vb=this.Suj(zb);Vb&&pa.S2b(new Oa(pa.eventId,this.controlId,this.Eg.X1b(zb),zb,Vb.top-1,Vb.left-1,Vb.height,Vb.width))}}})}ovb(pa,zb){if(!this.EE)return null;
for(let Vb=0;Vb<this.EE.length;Vb++){const xc=this.EE[Vb];if(xc.eventId===pa&&xc.targetId===zb)return xc}return null}MXe(){const pa=Sa.a(this.$).DU;for(let zb=pa.length-1;0<=zb;--zb){const Vb=pa[zb];if(3===Vb.floatingObject.type&&Vb.floatingObject.sl.InstanceId===this.X0.WebExtensionId)return Vb}return null}Dsi(){for(let pa=0;pa<this.$.yb.count;pa++)if(this.$.yb.getItem(pa).imageId===this.X0.WebExtensionId)return!0;return!1}wyc(pa){this.FQc=pa;this.hy.id=this.eLf;this.hy.className=ma;this.hy.dir=
this.$.isChromeRtl?"rtl":"ltr";this.Wxj()}J5e(){if(!this.enabled)return null;const pa=ja.a(this.sl)?"":this.sl.PrimaryMarketplace.SolutionVersion;return OSF.OsfManifestManager.getCachedManifest(this.sl.PrimaryMarketplace.SolutionId,pa)}k$e(pa,zb){if(Ha.EwaSettings.ra(23))this.Eg.zf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,zb);else try{if(e.ULS.sendTraceTag(537170462,0,50,"HandleDialogNotificationShownInAddinEvent called!"),4!==this.gge)this.Eg.zf(OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog,
zb);else{const Vb={};Vb[Z.a.Job]=this.controlId;const xc=new Kb.a(pa,0,this.$.isEditMode?2:1,0,null);this.$.Ia.Hb(xc,Vb);this.Eg.kv(zb)}}catch(Vb){e.ULS.sendTraceTag(537170461,0,10,`HandleDialogNotificationShownInAddinEvent called. Error message: ${Vb.message}.`),this.Eg.zf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,zb)}}static iph(pa){return pa===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||pa===OSF.DDA.EventDispId.dispidBindingDataChangedEvent}static Shf(pa){return pa===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||
pa===OSF.DDA.EventDispId.dispidSettingsChangedEvent||pa===OSF.DDA.EventDispId.dispidRichApiMessageEvent}static Wpd(pa){return pa===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||pa===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static Qhf(pa){return pa===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent}static Rhf(pa){return pa===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static Phf(pa){return pa===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent}}
Object(c.a)(ha,"OsfControl",Qa.a,[851]);class eb{constructor(){this.mZa={}}add(pa){this.mZa[pa]=!0}remove(pa){delete this.mZa[pa]}clear(){for(const pa of Object.keys(this.mZa))delete this.mZa[pa]}zaf(){return 0<Object.keys(this.mZa).length}nOh(){return Object.keys(this.mZa)}}Object(c.a)(eb,"RichApiBeforeDocumentCloseNotificationRegistrationManager",null,[]);var ta=a(59);class ya{constructor(pa,zb,Vb){this.uUf=this.tUf=0;this.RMb=this.dbb=null;this.lPi=()=>{var xc=Ya.h(this.$).ha.Ra.zA;if(this.Gpd(xc)&&
(xc=this.Ewb(xc))){var Sc={};Sc.chartId=xc;Sc.worksheetId=this.xja();Sc=ta.a.Dc(Sc);this.Uia(51,xc,Sc);this.Uia(51,this.xja(),Sc)}};this.mPi=()=>{if(this.dbb){var xc={};xc.chartId=this.dbb;xc.worksheetId=this.RMb;xc=ta.a.Dc(xc);this.Uia(52,this.dbb,xc);this.Uia(52,this.RMb,xc)}xc=Ya.h(this.$).ha.Ra.zA;this.Gpd(xc)?(this.dbb=this.Ewb(xc),this.RMb=this.xja()):this.RMb=this.dbb=null};this.$=pa;this.Zh=zb;this.vh=Vb}Kpb(pa){51===pa.messageType?this.tUf=this.EGa(pa.actionType,this.tUf,this.lPi):52===pa.messageType&&
(this.uUf=this.EGa(pa.actionType,this.uUf,this.mPi))}EGa(pa,zb,Vb){if(1===pa)zb||Ya.h(this.$).ha.Ra.pXc(Vb),zb++,this.KBj();else if(2===pa){if(1>zb)return zb;1===zb&&Ya.h(this.$).ha.Ra.VLd(Vb);zb--}return zb}Uia(pa,zb,Vb){zb&&this.Zh.KQ(pa,zb)&&this.vh.GJ(pa,zb,Vb)}Ewb(pa){return pa&&pa.floatingObject?(pa=pa.floatingObject.id.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}")))&&1===pa.length?pa[0]:null:null}xja(){const pa=this.$.va.na;return pa&&0===pa.JF?pa.sheetId:null}KBj(){const pa=Ya.h(this.$).ha.Ra.zA;
this.Gpd(pa)&&(this.dbb=this.Ewb(pa),this.RMb=this.xja())}Gpd(pa){return!!pa&&!!pa.floatingObject&&0===pa.floatingObject.type}}Object(c.a)(ya,"RichApiEventChartActivatedDeactivatedHandler",null,[]);var sb=a(745),Qb=a(197),oc=a(616),kb=a(101),jb=a(349),Wb=a(55);class wc extends Ba.a{constructor(pa,zb,Vb){super();this.lU=this.Sza=0;this.Uc=(xc,Sc)=>{if(this.enabled&&!(this.Kjf()||null!==Sc&&void 0!==Sc&&Sc.enf)&&(xc=Object(fb.a)(kb.a,this.$.va.na))&&0===xc.JF){const Jd=xc.sheetId,ye=this.Z1e();let pe=
null,re=null;this.Zh.Tmf()&&(pe=this.grid.tb.Dh(this.grid.ha.qa.activeCell),re=Jd in this.Tkc?this.Tkc[Jd]:null);this.nve(Jd,ye)&&Pa.TaskExtensions.za(Wb.Task.Sa(!0),()=>{this.Rai(Jd,ye);this.Cai(Jd,ye,pe,re)},this.la);this.kNe(Jd,ye,pe)}};this.$=pa;this.Zh=zb;this.vh=Vb;this.grid=Ya.h(pa);this.ENa={};this.Tkc={}}get enabled(){return!this.lU&&0<this.Sza}D1b(pa){Object(fb.a)(jb.a,this.$.va);1===pa.actionType?(this.Sza||this.grid.ha.UL(this.Uc),this.Sza++):2!==pa.actionType||1>this.Sza||(1===this.Sza&&
this.grid.ha.zR(this.Uc),this.Sza--)}hyc(pa){pa?this.lU++:(0<this.lU&&this.lU--,this.lU||this.Uc(null,new oc.a(!1)))}Z1e(){return this.grid.ha.qa.selectedRanges}nve(pa,zb){return Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:4233860_EnableSelectionChangedEventForFirstTimeOnOpenSheet")?(!!pa&&Qb.e(this.ENa)||pa in this.ENa)&&!tb.Q(this.ENa[pa],zb):pa in this.ENa&&!tb.Q(this.ENa[pa],zb)}kNe(pa,zb,Vb){this.ENa[pa]=tb.d(zb);this.Tkc[pa]=Vb}Kjf(){return this.grid.fb||this.grid.Vh}jYe(pa,zb){this.Zh.KQ(14,
pa)&&this.vh.GJ(14,pa,zb);this.Zh.KQ(14,sb.a.RK)&&this.vh.GJ(14,sb.a.RK,zb)}Rai(pa,zb){const Vb={};Vb.worksheetId=pa;Vb.address=this.xid(zb);zb=ta.a.Dc(Vb);this.jYe(pa,zb)}Cai(pa,zb,Vb,xc){if(this.Zh.Tmf()){var Sc="";let Jd="";xc&&(Sc=xc.Hi);Vb&&(Jd=Vb.Hi);xc?Vb?(zb=Vb.usedRange.$zb(zb),Sc!==Jd&&this.qac(Sc,"",pa),this.qac(Jd,this.xid(zb),pa)):this.qac(Sc,"",pa):Vb&&(Sc=Vb.usedRange.$zb(zb),this.qac(Jd,this.xid(Sc),pa))}}qac(pa,zb,Vb){if(this.Zh.KQ(100,pa)){const xc={};xc.address=zb;xc.worksheetId=
Vb;this.vh.GJ(100,pa,ta.a.Dc(xc))}}xid(pa){return tb.i(pa,",",this.$,!1)}dispose(){0<this.Sza&&this.grid.ha.zR(this.Uc);this.Tkc=this.ENa=null;this.Sza=0;this.vh=this.Zh=this.$=this.grid=null}}Object(c.a)(wc,"RichApiEventSelectionChangedHandler",Ba.a,[]);var Jc=a(345);class zc extends wc{constructor(pa,zb,Vb){super(pa,zb,Vb);this.bpf=this.cpf=null}Z1e(){return Jc.a.Nsb(this.grid.ha.rangePicker.DK)}nve(pa,zb){return this.cpf!==pa||!tb.Q(this.bpf,zb)}kNe(pa,zb){this.cpf=pa;this.bpf=tb.d(zb)}Kjf(){return!this.grid.fb&&
!this.grid.Vh}jYe(pa,zb){this.Zh.KQ(2700,sb.a.RK)&&this.vh.GJ(2700,sb.a.RK,zb)}}Object(c.a)(zc,"RichApiEventPickedRangesChangedHandler",wc,[]);class gd{constructor(pa,zb,Vb){this.vQa=this.uQa=0;this.cHa=this.pha=null;this.ZCf=()=>{var xc=Ya.h(this.$).ha.Ra.zA;if(0<this.vQa&&this.pha&&this.cHa){var Sc={};Sc.shapeId=this.pha;Sc.worksheetId=this.cHa;Sc=ta.a.Dc(Sc);this.fireEvent(2102,this.pha,Sc)}this.uui(xc)?(this.pha=this.MWj(xc),this.cHa=this.xja(),this.pha&&this.cHa)?0<this.uQa&&(xc={},xc.shapeId=
this.pha,xc.worksheetId=this.cHa,xc=ta.a.Dc(xc),this.fireEvent(2101,this.pha,xc)):e.ULS.sendTraceTag(537170458,344,10,`Something goes wrong, we got invalid shape id: '${this.pha}', or worksheet id: '${this.cHa}' from a Floating object or gridview.`):this.cHa=this.pha=null};this.$=pa;this.Zh=zb;this.vh=Vb}Kpb(pa){const zb=Ya.h(this.$).ha;1===pa.actionType?(this.uQa||this.vQa||zb.Ra.pXc(this.ZCf),2101===pa.messageType?this.uQa++:2102===pa.messageType&&this.vQa++):2===pa.actionType&&(2101===pa.messageType?
this.uQa=0<this.uQa?this.uQa-1:0:2102===pa.messageType&&(this.vQa=0<this.vQa?this.vQa-1:0),this.uQa||this.vQa||zb.Ra.VLd(this.ZCf))}uui(pa){return!!pa&&!!pa.floatingObject&&(0===pa.floatingObject.type||7===pa.floatingObject.type||1===pa.floatingObject.type||3===pa.floatingObject.type||5===pa.floatingObject.type)}MWj(pa){if(!pa||!pa.floatingObject)return null;pa=pa.floatingObject.id;var zb=pa.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}"));zb=zb&&1===zb.length?zb[0]:null;return zb?zb:(e.ULS.sendTraceTag(537170457,
344,10,`Expect get the guid like shape id from the floating object id: '${pa}', but we failed.`),null)}xja(){const pa=this.$.va.na;return pa&&0===pa.JF?pa.sheetId:null}fireEvent(pa,zb,Vb){zb&&this.Zh.KQ(pa,zb)&&this.vh.GJ(pa,zb,Vb)}}Object(c.a)(gd,"RichApiEventShapeActivatedDeactivatedHandler",null,[]);class Va{constructor(pa,zb,Vb){this.xUf=this.wUf=this.yUf=this.vUf=0;this.M1i=(xc,Sc)=>{xc=Object(fb.a)(kb.a,Sc.na);this.j8a(xc)&&(Sc={},Sc.worksheetId=xc.sheetId,Sc=ta.a.Dc(Sc),this.Uia(11,xc.sheetId,
Sc))};this.P1i=(xc,Sc)=>{xc=Object(fb.a)(kb.a,Sc.uF);this.j8a(xc)&&(Sc={},Sc.worksheetId=xc.sheetId,Sc=ta.a.Dc(Sc),this.Uia(12,xc.sheetId,Sc))};this.N1i=(xc,Sc)=>{xc=Object(fb.a)(kb.a,Sc.na);this.j8a(xc)&&(Sc={},Sc.worksheetId=xc.sheetId,xc=ta.a.Dc(Sc),this.Uia(11,null,xc,!0))};this.O1i=(xc,Sc)=>{xc=Object(fb.a)(kb.a,Sc.uF);this.j8a(xc)&&(Sc={},Sc.worksheetId=xc.sheetId,xc=ta.a.Dc(Sc),this.Uia(12,null,xc,!0))};this.$=pa;this.Zh=zb;this.vh=Vb}Kpb(pa){11===pa.messageType?pa.targetId===sb.a.RK?this.jUg(pa.actionType):
this.iUg(pa.actionType):12===pa.messageType&&(pa.targetId===sb.a.RK?this.kUg(pa.actionType):this.lUg(pa.actionType))}iUg(pa){this.vUf=this.EGa(pa,this.vUf,this.M1i)}lUg(pa){this.yUf=this.EGa(pa,this.yUf,this.P1i)}jUg(pa){this.wUf=this.EGa(pa,this.wUf,this.N1i)}kUg(pa){this.xUf=this.EGa(pa,this.xUf,this.O1i)}EGa(pa,zb,Vb){1===pa?zb=this.OZc(zb,Vb):2===pa&&(zb=this.v8c(zb,Vb));return zb}OZc(pa,zb){pa||this.$.va.Vf(zb);pa++;return pa}v8c(pa,zb){if(1>pa)return pa;1===pa&&this.$.va.sg(zb);pa--;return pa}j8a(pa){return!!pa&&
0===pa.JF}Uia(pa,zb,Vb,xc=!1){zb=xc?sb.a.RK:zb;this.Zh.KQ(pa,zb)&&this.vh.GJ(pa,zb,Vb)}}Object(c.a)(Va,"RichApiEventSheetActivatedDeactivatedHandler",null,[]);var Eb=a(240),hc=a(14),Ab=a(227);class Bb extends Sys.EventArgs{constructor(pa,zb,Vb,xc){super();this.sheet=pa;this.x2g=zb;this.offsetX=Vb;this.offsetY=xc}}Object(c.a)(Bb,"ClickInActiveCellEventArgs",Sys.EventArgs,[]);class ec{constructor(pa,zb,Vb){this.i4b=null;this.Jtd=!1;this.onPointerDown=xc=>{let Sc;3===xc.vb?({t0a:Sc}=this.gridView.Ibc(xc.clientPoint),
this.Jtd=!!Sc&&this.gridView.ha.qa.tNe(Sc)):this.Jtd=!1;this.i4b=xc.clientPoint;return!1};this.fd=xc=>{if(this.gridView.inRangePicker||this.gridView.Vh||this.Jtd||xc.shiftKey||xc.ctrlKey||xc.Ea.button!==Sys.UI.MouseButton.leftButton||!this.i4b||!xc.clientPoint||xc.clientPoint.x!==this.i4b.x||xc.clientPoint.y!==this.i4b.y)return!1;const Sc=({t0a:xc}=this.gridView.Ibc(xc.clientPoint)).returnValue,Jd=Object(fb.a)(kb.a,this.$.va.na);if(Sc&&Jd&&0===Jd.JF){if(!this.gridView.ha.qa.W3.contains(xc))return!1;
xc=new Bb(Jd,xc,za.HelperMethods.wGd(Sc.x),za.HelperMethods.wGd(Sc.y));this.Q1i(xc)}return!1};this.$=pa;this.gridView=Ya.h(pa);this.Zh=zb;this.vh=Vb;this.Zgj()}dispose(){this.ZYj()}Zgj(){for(const pa of this.gridView.yn){const zb=pa.domElement;Eb.a.instance.ta(hc.a.pointerDown,zb,this.onPointerDown);Ab.a.instance.ta(hc.a.click,zb,this.fd)}}ZYj(){for(const pa of this.gridView.yn){const zb=pa.domElement;Eb.a.instance.Ba(hc.a.pointerDown,zb,this.onPointerDown);Ab.a.instance.Ba(hc.a.click,zb,this.fd)}}Q1i(pa){var zb=
pa.sheet;if(this.j8a(zb)){var Vb={};Vb.worksheetId=zb.sheetId;Vb.address=pa.x2g.toString();Vb.offsetX=pa.offsetX;Vb.offsetY=pa.offsetY;pa=zb.sheetId;this.Zh.KQ(21,pa)&&(zb=ta.a.Dc(Vb),this.vh.GJ(21,pa,zb));pa=sb.a.RK;this.Zh.KQ(21,pa)&&(Vb=ta.a.Dc(Vb),this.vh.GJ(21,pa,Vb))}}j8a(pa){return!!pa&&0===pa.JF}}Object(c.a)(ec,"RichApiEventSingleClickedHandler",null,[]);class Qd{constructor(pa,zb,Vb){this.rJb=0;this.Sab=this.abb=null;this.eKf=()=>{const xc=Ya.h(this.$).ha.Ra.zA;if(xc)if(this.Inf(xc)){const Sc=
this.xja();this.Qcd(Sc);this.abb=xc.floatingObject.id;this.Sab=Sc}else this.abb&&(this.Qcd(this.Sab),this.Sab=this.abb=null);else this.abb&&(this.Qcd(this.Sab),this.Sab=this.abb=null)};this.$=pa;this.Zh=zb;this.vh=Vb}D1b(pa){2E3===pa.messageType&&(1===pa.actionType?(this.rJb||Ya.h(this.$).ha.Ra.pXc(this.eKf),this.rJb++,this.cyj()):2===pa.actionType&&this.rJb&&(1===this.rJb&&Ya.h(this.$).ha.Ra.VLd(this.eKf),this.rJb--))}Qcd(pa){var zb;const Vb={};Vb.worksheetId=pa;Vb.revisionLoad=!1;if(Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5509495_SelectedVisualIdVisualSelectionChangedEventArgs")&&
(Ha.EwaSettings.ra(616)||Ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSChartPlayerManualPlacement",!1))){const xc=Ya.h(this.$).ha.Ra.zA;(null===(zb=null===xc||void 0===xc?void 0:xc.floatingObject)||void 0===zb?0:zb.Wc)?Vb.selectedVisualId=xc.floatingObject.Wc.VisualID:Vb.selectedVisualId=null}zb=ta.a.Dc(Vb);pa&&this.Zh.KQ(2E3,pa)&&this.vh.GJ(2E3,pa,zb)}xja(){const pa=this.$.va.na;return pa&&0===pa.JF?pa.sheetId:null}cyj(){const pa=Ya.h(this.$).ha.Ra.zA;this.Inf(pa)&&(this.abb=
pa.floatingObject.id,this.Sab=this.xja())}Inf(pa){return!!pa&&pa.gud()}}Object(c.a)(Qd,"RichApiEventVisualSelectionChangedHandler",null,[]);class dc{constructor(pa,zb,Vb){this.sJb=0;this.Wng=!0;this.Dac=0;this.Csd=!0;this.YBe=()=>{const xc=document.hasFocus();if(this.Wng!==xc){if(xc){const Sc=ta.a.Dc({});this.vh.GJ(2203,sb.a.RK,Sc)}this.Wng=xc}};this.ZBe=xc=>{(0<xc.timeRemaining()||xc.didTimeout)&&this.YBe();window.requestIdleCallback(this.ZBe)};this.$=pa;this.Zh=zb;this.vh=Vb;window.requestIdleCallback||
(this.Csd=!1)}hUg(pa){1===pa.actionType?(this.sJb||this.AUg(),this.sJb++):2!==pa.actionType||1>this.sJb||(1===this.sJb&&this.Xlh(),this.sJb--)}AUg(){if(this.Zh.KQ(2203,sb.a.RK))if(this.Csd){const pa={};pa.timeout=this.$.ya.CheckFocusTimeout;this.Dac=window.requestIdleCallback(this.ZBe,pa)}else this.Dac=window.setInterval(this.YBe,this.$.ya.CheckFocusTimeInterval)}Xlh(){this.Csd?window.cancelIdleCallback(this.Dac):window.clearInterval(this.Dac)}}Object(c.a)(dc,"RichApiEventWorkbookActivatedHandler",
null,[]);var dd;(function(pa){pa[pa.none=0]="none";pa[pa.registerEvent=1]="registerEvent";pa[pa.unregisterEvent=2]="unregisterEvent";pa[pa.customFunction=3]="customFunction";pa[pa.showCard=4]="showCard";pa[pa.createWorkbook=5]="createWorkbook";pa[pa.openWorkbook=6]="openWorkbook";pa[pa.enableEvents=7]="enableEvents";pa[pa.closeWorkbook=8]="closeWorkbook";pa[pa.setCalculationMode=9]="setCalculationMode";pa[pa.workbookLinksRequestRefresh=10]="workbookLinksRequestRefresh";pa[pa.workbookLinksRequestRefreshAll=
11]="workbookLinksRequestRefreshAll";pa[pa.workbookLinksEnableContent=12]="workbookLinksEnableContent";pa[pa.workbookLinksFindNextLink=13]="workbookLinksFindNextLink";pa[pa.workbookLinksOpenWorkbook=14]="workbookLinksOpenWorkbook";pa[pa.rangePicker=15]="rangePicker";pa[pa.enableRichApiRecording=16]="enableRichApiRecording";pa[pa.recordAction=17]="recordAction";pa[pa.focus=18]="focus";pa[pa.businessBarShow=19]="businessBarShow";pa[pa.businessBarHide=20]="businessBarHide";pa[pa.augmentationLoopActivateAnnotation=
21]="augmentationLoopActivateAnnotation";pa[pa.augmentationLoopSubmitSignal=22]="augmentationLoopSubmitSignal";pa[pa.showRangeValuesPreview=23]="showRangeValuesPreview";pa[pa.hideRangeValuesPreview=24]="hideRangeValuesPreview"})(dd||(dd={}));Object(c.b)("PostProcessActionType",dd);var jd=a(252);class md{constructor(pa,zb,Vb){this.fLf=null;this.Ocd=(xc,Sc)=>{const Jd=sb.a.RK,ye={};ye.eventId=xc;ye.payload=Sc;this.Zh.KQ(2201,Jd)&&this.vh.GJ(2201,Jd,ta.a.Dc(ye))};this.$=pa;this.Zh=zb;this.vh=Vb;this.Shi()}gUg(pa){1===
pa.actionType?(this.$.zba=!0,Object(fb.a)(a(749).DdaFacade,jd.a(this.$)).Pcd(!0)):2===pa.actionType&&(this.$.zba=!1);this.fLf=pa.controlId;e.ULS.sendTraceTag(537170456,0,50,`AttachOrDetachMacroRecorderEventHandler: actionType: ${dd[pa.actionType]}; controlId: ${this.fLf}; this.ewaControl.IsMacroRecorderListening: ${this.$.zba}.`)}hth(pa){Object(fb.a)(a(749).DdaFacade,jd.a(this.$)).mYe(pa,this.$.zba)}Shi(){this.$.NQ&&Pa.TaskExtensions.za(wb.GetServiceTaskFactory.Oa(this.$.da,297,298,1),pa=>{(pa=pa.result)&&
pa.init(this.Ocd)},this.$.la,3)}}Object(c.a)(md,"RichApiMacroRecorderEventHandler",null,[]);class vd{constructor(pa){this.values=this.sB=void 0;this.bPa=(zb,Vb)=>{0===Vb.Iq&&this.F5a()};this.$=pa;this.gridView=Ya.h(this.$)}vai(pa,zb,Vb){this.klf(pa)?(pa=this.D0g(zb,Vb))?(this.F5a(),this.sB=pa,this.values=Vb,this.$na()):e.ULS.sendTraceTag(509384200,0,10,"DdaRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: failed to calculate range"):e.ULS.sendTraceTag(509384201,0,50,"DdaRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: not showing the preview, desired worksheet not active")}M9h(pa){this.klf(pa)&&
this.F5a()}$na(){this.tNf(void 0);this.dVd=this.gridView.JN.$na(this.sB,pa=>{this.d1h(pa)}).then(pa=>{e.ULS.sendTraceTag(509384199,0,50,"DdaRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: preview shown");this.VPa=pa;this.$.userOperationManager.Zq(this.bPa);return Promise.resolve()},pa=>{e.ULS.sendTraceTag(509384198,0,10,`DdaRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: failed to show preview, rejectionString = ${pa}`);return Promise.resolve()})}F5a(){this.dVd&&
this.dVd.then(()=>{this.VPa&&this.VPa.kka("DdaRangeValuesPreview");this.$.userOperationManager.Un(this.bPa);this.VPa=null;this.values=this.sB=void 0;this.dVd=null},()=>{e.ULS.sendTraceTag(509383618,0,10,"DdaRangeValuesPreview.hidePreview: unexpected rejection of this.showPromise")})}d1h(pa){pa=pa.Xc.block;this.sB.we(pa.De)&&this.tNf(pa.De)}D0g(pa,zb){pa=tb.Y(pa,this.$.va);if(pa.returnValue)return new Ga.Range(pa.range.top,pa.range.left,pa.range.top+zb.length-1,pa.range.left+zb[0].length-1,!0,!0)}klf(pa){const zb=
this.$.va.na;return zb&&pa===zb.sheetId}tNf(pa){for(let Vb=0;Vb<this.values.length;++Vb)for(let xc=0;xc<this.values[Vb].length;++xc){var zb=Ga.Range.Mc(this.sB.top+Vb,this.sB.left+xc);if(pa&&!pa.contains(zb))continue;const Sc=this.gridView.ov(zb);if(!Sc||zb.equals(Sc.topLeft))if(zb=this.gridView.Pb(zb))zb.cell.Msc=this.values[Vb][xc]}}}Object(c.a)(vd,"RichApiRangeValuesPreview",null,[]);class wd{}Object(c.a)(wd,"SessionRecreationInfo",null,[]);class Pd{constructor(pa,zb,Vb){this.$=pa;this.Zh=zb;this.runtimeCalculationMode=
Vb}NKi(){return Ha.EwaSettings.ra(234)?this.Zh.Gbi()||0!==this.runtimeCalculationMode:!1}mZg(){var pa={};pa.eventRegistrationInfos=this.Zh.HUh();pa.runtimeCalculationMode=this.runtimeCalculationMode;pa=Object(b.a)(new wd,{runtimeState:pa});const zb={HttpMethod:"POST",PathAndQuery:"RestoreRuntimeState",RequestHeaders:null};zb.RequestBody=JSON.stringify(pa);zb.RequestFlags=1;return zb}}Object(c.a)(Pd,"RichApiRuntimeStateHandler",null,[]);class ic{constructor(pa,zb,Vb,xc,Sc,Jd,ye,pe,re){this.dequeueUtcTime=
this.processUtcTime=this.enqueueUtcTime=null;this.operationCount=this.executionDurationInMS=this.inQueueDurationInMS=0;this.UserOperationName=this.ServerCorrelationId=null;this.IsDocumentHidden=!1;this.enqueueUtcTime=pa;this.processUtcTime=zb;this.dequeueUtcTime=Vb;this.inQueueDurationInMS=xc;this.executionDurationInMS=Sc;this.operationCount=Jd;this.ServerCorrelationId=ye;this.UserOperationName=pe;this.IsDocumentHidden=re}}Object(c.a)(ic,"UserOperationQueueItemsStatisticsData",null,[]);var cd=a(330),
Hd=a(31),he=a(19),Lb=a(295),Ic=a(49),Ob=a(598),Kc=a(65),Ac=a(56),Yc=a(74);class td extends cd.a{constructor(pa,zb,Vb){super(Vb,pa);this.Lva=this.hashCode=null;this.h5b=!1;this.Tm=(xc,Sc)=>{Sc.Xc.hash===this.hashCode&&this.Lva&&Object(fb.a)(a(749).DdaFacade,this.$.da.Aa(35)).gJj(this.Lva.InstanceId)};this.nf=(xc,Sc)=>{switch(Sc.Xc.block.state){case 1:case 3:case 5:this.Tda(Sc)}};this.vj=()=>{this.MIb(!0)};this.yo=(xc,Sc)=>{this.isVisible&&this.bUa(Sc.uF);this.clearCache()};this.Ud=(xc,Sc)=>{this.cTa(Sc.na,
!!Sc.uF)};this.vN=()=>{this.$.ea.tma()};this.GUa=zb;this.domElement.classList.add(Hd.a.d$b);this.domElement.classList.add(he.a.jo);Vb.tabIndex=0;this.cTa(this.$.na,!1);this.Cc.ka("mousedown",this.vN);this.Cc.ka("contextmenu",xc=>{Yc.g(xc)});this.$.va.aJ(this.yo);this.$.yb.aJ(this.yo);this.$.yb.Vf(this.Ud);this.$.va.Vf(this.Ud);this.Ca.Ns(this.nf);this.Ca.zG(this.Tm);this.Ca.Tv(this.vj);this.Uu(this.Aya)}get Ca(){return this.GUa}dispose(){this.$&&(this.$.va.KK(this.yo),this.$.yb.KK(this.yo),this.$.yb.sg(this.Ud),
this.$.va.sg(this.Ud));this.GUa&&(this.GUa.Kq(this.nf),this.GUa.aI(this.Tm),this.GUa.Nw(this.vj));this.my(this.Aya);this.clearCache();ka.a.Ja(this.GUa);this.GUa=null;W.DOMElementExtensions.vf(this.domElement);super.dispose()}Vxj(pa){W.DOMElementExtensions.vf(W.DOMElementExtensions.getElementById(this.domElement,pa.id));this.domElement.appendChild(pa)}Ynd(){if(this.Lva&&!this.h5b){var pa=Object(fb.a)(a(749).DdaFacade,jd.a(this.$)).pn(this.Lva.InstanceId);pa&&(pa.resize(this.Lva.Width,this.Lva.Height),
pa.ka(this.domElement),pa.showHide(!0),this.h5b=!0)}}l8a(){return!0}Tda(pa){this.Lva=pa.Xc.block.Wd;this.h5b=!1;this.Ynd()}bUa(pa){this.$.ea.H4&&pa&&(pa.Ju||(pa.Ju=new Lb.a),pa.Ju.ki=new Ic.a(this.domElement.scrollLeft,this.domElement.scrollTop),pa.Ju.hIb=20)}clearCache(){this.Ca.BQa(this.hashCode);this.Lva=this.hashCode=null;this.h5b=!1}cTa(pa,zb){if(this.isVisible=!!pa&&Kc.o(pa))this.hashCode=this.Ca.Rra(pa,Ac.a.k7b,this.hashCode),this.Lyc(zb)}static FGa(pa){if(!pa.da.Aa(34)){const zb=pa.rf;pa.da.Ha(34,
new td(pa,new Ob.a(pa,pa.ea,pa.oa.Ok,3,0),zb.appendChild(zb.ownerDocument.createElement("div"))))}}}Object(c.a)(td,"WebExtensionView",cd.a,[850,524,2]);var $d=a(229),be=a(376),ke=a(441),Pe=a(193),Dd=a(60),ge=a(113),ne=a(48),ce=a(44),we=a(158),ve=a(112),Re=a(69),rf=a(28),We=a(29),Ye=a(249),bf=a(22),Ve=a(13),Za=a(282),Xb=a(753),ib=a(52),Rb=a(151),lc=a(882);const nc=pa=>{Rb.a.sendOtelEvent(Object.assign(new lc.a,{otelEvent:pa}))},Oc=pa=>{Rb.a.sendOtelCustomerContent(Object.assign(new lc.a,{otelEvent:pa}))};
var Ib=a(175),gc=a(881),Fc=a(25),Vc=a(161),ed=a(730);class Sd{constructor(pa,zb,Vb){this.Ytc=0;this.xne=new Set;this.$=pa;this.Zh=zb;this.vh=Vb}fUg(pa){1===pa.actionType?this.Zh.KQ(65541,sb.a.RK)?this.Ytc++:e.ULS.sendTraceTag(509649754,0,10,"AugmentationLoop AnnotationAdded event is not registered"):2===pa.actionType&&0<this.Ytc&&this.Ytc--}dOi(pa,zb){if(0===this.Ytc)e.ULS.sendTraceTag(509649753,0,50,"No event listeners. Event not fired.");else if(zb){pa=zb.BG;var Vb=[];Vb.push({content:JSON.stringify(zb.BG),
annotationType:ed.a.Hva(pa),id:pa.id});this.vh.GJ(65541,sb.a.RK,JSON.stringify({U8j:Vb}))}else e.ULS.sendTraceTag(509649752,0,10,"Event args are null")}K8h(pa){return Object(Vc.a)(this,void 0,void 0,function*(){if(!this.Zh.KQ(65541,sb.a.RK))e.ULS.sendTraceTag(509649751,0,10,"Event is not registered");else if(!this.xne.has(pa.annotationType)){var zb=yield wb.GetServiceTaskFactory.c4(this.$.da,328,327,1);zb.yYa(pa.annotationType);zb.g2(pa.annotationType,this.dOi.bind(this));this.xne.add(pa.annotationType)}})}L8h(pa){return Object(Vc.a)(this,
void 0,void 0,function*(){(yield wb.GetServiceTaskFactory.c4(this.$.da,328,327,1)).mOb(JSON.parse(pa.content));e.ULS.sendTraceTag(509649750,0,100,`Submit operation for type: ${pa.signalType}`)})}}Object(c.a)(Sd,"RichApiAugmentationLoopHandler",null,[]);a.d(F,"DdaFacade",function(){return Zd});class Zd extends X.a{constructor(pa,zb){super();this.vh=this.Gl=this.ea=null;this.uf=[];this.aJa=null;this.disposed=this.initialized=this.iRb=this.OJe=!1;this.mCa=null;this.Zqc=[];this.IJe=[];this.FPa=[];this.G1a=
null;this.nGd=new Ca.a(M.a.Oi());this.l0b=new N.a(M.a.Oi());this.PHb=[];this.CMf=[];this.r7b=350;this.rxa=this.Wea=null;this.mVc=!1;this.spa=this.tkb=this.Die=this.Cie=this.sie=this.Bie=this.Aie=this.yie=this.uie=this.zie=this.vie=this.xie=this.tie=this.wie=null;this.tf=()=>{this.mCa=this.ea.Qn.WebExtensions;for(var Vb=this.uf.length-1;0<=Vb;--Vb){var xc=this.uf[Vb],Sc;if(Sc=!this.RHh(xc.controlId))Sc=xc,Sc=Ha.EwaSettings.ra(114)?!Sc.Bta:!0;Sc&&(xc.Yoc(),this.uf.splice(Vb,1))}if(this.mCa)for(let Jd=
0,ye=this.mCa.length;Jd<ye;Jd++)Vb=this.mCa[Jd],(xc=this.pn(Vb.WebExtensionId))&&xc.MDd(Vb)};this.aqc=Vb=>{this.raiseEvent("csc",Vb.getID())};this.bqc=(Vb,xc,Sc)=>{if(xc===OSF.AgaveHostAction.KeyboardShortcuts){var Jd=Object(fb.a)(Object,Sc);xc={};xc.keyCode=Jd.keyCode;xc.type="keydown";xc.ctrlKey=Jd.ctrlKey;xc.shiftKey=Jd.shiftKey;xc.altKey=Jd.altKey;xc.metaKey=Jd.metaKey;Jd=this.pn(Vb);Vb=Jd.W9;xc.srcElement=Object(yb.a)(231,Vb)?Vb.qGa:Ya.h(this.$).jc;Vb=new Sys.UI.DomEvent(xc);Jd=Zd.Xua(Jd.sl,
this.$);xc={};xc.focusedAddinId=Jd;Jd=new Kb.a(1461300262,1,this.$.xc,6,null);Ya.h(this.$).cLb(Vb,Jd,xc)}else if(xc===OSF.AgaveHostAction.Select)this.X9e(!0);else if(xc===OSF.AgaveHostAction.UnSelect)this.X9e(!1);else if(xc===OSF.AgaveHostAction.CancelDialog)this.VJ(-684355545,null);else if(xc===OSF.AgaveHostAction.InsertAgave)Vb={},Sc&&(this.tkb=Sc,Vb[Z.a.D9]=Sc,Vb[La.a.Pf]=Zd.nta(Sc),this.VJ(-741808261,Vb));else if(xc===OSF.AgaveHostAction.ClickTrust)this.sYc&&Sc&&(this.tkb=Sc);else if(xc===OSF.AgaveHostAction.OsfControlLoad)this.sYc&&
this.tkb&&Sc&&this.jTg(this.tkb,Sc)&&Sc.storeType&&(this.tkb=null,this.uR(xa.b(Sc.storeType)));else if(xc===OSF.AgaveHostAction.InsertDevManifest)Vb={},Sc&&(Vb[Z.a.D9]=Sc,Vb[La.a.Pf]=Zd.nta(Sc),this.VJ(-741808261,Vb));else if(xc===OSF.AgaveHostAction.InsertDevManifestError)Vb=Object(fb.a)(Object,Sc),Vb={[Z.a.cYc]:this.Gl.getDevManifestInvalidUrlErrorString(Vb.manifestUrl)},this.VJ(-2025863019,Vb);else if(xc===OSF.AgaveHostAction.NotifyHostError)Vb={[Z.a.cYc]:this.Gl.getManifestInvaildErrorString()},
this.VJ(-2025863019,Vb);else if(xc===OSF.AgaveHostAction.RefreshAddinCommands)Ha.EwaSettings.ra(52)&&this.VJ(Fc.a.refreshAddinCommands,null);else if(xc===OSF.AgaveHostAction.CtrlF6Exit||xc===OSF.AgaveHostAction.CtrlF6ExitShift){if(Jd=this.$.da.Aa(15)){(Vb=this.pn(Vb).W9)&&Vb.YAc();u.a.Cf&&document.activeElement.blur();var ye={keyCode:117,type:"keydown",ctrlKey:!0};ye.shiftKey=xc===OSF.AgaveHostAction.CtrlF6ExitShift;ye.srcElement=Object(yb.a)(231,Vb)?Vb.qGa:Ya.h(this.$).jc;Vb=new Sys.UI.DomEvent(ye);
Jd.kma(Vb)}}else if(xc===OSF.AgaveHostAction.PageIsReady){if((Vb=this.pn(Vb).W9)&&Vb.tZa===OSF.OsfControlTarget.TaskPane&&(Vb=this.$.da.Aa(183))&&this.uf){xc=db.a.Ad(this.$);for(Jd of this.uf)Zd.nMa(Jd.XT)&&(xc?Vb.ag(!0,!1):Vb.setFocusOnToolbarFirstElement())}}else if(xc===OSF.AgaveHostAction.TabExit){xc=this.pn(Vb);const He=xc.W9;if(He)if(He.tZa===OSF.OsfControlTarget.InContent)He.Hof();else{if(He.tZa===OSF.OsfControlTarget.TaskPane)if(db.a.Ad(this.$))u.a.Cf&&document.activeElement.blur(),Da.UISurfaces.dj().then(ze=>
{const ef=Object(yb.a)(231,He)?He:null;ef?ef.isResizable?ze.focusResizeHandle():ze.focusTabbedTaskPaneArea():ze.focusTabbedTaskPaneArea();return null});else if(xc=this.$.da.Aa(183))u.a.Cf&&document.activeElement.blur(),(Vb=document.getElementById(this.$.Bb+R.a.eoc))&&W.DOMElementExtensions.isVisible(Vb)?W.DOMElementExtensions.setFocus(Vb):xc.setFocusOnToolbarFirstElement()}else xc&&4===xc.osfControlType&&this.Gl.notifyAgave(Vb,OSF.AgaveHostAction.TabIn)}else if(xc===OSF.AgaveHostAction.TabExitShift)(xc=
this.pn(Vb),Jd=xc.W9)?Jd.tZa===OSF.OsfControlTarget.InContent?Jd.Iof():Jd.tZa===OSF.OsfControlTarget.TaskPane&&(Vb=Object(yb.a)(231,Jd)?Jd:null)&&(u.a.Cf&&document.activeElement.blur(),Vb.T4f()):xc&&4===xc.osfControlType&&this.Gl.notifyAgave(Vb,OSF.AgaveHostAction.TabIn);else if(xc===OSF.AgaveHostAction.EscExit||xc===OSF.AgaveHostAction.ExitNoFocusable||xc===OSF.AgaveHostAction.ExitNoFocusableShift)if(Jd=this.pn(Vb).W9)Jd.YAc();else{if(xc===OSF.AgaveHostAction.EscExit){xc=null;for(ye of D.i7h())if(ye.value.pe===
Vb){ye.value.dialog.hide();xc=ye.key;break}xc&&(Vb=this.pn(xc))&&4!==Vb.osfControlType&&this.Ng.notifyAgave(xc,OSF.AgaveHostAction.TabIn)}}else if(xc===OSF.AgaveHostAction.InstallCustomFunctions)if(Ha.EwaSettings.ra(114)){Re.a(this.$).uZe(()=>!1);var pe=this.$.da;Pa.TaskExtensions.za(wb.GetServiceTaskFactory.Oa(pe,278,279,1),He=>{He=He.result;pe.Aa(278)||pe.Ha(278,He);const ze=Sc.osfControl.getStoreType();He.wff(Sc.osfControl.getSolutionId(),ze,Zd.WSh(Sc.osfControl),Sc).ona()},this.la,3)}else e.ULS.sendTraceTag(537170577,
0,10,"DdaFacade.OnOsfNotifyHost: Cannot install Custom Functions because this feature is not enabled.");else if(xc===OSF.AgaveHostAction.UninstallCustomFunctions)if(Ha.EwaSettings.ra(114)){Re.a(this.$).uZe(()=>!1);var re=this.$.da;Pa.TaskExtensions.za(wb.GetServiceTaskFactory.Oa(re,278,279,1),He=>{He=He.result;re.Aa(278)||re.Ha(278,He);He.Vhg(Sc.solutionId,Sc.storeType).ona()},this.la,3)}else e.ULS.sendTraceTag(537170574,0,10,"DdaFacade.OnOsfNotifyHost: Cannot uninstall Custom Functions because this feature is not enabled.");
else xc===OSF.AgaveHostAction.SendTelemetryEvent?nc(Sc):xc===OSF.AgaveHostAction.SendCustomerContent?Oc(Sc):xc===OSF.AgaveHostAction.LaunchExtensionComponent?f.a.instance.Zyi(Sc):xc===OSF.AgaveHostAction.RefreshRibbonGallery?(Vb=this.$.da.Aa(519))&&Vb.Skd(Sc):xc===OSF.AgaveHostAction.RemoveAppCommandsAddin?(this.Eij(Sc.solutionId),db.a.Ad(this.$)||(Vb=this.$.da.Aa(183))&&Vb.HB(),Ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&w.AFrameworkApplication.rb.Vd(Fc.a.PUf,
2,Sc.solutionId)):xc===OSF.AgaveHostAction.GetOriginalControlId&&(Vb=new ia.a(this.$.Bb,Sc.ownerAddinSolutionId,new wa.a,!0),Sc.originalControlId=Vb?Vb.aKe(Sc.controlId):Sc.controlId)};this.Wvj=(Vb,xc)=>{const Sc=Array(2);Sc[0]=xc;Sc[1]=null;this.vh.aIh(Vb,JSON.stringify(Sc))};this.v1i=()=>{this.$.na&&Kc.o(this.$.na)&&this.$.da.Aa(34).Ynd()};this.dd=()=>{this.Jqf()};this.lR=(Vb,xc)=>{var Sc,Jd;1===xc.Iq&&(Vb=xc.Lf)&&(xc=new ic(ve.toTimestamp(Vb.enqueueUtcTime),ve.toTimestamp(Vb.processUtcTime),ve.toTimestamp(Vb.dequeueUtcTime),
ve.getElapsedMilliseconds(Vb.enqueueUtcTime,Vb.processUtcTime),ve.getElapsedMilliseconds(Vb.processUtcTime,Vb.dequeueUtcTime),Vb.operationCount,(null===(Jd=null===(Sc=Vb.operation)||void 0===Sc?void 0:Sc.od)||void 0===Jd?0:Jd.ServerCorrelationId)?Vb.operation.od.ServerCorrelationId:null,Vb.operation?Enum.toString(ke.a,Vb.operation.operationName):null,Xb.a.rH(ve.getElapsedMilliseconds(Vb.enqueueUtcTime,rf.a.Ya.Ub))),Sc=Sys.Serialization.JavaScriptSerializer.serialize(xc),e.ULS.sendTraceTag(50872916,
0,50,Sc))};this.Rc=(Vb,xc)=>{!this.ea.Xb&&$d.a(xc)?(Array.forEach(this.uf,this.NBf),this.uf.length=0,this.iRb=!1):(xc.oH&&(e.ULS.sendTraceTag(537170516,0,50,"Silent Reload require reset osf controls."),this.wZf()),this.PK(),Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:4058224_ResetWorkbookContextLoadedAfterSilentReload")&&(this.iRb=!1))};this.Ao=()=>{Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(e.ULS.sendTraceTag(537170515,0,50,"Load on demand occurred require reset osf controls."),
this.wZf());this.PK();Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(this.iRb=!1)};this.NBf=Vb=>{Vb.Yoc();this.raiseEvent("cd",Vb.controlId)};this.jb=pa;this.vYc=zb;this.initialize();Gb.ka(this);this.A_f=0;(pa=(pa=!(u.a.fp||u.a.Bba))&&(!Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5763473_DisableAddinKeyboardShortcutsInFirefox")||!u.a.Cf))&&OfficeExt.ShortcutKeyDispatchManager.init();this.Byg={}}get o1b(){return this.Wea||(this.Wea=new fa.a(this.$.eu))}xqe(pa){this.addHandler("cd",
pa)}Fjj(pa){this.removeHandler("cd",pa)}tMg(pa){this.addHandler("csc",pa)}Hjj(pa){this.removeHandler("csc",pa)}qMg(pa){this.addHandler("ca",pa)}Ejj(pa){this.removeHandler("ca",pa)}rMg(pa){this.addHandler("ci",pa)}sMg(pa){this.addHandler("ekros",pa)}Gjj(pa){this.removeHandler("ekros",pa)}QFd(pa,zb){try{return JSON.parse(pa)[zb].toLowerCase()}catch(Vb){return""}}AEj(pa){const zb=this.QFd(pa,"AudienceGroup"),Vb=this.QFd(pa,"SessionOrigin");try{const xc=parseInt(this.QFd(pa,"Ring"),10);if("automation"!==
zb&&"bluechicken"!==Vb&&-2<=xc)return!0}catch(xc){if("automation"!==zb&&"bluechicken"!==Vb)return!0}return!1}get Ng(){if(!this.Gl){const pa={},zb=!(this.$.qd&1),Vb=ub.a.current.EK,xc=this.$.workbookContext,Sc=ua.a.fL+ua.a.E4b;pa.pageBaseUrl=Vb.LayoutsContentUrlPrefix;pa.appName=OSF.AppName.ExcelWebApp;pa.appVersion="16";pa.appSettings=this.TWh();pa.singleSignOnSettings=E.AppsForOfficeSingleSignOnManager.M3h();pa.clientMode=zb?OSF.ClientMode.ReadOnly:OSF.ClientMode.ReadWrite;pa.appUILocale=this.$.ya.UICultureTag;
pa.dataLocale=this.$.ya.DataCultureTag;pa.docUrl=xc.ClientUrl;pa.hostControl=this;pa.formFactor=OSF.FormFactor.Default;pa.lcid=this.$.WF.toString();pa.localizedScriptsUrl=ua.a.fL+ua.a.X3c;pa.localizedImagesUrl=Sc;pa.localizedStylesUrl=ua.a.fL+ua.a.aFe;pa.localizedResourcesUrl=Sc;pa.osfOmexBaseUrl=Vb.OsfOmexBaseUrl;pa.firstPartyManifestCDNUrl=Vb.FirstPartyAddInManifestCDN;pa.sdxAssetsToPrefetchMapping=w.AFrameworkApplication.fa.Wa("SdxAssetsToPrefetchMapping");pa.sdxCdnUrl=Vb.SdxCdnUrl;pa.sdxDmsUrl=
Vb.SdxDmsUrl;pa.devCatalogUrl=Vb.DevCatalogUrl;pa.controlStatusChanged=this.aqc;pa.notifyHost=this.bqc;pa.allowExternalMarketplace=this.$.ea.wg.get(27)&&Zd.p5b;pa.enableAddinCommands=Ha.EwaSettings.ra(52);pa.enableBlackForestRedirect=Ha.EwaSettings.ra(87);pa.enableMyOrg=this.$.ea.wg.get(33);pa.enableMyApps=this.$.ea.wg.get(34);pa.enableDevCatalog=Ha.EwaSettings.ra(43);pa.enablePrivateCatalog=this.wFj();pa.enableTaskpaneUpgradeToAppCommand=Ha.EwaSettings.ra(92);pa.showSignOutFromPrivateCatalogMessage=
this.$.ea.wg.get(36);pa.enableUploadFileDevCatalog=Ha.EwaSettings.ra(52)&&!Ha.EwaSettings.ra(254);pa.userNameHashCode=U.a.Yu(w.AFrameworkApplication.userName);pa.envCode=this.$.ya.OfficeAddinTelemetryDataSourceCode.toString();pa.enableSingleSignOnForAddin=!Ha.EwaSettings.ra(23)&&w.AFrameworkApplication.isAppsForOfficeSingleSignOnSupportedOnHost;pa.enableDisplayBlockedMinorError=Ha.EwaSettings.ra(171);pa.hideAppsExtensionUrl=w.AFrameworkApplication.hideAppsExtensionUrl;pa.enableAnonymousUseLegacyCatalogService=
Ha.EwaSettings.ra(162);pa.enableInsertDialogAccessibilityFix=Ha.EwaSettings.ra(169);pa.disableAppsForOfficeThirdParty=Ha.EwaSettings.ra(174);pa.enableFirstPartySSO=Ha.EwaSettings.ra(186);pa.wacSessionId=this.$.ya.UserSessionId;pa.disableLogging=!this.$.ya.AriaLoggingIsEnabled;pa.enableFirstPartySDXErrorMessages=Ha.EwaSettings.ra(198);pa.enableRichApiCellEditDelay=Ha.EwaSettings.ra(178);pa.isHostDocumentDomain=Ha.EwaSettings.ra(209);pa.loggableUserId=w.AFrameworkApplication.fa.Wa("LoggableUserId");
pa.sessionStartInfoJson=w.AFrameworkApplication.fa.Wa("SessionStartInfoJson");pa.wopiHostOriginFromPostMessage=w.AFrameworkApplication.wopiHostOriginFromPostMessage;pa.wopiHostOriginFromWacPropBag=w.AFrameworkApplication.fa.Wa("PostMessageOrigin");pa.wacIsEmbedded=w.AFrameworkApplication.fa.pa("IsEmbedded");pa.accessibilityAllowFocusAddinTaskpane=w.AFrameworkApplication.fa.pa("AccessibilityAllowFocusAddinTaskpane");pa.enableRemoveAppCommandsAddin=w.AFrameworkApplication.fa.pa("RemoveAppCommandsAddinIsEnabled");
pa.isHostFrameTrustCheckEnabledForAddIns=w.AFrameworkApplication.fa.pa("HostFrameTrustCheckIsEnabledForAddIns");pa.isHostFrameTrusted=w.AFrameworkApplication.isHostFrameTrusted;pa.agaveAddinUploadEnabled=Ha.EwaSettings.ra(45);pa.hostAllowedOfficeStore=w.AFrameworkApplication.fa.pa("HostAllowedOfficeStore");pa.hostAllowedSdxEmbedding=w.AFrameworkApplication.fa.pa("HostAllowedSdxEmbedding");pa.hostInstallAddIns=w.AFrameworkApplication.fa.Wa("HostInstallAddIns");pa.hostInstallAddInsIsEnabled=w.AFrameworkApplication.fa.pa("HostInstallAddInsIsEnabled");
pa.approvedAddIns=w.AFrameworkApplication.fa.Wa("ApprovedAddIns");pa.addinEnforceHttpsIsEnabled=this.AEj(pa.sessionStartInfoJson);pa.hostFeatureGateFlag=0;pa.isUpnCheckEnabled=w.AFrameworkApplication.fa.pa("IsUpnCheckEnabled");pa.wacUpn=w.AFrameworkApplication.fa.Wa("UserPrincipalName");pa.isReactRibbonEnabled=db.a.isReactRibbonEnabled();pa.enableSetFocusOnTaskpaneOnUserAction=Ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);pa.isSafariWithIndexedDBDisabled=
Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&u.a.ZMa;pa.isIndexedDBDisabled=Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&u.a.ZMa||Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5735286_IDBBuggedInFirefox")&&u.a.Cf;pa.enableCustomShortcuts=!0;pa.changeGetModifierKeyStringOutputOrder=Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5426302_ChangeGetModifierKeyStringOutputOrder");pa.officeJsUrl=w.AFrameworkApplication.$N("OfficeJs/excel.js",5);
pa.enableOfficeJsUrlParam=Ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableOfficeJsUrlParam",!1);this.Gl=new OSF.ContextActivationManager(pa);this.Gl.setIframeAttributeBag({["frameborder"]:0,["marginheight"]:0,["marginwidth"]:0});this.Gl.setWSA(w.AFrameworkApplication.Gn);this.Gl&&"undefined"!==typeof this.Gl.hostCheckReadyHandler&&w.AFrameworkApplication.oNg(Object(d.a)(this.Gl,this.Gl.hostCheckReadyHandler,"hostCheckReadyHandler"));try{const Jd=Fa.a.instance.resolve("Common.App.OAuth.IOAuthManager");
this.Gl.setOAuthManager(Jd)}catch(Jd){}}return this.Gl}get A6j(){return this.mVc}get Zh(){return this.wie}get kna(){return this.tie}get NOd(){return this.xie}get MOd(){return this.vie}get $qj(){return this.zie}get Yqj(){return this.uie}get Zqj(){return this.yie}get arj(){return this.Aie}get brj(){return this.Bie}get OOd(){return this.Cie}get z_f(){return this.Die}get bV(){return this.Byg}get $(){return this.jb}get LOd(){return this.sie}X1b(pa){const zb={};zb.Name=pa.Name;zb.BindingType=pa.BindingType;
zb.HasHeaders=pa.HasHeaders;pa.IsValidRef&&(zb.ColCount=pa.Reference.LastColumn-pa.Reference.FirstColumn+1,zb.RowCount=pa.Reference.LastRow-pa.Reference.FirstRow+1);return zb}get dYc(){return w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)}Zpf(pa,zb){const Vb=this.oYg(zb);let xc=null;if(w.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:7073634_TellMeLaunchAddinDialogSetTabIdEnabled")&&
Ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",!1)&&null!==zb&&"LaunchAddinDialogFromTellMe"===zb[0])null!==Vb.assetId&&"undefined"!==typeof Vb.assetId&&(xc="{98143890-AC66-440E-A448-ED8771A02D52}");else if(this.dYc){const Sc=this.$.ea.wg.get(27);Sc&&null!==zb&&"InsertMoreAddInsFromFooter"===zb[0]?xc="{98143890-AC66-440E-A448-ED8771A02D52}":Sc&&null!==zb&&"AddinFlyoutMoreButton"===zb[0]&&(xc="0")}this.Gl.launchInsertDialog(pa,xc,Vb)}get r2(){return this.Iob}get Iob(){this.sYc&&
!this.spa&&(this.spa=new da(new ca.a({["AppsForOfficeAllowExternalMarketplace"]:this.allowExternalMarketplace.toString(),["AppsForOfficeThirdPartyIsDisabled"]:this.dSj.toString(),["AreThirdPartyAddInsAllowed"]:this.$.lP.toString(),["PopularAddinDetailsJsonString"]:Zd.EGd}),new mb.a(()=>this.Gl)));return this.spa}get dSj(){return Ha.EwaSettings.ra(174)}get allowExternalMarketplace(){return this.$.ea.wg.get(27)}get sYc(){return w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)}static get EGd(){return'[{"displayName":"Bing Maps","solutionId":"wa102957661","iconUrl":"https://store-images.s-microsoft.com/image/apps.45.d6c30518-91f7-4e79-b846-0813b56a1b2d.75cc16b5-7155-4a84-8094-a4ae7e997116.688fcadb-9dca-414b-91d4-2075b00c2772.png","addinInfo":{"priority":1,"AUP":1156}},{"displayName":"Mini Calendar and Date Picker","solutionId":"wa102957665","iconUrl":"https://store-images.s-microsoft.com/image/apps.31013.352a833c-760b-49ee-b384-f9718a71d650.3966871d-bbca-4abd-996d-777127e5f717.aac00a7f-336d-4d49-9fbb-f41bc3db4515.png","addinInfo":{"priority":1,"AUP":17494}},{"displayName":"\u30ab\u30ec\u30f3\u30c0\u30fc\u304b\u3089\u65e5\u4ed8\u5165\u529b","solutionId":"wa104017332","iconUrl":"https://store-images.s-microsoft.com/image/apps.10311.0344d7d5-ce70-4f70-a74e-3ebeb3971854.94d2cf9c-6327-468e-a46e-70a3c37ecbfb.1b44e913-4613-4bfa-bdb7-c4ec1bdd53b3.png","addinInfo":{"priority":3,"AUP":1162}},{"displayName":"QR4Office","solutionId":"wa104051163","iconUrl":"https://store-images.s-microsoft.com/image/apps.53638.20ce8aca-39c5-4b97-b87a-47d0f3e21e0d.0b60ea0f-7e02-4465-baeb-bb55c723d670.9147ef8e-cf16-47cf-af10-ef553e88804d.png","addinInfo":{"priority":1,"AUP":1220}},{"displayName":"Wikipedia","solutionId":"wa104099688","iconUrl":"https://store-images.s-microsoft.com/image/apps.7450.110c9a11-7db2-4228-b768-f1ad828e16be.9bd16ea2-22ff-455c-9f92-70de827e079a.aeef7210-898b-4a79-82b5-b648805129b9.png","addinInfo":{"priority":2,"AUP":226}},{"displayName":"Solver","solutionId":"wa104100404","iconUrl":"https://store-images.s-microsoft.com/image/apps.37315.adb6ef87-ef0f-4f99-b639-c08a45950b58.cb56fe0c-c385-43b5-8c1b-88701ddbb898.c5239aae-28c3-4dec-8338-e6c0ceef5b82.png","addinInfo":{"priority":1,"AUP":2955}},{"displayName":"People Graph","solutionId":"wa104104476","iconUrl":"https://store-images.s-microsoft.com/image/apps.49387.7b82fde0-3b87-471f-a121-86215bd4c0d4.5c5551ff-1f1c-4fdd-83a0-9a311307f989.b07f3a4e-26ca-4174-83e2-a8953ecb5eb6.png","addinInfo":{"priority":1,"AUP":1046}},{"displayName":"XLMiner Analysis ToolPak","solutionId":"wa104379190","iconUrl":"https://store-images.s-microsoft.com/image/apps.2225.9cbf413e-e33f-4be9-90ef-2fdb353c52a1.6e475dbb-9ae3-4b89-ae41-004faa21a088.e9552e6b-53ec-4728-ba49-ba04757c6dd0.png","addinInfo":{"priority":3,"AUP":7154}},{"displayName":"Stock Connector","solutionId":"wa104379220","iconUrl":"https://store-images.s-microsoft.com/image/apps.35421.d104d786-d979-48bb-9827-1b28ac5178cf.c0696ae0-87b8-4c16-ab8c-171be18ca0a9.8dcfdc9c-2863-4fa9-905d-84ff8534af7a.png","addinInfo":{"priority":1,"AUP":1375}},{"displayName":"Symbols and Characters - Fast Symbol Lookup","solutionId":"wa104379279","iconUrl":"https://store-images.s-microsoft.com/image/apps.53409.631e9a68-2435-4716-b1b8-dc48b99d3f85.d2f9c29f-cf48-4dcc-8202-fcbc5e4d1482.0216011c-2369-4ee7-8351-ac51d77015c2.png","addinInfo":{"priority":1,"AUP":558}},{"displayName":"Microsoft Dynamics Office Add-in","solutionId":"wa104379629","iconUrl":"https://store-images.s-microsoft.com/image/apps.2287.eac0bf67-c34b-4302-aaa9-a07c1e560721.16c405d8-e48b-42e1-ac8f-7c402b8ae0d1.5ce79e5f-d108-48a7-b34b-75c71b620973.png","addinInfo":{"priority":2,"AUP":2278}},{"displayName":"officeatwork | Template Chooser for Office - M365","solutionId":"wa104380050","iconUrl":"https://store-images.s-microsoft.com/image/apps.21517.40f3490e-24f2-4502-9a44-28e543d36a75.cc0236b1-594c-49ad-9462-3f787be3cd4f.f383d0e6-2de8-4367-9108-e62781456dad","addinInfo":{"priority":2,"AUP":525}},{"displayName":"Microsoft PowerApps Office Add-in","solutionId":"wa104380330","iconUrl":"https://store-images.s-microsoft.com/image/apps.60124.e1dfe8b1-6892-4a07-bb52-91fc1006be11.a6787a94-2200-4943-9d6a-f9efb8369662.47ff6184-6b13-4120-955b-1c285e83cbc7.png","addinInfo":{"priority":3,"AUP":489}},{"displayName":"Adobe Acrobat for Microsoft Word, Excel, and PowerPoint","solutionId":"wa104380526","iconUrl":"https://store-images.s-microsoft.com/image/apps.832.4553b45a-c9b7-42b8-9c57-e33b57f5df4d.80d83ec3-4ec7-4f7d-b45f-36b1f0c05e78.3d5b10f9-0a9c-4ac1-84fc-b7439dfb4f35.png","addinInfo":{"priority":3,"AUP":1300}},{"displayName":"Mobile Data Collection - Scan-IT to Office","solutionId":"wa104381026","iconUrl":"https://store-images.s-microsoft.com/image/apps.7989.6963e6f3-4ebf-4a63-82b7-734a5a002866.814dcb0f-f024-477c-9b9b-9407aef3d56a.a4027334-e000-4b89-bd22-18d0d906a688.png","addinInfo":{"priority":3,"AUP":809}},{"displayName":"Functions Translator, a Microsoft Garage project","solutionId":"wa104381504","iconUrl":"https://store-images.s-microsoft.com/image/apps.6460.beedf6f4-7724-4c03-8e90-d6cc7d58e77c.a85b2258-a967-4d48-898f-a8db56e4d9c6.1b6557bd-4e89-4bad-a3d7-0ad2f0f0ee55.png","addinInfo":{"priority":3,"AUP":889}},{"displayName":"Microsoft Power Automate for Excel","solutionId":"wa104381701","iconUrl":"https://store-images.s-microsoft.com/image/apps.24472.5327e164-9595-41b5-94b6-dc524c42d5f6.318749ea-0f55-45b9-aee5-b89aae584a0c.73475625-266a-4866-b041-d9536d4673bb.png","addinInfo":{"priority":2,"AUP":6761}},{"displayName":"FYI for Office","solutionId":"wa104381841","iconUrl":"https://store-images.s-microsoft.com/image/apps.55705.a91d847f-3878-41c0-90a2-1a25491d561e.6ece2a38-0dd7-4c23-abd0-2d418443543e.4218a512-bae0-420b-b293-2194a885c9aa.png","addinInfo":{"priority":3,"AUP":586}},{"displayName":"VitalTax | Making Tax Digital (MTD) for VAT","solutionId":"wa104381859","iconUrl":"https://store-images.s-microsoft.com/image/apps.10434.1d05b34e-479a-4769-bf99-07b416b11cbc.482ef49e-8635-4bfe-bb8d-e5ce4a2a4e61.be642c2c-717a-424c-96d8-8cea91a28e75.png","addinInfo":{"priority":1,"AUP":459}},{"displayName":"Microsoft Visio Data Visualizer","solutionId":"wa104381973","iconUrl":"https://store-images.s-microsoft.com/image/apps.28591.0bb30ee2-d030-40d4-ba7e-3cb028cacb85.45958ca1-0858-42f7-9002-36ecaceadb38.84405685-1ffe-4d1d-9782-069079dc8d28.png","addinInfo":{"priority":1,"AUP":9262}},{"displayName":"Analytic Solver","solutionId":"wa200000018","iconUrl":"https://store-images.s-microsoft.com/image/apps.13898.dda126ef-5dd2-44ef-b6bc-a6cb0309f3a1.5b43104b-37e9-4650-8c16-71e032e6cb7d.e1dd0809-9020-4553-ba59-1479f07f4705.png","addinInfo":{"priority":3,"AUP":1270}},{"displayName":"draw.io Diagrams","solutionId":"wa200000113","iconUrl":"https://store-images.s-microsoft.com/image/apps.14142.2ec57164-ba5b-42ee-8253-ade72ca74c8d.e8efbcc8-e27f-4682-9321-eb111eb3bc68.950e1c22-0dd9-4079-807b-145ecdb6df9c.png","addinInfo":{"priority":1,"AUP":265}},{"displayName":"SAP Analytics Cloud for Office","solutionId":"wa200000169","iconUrl":"https://store-images.s-microsoft.com/image/apps.22967.ffbd93af-2e67-49da-bff8-62f9e5029e69.9930b4d4-9fd9-4eac-8578-8c77ca3d7e15.3a9c2449-9616-45b4-83e5-2f8360c19338.png","addinInfo":{"priority":3,"AUP":655}},{"displayName":"Jira Cloud for Excel","solutionId":"wa200000556","iconUrl":"https://store-images.s-microsoft.com/image/apps.56884.e2ba98e8-580f-430a-a0f6-2d54d53d7762.fb12baec-4bec-40e4-8dfc-21c060e87964.7ef37c2b-d095-4918-89f1-25637b11e385.png","addinInfo":{"priority":2,"AUP":50071}},{"displayName":"Refinitiv Add-in","solutionId":"wa200000565","iconUrl":"https://store-images.s-microsoft.com/image/apps.22646.a3a6e343-b9d7-46ab-aad8-c0fc34c7b498.395fe483-7a9c-4c7f-ae27-4082290d2ccf.2a4f9940-98cd-460a-a422-d954187c3909.png","addinInfo":{"priority":3,"AUP":517}},{"displayName":"Money in Excel","solutionId":"wa200001306","iconUrl":"https://store-images.s-microsoft.com/image/apps.9427.a6eaa8f8-8441-4e98-b51b-7cdc68b3ad70.1e0bd518-ace3-4c76-a4e1-5bec9f355e89.eb2dcf06-11b7-4c0c-873b-df18bf95b4fa.png","addinInfo":{"priority":3,"AUP":1217}},{"displayName":"McGraw Hill","solutionId":"wa200002270","iconUrl":"https://store-images.s-microsoft.com/image/apps.10994.a2611ae6-e1fb-468e-9a75-4292ffd45f92.3e087ea2-0e00-40c2-9e26-d5c264f97fae.ffc523c3-0e09-439c-9422-af52e0770aff.png","addinInfo":{"priority":2,"AUP":90071}},{"displayName":"FRED Data","solutionId":"wa200003692","iconUrl":"https://store-images.s-microsoft.com/image/apps.51797.9b2b8182-033d-4060-9ca5-866292d44261.be4b3e57-cbb1-436a-98af-42040dca76d3.1d354664-b22f-4494-a818-f28e5304fc35.png","addinInfo":{"priority":1,"AUP":169}},{"displayName":"Advanced formula environment, a Microsoft Garage project","solutionId":"wa200003696","iconUrl":"https://store-images.s-microsoft.com/image/apps.42604.70ef3bb6-fd4c-4868-b560-ed816d7473dd.f2947730-eef9-434b-a86d-fa6e3bafe076.525d558d-aea8-4a78-89dd-576bcceda686.png","addinInfo":{"priority":3,"AUP":697}}]'}uR(pa,
zb){this.Iob&&this.Iob.uR(pa,zb)}Rtc(pa){this.Iob&&this.Iob.Utc(pa)}jTg(pa,zb){return M.a.Oi().equals(pa.solutionId,zb.solutionId)&&M.a.Oi().equals(pa.storeType,zb.storeType)}fda(pa,zb){if(w.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType"))this.eQf(pa,zb,OSF.StoreTypeEnum.MarketPlace);else{const Vb={};Vb.callbackFunc=pa;Vb.storeType=OSF.StoreTypeEnum.MarketPlace;Vb.fromInsertDialog=!1;Vb.refresh=zb;this.Gl.queryEntitlementDetails(Vb)}}eQf(pa,zb,Vb){const xc=
{};xc.callbackFunc=pa;xc.storeType=Vb;xc.fromInsertDialog=!1;xc.refresh=zb;this.Gl.queryEntitlementDetails(xc)}invokeDdaMethod(pa,zb){const Vb=this.pn(pa.DdaMethod.ControlId);Vb?Vb.invokeDdaMethod(pa,zb):this.zf(qa.a.internalError,zb)}registerDdaEventAsync(pa,zb,Vb,xc,Sc){(zb=this.pn(zb))?Zd.PAb(pa)?zb.xfj(pa,Vb,xc,Sc):this.zf(qa.a.iFd,Sc):this.zf(qa.a.internalError,Sc)}unregisterDdaEventAsync(pa,zb,Vb,xc,Sc){(zb=this.pn(zb))?Zd.PAb(pa)?zb.BYj(pa,Vb,xc,Sc):this.zf(qa.a.iFd,Sc):this.zf(qa.a.internalError,
Sc)}dispose(){this.disposed||(this.$.pl(this.dd),this.ea.ik(this.Rc),this.ea.yR(this.Ao),this.ea.Av(this.tf),this.vYc.detach(this),this.$.userOperationManager.Un(this.lR),this.Zqc=this.uf=this.vh=this.vYc=this.jb=null,this.aJa&&(this.aJa.dispose(),this.aJa=null),ka.a.Ja(this.NOd),ka.a.Ja(this.MOd),this.G1a&&(this.G1a.dispose(),this.G1a=null),super.dispose(),this.disposed=!0,e.ULS.sendTraceTag(537170583,0,50,"DdaFacade is disposed"))}Wfd(pa){return(pa=this.pn(pa))?pa.getDefaultIconUrl():null}hyc(pa){if(this.OJe!==
pa){this.OJe=pa;for(let zb=0,Vb=this.uf.length;zb<Vb;zb++){const xc=this.uf[zb];pa?xc.lMe(!1):xc.Xrh()}this.NOd.hyc(pa);this.MOd.hyc(pa)}}qTh(pa){return(pa=this.pn(pa))?pa.getDefaultDisplayName():null}zf(pa,zb,Vb=!0){const xc={};xc[La.a.Pf]=pa;xc[La.a.n3]=zb;this.VJ(451041795,xc,Vb)}kv(pa){const zb={};zb[La.a.n3]=pa;this.VJ(1237877382,zb)}VJ(pa,zb,Vb=!0){const xc=new Kb.a(pa,0,this.$.xc,0,null),Sc=zb?zb[La.a.n3]:null;this.G1a&&Ya.h(this.$).fb&&Yb.e7g(pa,zb)?this.G1a.Okh(pa,zb):(pa=this.$.Ia.Hb(xc,
zb),Vb&&Pa.TaskExtensions.za(pa,Jd=>{we.a(Jd)?this.zf(qa.a.internalError,Sc,!1):Jd.result||(Ya.h(this.$).fb?this.zf(qa.a.bAb,Sc,!1):this.zf(qa.a.internalError,Sc,!1))},this.la,8))}F9g(pa){return!!this.Tia(zb=>Zd.getSolutionId(zb.sl,this.$)===Zd.getSolutionId(pa,this.$)&&zb.sl.PrimaryMarketplace.MarketplaceType===pa.PrimaryMarketplace.MarketplaceType&&zb.sl.PrimaryMarketplace.MarketplaceRef===pa.PrimaryMarketplace.MarketplaceRef&&zb.sl.PrimaryMarketplace.SolutionVersion===pa.PrimaryMarketplace.SolutionVersion)}pn(pa){return this.Tia(zb=>
zb.controlId.startsWith(pa))}EHh(pa){return this.Tia(zb=>zb.Bta===pa)}NXe(pa){return this.Tia(zb=>zb.XT===pa&&!!zb.Bta)}bYe(pa,zb,Vb,xc){return this.Tia(Sc=>Sc.XT===pa&&Sc.sl.PrimaryMarketplace.MarketplaceRef.toLowerCase()===zb.toLowerCase()&&Sc.sl.PrimaryMarketplace.MarketplaceType.toLowerCase()===Vb.toLowerCase()&&!!Sc.sl.SharedRuntime&&!!Sc.sl.SharedRuntime.Resid&&!!xc&&!!xc.Resid&&Sc.sl.SharedRuntime.Resid.toLowerCase()===xc.Resid.toLowerCase())}UTg(pa,zb){if(pa=this.pn(pa))pa.ka(zb),pa.showHide(!0)}gJj(pa){(pa=
this.pn(pa))&&pa.showHide(!1)}eIa(pa){var zb;if(1!==pa.WebExtensionType||this.$.qd&8388608&&pa.TaskpaneVisible||this.$.qd&8388608&&!pa.TaskpaneVisible&&za.HelperMethods.ow(pa)){let Vb=null;za.HelperMethods.ow(pa)&&(Vb=Zd.Xua(pa,this.$),pa.TaskpaneWidth||(pa.TaskpaneWidth=this.r7b));const xc=(new ha(this,this.vh,pa)).Lnd();e.ULS.sendTraceTag(51263011,0,50,`DdaFacade::CreateOsfControl: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(pa.PrimaryMarketplace.SolutionId,pa.OwnerAddinStoreType||
pa.PrimaryMarketplace.MarketplaceType,null===(zb=pa.AssetMarketplace)||void 0===zb?void 0:zb.SolutionId,null,null,pa.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${pa.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${za.HelperMethods.ow(pa)}`);Vb&&(xc.Bta=Vb);this.uf.push(xc);this.rxa=null;this.u6a(pa.InstanceId)||(pa=String.format("{0}|{1}|{2}|{3}|{4}",pa.PrimaryMarketplace.SolutionId,pa.PrimaryMarketplace.SolutionVersion,pa.PrimaryMarketplace.MarketplaceRef,pa.PrimaryMarketplace.MarketplaceType,
pa.WebExtensionType),this.raiseEvent("ci",pa))}}NKj(pa,zb){pa.TaskpaneWidth=this.r7b;pa.TaskpaneVisible=!0;const Vb={};Vb.SolutionId=pa.PrimaryMarketplace.SolutionId;Vb.TargetType=pa.WebExtensionType;Vb.Version=pa.PrimaryMarketplace.SolutionVersion;Vb.StoreType=pa.PrimaryMarketplace.MarketplaceType;Vb.StoreId=pa.PrimaryMarketplace.MarketplaceRef;pa.AssetMarketplace?(Vb.AssetId=pa.AssetMarketplace.SolutionId,Vb.AssetStoreId=pa.AssetMarketplace.MarketplaceRef):(Vb.AssetId=null,Vb.AssetStoreId=null);
Vb.Width=pa.TaskpaneWidth;const xc=new ha(this,this.vh,pa,!0);xc.Lnd();this.uf.push(xc);const Sc=()=>{this.DQa(xc.controlId);this.Ng.purgeOsfControl(xc.controlId,!1);zb()};let Jd=null;Jd=ne.a.instance.yC(()=>{xc.hy&&(ka.a.Ja(Jd),Jd=null,this.Ng.insertBlankControlWithErrorUX(this.pIb(xc,Vb),Sc))},100,ce.a.Djh)}Fch(pa){if(pa&&pa.length){var zb=[];pa.forEach(Vb=>{if(Vb.ContainsCustomFunctions){const xc=Zd.Xua(Vb,this.$);this.nGd.contains(xc)||(this.nGd.add(xc),this.CMf.push(Vb));this.F9g(Vb)||zb.push(Vb)}});
zb.length&&this.XGe(zb)}}WIe(pa,zb){this.pn(pa.InstanceId)||(zb=zb(),pa=(new ha(this,this.vh,pa)).tef(zb),this.uf.push(pa),this.rxa=null)}AIj(pa){Zd.z1a.hb(pa)&&Zd.z1a.ma(pa).initializeAndShowWithTitle()}Dci(pa){Zd.z1a.hb(pa)&&Zd.z1a.ma(pa).hide()}o_h(pa){var zb=null;let Vb,xc,Sc=null;Vb=Zd.Ujd(pa,!0);if(!Vb)return e.ULS.sendTraceTag(537170570,0,10,"DdaFacade.GetOrCreateCustomFunctionSandboxAsync: webextension data is null"),Wb.Task.Sa(null);(xc=this.Gl.getOsfControl(Zd.getSolutionId(Vb,this.$)))&&
(zb=xc.getManifest())&&(Sc=zb.getSharedRuntimeForCustomFunctions("Workbook"));if(zb=Sc&&1===Sc.LifeTime?this.bYe(Vb.PrimaryMarketplace.SolutionId,Vb.PrimaryMarketplace.MarketplaceRef,Vb.PrimaryMarketplace.MarketplaceType,Sc):this.EHh(pa))return Wb.Task.Sa(zb.controlId);const Jd=new nb.a;za.HelperMethods.lkc(Sc)&&(Vb.SharedRuntime=Sc);pa=xc?xc.getNotificationParams():[];if(!pa.length)return this.AHe(Vb);this.r9f(pa,()=>{Pa.TaskExtensions.za(Jd.task,()=>{this.AHe(Vb)},this.la,3)},()=>{});return Jd.task}kOh(pa){pa=
Zd.Ujd(pa,!1);if(!pa)return e.ULS.sendTraceTag(537170569,0,10,"DdaFacade.GetAddinCommandSandbox: webextension data is null"),null;let zb=null;var Vb=this.Gl.getOsfControl(Zd.getSolutionId(pa,this.$));Vb&&(Vb=Vb.getManifest())&&(zb=Vb.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));return za.HelperMethods.lkc(zb)&&(pa=this.bYe(pa.PrimaryMarketplace.SolutionId,pa.PrimaryMarketplace.MarketplaceRef,pa.PrimaryMarketplace.MarketplaceType,zb))?pa.controlId:null}Yah(pa,zb){var Vb=Zd.Ujd(pa,!1);if(Vb){var xc=
null,Sc=this.Gl.getOsfControl(Zd.getSolutionId(Vb,this.$));Sc&&(Sc=Sc.getManifest())&&(xc=Sc.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));if(za.HelperMethods.lkc(xc)){Vb.SharedRuntime=xc;var Jd=Vb.PrimaryMarketplace.SolutionId;Sc=Vb.PrimaryMarketplace.SolutionVersion;var ye=OSF.OsfManifestManager.getCachedManifest(Jd,Sc);if(ye)if(this.l0b.hb(pa))xc=this.l0b.ma(pa),Pa.TaskExtensions.za(xc,He=>{(He=He.result)&&OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(He,zb,this.vh.NLb)},
this.la,3);else{var pe={};pe.solutionId=Jd;pe.version=Sc;pe.storeType=Vb.PrimaryMarketplace.MarketplaceType;pe.storeId=Vb.PrimaryMarketplace.MarketplaceRef;Vb.AssetMarketplace?(pe.assetId=Vb.AssetMarketplace.SolutionId,pe.assetStoreId=Vb.AssetMarketplace.MarketplaceRef):(pe.assetId=null,pe.assetStoreId=null);pe.targetType=OSF.OsfControlTarget.TaskPane;var re=new nb.a;Vb=Pa.TaskExtensions.Tj();Vb=new na.a(this.$,this,pe,Vb);xc=OSF.OsfManifestManager.getSharedRuntimeManifestCacheKey(Jd,xc.Resid);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(ye,
xc,Sc);Vb.createUILessSandbox(pe,ye,(He,ze)=>{He&&!ze?(OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(He,zb,this.vh.NLb),re.setResult(He)):re.setResult(null);this.l0b.remove(pa)});this.l0b.ia(pa,re.task)}}}else e.ULS.sendTraceTag(537170568,0,10,"DdaFacade.CreateAddinCommandSandboxAsync: webextension data is null")}NBe(pa){(pa=this.NXe(pa))&&(pa.sl.SharedRuntime||this.CJb(pa.controlId))}CJb(pa){(pa=this.NXe(pa))&&this.DQa(pa.controlId)}Eoh(pa,zb){if(!this.uf||!pa||!zb)return!1;
if(pa.toLowerCase()===zb.toLowerCase())return!0;let Vb=null,xc=null;for(let Sc=0,Jd=this.uf.length;Sc<Jd;Sc++){const ye=this.uf[Sc];if(ye.ownerAddinSolutionId&&(ye.controlId===pa&&(Vb=ye.ownerAddinSolutionId.toLowerCase()),ye.controlId===zb&&(xc=ye.ownerAddinSolutionId.toLowerCase()),Vb&&xc))break}return Vb&&Vb===xc?!0:!1}VJg(pa){this.pn(pa.InstanceId)||(pa=new ha(this,this.vh,pa),this.uf.push(pa),this.rxa=null)}tVf(pa){if(this.uf&&0<=pa&&pa<this.uf.length){const zb=this.uf[pa],Vb=zb.hy;this.uf.splice(pa,
1);this.NBf(zb);W.DOMElementExtensions.vf(Vb)}}DQa(pa){if(this.uf)for(let zb=0,Vb=this.uf.length;zb<Vb;zb++)if(this.uf[zb].controlId===pa){this.tVf(zb);break}}Eij(pa){if(this.uf){pa=pa.toLowerCase();for(let zb=0,Vb=this.uf.length;zb<Vb;zb++)if(pa===this.uf[zb].ownerAddinSolutionId.toLowerCase()){this.tVf(zb);break}}}zUg(pa){pa.Ci&&(this.pn(pa.floatingObject.sl.InstanceId)||(this.Ugc(pa.floatingObject.sl.InstanceId)||this.Zqc.push(pa.floatingObject.sl.InstanceId),this.eIa(pa.floatingObject.sl)),this.ea.isNamedObjectViewMode&&
this.UTg(pa.floatingObject.sl.InstanceId,pa.Hd))}Baa(pa){if(this.uf)for(let zb=0,Vb=this.uf.length;zb<Vb;zb++)if(1===this.uf[zb].controlType&&bf.a.equals(this.uf[zb].XT,pa,!0))return this.uf[zb].controlId;return null}gHh(pa){const zb=[];if(this.uf)for(let Vb=0,xc=this.uf.length;Vb<xc;Vb++)bf.a.equals(this.uf[Vb].XT,pa,!0)&&zb.push(this.uf[Vb].controlId);return zb}LHh(pa,zb){if(!zb||!pa)return null;if(this.uf)for(let Vb=0,xc=this.uf.length;Vb<xc;Vb++)if(1===this.uf[Vb].controlType&&bf.a.equals(this.uf[Vb].XT,
pa,!0)&&this.uf[Vb].sl.SharedRuntime&&bf.a.equals(this.uf[Vb].sl.SharedRuntime.Resid,zb.Resid,!0))return this.uf[Vb].controlId;return null}R3a(pa,zb=null){return pa?zb?`${pa}.${zb}`:pa:""}QBe(pa,zb,Vb){if(this.rxa===pa)return!0;this.rxa=pa;let xc=null,Sc=!1;if(!xc&&this.uf)for(let Jd=0,ye=this.uf.length;Jd<ye;Jd++)if(1===this.uf[Jd].controlType&&bf.a.equals(this.uf[Jd].XT,pa,!0)){let pe=!1,re=!1;zb?(pe=!0,re=!!this.uf[Jd].sl.SharedRuntime&&bf.a.equals(this.uf[Jd].sl.SharedRuntime.Resid,zb.Resid,!0)):
Vb&&(pe=!0,re=bf.a.equals(this.uf[Jd].sl.SharedRuntimeId,Vb,!0));if(!pe||re){re&&this.uf[Jd].Kg(!0);xc=this.uf[Jd].controlId;Sc=!0;this.rxa=null;break}}xc&&this.raiseEvent("ca",xc);return Sc}setAppRuntimeState(pa,zb){var Vb;if(pa){const xc=this.pn(pa);if(xc&&za.HelperMethods.ow(xc.sl))xc.Kg(zb),zb&&(this.raiseEvent("ca",pa),(null===(Vb=xc.hy)||void 0===Vb?0:Vb.firstChild)&&(pa=xc.hy.firstChild.title)&&0<pa.length&&this.o1b.Nvj(pa));else throw e.ULS.sendTraceTag(537170565,0,50,"SetAppRuntimeState: run on non-shared runtime app."),
Error.invalidOperation(Ve.a.instance.ga(2249));}else throw e.ULS.sendTraceTag(537170564,0,15,"SetAppRuntimeState: Invalid controlId."),Error.invalidOperation(Ve.a.instance.ga(2250));}getAppRuntimeState(pa){if(pa)if((pa=this.pn(pa))&&za.HelperMethods.ow(pa.sl))pa=pa.sl.TaskpaneVisible;else throw e.ULS.sendTraceTag(537170563,0,50,"GetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(Ve.a.instance.ga(2249));else throw e.ULS.sendTraceTag(537170562,0,15,"GetAppRuntimeState: Invalid controlId."),
Error.invalidOperation(Ve.a.instance.ga(2250));return pa}m3a(pa,zb){return(pa=this.pn(pa))?pa.m3a(zb):null}u6a(pa){return this.SBe(this.Zqc,pa)}Ugc(pa){return this.SBe(this.IJe,pa)}Coe(pa){this.IJe.push(pa)}gZ(pa){return(pa=this.pn(pa))?pa.sl:null}oBd(pa){this.raiseEvent("ekros",pa,this)}NEd(pa){if(pa){var zb=this.pn(pa.InstanceId);zb&&(pa.SharedRuntime||pa.SharedRuntimeId||(this.DQa(zb.controlId),this.Ng.purgeOsfControl(zb.controlId,!1)),zb={},zb.SolutionId=pa.PrimaryMarketplace.SolutionId,zb.TargetType=
pa.WebExtensionType,zb.Version=pa.PrimaryMarketplace.SolutionVersion,zb.StoreType=pa.PrimaryMarketplace.MarketplaceType,zb.StoreId=pa.PrimaryMarketplace.MarketplaceRef,pa.AssetMarketplace?(zb.AssetId=pa.AssetMarketplace.SolutionId,zb.AssetStoreId=pa.AssetMarketplace.MarketplaceRef):(zb.AssetId=null,zb.AssetStoreId=null),zb.Width=pa.TaskpaneWidth,zb.SharedRuntimeId=pa.SharedRuntimeId,this.qgg(zb))}}zia(){this.vh.zia()}GJ(pa,zb,Vb){this.vh.GJ(pa,zb,Vb)}mYe(pa,zb){zb=Zd.ogh(zb);pa=this.gZ(pa);this.vh.pac(pa.InstanceId,
2202,sb.a.RK,zb)}Pcd(pa){for(let zb=0,Vb=this.uf.length;zb<Vb;zb++)this.mYe(this.uf[zb].controlId,pa)}WHh(pa,zb){zb=Zd.Dbh(zb);this.vh.pac(pa,65539,"",zb)}ZHh(pa,zb,Vb){this.vh.pac(pa,1,zb,Vb)}VHh(pa,zb){this.vh.$Hh(pa,zb)}Vah(pa,zb){return[[2,1E3,"",JSON.stringify([pa,zb]),0,!1]]}imi(){return!!this.kna&&this.kna.zaf()}M4g(){this.kna&&this.kna.clear()}XHh(){if(this.kna&&this.kna.zaf()){var pa=this.kna.nOh();for(const zb of pa){pa=this.gHh(zb);for(const Vb of pa)this.vh.pac(Vb,65540,"","{}")}}}qfj(pa){this.kna.add(pa)}yYj(pa){this.kna.remove(pa)}Tia(pa){if(!this.uf)return null;
for(const zb of this.uf)if(pa(zb))return zb;return null}AHe(pa){const zb=new nb.a,Vb=Zd.Xua(pa,this.$);if(za.HelperMethods.ow(pa))e.ULS.sendTraceTag(537170531,0,50,"Shared runtime custom function agave is started."),this.zMf(pa,xc=>{xc?(pa.InstanceId=xc.InstanceId,pa.WebExtensionOsfControlType=3,pa.TaskpaneVisible=!1,this.eIa(pa),zb.setResult(pa.InstanceId)):(e.ULS.sendTraceTag(537170530,0,10,`InsertAgaveTaskPane for customfunction: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(pa.PrimaryMarketplace.SolutionId,
pa.PrimaryMarketplace.MarketplaceType,null,null,null,pa.PrimaryMarketplace.MarketplaceRef)} failed`),zb.setException(Error.create("Null insert data")))});else{Zd.z1a.ia(pa.InstanceId,new Ma.a);const xc=Zd.z1a.ma(pa.InstanceId).Z$;this.Ech(pa,xc,Vb);this.zMf(pa,null);zb.setResult(pa.InstanceId)}return zb.task}Ech(pa,zb,Vb){this.pn(pa.InstanceId)||(pa=new ha(this,this.vh,pa),pa.Bta=Vb,pa.tef(zb),this.uf.push(pa),this.rxa=null)}zMf(pa,zb){const Vb=Zd.Xua(pa,this.$);if(!this.nGd.contains(Vb))this.PHb.push(pa),
1<=this.PHb.length&&this.AMf(pa,zb);else if(zb)for(const xc of this.CMf)if(Zd.Xua(xc,this.$)===Vb){zb(xc,0);break}}AMf(pa,zb){let Vb=null;const xc={};xc.SolutionId=Zd.getSolutionId(pa,this.$);xc.TargetType=pa.WebExtensionType;xc.Version=pa.PrimaryMarketplace.SolutionVersion;xc.StoreType=pa.PrimaryMarketplace.MarketplaceType;xc.StoreId=pa.PrimaryMarketplace.MarketplaceRef;pa.AssetMarketplace?(xc.AssetId=pa.AssetMarketplace.SolutionId,xc.AssetStoreId=pa.AssetMarketplace.MarketplaceRef):(xc.AssetId=
null,xc.AssetStoreId=null);xc.Width=pa.TaskpaneWidth;xc.ContainsCustomFunctions=!0;za.HelperMethods.ow(pa)&&(xc.SharedRuntimeId=pa.SharedRuntime.Resid);const Sc=this.$.oa.xa;pa=this.$.oa.xa.Wb();const Jd=Sc.Na(9,pa);Jd.sharedInfo=xc;const ye=re=>{re=ge.a.Pe(re.data);e.ULS.sendTraceTag(537170528,0,10,`DdaFacade.CreateCustomFunctionSandbox failed on InsertAgaveTaskpane for persistenting CustomFunctions. errors: ${We.a.nc(re)}`)},pe=re=>{re&&!Ye.a(re)||e.ULS.sendTraceTag(537170527,0,10,`InsertAgaveTaskPane for addin ${Telemetry.PrivacyRules.GetPrivacyCompliantId(xc.SolutionId,
xc.StoreType,xc.AssetId,null,null,xc.StoreId)} finish with errors: ${We.a.nc(re.Errors)}`);this.PHb.shift();0<this.PHb.length&&this.AMf(this.PHb[0],zb)};if(zb){const re=He=>{const ze=He.Result;(Vb=ze?ze.AgaveData:null)||zb(null,He.Errors?He.Errors[0].ErrorCause:5001);zb(Vb,0)};pa=(He,ze,ef)=>Dd.g(Sc,"InsertAgaveTaskpane",Jd,Za.b(He,pe,re),Za.a(ze,ye),ef,null,0)}else pa=(re,He,ze)=>Dd.g(Sc,"InsertAgaveTaskpane",Jd,Za.b(re,pe),Za.a(He,ye),ze,null,0);be.a(this.$.userOperationManager,pa,re=>new Pe.a(519,
0,re,64),null)}wFj(){return this.$.$d.get(35)}ELd(pa){pa=this.pn(pa);(null===pa||void 0===pa?0:pa.Gda)&&pa.DVf()}XLi(pa){var zb=this.Tia(Vb=>Zd.nMa(Vb.XT));zb&&(zb=this.Ng.getOsfControl(zb.controlId))&&zb.notifyAgave(OSF.AgaveHostAction.SendMessage,pa)}Xmi(){return!!this.Tia(pa=>1===pa.controlType&&Zd.nMa(pa.XT))}Wmi(){const pa=this.Tia(zb=>Zd.nMa(zb.XT));return pa?pa.hy?W.DOMElementExtensions.isVisible(pa.hy):!1:!1}Vyj(){const pa=this.Tia(zb=>Zd.nMa(zb.XT));pa&&(pa.Kg(!0),this.raiseEvent("ca",pa.controlId))}initialize(){const {DdaEventDispatch:pa}=
a(1390),zb=void 0===this.$||null===this.$||Ha.EwaSettings.ra(234);void 0!==this.$&&null!==this.$||e.ULS.sendTraceTag(537170525,0,50,"VSO#2693929: Initialize is called. EwaControl is null");zb&&e.ULS.sendTraceTag(537170524,0,50,"VSO#2693929: Initialize is called. this.initialized is "+this.initialized);this.initialized||(td.FGa(this.$),this.ea=this.$.ea,this.vh=new pa(this.$),this.$.Lk(this.dd),this.ea.Jj(this.Rc),this.ea.TL(this.Ao),this.ea.$t(this.tf),this.$.userOperationManager.Zq(this.lR),this.Jqf(),
this.wWi(),this.ghi(),this.$.da.Ha(35,this),this.vYc.ka(this),zb&&e.ULS.sendTraceTag(537170522,0,50,"VSO#2693929: SessionIdChanged event is registered"),this.wie=new sb.a,zb&&e.ULS.sendTraceTag(537170521,0,50,"VSO#2693929: RichApiEventRegistration is constructed"),this.zie=new Va(this.$,this.Zh,this.vh),new ec(this.$,this.Zh,this.vh),this.xie=new wc(this.$,this.Zh,this.vh),this.vie=new zc(this.$,this.Zh,this.vh),this.uie=new ya(this.$,this.Zh,this.vh),this.yie=new gd(this.$,this.Zh,this.vh),this.Aie=
new Qd(this.$,this.Zh,this.vh),this.Bie=new dc(this.$,this.Zh,this.vh),this.$.NQ&&(this.Cie=new md(this.$,this.Zh,this.vh)),this.Die=new vd(this.$),Ha.EwaSettings.ra(178)&&(this.G1a=new Yb(this,Ya.h(this.$))),Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled")&&(this.tie=new eb),this.sie=new Sd(this.$,this.Zh,this.vh),this.initialized=!0,e.ULS.sendTraceTag(537170520,0,50,"DdaFacade is initialized"))}RHh(pa){if(!this.mCa)return null;for(let zb=0,Vb=this.mCa.length;zb<
Vb;zb++)if(pa.startsWith(this.mCa[zb].WebExtensionId))return this.mCa[zb];return null}Jqf(){var pa,zb=this.ea;if(zb.Xb&&!this.iRb){if(zb.workbookContext){if(this.mVc=this.$.ea.wg.get(22),null===(pa=zb.workbookContext.WebExtensions)||void 0===pa?0:pa.length){pa=zb.workbookContext.WebExtensions;zb=!1;for(let Vb=pa.length-1;0<=Vb;Vb--){if(!this.ea.isNamedObjectViewMode){this.Zqc.push(pa[Vb].InstanceId);if(1!==pa[Vb].WebExtensionType){pa.splice(Vb,1);continue}if(za.HelperMethods.ow(pa[Vb])&&0!==pa[Vb].SharedRuntime.State)1===
pa[Vb].SharedRuntime.State?pa[Vb].TaskpaneVisible=!1:2===pa[Vb].SharedRuntime.State?pa[Vb].TaskpaneVisible=!0:e.ULS.sendTraceTag(537170519,0,10,"The sharedRuntime state is invalid");else if(!pa[Vb].ContainsCustomFunctions&&!pa[Vb].TaskpaneVisible&&!ja.a(pa[Vb])){pa.splice(Vb,1);continue}}const xc=OSF.OsfControl.isFirstPartyStoreString(pa[Vb].PrimaryMarketplace.MarketplaceType);if(Ha.EwaSettings.ra(174)&&!xc&&(pa.splice(Vb,1),!zb)){zb=!0;const Sc=wb.GetServiceTaskFactory.Oa(this.$.da,5,4,3);Pa.TaskExtensions.za(Sc,
()=>{Sc.result.ih(36,null)},this.la,3)}Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:3937070_RemoveChartTaskPaneExtensionDuringLoad")&&pa[Vb].PrimaryMarketplace&&Zd.nMa(pa[Vb].PrimaryMarketplace.SolutionId)&&(e.ULS.sendTraceTag(537170518,0,50,"chart task pane info stored in workbook context webextensions"),pa.splice(Vb,1))}this.XGe(pa)}}else this.mVc=!1;this.iRb=!0}}X9e(pa){const zb=Ya.h(this.$),Vb=zb.ha.Ra.dc;if(Vb&&pa){pa=!1;if(this.uf)for(const xc of this.uf)if(Zd.nMa(xc.XT)||Zd.jqi(xc.XT)){pa=
!0;break}pa||zb.ha.Ra.SG(Vb)}}wWi(){this.Ng&&this.ea.isNamedObjectViewMode&&this.$.na&&Kc.o(this.$.na)&&(this.$.da.Aa(34).IQ?this.$.da.Aa(34).Ynd():this.$.da.Aa(34).Uu(this.v1i))}XGe(pa){let zb=null;zb=Vb=>{const xc=Vb.WebExtensionData,Sc=Vb.IsTaskPane,Jd=Vb.RecordHandler,ye=()=>{this.FPa.shift();0<this.FPa.length&&zb(this.FPa[0])};if(this.Baa(xc.PrimaryMarketplace.SolutionId))ye();else{Sc&&(xc.WebExtensionOsfControlType=1);var pe=ja.a(xc);if(!Sc||xc.TaskpaneVisible||pe||xc.SharedRuntime&&0!==xc.SharedRuntime.State||
xc.ContainsCustomFunctions){var re=new ha(this,this.vh,xc,!Sc);e.ULS.sendTraceTag(537170517,0,50,`DdaFacade::CreateAllOsfControls: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(xc.PrimaryMarketplace.SolutionId,xc.PrimaryMarketplace.MarketplaceType,null,null,null,xc.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${xc.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${za.HelperMethods.ow(xc)}`);re.Lnd();za.HelperMethods.ow(xc)&&(re.Bta=Zd.Xua(xc,this.$),xc.TaskpaneWidth=this.r7b);
pe&&(xc.WebExtensionToolTip="");Sc&&xc.TaskpaneVisible&&!pe&&(xc.TaskpaneWidth=this.r7b);this.uf.push(re);var He=this.rxa=null;He=ne.a.instance.yC(()=>{re.hy&&(ka.a.Ja(He),He=null,Jd&&Jd(Vb,re),ye())},100,ce.a.Cjh)}else ye()}};for(let Vb=0;Vb<pa.length;Vb++)if(!this.pn(pa[Vb].InstanceId))if(1!==pa[Vb].WebExtensionType)this.eIa(pa[Vb]);else if(!Ha.EwaSettings.ra(52))this.Anb(pa[Vb],zb);else if(this.$.qd&8388608||pa[Vb].TaskpaneVisible){const xc={};xc.solutionId=pa[Vb].PrimaryMarketplace.SolutionId;
xc.version=pa[Vb].PrimaryMarketplace.SolutionVersion;xc.storeType=pa[Vb].PrimaryMarketplace.MarketplaceType;xc.storeId=pa[Vb].PrimaryMarketplace.MarketplaceRef;xc.targetData=pa[Vb];this.Ng.isAddinCommandsAsync(xc,(Sc,Jd,ye)=>{if(Sc){var pe=ye.targetData;if(Jd){if(Ha.EwaSettings.ra(86))if(xc.storeType.toLowerCase()!==OSF.StoreType.OMEX.toLowerCase())Sc=xc.storeType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog.toLowerCase(),Jd=xc.storeType.toLowerCase()===OSF.StoreType.PrivateCatalog.toLowerCase(),
(Sc||Jd)&&za.HelperMethods.ow(pe)&&this.Anb(pe,zb);else if(Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForUploadFileCatalog"))this.u$h(ye,zb);else{let re=!1;this.fda(He=>{if(!He.errorCode){if(He.value)for(const ze of He.value){if(re)break;re=Ib.e(ze[1])===Ib.e(pe.PrimaryMarketplace.SolutionId)}re?za.HelperMethods.ow(pe)&&this.Anb(pe,zb):(He={},He.SolutionId=ye.solutionId,He.Version=ye.version,He.StoreType=pe.PrimaryMarketplace.MarketplaceType,He.StoreId=ye.storeId,
He.AssetId=null,He.AssetStoreId=null,He.Width=pe.TaskpaneWidth,He.TargetType=pe.WebExtensionType,pe.TaskpaneVisible=!0,this.nne(He,pe,zb))}},!0)}}else this.Anb(pe,zb)}else Sc=ye.targetData,e.ULS.sendTraceTag(542185164,220,15,`Judging AddinCommands failed for ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Sc.PrimaryMarketplace.SolutionId,Sc.PrimaryMarketplace.MarketplaceType,null,null,null,Sc.PrimaryMarketplace.MarketplaceRef)} from ${Sc.PrimaryMarketplace.MarketplaceType} during document loading`)})}}u$h(pa,
zb){let Vb=!1;this.fda(xc=>{const Sc=pa.targetData;if(!xc.errorCode){if(xc.value)for(const Jd of xc.value){if(Vb)break;Vb=Ib.e(Jd[1])===Ib.e(Sc.PrimaryMarketplace.SolutionId)}Vb?za.HelperMethods.ow(Sc)&&this.Anb(Sc,zb):(xc={},xc.SolutionId=pa.solutionId,xc.Version=pa.version,xc.StoreType=Sc.PrimaryMarketplace.MarketplaceType,xc.StoreId=pa.storeId,xc.AssetId=null,xc.AssetStoreId=null,xc.TargetType=Sc.WebExtensionType,xc.Width=Sc.TaskpaneWidth,Sc.TaskpaneVisible=!0,this.nne(xc,Sc,zb))}},!0)}Anb(pa,
zb){const Vb={};Vb.WebExtensionData=pa;Vb.IsTaskPane=!0;this.FPa.push(Vb);1===this.FPa.length&&zb(Vb)}nne(pa,zb,Vb){const xc={};xc.ActivationInfo=pa;xc.WebExtensionData=zb;xc.IsTaskPane=!1;xc.RecordHandler=(Sc,Jd)=>{const ye=Sc.ActivationInfo;this.Ng.insertBlankControlWithErrorUX(this.pIb(Jd,ye),()=>{this.DQa(Jd.controlId);this.Ng.purgeOsfControl(Jd.controlId,!1);this.qgg(ye)})};this.FPa.push(xc);1===this.FPa.length&&Vb(xc)}qgg(pa){var zb={};zb.solutionId=pa.SolutionId;zb.version=pa.Version;zb.storeType=
pa.StoreType;zb.storeId=pa.StoreId;zb.assetId=pa.AssetId;zb.assetStoreId=pa.AssetStoreId;zb.targetType=pa.TargetType;zb.sharedRuntimeId=pa.SharedRuntimeId;pa=new L.a;pa.add(zb);zb={};zb[Z.a.Eob]=pa;zb[Z.a.VL]=3;pa=new Kb.a(Fc.a.lDb,0,this.$.xc,0,null);this.$.Ia.Hb(pa,zb)}pIb(pa,zb){const Vb={};Vb.div=pa.hy;Vb.id=pa.controlId;Vb.solutionId=zb.SolutionId;Vb.version=zb.Version;Vb.storeId=zb.StoreId;Vb.storeType=zb.StoreType;Vb.osfControlType=OSF.OsfControlTarget.TaskPane;return Vb}wZf(){if(Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:3935411_RemoveOsfControlsAferSilentReload")){const Vb=
[];for(var pa=0;pa<this.uf.length;pa++){var zb=this.uf[pa];0!==zb.osfControlType&&3!==zb.osfControlType&&4!==zb.osfControlType||Vb.push(zb)}pa=!1;for(zb=0;zb<Vb.length;zb++){const xc=Vb[zb];this.DQa(xc.controlId);!pa&&xc&&xc.sl&&(pa=za.HelperMethods.ow(xc.sl))}pa&&this.VJ(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:4})}Ha.EwaSettings.ra(355)&&Pa.TaskExtensions.za(wb.GetServiceTaskFactory.Oa(this.$.da,278,279,3),Vb=>{Vb&&(Vb=Vb.result)&&(this.$.da.Aa(278)||this.$.da.Ha(278,Vb),Vb.zff().ona())},
this.la,3)}PK(){var pa=new Pd(this.$,this.Zh,this.A_f);void 0===this.$||null===this.$?e.ULS.sendTraceTag(537170514,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. EwaControl is null"):Ha.EwaSettings.ra(234)&&e.ULS.sendTraceTag(537170513,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. RichAPiEventRegistration is null: "+(void 0===this.Zh||null===this.Zh));if(pa.NKi()){const zb=()=>{},Vb=Sc=>{Sc=ge.a.Pe(Sc.data);e.ULS.sendTraceTag(537170511,0,10,`ResetStateForWorkbookReload: Failed to recreate event registration information. Errors: ${We.a.nc(Sc)}.`)},
xc=pa.mZg();pa=Zd.Qhd(xc);pa|=64;this.$.userOperationManager.KE(new Pe.a(507,0,(Sc,Jd,ye)=>Dd.g(this.$.oa.xa,"ExecuteRichApiRequest",this.nZg(xc),Za.b(Sc,zb),Za.a(Jd,Vb),ye,null,0),pa))}}nZg(pa){const zb=this.$.oa.xa.Na(1);zb.request=pa;return zb}SBe(pa,zb){if(pa)for(let Vb=0;Vb<pa.length;Vb++)if(bf.a.equals(pa[Vb],zb,!0))return!0;return!1}oYg(pa){const zb={};zb.navigationMode=OSF.OsfNavigationMode.DefaultMode;zb.assetId=null;zb.category=null;if(!pa||3>pa.length)return zb;if(pa[0]){const Vb=parseInt(pa[0],
10);isNaN(parseInt(Vb,10))||(zb.navigationMode=Vb)}pa[1]&&(zb.assetId=pa[1]);pa[2]&&(zb.category=pa[2]);return zb}ghi(){if(Ha.EwaSettings.ra(60)){var pa=this.$.workbookContext.FullDocumentInfo.EmbeddingPageOrigin;if(pa&&"*"!==pa.trim()){this.aJa=OsfRuntime.Embedded.createOrReplaceEmbeddingEndpoint(new Na(this),pa,this.$.workbookContext.FullDocumentInfo.EmbeddingPageSessionInfo,this.$.$d.get(2));try{this.aJa.init()}catch(zb){try{this.aJa.dispose()}catch(Vb){}this.aJa=null;e.ULS.sendTraceTag(537170510,
0,10,"EmbeddingEnpoint failed to initialize. Error message: "+zb.message)}pa={};pa.a=this.$.ya.UserSessionId;ib.b().Se(39,pa)}}}r9f(pa,zb,Vb){const xc=Zd.BXg(pa[0]),Sc=xc.mha,Jd=xc.nia;xc.mha=()=>{Sc&&Sc();const ye=xc.RLa!==OSF.InfoType.Error?zb:null;pa.shift();pa.length?this.r9f(pa,ye,Vb):ye&&ye()};xc.nia=()=>{Jd&&Jd();Vb&&xc.RLa!==OSF.InfoType.Error&&Vb()};Ta.a.uUd(xc)}TWh(){const pa={};pa.AddinRibbonControlsOverriddenByApi=Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:4373039_AddinRibbonControlsOverriddenByApi").toString();
pa.AddinActionDefinitionHybridMode=Ha.EwaSettings.ra(556).toString();pa.UseActionIdForUILessCommand=Ha.EwaSettings.ra(559).toString();pa.AllowStorageAccessByUserActivationOnIFrame=Ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AllowStorageAccessByUserActivationOnIFrame",!1).toString();pa.RequirementSetRibbonApiOnePointTwo=Ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.RequirementSetRibbonApiOnePointTwo",!1).toString();pa.flightingTreatmentVariables=w.AFrameworkApplication.fa.wac;
pa.ShortcutInfoArrayInUserPreferenceData=Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5232658_ShortcutInfoArrayInUserPreferenceData").toString();return pa}static get p5b(){return Zd.c7d}static set p5b(pa){Zd.c7d=pa}static getSolutionId(pa){let zb=pa.PrimaryMarketplace.SolutionId;Ha.EwaSettings.ra(261)&&pa.OwnerAddinSolutionId&&(zb=pa.OwnerAddinSolutionId);return zb}static Qhd(pa){let zb=0;Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?pa.RequestFlags&1&&256!==
(pa.RequestFlags&256)||(zb=16):zb=pa.RequestFlags&1?0:16;return zb}static Xua(pa,zb){zb=Zd.getSolutionId(pa,zb);return Zd.c2e(zb,pa.PrimaryMarketplace.SolutionVersion,pa.PrimaryMarketplace.MarketplaceType,pa.PrimaryMarketplace.MarketplaceRef)}static ogh(pa){return JSON.stringify({["recording"]:pa})}static Dbh(pa){const zb={};zb.visibility=pa?"Visible":"Hidden";return JSON.stringify(zb)}static WSh(pa){let zb=pa.getSolutionId(),Vb=pa.getVersion(),xc=pa.getStoreType();pa=pa.getStoreId();return Zd.c2e(zb,
Vb,xc,pa)}static c2e(pa,zb,Vb,xc){return String.format("{0}|{1}|{2}|{3}|{4}|||","2",pa,zb,Zd.k4h(Vb).toString(),xc)}static Ujd(pa,zb){var Vb=pa.split("|");if(7>Vb.length)return e.ULS.sendTraceTag(537170509,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected customFunctionAddinId."),null;if("2"!==Vb[0])return e.ULS.sendTraceTag(537170508,0,10,`DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected format='${Vb[0]}'.`),null;let xc=Vb[1];const Sc=Vb[2],Jd=Zd.l4h(Vb[3]),ye=Vb[4];Vb=
Vb[5];xc&&xc.length||(xc=Vb);Vb={};Vb.InstanceId=String.format("{{{0}}}",S.a.create().toString());Vb.WebExtensionOsfControlType=4;Vb.WebExtensionType=1;Vb.PrimaryMarketplace={};Vb.PrimaryMarketplace.SolutionId=xc;Vb.PrimaryMarketplace.SolutionVersion=Sc;Vb.PrimaryMarketplace.MarketplaceRef=ye;Vb.PrimaryMarketplace.MarketplaceType=Jd;Vb.ContainsCustomFunctions=zb?!0:!1;zb&&(Vb.OsfPropertyBag=[["customFunctionAddinId",pa]]);return Vb}static l4h(pa){pa=parseInt(pa,10);return pa===OSF.StoreTypeEnum.MarketPlace?
OSF.StoreType.OMEX:pa===OSF.StoreTypeEnum.Catalog?OSF.StoreType.SPCatalog:pa===OSF.StoreTypeEnum.SPApp?OSF.StoreType.SPApp:pa===OSF.StoreTypeEnum.Exchange?OSF.StoreType.Exchange:pa===OSF.StoreTypeEnum.FileSystem?OSF.StoreType.FileSystem:pa===OSF.StoreTypeEnum.Registry?OSF.StoreType.Registry:pa===OSF.StoreTypeEnum.PrivateCatalog?OSF.StoreType.PrivateCatalog:pa===OSF.StoreTypeEnum.HardCodedPreinstall?OSF.StoreType.HardCodedPreinstall:pa===OSF.StoreTypeEnum.FirstParty?OSF.StoreType.FirstParty:pa===OSF.StoreTypeEnum.UploadFileDevCatalog?
OSF.StoreType.UploadFileDevCatalog:pa===OSF.StoreTypeEnum.WopiCatalog?OSF.StoreType.WopiCatalog:null}static k4h(pa){return pa===OSF.StoreType.OMEX?OSF.StoreTypeEnum.MarketPlace:pa===OSF.StoreType.SPCatalog?OSF.StoreTypeEnum.Catalog:pa===OSF.StoreType.SPApp?OSF.StoreTypeEnum.SPApp:pa===OSF.StoreType.Exchange?OSF.StoreTypeEnum.Exchange:pa===OSF.StoreType.FileSystem?OSF.StoreTypeEnum.FileSystem:pa===OSF.StoreType.Registry?OSF.StoreTypeEnum.Registry:pa===OSF.StoreType.PrivateCatalog?OSF.StoreTypeEnum.PrivateCatalog:
pa===OSF.StoreType.HardCodedPreinstall?OSF.StoreTypeEnum.HardCodedPreinstall:pa===OSF.StoreType.FirstParty?OSF.StoreTypeEnum.FirstParty:pa===OSF.StoreType.UploadFileDevCatalog?OSF.StoreTypeEnum.UploadFileDevCatalog:pa===OSF.StoreType.WopiCatalog?OSF.StoreTypeEnum.WopiCatalog:-1}static nta(pa){const zb={};zb.Version=pa.version;zb.AssetId=pa.assetId;zb.AssetStoreId=pa.assetStoreId;zb.StoreType=pa.storeType;zb.Height=pa.height;zb.SolutionId=pa.solutionId;zb.StoreId=pa.storeId;zb.TargetType=pa.targetType;
zb.Width=1===zb.TargetType?0:pa.width;zb.SharedRuntimeId=pa.sharedRuntimeId;return zb}static PAb(pa){return pa===OSF.DDA.EventDispId.dispidSettingsChangedEvent||pa===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent||pa===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||pa===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||pa===OSF.DDA.EventDispId.dispidRichApiMessageEvent||pa===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent||pa===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent||
pa===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static BXg(pa){return Object(b.a)(new gc.a,{RLa:pa.infoType,id:pa.id,title:pa.title,description:pa.description,buttonText:pa.buttonTxt,mha:pa.buttonCallback,pfc:pa.highPriority,nia:pa.dismissCallback,errorCode:pa.errorCode,Edf:pa.iframeNotificationUrl})}static nMa(pa){let zb="FA000000014"===pa;zb||(zb="907DD90F-A82F-4BBF-B4F2-FCD4868A5E14ButtonId1"===pa);return zb}static jqi(pa){return"FA000000005"===pa}}Zd.z1a=new G.a;Zd.c7d=!0;Object(c.a)(Zd,
"DdaFacade",X.a,[217,821,797,822,823,2])},776:function(r,F,a){a.d(F,"a",function(){return c});r=a(0);class c{constructor(b,e,f,d=null){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=b;this.controlId=e;this.ddaBinding=f;this.ArrayData=d}getDispid(){return this.dispid}getDdaBinding(){return this.ddaBinding}}Object(r.a)(c,"DdaEventArgs",null,[])},827:function(r,F,a){r=a(0);class c{constructor(){this.title=this.id=this.tabs=null}}Object(r.a)(c,"AddInDataTransferObject",
null,[]);a.d(F,"a",function(){return b});class b{constructor(e,f,d){this.GRb=e;this.rsg=f;this.ssg=d}get Ks(){return this.GRb}get sJg(){return this.rsg}get tJg(){return this.ssg}static O3a(e){return(e=e.KV)?Object.assign(new c,{tabs:e.Ks.toArray(),id:e.sJg,title:e.tJg}):null}}Object(r.a)(b,"OneLineRibbonExtensibility",null,[])},831:function(r,F,a){a.d(F,"a",function(){return c});a.d(F,"b",function(){return b});const c=e=>{let f=null;switch(e){case 0:f="omex";break;case 1:f="spcatalog";break;case 2:f=
"spapp";break;case 3:f="filesystem";break;case 4:f="exchange";break;case 6:f="registry";break;case 7:f="inmemory";break;case 8:f="uploadfiledevcatalog";break;case 9:f="hardcodedpreinstall";break;case 10:f="excatalog";break;case 16:f="wopicatalog"}return f},b=e=>{let f=-1;switch(e.toLowerCase()){case "omex":f=0;break;case "spcatalog":f=1;break;case "spapp":f=2;break;case "filesystem":f=3;break;case "exchange":f=4;break;case "registry":f=6;break;case "inmemory":f=7;break;case "uploadfiledevcatalog":f=
8;break;case "hardcodedpreinstall":f=9;break;case "excatalog":f=10;break;case "wopicatalog":f=16}return f}},865:function(r,F,a){a.r(F);r=a(0);var c=a(192),b=a(15),e=a(100);class f{constructor(){this.startTime=0;this.callback=null}}Object(r.a)(f,"SSOCallbackInfo",null,[]);class d{constructor(){this.accessToken=null}}Object(r.a)(d,"AccessTokenInformation",null,[75]);var h=a(981);class l{constructor(){this.token=null;this.expiresOn=0;this.bha=this.authChallenge=null}}Object(r.a)(l,"CachedTokenInfo",
null,[]);class k{constructor(){this.jSb=new c.a;this.O9=this.N9=!1;this.zoa=this.authChallenge=null;this.startTime=this.retryCount=0;this.ese=null}get callbacks(){return this.jSb}}Object(r.a)(k,"SSORequestInfo",null,[]);class t extends k{constructor(){super();this.errorCode=0}}Object(r.a)(t,"SSOFailedRequestInfo",k,[]);var n=a(4);class z{constructor(I,U,S,G){this.WS=new c.a;this.mG=new c.a;this.Fpa=null;this.Wlb=new c.a;this.$ce=Promise.resolve(null);this.ike=!1;this.kXb=U;this.evg=I;this.Mke=S;this.wsg=
G}AGj(I){if(this.Fpa&&this.Fpa.authChallenge===I.authChallenge){if(Date.now()/1E3+z.nHi>this.Fpa.expiresOn)return this.Fpa=null,!1;I=new h.a;I.token=this.Fpa.token;I.expiresOn=this.Fpa.expiresOn;I.bha=this.Fpa.bha;I.LTa=!0;I.dyb=0;this.vyb(I);return!0}return!1}$Ej(I){for(let U=0;U<this.mG.count;U++)if(this.mG.ma(U).authChallenge===I.authChallenge&&this.mG.ma(U).zoa===I.zoa){let S;(S=this.mG.ma(U)).retryCount=S.retryCount+1;I.retryCount=this.mG.ma(U).retryCount;if(this.mG.ma(U).retryCount<z.MHi||!this.mG.ma(U).N9&&
I.N9||!this.mG.ma(U).O9&&I.O9){if(!this.mG.ma(U).N9&&I.N9||!this.mG.ma(U).O9&&I.O9)I.retryCount=0;this.mG.removeAt(U);break}I=new h.a;I.errorCode=this.mG.ma(U).errorCode;this.vyb(I);return!0}return!1}gLg(I,U){for(let S=0;S<this.mG.count;S++)if(this.mG.ma(S).zoa===I.zoa&&this.mG.ma(S).authChallenge===I.authChallenge)return;this.mG.add(Object.assign(new t,{N9:I.N9,O9:I.O9,authChallenge:I.authChallenge,zoa:I.zoa,errorCode:U,retryCount:I.retryCount}))}get resource(){return this.kXb}Oed(I,U,S,G,D,E){const {AppsForOfficeSingleSignOnManager:N}=
a(865);""===S&&(S=null);if(this.ike)N.y5(E,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{var M=null;for(let L of this.WS)if(L.N9===I&&L.O9===U&&L.authChallenge===S&&L.zoa===D){M=L;break}M||(M=Object.assign(new k,{N9:I,O9:U,authChallenge:S,ese:G,zoa:D,retryCount:0,startTime:N.jw()}),this.WS.add(M));M.retryCount=0;M.callbacks.add(E);this.$ce=this.$ce.then(()=>{var {AppsForOfficeSingleSignOnManager:L}=a(865);if(0<this.WS.count){var aa=this.WS.ma(0);if(this.AGj(aa)||this.$Ej(aa))return null;
for(let P=0;P<this.Wlb.count;)this.Wlb.ma(P)+z.jSj<L.jw()?this.Wlb.removeAt(P):P++;if(this.Wlb.count>=z.IHi||this.WS.count>=z.jHi)return aa=new h.a,aa.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,this.vyb(aa),null;let V=null;n.AFrameworkApplication.sa&&(L=n.AFrameworkApplication.sa.HD)&&(V=L.Gc("ComponentAttach",this.evg+z.IEg));return aa.zoa.mHg(this.resource,aa.N9,aa.O9,aa.authChallenge,this.wsg,aa.ese).then(P=>{V&&V.stop();this.vyb(P)},()=>{V&&V.stop();const P=new h.a;P.errorCode=
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;this.vyb(P)})}return null})}}vyb(I){const {AppsForOfficeSingleSignOnManager:U}=a(865);try{if(this.WS.count){var S=this.WS.ma(0);this.WS.removeAt(0);var G=null;I.errorCode||(G=new d,G.accessToken=I.token);I.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&I.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&I.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&I.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||
this.gLg(S,I.errorCode);var D={};null!=I.dyb&&(D.getTokenSilentTime=I.dyb.toString());null!=I.zjd&&(D.getTokenPopupTime=I.zjd.toString());null!=I.ehd&&(D.getIDTokenTime=I.ehd.toString());null!=I.LTa&&(D.tokenCached=I.LTa.toString());I.fYd&&(D.detailedError=I.fYd);I.bha&&(D.authLibrary=I.bha);S.retryCount&&(D.retryCount=S.retryCount);for(var E of S.callbacks)U.y5(E,I.errorCode,G,D);null!=I.LTa&&I.LTa||this.Wlb.add(S.startTime);if(!I.errorCode)for(null!=I.expiresOn&&(this.Fpa=Object.assign(new l,{token:I.token,
expiresOn:I.expiresOn,authChallenge:S.authChallenge,bha:I.bha})),this.mG.clear(),E=0;E<this.WS.count;)if(this.WS.ma(E).authChallenge===S.authChallenge){for(let N of this.WS.ma(E).callbacks)U.y5(N,I.errorCode,G,D);this.WS.removeAt(E)}else E++}}catch(N){b.ULS.sendTraceTag(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",N.message)}}shutdown(){this.ike=!0;this.WS.clear()}}z.jSj=6E4;z.IHi=6;z.jHi=6;z.MHi=3;z.nHi=300;z.IEg="GetAccessToken";Object(r.a)(z,"SSOCallbackManager",null,[]);
var w=a(731),m=a(556),u=a(122),y=a(79),v=a(27),C=a(30),x=a(151),B=a(346);a.d(F,"AppsForOfficeSingleSignOnManager",function(){return H});class H{constructor(I,U,S=null){this.SGc=new e.a;const G=new c.a;U&&G.add(U.KFi);S&&G.addRange(S);this.Gl=I;this.MFg=G}Ped(I,U,S,G,D,E,N,M,L,aa){aa=Object.assign(new f,{startTime:H.jw(),callback:aa});try{const ba=!!S&&""!==S;var V=aa.startTime;const Y=this.getOsfControl(I);let Z=Y.getStoreType()||"",ea=Y.getOwnerAddinStoreType()||"",ra=Y.getSolutionId()||"";const O=
Y.getVersion()||"";Z=Z.toLowerCase();ea=ea.toLowerCase();ra=ra.toLowerCase();var P=y.a.dhd(U)||"";const da=y.a.dhd(Y.getIframeUrl())||"",xa=P.toLowerCase()===da.toLowerCase();P=Z;"inmemory"===Z&&(P=ea);const ia=Telemetry.PrivacyRules.GetPrivacyCompliantId(ra,P,Y.getAssetId(),null,null,Y.getStoreId()),Ma={["callInstanceId"]:V.toString(),["controlSolutionId"]:ia,["controlVersion"]:O,["storeType"]:Z,["ownerStoreType"]:ea,["allowConsentPrompt"]:G.toString(),["forMSGraphAccess"]:D.toString(),["allowSignInPrompt"]:E.toString(),
["hasAddinAuthChallenge"]:ba.toString(),["securityOriginEqualsSourceLocation"]:xa.toString(),["singleSignOnEnabled"]:N.toString(),["accountTypeFilter"]:M||""};b.ULS.sendTraceTag(51401115,344,50,"{0}",Ma);x.a.sendTelemetryEvent(Object.assign(new B.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:u.a.Mi(Ma)}));V=!0;const Ta=n.AFrameworkApplication.fa.Wa("HostAuthType");switch(M){case "aad":V="aad"===Ta;break;case "msa":V="msa"===Ta;break;default:V=!M||"noFilter"===M}if(V){M=
null;if(N)for(let Da of this.MFg)if(Da.Doi(ra)){M=Da;break}M?this.isSSOAddin(I)?(N=!0,"omex"===P&&(N=!1),"spapp"===P||"spcatalog"===P?(b.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),H.y5(aa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):D&&!N?(b.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),H.y5(aa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,
null)):(D&&"exchange"===P&&(G=!1),this.Oed(I,U,S,P,G,E,L,M,aa))):(b.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),H.y5(aa,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):H.y5(aa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else H.y5(aa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(ba){this.Ulc(),b.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",
ba.message),H.y5(aa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}}getAccessToken(I,U,S,G){this.Ped(I,S[w.a.eYc]||null,S[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,S[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,S[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,S[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,U,S[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||
null,S[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,G)}Oed(I,U,S,G,D,E,N,M,L){this.SGc.hb(I)?G=this.SGc.ma(I):(G=new z(I,this.getWebApplicationResource(I).split(",")[0],G,this.getDefaultDisplayName(I)),this.SGc.add(I,G));const aa=G.resource;I=H.d2h(aa,this.getWebApplicationId(I));const V=OfficeExt.WACUtils.getHostSecure(U);I&&V?I.toLowerCase()===V.toLowerCase()?G.Oed(D,E,S,N,M,L):(H.$Na('SSO Resource "'+aa+'" cannot be used from "'+U+'" origin due to domain mismatch.'),b.ULS.sendTraceTag(22402396,
344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),H.y5(L,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(I||b.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),V||b.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),H.y5(L,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))}Ulc(){b.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",{["UserAgent"]:window.navigator.userAgent})}getOsfControl(I){return this.Gl.getOsfControl(I)}isSSOAddin(I){return this.getOsfControl(I).getManifest().isSSOAddin()}getWebApplicationId(I){return this.getOsfControl(I).getManifest().getWebApplicationId()}getWebApplicationResource(I){return this.getOsfControl(I).getManifest().getWebApplicationResource()}getDefaultDisplayName(I){return this.getOsfControl(I).getManifest().getDefaultDisplayName()}static M3h(){try{const I=
{};v.a.kxa&&m.OAuthManagerSettings.kzb&&(I.UiHostSupportsAuthTokenAddinList=H.vYe);I.UiHostSupportsAuthToken=m.OAuthManagerSettings.kzb;return I}catch(I){b.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",I.message)}return null}static getInstance(I,U,S=null){H.La||(H.La=new H(I,S));return H.La}static $Na(I){window.console.warn&&window.console.warn(I)}static d2h(I,U){if(!I)return"";U||(U="");let S=I.toLowerCase();var G=U.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(G)||
(H.$Na('SSO App Id "'+U+'" is not a valid format. It will be rejected from store submission.'),b.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));S.endsWith(G)||(H.$Na('SSO Resource "'+I+'" does not end with App Id "'+U+'". It will be rejected from store submission.'),b.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!S.startsWith("https://")&&!S.startsWith("api://"))return H.$Na('SSO Resource "'+I+'" must be https:// or api:// protocol.'),b.ULS.sendTraceTag(590962909,
344,10,"Resource not using https or api protocol."),"";for(U=0;U<I.length;U++){G=I.charAt(U);const D=C.a.charCodeAt(I,U);if(33>D||126<D||"&"===G||"?"===G||"#"===G||"%"===G||"\\"===G)return H.$Na('SSO Resource "'+I+'" contains an invalid character "'+G+'".'),b.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+G+"' in resource URI."),""}if(0<=I.indexOf("::"))return H.$Na('SSO Resource "'+I+'" contains an invalid string "::".'),b.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<
I.length)return H.$Na('SSO Resource "'+I+'" is '+I.length+" characters and exceeds the max length of 120 characters."),b.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+I.length+"."),"";S.startsWith("api://")&&(S="https://"+S.substring(6,S.length));return 8===S.length?"":OfficeExt.WACUtils.getHostSecure(S)||""}static y5(I,U,S,G){var D=I.startTime;let E=0;0<D&&(E=H.jw()-D);D={["callInstanceId"]:D.toString(),["callDuration"]:E.toString(),["errorCode"]:U.toString()};if(G)for(let N in G)D[N]=
G[N];b.ULS.sendTraceTag(51401116,344,50,"{0}",D);x.a.sendTelemetryEvent(Object.assign(new B.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:u.a.Mi(D)}));I.callback(U,S)}static jw(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(I){}return Date.now()}}H.vYe="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");H.La=null;Object(r.a)(H,
"AppsForOfficeSingleSignOnManager",null,[35])},880:function(r,F,a){a.d(F,"a",function(){return b});r=a(0);var c=a(13);class b{constructor(){this.QVe={["tabhome"]:"Ribbon.Home",["tabinsert"]:"Ribbon.Insert",["tabdata"]:"Ribbon.Data",["tabreview"]:"Ribbon.Review",["tabview"]:"Ribbon.View"};this.OVe={["tabpagelayoutexcel"]:["Ribbon.PageLayoutExcel",c.a.instance.ga(1632),c.a.instance.ga(1636)],["tabformulas"]:["Ribbon.Formulas",c.a.instance.ga(1633),c.a.instance.ga(1637)],["tabdeveloper"]:["Ribbon.Developer",
c.a.instance.ga(1634),c.a.instance.ga(1638)],["tabaddins"]:["Ribbon.AddIns",c.a.instance.ga(1635),c.a.instance.ga(1639)]};this.m$b=null}get Sha(){return"SourceControlId"}get PM(){return"Workbook"}get formFactor(){return"DesktopFormFactor"}QYh(){if(!this.m$b){this.m$b={};for(const e of Object.keys(this.QVe))this.m$b[e]=this.QVe[e];for(const e of Object.keys(this.OVe))this.m$b[e]=this.OVe[e][0]}}}Object(r.a)(b,"AddinCommandsStringProvider",null,[829])},881:function(r,F,a){a.d(F,"a",function(){return c});
r=a(0);class c{constructor(){this.RLa=0;this.mha=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.pfc=!1;this.Edf=this.nia=null}}Object(r.a)(c,"AddInCommandsNotificationParameters",null,[])},952:function(r,F,a){r=a(0);var c=a(15),b=a(85),e=a(156),f=a(14),d=a(88);class h extends Sys.UI.Control{constructor(G,D,E,N){super(document.createElement("div"));this.zS=this.xS=this.Lv=this.gG=this.oG=this.ypa=this.Xqa=null;this.Gjb=this.mqa=!1;this.content=this.Bp=null;this.Y0=0;
this.Ywe=null;this.DT=0;this.OIf=null;this.hle=G;this.tge=D;this.ZO=E;this.LG=N;this.eg=D.ownerDocument;this.Qec=this.pt=this.$jb=!1}get NV(){this.Xqa||(this.Xqa=this.eg.createElement("div"),this.Xqa.id=this.Fh("WACCalloutOuter"),this.Xqa.className="WACCalloutOuter",this.Xqa.setAttribute(d.a.Cd,d.a.PZa),this.Xqa.style.width=this.Y0+"px");return this.Xqa}get Ypb(){if(!this.ypa){this.ypa=this.eg.createElement("div");this.ypa.id=this.Fh("WACCalloutBeakContainer");this.ypa.className="WACCalloutBeakContainer";
var G="CalloutBeakTopFilled_32x16x32";if(5===this.DT||6===this.DT||4===this.DT)G="CalloutBeakBottomFilled_32x16x32";G=e.createClusteredImage(32,16,G,"WACCalloutBeak",!0,"");this.ypa.appendChild(G)}return this.ypa}set Ypb(G){this.ypa=G}get vMa(){return this.$jb}get title(){return this.Bp}set title(G){this.Bp!==G&&(this.Bp=G,this.xS&&(this.xS.innerText=this.Bp))}get pt(){return this.mqa}set pt(G){this.mqa!==G&&(this.mqa=G,this.oG&&(this.oG.contains(this.Lv)&&!this.mqa?this.oG.removeChild(this.Lv):!this.oG.contains(this.Lv)&&
this.mqa&&this.woe()))}get Qec(){return this.Gjb}set Qec(G){this.Gjb!==G&&(this.Gjb=G,this.oG&&(this.oG.contains(this.xS)&&!this.Gjb?this.oG.removeChild(this.xS):!this.oG.contains(this.xS)&&this.Gjb&&this.Rpe()))}show(){this.$jb||(this.Wch(),this.lm(),this.tge.appendChild(this.NV),this.NV.style.display="Block",this.WBj(),this.$jb=!0,this.OIf&&this.OIf())}dismiss(){this.$jb&&(this.Y$(),this.tge.removeChild(this.NV),this.$jb=!1,this.LG&&this.LG())}dispose(){this.dismiss();this.xS=this.Lv=this.gG=this.ypa=
this.oG=this.Xqa=null;Sys.Component.prototype.dispose.call(this)}Fh(G){return this.get_element().id+G}Wch(){this.oG=this.eg.createElement("div");this.oG.id=this.Fh("WACCalloutHeader");this.oG.className="WACCalloutHeader";this.pt&&this.woe();this.Qec&&this.Rpe();this.gG=this.eg.createElement("div");this.gG.id=this.Fh("WACCalloutContent");this.gG.className="WACCalloutContent";this.gG.style.width=190<this.Y0?this.Y0-26+"px":"164px";this.gG.appendChild(this.content);this.NV.appendChild(this.Ypb);this.NV.appendChild(this.oG);
this.NV.appendChild(this.gG)}woe(){this.Lv=this.eg.createElement("a");this.Lv.className="WACCalloutCloseAnchor";this.Lv.id=this.Fh("WACCalloutCloseAnchor");this.Lv.href="#";this.oG.appendChild(this.Lv);const G=e.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);this.Lv.appendChild(G)}Rpe(){this.xS=this.eg.createElement("div");this.xS.className="WACCalloutTitle UIFontBold";this.xS.style.width=190<this.Y0?this.Y0-30+"px":"160px";this.xS.id=
this.Fh("WACCalloutTitle");this.xS.innerText=this.title;this.oG.contains(this.Lv)?this.oG.insertBefore(this.xS,this.Lv):this.oG.appendChild(this.xS)}WBj(){var G=this.hle;let D;if(1===this.DT){var E=this.Ywe.y+16;D=-16}else 2===this.DT||3===this.DT||0===this.DT?(E=G.y+G.height+15,D=-15):(E=G.y-this.NV.clientHeight-15-2,D=this.NV.clientHeight-1);this.NV.style.top=E+"px";this.Ypb.style.top=D+"px";1===this.DT?(G=this.Ywe.x-16,this.NV.style.left="50%",this.NV.style.marginLeft=-this.Y0/2+"px",E=Sys.UI.DomElement.getBounds(this.NV),
this.Ypb.style.left=G-E.x+"px"):(E=G.x+this.hle.width/2,2===this.DT||5===this.DT?(G=20,E-=36):0===this.DT||4===this.DT?(G=this.Y0/2-16,E-=this.Y0/2):(G=this.Y0-20-32,E=E-this.Y0+36),this.NV.style.left=E+"px",this.Ypb.style.left=G+"px")}lm(){this.pt&&!this.zS&&(this.zS=Object(b.a)(this,this.w$,"closeHandler"),this.ZO.ta(f.a.click,this.Lv,this.zS,null))}Y$(){this.pt&&this.zS&&(this.ZO.Ba(f.a.click,this.Lv,this.zS),this.zS=null)}w$(){this.dismiss();return!0}}Object(r.a)(h,"Callout",Sys.UI.Control,[352]);
class l extends h{constructor(G,D,E,N,M,L=null){super(G,E,M.RW,L);this.Bee=0;this.Y0=this.VYh(N);this.jYa=D;this.Ye=M;this.kTj=7;this.vl=this.jYa.ownerDocument.createElement("div");this.vl.className="ModalCalloutControlOverlay";this.vl.tabIndex=0;this.jYa.insertBefore(this.vl,this.jYa.firstChild)}show(){this.vMa||(this.Ye.wsc(),this.Ye.qP(!1),this.vl.style.zIndex=String(this.Ye.b2),super.show(),this.Aj(),this.Bee=window.setTimeout(Object(b.a)(this,this.dismiss,"dismiss"),1E3*this.kTj))}dismiss(){this.vMa&&
(this.Ye.uM(!1),this.Sj(),this.jYa&&this.jYa.contains(this.vl)&&this.jYa.removeChild(this.vl),super.dismiss(),window.clearTimeout(this.Bee))}Aj(){this.Ye.Yra(Object(b.a)(this,this.dismiss,"dismiss"));this.Ye.wy.ta(f.a.click,this.vl,Object(b.a)(this,this.fd,"onClick"))}Sj(){this.Ye.wcb(Object(b.a)(this,this.dismiss,"dismiss"));this.Ye.wy.Ba(f.a.click,this.vl,Object(b.a)(this,this.fd,"onClick"))}fd(){this.dismiss();return!0}VYh(G){let D=0;switch(G){case 0:D=190;break;case 1:D=250;break;case 2:D=300;
break;case 3:D=360}return D}}Object(r.a)(l,"ModalCallout",h,[]);var k=a(463),t=a(176);class n extends l{constructor(G,D,E,N,M,L=null){super(G,D,E,N,M,L);this.YVb=null}show(){if(!this.vMa){const G=Object.assign(new k.a,{onShow:()=>{l.prototype.show.call(this)}});t.UISurfaces.hH().then(D=>{const E=D.externalNotification();this.YVb=D.addNotification(E,G);return null},D=>{c.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",D);return null})}}dismiss(){this.vMa&&this.YVb&&(t.UISurfaces.hH().then(G=>
{G.removeNotification(this.YVb);return this.YVb=null},G=>{c.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",G);return null}),super.dismiss())}}Object(r.a)(n,"ReactManagedModalCallout",l,[]);var z=a(4);class w{static Keh(G,D,E){return z.AFrameworkApplication.sa.Qa.OQ?new n(G,D,E,3,z.AFrameworkApplication.sa,null):new l(G,D,E,3,z.AFrameworkApplication.sa,null)}}Object(r.a)(w,"ModalCalloutControlFactory",null,[]);var m=a(54),u=a(878),y=a(586),v=a(879),C=a(135),x=a(57),B=a(40),
H=a(83),I=a(827),U=a(710);a.d(F,"a",function(){return S});class S{static get o1b(){return S.Wea||(S.Wea=H.a.instance.mg("Common.Utils.IAriaNotifier"))}static dHe(G,D,E,N){S.MI&&S.MI.vMa&&S.MI.dismiss();S.MI=w.Keh(D,G,G);S.MI.content=E;U.b(N)||(S.MI.title=N,S.MI.Qec=!0);G=new Sys.UI.Bounds(0,0,x.a.Ndc(),x.a.Mdc());S.MI.DT=S.GQh(G,D,S.MI.Y0);S.MI.show();S.o1b&&S.o1b.sendNotification(E.innerText,!0)}static t5c(G,D,E,N=null){t.UISurfaces.hH().then(M=>{let L=null;S.Tlb&&(M.removeNotification(S.Tlb),S.Tlb=
null);const aa=M.callout(Object.assign(new u.a,{target:G,title:D,content:E,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new v.a,{onDismiss:()=>{M.removeNotification(L)},directionalHint:null!=N?N:null})})),V=Object.assign(new k.a,{expirationOptions:Object.assign(new y.a,{displayTimeoutSeconds:7,onExpire:()=>{M.removeNotification(S.Tlb)}})});L=S.Tlb=M.addNotification(aa,V);return null},M=>{c.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",
M);return null})}static sUd(G,D=null){S.MI&&S.MI.vMa&&S.MI.dismiss();const E=new C.StandardDialog;E.HSa=!1;E.Ob=0;E.Nz(m.a.Kyi,CommonUIStrings.l_DialogError,U.b(G)?S.l2e():G,D)}static uUd(G){S.MI&&S.MI.vMa&&S.MI.dismiss();c.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",G.errorCode));const D=U.b(G.description)?S.l2e():G.description,E=new C.StandardDialog;let N=null;G.mha?(E.Ob=1,E.tc(1,G.buttonText),E.p0(1)):E.Ob=0;N=M=>{1===M?G.mha():G.nia&&G.nia()};
E.HSa=!1;0===G.RLa?E.Nz(G.errorCode,G.title?G.title:CommonUIStrings.l_DialogError,D,N):1===G.RLa?E.YR(G.title?G.title:CommonUIStrings.l_DialogWarning,D,N):E.Zna(G.title?G.title:CommonUIStrings.l_DialogInfo,D,N)}static GQh(G,D,E){let N=4;const M=G.x+G.width-D.x-D.width;D.x-G.x+D.width/2<=E/2?N=5:M+D.width/2<=E/2&&(N=6);return N}static kIj(G,D,E,N=!1){(D=I.a.O3a(D))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(D,M=>{M&&(N||S.t5c(M,
E,G,5))})}static lIj(G,D,E=!1){S.kIj(D.startedNode?D.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,G),D,D.startedNode?D.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,G),E)}static jIj(G,D,E,N){if(S.wlg)G=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,E,N,CommonUIStrings.l_InsertionDialogRefresh)),S.t5c(D,G,CommonUIStrings.l_ErrorLoadingAddInsTitle,1);else{D=
B.a.Xo(D);var M=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),L=document.createElement("span");L.innerText=M[0];var aa=document.createElement("span");aa.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,E,N,CommonUIStrings.l_InsertionDialogRefresh);aa.className="UIFontBold";E=document.createElement("span");E.innerText=M[1];N=document.createElement("div");Sys.UI.DomElement.addCssClass(N,"ModalCalloutControl");N.appendChild(L);N.appendChild(aa);N.appendChild(E);
S.dHe(G,D,N,CommonUIStrings.l_ErrorLoadingAddInsTitle)}}static DJj(G,D){var E=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,N=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;S.wlg?S.t5c(D,E,N):(D=B.a.Xo(D),S.dHe(G,D,S.TZg(N),E))}static TZg(G){const D=document.createElement("div");Sys.UI.DomElement.addCssClass(D,"ModalCalloutControl");D.innerText=G;return D}static l2e(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive}static get wlg(){return z.AFrameworkApplication.sa.Qa.Di&&
z.AFrameworkApplication.sa.Qa.OQ}}S.MI=null;S.Tlb=null;S.Wea=null;Object(r.a)(S,"AddInCommandsNotificationFactory",null,[])},962:function(r,F,a){a.r(F);r=a(0);var c=a(15),b=a(1490),e=a(151),f=a(122),d=a(731),h=a(746),l=a(346);class k{constructor(m,u,y,v){this.cA=!1;this._id=m;this.ix=u;this.m1=y;this.Nd=v}get enabled(){return this.cA}set enabled(m){const {DynamicRibbon:u}=a(962);var y=this.Nd.OwnerAddinStoreType;const v=this.Nd.PrimaryMarketplace.MarketplaceRef,C=this.Nd.AssetMarketplace?this.Nd.AssetMarketplace.SolutionId:
null,x=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.ix,y,null,null,null,v);y={["addinSolutionId"]:x,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Nd.OwnerAddinSolutionId,y,C,null,null,v),["ownerAddinStoreType"]:y,["ribbonControlType"]:"Button",["toggle"]:m};e.a.sendTelemetryEvent(Object.assign(new l.a,{name:u.$Bc+"ControlUpdate",dataFields:f.a.Mi(y)}));this.cA=m;this.m1.VJ(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:1,["SolutionId"]:this.ix,["PrivacyCompliantSolutionId"]:x,
["SourceControlId"]:this.id,["MethodData"]:this.cA})}get id(){return this._id}get label(){return null}setEnabled(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonButton"}invokePropertyGet(m){switch(m){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);}invokePropertyGetAsync(m){m=this.invokePropertyGet(m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(m)}invokePropertySet(m,
u){switch(m){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);}invokePropertySetAsync(m,u){this.invokePropertySet(m,u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(m,u){switch(m){case 5:return this.Cyj(u);case 1:return this.CCa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);}invokeMethodAsync(m,u){m=this.invokeMethod(m,
u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(m)}Cyj(m){m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"boolean");this.setEnabled(m);return null}CCa(){this._OnAccess();return null}}Object(r.a)(k,"RibbonButton",null,[]);class t{constructor(m,u,y,v){this._id=m;this.ix=u;this.m1=y;this.Nd=v}get id(){return this._id}setVisibility(m){const {DynamicRibbon:u}=a(962),y=this.Nd.OwnerAddinStoreType;var v=this.Nd.PrimaryMarketplace.MarketplaceRef;const C=this.Nd.AssetMarketplace?
this.Nd.AssetMarketplace.SolutionId:null,x=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.ix,y,C,null,null,v);v={["addinSolutionId"]:x,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Nd.OwnerAddinSolutionId,y,C,null,null,v),["ownerAddinStoreType"]:y,["ribbonControlType"]:"Tab",["toggle"]:m};e.a.sendTelemetryEvent(Object.assign(new l.a,{name:u.$Bc+"ControlUpdate",dataFields:f.a.Mi(v)}));this.m1.VJ(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:2,["SolutionId"]:this.ix,
["PrivacyCompliantSolutionId"]:x,["StoreType"]:y,["SourceControlId"]:this.id,["MethodData"]:m})}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonTab"}invokePropertyGet(m){switch(m){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);}invokePropertyGetAsync(m){m=this.invokePropertyGet(m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(m)}invokePropertySet(m){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);
}invokePropertySetAsync(m,u){this.invokePropertySet(m,u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(m,u){switch(m){case 3:return this.yCj(u);case 1:return this.CCa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);}invokeMethodAsync(m,u){m=this.invokeMethod(m,u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(m)}yCj(m){m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"boolean");this.setVisibility(m);
return null}CCa(){this._OnAccess();return null}}Object(r.a)(t,"RibbonTab",null,[]);var n=a(988),z=a(190);a.d(F,"DynamicRibbon",function(){return w});class w{constructor(m,u,y,v,C){this.ix=m;this.EI=y;this.m1=v;this.Nd=C;this.jib=this.EI.Ng;this.Gy=this.jib.getOsfControl(u);this.uAg=this.Gy.getManifest()}get buttons(){return null}executeRequestCreate(m){try{var u=this.Nd.OwnerAddinStoreType;const v=this.Nd.PrimaryMarketplace.MarketplaceRef,C=this.Nd.AssetMarketplace?this.Nd.AssetMarketplace.SolutionId:
null;var y=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.ix,u,C,null,null,v);const x={["addinSolutionId"]:y,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Nd.OwnerAddinSolutionId,u,C,null,null,v),["ownerAddinStoreType"]:this.Nd.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};e.a.sendTelemetryEvent(Object.assign(new l.a,{name:w.$Bc+"ExecuteRequestCreate",dataFields:f.a.Mi(x)}));const B=z.a.Xh(m);m={};u={};u[d.a.VIa]=this.Gy;u[d.a.WIa]=B;u[d.a.y9c]=this.Nd;m[d.a.gub]=
3;m[d.a.v3]=this.ix;m[d.a.R8b]=y;m[d.a.u3]=u;this.m1.VJ(-1014260128,m);let H=w.obc("ExecuteRequestCreate",!0,"");c.ULS.sendTraceTag(538572826,0,50,H)}catch(v){y=w.obc("ExecuteRequestCreate",!1,v.toString()),c.ULS.sendTraceTag(538572825,0,50,y)}return null}executeRequestUpdate(m){try{var u=this.Nd.OwnerAddinStoreType;const v=this.Nd.PrimaryMarketplace.MarketplaceRef,C=this.Nd.AssetMarketplace?this.Nd.AssetMarketplace.SolutionId:null;var y=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.ix,u,C,null,
null,v);const x={["addinSolutionId"]:y,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Nd.OwnerAddinSolutionId,u,C,null,null,v),["ownerAddinStoreType"]:this.Nd.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};e.a.sendTelemetryEvent(Object.assign(new l.a,{name:w.$Bc+"ExecuteRequestUpdate",dataFields:f.a.Mi(x)}));const B=z.a.Xh(m);m={};u={};u[d.a.VIa]=this.Gy;u[d.a.WIa]=B;u[d.a.y9c]=this.Nd;m[d.a.gub]=3;m[d.a.v3]=this.ix;m[d.a.R8b]=y;m[d.a.u3]=u;this.m1.VJ(-1014260128,
m);let H=w.obc("ExecuteRequestUpdate",!0,"");c.ULS.sendTraceTag(538572824,0,50,H)}catch(v){y=w.obc("ExecuteRequestUpdate",!1,v.toString()),c.ULS.sendTraceTag(538572823,0,50,y)}return null}getButton(m){let u=null;if(!this.dif())return this.gHe();if(m&&0<m.length){if(!this.eCe(m))return this.yHe(m);u=new k(m,this.ix,this.m1,this.Nd)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)}getTab(m){let u=null;if(!this.dif())return this.gHe();if(this.Gy.getOwnerAddinControlRecreated())return this.Xdh();
if(m&&0<m.length){if(!this.eCe(m))return this.yHe(m);u=new t(m,this.ix,this.m1,this.Nd)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.DynamicRibbon"}invokePropertyGet(m){switch(m){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);}invokePropertyGetAsync(m){m=this.invokePropertyGet(m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(m)}invokePropertySet(m){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);
}invokePropertySetAsync(m,u){this.invokePropertySet(m,u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(m){switch(m){case 1:return this.CCa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);}invokeMethodAsync(m,u){switch(m){case 7:return this.hEh(u);case 6:return this.iEh(u);case 3:return this.lQh(u);case 5:return this.J4h(u)}m=this.invokeMethod(m,u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(m)}hEh(m){m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,
0,"string");return this.executeRequestCreate(m)}iEh(m){m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return this.executeRequestUpdate(m)}lQh(m){m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return this.getButton(m)}J4h(m){m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return this.getTab(m)}CCa(){this._OnAccess();return null}yHe(m){return n.a(h.a.r$g,z.a.ga(1770)+m)}gHe(){return n.a(h.a.yqj,z.a.ga(1766))}Xdh(){return n.a(h.a.hostRestartNeeded,
z.a.ga(1771))}dif(){var m=this.Gy.getSharedRuntimeId();m=!!m&&0<m.length;c.ULS.sendTraceTag(538572822,0,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",m));return m}eCe(m){const u=this.uAg.getRibbonExtensionControlMap();return m in u||this.I3g(m)}I3g(m){var u=this.HHh();if(u){u=u.sOe;for(const y of u.tabs){if(y.id===m)return!0;for(const v of y.groups)for(const C of v.controls){if(C.id===m)return!0;if("Menu"===C.type){u=C;for(const x of u.items)if(x.id===m)return!0}}}}return!1}HHh(){return b.a.getInstance().Ria(this.Nd.PrimaryMarketplace.MarketplaceType,
this.Nd.PrimaryMarketplace.SolutionId,1)}static obc(m,u,y){const v={};v.methodName="DynamicRibbon."+m;v.result=u?"Succeeded":"Failed";v.message=y;return z.a.Dc(v)}}w.$Bc="Office.Online.Extensibility.Ribbon.";Object(r.a)(w,"DynamicRibbon",null,[])},973:function(r,F,a){a.d(F,"a",function(){return b});var c=a(974);const b=()=>{Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=c.a}},979:function(r,F,a){a.d(F,"a",function(){return c});
const c=(b,e)=>{let f=!1;b&&(b=e.osfControl,(e=b.getManifest())&&e.getSharedRuntimeForCustomFunctions("Workbook")&&!b.getIsUpgrading()&&(f=!0));return f}},981:function(r,F,a){a.d(F,"a",function(){return c});r=a(0);class c{constructor(){this.token=null;this.errorCode=0;this.expiresOn=this.bha=this.LTa=this.ehd=this.zjd=this.dyb=this.fYd=null}}Object(r.a)(c,"AppsForOfficeOauthResult",null,[])},988:function(r,F,a){a.d(F,"a",function(){return c});const c=(b,e)=>OfficeExtension.WacRuntime.Utility.createPromise((f,
d)=>{d(OfficeExtension.WacRuntime.Utility.createRichApiException(b,e))})}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.agave.js.map/b685b548e3eff9402a9031a0d91abe5f/EwaDSEsNext.agave.js.map
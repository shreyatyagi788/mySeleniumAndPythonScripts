'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[26],{1146:function(r,F,a){a.d(F,"a",function(){return b});var c=a(512);const b=()=>{c.a.Bi(".ewr-selection-draghandle,.ewr-selection-draghandle-grab{position:absolute;cursor:move;background-color:#fff;opacity:.01;z-index:15;pointer-events:auto}.ewr-selection-draghandle-grab{cursor:grab}.ewr-selection-draghandle-top-ie,.ewr-selection-draghandle-top-ie-enhanced{top:-2px;left:-2px;right:-2px;height:5px}.ewr-selection-draghandle-top-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-top,.ewr-selection-draghandle-top-enhanced{top:-2px;left:-2px;right:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-top-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom-ie,.ewr-selection-draghandle-bottom-ie-enhanced{right:0;left:-2px;bottom:-2px;height:5px}.ewr-selection-draghandle-bottom-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom,.ewr-selection-draghandle-bottom-enhanced{right:0;left:-2px;bottom:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-left-ie,.ewr-selection-draghandle-left-ie-enhanced{top:0;left:-2px;bottom:0;width:5px}.ewr-selection-draghandle-left-ie-enhanced{border-top:1.5px solid transparent}.ewr-selection-draghandle-left,.ewr-selection-draghandle-left-enhanced{top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-enhanced{border-left:1.5px solid transparent}.ewr-selection-draghandle-right-ie,.ewr-selection-draghandle-right-ie-enhanced{top:0;right:-2px;bottom:0;width:5px}.ewr-selection-draghandle-right-ie-enhanced{border-right:1.5px solid transparent}.ewr-selection-draghandle-right,.ewr-selection-draghandle-right-enhanced{top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-enhanced{border-right:1.5px solid transparent}.ewr-selection-dragtooltip{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:18px;font-size:12px;padding-left:2px;padding-right:2px}.ewr-selection-dragtooltip-updated{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:fit-content;width:max-content;font-size:10px;padding-left:2px;padding-right:2px}.ewr_selection_rearrangeleft{border-left:3px solid #217346;position:absolute;height:10px;width:0;left:-2px;top:-4px}.ewr_selection_rearrangeright{border-right:3px solid #217346;position:absolute;height:10px;width:0;right:-5px;top:-4px}.ewr_selection_rearrangetop{border-top:3px solid #217346;position:absolute;width:10px;height:0;top:-2px;left:-4px}.ewr_selection_rearrangebottom{border-bottom:3px solid #217346;position:absolute;width:10px;height:0;bottom:-5px;left:-4px}.ewr-cell-selection-highlight-all.selecting .ewr-selection-draghandle{cursor:unset}.ewr-selection-resizemarqueehandle{position:absolute;width:5px;height:5px;background-color:#217346;border:solid 1px #fff;z-index:16;pointer-events:auto}.ewr-selection-resizemarqueehandle-topleft,.ewr-selection-resizemarqueehandle-topright{top:-4px}.ewr-selection-resizemarqueehandle-bottomleft,.ewr-selection-resizemarqueehandle-bottomright{bottom:-4px}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{cursor:nwse-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{cursor:nesw-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright{cursor:nesw-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright{cursor:nwse-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{left:-4px}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{right:-4px}.ewr-marquee-thick{z-index:calc(10 + 1) !important;border-width:3px !important}.ewr-grdcontarea-ltr .ewr-marquee-thick{margin:-3px 0 0 -3px !important}.ewr-grdcontarea-rtl .ewr-marquee-thick{margin:-3px -3px 0 0 !important}.ewr-resizemarqueehandle-thick{height:6px !important;width:6px !important}")}},
1147:function(r,F,a){a.d(F,"a",function(){return b});var c=a(512);const b=()=>{c.a.Bi('.ewa-stb-uir{background-color:#f5f5f5;height:32px}.grid-visual-refresh .ewa-stb-ltr,.grid-visual-refresh .ewa-stb-rtl{background-color:#f5f5f5}.ewa-stb-drag{cursor:pointer}.ewa-stb-navarea{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-uir .ewa-stb-navarea-dimensions{height:32px}.ewa-stb-ltr .ewa-stb-navarea{left:0}.ewa-stb-rtl .ewa-stb-navarea{right:0}a.ewa-stb-navbutton.cui-disabled:focus{outline:auto 1px}.ewa-stb-navareaextra a.ewa-stb-navbutton:focus-visible{outline-offset:-1px}.ewa-stb-navbutton{border:0;padding:0;margin:0;width:27px;height:27px}.ewa-stb-uir .ewa-stb-navbutton{width:24px;height:24px;margin:4px;border-radius:2px}.ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#e1dfdd}.ewa-stb-uir .ewa-stb-navbutton:active{background-color:#bebbb8}.ewa-stb-ltr .ewa-stb-navbutton{float:left}.ewa-stb-rtl .ewa-stb-navbutton{float:right}.ewa-stb-navbutton .clip16x16{display:inline-block;margin:5px 6px 6px 5px}.ewa-stb-uir .ewa-stb-navbutton .clip12x12{display:inline-block;margin:6px}.ewa-stb-uir .cui-disabled svg{fill-opacity:.3}.ewa-stb-navbutton.cui-disabled .cui-img-container{opacity:.3}.ewa-stb-navareaextra{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-contentarea{position:relative;flex:0 1 auto;min-width:0%;top:0;left:0;right:0;border:0;height:27px;padding:0;margin:0;white-space:nowrap}.ewa-stb-uir .ewa-stb-contentarea{height:32px}.ewa-stb-uir .ewa-stb-left-scrollable.ewa-stb-contentarea::before{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-uir .ewa-stb-right-scrollable.ewa-stb-contentarea::after{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(-90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-tabarea{position:relative;top:0;height:27px;left:0;right:0}.ewa-stb-uir .ewa-stb-tabarea{height:32px}.ewa-stb-sheettabmoveindicator{position:absolute;top:-4px}.ewa-stb-tabs{display:block;height:27px;list-style:none;left:0;right:0;margin:0;padding:0;overflow-x:scroll;overflow-y:hidden;white-space:nowrap}.ewa-stb-uir .ewa-stb-tabs{height:32px}.ewa-stb-tabs-smooth{scroll-behavior:smooth}@media(prefers-reduced-motion:reduce){.ewa-stb-tabs{scroll-behavior:auto}}.ewa-stb-tabs .tab-active,.ewa-stb-tabs .tab-inactive{background-color:#f6f6f6;background-image:none;border:0 solid #ababab;border-left-width:1px;padding:0;height:22px;margin:2px 0 3px 0;display:inline-block;overflow:hidden;transform:translateX(0);transition:transform .2s}.ewa-stb-tabs .tab-active{border-bottom-width:2px;border-bottom-color:#217346;border-bottom-style:solid;margin:2px 0 3px 0;height:20px;background-color:#f6f6f6;transform:translateX(0);transition:transform .2s}.ewa-stb-uir .tab-active,.ewa-stb-uir .tab-inactive{background-color:#f5f5f5;border:0;margin:0;height:32px}.ewa-stb-uir .tab-hover{background-color:#e1dfdd}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active{background-color:Highlight;forced-color-adjust:none}}.ewa-stb-tabs .tab-active.ewa-stb-tabs-ghost,.ewa-stb-uir .ewa-stb-tabs-ghost{position:fixed;z-index:1000;border-right-width:1px;transition:none}.ewa-stb-tabs .tab-anchor-text{text-decoration:none;white-space:nowrap;height:22px;display:block}.tab-anchor-text:focus-visible{outline-offset:-1px}.ewa-stb-uir .tab-anchor-text{height:32px}.ewa-stb-tabs .dark{color:#444;white-space:pre;height:18px}.ewa-stb-tabs .light{color:#fff;white-space:pre;height:18px}.ewa-stb-tabs .tab-active-text{color:#217346;height:14px}.ewa-stb-uir .tab-active-text{color:#444;line-height:16px;padding-bottom:5px}.ewa-stb-uir .tab-active .tab-content-container::before{content:"";position:absolute;display:inline-block;top:0;bottom:0;left:0;right:0;color:rgba(0,0,0,0);border-bottom:3px solid #217346;padding-bottom:5px;width:calc(100% - 18px);margin:auto;transition:width 400ms cubic-bezier(.17,.17,0,1) 0s}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active .tab-content-container::before{border-bottom-color:HighlightText}.ewa-stb-uir .tab-active svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-stb-uir .tab-active.tab-hover .tab-content-container:hover::before{width:calc(100%)}.ewa-stb-tabs .tab-text,.ewa-stb-tabs .tab-content-container{white-space:pre;font-size:10pt;display:inline-block;text-align:center;margin-bottom:0}.ewa-stb-tabs .tab-content-container{padding:0 18px 0 18px;margin:0 2px 0 2px}.ewa-stb-uir .tab-content-container{padding:3px 6px 3px 6px;border-radius:2px;margin:2px 3px 2px 3px;font-size:14px}.ewa-stb-tabs .cui-img-container{top:1px}.ewa-stb-tabs .tab-content-container .clip12x12,.ewa-stb-tabs .tab-content-container .clip16x16,.ewa-stb-tabs .tab-content-container .clip24x16{display:inline-block}.ewa-stb-nsv-inactive{opacity:.7}.ewa-stb-nsv-inactive-svg{fill-opacity:.7}.ewa-stb-nsv-active{opacity:1}.ewa-stb-nsv-active-svg{fill-opacity:1}.ewa_nsv_margin{margin-left:4px !important;height:14px}.ewa-stb-rtl .ewa_nsv_margin{margin-left:0 !important;margin-right:4px !important}@media screen and (-ms-high-contrast:active){.ewa-stb-tabs .tab-active-text{color:ButtonText}}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active-text{color:HighlightText}}.ewa-stb-disable-scrollbar *::-webkit-scrollbar{display:none}.ewa-stb-disable-scrollbar *{scrollbar-width:none}.leave-size-fixed-on-tab-hover-old::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden}.leave-size-fixed-on-tab-hover::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden;height:0}.ewa-stb-locked-sheet{margin-right:4px !important;height:13px !important;width:12px !important}.ewa-stb-tabs .ewa-stb-locked-sheet-svg-16px{margin-right:4px}.ewa-stb-rtl .ewa-stb-locked-sheet{margin-right:0 !important;margin-left:4px !important}.ewa-stb-dropdown-menu-button{position:relative;display:inline-block;padding:0;margin:0;border:0}.ewa-active-sheet-menu-item{background-color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir,.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive,.ewr-presentMode-on .ewa-stb-uir .tab-active,.ewr-presentMode-on .ewa-stb-uir .tab-inactive,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-rtl{background-color:#3b3a39}.ewr-presentMode-on .ewa-stb-uir .tab-hover,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#484644}.ewr-presentMode-on .ewa-stb-tabs .tab-active :focus,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive :focus,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton.cui-disabled:focus{background-color:#3b3a39 !important;border:1px solid #e5e5e5 !important}.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-active-text{border-bottom-color:#37a660}.ewr-presentMode-on .ewa-stb-uir .tab-active .tab-content-container::before{border-bottom:3px solid #37a660}.ewr-presentMode-on .ewa-stb-tabs .light{color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir .tab-active-text{color:#f3f2f1}.ewa-active-sheet-menu-item-present-mode{background-color:#605e5c}.ewr-presentMode-transition .ewa-stb-uir,.ewr-presentMode-transition .ewa-stb-tabs .tab-active,.ewr-presentMode-transition .ewa-stb-tabs .tab-inactive,.ewr-presentMode-transition .ewa-stb-uir .tab-active,.ewr-presentMode-transition .ewa-stb-uir .tab-inactive,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-rtl{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-stb-tabs .light,.ewr-presentMode-transition .ewa-stb-uir .tab-active-text{transition:color .4s linear}')}},
1148:function(r,F,a){a.d(F,"a",function(){return b});var c=a(512);const b=()=>{c.a.Bi(".ewa-svg-icon{height:100%;width:100%}")}},1149:function(r,F,a){function c(k,t){this.ID=k;this.type=t}function b(k,t){this.value=k;this.contextId=t}function e(k,t,n,z,w,m,u,y){this.type=k;this.startTime=null==n||void 0==n.value?new b(n,null):n;this.endTime=null==z||void 0==z.value?new b(z,null):z;null!=w&&void 0!=w.value||new b(w,null);null!=m&&void 0!=m.value||new b(m,null);this.operationType=y}function f(k){this.ID=
k}function d(){this.Se=[];this.Vob=[];this.LYc=0;this.duration=this.startTime=null;this.Y8b={};this.Tyd=this.yzd=this.f_c=-1}function h(k){var t;return(null!=document.body.style.msTransform?t=k.style.msTransform:null!=document.body.style.webkitTransform?t=k.style.webkitTransform:null!=document.body.style.mozTransform?t=k.style.D9j:null!=document.body.style.oTransform?t=k.style.G9j:null!=document.body.style.transform&&(t=k.style.transform),t)?(t=t.replace("rotate(",""),t=t.replace("deg)",""),parseFloat(t)):
0}a.d(F,"a",function(){return h});new c(0,0,0,0,0,0);new c(1,1,0,0,0,0);new c(2,2,0,0,0,0);new c(3,3,0,0,0,1);new c(4,3,1,0,1,1);new c(5,3,0,0,.42,1);new c(6,3,.83,0,1,1);new c(7,3,0,0,.58,1);new c(8,3,.42,0,.58,1);new c(9,3,.1,.25,.75,.9);new c(10,3,.1,.9,.2,1);new c(11,3,.1,.9,.2,1);new c(12,3,.9,.1,.2,1);new c(13,3,.4,0,0,1);new c(14,3,.13,.21,.1,.7);new c(15,3,.02,.33,.38,.77);new c(16,3,.57,.17,.95,.75);new c(17,3,0,.19,.07,.72);new c(18,3,0,0,.95,.37);new c(19,3,.66,0,.34,1);new c(20,3,.8,0,
.2,1);new c(21,3,.8,0,.2,1);e.prototype={type:0,startTime:new b(0,null),endTime:new b(0,null),X9j:new b(0,null),h9j:new b(0,null),operationType:0};r=Array(1);r[0]=new b(0,0);new f(0,[new e(5,0,0,0,null,1,1,0)]);new f(1,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,50,null,1,1,0)]);new f(2,[new e(1,3,0,167,null,0,1,1),new e(2,3,0,167,null,0,1,1)]);new f(3,[new e(3,3,0,167,null,0,1,1),new e(4,3,0,167,null,0,1,1)]);new f(4,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,167,null,1,1,0)]);new f(5,[new e(5,2,0,167,null,
0,1,0)]);new f(6,[new e(1,3,0,100,null,0,1,1),new e(2,3,0,100,null,0,1,1)]);new f(7,[new e(3,3,0,100,null,0,1,1),new e(4,3,0,100,null,0,1,1)]);new f(8,[new e(5,2,0,100,null,1,1,0)]);new f(9,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,100,null,1,1,0)]);new f(10,[new e(5,2,0,100,null,0,1,0)]);new f(11,[new e(1,3,0,267,null,0,1,1),new e(2,3,0,267,null,0,1,1)]);new f(12,[new e(3,3,0,267,null,0,1,1),new e(4,3,0,267,null,0,1,1)]);new f(13,[new e(5,2,0,267,null,1,1,0)]);new f(14,[new e(5,2,0,0,null,0,2,0),new e(5,
2,0,267,null,1,1,0)]);new f(15,[new e(5,2,0,267,null,0,1,0)]);new f(16,[new e(6,3,0,267,null,0,1,1),new e(7,3,0,267,null,0,1,1)]);new f(17,[new e(1,3,0,750,null,0,1,1),new e(2,3,0,750,null,0,1,1)]);new f(18,[new e(3,3,0,750,null,0,1,1),new e(4,3,0,750,null,0,1,1)]);new f(19,[new e(5,2,0,750,null,1,1,0)]);new f(20,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,750,null,1,1,0)]);new f(21,[new e(6,3,0,1E3,null,0,1,1),new e(7,3,0,1E3,null,0,1,1)]);new f(22,[new e(1,3,0,367,null,0,1,1),new e(2,3,0,367,null,0,
1,1)]);new f(23,[new e(3,3,0,367,null,0,1,1),new e(4,3,0,367,null,0,1,1)]);new f(24,[new e(5,2,0,367,null,1,1,0)]);new f(25,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,367,null,1,1,0)]);new f(26,[new e(5,2,0,367,null,0,1,0)]);new f(27,[new e(6,2,0,r[0],null,0,1,1),new e(7,2,0,r[0],null,0,1,1)]);new f(28,[new e(5,2,0,0,null,1,1,0),new e(5,2,0,50,null,0,1,0)]);new f(29,[new e(1,3,0,433,null,0,1,1),new e(2,3,0,433,null,0,1,1)]);new f(30,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,50,null,1,1,0),new e(2,3,0,0,
null,40,1,1),new e(2,3,0,100,null,0,1,1)]);new f(31,[new e(2,0,0,0,null,32,1,1),new e(2,0,0,100,null,32,1,1),new e(2,3,101,350,null,0,1,1),new e(3,0,0,0,null,0,2,1),new e(3,0,0,100,null,0,2,1),new e(3,3,101,350,null,0,1,1),new e(5,0,0,0,null,0,2,0),new e(5,0,0,100,null,1,1,0)]);new f(32,[new e(2,3,0,267,null,32,1,1),new e(3,3,0,267,null,0,2,1),new e(5,2,0,0,null,1,0,0),new e(5,2,0,267,null,0,2,0)]);new f(33,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,100,null,0,2,0),new e(5,2,101,267,null,1,1,0)]);new f(34,
[new e(1,10,0,300,null,0,1,1),new e(2,10,0,300,null,0,1,1)]);new f(35,[new e(3,10,0,300,null,0,1,1),new e(4,10,0,300,null,0,1,1)]);new f(36,[new e(1,8,0,750,null,0,1,1),new e(2,8,0,750,null,0,1,1)]);new f(37,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,200,null,0,2,0),new e(5,3,201,500,null,1,1,0)]);new f(38,[new e(1,2,0,0,null,0,2,1),new e(2,2,0,0,null,0,2,1),new e(1,2,0,200,null,0,2,1),new e(2,2,0,200,null,0,2,1),new e(1,3,201,267,null,0,1,1),new e(2,3,201,267,null,0,1,1)]);new f(39,[new e(1,3,0,267,
null,0,1,1),new e(2,3,0,267,null,0,1,1)]);new f(40,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,267,null,1,1,0)]);new f(41,[new e(5,2,0,267,null,0,1,0)]);window.location.search.indexOf("AnimationLogging=1");window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(k){window.setTimeout(k,16)}}();d.prototype={Se:null,uRg:5,Vob:null,LYc:0,startTime:null,
duration:null,Y8b:null,f_c:-1,yzd:-1,Tyd:-1};d.prototype.Start=function(){this.startTime=new Date;this.Y8b={}};d.prototype.GetRecentAnimationStats=function(){var k,t=[],n=0;for(k=l.LYc;k<l.uRg;k++)null!=l.Vob[k]&&(t[n]=l.Vob[k],n++);for(k=0;k<l.LYc;k++)null!=l.Vob[k]&&(t[n]=l.Vob[k],n++);return t};d.prototype.GetAnimationSqmStats=function(){var k=[];return k[0]=0>l.f_c?0:l.f_c,k[1]=0>l.yzd?0:l.yzd,k[2]=0>l.Tyd?0:l.Tyd,k};var l=new d},1150:function(r,F,a){a.d(F,"a",function(){return b});var c=a(512);
const b=()=>{c.a.Bi(".ewa-ttrd-buttonarea{position:absolute;z-index:31}.ewr-table-resize-fillhandle-broader{position:absolute;width:6px;height:3px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-higher{position:absolute;width:3px;height:6px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-grdcontarea-ltr .ewr-table-resize-fillhandle-higher{right:-6px}.ewr-grdcontarea-rtl .ewr-table-resize-fillhandle-higher{left:-6px}.ewr-grdcontarea-ltr .ewr-table-resize-handle{cursor:nwse-resize;right:6px;bottom:0}.ewr-grdcontarea-rtl .ewr-table-resize-handle{cursor:nesw-resize;left:6px;bottom:0}.ewr-grdcontarea-ltr .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-grdcontarea-rtl .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-cell-selection-highlight-all.Selecting .ewr-table-resize-handle{cursor:nesw-resize}@media screen and (-ms-high-contrast:active),(forced-colors:active){.ewr-table-resize-fillhandle-higher{forced-color-adjust:none;position:absolute;width:3px;height:6px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-broader{forced-color-adjust:none;position:absolute;width:6px;height:3px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}}@media screen and (-ms-high-contrast:black-on-white),(forced-colors:active) and (prefers-color-scheme:light){.ewr-table-resize-fillhandle-higher{background-color:#000}.ewr-table-resize-fillhandle-broader{background-color:#000}}")}},
1166:function(r,F,a){var c=a(9);r=a(0);var b=a(226),e=a(38);class f extends e.a{constructor(ta){super();ta.da.Ha(376,this)}fPg(ta){this.addHandler("TAF",ta)}Rlj(ta){this.removeHandler("TAF",ta)}bbj(){this.raiseEvent("TAF")}}Object(r.a)(f,"GridHighlightBehaviorEventManager",e.a,[366,2]);class d extends b.a{constructor(ta){super();this.$=ta;this.Db()}create(){this.nb(this.$.da.Aa(376)||new f(this.$))}static ka(ta){ta.da.Ha(377,new d(ta))}}Object(r.a)(d,"GridHighlightBehaviorEventManagerFactory",b.a,
[]);var h=a(50),l=a(37),k=a(27),t=a(81),n=a(15),z=a(240),w=a(14),m=a(159),u=a(5),y=a(117),v=a(12);class C extends Sys.EventArgs{constructor(ta,ya){super();this.start=ta;this.c6a=ya}}Object(r.a)(C,"MarqueeResizeStartedOrEndedEventArgs",Sys.EventArgs,[]);var x=a(33);class B extends e.a{constructor(ta){super();this.Omc=[3];this.lqa=void 0;this.gridView=ta;this.vhg=x.a.tH(this.gridView.$);this.UM=x.a.tH(this.gridView.$)}get coloredReferencesManager(){const ta=this.gridView.$.da.Aa(281);ta||n.ULS.sendTraceTag(537159395,
0,50,"BehaviorHelperMethods.ColoredReferencesManager: coloredReferencesManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");return ta}get LA(){if(this.lqa)return this.lqa;const ta=this.gridView.$.da.Aa(464);ta||n.ULS.sendTraceTag(510255179,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaAssistanceManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");
ta.LA||n.ULS.sendTraceTag(510255178,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaHighlightsControl is null.");return this.lqa=ta.LA}INg(ta){this.addHandler("mrek",ta)}PN(ta,ya,sb){for(const Qb of this.gridView.yn)z.a.instance.ta(w.a.yj,Qb.domElement,ta);z.a.instance.ta(w.a.Kf,document.documentElement,ya);this.gridView.mc.e9b(!0);sb&&z.a.instance.ta(w.a.qB,this.gridView.pj,ya)}F_d(ta,ya,sb){for(const Qb of this.gridView.yn)z.a.instance.Ba(w.a.yj,Qb.domElement,ta);z.a.instance.Ba(w.a.Kf,
document.documentElement,ya);this.gridView.mc.e9b(!1);sb&&z.a.instance.Ba(w.a.qB,this.gridView.pj,ya)}Yfj(ta,ya){for(const sb of this.gridView.yn)m.a.instance.ta(w.a.Tf,sb.domElement,ta);m.a.instance.ta(w.a.ve,document.documentElement,ya)}KYj(ta,ya){for(const sb of this.gridView.yn)m.a.instance.Ba(w.a.Tf,sb.domElement,ta);m.a.instance.Ba(w.a.ve,document.documentElement,ya)}EHe(ta,ya,sb,Qb){const oc=document.createElement("div");oc.className=ya;for(const kb of sb)oc.classList.add(kb);ta.appendChild(oc);
z.a.instance.ta(w.a.pointerDown,oc,Qb);return oc}j7e(ta){ta=ta.Mb.parentNode;if(!ta)return n.ULS.shipAssertTag(537159394,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: selectedHighlightElement is null."),null;ta=parseInt(ta.getAttribute(u.a.c6a),10);return isNaN(ta)?(n.ULS.shipAssertTag(537159393,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: indexInMarqueeCollection is not a valid number."),null):this.gridView.Cb.NC(3,1,ta)}AMb(ta,ya,sb=!0){ta=sb&&(this.UM?!!this.LA&&
this.LA.ari(ta):!!this.coloredReferencesManager&&this.coloredReferencesManager.$qi(ta));for(const Qb of ya)v.DOMElementExtensions.setVisible(Qb,ta)}rbc(){return this.gridView.Ql?y.a(this.gridView.$):this.gridView.Vb}HSf(){if(this.UM){var ta=this.rbc();ta&&this.LA?this.vhg?ta.KD(null):this.LA.bgb(ta,null):(n.ULS.sendTraceTag(510255177,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.Cb.Nj(this.Omc),this.gridView.Cb.wk(null,
this.Omc))}else this.Ldj()}Ldj(){const ta=this.rbc();ta&&this.coloredReferencesManager?this.vhg?ta.KD(null):this.coloredReferencesManager.KD(ta,null):(n.ULS.sendTraceTag(537159392,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.Cb.Nj(this.Omc),this.gridView.Cb.wk(null,this.Omc))}PQf(ta,ya){this.raiseEvent("mrek",new C(ta,ya))}}Object(r.a)(B,"BehaviorHelperMethods",e.a,[]);var H=a(89),I=a(40);e=a(96);
class U extends e.a{constructor(ta,ya=null){super(ta,ya)}oZa(){}}Object(r.a)(U,"HighlightFlyweightBehavior",e.a,[]);var S=a(19),G=a(464),D=a(68),E=a(11),N=a(116),M=a(227),L=a(46);e=a(239);var aa=a(8),V=a(72),P=a(1),ba=a(34);class Y extends e.a{constructor(ta,ya,sb){super(document.createElement("div"));this.J6b=null;this.VQb=!1;this.onPointerDown=Qb=>{Qb=ba.a(this.$)?ba.a(this.$).me(Qb):Qb;this.VQb=!1;if(3===(D.a.zb=Qb.vb)){const oc=Qb.Ea.rawEvent,kb=oc.srcElement||oc.target;v.DOMElementExtensions.Af(this.domElement,
kb)&&v.DOMElementExtensions.Af(oc.currentTarget,kb)&&(this.VQb=!0,this.J6b=Qb.clientPoint)}return!1};this.Wg=Qb=>{Qb=ba.a(this.$)?ba.a(this.$).me(Qb):Qb;this.raiseEvent("GrPointerUp",Qb);return this.VQb=!1};this.Ti=Qb=>{Qb=ba.a(this.$)?ba.a(this.$).me(Qb):Qb;3===Qb.vb&&this.VQb&&this.Abi(Qb.clientPoint)&&(this.raiseEvent("GrDrag"),this.VQb=!1);return!1};this.fd=Qb=>{ba.a(this.$)&&ba.a(this.$).me(Qb);return!0};this.$=sb;sb=!P.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");this.domElement.classList.add(sb?
V.a.sVe:V.a.rVe);this.domElement.classList.add(V.a.h$b);ta.appendChild(this.domElement);v.DOMElementExtensions.setVisible(this.domElement,!1);this.iLa=document.createElement("div");this.iLa.classList.add(V.a.g$b);this.iLa.style.borderColor=ya;this.domElement.appendChild(this.iLa);z.a.instance.ta(w.a.pointerDown,this.domElement,this.onPointerDown);z.a.instance.ta(w.a.Kf,this.domElement,this.Wg);m.a.instance.ta(w.a.ve,this.domElement,this.Wg);z.a.instance.ta(w.a.yj,this.domElement,this.Ti);m.a.instance.ta(w.a.Tf,
this.domElement,this.Ti);M.a.instance.ta(w.a.click,this.domElement,this.fd)}Qqe(ta){this.addHandler("GrDrag",ta)}wWf(ta){this.removeHandler("GrDrag",ta)}Pqe(ta){this.addHandler("GrContxt",ta)}vWf(ta){this.removeHandler("GrContxt",ta)}Rqe(ta){this.addHandler("GrPointerUp",ta)}xWf(ta){this.removeHandler("GrPointerUp",ta)}dispose(){L.a.Wma(this.domElement);super.dispose()}nkg(ta){this.domElement.parentNode.removeChild(this.domElement);ta.appendChild(this.domElement)}Q3f(){this.domElement.classList.remove(V.a.h$b);
this.iLa.classList.remove(V.a.g$b);this.iLa.classList.add(V.a.tVe)}Big(){this.iLa.classList.remove(V.a.tVe);this.iLa.classList.add(V.a.g$b);this.domElement.classList.add(V.a.h$b)}Abi(ta){return!!this.J6b&&(3<Math.abs(ta.x-this.J6b.x)||3<Math.abs(ta.y-this.J6b.y))}static Fwb(ta){return P.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?(ta=ba.a(ta.$)?ba.a(ta.$).zoom:aa.a.v_,Math.round(9/Math.max(ta,1))):9}}Y.Cyd=0;Object(r.a)(Y,"TouchGrippie",e.a,[]);class Z extends U{constructor(ta,
ya,sb,Qb){super(ya);this.Ntd=this.jZc=this.jpb=!1;this.Hqb=null;this.xba=this.Itd=!1;this.Ew=()=>{this.jpb&&this.Itd?this.Yna():this.s4()};this.ZDf=kb=>{3===kb.vb&&(this.Itd=!0,this.Yna());return!1};this.$Df=kb=>{if(3===kb.vb){if(!kb.Mb||this.Noi(kb))return!1;this.Itd=!1;this.s4()}return!1};this.Xg=()=>{this.xba&&this.J_d();this.Yna();this.Ntd=!1};this.tr=()=>{this.s4();this.Ntd=!0};this.Pya=(kb,jb)=>{jb.v4===this.v4&&(jb.visible?this.Ntd||this.Yna():this.s4())};this.GJf=()=>{this.aEf(this.zO.domElement,
!1)};this.lAf=()=>{this.aEf(this.cM.domElement,!0)};this.vpc=(kb,jb)=>{this.ha.Bza(jb)};this.wpc=(kb,jb)=>{this.ha.Bza(G.b(jb))};this.rGb=()=>{3===D.a.zb?this.Yna():this.s4();this.xba&&1===D.a.zb&&this.J_d()};this.HJf=()=>{this.rxj()};this.wOe=()=>{this.s4()};this.xn=()=>{this.ha.Ra.dc&&this.s4()};this.$zf=()=>{this.s4()};this.SDf=(kb,jb)=>{this.J_d();3===jb.vb?this.Yna():this.s4()};this.rtc=()=>{this.jpb&&(this.s4(),this.Yna())};const oc=sb.$;this.Wt=sb;this.ha=sb.ha;this.hba=ta;this.Uuj=ya;this.paneType=
Qb;ta=this.domElement.currentStyle;ya="#000000";ta&&(ya=ta.borderTopColor);this.zO=new Y(this.Icd(),ya,oc);this.cM=new Y(this.Icd(),ya,oc);this.Hkf=oc.ea.isNamedObjectViewMode&&1===oc.workbookContext.NovMode;this.zO.Qqe(this.GJf);this.zO.Pqe(this.vpc);this.zO.Rqe(this.wpc);this.cM.Qqe(this.lAf);this.cM.Pqe(this.vpc);this.cM.Rqe(this.wpc);for(const kb of this.gridView.yn)m.a.instance.ta(w.a.pf,kb.domElement,this.$Df),m.a.instance.ta(w.a.ve,kb.domElement,this.ZDf);sb.view.Ps(this.Ew);sb.Vb.xl(this.wOe);
sb.Cb.yob(this.Pya);sb.iXc(this.$zf);oc.dC(this.rtc);sb.Uu(this.rtc);this.ha.q2(this.Xg);this.ha.z9(this.tr);sb.jE(this.xn);this.ha.F_b(this.SDf);D.a.$qe(this.rGb);l.TaskExtensions.za(h.GetServiceTaskFactory.Oa(oc.da,376,377,0),kb=>{kb.result.fPg(this.HJf)},oc.la,3)}get gridView(){return this.Wt}dispose(){H.a.pc([this.zO,this.cM]);this.zO.wWf(this.GJf);this.zO.vWf(this.vpc);this.zO.xWf(this.wpc);this.cM.wWf(this.lAf);this.cM.vWf(this.vpc);this.cM.xWf(this.wpc);for(var ta of this.gridView.yn)m.a.instance.Ba(w.a.pf,
ta.domElement,this.$Df),m.a.instance.Ba(w.a.ve,ta.domElement,this.ZDf);this.gridView.view.Mq(this.Ew);this.gridView.Vb.nl(this.wOe);this.gridView.Cb.cKb(this.Pya);this.gridView.NLd(this.$zf);this.gridView.$.zF(this.rtc);this.gridView.my(this.rtc);this.ha.Y_(this.Xg);this.ha.xda(this.tr);this.gridView.AF(this.xn);this.ha.Fuc(this.SDf);D.a.FWf(this.rGb);this.xba&&n.ULS.sendTraceTag(537159314,0,15,"SelectionTouchGrippiesBehaviorBase.Dispose during autofill mode");(ta=this.gridView.$.da.Aa(376))&&ta.Rlj(this.HJf);
super.dispose()}vSa(){if(!this.hba.range||!this.hba.range.equals(this.odb))return!1;const ta=!this.gridView.NMa();return this.gridView.fb&&ta&&(this.odb.isRow||this.odb.Rg)?!1:this.xba?!0:3===D.a.zb}s4(){this.jpb&&(this.zO.set_visible(!1),this.cM.set_visible(!1),this.jpb=!1)}Yna(){if(this.vSa()){this.v1j();var ta=v.DOMElementExtensions.getBoundingClientRect(this.Hqb);ta||n.ULS.shipAssertTag(537159313,0,!1,"grippiesParentBounds is null. IsNamedObjectViewMode: {0}, isNov15: {1}, areGrippiesAttachedToNovFocusPane: {2}GridView.ContainerElement: {3}, Freezepanes: {4}",
this.gridView.$.ea.isNamedObjectViewMode,this.Hkf,this.jZc,this.gridView.pj,this.gridView.ib.fj);var ya=v.DOMElementExtensions.getBoundingClientRect(this.Uuj),sb=new Sys.UI.Bounds(ya.x-ta.x,ya.y-ta.y,ya.width,ya.height),Qb=this.odb,oc=Qb.topLeft,kb=Qb.bottomRight,jb=Qb.isRow||Qb.Rg;if(Qb.Rg){var Wb=this.rHh();Qb=sb.x-2*Y.Fwb(this.gridView);var wc=Wb;var Jc=sb.x+ya.width}else Qb.isRow?(Qb=Jc=this.qHh(),wc=sb.y-2*Y.Fwb(this.gridView),Wb=sb.y+ya.height):(wc=sb.y,Wb=sb.y+ya.height,this.gridView.rtl?(Qb=
sb.x+ya.width,Jc=sb.x):(Qb=sb.x,Jc=sb.x+ya.width));ya=Y.Cyd+(jb?0:Y.Fwb(this.gridView));this.zO.style.left=E.HelperMethods.sc(Qb-ya);this.zO.style.top=E.HelperMethods.sc(wc-ya);this.cM.style.left=E.HelperMethods.sc(Jc-ya);this.cM.style.top=E.HelperMethods.sc(Wb-ya);this.zO.set_visible(this.cjf(wc,Qb,oc,jb,ta));this.cM.set_visible(this.cjf(Wb,Jc,kb,jb,ta));this.jpb=!0}}cjf(ta,ya,sb,Qb,oc){const kb=v.DOMElementExtensions.getBoundingClientRect(this.gridView.Rf(this.paneType).domElement);oc=new Sys.UI.Bounds(kb.x-
oc.x-3,kb.y-oc.y-3,kb.width+6,kb.height+6);return(this.gridView.ib.Ai(sb)===this.paneType||Qb)&&I.a.XM(oc,new Sys.UI.Point(ya,ta))}v1j(){if(this.Hkf!==this.jZc){this.Hqb=null;const ta=this.Icd();this.zO.nkg(ta);this.cM.nkg(ta)}}rHh(){return(this.gridView.view.visibleArea.height+this.gridView.ib.height+Y.Cyd-Y.Fwb(this.gridView))/2}qHh(){return(this.gridView.view.visibleArea.width+this.gridView.ib.width+Y.Cyd-Y.Fwb(this.gridView))/2}VHf(){this.Yna()}Noi(ta){return v.DOMElementExtensions.nRa(ta.Mb,
S.a.jo)&&(this.Qpi(ta)||this.Rpi(ta))}Rpi(ta){if(this.gridView.rtl)ta=ta.clientPoint.x;else{const ya=v.DOMElementExtensions.getBoundingClientRect(ta.Mb);ta=ta.clientPoint.x-(ya.x+ya.width-N.a.Bu)}return 0<ta&&ta<=N.a.Bu}Qpi(ta){const ya=v.DOMElementExtensions.getBoundingClientRect(ta.Mb);ta=ta.clientPoint.y-(ya.y+ya.height-N.a.Bu);return 0<ta&&ta<=N.a.Bu}aEf(ta,ya){this.xba&&n.ULS.sendTraceTag(537159312,0,50,"SelectionTouchGrippiesBehaviorBase: Performing Touch Autofill");this.ha.p1c(ta,ya,this.xba);
this.s4()}rxj(){this.xba||(n.ULS.sendTraceTag(537159311,0,50,"SelectionTouchGrippiesBehaviorBase.SetAutoFillMode"),this.xba=!0,this.zO.Q3f(),this.cM.Q3f(),this.gridView.ha.sourceRange=this.gridView.ha.qa.ld,this.Yna())}J_d(){this.xba&&(n.ULS.sendTraceTag(537159310,0,50,"SelectionTouchGrippiesBehaviorBase.UnsetAutoFillMode"),this.xba=!1,this.zO.Big(),this.cM.Big())}Icd(){this.Hqb||(this.jZc=!1,this.Hqb=this.gridView.pj);return this.Hqb}}Object(r.a)(Z,"SelectionTouchGrippiesBehaviorBase",U,[]);class ea extends Z{constructor(ta,
ya,sb,Qb){super(ta,ya,sb,Qb)}get v4(){return 19}get odb(){return this.gridView.ha.qa.activeRange}vSa(){const ta=this.gridView.Vh||this.gridView.fb;return!this.gridView.ha.qa.Tg&&!ta&&super.vSa()}}Object(r.a)(ea,"DiscontinuousSelectionTouchGrippiesBehavior",Z,[]);var ra=a(382);class O extends U{constructor(ta){super(ta);const ya=document.createElement("div");ya.className=V.a.GCh;ta.appendChild(ya)}}Object(r.a)(O,"SelectionBorderBehavior",U,[]);class da{}da.jCh="ewr-selection-draghandle";da.oCh="ewr-selection-draghandle-grab";
da.zCh="ewr-selection-draghandle-top-ie";da.ACh="ewr-selection-draghandle-top-ie-enhanced";da.xCh="ewr-selection-draghandle-top";da.yCh="ewr-selection-draghandle-top-enhanced";da.mCh="ewr-selection-draghandle-bottom-ie";da.nCh="ewr-selection-draghandle-bottom-ie-enhanced";da.kCh="ewr-selection-draghandle-bottom";da.lCh="ewr-selection-draghandle-bottom-enhanced";da.rCh="ewr-selection-draghandle-left-ie";da.sCh="ewr-selection-draghandle-left-ie-enhanced";da.pCh="ewr-selection-draghandle-left";da.qCh=
"ewr-selection-draghandle-left-enhanced";da.vCh="ewr-selection-draghandle-right-ie";da.wCh="ewr-selection-draghandle-right-ie-enhanced";da.tCh="ewr-selection-draghandle-right";da.uCh="ewr-selection-draghandle-right-enhanced";da.BCh="ewr-selection-dragtooltip";da.CCh="ewr-selection-dragtooltip-updated";da.NCh="ewr_selection_rearrangeleft";da.OCh="ewr_selection_rearrangeright";da.PCh="ewr_selection_rearrangetop";da.MCh="ewr_selection_rearrangebottom";da.selecting="selecting";da.QCh="ewr-selection-resizemarqueehandle";
da.TCh="ewr-selection-resizemarqueehandle-topleft";da.UCh="ewr-selection-resizemarqueehandle-topright";da.RCh="ewr-selection-resizemarqueehandle-bottomleft";da.SCh="ewr-selection-resizemarqueehandle-bottomright";da.$Bh="ewr-marquee-thick";da.dCh="ewr-resizemarqueehandle-thick";Object(r.a)(da,"CssClassNames",null,[]);var xa=a(252),ia=a(21);class Ma extends O{constructor(ta,ya,sb,Qb){super(ta);this.eTa=!1;this.Gne=this.Hne=null;this.Mra=0;this.qr=P.EwaSettings.getBooleanFeatureGate(ra.a.E8b,!1);this.koi=
P.EwaSettings.getBooleanFeatureGate(ra.a.Cph,!1);this.T1d=this.pmd=this.V2=0;this.WV=this.Gb=this.sourceRange=this.Jma=null;this.Wg=oc=>{oc=ba.a(this.$).me(oc);return this.HGf(oc)};this.onPointerDown=oc=>{oc=ba.a(this.$).me(oc);if(2===oc.vb&&oc.Sn===Sys.UI.MouseButton.leftButton&&!this.eTa){var kb=this.Pid(oc);if(!kb)return n.ULS.shipAssertTag(537159379,0,!1,"DragSelectionClickBehaviorBase.OnPointerDown: GetSelectedRange failed"),!1;this.Gb=kb.clone();this.sourceRange=this.Gb.clone();this.Jma=this.Gb;
if(kb=this.gZh(oc))this.Om=5,this.T1d=kb.top-this.sourceRange.top,this.pmd=kb.left-this.sourceRange.left,ia.h(this.$).Gg.vp(this.qr?Ma.dub:Ma.QNe),this.eEd(oc),this.eTa=!0,xa.b(this.$,!0)}return!1};this.Ti=oc=>{oc=ba.a(this.$).me(oc);if(this.qr&&this.fEd(oc))return!0;if(oc=this.ha.Xp(oc.clientPoint,oc.Mb,5,void 0,void 0,!0)){oc=this.Mqb(oc);if(this.Gb.equals(oc))return!0;this.Gb=oc;if(!this.jS())return n.ULS.shipAssertTag(537159378,0,!1,"DragSelectionClickBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),
this.H$b(!0),!1}return!0};this.dd=(oc,kb)=>{kb.cN||(P.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")?this.Jdb(this.$.isEditMode&&this.seb()):this.Jdb(this.$.isEditMode))};this.JC=[];this.$=ya;this.ha=ia.h(this.$).ha;this.paneType=sb;this.Po=Qb;ya=P.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");ya=this.koi?ya?[da.yCh,da.lCh,da.qCh,da.uCh]:[da.ACh,da.nCh,da.sCh,da.wCh]:ya?[da.xCh,da.kCh,da.pCh,da.tCh]:[da.zCh,da.mCh,da.rCh,da.vCh];for(const oc of ya)ya=
this.Po.EHe(ta,oc,this.qr?[da.oCh]:[da.jCh],this.onPointerDown),this.JC.push(ya);this.$.Lk(this.dd);P.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")||this.Jdb(this.$.isEditMode)}get Cb(){return ia.h(this.$).Cb}get Om(){return this.ha.selectionType}set Om(ta){this.ha.selectionType=ta}dispose(){this.JC.forEach(ta=>{z.a.instance.Ba(w.a.pointerDown,ta,this.onPointerDown)});this.JC.length=0;this.Jma=this.sourceRange=this.Gb=null;n.ULS.sendTraceTag(537159381,0,50,`DragSelectionClickBehaviorBase.Dispose: ActiveRegistrationCount = ${this.Mra}, EwaControl is null : ${!this.$}`);
this.$&&(this.$.pl(this.dd),1===this.Mra&&(n.ULS.sendTraceTag(537159380,0,15,"DragSelectionClickBehaviorBase.Dispose: Some handlers are still registered"),this.hJ(this.Gne,this.Hne,!1)));super.dispose()}HGf(ta){if(5!==this.Om)return!1;(ta=this.aPa(ta))||this.H$b(!1);xa.b(this.$,!1);return ta}PN(ta,ya){n.ULS.shipAssertTag(537159377,0,!this.Mra,"DragSelectionClickBehaviorBase.RegisterHandlersForMouse: More than one active registration is not expected");this.Mra+=1;this.Gne=ta;this.Hne=ya;this.Po.PN(ta,
ya,this.FZd())}Mqb(ta){if(!ta||!this.Gb)return n.ULS.shipAssertTag(537159376,0,!!ta,"DragSelectionClickBehaviorBase.CalculateDragRange: mouseSelectionRange is null"),n.ULS.shipAssertTag(537159375,0,!!this.Gb,"DragSelectionClickBehaviorBase.CalculateDragRange: CurrentRange is null"),null;const ya=this.Gb.clone();1!==this.V2&&(ya.left=Math.max(ta.left-this.pmd,1),ya.right=ya.left+this.sourceRange.width-1);2!==this.V2&&(ya.top=Math.max(ta.top-this.T1d,1),ya.bottom=ya.top+this.sourceRange.height-1);return this.Lob(ya)}hJ(ta,
ya,sb=!0,Qb=!0){n.ULS.shipAssertTag(537159374,0,1===this.Mra,"DragSelectionClickBehaviorBase.CleanUp: Expected exactly one active registration");--this.Mra;this.qr||ia.h(this.$).Gg.vp(u.a.QU);this.Po.F_d(ta,ya,this.FZd());sb&&this.vCe(Qb);this.V2=0;this.eTa=!1}Lob(ta){var ya=ia.h(this.$);let sb=ta;if(ya.ib.o4){if(!ya.Pb(ta.topLeft)){ya=ya.Wj("DragSelectionClickBehaviorBase.AdjustHiddenRowColumns",ya.jQ,this.Jma.top!==ta.top?1:2);try{ya.Ik=this.Jma.top<ta.top||this.Jma.left<ta.left,ya.xv(ta.topLeft),
sb=ya.$$cu().range}finally{ya&&ya.dispose()}}sb.right=sb.left+ta.width-1;sb.bottom=sb.top+ta.height-1}return this.Jma=sb}Jdb(ta){this.JC.forEach(ya=>{v.DOMElementExtensions.setVisible(ya,ta)})}gZh(ta){const ya=ta.Mb;ta=ta.clientPoint;if(!ya||!ta)return n.ULS.shipAssertTag(537159373,0,!!ya,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: source is null"),n.ULS.shipAssertTag(537159372,0,!!ta,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: point is null"),null;ta.y+=ya===this.JC[Ma.H8b]?
2:ya===this.JC[Ma.TNe]?-2:0;ta.x+=ya===this.JC[Ma.VNe]?2:ya===this.JC[Ma.G8b]?-2:0;return this.ha.Xp(ta,ya,5,void 0,void 0,!0)}}Ma.QNe="move";Ma.$4c="copy";Ma.dub="grabbing";Ma.H8b=0;Ma.TNe=1;Ma.VNe=2;Ma.G8b=3;Object(r.a)(Ma,"DragSelectionClickBehaviorBase",O,[]);class Ta extends Ma{constructor(ta,ya,sb,Qb,oc,kb){super(ta,ya,sb,oc);this.eb=this.EF=null;this.N$e=()=>{this.H$b(!0)};P.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")&&this.Jdb(this.seb()&&this.$.isEditMode);
this.gridView=ia.h(this.$);this.kF=Qb;this.coloredReferencesManager=this.$.da.Aa(281);n.ULS.shipAssertTag(537159391,0,!!this.coloredReferencesManager,"DragMarqueeClickBehavior Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");if(this.UM=x.a.tH(this.$))ta=this.$.da.Aa(464),n.ULS.shipAssertTag(512312961,0,!!ta,"DragMarqueeClickBehavior Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen."),this.LA=ta.LA;
for(const jb of this.JC)z.a.instance.ta(w.a.XV,jb,this.kF.ddf),z.a.instance.ta(w.a.qB,jb,this.kF.edf);this.oZa(kb)}oZa(ta){this.Po.AMb(ta,this.JC);this.kF.eAa()}eEd(ta){n.ULS.sendTraceTag(537159390,0,50,"DragMarqueeClickBehavior.OnPointerDownInternal: Starting drag marquee operation.");this.gridView.PLa=!0;this.eb.qE(!1);this.Om=5;this.kF.XNe(ta.Mb);this.eb.textBox.removeSelection();this.eb.Q_b(this.N$e);this.PN(this.Ti,this.Wg);this.V2=this.sourceRange.isRow?1:this.sourceRange.Rg?2:0}aPa(){const ta=
this.GW();this.Om=-1;this.hJ(this.Ti,this.Wg);return ta}vCe(){this.gridView.PLa=!1;this.kF.YNe(this.JC[0]);this.eb.textBox.setCaretPositionToEnd();this.eb.Quc(this.N$e);this.Po.HSf()}H$b(ta){n.ULS.sendTraceTag(537159389,0,10,"DragMarqueeClickBehavior.FailureFallback: Operation failed, will try to recalculate colored references as a fallback in CleanUp.");ta&&this.hJ(this.Ti,this.Wg)}Pid(ta){this.eb=this.Po.rbc();this.EF=this.Po.j7e(ta);return this.eb&&this.EF&&this.EF.range?this.EF.range:(n.ULS.shipAssertTag(537159388,
0,!!this.eb,"DragMarqueeClickBehavior.GetSelectedRange: cellContentEditor is null"),n.ULS.shipAssertTag(537159387,0,!!this.EF,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState is null"),n.ULS.shipAssertTag(537159386,0,!!this.EF.range,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState.Range is null"),null)}GW(){return this.EF?this.UM?this.LA.PEb(this.eb,this.EF,this.Gb):this.coloredReferencesManager.PEb(this.eb,this.EF,this.Gb):(n.ULS.shipAssertTag(537159385,0,!1,"DragMarqueeClickBehavior.SetSelectedRange called when selectedHighlightState is null. It shouldn't be null while dragging a marquee highlight."),
!1)}jS(){return this.GW()}FZd(){return!0}fEd(){return!1}seb(){return!0}}Object(r.a)(Ta,"DragMarqueeClickBehavior",Ma,[]);var Da=a(86),fa=a(110),ua=a(174),Fa=a(83),ca=a(421),ka=a(724),Ca=a(228),fb=a(29),yb=a(45);class mb extends Ma{constructor(ta,ya,sb,Qb,oc){super(ta,ya,sb,oc);this.ir=null;this.Rg=this.isRow=!1;this.Xg=()=>{this.domElement.classList.remove(da.selecting)};this.tr=()=>{this.domElement.classList.add(da.selecting)};this.Uc=()=>{if(this.$.isEditMode){const kb=this.seb();this.Jdb(kb)}};
this.tableManager=Qb;P.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")&&this.Jdb(this.seb()&&this.$.isEditMode);this.dm={};this.dz=!1;this.ha.z9(this.tr);this.ha.q2(this.Xg);this.ha.UL(this.Uc);this.D1d=this.$.isChangeGateEnabled("OfficeVSO:7148113_FixShowToolTipBug7144260")}dispose(){this.ha&&(this.ha.xda(this.tr),this.ha.Y_(this.Xg),this.ha.zR(this.Uc),P.EwaSettings.isChangeGateEnabled("OfficeVSO:7117157_ChangesInDragDropRefactoredCode")||this.ha.cvc(this.S$a));if(this.dm)for(let ta=
1;4>=ta;ta++)v.DOMElementExtensions.vf(this.dm[ta.toString()]);this.dm=this.ir=null;super.dispose()}vCe(ta){ta&&(this.qr&&ia.h(this.$).Gg.vp(u.a.QU),fa.KeyInputManager.instance.Ba(w.a.Sb,this.domElement.ownerDocument.body,this.onKeyDown),this.dz=!1);for(ta=1;4>=ta;ta++){const ya=this.dm[ta.toString()];ya&&ya.parentNode.removeChild(ya);this.dm[ta.toString()]=null}this.ir=null}Pid(){return this.ha.qa.ld}GW(){this.ha.updateSelection(this.Gb,this.Gb.topLeft,0);return!0}jS(ta=!1){this.Cb.wk(this.Gb,this.Qaa());
this.Cb.Qq(this.Qaa());this.nI(ta);return!0}Noa(ta=!1){this.Cb.wk(this.Gb,this.ir);this.Cb.Qq(this.ir);this.nI(ta)}H$b(){n.ULS.sendTraceTag(523638490,0,15,"DragSelectionClickBehaviorTemporary.FailureFallback: this function was not implemented for dragging selection")}FZd(){return!1}g7(ta,ya,sb,Qb,oc=!1){var kb=v.DOMElementExtensions.getBoundingClientRect(ya);let jb=ya===this.JC[Ma.H8b]||ya===this.JC[Ma.TNe];if(this.qr){var Wb=ya===this.JC[Ma.VNe]||ya===this.JC[Ma.G8b];this.isRow&&Wb||this.Rg&&jb?
Wb="100px":(jb=this.isRow||jb,Wb=(jb?oc?mb.dUj:mb.iUj:oc?mb.cUj:mb.fUj)+"px");ya=jb?ya===this.JC[Ma.H8b]?"top":"bottom":ya===this.JC[Ma.G8b]?"right":"left";ta=100*(jb?ta.x-kb.x:ta.y-kb.y)/(jb?kb.width:kb.height);for(kb=1;4>=kb;kb++){Qb=document.createElement("div");var wc=document.createElement("div");const Jc=document.createElement("div");Qb.appendChild(wc);Qb.appendChild(Jc);oc&&(wc=document.createElement("div"),Qb.appendChild(wc),Jc.style.fontWeight="bold");Qb.className=da.CCh;this.dm[kb.toString()]=
Qb;this.Cb.NC(sb,kb).hg.appendChild(Qb);Qb=this.dm[kb.toString()];Qb.style[ya]=Wb;Qb.style[jb?"left":"top"]=ta+"%"}}else for(oc=(jb?-mb.hUj:-mb.eUj)+"px",Wb=jb?ya===this.JC[Ma.H8b]?"top":"bottom":ya===this.JC[Ma.G8b]||Qb?"right":"left",ya=100*(jb?Qb?0:ta.x-kb.x:ta.y-kb.y)/(jb?kb.width:kb.height),ta=1;4>=ta;ta++)kb=document.createElement("div"),kb.className=da.BCh,this.dm[ta.toString()]=kb,this.Cb.NC(sb,ta).hg.appendChild(kb),kb=this.dm[ta.toString()],kb.style[Wb]=oc,kb.style[jb?"left":"top"]=ya+"%"}fkg(ta,
ya,sb){const Qb=ia.h(this.$),oc=Qb.xg(ta);var kb=Qb.Rf(this.paneType);sb=ka.a.Gu(kb.view.ki,this.domElement.parentNode,sb,Qb.rtl);kb=!1;let jb=2;ya&&sb.y-oc.topLeft.y>oc.height/2?(kb=!0,jb=1):!ya&&sb.x-oc.topLeft.x>oc.width/2&&(kb=!0);if(kb){ya=Qb.Wj("DragSelectionClickBehaviorTemporary.updateMouseSelectionRange",Qb.jQ,jb);try{ya.xv(ta),ya.$$mn(),ya.$$cu()}finally{ya&&ya.dispose()}}}lrb(ta){this.Cb.Nj(this.ir);this.hJ(this.nma,this.oma,void 0,ta)}OT(ta){this.Cb.Nj(this.Qaa());this.hJ(this.Ti,this.Wg,
void 0,ta)}Swb(){return this.qr?48:6}Qaa(){return this.qr?mb.Dph:mb.Gph}I6a(ta){return ta.Ea.keyCode===Da.a.Uoa||k.a.isMac&&ta.Ea.keyCode===Da.a.uUa}Zzb(ta){ta=ia.h(this.$).getRangeInformation(ta);for(let ya=0,sb=ta.length;ya<sb;++ya)if(Object(ca.a)(Ca.PivotTableRange,ta[ya]))return ta=fb.a.ed(1,0,901,900,0,2105176604,"InsDelCellsPivotTable"),yb.a(this.$).Jt([ta]),!0;return!1}}mb.eUj=50;mb.hUj=25;mb.fUj=-85;mb.iUj=-40;mb.cUj=-120;mb.dUj=-50;mb.Gph=[6];mb.Dph=[48];Object(r.a)(mb,"DragSelectionClickBehaviorTemporary",
Ma,[]);var nb=a(24),X=a(796),R=a(41),wa=a(193),na=a(113),Ba=a(282),Ra=a(60);const qa=(ta,ya,sb,Qb,oc,kb,jb,Wb=null)=>{Wb=ta.Na(41,Wb);Wb.sourceRange=ya;Wb.destinationRange=sb;return Ra.g(ta,"RearrangeRowColumn",Wb,Qb,oc,kb,jb,0)},La=(ta,ya,sb,Qb,oc,kb,jb=null)=>{jb=ta.Na(1,jb);jb.moveRange=ya;return Ra.g(ta,"MoveLineItems",jb,sb,Qb,oc,kb,0)};class Yb{constructor(ta,ya){this.destinationRange=this.sourceRange=null;this.sourceRange=ta;this.destinationRange=ya}}Object(r.a)(Yb,"MacroRecorderTableRowColumnRearrangedPayload",
null,[162]);var mc=a(13);class Zb extends mb{constructor(ta,ya,sb,Qb,oc){super(ta,ya,sb,Qb,oc);this.bea=null;this.UQ=this.VQ=!1;this.Jof=0;this.QAa=this.Yta=null;this.sJ=0;this.I8b=mc.a.instance.ga(2268);this.ZNe=mc.a.instance.ga(2269);this.fzc=mc.a.instance.ga(2270);this.Q7f=mc.a.instance.ga(2271);this.onKeyDown=kb=>{if(this.qr){if(this.I6a(kb)||kb.Ea.keyCode===Da.a.vUa)return this.JMa||(fa.KeyInputManager.instance.ta(w.a.Ld,this.domElement.ownerDocument.body,this.onKeyUp),this.JMa=!0),!this.NZ&&
this.I6a(kb)&&(ia.h(this.$).Gg.vp(Ma.$4c),this.NZ=!0),this.OZ||kb.Ea.keyCode!==Da.a.vUa||(ia.h(this.$).Gg.vp(Ma.dub),this.OZ=!0,2===this.sJ?(this.OT(!1),this.V2=0,this.ir=this.UQ?[11]:[12],this.VQ=this.UQ,this.GKd(),this.Noa()):3===this.sJ?(this.krb(!1),this.V2=this.isRow?1:2,this.Sma(),this.jS()):1===this.sJ&&(this.lrb(!1),this.Sma(),this.jS())),!0}else if(!this.NZ&&(kb.Ea.keyCode===Da.a.Uoa||k.a.isMac&&kb.Ea.keyCode===Da.a.uUa))return fa.KeyInputManager.instance.ta(w.a.Ld,this.domElement.ownerDocument.body,
this.onKeyUp),ia.h(this.$).Gg.vp(Ma.$4c),this.NZ=!0;return!1};this.onKeyUp=kb=>{if(this.qr){if(this.I6a(kb)||kb.Ea.keyCode===Da.a.vUa)return this.Jof=this.I6a(kb)?0:1,this.dz&&ia.h(this.$).Gg.vp(Ma.dub),kb.Ea.keyCode===Da.a.vUa&&(2===this.sJ?(this.krb(!1),this.V2=0,this.Sma(!0),this.jS(!0)):3===this.sJ?(this.OT(!1),this.V2=this.isRow?1:2,this.ir=this.isRow?[11]:[12],this.GKd(!0),this.Noa(!0)):1===this.sJ&&(this.OT(!1),this.ir=this.UQ?[11]:[12],this.nJb(!0),this.Noa(!0))),this.tDc(this.Jof),!0}else if(kb.Ea.keyCode===
Da.a.Uoa||k.a.isMac&&kb.Ea.keyCode===Da.a.uUa)return this.tDc(),this.dz&&ia.h(this.$).Gg.vp(Ma.QNe),!0;return!1};this.oma=kb=>{kb=ba.a(this.$).me(kb);5===this.Om?this.HGf(kb):(this.dz=!1,this.Cb.Nj(this.ir),!this.$.Us([this.Gb],!1)||this.Idj()||this.Ekf()||(this.ha.sourceRange=this.sourceRange.clone(),this.qr?this.X9i():this.kWe(),this.Jba()?this.Gb.top>this.sourceRange.top&&(kb=this.Gb.height,this.Gb.top-=kb,this.Gb.bottom-=kb):this.Gb.left>this.sourceRange.left&&(kb=this.Gb.width,this.Gb.left-=
kb,this.Gb.right-=kb),this.GW()),this.Cwd());this.hJ(this.nma,this.oma);this.tableRange=null;this.Om=-1;this.qr&&(this.bea=null,this.sJ=0);return!0};this.IGb=()=>{this.dz=!1;this.sJ=0;this.Cb.Nj(this.ir);if(!this.$.Us([this.Gb],!1))return this.hJ(this.HGb,this.IGb),this.Om=-1,!0;if(!(this.ha.qa.ld.equals(this.Gb)||this.Zzb(this.Gb)||this.Zzb(this.sourceRange)||this.Ekf()||(this.GW(),this.ha.sourceRange=this.sourceRange.clone(),this.$.Yc(-694765314,2,30,{[u.a.UIa]:this.NZ,[u.a.n9c]:!0,[u.a.o9c]:this.VQ,
[u.a.iaa]:this.ha.sourceRange,[u.a.haa]:this.ha.qa.ld,[u.a.aub]:this.OZ}),this.NZ))){if(this.Gb.top>this.sourceRange.top&&(this.isRow||this.Gb.left===this.sourceRange.left&&this.VQ)){var kb=this.Gb.height;this.Gb.top-=kb;this.Gb.bottom-=kb}else this.Gb.left>this.sourceRange.left&&(this.Rg||this.Gb.top===this.sourceRange.top&&!this.VQ)&&(kb=this.Gb.width,this.Gb.left-=kb,this.Gb.right-=kb);this.GW()}this.hJ(this.HGb,this.IGb);this.bea=this.tableRange=null;this.Om=-1;this.VQ=!1;this.Cwd();return!0};
this.nma=kb=>{const jb=P.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");jb&&(kb=ba.a(this.$).me(kb));var Wb=kb.clientPoint;jb||(kb=ba.a(this.$).me(kb));this.qr&&(this.WV=kb);if(kb=this.ha.Xp(Wb,kb.Mb,5,void 0,void 0,!0)){if(this.tableRange.contains(kb.topLeft)){if(this.fkg(kb,this.Jba(),Wb),this.Gb=this.dHa(kb),this.ha.sourceRange=this.Gb,this.Cb.wk(this.Gb,this.ir),this.Cb.Qq(this.ir),this.Cb.Nj(this.Qaa()),6!==this.Om){for(Wb=1;4>=Wb;Wb++)kb=this.dm[Wb.toString()],
kb.parentNode.removeChild(kb),this.Cb.NC(this.Jba()?11:12,Wb).hg.appendChild(kb);this.Om=6}}else if(this.Gb=this.Mqb(kb),this.qr)this.n$e(!1);else if(this.Cb.wk(this.Gb,this.Qaa()),this.Cb.Qq(this.Qaa()),this.Cb.Nj(this.ir),5!==this.Om){for(Wb=1;4>=Wb;Wb++)kb=this.dm[Wb.toString()],kb.parentNode.removeChild(kb),this.Cb.NC(this.Swb(),Wb).hg.appendChild(kb);this.Om=5}this.nI()}return!0};this.HGb=kb=>{var jb=P.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");jb&&(kb=
ba.a(this.$).me(kb));var Wb=kb.clientPoint;jb||(kb=ba.a(this.$).me(kb));this.WV=kb;if(jb=this.ha.Xp(Wb,kb.Mb,5,void 0,void 0,!0)){if(this.Uaf(jb))return this.Gb=this.Mqb(jb),this.m$e(!1),!0;var wc=ia.h(this.$),Jc=wc.xg(jb),zc=wc.Rf(this.paneType);Wb=ka.a.Gu(zc.view.ki,this.domElement.parentNode,Wb,wc.rtl);zc=!1;let gd=2;this.VQ=!1;if(this.isRow||this.Rg){this.isRow&&Wb.y-Jc.topLeft.y>Jc.height/2?(zc=!0,gd=1):this.Rg&&Wb.x-Jc.topLeft.x>Jc.width/2&&(zc=!0);if(zc){kb=wc.Wj("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",
wc.jQ,gd);try{kb.xv(jb),kb.$$mn(),jb=kb.$$cu().range}finally{kb&&kb.dispose()}}this.Gb=this.Mqb(jb)}else{Wb.x-Jc.topLeft.x===Jc.width?(this.VQ=!1,zc=!0):Wb.y-Jc.topLeft.y>Jc.height/2&&(this.VQ=zc=!0,gd=1);this.bea&&(this.VQ=this.UQ);if(zc){wc=wc.Wj("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",wc.jQ,gd);try{wc.xv(jb),wc.$$mn(),jb=wc.$$cu().range}finally{wc&&wc.dispose()}}this.Cb.Nj(this.ir);this.ir=this.VQ?[11]:[12];for(wc=1;4>=wc;wc++)(Jc=this.dm[wc.toString()])&&Jc.parentNode.removeChild(Jc),
this.dm[wc.toString()]=null;this.g7(kb.clientPoint,kb.Mb,this.VQ?11:12,!0);this.Gb=this.dHa(jb)}this.ha.sourceRange=this.Gb;this.Cb.wk(this.Gb,this.ir);this.Cb.Qq(this.ir);this.Cb.Nj(this.Qaa());if(6!==this.Om){for(kb=1;4>=kb;kb++)jb=this.dm[kb.toString()],jb.parentNode.removeChild(jb),this.Cb.NC(this.isRow||this.VQ?11:12,kb).hg.appendChild(jb);this.Om=6}this.nI()}return!0};this.S$a=()=>{this.qr?this.dz&&5<=this.Om&&(this.tableRange?this.OZ?this.OT(!0):this.lrb(!0):this.OZ?this.isRow||this.Rg?this.OT(!0):
this.krb(!0):this.isRow||this.Rg?this.krb(!0):this.OT(!0)):this.dz&&5<=this.Om&&(this.tableRange?(this.Cb.Nj(this.ir),this.hJ(this.nma,this.oma)):(this.Cb.Nj(this.Qaa()),this.hJ(this.Ti,this.Wg)))};this.tableRange=null;this.JMa=this.NZ=this.OZ=!1;this.ha.OXc(this.S$a)}dispose(){P.EwaSettings.isChangeGateEnabled("OfficeVSO:7117157_ChangesInDragDropRefactoredCode")&&this.ha&&this.ha.cvc(this.S$a);this.NZ&&this.tDc();this.qr&&this.OZ&&this.tDc(1);super.dispose()}eEd(ta){this.qr&&(this.WV=ta,this.bea=
null,this.UQ=this.isRow=this.Rg=this.VQ=!1,fa.KeyInputManager.instance.ta(w.a.Sb,this.domElement.ownerDocument.body,this.onKeyDown));this.dz=!0;this.tableRange=this.I0g(this.tableManager.Np(this.sourceRange.topLeft));ia.h(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.qr?(this.bea=this.tableRange,this.sJ=1,this.ir=(this.UQ=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.Om=6,this.PN(this.nma,this.oma),this.Yta=this.I8b,
this.QAa=this.fzc,this.g7(ta.clientPoint,ta.Mb,this.UQ?11:12,!0,!0),this.Noa(!0)):(this.ir=(this.isRow=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.Om=6,this.PN(this.nma,this.oma),this.g7(ta.clientPoint,ta.Mb,this.isRow?11:12,!0)):(this.tableRange=null,this.qr?(this.isRow=this.sourceRange.isRow,this.Rg=this.sourceRange.Rg,this.isRow||this.Rg?(this.sJ=3,this.V2=this.isRow?1:2,this.Om=6,this.ir=this.isRow?[11]:[12],this.PN(this.HGb,this.IGb),
this.Yta=this.I8b,this.QAa=this.fzc,this.g7(ta.clientPoint,ta.Mb,this.isRow?11:12,!0,!0),this.Noa(!0)):(this.sJ=2,this.V2=0,this.PN(this.Ti,this.Wg),this.Yta=this.ZNe,this.QAa=this.Q7f,this.g7(ta.clientPoint,ta.Mb,this.Swb(),!1,!0),this.jS(!0))):(this.PN(this.Ti,this.Wg),fa.KeyInputManager.instance.ta(w.a.Sb,this.domElement.ownerDocument.body,this.onKeyDown),this.V2=this.sourceRange.isRow?1:this.sourceRange.Rg?2:0,this.g7(ta.clientPoint,ta.Mb,this.Swb(),!1),this.jS()))}aPa(){this.dz=!1;this.qr&&(this.sJ=
0);this.Cb.Nj(this.Qaa());if(!this.$.Us([this.Gb],!1))return this.hJ(this.Ti,this.Wg),this.Om=-1,!0;if(this.ha.qa.ld.equals(this.Gb)||this.Zzb(this.Gb)||this.Zzb(this.sourceRange))this.Om=-1;else{this.GW();this.ha.sourceRange=this.sourceRange.clone();const ta=this.ha.sourceRange,ya=this.ha.qa.ld;this.qr?this.$.Yc(-694765314,2,30,{[u.a.UIa]:this.NZ,[u.a.iaa]:ta,[u.a.haa]:ya,[u.a.aub]:this.OZ}):this.$.Yc(-694765314,2,30,{[u.a.UIa]:this.NZ,[u.a.iaa]:ta,[u.a.haa]:ya})}!this.qr&&this.tableRange||this.hJ(this.Ti,
this.Wg);this.Cwd();return!0}fEd(ta){const ya=this.ha.Xp(ta.clientPoint,ta.Mb,5,void 0,void 0,!0);this.WV=ta;return this.Uaf(ya)?(this.Gb=this.dHa(ya),this.m$e(!0),!0):this.ebi(ya)?(this.Gb=this.Mqb(ya),this.n$e(!0),!0):!1}nI(ta=!1){const ya=this.Gb.toString();if(this.qr)for(var sb=1;4>=sb;sb++)if(this.D1d){const Qb=this.dm[sb.toString()];Qb&&Qb.childNodes&&0<Qb.childNodes.length&&(Qb.childNodes[0].innerText=ya,Qb.childNodes[1].innerText=this.Yta,ta&&(Qb.childNodes[2].innerText=this.QAa))}else this.dm[sb.toString()].childNodes[0].innerText=
ya,this.dm[sb.toString()].childNodes[1].innerText=this.Yta,ta&&(this.dm[sb.toString()].childNodes[2].innerText=this.QAa);else for(ta=1;4>=ta;ta++)if(this.D1d){if(sb=this.dm[ta.toString()])sb.innerText=ya}else this.dm[ta.toString()].innerText=ya}Uaf(ta){return!!this.bea&&1!==this.sJ&&!!ta&&this.bea.contains(ta.topLeft)}ebi(ta){return!!this.bea&&1===this.sJ&&!!ta&&!this.bea.contains(ta.topLeft)}m$e(ta){this.tableRange=this.bea;this.sJ=1;const ya=!this.OZ;ta?(this.OT(!1),this.ir=this.UQ?[11]:[12],this.nJb(ya),
this.Noa(ya)):(this.krb(!1),this.Sma(ya),this.jS(ya))}n$e(ta){this.tableRange=null;this.sJ=2;const ya=!this.OZ;ta?(this.OT(!1),this.ir=this.UQ?[11]:[12],this.VQ=this.UQ,this.GKd(ya),this.Noa(ya)):(this.lrb(!1),this.Sma(ya),this.jS(ya))}seb(){if(!ia.h(this.$).ha.qa.Tg)return!1;const ta=ia.h(this.$).getRangeInformation(this.ha.qa.ld);for(const ya of ta)if(Object(ca.a)(Ca.PivotTableRange,ya))return!1;return!0}I0g(ta){if(ta&&ta.contains(this.sourceRange)&&!ta.equals(this.sourceRange)){if(ta.dka&&this.sourceRange.bottom===
this.sourceRange.top&&this.sourceRange.top===ta.top){const ya=new nb.Range(this.sourceRange.top,this.sourceRange.left,ta.bottom,this.sourceRange.right,!1,!1);if(!ya.equals(ta))return this.sourceRange=ya,this.ha.updateSelection(this.sourceRange,this.sourceRange.topLeft,0),ta}this.qr?this.UQ=ta.left===this.sourceRange.left&&ta.right===this.sourceRange.right:this.isRow=ta.left===this.sourceRange.left&&ta.right===this.sourceRange.right;if(ta.top===this.sourceRange.top&&ta.bottom===this.sourceRange.bottom||
this.Jba())return ta}return null}dHa(ta){const ya=ta.clone();this.Jba()?ya.left=Math.max(ta.left-this.pmd,1):ya.top=Math.max(ta.top-this.T1d,1);ya.right=ya.left+this.sourceRange.width-1;ya.bottom=ya.top+this.sourceRange.height-1;return this.Lob(ya)}Ekf(){const ta=this.Gb.topLeft.zd(this.sourceRange);return ta||this.qr&&!this.tableRange?ta:this.Jba()?this.Gb.top===this.sourceRange.bottom+1:this.Gb.left===this.sourceRange.right+1}Idj(){if(this.Jba()&&this.Gb.left!==this.tableRange.left||!this.Jba()&&
this.Gb.top!==this.tableRange.top){const ta=fb.a.ed(1,1,0,917,0,2065438552,"RearrangeInvalidDest");yb.a(this.$).Jt([ta]);return!0}return!1}X9i(){const ta=this.$.Jb.Gc("UserAction","RearrangeRowColumnClientSide"),ya={["CopyPasteTargetType"]:1,["OperationId"]:ua.a.create().toString(),["Stopwatch"]:ta,["DragDropIsShiftKeyDown"]:this.OZ,["EncounteredDeploymentErrors"]:!1},sb=this.NZ?2:1,Qb=this.$.da.Aa(254);(new Promise((oc,kb)=>{this.kWe(jb=>{jb.Errors&&0<jb.Errors.length?kb(new X.a(22,jb.Errors)):oc(!0)},
jb=>{jb=na.a.Pe(jb.data);kb(new X.a(22,jb))})})).then(()=>{n.ULS.sendTraceTag(520747156,0,50,'DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: success. copyPasteTargetType="1"');Qb&&Qb.UDi(ya,sb,this.sourceRange,this.Gb);return Promise.resolve(!0)},oc=>{n.ULS.sendTraceTag(520747155,0,10,`DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: ${oc?copyPasteInfra.getStringifiedError(oc):"null"}, copyPasteTargetType="${1}"`);return Qb?Qb.zYi(oc,ya,sb,this.sourceRange,this.Gb):
Promise.reject(oc)})}kWe(ta=null,ya=null){const sb={};this.Jba()?(sb.FirstRow=this.Gb.top-1,sb.FirstColumn=0,sb.DeltaColumn=0,sb.DeltaRow=this.Gb.bottom-this.Gb.top+1):(sb.FirstRow=0,sb.FirstColumn=this.Gb.left-1,sb.DeltaColumn=this.Gb.right-this.Gb.left+1,sb.DeltaRow=0);sb.LastRow=aa.a.eB;sb.LastColumn=aa.a.dy;sb.SheetName=this.$.va.na?this.$.va.na.name:this.$.yb.getItemByName(this.$.yb.na.name).sheetName;const Qb=R.v(this.sourceRange,this.$);this.$.userOperationManager.Jc(new wa.a(514,0,(oc,kb,
jb)=>qa(this.$.oa.xa,Qb,sb,ta?Ba.b(oc,ta):oc,ya?Ba.a(kb,ya):kb,jb,null),64,()=>new Yb(Qb,sb)),null)}tDc(ta=0){0===ta?this.NZ=!1:1===ta&&(this.OZ=!1);this.qr&&(this.NZ||this.OZ)||(fa.KeyInputManager.instance.Ba(w.a.Ld,this.domElement.ownerDocument.body,this.onKeyUp),this.JMa=!1)}Sma(ta=!1){this.Om=5;this.PN(this.Ti,this.Wg);this.Yta=this.ZNe;this.QAa=this.Q7f;this.g7(this.WV.clientPoint,this.WV.Mb,this.Swb(),!1,ta)}GKd(ta=!1){this.Om=6;this.PN(this.HGb,this.IGb);this.Yta=this.I8b;this.QAa=this.fzc;
this.g7(this.WV.clientPoint,this.WV.Mb,this.isRow||this.UQ?11:12,!0,ta)}nJb(ta=!1){this.Om=6;this.PN(this.nma,this.oma);this.Yta=this.I8b;this.QAa=this.fzc;this.g7(this.WV.clientPoint,this.WV.Mb,this.Jba()?11:12,!0,ta)}Jba(){return!this.qr&&this.isRow||this.qr&&this.UQ}krb(ta){this.Cb.Nj(this.ir);this.hJ(this.HGb,this.IGb,void 0,ta)}Cwd(){const ta=Fa.a.instance.Tb("Common.ISystemInitiatedFeedback");ta&&ta.execute(ya=>{ya.logActivity("DragDrop",null)})}}Object(r.a)(Zb,"DragSelectionClickBehaviorCellRangeAndTable",
mb,[]);var qb=a(320),Ha=a(140);class Ya extends mb{constructor(ta,ya,sb,Qb,oc){super(ta,ya,sb,Qb,oc);this.S$a=()=>{this.dz&&this.lrb(!0);5===this.Om&&this.OT(!0)};this.oma=kb=>{ba.a(this.$).me(kb);this.dz=!1;this.Cb.Nj(this.ir);this.ha.sourceRange=this.sourceRange.clone();this.wmf?this.$.Yc(927125067,D.a.zb,30,null):this.Fwa?(this.GW(),this.ha.sourceRange=this.sourceRange.clone(),this.$.Yc(-694765314,2,30,{[u.a.UIa]:!0,[u.a.iaa]:this.ha.sourceRange,[u.a.haa]:this.ha.qa.ld,[u.a.aub]:!1}),n.ULS.sendTraceTag(509617280,
0,50,"DragSelectionClickBehaviorPivotTableRange.onPointerUpRearrange: dragDropCells"),ia.h(this.$).Gg.vp(u.a.QU),this.Fwa=!1):this.O9i();this.hJ(this.nma,this.oma);this.Om=-1;return!0};this.nma=kb=>{kb=ba.a(this.$).me(kb);const jb=kb.clientPoint;this.WV=kb;let Wb=this.ha.Xp(jb,kb.Mb,5,void 0,void 0,!0);if(Wb){if(!this.rsd(Wb))return this.g9h(kb),!0;this.fkg(Wb,this.isRow,jb);if(this.isRow||this.Rg)this.Gb=this.dHa(Wb);this.ha.sourceRange=this.Gb;this.Cb.wk(this.Gb,this.ir);this.Cb.Qq(this.ir);this.Cb.Nj(this.Qaa());
this.nI()}return!0};this.onKeyDown=kb=>this.I6a(kb)?(this.JMa||(fa.KeyInputManager.instance.ta(w.a.Ld,this.domElement.ownerDocument.body,this.onKeyUp),this.JMa=!0),this.Fwa||(ia.h(this.$).Gg.vp(Ma.$4c),this.Fwa=!0),!0):!1;this.onKeyUp=kb=>{this.I6a(kb)&&(fa.KeyInputManager.instance.Ba(w.a.Ld,this.domElement.ownerDocument.body,this.onKeyUp),this.JMa=!1,this.dz?ia.h(this.$).Gg.vp(Ma.dub):ia.h(this.$).Gg.vp(u.a.QU),this.Fwa=!1);return!0};this.JFf=kb=>{kb.Errors&&0<kb.Errors.length?(n.ULS.sendTraceTag(521410185,
0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsSuccess: Errors: [${fb.a.nc(kb.Errors)}]`),this.Gb.left=this.sourceRange.left,this.Gb.right=this.sourceRange.right,this.Gb.top=this.sourceRange.top,this.Gb.bottom=this.sourceRange.bottom):this.isRow?this.sourceRange.top<=this.Gb.top&&this.sourceRange.bottom>=this.Gb.top-1?(this.Gb.top=this.sourceRange.top,this.Gb.bottom=this.sourceRange.bottom):(this.sourceRange.top>this.Gb.top||(this.Gb.top-=this.sourceRange.height),this.Gb.bottom=this.Gb.top+
this.sourceRange.height-1):this.sourceRange.left<=this.Gb.left&&this.sourceRange.right>=this.Gb.left-1?(this.Gb.left=this.sourceRange.left,this.Gb.right=this.sourceRange.right):(this.sourceRange.left>this.Gb.left||(this.Gb.left-=this.sourceRange.width),this.Gb.right=this.Gb.left+this.sourceRange.width-1);this.GW();this.Om=-1};this.IFf=kb=>{kb=na.a.Pe(kb.data);n.ULS.sendTraceTag(521410184,0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsFail: Errors: [${fb.a.nc(kb)}]`)};this.ha.OXc(this.S$a);
this.Fwa=this.JMa=!1}dispose(){P.EwaSettings.isChangeGateEnabled("OfficeVSO:7117157_ChangesInDragDropRefactoredCode")&&this.ha&&this.ha.cvc(this.S$a);super.dispose()}eEd(ta){this.WV=ta;this.isRow=this.Rg=!1;this.dz=!0;fa.KeyInputManager.instance.ta(w.a.Sb,this.domElement.ownerDocument.body,this.onKeyDown);this.fc=this.tableManager.Kja(this.sourceRange);this.thf=this.Ssi(this.Gb);this.fc||n.ULS.sendTraceTag(512341332,0,50,"DragSelectionClickBehaviorPivotTableRange.onPointerDownInternal: pivotTableRange null for range {0}",
this.sourceRange);this.wmf=(new Ha.a(this.$.va)).Ph;ia.h(this.$);ia.h(this.$).Gg.vp(Ma.dub);this.rsd(this.Gb)?(this.isRow=this.Jti(),this.Rg=this.oni(),this.isRow||this.Rg?(this.v7a=!1,this.nJb(ta),this.Gb=this.dHa(this.Gb),this.Noa()):(this.v7a=!0,this.Sma(ta),this.jS())):(this.v7a=!0,this.Sma(ta),this.jS())}aPa(){return this.wmf?(this.$.Yc(927125067,D.a.zb,30,null),this.OT(!0),this.v7a=!1,this.Om=-1,!0):this.Fwa||P.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MovePivotTables",!1)&&
this.thf?(this.GW(),this.ha.sourceRange=this.sourceRange.clone(),this.$.Yc(-694765314,2,30,{[u.a.UIa]:this.Fwa,[u.a.iaa]:this.ha.sourceRange,[u.a.haa]:this.ha.qa.ld,[u.a.aub]:!1}),n.ULS.sendTraceTag(509617281,0,50,`DragSelectionClickBehaviorPivotTableRange.onPointerUpInternal: dragDropCells with isCopyOperation="${this.Fwa}"`),ia.h(this.$).Gg.vp(u.a.QU),this.OT(!0),this.dz=this.v7a=!1,this.Om=-1,this.thf=!1,!0):5===this.Om?(this.OT(!0),this.v7a=!1,this.HIj(),this.Om=-1,!0):!1}fEd(ta){const ya=this.ha.Xp(ta.clientPoint,
ta.Mb,5,void 0,void 0,!0);this.WV=ta;return this.v7a?!1:this.rsd(ya)?(this.h9h(ta),!0):!1}nI(){let ta=new nb.Range(this.Gb.top,this.Gb.left,this.Gb.bottom,this.Gb.right,!1,!0);6===this.Om&&(this.isRow?(--ta.top,ta.bottom=ta.top+this.Gb.height-1):(--ta.left,ta.right=ta.left+this.Gb.width-1));for(let ya=1;4>=ya;ya++)if(this.D1d){const sb=this.dm[ya.toString()];sb&&sb.childNodes&&0<sb.childNodes.length&&(sb.childNodes[0].innerText=ta.toString())}else this.dm[ya.toString()].childNodes[0].innerText=ta.toString()}seb(){if(!ia.h(this.$).ha.qa.Tg)return!1;
var ta=ia.h(this.$).getRangeInformation(this.ha.qa.ld);for(var ya of ta)if(Object(ca.a)(Ca.PivotTableRange,ya)&&(ta=this.tableManager.Kja(ya)))return ya=!ta.isOlap||!ta.oNa(!0),n.ULS.sendTraceTag(512341331,0,50,"DragSelectionClickBehaviorPivotTableRange.shouldShowHandlesOnSelectionChanged: enabling for range {0}",ta),ta.isActionable&&ya;return!1}dHa(ta){ta=ta.clone();this.isRow?(ta.left=this.sourceRange.left,ta.right=this.fc.right,ta.bottom=ta.top+this.sourceRange.height-1):this.Rg?(ta.top=this.sourceRange.top,
ta.bottom=this.fc.UK.bottom,ta.right=ta.left+this.sourceRange.width-1):n.ULS.sendTraceTag(520176346,0,10,"DragSelectionClickBehaviorPivotTableRange.calculateRearrangeRange: no row/column rearrange");return this.Lob(ta)}O9i(){const ta={},ya=R.v(this.sourceRange,this.$);ia.h(this.$).getRangeInformation(this.Gb);if(this.isRow){ya.FirstColumn=ta.FirstColumn=this.Gb.left-1;ya.LastColumn=ta.LastColumn=this.Gb.right-1;if(this.sourceRange.top<=this.Gb.top&&this.sourceRange.bottom>=this.Gb.top-1){n.ULS.sendTraceTag(520176345,
0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}this.sourceRange.top>this.Gb.top?ta.LastRow=ta.FirstRow=this.Gb.top-1:(ta.FirstRow=this.Gb.top-this.sourceRange.height-1,ta.LastRow=ta.FirstRow+this.sourceRange.height-1)}else{ta.FirstRow=this.Gb.top;ta.LastRow=this.Gb.bottom-1;if(this.sourceRange.left<=this.Gb.left&&this.sourceRange.right>=this.Gb.left-1){n.ULS.sendTraceTag(520176344,0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}ta.LastColumn=
this.sourceRange.left>this.Gb.left?ta.FirstColumn=this.Gb.left-1:ta.FirstColumn=this.Gb.left-this.sourceRange.width-1}const sb={};sb.SheetName=this.$.va.na?this.$.va.na.name:this.$.yb.getItemByName(this.$.yb.na.name).sheetName;sb.Ranges=Array(2);sb.Ranges[0]=ya;sb.Ranges[1]=ta;this.dEh(sb)}dEh(ta){this.$.userOperationManager.Jc(new wa.a(265,0,(ya,sb,Qb)=>La(this.$.oa.xa,ta,this.JFf?Ba.b(ya,this.JFf):ya,this.IFf?Ba.a(sb,this.IFf):sb,Qb,null),64),null)}rsd(ta){return null!==this.fc&&(null===this.fc.UK||
ta.left>=this.fc.UK.left)&&(null===this.fc.kJ||ta.right<=this.fc.kJ.right)&&(null===this.fc.top||ta.top>=this.fc.top)&&(null===this.fc.UK||ta.bottom<=this.fc.UK.bottom)}Ssi(ta){return null!==this.fc&&this.fc.left>=ta.left&&this.fc.right<=ta.right&&this.fc.top>=ta.top&&this.fc.bottom<=ta.bottom}Jti(){return null!==this.fc&&null!==this.fc.UK&&this.fc.UK.top<=this.Gb.top&&this.fc.UK.left<=this.Gb.left&&this.fc.UK.right>=this.Gb.left}oni(){return null!==this.fc&&null!==this.fc.kJ&&this.fc.kJ.top===this.Gb.top&&
this.fc.kJ.left<=this.Gb.left&&this.fc.kJ.right>=this.Gb.right}nJb(ta){this.Om=6;this.ir=this.isRow?[11]:[12];this.PN(this.nma,this.oma);this.g7(ta.clientPoint,ta.Mb,this.isRow?11:12,!0,!1)}Sma(ta){this.Om=5;this.PN(this.Ti,this.Wg);this.g7(ta.clientPoint,ta.Mb,this.Swb(),!1,!1)}h9h(ta){this.OT(!1);this.nJb(ta);this.Gb=this.dHa(this.Gb);this.Noa()}g9h(ta){this.lrb(!1);this.Sma(ta);this.jS()}HIj(){if(!this.Zzb(this.Gb)){var ta=fb.a.ed(1,0,903,902,0,2069074184,"PivotTableInvalidMove");ta.HelpTopicId=
qb.a.wMj;ta.HelpDescription=mc.a.instance.ga(912);yb.a(this.$).Jt([ta])}}}Object(r.a)(Ya,"DragSelectionClickBehaviorPivotTableRange",mb,[]);var Gb=a(377);class Ja extends O{constructor(ta,ya){super(ta);this.Xg=()=>{this.domElement.classList.remove(da.selecting);Gb.c(this.gridView.$,!0,"FillHandleClickBehavior:OnSelectionEnded")};this.tr=()=>{this.domElement.classList.add(da.selecting)};this.onPointerDown=sb=>{2===sb.vb&&sb.Sn===Sys.UI.MouseButton.leftButton&&(this.gridView.ha.selectionType=4,this.gridView.ha.sourceRange=
this.gridView.ha.qa.ld,Gb.c(this.gridView.$,!1,"FillHandleClickBehavior:OnSelectionStarted"));return!1};this.yca=()=>{this.gridView.$.Yc(1983983164,2,30,null);return!0};this.dd=()=>{v.DOMElementExtensions.setVisible(this.zaa,this.gridView.$.isEditMode)};this.n6=()=>{v.DOMElementExtensions.setVisible(this.zaa,!1)};this.m6=()=>{v.DOMElementExtensions.setVisible(this.zaa,!0)};this.UDf=()=>{v.DOMElementExtensions.setVisible(this.zaa,!1)};this.TDf=()=>{v.DOMElementExtensions.setVisible(this.zaa,!0)};this.$Fb=
(sb,Qb)=>{v.DOMElementExtensions.setVisible(this.zaa,!Qb.Kne)};this.gridView=ya;ya=document.createElement("div");ya.className=V.a.FCh;this.zaa=ya;this.dd(null,null);ta.appendChild(ya);z.a.instance.ta(w.a.pointerDown,this.zaa,this.onPointerDown);M.a.instance.ta(w.a.tk,this.zaa,this.yca);this.gridView.ha.z9(this.tr);this.gridView.ha.q2(this.Xg);this.gridView.$.Lk(this.dd);this.gridView.$.qb.k0b(this.n6);this.gridView.$.qb.j0b(this.m6);this.gridView.rqe(this.$Fb);this.gridView.mc.xl(this.UDf);this.gridView.mc.Km(this.TDf)}dispose(){z.a.instance.Ba(w.a.pointerDown,
this.zaa,this.onPointerDown);M.a.instance.Ba(w.a.tk,this.zaa,this.yca);this.gridView.$&&(this.gridView.ha.xda(this.tr),this.gridView.ha.Y_(this.Xg),this.gridView.$.pl(this.dd),this.gridView.$.qb.gvc(this.n6),this.gridView.$.qb.fvc(this.m6),this.gridView.cWf(this.$Fb),this.gridView.mc.nl(this.UDf),this.gridView.mc.$l(this.TDf));super.dispose()}}Object(r.a)(Ja,"FillHandleClickBehavior",O,[]);class Na extends U{constructor(ta,ya){super(ta);this.QZi=sb=>{const Qb=E.HelperMethods.oo(sb);var oc=this.Nva.Y1d(sb.clientPoint);
if(!oc)return!1;var kb=oc.fe,jb=this.Nva.Ca.dxb(kb.hashCode).eva(oc.zI);if(!jb)return!1;sb=kb.$i.domElement;oc=E.HelperMethods.spe(E.HelperMethods.Bxb(kb.domElement,sb),oc.zI);kb=0;jb=this.Nva.Pb(jb.getRange());for(let wc=0,Jc=Na.iBe.length;wc<Jc;++wc){const zc=Na.iBe[wc];if((128===zc||64===zc)&&this.Nva.$.isEditMode)continue;var Wb=jb.EKa(zc);if(!Wb||!Wb.o6a||"none"===Wb.o6a.style.display)continue;Wb=Wb.o6a;const gd=E.HelperMethods.Bxb(Wb,sb);Wb=new Sys.UI.Bounds(gd.x,gd.y,Wb.offsetWidth,Wb.offsetHeight);
if(I.a.XM(Wb,oc)){kb=zc;break}}return 0!==kb?(jb.invoke(kb,Qb),!0):!1};this.Exg=ya;M.a.instance.ta(w.a.click,ta,this.QZi)}get Nva(){return this.Exg}}Na.iBe=[1,2,32,256,128,64];Object(r.a)(Na,"IPadSelectionClickThroughBehavior",U,[]);var Qa=a(22);class Oa{constructor(ta){this.ddf=ya=>{this.WDc(ya.Mb,1);return!0};this.edf=ya=>{this.WDc(ya.Mb,-1);return!0};this.Xg=()=>{this.frd=!1};this.tr=()=>{this.frd=!0};this.gridView=ta;this.L5a=0;this.frd=this.nic=!1;this.q5=Number.NaN;this.gridView.ha.z9(this.tr);
this.gridView.ha.q2(this.Xg);this.gridView.ha.OXc(this.Xg)}dispose(){this.gridView.ha.xda(this.tr);this.gridView.ha.Y_(this.Xg);this.gridView.ha.cvc(this.Xg)}eAa(){this.L5a=0;this.nic=!1;this.q5=Number.NaN}XNe(ta){this.nic=!0;this.WDc(ta,1)}YNe(ta){this.nic=!1;this.WDc(ta,-1)}WDc(ta,ya){if(ta)if(ta.parentNode)if(this.frd)isNaN(this.q5)||(this.jEc(this.q5,!1),this.q5=Number.NaN);else if(ta=parseInt(ta.parentNode.getAttribute(u.a.c6a),10),isNaN(ta))n.ULS.shipAssertTag(537159366,0,!1,"MarqueeHoveringManager.UpdateMarqueeStyle: indexInMarqueeCollection is not a valid number.");
else{if(!isNaN(this.q5)&&ta!==this.q5){if(this.nic)return;this.jEc(this.q5,!1)}if(isNaN(this.q5)||ta!==this.q5)this.q5=ta,this.L5a=0;!this.L5a&&0<ya&&this.jEc(ta,!0);this.L5a=Math.max(this.L5a+ya,0);!this.L5a&&0>ya&&(this.jEc(ta,!1),this.q5=Number.NaN)}else n.ULS.shipAssertTag(537159367,0,!!ta.parentNode,"MarqueeHoveringManager.UpdateMarqueeStyle: handle.ParentNode is null.");else n.ULS.shipAssertTag(537159368,0,!!ta,"MarqueeHoveringManager.UpdateMarqueeStyle: handle is null.")}jEc(ta,ya){for(let Qb=
1;4>=Qb;Qb++){var sb=this.gridView.Cb.NC(3,Qb,ta).hg;v.DOMElementExtensions.toggleCssClass(sb,da.$Bh,ya);for(sb=sb.firstChild;sb;sb=sb.nextSibling)Qa.a.contains(sb.className,"resizemarqueehandle",!0)&&v.DOMElementExtensions.toggleCssClass(sb,da.dCh,ya)}}}Object(r.a)(Oa,"MarqueeHoveringManager",null,[]);var bb=a(181),Ga=a(84),tb=a(839),wb=a(1260);class lb extends U{constructor(ta,ya){super(ta);this.gqc=()=>{if(!this.qw)return n.ULS.shipAssertTag(537159364,0,!1,"RangeCatchUpActivityHighlightBehavior.OnPointerEnter: highlightController is null"),
!1;this.qw.Sbj(this.fba);this.qw.tsh(this.gba);if(3===this.qw.model.state)return!0;this.qw.adf(!0);return!0};this.Fca=()=>{if(!this.qw)return!1;this.qw.Vaj();this.qw.VNd(this.gba,!1);if(3===this.qw.model.state)return!0;this.qw.adf(!1);return!0};this.onPointerDown=sb=>this.qw?2===sb.vb&&sb.Sn===Sys.UI.MouseButton.leftButton?!0:!1:!1;this.xGb=()=>{if(!this.qw)return!1;this.qw.VNd(this.gba,!0);this.qw.X1a();return!0};this.onDoubleClick=sb=>{if(sb.Ea)return sb.Ea.stopPropagation(),!0;n.ULS.sendTraceTag(537159363,
0,50,"CatchUpActivityHighlightBehavior::OnDoubleClick Double click event handled on Pill.");return!0};this.qw=Object(Ga.a)(wb.a,ya.metadata);this.gba=document.createElement("div");this.gba.id=`${ta.id}-${u.a.ZAe}`;this.gba.className=tb.a.o2g;this.fba=document.createElement("div");this.fba.id=`${ta.id}-${u.a.B1c}`;this.fba.className=tb.a.B1c;this.yQ=document.createElement("div");this.yQ.appendChild(this.fba);this.yQ.className=tb.a.n2g;this.gba.appendChild(this.yQ);ta.appendChild(this.gba);n.ULS.sendTraceTag(537159365,
0,50,"RangeCatchUpActivityHighlightBehavior::RangeCatchUpActivityHighlightBehavior: An activity indicator has been created.");z.a.instance.ta(w.a.XV,this.yQ,this.gqc);z.a.instance.ta(w.a.qB,this.yQ,this.Fca);z.a.instance.ta(w.a.pointerDown,this.yQ,this.onPointerDown);bb.a.instance.ta(w.a.click,this.yQ,this.xGb);bb.a.instance.ta(w.a.tk,this.yQ,this.onDoubleClick);v.DOMElementExtensions.setVisible(this.yQ,ya.isVisible)}dispose(){z.a.instance.Ba(w.a.XV,this.yQ,this.gqc);z.a.instance.Ba(w.a.qB,this.yQ,
this.Fca);z.a.instance.Ba(w.a.pointerDown,this.yQ,this.onPointerDown);bb.a.instance.Ba(w.a.click,this.yQ,this.xGb);bb.a.instance.Ba(w.a.tk,this.yQ,this.onDoubleClick);v.DOMElementExtensions.vf(this.fba);this.fba=null;v.DOMElementExtensions.vf(this.gba);this.qw=this.gba=null;super.dispose()}oZa(ta){this.qw=Object(Ga.a)(wb.a,ta.metadata);ta.isVisible!==ta.Axa&&(this.qw.zCj(ta.isVisible?1:0),v.DOMElementExtensions.setVisible(this.gba,ta.isVisible))}}Object(r.a)(lb,"RangeCatchUpActivityHighlightBehavior",
U,[]);class db extends Z{constructor(ta,ya,sb,Qb){super(ta,ya,sb,Qb)}get v4(){return 16}get odb(){return this.gridView.ha.rangePicker.Wed(!1)}vSa(){return(this.gridView.inRangePicker||this.gridView.Vh)&&super.vSa()}}Object(r.a)(db,"RangePickerTouchGrippiesBehavior",Z,[]);class Pa extends U{constructor(ta,ya){super(ta);const sb=document.createElement("div"),Qb=document.createElement("div");sb.className=ya?da.NCh:da.PCh;Qb.className=ya?da.OCh:da.MCh;ta.appendChild(sb);ta.appendChild(Qb)}}Object(r.a)(Pa,
"RearrangeHighlightBehavior",U,[]);var ja;(function(ta){ta[ta.topLeft=0]="topLeft";ta[ta.topRight=1]="topRight";ta[ta.bottomLeft=2]="bottomLeft";ta[ta.bottomRight=3]="bottomRight";ta[ta.error=4]="error"})(ja||(ja={}));Object(r.b)("Corner",ja);class Ka extends U{constructor(ta,ya,sb,Qb,oc){super(ta);this.eb=this.EF=null;this.i3=0;this.Gb=this.sourceRange=null;this.eTa=!1;this.onPointerDown=kb=>{kb=ba.a(this.$).me(kb);if(this.p8f(kb)&&!this.eTa){this.zsf();this.eb=this.Po.rbc();this.EF=this.Po.j7e(kb);
if(!this.eb||!this.EF||!this.EF.range)return n.ULS.shipAssertTag(537159361,0,!!this.eb,"ResizeMarqueeBehaviorBase.OnPointerDown: cellContentEditor is null"),n.ULS.shipAssertTag(537159360,0,!!this.EF,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState is null"),n.ULS.shipAssertTag(537159331,0,!!this.EF.range,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState.Range is null"),!1;this.Gb=this.EF.range.clone();this.sourceRange=this.Gb.clone();this.i3=this.$2e(kb);if(4===this.i3)return n.ULS.shipAssertTag(537159330,
0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;const jb=this.S4e(kb,!0);if(!jb)return n.ULS.shipAssertTag(537159329,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: mouseSelection is null. Not expect when clicking on handler."),!1;if(!this.sIe(jb))return n.ULS.shipAssertTag(537159328,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;this.gridView.PLa=!0;this.eb.qE(!1);this.kF.XNe(kb.Mb);this.Po.PQf(!0,this.hba.QT);this.eb.textBox.removeSelection();
this.eb.Q_b(this.O$e);this.lUf();this.eTa=!0;xa.b(this.$,!0)}return!0};this.Ti=kb=>{kb=ba.a(this.$).me(kb);kb=this.S4e(kb,!1);if(!kb)return!0;kb=this.sIe(kb);if(!kb)return n.ULS.shipAssertTag(537159327,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: newMarqueeRange is null"),this.lac(!0),!1;if(this.Gb.equals(kb))return!0;this.Gb=kb;kb=this.jS();kb||(n.ULS.shipAssertTag(537159326,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.lac(!0));return kb};this.Wg=kb=>{ba.a(this.$).me(kb);
kb=this.GW();n.ULS.shipAssertTag(537159325,0,kb,"ResizeMarqueeBehaviorBase.OnPointerUp: SetSelectedRange failed");this.lac(!kb);return kb};this.O$e=()=>{this.lac(!0)};this.gridView=ya;this.$=ya.$;this.QK=[];this.ha=this.gridView.ha;this.kF=sb;this.Po=Qb;this.hba=oc;this.coloredReferencesManager=this.$.da.Aa(281);n.ULS.shipAssertTag(537159362,0,!!this.coloredReferencesManager,"ResizeMarqueeBehaviorBase Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");
if(this.UM=x.a.tH(this.$))ya=this.$.da.Aa(464),n.ULS.shipAssertTag(510255176,0,!!ya,"ResizeMarqueeBehaviorBase Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen."),this.LA=ya.LA;for(const kb of this.CZf())ya=this.Po.EHe(ta,kb,this.fse(),this.onPointerDown),this.QK.push(ya);for(const kb of this.QK)z.a.instance.ta(w.a.XV,kb,this.kF.ddf),z.a.instance.ta(w.a.qB,kb,this.kF.edf);this.oZa(oc)}dispose(){this.QK.forEach(ta=>{z.a.instance.Ba(w.a.pointerDown,ta,
this.onPointerDown)});this.QK.length=0;super.dispose()}oZa(ta){this.hba=ta;this.ose(ta);this.Po.AMb(ta,this.QK,this.gUd());this.kF.eAa()}S4e(ta,ya){const sb=ta.Mb;ta=ta.clientPoint;if(!sb||!ta)return n.ULS.shipAssertTag(537159324,0,!!sb,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: source is null"),n.ULS.shipAssertTag(537159323,0,!!ta,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: point is null"),null;ya&&(ta=this.xwf(ta));ya=this.ha.Xp(ta,sb,0,!0,!1,!0);ya||(ta=this.xwf(ta),ya=this.ha.Xp(ta,
sb,0,!0,!1,!0));return ya}xwf(ta){ta.y+=0===this.i3||1===this.i3?2:-2;ta.x+=0===this.i3||2===this.i3?2:-2;return ta}sIe(ta){if(!ta||!this.sourceRange)return n.ULS.shipAssertTag(537159322,0,!!ta,"ResizeMarqueeBehaviorBase.CreateNewRange: newCorner is null"),n.ULS.shipAssertTag(537159321,0,!!this.sourceRange,"ResizeMarqueeBehaviorBase.CreateNewRange: sourceRange is null"),null;if(0===this.i3)return new nb.Range(ta.top,ta.left,this.sourceRange.bottom,this.sourceRange.right,!0,!1);if(1===this.i3)return new nb.Range(ta.top,
this.sourceRange.left,this.sourceRange.bottom,ta.right,!0,!1);if(2===this.i3)return new nb.Range(this.sourceRange.top,ta.left,ta.bottom,this.sourceRange.right,!0,!1);if(3===this.i3)return new nb.Range(this.sourceRange.top,this.sourceRange.left,ta.bottom,ta.right,!0,!1);n.ULS.shipAssertTag(537159320,0,!1,`ResizeMarqueeBehaviorBase.CreateNewRange: currentFixedCorner is not valid: ${ja[this.i3]}`);return null}GW(){return this.UM?this.LA.PEb(this.eb,this.EF,this.Gb):this.coloredReferencesManager.PEb(this.eb,
this.EF,this.Gb)}jS(){return this.GW()}lac(ta){ta&&n.ULS.sendTraceTag(537159319,0,10,"ResizeMarqueeBehaviorBase.FinishOrAbortOperation: Aborting operation, will try to recalculate colored references as a fallback.");this.kF.YNe(this.QK[0]);this.Po.PQf(!1,this.hba.QT);this.eb.textBox.setCaretPositionToEnd();this.eb.Quc(this.O$e);this.uig();this.eTa=this.gridView.PLa=!1;xa.b(this.$,!1);this.Po.HSf()}}Object(r.a)(Ka,"ResizeMarqueeBehaviorBase",U,[]);class ub extends Ka{constructor(ta,ya,sb,Qb,oc){super(ta,
ya,sb,Qb,oc)}CZf(){return[da.TCh,da.UCh,da.RCh,da.SCh]}fse(){return[da.QCh]}$2e(ta){ta=ta.Mb;if(ta===this.QK[0])return 0;if(ta===this.QK[1])return 1;if(ta===this.QK[2])return 2;if(ta===this.QK[3])return 3;n.ULS.shipAssertTag(537159318,0,!1,"ResizeMarqueeMouseBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4}lUf(){this.Po.PN(this.Ti,this.Wg,!0)}uig(){this.Po.F_d(this.Ti,this.Wg,!0)}p8f(ta){return 2===(D.a.zb=ta.vb)&&ta.Sn===Sys.UI.MouseButton.leftButton}gUd(){return!0}zsf(){n.ULS.sendTraceTag(537159317,
0,50,"ResizeMarqueeMouseBehavior.LogStartOperation: Starting resize marquee operation with mouse.")}ose(ta){for(const ya of this.QK)ya.style.backgroundColor=ta.hg.style.borderColor}}Object(r.a)(ub,"ResizeMarqueeMouseBehavior",Ka,[]);class Kb extends Ka{constructor(ta,ya,sb,Qb,oc){super(ta,ya,sb,Qb,oc);this.rGb=()=>{const kb=3===D.a.zb;this.Xud&&!kb?this.Po.AMb(this.hba,this.QK,!1):!this.Xud&&kb&&this.Po.AMb(this.hba,this.QK,!0);this.Xud=kb};this.VYi=(kb,jb)=>{jb.c6a===this.hba.QT&&this.Po.AMb(this.hba,
this.QK,!jb.start&&this.gUd())};D.a.$qe(this.rGb);this.Xud=3===D.a.zb;this.Po.INg(this.VYi)}dispose(){D.a.FWf(this.rGb);super.dispose()}CZf(){return[V.a.TBh,V.a.SBh]}fse(){const ta=!P.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");return[ta?V.a.sVe:V.a.rVe,V.a.h$b,ta?V.a.RBh:V.a.g$b]}$2e(ta){ta=ta.Mb;if(ta===this.QK[0])return 0;if(ta===this.QK[1])return 3;n.ULS.shipAssertTag(537159316,0,!1,"ResizeMarqueeTouchBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4}lUf(){k.a.sw?
this.Po.PN(this.Ti,this.Wg,!1):this.Po.Yfj(this.Ti,this.Wg)}uig(){k.a.sw?this.Po.F_d(this.Ti,this.Wg,!1):this.Po.KYj(this.Ti,this.Wg)}p8f(ta){return 3===(D.a.zb=ta.vb)}gUd(){return 3===D.a.zb}zsf(){n.ULS.sendTraceTag(537159315,0,50,"ResizeMarqueeTouchBehavior.LogStartOperation: Starting resize marquee operation with touch.")}ose(){}}Object(r.a)(Kb,"ResizeMarqueeTouchBehavior",Ka,[]);class W extends U{constructor(ta,ya){super(ta);W.ysb(ta,S.a.iCh+" "+V.a.tua,null===ya||void 0===ya?void 0:ya.horizontal);
W.ysb(ta,S.a.hCh+" "+V.a.tua,null===ya||void 0===ya?void 0:ya.vertical);W.ysb(ta,S.a.eCh+" "+V.a.tua,null===ya||void 0===ya?void 0:ya.horizontal);W.ysb(ta,S.a.gCh+" "+V.a.tua,null===ya||void 0===ya?void 0:ya.vertical);W.ysb(ta,V.a.fCh)}static ysb(ta,ya,sb){const Qb=document.createElement("div");Qb.className=ya;sb&&(Qb.style.backgroundImage=`url("${sb}")`);ta.appendChild(Qb)}}Object(r.a)(W,"SelectionCutCopyBehavior",U,[]);class za extends U{constructor(ta){super(ta);appChrome.renderSpinner(ta)}}Object(r.a)(za,
"SelectionPasteBehavior",U,[]);class Sa extends U{constructor(ta,ya){super(ta);Sa.Osb(ta,S.a.LCh+" "+V.a.tua,null===ya||void 0===ya?void 0:ya.horizontal);Sa.Osb(ta,S.a.KCh+" "+V.a.tua,null===ya||void 0===ya?void 0:ya.vertical);Sa.Osb(ta,S.a.HCh+" "+V.a.tua,null===ya||void 0===ya?void 0:ya.horizontal);Sa.Osb(ta,S.a.JCh+" "+V.a.tua,null===ya||void 0===ya?void 0:ya.vertical);Sa.Osb(ta,V.a.ICh)}static Osb(ta,ya,sb){const Qb=document.createElement("div");Qb.className=ya;sb&&(Qb.style.backgroundImage=`url("${sb}")`);
ta.appendChild(Qb)}}Object(r.a)(Sa,"SelectionRangePickerBehavior",U,[]);class Wa extends Z{constructor(ta,ya,sb,Qb){super(ta,ya,sb,Qb)}get v4(){return 0}get odb(){return this.gridView.ha.qa.ld}vSa(){const ta=this.gridView.Vh||this.gridView.fb;return this.gridView.ha.qa.Tg&&!ta&&super.vSa()}}Object(r.a)(Wa,"SelectionTouchGrippiesBehavior",Z,[]);var ab=a(51);class ma extends t.a{constructor(ta,ya){super();this.Hpb=(sb,Qb)=>{sb=Qb.v4;const oc=this.gridView;Qb=Qb.mdi;const kb=Qb.hg,jb=Qb.c$;k.a.Hg&&jb.push(new Na(kb,
oc));switch(sb){case 24:Qb.c$.push(new lb(kb,Qb));break;case 0:Qb.c$.push(new Ja(kb,oc));k.a.fp||(jb.push(new Zb(kb,this.gridView.$,Qb.paneType,this.tableManager,this.Po)),P.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",!1)&&jb.push(new Ya(kb,this.gridView.$,Qb.paneType,this.tableManager,this.Po)));jb.push(new Wa(Qb,kb,oc,Qb.paneType));break;case 3:jb.push(new O(kb));k.a.fp||(jb.push(new Ta(kb,this.gridView.$,Qb.paneType,this.kF,this.Po,Qb)),jb.push(new ub(kb,
this.gridView,this.kF,this.Po,Qb)),jb.push(new Kb(kb,this.gridView,this.kF,this.Po,Qb)));break;case 4:case 5:jb.push(new W(kb,this.Bte));break;case 30:jb.push(new za(kb));break;case 16:jb.push(new Sa(kb,this.Bte));jb.push(new db(Qb,kb,oc,Qb.paneType));break;case 11:case 12:jb.push(new Pa(kb,11===sb));break;case 17:jb.push(new O(kb));break;case 19:jb.push(new O(kb)),jb.push(new ea(Qb,kb,oc,Qb.paneType))}Qb.V1b=!0};this.$=ta;this.gridView=ia.h(ta);this.tableManager=ya;this.kF=new Oa(this.gridView);
this.Po=new B(this.gridView);this.gridView.Cb&&(this.gridView.Cb.dNg(this.Hpb),this.gridView.Cb.update(!1));ta.da.Ha(64,this)}get Bte(){P.EwaSettings.isChangeGateEnabled("OfficeVSO:6809974_DancingAnts1Cdn")&&!this.Ate&&(this.Ate={vertical:ab.a.current.qo(104),horizontal:ab.a.current.qo(105)});return this.Ate}dispose(){this.gridView.Cb.ikj(this.Hpb);this.kF&&(this.kF.dispose(),this.kF=null);super.dispose()}}Object(r.a)(ma,"GridHighlightsBehaviorManager",t.a,[]);class ha extends b.a{constructor(ta){super();
this.$=ta;this.Db()}create(){l.TaskExtensions.za(h.GetServiceTaskFactory.create(this.$.da,134,this.la,this.Xa),ta=>{this.nb(this.$.da.Aa(64)||new ma(this.$,ta.result))},this.la,3)}static ka(ta){ta.da.Ha(149,new ha(ta))}}Object(r.a)(ha,"GridHighlightsBehaviorManagerFactory",b.a,[]);a.d(F,"a",function(){return eb});const eb=()=>{c.a.Fa(ha.ka);c.a.Fa(d.ka)}},1173:function(r,F,a){var c=a(9);r=a(0);var b=a(709),e=a(50),f=a(37),d=a(189),h=a(55);class l{constructor(ya){this.Sph=ya}Hc(){return!1}executeCommand(ya,
sb){ya=sb.command;sb=null;switch(ya){case 1243860697:this.Sph.OTj();break;default:sb=d.a(ya)}return sb||h.Task.Sa(!0)}wc(ya,sb){return 1243860697===sb.command}Nc(){return!1}}Object(r.a)(l,"SheetDropdownMenuCommandHandler",null,[222]);class k extends b.a{constructor(ya){super(ya)}hd(){this.$.Vx(ya=>{ya.bgc().then(()=>{f.TaskExtensions.za(e.GetServiceTaskFactory.Oa(this.$.da,32,33,this.Xa),sb=>{this.$c([new l(sb.result.gEj)])},this.$.la)})})}static ka(ya){b.a.Md(392,new k(ya))}}Object(r.a)(k,"SheetDropdownMenuCommandHandlerFactory",
b.a,[]);var t=a(226),n=a(5),z=a(77),w=a(33),m=a(1),u=a(15),y=a(27),v=a(181),C=a(14),x=a(89),B=a(46),H=a(240),I=a(159),U=a(110),S=a(40),G=a(421),D=a(84),E=a(13),N=a(35);class M{constructor(){this.yMe=new N.a(!0);this.$Jc=0}get H8c(){return this.$Jc}get navigationButtonsDisabled(){return!!(this.H8c&1)}get operationButtonsDisabled(){return!!(this.H8c&2)}wSg(ya,sb){this.yMe.add(ya,sb);this.lS()}lS(){this.$Jc=0;N.a.forEach(this.yMe.tu,ya=>{this.$Jc=this.H8c|ya.value})}}Object(r.a)(M,"SheetTabBarDisabledStateManager",
null,[]);var L=a(239),aa=a(31);class V{}V.dzh="ewa-stb-uir";V.XSe="ewa-stb-drag";V.Oyh="ewa-stb-navarea";V.Pyh="ewa-stb-navarea-dimensions";V.Ryh="ewa-stb-navbutton";V.$T="cui-disabled";V.Qyh="ewa-stb-navareaextra";V.cia="cui-img-container";V.Iyh="ewa-stb-contentarea";V.YSe="ewa-stb-left-scrollable";V.iTe="ewa-stb-right-scrollable";V.bzh="ewa-stb-tabarea";V.azh="ewa-stb-sheettabmoveindicator";V.kTe="ewa-stb-tabs";V.AQj="tab-active";V.IQj="tab-inactive";V.HQj="tab-hover";V.czh="ewa-stb-tabs-ghost";
V.CQj="tab-anchor-text";V.dark="dark";V.light="light";V.BQj="tab-active-text";V.FQj="tab-content-container";V.KQj="tab-text";V.Uyh="ewa-stb-nsv-inactive";V.Vyh="ewa-stb-nsv-inactive-svg";V.Syh="ewa-stb-nsv-active";V.Tyh="ewa-stb-nsv-active-svg";V.Cxh="ewa_nsv_margin";V.Jyh="ewa-stb-disable-scrollbar";V.Ezi="leave-size-fixed-on-tab-hover-old";V.Dzi="leave-size-fixed-on-tab-hover";V.bTe="ewa-stb-locked-sheet";V.cTe="ewa-stb-locked-sheet-svg-16px";V.Kyh="ewa-stb-dropdown-menu-button";V.iuh="ewa-active-sheet-menu-item";
Object(r.a)(V,"CssClassNames",null,[]);var P=a(747),ba=a(19),Y=a(263),Z=a(103),ea=a(193),ra=a(250),O=a(44),da=a(287),xa=a(51),ia=a(12),Ma=a(74),Ta=a(319),Da=a(11),fa=a(101),ua=a(349),Fa=a(21),ca=a(183),ka=a(377),Ca=a(373),fb=a(45),yb=a(227),mb=a(86);class nb extends L.a{constructor(ya,sb,Qb=!1){super(ya);this.Vab=this.Dsa=null;this.$=sb;this.uX=Qb}get disabled(){return this.uX}dispose(){this.Vab=this.Dsa=this.$=null;super.dispose()}fS(ya){this.uX=ya;this.domElement.setAttribute(n.a.osa,ya.toString());
ia.DOMElementExtensions.toggleCssClass(this.domElement,P.a.$T,ya)}}Object(r.a)(nb,"SheetBarButton",L.a,[]);var X=a(727);class R extends nb{constructor(ya,sb,Qb,oc=!1){super(document.createElement("a"),sb,oc);this.fd=kb=>{this.disabled||this.$.Yc(-1935155518,kb.vb,30,null);return!0};this.zGb=kb=>{kb="mouseover"===kb.type||"focus"===kb.type;const jb=ka.a(this.$)?this.Vab:this.Dsa;Da.HelperMethods.VYd(jb,this.nha,this.nha+n.a.Ffc,kb&&!Fa.h(this.$).inRangePicker)};this.Ri=()=>{this.fS(!0)};this.$f=()=>
{this.fS(!1)};this.nha=m.EwaSettings.ra(437)?ba.a.Fad:ba.a.TTe;this.Dsa=Qb.pb(this.domElement,E.a.instance.ga(508),0,this.nha,E.a.instance.ga(509),X.a.V3c,oc);ya.appendChild(this.domElement);this.Cc.ka("contextmenu",kb=>{Ma.g(kb)});m.EwaSettings.ra(437)||(this.Cc.ka("mouseover",this.zGb),this.Cc.ka("mouseout",this.zGb));yb.a.instance.ta(C.a.click,this.domElement,this.fd);this.hla=U.KeyInputManager.instance.Dt(this.domElement,this.fd,mb.a.Lh,mb.a.$W);Fa.h(this.$).mc.xl(this.Ri);Fa.h(this.$).mc.Km(this.$f)}dispose(){yb.a.instance.Ba(C.a.click,
this.domElement,this.fd);U.KeyInputManager.instance.Xw(this.domElement,this.hla);Fa.h(this.$)&&Fa.h(this.$).mc&&(Fa.h(this.$).mc.nl(this.Ri),Fa.h(this.$).mc.$l(this.$f));super.dispose()}fS(ya){const sb=R.n8f(this.$);super.fS(ya||sb)}static n8f(ya){return!ya.isEditMode||!ya.va.count}}Object(r.a)(R,"InsertSheetButton",nb,[]);class wa extends nb{constructor(ya,sb,Qb){super(document.createElement("a"),sb);this.fd=oc=>{this.$.Yc(-684145703,oc.vb,0,null);return!0};this.zGb=oc=>{Da.HelperMethods.VYd(this.Xye,
this.nha,this.nha+n.a.Ffc,("mouseover"===oc.type||"focus"===oc.type)&&!Fa.h(this.$).inRangePicker)};this.$=sb;this.nha=m.EwaSettings.ra(437)?ba.a.Fad:ba.a.TTe;this.Xye=Qb.pb(this.domElement,E.a.instance.ga(510),0,this.nha,E.a.instance.ga(511),X.a.V3c);ya.appendChild(this.domElement);this.Cc.ka("contextmenu",oc=>{Ma.g(oc)});this.Cc.ka("mouseover",this.zGb);this.Cc.ka("mouseout",this.zGb);yb.a.instance.ta(C.a.click,this.domElement,this.fd);this.hla=U.KeyInputManager.instance.Dt(this.domElement,this.fd,
mb.a.Lh,mb.a.$W)}dispose(){yb.a.instance.Ba(C.a.click,this.domElement,this.fd);U.KeyInputManager.instance.Xw(this.domElement,this.hla);this.Xye=null;super.dispose()}}Object(r.a)(wa,"InsertTemplateButton",nb,[]);class na{constructor(ya,sb){this.sheetName=null;this.newSheetIndex=0;this.sheetName=ya;this.newSheetIndex=sb}getSheetName(){return this.sheetName}}Object(r.a)(na,"MacroRecorderSheetReorderedPayload",null,[162]);var Ba=a(94);class Ra extends L.a{constructor(ya,sb){super(document.createElement("div"));
this.nR=()=>{u.ULS.sendTraceTag(537153794,0,50,"SheetDropdownMenu.OnSheetsChanges");this.EXf(!1,"OnSheetsChanged")};this.zRi=()=>{this.Aj()};this.yRi=()=>{this.Sj()};this.$=ya;this.iRj=sb;this.zU=!1;this.mPb=0}dispose(){this.Sj();super.dispose()}OTj(){this.EXf(!0,"TogglerSheetDropdownMenu")}EXf(ya,sb){u.ULS.sendTraceTag(537153795,0,50,`SheetDropdownMenu.RenderSheetMenuInternal: render start. caller: ${sb}, toggle: ${ya}, toggleStateId: ${this.mPb}`);ya&&(this.mPb+=1);const Qb=this.$.Jb.Gc("UserAction",
`SheetDropdownMenu.RenderSheetMenuInternal: caller: ${sb}, toggle: ${ya}, toggleStateId: ${this.mPb}, sheetCount: ${this.$.va.count}`);ya=this.Zgh();appChrome.renderSheetDropdownMenu(this.domElement,this.iRj,ya,this.mPb,this.zRi,this.yRi,()=>{Qb.stop()},ka.a(this.$))}Zgh(){const ya=this.$.va,sb=[];for(let oc=0;oc<ya.count;oc++){var Qb=Object(D.a)(fa.a,ya.getItem(oc));0===Qb.AB&&(Qb=this.Ygh(Qb),sb.push(Qb))}return sb}Ygh(ya){const sb={};sb.key=ya.name;sb.text=ya.name;sb.onClick=this.$gh(ya);ya.active&&
(sb.className=ka.a(this.$)?"ewa-active-sheet-menu-item-present-mode":V.iuh);return sb}$gh(ya){return()=>{const sb=new Ba.a(-1876836819,0,this.$.xc,30,null);this.$.Ia.Hb(sb,{[n.a.oTd]:ya.name})}}Aj(){if(!this.zU){const ya=this.$.va;ya.Vf(this.nR);ya.lXc(this.nR);ya.fY(this.nR);ya.Nga(this.nR);ya.aGa(this.nR);ya.Xqe(this.nR);ya.YYa(this.nR);this.zU=!0}}Sj(){if(this.zU){const ya=this.$.va;ya.sg(this.nR);ya.PLd(this.nR);ya.N6(this.nR);ya.bna(this.nR);ya.HQa(this.nR);ya.DWf(this.nR);ya.VJb(this.nR);this.zU=
!1}}}Object(r.a)(Ra,"SheetDropdownMenu",L.a,[325,2]);var qa=a(353);class La extends nb{constructor(ya,sb,Qb){super(document.createElement("a"),ya,!0);this.Jf=()=>{this.fS(!1);this.$.ea.Cn(this.Jf)};this.fd=oc=>{this.vfg(oc.vb);return!0};this.onKeyDown=oc=>13===oc.Ea.keyCode||32===oc.Ea.keyCode?(this.vfg(oc.vb),!0):!1;this.Dsa=sb.pb(this.domElement,E.a.instance.ga(512),0,ba.a.Hyh,E.a.instance.ga(512),X.a.C8h,this.disabled);this.domElement.classList.add(V.Kyh);Qb.appendChild(this.domElement);this.Vrh();
this.Ffj()}dispose(){this.FYj();super.dispose()}fS(ya){super.fS(ya||!this.$.ea.Eka)}Vrh(){const ya=this.$.ea;ya.Zf?this.fS(!1):ya.Dk(this.Jf)}vfg(ya){this.disabled||(u.ULS.sendTraceTag(537153793,0,50,`SheetDropdownMenuAnchor.ToggleMenu: inputMethod: ${qa.a[ya]}`),this.$.Ia.Hb(new Ba.a(1243860697,ya,this.$.xc,30,null)))}Ffj(){yb.a.instance.ta(C.a.click,this.domElement,this.fd);U.KeyInputManager.instance.ta(C.a.Sb,this.domElement,this.onKeyDown)}FYj(){yb.a.instance.Ba(C.a.click,this.domElement,this.fd);
U.KeyInputManager.instance.Ba(C.a.Sb,this.domElement,this.onKeyDown)}}Object(r.a)(La,"SheetDropdownMenuAnchor",nb,[]);var Yb=a(60);const mc=(ya,sb,Qb,oc,kb,jb,Wb,wc=null)=>{wc=ya.Na(9,wc);wc.sheetName=sb;wc.newSheetIndex=Qb;return Yb.g(ya,"ReorderSheets",wc,oc,kb,jb,Wb,0)};var Zb=a(176),qb=a(133),Ha=a(192),Ya=a(127),Gb=a(56),Ja=a(214),Na=a(205),Qa=a(170),Oa=a(128);class bb{constructor(ya,sb,Qb){this.vm=sb;this.ww=Qb;this.sheet=ya;this.altText=E.a.instance.ga(1993)}AH(){return this.sheet.active}$qd(){return this.sheet.isLockPausedInSession}Osa(){return this.vm?
ba.a.aTe:this.AH()?ba.a.$Se:ba.a.ZSe}ooa(){return this.sheet.Ph?X.a.UPf:X.a.sYj}DXd(){return 16}zha(){return null}Psa(){return this.vm?this.ww?V.cTe:V.bTe:null}eZd(){return null}xs(){return null}gnd(){return 0}SYc(){return!0}}Object(r.a)(bb,"LockPausedSheetIconDataSource",null,[341]);class Ga{constructor(ya,sb,Qb){this.vm=sb;this.ww=Qb;this.sheet=ya;this.altText=E.a.instance.ga(1992)}AH(){return this.sheet.active}$qd(){return this.sheet.Ph}Osa(){return this.vm?ba.a.aTe:this.AH()?ba.a.$Se:ba.a.ZSe}ooa(){return X.a.UPf}DXd(){return 16}zha(){return null}Psa(){return this.vm?
this.ww?V.cTe:V.bTe:null}eZd(){return null}xs(){return null}gnd(){return 0}SYc(){return!0}}Object(r.a)(Ga,"LockedSheetIconDataSource",null,[341]);class tb{constructor(ya,sb,Qb,oc){this.sheet=ya;this.altText=E.a.instance.ga(1907);this.bUj=sb;this.k9f=Qb;this.ww=oc}AH(){return this.sheet.active}$qd(){return this.sheet.Zd.kz}zha(){return this.ww?this.AH()?V.Tyh:V.Vyh:this.AH()?V.Syh:V.Uyh}Osa(){return!this.AH()&&this.k9f()?ba.a.GAh:ba.a.FAh}ooa(){return!this.AH()&&this.k9f()?X.a.qEj:X.a.pEj}DXd(){return 14}Psa(){return V.Cxh}eZd(){return this.sheet.Zd.Inb}xs(){return this.bUj}gnd(){return 8}SYc(){return!1}}
Object(r.a)(tb,"NamedSeetViewSheetIconDataSource",null,[341]);var wb=a(160),lb=a(131);class db{constructor(ya,sb){this.Gqa=this.p1=this.mBa=this.Bl=null;this.llf=!1;this.ITc=this.ooa=this.Psa=this.zha=this.Osa=null;this.xN=()=>{this.dataSource.AH()&&f.TaskExtensions.za(this.HDb,()=>{dialogControls.renderToolTip(this.dataSource.xs(),"SheetIconTooltip",this.dataSource.eZd(),this.qI,10,!1,!1,1)},this.$.la,3)};this.wN=()=>{this.dataSource.AH()&&this.clearToolTip()};this.$=ya;this.dataSource=sb;this.ww=
w.a.Jsd()}get Cc(){return this.p1||(this.p1=lb.a.instance.ie(this.qI))}get HDb(){if(this.Gqa)return this.Gqa;const ya=new wb.a;this.$.Vx(sb=>{f.TaskExtensions.za(sb.gwd(),()=>{ya.setResult(!0)},this.$.la,3)});return this.Gqa=ya.task}get qI(){return this.ITc}Qjg(){if(this.qI&&(this.Bl||this.mBa)){if(this.ww){var ya=this.dataSource.ooa();this.ooa!==ya&&(this.mBa&&this.mBa.parentNode.removeChild(this.mBa),this.kff(),this.ooa=ya)}else ya=this.dataSource.Osa(),this.Osa!==ya&&(this.TMd(this.Bl,this.Osa,
ya),this.Osa=ya);ya=this.dataSource.zha();this.zha!==ya&&(this.ww?this.Cmj(this.mBa,this.zha,ya):this.TMd(this.Bl,this.zha,ya),this.zha=ya);ya=this.dataSource.Psa();this.Psa!==ya&&(this.TMd(this.qI,this.Psa,ya),this.Psa=ya);this.dataSource.xs()&&!this.dataSource.AH()&&this.clearToolTip()}}hJj(ya,sb,Qb){this.xii(ya,sb,Qb);ia.DOMElementExtensions.setVisible(this.qI,this.dataSource.$qd())}clearToolTip(){f.TaskExtensions.za(this.HDb,()=>{dialogControls.clearToolTip(this.dataSource.xs())},this.$.la,3)}xii(ya,
sb,Qb){this.qI&&this.llf!==ya&&(this.qI.parentNode.removeChild(this.qI),this.Psa=this.zha=this.ooa=this.Osa=this.ITc=null,this.dataSource.xs()&&(this.Cc.detach("mouseover",!0),this.Cc.detach("mouseout",!0)));this.qI||(this.ITc=document.createElement("span"),Sys.UI.DomElement.addCssClass(this.qI,P.a.cia),Sys.UI.DomElement.addCssClass(this.qI,ba.a.Or),m.EwaSettings.ra(437)?ya===this.dataSource.SYc()?sb.appendChild(this.qI):sb.insertBefore(this.qI,Qb):ya?sb.insertBefore(this.qI,Qb):sb.appendChild(this.qI),
this.ww?this.kff():(this.Bl=document.createElement("img"),this.Bl.tabIndex=-1,this.Bl.alt=this.dataSource.altText,this.qI.appendChild(this.Bl),this.Bl.src=xa.a.qe(this.dataSource.gnd())),this.dataSource.xs()&&(this.Cc.ka("mouseover",this.xN,!0),this.Cc.ka("mouseout",this.wN,!0)),this.llf=ya)}Cmj(ya,sb,Qb){ya&&(Sys.UI.DomElement.removeCssClass(ya,sb),Sys.UI.DomElement.addCssClass(ya,Qb))}TMd(ya,sb,Qb){sb&&Sys.UI.DomElement.removeCssClass(ya,sb);Qb&&Sys.UI.DomElement.addCssClass(ya,Qb)}dispose(){x.a.Ja(this.p1)}kff(){const ya=
this.$.da.Aa(388);ya?(this.mBa=ya.Oja(this.dataSource.ooa(),this.dataSource.DXd()))?this.qI.appendChild(this.mBa):u.ULS.shipAssertTag(537153763,0,!1,`Sheeticon.InsertCurrentSvgIcon: Svg with id ${this.dataSource.ooa()} was not found.`):u.ULS.shipAssertTag(537153792,0,!1,"Sheeticon.InsertCurrentSvgIcon: Unable to recieve SvgIconProvider service.")}}Object(r.a)(db,"SheetIcon",null,[2]);var Pa=a(354),ja=a(96),Ka=a(158);class ub extends ja.a{constructor(ya,sb){super(ya.domElement);this.onKeyDown=Qb=>
{121===Qb.keyCode&&Qb.shiftKey&&!this.Sna.disabled&&(this.showContextMenu(new Sys.UI.Point(0,0),1,this.Sna.anchor),Ma.g(Qb))};this.yca=Qb=>{if(!this.$.isEditMode||this.Sna.disabled)return!0;this.rename(!1,Qb.vb);return!0};this.Xl=Qb=>this.Sna.disabled?!0:this.showContextMenu(Qb.clientPoint,Qb.vb,Qb.Mb);this.Sje=ya;this.$=sb;yb.a.instance.ta(C.a.tk,ya.domElement,this.yca);Pa.a.instance.ta(ya.domElement,this.Xl);this.Cc.ka("keydown",this.onKeyDown)}get Sna(){return this.Sje}dispose(){this.Sna&&(yb.a.instance.Ba(C.a.tk,
this.Sna.domElement,this.yca),Pa.a.instance.Ba(this.Sna.domElement,this.Xl),this.Sje=null);this.$=null;super.dispose()}showContextMenu(ya,sb,Qb){this.Sna.activate(sb,w.a.wtd());sb=new Ba.a(-1075099431,sb,this.$.xc,30,null);let oc;return!Ka.a(oc=this.$.Ia.Hb(sb,{[n.a.L7f]:ya,[ub.hEj]:this.Sna.sheet,[n.a.M7f]:Qb}))&&(6!==oc.status||oc.result)}rename(ya,sb){this.$.Yc(817296323,sb,ya?19:0,null)}}ub.hEj="Sheet";Object(r.a)(ub,"SheetOpsSheetClickHelper",ja.a,[]);var Kb=a(39),W=a(61);class za extends nb{constructor(ya,
sb,Qb,oc,kb,jb,Wb){super(document.createElement("li"),ya);this.u3c=this.t3c=this.K7f=this.J7f=0;this.Y6c=.5;this.zU=this.mTd=!1;this.color=this.MJc=this.yE=this.aFb=this.vO=null;this.djc=this.Wjf=!1;this.O6b="#BEBBB8";this.jHc=null;this.onKeyDown=wc=>13!==wc.Ea.keyCode||this.disabled?!1:(this.activateSheet(1),!0);this.vz=wc=>32!==wc.Ea.charCode||this.disabled?!1:(this.activateSheet(1),!0);this.xN=()=>{this.disabled||(this.WR.o_i(this),this.WR.hF||this.Kna(!0,void 0,"OnMouseOver"))};this.wN=()=>{this.disabled||
this.Kna(!1,void 0,"OnMouseOut")};this.yGb=()=>{this.WR.hF||(this.JNj(),Object(W.c)(this.sheet.sheetProcessedData)||Fa.h(this.$).aAa(this.sheet.sheetName,"sheetTabButton.onMouseEnter"));return!1};this.f6=()=>{this.HPe(!1);return!1};this.fd=wc=>{if(this.disabled)return!0;const Jc=Fa.h(this.$);this.sheet.active||3!==wc.vb?this.vm?this.activateSheet(wc.vb):w.a.wtd()&&Jc.focus():(!w.a.mNa(this.$)&&!this.vCb||Jc.fb||Jc.Vh||Jc.Ktb(),this.activateSheet(wc.vb));return 3!==wc.vb};this.onPointerDown=wc=>{if(this.disabled)return!0;
this.HPe(!0);Fa.h(this.$).inRangePicker&&u.ULS.sendTraceTag(35985038,0,15,"SheetTabButton:OnPointerDown() - Tried clicking different sheet while in range picker (e.g editing a formula).");var Jc=3===wc.vb;if(2===wc.vb||Jc&&this.dxa)this.vm?(this.Kna(!0,!Jc,"OnPointerDown"),Jc=h.Task.delay(Jc?this.K7f:this.J7f).So(()=>!0)):Jc=this.activateSheet(wc.vb),this.PBb&&(this.djc=!0,this.WR.rvc=f.TaskExtensions.za(Jc,()=>{this.djc&&this.WR.q_i(this,wc)},this.la,11));return!1};this.Wg=wc=>{if(this.disabled||
!this.PBb&&m.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))return!0;const Jc=this.WR.hF&&!w.a.qkf();this.djc=!1;this.vm&&this.Kna(2===wc.vb,void 0,"OnPointerUp");this.WR.rvc&&(f.TaskExtensions.za(this.WR.rvc,()=>{this.WR.p_i(this)},this.la,11),this.WR.rvc=null);return Jc};this.BN=()=>{this.djc=!1;this.mTd||this.Kna(!1,void 0,"OnTouchMove");return!1};this.fDe=new ub(this,ya);this.vm=jb;this.ww=Wb;this.vCb=w.a.vCb(ya);this.Xpd=m.EwaSettings.isChangeGateEnabled("OfficeVSO:3843903_DelayLoadSheetViewIcon")&&
!this.ww;this.vm?(this.J7f=ya.ya.SheetDragReorderDelayInMilliseconds,this.K7f=ya.ya.SheetDragReorderDelayInMillisecondsForTouch,this.t3c=18,this.u3c=20):(this.t3c=19,this.u3c=22);this.$=ya;this.RXb=oc;this.WR=kb;this.PBb=kb.Wse();this.ihh();this.cbh();this.Hmd=ya.Jb.zg("UserAction",this.name);this.Zqd=!1;ia.DOMElementExtensions.It(this.domElement,n.a.sq,null,null);this.domElement.appendChild(this.anchor);this.anchor.appendChild(this.yE);this.Qna=new Ha.a;ya=new Ga(this.sheet,this.vm,this.ww);this.Qna.add(new db(this.$,
ya));this.$.ea.SMb&&(ya=new bb(this.sheet,this.vm,this.ww),this.Qna.add(new db(this.$,ya)));this.Xpd||(ya=new tb(this.sheet,this.WR.Zyc,()=>this.color?za.qUd(this.color):!1,this.ww),this.aFb=new db(this.$,ya),this.Qna.add(this.aFb));this.dxa=this.WR.dxa;this.Dgb();this.Ygj();this.dye=new da.a(this.domElement,1);sb.insertBefore(this.domElement,Qb);ka.a(this.$)&&this.Kkg(!0)}get Ckh(){return this.MJc||(this.MJc=Na.a.Wo("#F5F5F5"))}get name(){return this.vO.innerText}set name(ya){this.vO&&(this.vO.innerText=
ya,this.JDc(),this.Lkg())}get sheet(){return this.RXb}get anchor(){return this.jHc}get tabIndex(){return this.anchor.tabIndex}set tabIndex(ya){this.anchor.tabIndex=ya}FVh(){return ia.DOMElementExtensions.Ff(this.anchor)?this.anchor:null}dispose(){if(this.zU){H.a.instance.Ba(C.a.pointerDown,this.domElement,this.onPointerDown);U.KeyInputManager.instance.Ba(C.a.Sb,this.domElement,this.onKeyDown);U.KeyInputManager.instance.Ba(C.a.hp,this.domElement,this.vz);yb.a.instance.Ba(C.a.click,this.domElement,
this.fd);H.a.instance.Ba(C.a.XV,this.domElement,this.yGb);H.a.instance.Ba(C.a.qB,this.domElement,this.f6);if(this.PBb||m.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))H.a.instance.Ba(C.a.Kf,this.domElement,this.Wg),this.dxa&&(I.a.instance.Ba(C.a.ve,this.domElement,this.Wg),I.a.instance.Ba(C.a.Tf,this.domElement,this.BN));this.zU=!1;this.O6b="#BEBBB8"}x.a.pc([this.fDe,this.dye]);this.vO=this.yE=this.jHc=this.WR=this.dye=this.fDe=null;if(this.Qna){for(let ya of this.Qna)ya.dispose();
this.Qna=null}this.color=this.RXb=null;super.dispose()}fS(ya){ya&&this.Kna(!1,!1);super.fS(ya)}k$f(ya){if(Gb.a.pg.OQ){this.EMe();var sb=e.GetServiceTaskFactory.Oa(this.$.da,322,323,1);f.TaskExtensions.za(sb,Qb=>{Zb.UISurfaces.hH().then(oc=>{const kb=Qb.result;kb.pAj(oc);kb.show(ya);return null},oc=>{u.ULS.sendTraceTag(537153688,0,15,`SheetTabButton.ShowNamedSheetViewTeachingUI: Failed to GetNotificationsAPIAsync: ${oc}`);return null})},this.la,3)}}wpe(){if(this.sheet.active&&this.$.ar){var ya=this.$.ar,
sb=Fa.h(this.$),Qb=sb.sj;if(this.sheet.Zd.kz){if(!this.aFb){const oc=new tb(this.sheet,this.WR.Zyc,()=>this.color?za.qUd(this.color):!1,this.ww);this.aFb=new db(this.$,oc);this.Qna.add(this.aFb)}Qb&&sb.sgb(1);ya.classList.add(ba.a.wVe);ya=za.U4e(n.a.axf);sb=za.U4e(n.a.iAd);"true"===ya&&"true"===sb?this.$.ea.hUd&&this.$.ea.kNb&&(this.sheet.Zd.hK?(ya=1,qb.a.Cv(n.a.iAd,"false",qb.a.m_),this.$.ea.kNb=!1):ya=0,qb.a.Cv(n.a.axf,"false",qb.a.m_),this.$.ea.hUd=!1,this.k$f(ya)):this.sheet.Zd.hK&&"true"===sb&&
this.$.ea.kNb&&(qb.a.Cv(n.a.iAd,"false",qb.a.m_),this.$.ea.kNb=!1,this.k$f(2))}else this.EMe(),Qb&&sb.sgb(0),ya.classList.remove(ba.a.wVe)}}EMe(){const ya=this.$.da.Aa(322);ya&&ya.dismiss()}Dgb(){this.name=this.sheet.name;this.domElement.className=this.sheet.active||this.u7a()?V.AQj:V.IQj;m.EwaSettings.isChangeGateEnabled("OfficeVSO:5262355_SheetTabFocusBugFix")?this.vO.parentNode.classList.add(V.Dzi):this.vO.parentNode.classList.add(V.Ezi);this.Lkg();this.Xpd&&this.wpe();this.iJj();this.Tkg();this.JDc();
this.Xpd||this.wpe()}n_i(){this.mTd=!0;this.Kna(!0,!0,"OnSheetReorderStarted")}m_i(){this.mTd=!1;this.Kna(!1,void 0,"OnSheetReorderEnded")}activate(ya=0,sb=!1){this.I3b()||(this.sheet.activate(),sb&&Fa.h(this.$).focus(),ya={["InputMethod"]:qa.a[ya],["AppMode"]:this.$.xc,["Location"]:"canvas"},Oa.b(this.$).rd(Ya.a.dEj,ya))}Kkg(ya){this.O6b=ya?"#797775":"#BEBBB8";this.Y6c=ya?-.5:.5;this.MJc=ya?Na.a.Wo("#3B3A39"):Na.a.Wo("#F5F5F5");this.Tkg()}gxj(ya){this.PBb=ya}KCd(ya){ya.k4c();this.sBe(ya)}sBe(ya){ya.N0a();
this.sheet.activate()}FHg(ya){ya=new Ba.a(-1876836819,ya,this.$.xc,30,null);return this.$.Ia.Hb(ya,{[n.a.oTd]:this.sheet.name})}Lkg(){this.vO.parentNode.setAttribute("sheet-title",this.vO.innerText)}JDc(){const ya=this.cPh();this.anchor.setAttribute(n.a.Vu,ya);this.anchor.setAttribute(n.a.U9,this.sheet.active.toString())}cPh(){const ya=this.sheet.Zd.kz,sb=this.sheet.Zd.Inb,Qb=this.sheet.Ph,oc=this.sheet.isLockPausedInSession;return ya&&Qb?String.format(E.a.instance.ob(20),this.name,sb):ya&&oc?String.format(E.a.instance.ob(22),
this.name,sb):ya?String.format(E.a.instance.ob(19),this.name,sb):Qb?String.format(E.a.instance.ob(18),this.name):oc?String.format(E.a.instance.ob(21),this.name):this.name}activateSheet(ya=0){if(w.a.wtd()){if(m.EwaSettings.isChangeGateEnabled("OfficeVSO:4099273_PromptForCommentsOnSheetChange")&&this.I3b())return h.Task.Sa(!1);Qa.a.current.LR="ActivateSheet";this.sheet.activate();return h.Task.Sa(!0)}return this.FHg(ya)}Tkg(){const ya=this.sheet.tabColor;this.color=ya?Na.a.Wo(ya):this.Ckh;this.Wjf=
za.qUd(this.color);this.Kna(!1,void 0,"UpdateTabColor")}Kna(ya,sb=!1,Qb=null){if(this.sheet){Qb=this.sheet.active;var oc=this.u7a(),kb=!!this.sheet.tabColor,jb=Na.a.RF(Qb||oc?Ja.a.white:this.color);this.yE.style.background="";Qb||oc?(kb?m.EwaSettings.isChangeGateEnabled("OfficeVSO:5293663_SheetTabHighContrastBackgroundBug")&&this.$.zLa?this.gCj():this.vm?this.fCj():this.eCj():this.vm||(this.yE.style.backgroundColor=jb),this.yE.style.height=this.t3c.toString()+"px"):(this.yE.style.filter="",this.yE.style.backgroundColor=
jb,this.yE.style.height=this.u3c.toString()+"px");this.vO.className=Qb?V.BQj:oc?V.dark:this.Wjf?V.light:V.dark;for(let Wb of this.Qna)Wb.Qjg();this.vm&&(ya&&!kb&&(this.yE.style.backgroundColor="#E1DFDD"),ia.DOMElementExtensions.toggleCssClass(this.domElement,V.HQj,ya),sb?(kb||(this.yE.style.backgroundColor=this.O6b),this.domElement.style.backgroundColor=this.O6b):(kb||(this.yE.style.backgroundColor=""),this.domElement.style.backgroundColor=""));this.vO.style.fontWeight=Qb||oc||!this.vm&&ya?this.vm?
"600":"bold":""}else u.ULS.sendTraceTag(537153687,0,15,`SheetTabButton.SetTabColors: can't change colors to a sheet tab without sheet, whihc means its not rendered. caller: ${Qb}`)}fCj(){const ya=this.yE.style,sb=Na.a.RF(za.L1c(this.color,this.Y6c));ya.background=sb}eCj(){const ya=this.yE.style,sb=Na.a.RF(za.L1c(this.color,1)),Qb=Na.a.RF(za.L1c(this.color,this.Y6c));ya.background=`$linear-gradient(${sb}, ${Qb})`}gCj(){this.yE.style.background="transparent"}cbh(){this.jHc=document.createElement("a");
this.anchor.removeAttribute("Href");this.anchor.className=V.CQj;ia.DOMElementExtensions.It(this.anchor,n.a.upb,null,null);this.tabIndex=-1}ihh(){this.yE=document.createElement("span");this.yE.className=V.FQj;this.vO=document.createElement("span");this.vO.className=V.KQj;this.vO.dir=this.sheet.rtlName?"rtl":"ltr";this.yE.appendChild(this.vO)}iJj(){const ya=this.$.XI;for(let sb of this.Qna)sb.hJj(ya,this.yE,this.vO)}u7a(){return Fa.h(this.$).u7a(this.sheet)}JNj(){this.Hmd.start();this.Zqd=!0}HPe(ya){this.Zqd&&
(this.Hmd.stop(),u.ULS.sendTraceTag(537153686,0,50,Kb.c({["Sheet index"]:this.sheet.index,["Active Sheet"]:this.sheet.active,["Hovering time"]:this.Hmd.Bc,["Has been clicked"]:ya})),this.Zqd=!1)}Ygj(){H.a.instance.ta(C.a.pointerDown,this.domElement,this.onPointerDown);U.KeyInputManager.instance.ta(C.a.Sb,this.domElement,this.onKeyDown);U.KeyInputManager.instance.ta(C.a.hp,this.domElement,this.vz);this.Cc.ka("mouseover",this.xN);this.Cc.ka("mouseout",this.wN);H.a.instance.ta(C.a.XV,this.domElement,
this.yGb);H.a.instance.ta(C.a.qB,this.domElement,this.f6);if(this.PBb||m.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))H.a.instance.ta(C.a.Kf,this.domElement,this.Wg),this.dxa&&(I.a.instance.ta(C.a.ve,this.domElement,this.Wg),I.a.instance.ta(C.a.Tf,this.domElement,this.BN));yb.a.instance.ta(C.a.click,this.domElement,this.fd);this.zU=!0}I3b(){const ya=this.$.da.Aa(65);return ya&&ya.Fka()?(ya.Jwc(),this.sBe(ya),!0):!1}static U4e(ya){let sb=qb.a.get(ya);sb||(qb.a.Cv(ya,
"true",qb.a.m_),sb=qb.a.get(ya));return sb}static L1c(ya,sb){if(1<sb||-1>sb)return ya;let Qb=ya.r,oc=ya.g;ya=ya.b;0<sb?(Qb=Qb*(1-sb)+255*sb,oc=oc*(1-sb)+255*sb,ya=ya*(1-sb)+255*sb):(Qb*=1+sb,oc*=1+sb,ya*=1+sb);return Ja.a.$vb(Math.round(Qb),Math.round(oc),Math.round(ya))}static qUd(ya){return 128>=(222*ya.r+707*ya.g+71*ya.b)/1E3}}Object(r.a)(za,"SheetTabButton",nb,[]);class Sa extends nb{constructor(ya,sb,Qb){super(document.createElement("a"),sb);this.nha=m.EwaSettings.ra(437)?ba.a.Fad:ba.a.$zh;Qb.pb(this.domElement,
E.a.instance.ga(712),0,this.nha,E.a.instance.ga(712),X.a.V3c,!0);ya.appendChild(this.domElement);this.Cc.ka("contextmenu",oc=>{Ma.g(oc)})}}Object(r.a)(Sa,"WorkbookProtectionButton",nb,[]);var Wa=a(52),ab=a(42),ma=a(58);class ha extends L.a{constructor(ya,sb,Qb=null,oc=null){super(sb);this.sheetTabActivatePreviousHidden=E.a.instance.ga(721);this.sheetTabActivateNextHidden=E.a.instance.ga(723);this.svgIconProvider=null;this.oh=[];this.wK=Array(6);this.sAd=Array(6);this.nSa=this.Vzb=this.nH=this.bzc=
this.deb=this.dzc=this.tTd=this.Vk=null;this.isRtl=!1;this.jK=this.gv=0;this.B8b=this.qvc=!1;this.$rc=this.rna=0;this.sM=this.t3=this.kaa=this.K8b=null;this.Zdc=this.TC=0;this.AOb=null;this.QCb=-1;this.IY=null;this.$qc=0;this.PAc=-1;this.Lma=0;this.Nta=new M;this.ONc=!1;this.rvc=this.ezc=this.UMb=this.Pje=this.q_=null;this.Sbe=!1;this.Cnd=null;this.Mzd=!1;this.htmlSanitizationHelper=this.Oje=null;this.mD=(kb,jb)=>{this.HIf(jb.item)};this.Sya=(kb,jb)=>{kb=this.$.va.na.index;for(let Wb=0,wc=this.oh.length;Wb<
wc;Wb++){const Jc=this.tQ(Wb);if(Jc.name===jb.oldName){Jc.name=jb.newName;this.V_();Wb===kb&&this.h0(6);break}}};this.LIf=(kb,jb)=>{(kb=this.n3a(jb.item))&&kb.Dgb()};this.MIf=(kb,jb)=>{jb.visible?(this.eSa(!1),this.IIf(jb.item)):this.HIf(jb.item)};this.rN=kb=>{this.hF?(this.IY=kb,this.WPb()):(this.IY&&(this.$rc+=this.IY.clientPoint.x-kb.clientPoint.x),this.IY=kb,Math.abs(this.$rc)>=this.Kph&&this.WPb());return!0};this.BN=kb=>{kb.Ea.preventDefault();return!1};this.c2f=kb=>{this.Z1f(kb,!0)};this.b2f=
kb=>{this.Z1f(kb,!1)};this.c6=kb=>{if(this.hF&&(this.jz||this.xmf(kb)))if(this.B8b=this.qif(kb),this.jz){let jb;kb=(jb=this.tQ(this.TC+1))?jb.sheet:null;this.reorderSheets(kb,this.TC+1===this.rTd,!0)}else kb=this.Mzd?null:this.Cnd,this.reorderSheets(kb,this.Mzd,!0);this.YP();return!0};this.ij=(kb,jb)=>{jb.uF&&this.S0d(jb.uF);this.gyc(!1);this.V_();jb.na&&(this.S0d(jb.na),this.h0(6),this.ea.tma())};this.pzf=(kb,jb)=>{this.BEc(jb.item)};this.qzf=(kb,jb)=>{this.BEc(jb.item)};this.rzf=(kb,jb)=>{this.BEc(jb.item)};
this.WOa=(kb,jb)=>{this.BEc(jb.item)};this.yya=()=>{this.J2c()};this.dd=()=>{this.isVisible=!this.ea.isNamedObjectViewMode;this.J2c();this.G6c();m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&(ma.d(this.$)||ma.e(this.$))&&(ab.PageLoadTrackingInfo.instance.BR(n.a.OAa,["sheetTabBar"]),ab.PageLoadTrackingInfo.instance.oW(n.a.OAa,["sheetTabBar"]));this.n6c();this.V_();this.eSa(!0);this.h0(6)};this.wj=()=>{this.isVisible&&(this.V_(),this.h0(6))};this.tf=()=>{Object(G.a)(R,
this.nH)===Z.k(this.$.dg)&&this.n6c();for(const kb of this.oh)kb.gxj(!Z.k(this.$.dg))};this.KIf=(kb,jb)=>{this.tmj(jb.item,jb.isUserOperation)};this.PGb=(kb,jb)=>{this.IIf(jb.item)};this.onKeyDown=kb=>{switch(kb.keyCode){case 9:var jb=this.domElement.querySelectorAll(ia.DOMElementExtensions.nr);const Wb=ia.DOMElementExtensions.rm(jb);jb=ia.DOMElementExtensions.PA(jb);ia.DOMElementExtensions.FAa(kb,Wb,jb);break;case 39:case 37:ia.DOMElementExtensions.a5f(kb,this.domElement.querySelectorAll(ia.DOMElementExtensions.nr),
39===kb.keyCode?!this.isRtl:this.isRtl)}u.ULS.sendTraceTag(537153691,0,50,`SheetTabBarControl.OnKeyDown: Press on ${kb.keyCode}`)};this.onScroll=()=>{this.Vk.scrollLeft!==this.rna&&this.mSj()};this.zN=kb=>{if(kb.ctrlKey||kb.W2)return!1;this.Vk.scrollLeft+=Math.floor(30*kb.qCa);if(this.jz&&this.hF){const jb=this.u3e("OnMouseWheel");jb&&this.GXd(0<kb.qCa,jb.x+jb.width/2)}return!0};this.pF=(kb,jb)=>{if(this.Nta)this.baf("PartialInteractivity",jb.OL?3:0);else{this.YP(!1);this.XRd(jb.OL);for(const Wb of this.Vwe)Wb&&
Wb.fS(jb.OL);for(const Wb of this.oh)Wb&&Wb.fS(jb.OL)}};this.$Fb=(kb,jb)=>{kb=0;jb.Kne&&(kb=2|(jb.iEj?1:0));this.baf("ComponentRangePicker",kb)};this.$=ya;this.ea=this.$.ea;this.S8b=(this.jz=w.a.qkf())&&!m.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2");this.vm=m.EwaSettings.ra(437);this.ww=w.a.Jsd();this.umf=this.vm&&!this.$.tw;this.jz&&(this.Sbe=this.vm&&!y.a.sw);this.rqi=m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InSheetTemplates",
!1);this.xKi=this.$.ya.SheetTabNavigateButtonLongKeyPressPeriodMS;this.wKi=this.$.ya.SheetTabNavigateButtonIntervalPeriodMS;this.Kph=this.$.ya.SheetTabDragStartPixelThreshold;this.KPa=this.LPa=-1;this.H4c=!1;this.htmlSanitizationHelper=oc;this.ww&&(this.svgIconProvider=Qb);this.jC=new da.a(this.domElement,3);this.vm&&this.domElement.classList.add(V.dzh);this.Teh();this.tch();this.Ueh();m.EwaSettings.YM()&&document.getElementById(n.a.cba)||this.Xfh();this.gyc(!0);this.dd(null,null);ya=this.$.va;ya.Vf(this.ij);
ya.lXc(this.yya);ya.fY(this.mD);ya.Nga(this.PGb);ya.aGa(this.Sya);ya.Xqe(this.KIf);ya.YYa(this.MIf);ya.pNg(this.LIf);ya.vXc(this.pzf);ya.Uqe(this.qzf);ya.Vqe(this.rzf);ya.Wqe(this.WOa);this.$.Lk(this.dd);this.$.dC(this.wj);Y.a(this.$).Yh(this);this.$.da.Ha(32,this);m.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport")&&this.$.ea.$t(this.tf);this.czc=this.Ae.ie(this.domElement);this.czc.ka("keydown",this.onKeyDown);fb.a(this.$).ep()&&this.pF(null,new Ca.a(!0));fb.a(this.$).Sf.y9(this.pF);
Fa.h(this.$).rqe(this.$Fb);this.czc.ka("mousedown",kb=>{kb.preventDefault()});v.a.instance.ta(C.a.eD,this.domElement,this.zN);this.sTd=this.Ae.ie(this.Vk);this.sTd.ka("scroll",this.onScroll);this.mSj=Ta.a(()=>{this.V_()},200,this.$.la,O.a.nEj,!0);this.$.TA(n.a.oLj);this.umf&&(this.Oje=new Ra(this.$,this.nSa.domElement));m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&ab.PageLoadTrackingInfo.instance.Z_(n.a.OAa,["sheetTabBar"])}get jc(){return this.domElement}get Ff(){return this.isVisible}get Xd(){return ra.a.qTd}get hF(){return this.ONc}get rTd(){return this.oh.length}get Zyc(){return this.Pje}get dxa(){return this.Sbe}get navigationButtonsDisabled(){return!!this.Nta&&
this.Nta.navigationButtonsDisabled}get operationButtonsDisabled(){return!!this.Nta&&this.Nta.operationButtonsDisabled}get rAd(){return this.vm?this.$.XI?[ba.a.S9b,ba.a.fTe,ba.a.hTe,ba.a.R9b,ba.a.qua,ba.a.qua]:[ba.a.R9b,ba.a.hTe,ba.a.fTe,ba.a.S9b,ba.a.qua,ba.a.qua]:this.$.XI?[ba.a.S9b,ba.a.eTe,ba.a.gTe,ba.a.R9b,ba.a.qua,ba.a.qua]:[ba.a.R9b,ba.a.gTe,ba.a.eTe,ba.a.S9b,ba.a.qua,ba.a.qua]}get tAd(){return this.$.XI?[null,X.a.ZEe,X.a.XEe]:[null,X.a.XEe,X.a.ZEe]}get qOf(){return this.$.XI?[null,X.a.$Ee,
X.a.YEe]:[null,X.a.YEe,X.a.$Ee]}get tDb(){if(this.isRtl){if(y.a.iF)return 0;if(y.a.Cf)return-1*(this.Vk.scrollWidth-this.Vk.clientWidth);if(y.a.sw)return this.Vk.scrollWidth-this.Vk.clientWidth;u.ULS.sendTraceTag(537153762,0,15,"SheetTabBarControl.ScrollLeftEdgeValue: unknown browser")}return 0}get YKb(){if(this.isRtl){if(y.a.iF)return this.Vk.scrollWidth-this.Vk.clientWidth;if(y.a.Cf||y.a.sw)return 0;u.ULS.sendTraceTag(537153761,0,15,"SheetTabBarControl.ScrollRightEdgeValue: unknown browser")}return this.Vk.scrollWidth-
this.Vk.clientWidth}get Vwe(){return this.Nta?[this.nH,this.Vzb]:[this.nH,this.Vzb,this.nSa]}get JQj(){return this.oh.concat(this.nSa)}get gEj(){return this.Oje}pb(ya,sb,Qb,oc,kb,jb,Wb=!1){ya.removeAttribute("Href");ya.setAttribute(n.a.Cd,n.a.Qs);ya.className=V.Ryh;ya.title=sb;ya.tabIndex=0;this.ww&&jb?Qb=this.svgIconProvider.pba(jb,12,12,ya,24,24):(sb=document.createElement("span"),sb.className=this.vm?ba.a.M5g:ba.a.Or,sb.classList.add(P.a.cia),sb.tabIndex=-1,ya.appendChild(sb),jb=document.createElement("img"),
jb.src=xa.a.qe(Qb),jb.className=oc,jb.alt=kb,jb.tabIndex=-1,sb.appendChild(jb),Qb=jb);Wb&&ya.classList.add(P.a.$T);return Qb}dispose(){if(this.$){var ya=this.$.va;ya.sg(this.ij);ya.PLd(this.yya);ya.N6(this.mD);ya.bna(this.PGb);ya.HQa(this.Sya);ya.DWf(this.KIf);ya.VJb(this.MIf);ya.pkj(this.LIf);ya.$Ld(this.pzf);ya.AWf(this.qzf);ya.BWf(this.rzf);ya.CWf(this.WOa);this.$.pl(this.dd);this.$.zF(this.wj);fb.a(this.$)&&fb.a(this.$).Sf.vda(this.pF);this.Nta&&Fa.h(this.$).cWf(this.$Fb);v.a.instance.Ba(C.a.eD,
this.domElement,this.zN)}x.a.pc(this.sAd);this.sAd=null;if(this.wK)for(ya=0;ya<this.wK.length;ya++){const sb=ia.DOMElementExtensions.OJ(this.wK[ya],this.domElement,!1,"a");sb&&B.a.Wma(sb)}x.a.Ja(this.jC);x.a.Ja(this.czc);x.a.Ja(this.sTd);this.sTd=this.czc=this.Vzb=this.nH=this.jC=null;this.$&&this.jz&&this.YP(!1);this.kaa=null;this.oRd(null,"Dispose");this.AOb=this.sM=this.K8b=null;this.J2c();this.deb=this.dzc=this.tTd=this.Vk=this.wK=this.$=this.ea=null;super.dispose()}ag(ya,sb){if(!sb){u.ULS.shipAssertTag(537153760,
0,0<this.oh.length,"There is no sheet tab button.");if(!this.oh.length)return!1;ya=null;for(const Qb of this.oh)if(ya=Qb.FVh())break;if(!ya)return u.ULS.shipAssertTag(537153759,0,!1,"There is no focusable tab element."),!1;ia.DOMElementExtensions.setFocus(ya)}return!sb}sh(ya){return ia.DOMElementExtensions.Af(this.jc,ya)}rj(){}dk(){}reorderSheets(ya,sb,Qb){if(this.q_&&this.q_!==ya){const oc=this.q_.index;this.smj(this.q_,ya,sb);ya=ya?ya.index-1:sb?this.$.va.count-1:0;oc!==ya&&(this.aEi(oc,ya,Qb),
this.zsh(this.q_.name,ya))}}P6h(ya){ya=this.Sia(ya);return-1!==ya&&this.gv<=ya&&ya<=this.jK?this.oh[ya].domElement:null}c2j(ya){if(this.ww){for(var sb=0;sb<this.wK.length;sb++){const Qb=this.wK[sb];if(Qb&&this.svgIconProvider){const oc=Qb.parentNode;this.GVf(Qb);oc&&(this.wK[sb]=this.svgIconProvider.pba(ya?this.qOf[sb]:this.tAd[sb],12,12,oc,24,24))}}for(sb=0;sb<this.oh.length;sb++)this.oh[sb].Kkg(ya);this.nSa&&this.nSa.Dsa&&this.Jkg(X.a.D8h,this.nSa,ya);this.nH&&this.nH.Dsa&&this.Jkg(X.a.R7g,this.nH,
ya)}}Jkg(ya,sb,Qb){sb.Vab||(sb.Vab=this.svgIconProvider.pba(ya,12,12,sb.Dsa.parentNode,24,24));sb.Vab&&(ia.DOMElementExtensions.setVisible(sb.Dsa,!Qb),ia.DOMElementExtensions.setVisible(sb.Vab,Qb))}q_i(ya,sb){var Qb=Fa.h(this.$);const oc=Qb.inRangePicker,kb=Da.HelperMethods.oo(sb);if(Qb.fb&&!oc){const jb=Qb.Ql?"formulaBar_end_edit_sheet_changed":"cell_text_end_edit_sheet_changed";let Wb=void 0;m.EwaSettings.w7a&&(Wb=[Object(ca.a)(Qb.mc.textBox.tBa)]);ca.b(this.$).IBa(kb.rawEvent,jb,Wb);Qb.endEdit(!0,
"SheetTabBar.OnSheetTabMouseDown")}Qb=this.dxa&&3===sb.vb;!(2===sb.vb&&kb.button===Sys.UI.MouseButton.leftButton||Qb)||oc||this.hF||fb.a(this.$).ep()||(Qb&&ya.n_i(),this.QCb=sb.clientPoint.x,this.IY=sb,this.UVg(ya))}o_i(ya){!this.jz&&this.hF&&this.fVd(ya.sheet,!1)}p_i(ya){this.jz||(this.hF&&this.reorderSheets(ya.sheet,!1,!0),this.YP());this.V_()}Wse(){return this.$.isEditMode&&!Z.k(this.$.dg)}V_(){const ya=Da.HelperMethods.gR(()=>{this.Y_j();this.vm&&this.IBj();this.XRd()});u.ULS.sendTraceTag(537153757,
0,50,`SheetTabBarControl.RearrangeContentAreaAndNavAreaExtra: duration = ${ya}`)}IBj(){const ya=this.jK===this.oh.length-1;ia.DOMElementExtensions.toggleCssClass(this.deb,this.$.XI?V.iTe:V.YSe,!!this.gv);ia.DOMElementExtensions.toggleCssClass(this.deb,this.$.XI?V.YSe:V.iTe,!ya)}XRd(ya=!1){const sb=!this.gv,Qb=this.jK===this.oh.length-1;this.I5f(4,this.sheetTabActivatePreviousHidden,!sb);this.I5f(5,this.sheetTabActivateNextHidden,!Qb);this.tyc(0,sb||ya);this.tyc(1,sb||ya);this.tyc(2,Qb||ya);this.tyc(3,
Qb||ya)}I5f(ya,sb,Qb){if(ya=this.wK[ya]){ia.DOMElementExtensions.setVisible(ya,Qb);var oc=this.Z4e(ya);oc.title="img"===ya.nodeName?ya.alt=0<this.oh.length&&Qb?sb:"":ya.title=0<this.oh.length&&Qb?sb:"";oc.tabIndex=Qb?0:-1}}Z4e(ya){return this.ww?ya.parentNode:ya.parentNode.parentNode}tyc(ya,sb){if(ya=this.wK[ya])ya=this.Z4e(ya),void 0!==ya&&null!==ya&&(!this.oh.length||sb?(ya.classList.add(P.a.$T),ya.setAttribute(n.a.osa,"true")):(ya.classList.remove(P.a.$T),ya.setAttribute(n.a.osa,"false")))}eSa(ya){const sb=
this.$.XI?this.oh.length-1:0;let Qb=this.B7e(this.$.XI?0:this.oh.length-1);Qb&&(Qb.borderRightWidth=ya?"1px":"0");this.gv!==this.jK&&(Qb=this.B7e(sb))&&(Qb.borderRightWidth="0")}Kpe(ya,sb){this.oh||(this.oh=[]);-1===sb?this.oh.push(ya):this.oh.splice(sb,0,ya)}i6b(ya,sb){let Qb=-1,oc=null;sb||(Qb=this.KZh(ya.index),-1!==Qb&&(oc=this.VKa(Qb)));ya=new za(this.$,this.Vk,oc,ya,this,this.vm,this.ww);this.Kpe(ya,Qb);ia.DOMElementExtensions.setVisible(ya.domElement,!0)}fVd(ya,sb){var Qb=this.n3a(ya);if(Qb){this.Cnd=
ya;this.Mzd=sb;ya=Qb.domElement;Qb=this.isRtl?ya.offsetLeft+(this.Vk.scrollWidth-this.Vk.clientWidth-this.Vk.scrollLeft):ya.offsetLeft-this.Vk.scrollLeft;if(!this.isRtl&&sb||this.isRtl&&!sb)Qb+=ya.offsetWidth;this.bzc.style.left=Da.HelperMethods.sc(Qb-4);ia.DOMElementExtensions.setVisible(this.bzc,!0)}}qcf(){ia.DOMElementExtensions.setVisible(this.bzc,!1)}h0(ya){const sb=Da.HelperMethods.gR(()=>{switch(ya){case 0:this.Zwc(0);break;case 1:this.Zwc(this.gv-1);break;case 2:this.Zwc(this.gv+1);break;
case 3:this.scrollIntoView(this.oh.length-1);break;case 4:this.gv&&1<=this.oh.length&&(this.une(this.gv-1),this.MPd());break;case 5:this.jK!==this.oh.length-1&&1<=this.oh.length&&(this.une(this.jK+1),this.MPd());break;case 6:this.MPd()}});this.S8b&&this.hF&&this.WPb();u.ULS.sendTraceTag(537153755,0,50,`SheetTabBarControl.ScrollSheetTabs: operation = ${ya}, duration = ${sb}`)}une(ya){(ya=this.tQ(ya))&&ya.activate()}QHh(ya){if(0===ya.AB){const sb=this.$.va;let Qb=0;for(let oc=0,kb=sb.count;oc<kb;oc++){const jb=
Object(D.a)(fa.a,sb.getItem(oc));if(jb===ya)return Qb;0===jb.AB&&Qb++}}return-1}DHh(ya){const sb=this.$.va;for(let Qb=ya.index+1,oc=sb.count;Qb<oc;Qb++)if(ya=Object(D.a)(fa.a,sb.getItem(Qb)),0===ya.AB)return ya;return null}Sia(ya){for(let sb=0;sb<this.oh.length;sb++){const Qb=this.tQ(sb);if(!Qb)u.ULS.sendTraceTag(537153754,0,15,`SheetTabBarControl.FindMatchingSheetTabIndex: sheetTabButton[${sb}] is null even though index is not out of bounds!`);else if(Qb.sheet===ya)return sb}return-1}n3a(ya){ya=
this.Sia(ya);return this.tQ(ya)}aEi(ya,sb,Qb){const oc={};oc.a=this.$.ya.UserSessionId;oc.b=Qb;oc.c=this.B8b;oc.d=ya;oc.e=sb;oc.f=this.$.va.count;Wa.b().Se(2,oc,Qb)}smj(ya,sb,Qb){const oc=Object(D.a)(ua.a,this.$.va);sb?(sb=sb.index,sb=ya.index<sb?sb-1:sb):sb=Qb?oc.count-1:0;oc.reorderSheet(ya,sb,!0)}f5f(ya){Fa.h(this.$).Gg.vp(ya)}UVg(ya){if(!this.qvc){const sb=this.domElement.ownerDocument.body;this.jz?(H.a.instance.ta(C.a.yj,document.documentElement,this.rN),this.dxa&&(I.a.instance.ta(C.a.Tf,document.documentElement,
this.rN),I.a.instance.ta(C.a.Tf,this.domElement,this.BN))):(H.a.instance.ta(C.a.yj,sb,this.rN),I.a.instance.ta(C.a.Tf,sb,this.rN));H.a.instance.ta(C.a.Kf,document.documentElement,this.c6);I.a.instance.ta(C.a.ve,sb,this.c6);this.qvc=!0}this.q_=ya.sheet;this.B8b=!1;this.jz?(this.sM=null,this.K8b=ya,this.kaa=ya.domElement,this.oRd(ia.DOMElementExtensions.getBoundingClientRect(this.kaa),"BeginSheetTabButtonDrag")):(u.ULS.sendTraceTag(537153752,0,50,"SheetTabBarControl.BeginSheetTabButtonDrag: Starting legacy sheet tab drag and drop."),
this.domElement.classList.add(V.XSe),this.domElement.style.cursor="",this.f5f("pointer"))}YP(ya=!0){if(this.qvc){this.f5f(n.a.QU);const sb=this.domElement.ownerDocument.body;this.jz?(H.a.instance.Ba(C.a.yj,document.documentElement,this.rN),this.dxa&&(I.a.instance.Ba(C.a.Tf,document.documentElement,this.rN),I.a.instance.Ba(C.a.Tf,this.domElement,this.BN))):(H.a.instance.Ba(C.a.yj,sb,this.rN),I.a.instance.Ba(C.a.Tf,sb,this.rN));H.a.instance.Ba(C.a.Kf,document.documentElement,this.c6);I.a.instance.Ba(C.a.ve,
sb,this.c6);this.ONc=this.qvc=!1}this.$rc=0;this.B8b=!1;this.Cnd=this.q_=null;this.jz?(this.kaa&&(this.kaa.style.visibility="visible",this.kaa=null),this.K8b=null,this.oRd(null,"EndSheetTabButtonDrag"),this.sM&&(this.sM.parentNode&&this.sM.parentNode.removeChild(this.sM),this.sM=null),this.Foj(ya)):(this.domElement.classList.remove(V.XSe),this.qcf())}Foj(ya){this.UWd(ya);this.TC=this.QCb=-1}zsh(ya,sb){const Qb=this.$.oa,oc=Qb?Qb.xa:null;this.$.userOperationManager.Jc(new ea.a(557,0,(kb,jb,Wb)=>mc(oc,
ya,sb,kb,jb,Wb,null),64,()=>new na(ya,sb)),null)}tQ(ya){return 0<=ya&&ya<this.oh.length?this.oh[ya]:null}A7e(ya){return(ya=this.tQ(ya))?ya.sheet:null}VKa(ya){return(ya=this.tQ(ya))?ya.domElement:null}B7e(ya){return(ya=this.VKa(ya))?ya.style:null}KZh(ya){const sb=this.$.va;ya+=1;let Qb=-1;const oc=this.oh?this.oh.length:0;for(;ya<sb.count;){const kb=Object(D.a)(fa.a,sb.getItem(ya));if(0===kb.AB){for(Qb=0;Qb<oc&&this.A7e(Qb)!==kb;Qb++);break}ya++}return-1===Qb||Qb===oc?-1:Qb}HIf(ya){var sb=this.n3a(ya);
sb&&(this.jz&&this.hF&&(u.ULS.sendTraceTag(537153751,0,50,"SheetTabBarControl.OnSheetDeletedOrHidden: A sheet has been deleted while re-order operation is midway."),m.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.YP()),this.Vk.removeChild(sb.domElement),sb=Array.indexOf(this.oh,sb),this.oh.splice(sb,1),this.V_(),(!this.isRtl&&sb===this.oh.length||this.isRtl&&!sb)&&this.eSa(!0),this.S8b&&this.hF?ya===this.q_?(this.YP(),this.h0(6)):this.WPb():
this.h0(6))}IIf(ya){const sb=Object(D.a)(fa.a,ya);this.jz&&this.hF&&(u.ULS.sendTraceTag(537153750,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: A sheet has been added to the sheet tab bar while re-order operation is midway."),m.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.YP());if(0===sb.AB){this.eSa(!1);var Qb=this.Sia(ya);-1===Qb&&(u.ULS.sendTraceTag(537153749,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: could not find matching sheet tab index. Creating sheet tab..."),
this.i6b(sb,!1),Qb=this.Sia(ya));this.kaf(Qb,!0)}}tmj(ya,sb){const Qb=this.n3a(ya);Qb&&(this.jz&&this.hF&&!sb&&(u.ULS.sendTraceTag(537153748,0,50,"SheetTabBarControl.ReorderSheetTab: A sheet has been re-ordered while re-order operation is midway."),m.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.YP()),ya=this.wQj(ya,Qb),!m.EwaSettings.isChangeGateEnabled("OfficeVSO:4176044_CancelCallsToSetTabColorAfterReorder")&&this.jz&&ya&&sb&&ya.m_i())}wQj(ya,
sb){var Qb=Array.indexOf(this.oh,sb);const oc=this.QHh(Object(D.a)(fa.a,ya));if(-1===oc||-1===Qb)return null;Qb!==oc||this.jz?(this.eSa(!1),{rIh:this.gv,Fyi:this.jK}=ha.pmj(Qb,oc,this.gv,this.jK),sb&&sb.domElement.parentNode===this.Vk&&(this.Vk.removeChild(sb.domElement),this.oh.splice(Qb,1)),sb=this.DHh(ya),Qb=this.Sia(sb),sb=new za(this.$,this.Vk,this.VKa(Qb),Object(D.a)(fa.a,ya),this,this.vm,this.ww),this.Kpe(sb,Qb),Qb=this.Sia(ya),this.kaf(Qb,!1,!this.vm)):sb=null;return sb}nth(){const ya=this.oh?
this.oh.length:0,sb=this.gv,Qb=this.jK;for(let oc=0;oc<ya;oc++){const kb=this.tQ(oc),jb=oc>=sb;kb&&(kb.tabIndex=jb&&oc<=Qb?0:-1)}}IZj(){const ya=this.oh?this.oh.length:0;for(let sb=0;sb<ya;sb++){const Qb=this.tQ(sb);Qb&&Qb.Dgb()}}kaf(ya,sb,Qb=!0){sb&&ya<=this.gv&&this.gv++;this.nth();this.eSa(!0);this.V_();this.S8b&&this.hF?this.WPb():Qb&&this.h0(6)}gyc(ya){const sb=this.$.XI;if(ya||this.isRtl!==sb)this.isRtl=sb,this.domElement.classList.remove(this.isRtl?ba.a.dTe:ba.a.jTe),this.domElement.classList.add(this.isRtl?
ba.a.jTe:ba.a.dTe),this.domElement.dir=this.isRtl?"rtl":"ltr",this.IZj();ya||this.eSa(!0);for(ya=0;ya<this.wK.length;ya++)0!==ya&&3!==ya&&(!this.vm||4!==ya&&5!==ya)&&this.J5f(ya)}Teh(){const ya=this.tTd=document.createElement("div");ya.className=V.Oyh;this.vm&&ya.classList.add(V.Pyh);this.domElement.appendChild(ya);this.c6b(ya,1,716,715);this.c6b(ya,2,718,717);this.umf&&(this.nSa=new La(this.$,this,ya));this.vm||this.c6b(ya,4,722,721)}Ueh(){const ya=this.dzc=document.createElement("div");ya.className=
V.Qyh;this.domElement.appendChild(ya);this.vm||this.c6b(ya,5,724,723);this.n6c()}Xfh(){const ya=document.getElementById(n.a.eEj),sb=document.getElementById(n.a.fEj);ya&&!sb&&u.ULS.sendTraceTag(537153746,0,50,`CreateProgressBarArea - progressBar div is not null, separator div is null. progressBarDiv parent ID: ${ya.parentNode.id}. progressBar div has child: ${!!ya.firstChild}. ProgressBarMessage div exists: ${!!document.getElementById(n.a.jTd)}`);const Qb=w.a.Amf(this.$);if(Qb&&ya&&sb)this.domElement.appendChild(ya),
this.UMb=ya.firstChild,this.ezc=document.getElementById(n.a.jTd),sb.style.visibility="visible";else{const oc=document.createElement("div"),kb=document.createElement("div");oc.className=ba.a.Zyh;kb.className=ba.a.Xyh;m.EwaSettings.isChangeGateEnabled("OfficeVSO:7103434_sheetTabProgressBarId")&&(kb.id=n.a.aeb);kb.style.display="none";const jb=document.createElement("div");jb.className=ba.a.$yh;const Wb=document.createElement("div");Wb.className=ba.a.Yyh;const wc=document.createElement("div");wc.className=
ba.a.Wyh;kb.appendChild(jb);kb.appendChild(Wb);kb.appendChild(wc);oc.appendChild(kb);this.domElement.appendChild(oc);this.UMb=kb;this.ezc=Wb;u.ULS.sendTraceTag(512275475,0,50,"SheetTabBarControl.createProgressBarArea: Create the progress bar in this function, because isSkeletonProgressBarEnabled = {0}, skeletonProgressBar={1}, skeletonProgressBarSeperator={2}.",Qb,ya,sb)}}J5f(ya){var sb=this.wK[ya];if(sb)if(this.ww){const Qb=sb.parentNode;this.GVf(sb);sb=ka.a(this.$)?this.qOf[ya]:this.tAd[ya];this.wK[ya]=
this.svgIconProvider.pba(sb,12,12,Qb,24,24)}else sb.className=this.rAd[ya]}GVf(ya){(null===ya||void 0===ya?0:ya.parentNode)&&ya.parentNode.removeChild(ya)}tch(){const ya=this.deb=document.createElement("div");ya.className=V.Iyh;this.domElement.appendChild(ya);this.ahh(ya)}ahh(ya){const sb=document.createElement("div");sb.className=V.bzh;sb.classList.add(V.Jyh);this.$.printingEnabled||sb.classList.add(aa.a.qVe);ya.appendChild(sb);this.Vk=document.createElement("ul");ia.DOMElementExtensions.It(this.Vk,
n.a.wZc,null,null);this.Vk.className=aa.a.kTe;sb.appendChild(this.Vk);this.Meh();this.Pje=document.createElement("div");this.Zyc.id="SheetIconTooltipContainer";sb.appendChild(this.Zyc)}Meh(){const ya=document.createElement("div");var sb="<div class='"+ba.a.P5g+"'>{0}</div>";const Qb=xa.a.zfd(ba.a.Zzh,0,"55_16_N","");sb=String.format(sb,Qb);m.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&m.EwaSettings.isChangeGateEnabled("OfficeVSO:7308078_ReduceInnerHTMLUsageSheetTabBar")&&
this.htmlSanitizationHelper?this.htmlSanitizationHelper.Rh(ya,sb):ya.innerHTML=sb;ya.className=V.azh;ia.DOMElementExtensions.setVisible(ya,!1);this.bzc=ya;this.Vk.appendChild(ya)}G6c(){const ya=this.$.va;for(let sb=0,Qb=ya.count;sb<Qb;sb++){const oc=Object(D.a)(fa.a,ya.getItem(sb));0===oc.AB&&(this.i6b(oc,!0),oc.active&&oc.activate())}}J2c(){x.a.pc(this.oh);this.oh=[];this.jK=this.gv=0}c6b(ya,sb,Qb,oc){const kb=document.createElement("a");ya.appendChild(kb);ya=this.tAd[sb];this.wK[sb]=this.pb(kb,
E.a.instance.ga(oc),0,this.rAd[sb],E.a.instance.ga(Qb),ya);if(5===sb||4===sb)ia.DOMElementExtensions.OJ(this.wK[sb],kb,!1,"span").style.marginTop="10px";this.J5f(sb);Qb=this.sAd[sb]=this.Ae.ie(kb);H.a.instance.ta(C.a.pointerDown,kb,Wb=>Wb.ctrlKey&&this.RQi(sb)?!0:this.RFf(sb));H.a.instance.ta(C.a.Kf,kb,()=>this.SFf());I.a.instance.ta(C.a.ve,kb,()=>this.SFf());H.a.instance.ta(C.a.pointerOut,kb,()=>this.B2c());U.KeyInputManager.instance.ta(C.a.Sb,kb,Wb=>13!==Wb.Ea.keyCode&&32!==Wb.Ea.keyCode||this.H4c?
!1:(this.H4c=!0,this.RFf(sb)));U.KeyInputManager.instance.ta(C.a.Ld,kb,Wb=>13===Wb.Ea.keyCode||32===Wb.Ea.keyCode?(this.H4c=!1,this.B2c()):!1);const jb=this.Wse();oc=Wb=>{"mouseup"===Wb.type&&this.jz&&this.hF||Ma.g(Wb);kb.classList.contains(P.a.$T)||(jb?this.ZWi(Wb,sb):this.vm||this.TFf(Wb,sb))};Qb.ka("mouseover",oc);Qb.ka("mouseout",oc);Qb.ka("focus",oc);Qb.ka("blur",oc);jb&&Qb.ka("mouseup",oc)}qif(ya){let sb=!1;const Qb=this.$.rf;Qb&&(sb=S.a.XM(ia.DOMElementExtensions.getBoundingClientRect(Qb),
ya.clientPoint));return sb}xmf(ya){return S.a.XM(ia.DOMElementExtensions.getBoundingClientRect(this.domElement),ya.clientPoint)||this.qif(ya)}MHh(ya){let sb=null;const Qb=ya.clientPoint;let oc=this.gv;if(this.xmf(ya))for(oc=this.gv;oc<=this.jK;oc++)if(sb=this.tQ(oc))if(ya=ia.DOMElementExtensions.getBoundingClientRect(sb.domElement),!this.isRtl&&Qb.x<ya.x+ya.width||this.isRtl&&Qb.x>ya.x)break;return{returnValue:sb,XHj:oc>this.jK}}WPb(){if(this.jz){if(!this.sM){u.ULS.sendTraceTag(537153743,0,50,"SheetTabBarControl.UpdateDragAndDropState: Starting modern sheet tab drag and drop.");
this.sM=this.kaa.cloneNode(!0);if(!this.A0f(this.sM,this.kaa,!0,"UpdateDragAndDropState"))return;this.kaa.style.visibility="hidden";this.sM.classList.add(V.czh);this.sM.style.borderRightWidth="";this.Zdc=this.IY.clientPoint.x-this.t3.width/2;this.sM.style.left=this.Zdc+"px";this.TC=this.Sia(this.q_);0>this.TC&&u.ULS.sendTraceTag(537153742,0,15,"SheetTabBarControl.UpdateDragAndDropState: ghostIndex < 0!")}this.S8b&&(this.TC=this.Sia(this.q_));var ya=ia.DOMElementExtensions.getBoundingClientRect(this.Vk),
sb=ya.x;ya=ya.x+ya.width;let Qb=this.IY.clientPoint.x-this.t3.width/2;Qb=Math.min(Qb,ya-this.t3.width);Qb=Math.max(Qb,sb);this.sM.style.transform="translateX("+Math.abs(Qb-this.Zdc)*(this.Zdc<Qb?1:-1)+"px)";const oc=this.IY.clientPoint.x>this.QCb;let kb=this.IY.clientPoint.x;Qb>=ya-this.t3.width?(kb=ya-this.t3.width/2,this.JPd()||this.Lma||(u.ULS.sendTraceTag(537153741,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the right."),this.$qc=
this.Vk.scrollLeft,this.Lma=window.requestAnimationFrame(this.c2f))):Qb<=sb?(kb=sb+this.t3.width/2,this.IPd()||this.Lma||(u.ULS.sendTraceTag(537153740,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the left."),this.$qc=this.Vk.scrollLeft,this.Lma=window.requestAnimationFrame(this.b2f))):this.Lma&&(u.ULS.sendTraceTag(537153739,0,50,"SheetTabBarControl.UpdateDragAndDropState: Ending scroll as dragged sheet left renderd edge of stb."),this.UWd());
this.IY.clientPoint.x!==this.QCb&&(this.GXd(oc,kb),this.QCb=this.IY.clientPoint.x)}else(ya=({XHj:sb}=this.MHh(this.IY)).returnValue)?this.fVd(ya.sheet,sb):this.qcf();this.ONc=!0}GXd(ya,sb){let Qb;for(;({e3b:Qb}=this.Lph(sb,ya)).returnValue;)this.AOb=Qb,this.pRg(ya)}pRg(ya){if(this.AOb){var sb=(ya?1:-1)*this.t3.width;if(ya&&!this.$.XI||!ya&&this.$.XI){var Qb=this.kaa;var oc=this.TC+1;var kb=!0}else Qb=(oc=this.tQ(this.TC+1))?oc.domElement:null,oc=this.TC-1,kb=!1;if(this.A0f(this.AOb,Qb,kb,"AnimateSheetSwap")){u.ULS.sendTraceTag(537153738,
0,50,`SheetTabBarControl.AnimateSheetSwap: Sheet swap between ghost-index ${this.TC} and other sheet-index ${oc}. amount of sheets in the bar: ${this.rTd} isMovingRight: ${ya}`);0<=this.TC&&this.TC<this.oh.length&&0<=oc&&oc<this.oh.length?(ya=this.oh[oc],this.oh[oc]=this.oh[this.TC],this.oh[this.TC]=ya):(u.ULS.sendTraceTag(537153737,0,15,`SheetTabBarControl.AnimateSheetSwap: indices are out of range! length: ${this.oh.length}, ghostIndex: ${this.TC}, swappedSheetIndex: ${oc}`),this.YP());this.TC=
oc;var jb=this.AOb;jb.style.transform="translateX("+sb+"px)";window.requestAnimationFrame(()=>{jb.style.transform="translateX(0px)"})}}}A0f(ya,sb,Qb,oc){const kb=jb=>jb?`Node ID: ${jb.id} , Node class: ${jb.className}, Node name: ${jb.nodeName},`:null;try{return this.Vk.insertBefore(ya,sb),!0}catch(jb){return ya=this.n3a(this.q_),u.ULS.sendTraceTag(537153736,0,15,"SheetTabBarControl.SafeInsertSheetBefore: Reference node is not a descendant of the sheet tab bar. sheetTabButonState: [{0}], Caller: [{1}], Node to insert before [{2}], That node's parent: [{3}],SheetTabListElement: [{4}], isReferenceSheetTheDraggedSheet:[{5}], ghostIndex:[{6}], sheetTabButtons length:[{7}], Exception: [{8}]",
ya?ya!==this.K8b?"Changed":"NoChange":"Removed",oc,kb(sb),kb(sb.parentNode),kb(this.Vk),Qb,this.TC,this.rTd,jb),this.YP(),!1}}Lph(ya,sb){var Qb=this.$.XI===sb?this.tQ(this.TC-1):this.tQ(this.TC+1);if(!Qb)return{returnValue:!1,e3b:null};Qb=Qb.domElement;const oc=ia.DOMElementExtensions.getBoundingClientRect(Qb);return this.t3?sb?{returnValue:ya+this.t3.width/2>=oc.x+.5*oc.width,e3b:Qb}:{returnValue:ya-this.t3.width/2<=oc.x+.5*oc.width,e3b:Qb}:(u.ULS.sendTraceTag(537153735,0,50,"SheetTabBarControl.DraggedSheetCrossesSiblingSheet: Avoding JS crash and ending drag and drop due to client bounds of dragged sheet being null."),
this.YP(),{returnValue:!1,e3b:Qb})}Z1f(ya,sb){let Qb;Qb=sb?this.c2f:this.b2f;if(-1===this.PAc)this.PAc=ya,this.Lma=window.requestAnimationFrame(Qb);else{ya=Math.floor((ya-this.PAc)/1E3*300);var oc=this.YKb>this.tDb?1:-1;this.scrollLeft(Math.abs(this.Vk.scrollLeft-(sb?this.$qc+ya*oc:this.$qc-ya*oc))*(sb?-1:1));if(ya=this.u3e("ScrollStep"))this.GXd(sb,ya.x+ya.width/2),sb&&!this.JPd()||!sb&&!this.IPd()?this.Lma=window.requestAnimationFrame(Qb):(u.ULS.sendTraceTag(537153734,0,50,"SheetTabBarControl.ScrollStep: Ending scroll as dragged sheet reached first/last sheet."),
this.UWd())}}JPd(){const ya=this.YKb>this.tDb;return ya&&this.rna>=this.YKb||!ya&&this.rna<=this.YKb}IPd(){const ya=this.YKb>this.tDb;return ya&&this.rna<=this.tDb||!ya&&this.rna>=this.tDb}UWd(ya=!0){this.Vk&&(this.rna=this.Vk.scrollLeft);window.cancelAnimationFrame(this.Lma);this.Lma=0;this.PAc=-1;ya&&this.V_()}oRd(ya,sb){ya||u.ULS.sendTraceTag(537153733,0,50,`SheetTabBarControl.SetDraggedSheetTabButtonRect: DraggedSheetTabButtonRect set to null by ${sb}`);this.t3=ya}RQi(ya){return 2===ya?(this.h0(3),
!0):1===ya?(this.h0(0),!0):!1}RFf(ya){u.ULS.shipAssertTag(537153732,0,-1===this.LPa&&-1===this.KPa,"SheetTabBarControl.OnNavigateButtonDown: PeriodicNavigateSetTimeoutID and PeriodicNavigateSetIntervalID should be -1 on button down!");-1!==this.LPa&&(window.clearTimeout(this.LPa),this.LPa=-1);-1!==this.KPa&&(window.clearInterval(this.KPa),this.KPa=-1);this.h0(ya);this.LPa=window.setTimeout(()=>{this.ZNj(ya)},this.xKi);return!0}ZNj(ya){this.KPa=window.setInterval(()=>{this.h0(ya)},this.wKi)}SFf(){this.B2c();
return!this.jz||!this.hF}B2c(){window.clearTimeout(this.LPa);window.clearInterval(this.KPa);this.KPa=this.LPa=-1;return!0}TFf(ya,sb){const Qb=this.rAd[sb];Da.HelperMethods.VYd(this.wK[sb],Qb,Qb+n.a.Ffc,"mouseover"===ya.type||"focus"===ya.type)}ZWi(ya,sb){const Qb=this.lic(sb),oc=5===sb;if("mouseup"===ya.type){if(oc||4===sb)Qb||this.reorderSheets(null,oc,!1),this.YP()}else!this.jz&&this.hF?(Qb||this.fVd(this.A7e(oc?this.jK:this.gv),oc),this.h0(oc?2:1)):this.vm||this.TFf(ya,sb)}lic(ya){return!!ia.DOMElementExtensions.Bgd(this.wK[ya],
"a").title}BEc(ya){this.S0d(ya);this.V_()}S0d(ya){(ya=this.n3a(ya))&&ya.Dgb()}MPd(){var ya=this.$.va;if(ya.na&&(!ma.e(this.$)||ya.count))if(ya=this.Sia(ya.na),-1===ya)u.ULS.sendTraceTag(537153729,0,50,"SheetTabBarControl.ScrollToActiveIndex: shouldn't have an invisible, active sheet");else{var sb=this.VKa(ya);ya<this.gv?this.Zwc(ya):ya>this.gv&&!this.xtd(sb)&&this.scrollIntoView(ya)}}Y_j(){this.gv=0;this.jK=this.oh.length-1;let ya=!1;for(let sb=0;sb<this.oh.length;sb++){const Qb=this.tQ(sb);if(!Qb)break;
const oc=this.xtd(Qb.domElement);Qb.tabIndex=oc?0:-1;if(!ya&&oc)this.gv=sb,ya=!0;else if(ya&&!oc){this.jK=sb-1;break}}}Zwc(ya){this.$.va.count&&(this.oh.length||this.G6c(),this.U3f(this.VKa(Math.max(0,Math.min(ya,this.oh.length-1)))),this.V_())}scrollIntoView(ya){u.ULS.shipAssertTag(537153697,0,ya>=this.gv,"SheetTabBarControl.ScrollIntoView: sheetTabIndex must be greater than the first visible sheet tab index!");if(this.$.va.count){this.oh.length||this.G6c();var sb=this.VKa(Math.max(0,Math.min(ya,
this.oh.length-1))),Qb=this.VKa(this.gv);if(!this.xtd(sb)){sb=ia.DOMElementExtensions.getBoundingClientRect(sb);var oc=ia.DOMElementExtensions.getBoundingClientRect(this.deb);sb=this.isRtl?oc.x-sb.x:sb.x+sb.width-(oc.x+oc.width);for(oc=0;Qb&&oc<sb;){const kb=ia.DOMElementExtensions.getBoundingClientRect(Qb);oc+=kb.width;Qb=Qb.nextSibling}Qb?this.U3f(Qb):u.ULS.sendTraceTag(537153696,0,15,`SheetTabBarControl.ScrollIntoView: new firstVisible is null. firstVisibleSheetTabIndex = ${this.gv}, lastVisibleSheetTabIndex = ${this.jK}, scroll to index: ${ya}`)}this.V_()}}U3f(ya){const sb=
ia.DOMElementExtensions.getBoundingClientRect(this.Vk);ya=ia.DOMElementExtensions.getBoundingClientRect(ya);this.isRtl?this.scrollLeft(Math.floor(sb.x+sb.width-(ya.x+ya.width+.5))):this.scrollLeft(Math.ceil(sb.x-ya.x-.5))}scrollLeft(ya){(0>ya&&this.JPd()||0<ya&&this.IPd())&&u.ULS.sendTraceTag(537153695,0,50,"SheetTabBarControl.Scrollleft: attempt to scroll after the edge (overflow) in sheet tab bar.");const sb=this.Vk.scrollLeft;if(this.isRtl){if(y.a.iF||y.a.Cf){this.Vk.scrollLeft=this.rna=sb-ya;
return}if(y.a.uH){this.Vk.scrollLeft=this.rna=sb+ya;return}u.ULS.sendTraceTag(537153694,0,15,"SheetTabBarControl.ScrollLeft: unknown browser")}this.Vk.scrollLeft=this.rna=sb-ya}xtd(ya){ya=ia.DOMElementExtensions.getBoundingClientRect(ya);const sb=ia.DOMElementExtensions.getBoundingClientRect(this.deb);return ya&&sb?ya.x>=sb.x-1&&ya.x+ya.width<=sb.x+sb.width+1:(u.ULS.sendTraceTag(537153693,0,15,"SheetTabBarControl.IsTabCompletelyVisible: sheetTabRect is null or contentAreaRect is null"),!1)}nfh(){const ya=
this.dzc;if(R.n8f(this.$))this.vm?(x.a.Ja(this.nH),this.nH=new R(ya,this.$,this,!0)):(x.a.Ja(this.nH),this.nH=null);else if(!this.nH||this.vm)x.a.Ja(this.nH),Z.k(this.$.dg)?this.nH=new Sa(ya,this.$,this):this.nH=new R(ya,this.$,this)}yIe(ya,sb){var Qb=this.$.va;if(!this.$.isEditMode||!Qb.count)x.a.Ja(sb),sb=null;else if(!sb)if(Qb=this.vm?this.tTd:this.dzc,Z.k(this.$.dg))sb=new Sa(Qb,this.$,this);else switch(ya){case 0:sb=new R(Qb,this.$,this);break;case 1:sb=new wa(Qb,this.$,this);break;default:u.ULS.sendTraceTag(537153692,
0,10,"Unsupported SheetTabBarButtonType. Are you trying to create a new button? Make sure to update the SheetTabBarButtonType enum and add a case here to support creation of your new button.")}return sb}n6c(){this.rqi?(this.nH=this.yIe(0,this.nH),this.Vzb=this.yIe(1,this.Vzb)):this.nfh()}u3e(ya){const sb=ia.DOMElementExtensions.getBoundingClientRect(this.sM);sb||(u.ULS.sendTraceTag(537153689,0,50,`SheetTabBarControl.${ya}: GetBoundingClientRect returned null for the dragged sheet.`),this.YP());return sb}baf(ya,
sb){this.Nta.wSg(ya,sb);this.YP(!1);this.XRd(this.navigationButtonsDisabled);for(const Qb of this.JQj)Qb&&Qb.fS(this.navigationButtonsDisabled);for(const Qb of this.Vwe)Qb&&Qb.fS(this.operationButtonsDisabled)}static pmj(ya,sb,Qb,oc){ya<Qb?(sb>Qb&&Qb--,sb>oc&&oc--):ya>oc?(sb<Qb&&Qb++,sb<oc&&oc++):sb<Qb&&Qb++;return{rIh:Qb,Fyi:oc}}}Object(r.a)(ha,"SheetTabBarControl",L.a,[251,2,54]);class eb extends t.a{constructor(ya){super();this.$=ya;this.Db()}create(){const ya=this.$.Bb;if(z.a(this.$.ya,1))ab.PageLoadTrackingInfo.instance.zda(n.a.OAa,
["sheetTabBar"]);else{var sb=document.getElementById(ya+n.a.N7c);if(sb){m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&ab.PageLoadTrackingInfo.instance.AAa(n.a.OAa);var Qb=m.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&m.EwaSettings.isChangeGateEnabled("OfficeVSO:7308078_ReduceInnerHTMLUsageSheetTabBar")?e.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Xa):h.Task.Sa(null),oc=w.a.Jsd()?e.GetServiceTaskFactory.Oa(this.$.da,388,387,this.Xa):
h.Task.Sa(null);f.TaskExtensions.za(f.TaskExtensions.Fd([oc,Qb],this.$.la),()=>{this.nb(this.$.da.Aa(32)||new ha(this.$,sb,oc.result,Qb.result))},this.$.la,3)}else ab.PageLoadTrackingInfo.instance.zda(n.a.OAa,["sheetTabBar"])}}static ka(ya){ya.da.Ha(33,new eb(ya))}}Object(r.a)(eb,"SheetTabBarFactory",t.a,[]);a.d(F,"a",function(){return ta});const ta=()=>{c.a.Fa(ya=>{eb.ka(ya);k.ka(ya)})}},1179:function(r,F,a){var c=a(9),b=a(1);r=a(0);var e=a(226),f=a(15),d=a(31),h=a(5),l=a(12),k=a(22),t=a(13),n=a(257),
z=a(21),w=a(30);class m{constructor(ca){this.Ewc=ca||""}static get qPe(){return m.P8d||(m.P8d=new m(""))}static get xxd(){return m.Rde||(m.Rde=m.Sua(2).Ewc)}static H3a(ca){ca=w.a.yg(ca||"");return new m(ca)}static I3a(ca){return m.H3a(t.a.instance.ga(ca))}static Sua(ca){return new m(t.a.instance.Ta(ca))}static VZe(ca,...ka){return m.RKh(t.a.instance.ob(ca),...ka)}static RKh(ca,...ka){const Ca=ka.length,fb=Array(Ca);for(let yb=0;yb<Ca;yb++)fb[yb]=(ka[yb]||m.qPe).Ewc;return new m(String.format(ca,fb))}}
m.P8d=null;m.Rde=null;Object(r.a)(m,"SafeHtml",null,[739]);const u=(ca,ka)=>{ka&&(ca.append(ka),ca.append(m.xxd))};var y=a(52);class v{constructor(ca,ka,Ca,fb=null){this.dBf=(yb,mb)=>{this.$Rf(mb.Sd)};this.rrf=()=>{if(b.EwaSettings.isChangeGateEnabled("OfficeVSO:7536223_AddAriaLiveRegionTelemetry")&&!this.$.ea.Xb){var yb={};yb.a=this.$.ya.UserSessionId;yb.b=this.i6i;yb.c=this.DQg;yb.d=this.rUj;y.b().Xlc(60,yb)}};this.$=ca;this.htmlSanitizationHelper=fb;this.Uea=document.createElement("div");this.Uea.setAttribute(h.a.u2,
h.a.Uj);this.Uea.className=d.a.yad;ka.insertBefore(this.Uea,Ca);this.cga=document.createElement("div");this.cga.setAttribute(h.a.u2,h.a.Uj);this.cga.className=d.a.yad;ka.insertBefore(this.cga,this.Uea);this.pAg=t.a.instance.Ta(2);this.x2=document.createElement("div");this.x2.setAttribute(h.a.Cd,h.a.nsa);this.x2.setAttribute(h.a.psa,h.a.ppb);this.x2.className=d.a.yad;ka.insertBefore(this.x2,this.cga);this.Hle=this.H4d=this.Xge=0;this.register();this.$.da.Ha(211,this)}get Lxa(){return this.pAg}get isActive(){return!0}get activeCell(){return z.h(this.$).Pb(null)}get tsd(){return b.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&
b.EwaSettings.isChangeGateEnabled("OfficeVSO:7143612_ReduceInnerHTMLUsageForAriaLiveNotifier")}get i6i(){return this.Xge}get DQg(){return this.H4d}get rUj(){return this.Hle}get vhf(){return b.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConfirmationForFreewayScenarios",!1)}dispose(){this.$&&this.unregister();l.DOMElementExtensions.vf(this.x2);l.DOMElementExtensions.vf(this.Uea);l.DOMElementExtensions.vf(this.cga);this.cga=this.Uea=this.x2=this.$=null}setEnabled(ca){this.F4f(this.cga,
ca)}Ayj(){this.F4f(this.Uea,!0)}readText(ca){this.Jbb(m.H3a(ca),!0)}gQa(ca){this.Jbb(m.H3a(ca),!1)}cSf(ca,ka){if(1>ka||!ca)f.ULS.shipAssertTag(537153954,0,!1,"Skiping listbox description readout");else{var Ca=new Sys.StringBuilder;ca=String.format(t.a.instance.ob(34),ka,ca);u(Ca,ca);u(Ca,t.a.instance.ga(856));this.Jbb(m.H3a(Ca.toString()),!1)}}rdj(ca,ka,Ca){if(1>Ca||1>ka||ka>Ca||!ca)f.ULS.shipAssertTag(537153952,0,!1,"Skipping listbox item readout");else{var fb=new Sys.StringBuilder;u(fb,ca);fb.append(String.format(t.a.instance.ob(55),
ka,Ca));this.Jbb(m.H3a(fb.toString()),!1)}}$Rf(ca){ca=this.j2h(ca);this.Jbb(ca,!1)}pdj(ca){ca=this.i2h(ca);this.Jbb(ca,!1)}Jbb(ca,ka){if(ca=ca?ca.Ewc:null)ka=ka?this.cga:this.Uea,k.a.equals(ka.innerHTML,ca,!1)&&(ca+=m.xxd),this.$fg(ka),this.tsd&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.Rh(ka,ca):ka.innerHTML=ca}Ibb(ca,ka){this.x2.getAttribute(h.a.psa)!==ka&&this.x2.setAttribute(h.a.psa,ka);ca=ca?m.H3a(ca).Ewc:"";this.$fg(this.x2);this.tsd&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.Rh(this.x2,
ca):this.x2.innerHTML=ca}sdj(ca,ka,Ca,fb){const yb=t.a.instance.ob(54);f.ULS.shipAssertTag(537153949,0,!(void 0===ca||null===ca));f.ULS.shipAssertTag(537153948,0,!(void 0===ka||null===ka));f.ULS.shipAssertTag(537153947,0,!(void 0===Ca||null===Ca));f.ULS.shipAssertTag(537153946,0,!(void 0===fb||null===fb));f.ULS.shipAssertTag(537153945,0,!(void 0===yb||null===yb));ca=String.format(yb,ca||"",ka||"",Ca||"",fb||"");this.Ibb(ca,h.a.DGa)}MZj(ca){var ka=this.cga.style;ca?(ca=n.a.w2b(ca.cell,ka),ka=ca.EB,
ka.top=ka.left=ka.bottom=ka.right=null,ca.s2()):ka.cssText=""}j2h(ca){switch(ca.command){case -1985798686:return m.I3a(12);case -911352779:return m.I3a(11);case 237279923:return m.I3a(13);case -1502853784:return m.Sua(81);case -111689794:return m.Sua(78);case -287251124:return this.Fid(1332,ka=>ka.bold);case -1925065947:return this.Fid(1333,ka=>ka.italic);case 1764140053:return this.Fid(1334,ka=>ka.underline)}if(this.vhf)switch(ca.command){case 368460465:return this.l2h(this.$.na.hasAutoFilter);case 1941920197:return m.I3a(835);
case 1051390410:return m.Sua(589);case 1542466017:return m.Sua(591);case -706918724:return m.Sua(590);case 369708605:return m.Sua(592)}return null}i2h(ca){if(!this.vhf)return null;switch(ca.command){case -1215659745:return m.Sua(523)}return null}register(){f.ULS.shipAssertTag(537153944,0,!!this.$,"Can't register to ewaControl's events");this.$&&(f.ULS.shipAssertTag(537153943,0,!!this.$.Ia,"Can't register to CommandHandlerManager's event"),this.$.Ia&&this.$.Ia.YFa(this.dBf),this.$.ea&&b.EwaSettings.isChangeGateEnabled("OfficeVSO:7536223_AddAriaLiveRegionTelemetry")&&
this.$.ea.oA(this.rrf))}unregister(){this.$&&(this.$.Ia.Vza(this.dBf),b.EwaSettings.isChangeGateEnabled("OfficeVSO:7536223_AddAriaLiveRegionTelemetry")&&this.$.ea.uB(this.rrf))}F4f(ca,ka){const Ca=ca===this.Uea;ka?(ca.setAttribute(h.a.psa,h.a.DGa),Ca&&ca.setAttribute(h.a.Cd,h.a.nsa),ca.setAttribute(h.a.u2,h.a.rq),ca.removeAttribute(h.a.u2),this.tsd&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.Rh(ca,ca.innerHTML+" "):ca.innerHTML+=" "):(ca.removeAttribute(h.a.psa),Ca&&ca.removeAttribute(h.a.Cd),
ca.setAttribute(h.a.u2,h.a.Uj))}Fid(ca,ka){const Ca=this.activeCell;if(!Ca)return null;const fb=b.EwaSettings.isChangeGateEnabled("OfficeVSO:7150857_FlipRibbonCommandStateAriaDescription"),yb=[7,8];ka=ka(Ca)?!0:!1;return m.VZe(fb?yb[+ka]:yb[+!ka],m.I3a(ca))}$fg(ca){b.EwaSettings.isChangeGateEnabled("OfficeVSO:7536223_AddAriaLiveRegionTelemetry")&&("polite"===ca.vTg&&this.Xge++,"alert"===ca.role&&this.H4d++,this.Hle++)}l2h(ca){if(!this.activeCell)return null;const ka=b.EwaSettings.isChangeGateEnabled("OfficeVSO:7150857_FlipRibbonCommandStateAriaDescription"),
Ca=[7,8];ca=ca?!0:!1;return m.VZe(ka?Ca[+ca]:Ca[+!ca],m.I3a(1969))}}Object(r.a)(v,"AriaLiveNotifier",null,[708,683,2]);var C=a(50),x=a(37);class B extends e.a{constructor(ca){super();this.$=ca;this.Db()}create(){if(b.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&b.EwaSettings.isChangeGateEnabled("OfficeVSO:7143612_ReduceInnerHTMLUsageForAriaLiveNotifier")){const ca=C.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Xa);x.TaskExtensions.za(x.TaskExtensions.Fd([ca],this.$.la),
()=>{this.nb(this.$.da.Aa(211)||new v(this.$,this.$.eu,this.$.rf,ca.result))},this.la,3)}else this.nb(this.$.da.Aa(211)||new v(this.$,this.$.eu,this.$.rf))}static ka(ca){ca.da.Ha(212,new B(ca))}}Object(r.a)(B,"AriaLiveNotifierFactory",e.a,[]);var H=a(27),I=a(217),U=a(132),S=a(64);class G{constructor(ca,ka){this.U_=this.hW=this.NN=null;this.eja=ka;this.ngh(ca);this.j8i();b.EwaSettings.wb()&&ca.da.Ha(244,this)}get isActive(){return!!this.eja&&document.activeElement===this.eja}readText(ca){ca=String.format(t.a.instance.ob(30),
ca);this.NN.setAttribute(h.a.Vu,ca);this.hW.setAttribute(h.a.Vu,ca);this.tQj()}dispose(){this.U_&&this.U_.parentNode&&this.U_.parentNode.removeChild(this.U_);this.hW=this.NN=this.U_=this.eja=null}ngh(ca){var ka=ca.Bb+"readoutElementWrapper";const Ca=ca.Bb+"readoutElement1",fb=ca.Bb+"readoutElement2";this.U_=document.getElementById(ka);this.U_||(this.U_=document.createElement(I.a.div),this.U_.id=ka,this.NN=document.createElement(I.a.label),this.NN.id=Ca,this.NN.setAttribute(U.a.contentEditable,S.a.MQb),
this.NN.setAttribute(h.a.Cd,h.a.QZa),this.hW=document.createElement(I.a.label),this.hW.id=fb,this.hW.setAttribute(U.a.contentEditable,S.a.MQb),this.hW.setAttribute(h.a.Cd,h.a.QZa),this.NN.style.width="0px",this.NN.style.height="0px",this.hW.style.width="0px",this.hW.style.height="0px",this.NN.tabIndex=-1,this.hW.tabIndex=-1,this.U_.appendChild(this.NN),this.U_.appendChild(this.hW),ca=ca.Bb+h.a.f5b,ka=document.getElementById(ca),f.ULS.shipAssertTag(537153942,3,!!ka,`FocusBasedReadout.CreateReadoutElementsIfNeeded: expected to find contentAreaDiv with id: ${ca}`),
ka&&ka.appendChild(this.U_))}j8i(){this.eja&&this.NN&&this.hW&&(this.eja.setAttribute(h.a.jY,this.NN.id),this.eja.setAttribute(h.a.p1b,`${this.NN.id} ${this.hW.id}`))}tQj(){if(this.isActive){let ca="";l.DOMElementExtensions.hasAttribute(this.eja,h.a.jY)&&(ca=this.eja.getAttribute(h.a.jY).toString());this.eja.setAttribute(h.a.jY,ca===this.NN.id?this.hW.id:this.NN.id)}else f.ULS.shipAssertTag(537153941,0,!1,"FocusBasedReadout.SwitchVirtualFocus: called when is not active.")}static X6a(){if(null==G.Mvb)if(b.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ActiveDescendantGridReadout",
!1)&&!H.a.ZMa)G.Mvb=!0,f.ULS.sendTraceTag(537153940,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: ActiveDescendantGridReadout Flight is enabled");else if(G.Mvb=!1,H.a.uH||H.a.Cf)G.Mvb=!0,f.ULS.sendTraceTag(537153939,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: The FocusBasedCellReadout BRS is on");return G.Mvb}static ka(ca){G.X6a()&&ca.da.Ha(244,new G(ca,z.h(ca).mc.textBox.Je))}}G.Mvb=null;Object(r.a)(G,"FocusBasedReadout",null,[683,2]);class D extends e.a{constructor(ca){super();
this.$=ca;this.Db()}create(){G.X6a()?z.h(this.$).mc.textBox.uP(()=>{const ca=this.$.da.Aa(244)||new G(this.$,z.h(this.$).mc.textBox.Je);this.nb(ca)}):this.nb(null)}static ka(ca){ca.da.Ha(315,new D(ca))}}Object(r.a)(D,"FocusBasedReadoutFactory",e.a,[]);var E=a(7),N=a(89),M=a(84);const L=ca=>{switch(ca){case 1:return 1456;case 2:return 1457;case 3:return 1458;case 4:return 1459;case 5:return 1460;case 6:return 1461;case 7:return 1462;case 8:return 1463;case 9:return 1464;case 10:return 1465;case 11:return 1466;
case 12:return 1467;case 13:return 1468;case 14:return 1469;case 15:return 1470;case 16:return 1471;case 17:return 1472;case 18:return 1473;case 19:return 1474;case 20:return 1475;case 21:return 1476;case 22:return 1479;case 23:return 1477;case 24:return 1478;case 25:return 1480;case 26:return 1481;case 27:return 1482;case 28:return 1483;default:return 1484}};var aa=a(24),V=a(41),P=a(216),ba=a(48),Y=a(44),Z=a(124);class ea{static get gcj(){return ea.Che||(ea.Che=RegExp("([A-Z]+)","g"))}static get fcj(){return ea.Bhe||
(ea.Bhe=RegExp("([A-Z])","g"))}static get W3g(){return ea.k6d||(ea.k6d=RegExp("^\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+\\$?[0-9]+:\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+:\\$?[A-Z]+$|^\\$?[0-9]+:\\$?[0-9]+$"))}static qid(ca){return ea.r6e(ca.toString())}static r6e(ca){return ea.W3g.test(ca)?ca.replace(ea.gcj,"$1 ").replace(ea.fcj,' "$1"').trim():ca}static Mmj(ca){const ka=ca.lastIndexOf("!");return ca.substring(0,-1<ka?ka+1:0)+ea.r6e(ca.substring(-1<ka?ka+1:0,ca.length))}}ea.Che=null;ea.Bhe=null;ea.k6d=null;Object(r.a)(ea,
"RangeAriaExtensions",null,[]);class ra{constructor(){this.activeItemName=null;this.gmf=!1;this.tableName=null;this.D0a=0;this.GBc=!1}}Object(r.a)(ra,"SelectionReadoutState",null,[]);a(65);var O=a(68);class da{constructor(ca,ka,Ca,fb,yb){this.gridReadoutNotifier=null;this.Cbb=!1;this.Fsa=this.Bpb=null;this.hda=()=>{b.EwaSettings.isChangeGateEnabled("OfficeVSO:5963256_DoNotReadActiveItemIfDisposed")&&!this.$?f.ULS.sendTraceTag(526235470,0,15,"calling readActiveItemDescription after dispose, ignoring."):
z.h(this.$).fb||this.v1b.Yp()};this.KNi=()=>{if(!z.h(this.$).ha.Ra.Srd){var mb,nb=({activeCell:mb}=this.ZNh()).returnValue;this.readText(nb,mb)}};this.np=()=>{const mb=this.activeCell;this.readText("Editing",mb);b.EwaSettings.isChangeGateEnabled("OfficeVSO:5190952_removePhoneticErrorDialog2")||mb&&mb.Mec&&!z.h(this.$).Iaf||this.v1b.cancel()};this.Uc=()=>{b.EwaSettings.isChangeGateEnabled("OfficeVSO:6053639_DoNotHandleSelectionChangedIfDisposed")&&!this.$?f.ULS.sendTraceTag(525366409,0,15,"calling onSelectionChanged after dispose, ignoring."):
(this.hda(),this.Cbb&&z.h(this.$).inRangePicker&&1===O.a.zb&&(null===this.Bpb?this.Bpb=ba.a.instance.create(this.LJd,da.TVc,"readSelectedRanges"):this.Bpb.Yp()))};this.$=ka;this.ariaLiveNotifier=ca;this.sparklineManager=fb;this.tableManager=Ca;this.tD=new ra;this.X6a=G.X6a();this.Cbb=b.EwaSettings.isChangeGateEnabled("OfficeVSO:5888244_FixCellReadoutInRangePicking");this.X6a&&(b.EwaSettings.wb()?this.gridReadoutNotifier=yb:this.gridReadoutNotifier=ka.da.Aa(244),f.ULS.shipAssertTag(537153937,0,!!this.gridReadoutNotifier,
"SelectionReadoutHandler.ctor: gridReadoutNotifier shouldn't be null"),da.TVc=b.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.IncreaseActiveCellCallbackDelayForBraille",1200));this.v1b=ba.a.instance.create(this.KNi,da.TVc,Y.a.dvj,!1);this.Aj()}get activeCell(){return z.h(this.$).Pb(null)}dispose(){this.$&&this.Sj();N.a.Ja(this.v1b);this.sparklineManager=this.$=this.v1b=null}Z0e(ca,ka,Ca=!0){if(b.EwaSettings.isChangeGateEnabled("OfficeVSO:7449834_NoReadoutWhenFindAndReplaceDialogOpen")&&this.$.qb.uv&&
null!==this.$.qb.$g&&null!==this.$.qb.$g.kc&&"FindAndReplaceDialog"===this.$.qb.$g.kc||!ca)return"";var fb=this.$.da;const yb=new Sys.StringBuilder;this.kSg(yb,ca,ka);if(b.EwaSettings.isChangeGateEnabled("OfficeVSO:4124702_ColumnHeaderReadout")){var mb=this.tableManager.Kja(ca.range);(null===mb||void 0===mb?0:mb.CUd)&&this.Xte(yb,mb);mb=this.tableManager.Np(ca.range);(null===mb||void 0===mb?0:mb.dka)&&this.Xte(yb,mb)}mb=ca.bba?this.T3e(ca):ca.text;u(yb,mb);mb=this.$.activeItemName;this.tD.activeItemName!==
mb&&(u(yb,mb),this.tD.activeItemName=mb);mb=1===ka.length?V.K(ka).isSingle?"":t.a.instance.ga(852):String.format(t.a.instance.ob(31),ka.length);u(yb,mb);for(var nb of ka)u(yb,ea.qid(nb)),1===ka.length&&da.Wvi(nb)&&(mb=z.h(this.$).Ca.Ur(nb.bottomRight),void 0!==mb&&null!==mb&&mb.text&&(mb=mb.bba?this.S3e(mb,mb.text):mb.text,u(yb,mb)));nb=ca.cell;nb=this.A_h(nb.srj,nb.S6g);u(yb,nb);this.URg(yb,ca);Ca&&(ca.A7a?u(yb,t.a.instance.ga(840)):ca.bxa&&u(yb,t.a.instance.ga(841)));if(ca.hasAutoFilter||ca.p4)this.lSg(yb,
ca.hasAutoFilter?ca.cell.autoFilterType:ca.cell.G5i),Ca&&u(yb,t.a.instance.ga(843));P.c(this.$,ca.range)&&u(yb,t.a.instance.ga(847));this.RRg(yb,ca);Ca=(Ca=fb.Aa(14))?Ca.bPh():"";u(yb,Ca);ca.RA&&(Ca=z.h(this.$).Ca.Ur(ca.range),Ca=!!Ca&&Ca.hasIgnorableError,da.DEj(ca)?da.SRg(yb,ca):b.EwaSettings.isChangeGateEnabled("OfficeVSO:3286994_NarratorForFormulaErrors")&&Ca?u(yb,t.a.instance.ga(845)):u(yb,t.a.instance.ga(844)));ca.MM&&(u(yb,t.a.instance.ga(846)),ca.Cyb&&u(yb,String.format(t.a.instance.ob(16),
ca.qjh)),u(yb,ca.iconName));ca.hasRichValueIcon&&(nb=this.$.da.Aa(271),Ca="",nb&&ca.cell.sqf&&(nb=nb.nU(ca.cell.sqf))&&nb.DomainId.Id!==da.P6j&&(Ca=nb.Name),ca.cell.Sli?(u(yb,String.format(t.a.instance.ob(187),Ca)),u(yb,t.a.instance.ga(1811))):(u(yb,String.format(t.a.instance.ob(185),Ca)),u(yb,t.a.instance.ga(1810))));this.pbi(ca)&&u(yb,da.ZVh(ca));(fb=fb.Aa(231))&&u(yb,fb.e4e(ka,!0));1===ka.length&&ka[0].isSingle&&da.CEj(ca,ka[0],this.$)&&(ka=this.$.da.Aa(271))&&u(yb,ka.mPh());ca.pPb&&ca.qPb&&u(yb,
ca.qPb);(ka=ca.cell.I2g)&&u(yb,ka);ca.MMa&&ca.XHb&&(ca=ca.pGd)&&(u(yb,t.a.instance.ga(1984)),u(yb,ca));return yb.toString()}lze(ca){this.Fsa=this.tD;this.tD=Object(E.a)(new ra,{activeItemName:this.Fsa.activeItemName,GBc:ca?this.Fsa.GBc:!1,tableName:ca?this.Fsa.tableName:"",D0a:ca?this.Fsa.D0a:-1})}WZf(){this.Fsa&&(this.tD=this.Fsa,this.Fsa=null)}A_h(ca,ka){return 2===ca||2===ka?t.a.instance.ga(874):1===ca||1===ka?t.a.instance.ga(875):""}T3e(ca){return this.S3e(ca.cell,ca.text)}kSg(ca,ka,Ca){if(Ca&&
1===Ca.length&&Ca[0].isSingle){Ca="";var fb=this.tableManager.Kja(ka.range);if(fb){Ca=fb.pivotTableName;this.TYc(ca,Ca);var yb=fb.Nhc?t.a.instance.ga(834):"";b.EwaSettings.isChangeGateEnabled("OfficeVSO:6154754_NarratorReadoutForPivotTableAltText")&&(yb+=(fb.altText?fb.altText+" . ":"")+(fb.altTextSummary?fb.altTextSummary:""));this.Zte(ca,!0,Ca,yb);u(ca,this.tableManager.Hti(fb,ka.range)?t.a.instance.ga(837):"");u(ca,this.tableManager.nni(fb,ka.range)?t.a.instance.ga(836):"")}else if(fb=this.tableManager.Np(ka.range)){Ca=
(yb=z.h(this.$).tb.Dh(ka.range))?yb.name:"";this.TYc(ca,Ca);let mb="";yb&&(mb=(yb.sTa?yb.sTa+" . ":"")+(yb.tTa?yb.tTa:""));this.Zte(ca,!1,Ca,mb);u(ca,this.tableManager.ejf(fb,ka.range)?t.a.instance.ga(836):"")}else this.TYc(ca,Ca),this.tD.tableName="",this.tD.D0a=-1}}TYc(ca,ka){ka!==this.tD.tableName&&this.tD.tableName&&(ca.append(t.a.instance.ga(this.tD.GBc?833:832)),u(ca," "+this.tD.tableName))}Zte(ca,ka,Ca,fb){Ca!==this.tD.tableName&&(ca.append(t.a.instance.ga(ka?831:830)),u(ca," "+Ca),u(ca,fb),
this.tD.tableName=Ca,this.tD.GBc=ka,this.tD.D0a=-1)}Xte(ca,ka){const Ca=z.h(this.$).ha.qa.activeCell;if(Ca.top!==ka.top&&Ca.left!==this.tD.D0a){ca.append(t.a.instance.ga(836));ka=new aa.Range(ka.top,Ca.left,ka.top,Ca.left,!0,!0);u(ca,ea.qid(ka));if(ka=z.h(this.$).Pb(ka))ka=ka.bba?this.T3e(ka):ka.text,u(ca,ka);this.tD.D0a=Ca.left}}S3e(ca,ka){const Ca=ca.O5a;return ca.Vva?String.format(t.a.instance.ob(14),ka,Ca):String.format(t.a.instance.ob(13),ka,ea.Mmj(Ca))}Aj(){f.ULS.shipAssertTag(537153930,0,!!this.$,
"Can't register to ewaControl's events");if(this.$){var ca=z.h(this.$);f.ULS.shipAssertTag(537153929,0,!!ca,"Can't register to grid's events");ca&&(ca.Vb.xl(this.np),ca.Ca.Tv(this.hda),ca.jE(this.hda),this.Cbb&&ca.Vb.Km(this.$f.bind(this)),ca=ca.ha,f.ULS.shipAssertTag(537153928,0,!!ca,"Can't register to selectionManager's events"),ca&&(ca.eC(this.Uc),ca.yG(this.hda),ca.Ra.o2(this.hda),this.Cbb&&(this.LJd=this.LJd.bind(this))))}}Sj(){if(this.$){var ca=z.h(this.$);ca&&(ca.Vb.nl(this.np),ca.Ca.Nw(this.hda),
ca.AF(this.hda),this.Cbb&&ca.Vb.$l(this.$f),ca=ca.ha)&&(ca.vB(this.hda),ca.JK(this.hda),ca.Ra.ana(this.hda))}}readText(ca,ka){this.X6a&&this.gridReadoutNotifier&&this.gridReadoutNotifier.isActive?this.gridReadoutNotifier.readText(ca):(b.EwaSettings.isChangeGateEnabled("OfficeVSO:5033038_Embed_Mode_Grid_Narrator_Fix")&&this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(ca),this.Cbb&&!ka||this.ariaLiveNotifier.MZj(ka))}$f(){this.Bpb&&this.Bpb.cancel()}LJd(){this.readText(this.X2h())}X2h(){let ca=
"";z.h(this.$).ha.rangePicker.DK.forEach(()=>{ca+=void 0});return ca+=" selected"}ZNh(){let ca;ca=null;var ka=z.h(this.$).ha;if(1!==ka.Ke&&!ka.Ra.dc)return f.ULS.sendTraceTag(537153927,0,15,`selectionManager.CommandSelectionMode=${ka.Ke} and selectionManager.SelectedFloatingObjectControl is null`),{returnValue:"",activeCell:ca};switch(ka.Ke){case 2:return{returnValue:this.dRh(ka),activeCell:ca};case 64:var Ca=ka.Ra.dc.floatingObject,fb="";if(ka=ka.Ra.dc.As||ka.Ra.dc.Hd)fb=(fb=ka.firstChild)?l.DOMElementExtensions.getTextContent(fb):
"";return{returnValue:String.format(t.a.instance.ob(53),da.pbc(Ca.altText,Ca.altTextDescription,Ca.name),fb,Ca.altTextDescription),activeCell:ca};case 4:return{returnValue:da.cRg(ka.Ra.dc.floatingObject),activeCell:ca};case 512:return{returnValue:Z.a.y2e(ka.Ra.dc.floatingObject.A9c),activeCell:ca};case 8:return Ca=(Ca=ka.Ra.dc.floatingObject)?Ca.name:"",{returnValue:String.format(t.a.instance.ob(51),Ca),activeCell:ca};case 1:return ca=this.activeCell,{returnValue:this.Z0e(ca,ka.qa.selectedRanges),
activeCell:ca}}return{returnValue:"",activeCell:ca}}dRh(ca){const ka=new Sys.StringBuilder;ka.append(da.n3g(ca));const Ca=this.$.da.Aa(231);Ca&&u(ka,Ca.e4e(ca.Ra.dc.floatingObject,!1));return ka.toString()}pbi(ca){ca=ca.dhf();let ka=!1;this.tD.gmf!==ca&&(this.tD.gmf=ca,ka=!0);return ka}URg(ca,ka){if(ka.Myb)if(ka=this.sparklineManager.U3h(ka)){var Ca=t.a.instance,fb=Ca.ga;a:switch(ka.type){case 0:var yb=827;break a;case 1:yb=828;break a;default:yb=829}Ca=fb.call(Ca,yb);u(ca,String.format(t.a.instance.ob(25),
Ca));ka=String.format(t.a.instance.ob(24),ea.qid(ka.NMj));u(ca,ka)}else f.ULS.sendTraceTag(537153925,0,15,"No sparkline range was found on a cell with sparkline."),u(ca,String.format(t.a.instance.ob(25),""))}lSg(ca,ka){switch(ka){case 1:case 11:u(ca,t.a.instance.ga(848));break;case 6:u(ca,t.a.instance.ga(848));u(ca,t.a.instance.ga(850));break;case 7:u(ca,t.a.instance.ga(848));u(ca,t.a.instance.ga(851));break;case 2:u(ca,t.a.instance.ga(849));u(ca,t.a.instance.ga(850));break;case 3:u(ca,t.a.instance.ga(849));
u(ca,t.a.instance.ga(851));break;default:u(ca,t.a.instance.ga(849))}}RRg(ca,ka){var Ca;const fb=this.$.da.Aa(65);ka=fb?fb.nKa(ka.range):null;let yb="";const mb=Object(M.a)(378,ka);if(ka)yb=!ka.e7a&&mb&&mb.vvi?String.format(t.a.instance.ob(29),mb.kRj):String.format(t.a.instance.ob(23),ka.author);else if(null===(Ca=null===fb||void 0===fb?void 0:fb.Rm)||void 0===Ca?0:Ca.WE)yb=String.format(t.a.instance.ob(28),fb.Rm.nN.author);u(ca,yb)}static cRg(ca){return String.format(t.a.instance.ob(52),da.pbc(ca.altText,
ca.altTextDescription,ca.name),ca.altTextDescription)}static ZVh(ca){return t.a.instance.ga(ca.dhf()?838:839)}static pbc(ca,ka,Ca){return ca||ka?ca:Ca}static n3g(ca){var ka=ca.Ra.dc;ca=ka.floatingObject;const Ca=ca.Wc,fb=Ca.ChartTitle,yb=ca.altText,mb=ca.altTextDescription,nb=!!(Ca.Attributes&4);return(ka=ka.getSelectionDescription())?ka:Ca.DataRangeForDisplay?String.format(t.a.instance.ob(nb?49:47),da.pbc(yb,mb,ca.name),mb,fb,t.a.instance.ga(L(Ca.ChartCategory)),Ca.DataRangeForDisplay):String.format(t.a.instance.ob(nb?
50:48),da.pbc(yb,mb,ca.name),mb,fb,t.a.instance.ga(L(Ca.ChartCategory)))}static DEj(ca){return b.EwaSettings.ra(101)&&(ca.Q6a||ca.Mhc)}static SRg(ca,ka){if(!ka.goa)f.ULS.shipAssertTag(537153924,0,!1,"SelectionReadoutHandler.AppendAriaDynamicArrayFormulaDescription: This method should only be called with a valid dynamic array range.");else if(ka.Q6a)ka=ka.goa.topLeft.toString(),u(ca,String.format(t.a.instance.ob(26),ka));else if(ka.Mhc){var Ca=ka.goa.eS();ka=(Ca.LastColumn-Ca.FirstColumn+1).toString();
Ca=(Ca.LastRow-Ca.FirstRow+1).toString();u(ca,String.format(t.a.instance.ob(27),ka,Ca))}}static CEj(ca,ka,Ca){return ca.RA||!b.EwaSettings.ra(131)?!1:(ca=Ca.da.Aa(271))?ca.mhc(ka):!1}static Wvi(ca){return ca.top===ca.bottom&&ca.left+1===ca.right||ca.top+1===ca.bottom&&ca.left===ca.right}}da.P6j=268435712;da.TVc=500;Object(r.a)(da,"SelectionReadoutHandler",null,[707,2]);var xa=a(55),ia=a(712);class Ma extends e.a{constructor(ca){super();this.$=ca;this.Db()}create(){const ca=this.$.da,ka=C.GetServiceTaskFactory.Oa(ca,
211,212,this.Xa),Ca=C.GetServiceTaskFactory.Oa(ca,66,134,this.Xa),fb=C.GetServiceTaskFactory.Oa(ca,240,239,this.Xa);let yb=xa.Task.Sa(null);b.EwaSettings.wb()&&(yb=C.GetServiceTaskFactory.Oa(ca,244,315,this.Xa));x.TaskExtensions.za(x.TaskExtensions.Fd([ka,Ca,fb,yb],this.la),()=>{const mb=Object(ia.a)(this.$.da,226,()=>new da(ka.result,this.$,Ca.result,fb.result,yb.result));this.nb(mb)},this.$.la,3)}static ka(ca){ca.da.Ha(227,new Ma(ca))}}Object(r.a)(Ma,"SelectionReadoutHandlerFactory",e.a,[]);class Ta{constructor(ca,
ka){this.$=ka;this.ariaLiveNotifier=ca}kSf(){const ca=this.dPh();this.ariaLiveNotifier.Ibb(ca,h.a.ppb)}dPh(){const ca=new Sys.StringBuilder;this.$.workbookContext&&u(ca,this.$.workbookContext.WorkbookFileName);u(ca,t.a.instance.ga(854));u(ca,this.fPh());u(ca,this.ePh());u(ca,t.a.instance.ga(855));return ca.toString()}fPh(){return this.$.isEditMode?t.a.instance.ga(859):t.a.instance.ga(860)}ePh(){var ca=this.$5j();const ka=this.$.va.na;ca=1!==ca?String.format(t.a.instance.ob(32),ca):t.a.instance.ga(853);
ca=new Sys.StringBuilder(ca);ka&&ka.sheetName&&(ca.append(m.xxd),ca.append(String.format(t.a.instance.ob(33),ka.sheetName)));return ca.toString()}$5j(){let ca=0;for(const ka of this.$.va.items)ka.visible&&ca++;return ca}}Object(r.a)(Ta,"WorkbookReadout",null,[]);class Da{constructor(ca,ka,Ca){this.OEf=()=>{this.I2d.kSf();this.ariaLiveNotifier.setEnabled(!0)};this.$=ka;this.ariaLiveNotifier=ca;this.I2d=new Ta(ca,ka);this.Eac=Ca.Uhd(this.$);this.Eac.wNg(this.OEf)}dispose(){this.Eac&&this.Eac.wkj(this.OEf);
this.Eac=this.ariaLiveNotifier=this.$=null}}Object(r.a)(Da,"EmbeddedWorkbookReadoutHandler",null,[2]);class fa{constructor(ca,ka){this.JV=()=>{this.Ed||this.xte()};this.Ed=!1;this.KY=ka.HY;this.ariaLiveNotifier=ca;this.I2d=new Ta(ca,ka);this.KY&&this.KY.IQ?this.xte():this.Aj()}dispose(){this.Sj();this.ariaLiveNotifier=this.KY=null;this.Ed=!0}Aj(){if(this.KY){this.KY.Uu(this.JV);this.KY.Ca.Tv(this.JV);this.KY.jE(this.JV);var ca=Object(M.a)(220,this.KY);ca&&(ca.Vb.xl(this.JV),ca.ha.eC(this.JV),ca.ha.yG(this.JV),
ca.ha.Ra.o2(this.JV))}else f.ULS.sendTraceTag(537153923,0,15,"WorkbookReadoutHandler.RegisterEvents: Can't register to view events")}Sj(){if(this.KY){this.KY.Ca.Nw(this.JV);this.KY.AF(this.JV);const ca=Object(M.a)(220,this.KY);ca&&(ca.Vb.nl(this.JV),ca.ha.vB(this.JV),ca.ha.JK(this.JV),ca.ha.Ra.ana(this.JV))}}xte(){this.I2d.kSf();this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.Ayj();this.dispose()}}Object(r.a)(fa,"WorkbookReadoutHandler",null,[2]);class ua extends e.a{constructor(ca){super();
this.$=ca;this.Db()}create(){const ca=C.GetServiceTaskFactory.Oa(this.$.da,211,212,this.Xa);if(this.$.fK){const ka=C.GetServiceTaskFactory.Oa(this.$.da,12,477,this.Xa);x.TaskExtensions.za(x.TaskExtensions.Fd([ca,ka],this.$.la),()=>{const Ca=Object(ia.a)(this.$.da,228,()=>new Da(ca.result,this.$,ka.result));this.nb(Ca)},this.$.la,3)}else x.TaskExtensions.za(ca,ka=>{const Ca=Object(ia.a)(this.$.da,228,()=>new fa(ka.result,this.$));this.nb(Ca)},this.$.la,3)}static ka(ca){ca.da.Ha(229,new ua(ca))}}Object(r.a)(ua,
"WorkbookReadoutHandlerFactory",e.a,[]);a.d(F,"a",function(){return Fa});const Fa=()=>{c.a.Fa(ca=>{B.ka(ca);b.EwaSettings.wb()?D.ka(ca):G.ka(ca);Ma.ka(ca);ua.ka(ca)})}},1182:function(r,F,a){var c=a(9);r=a(0);var b=a(709),e=a(50),f=a(37),d=a(15),h=a(4),l=a(31),k=a(5),t=a(24),n=a(68),z=a(59);class w{constructor(qa,La){this.autoFilterOptions=null;this.sortType=0;this.autoFilterOptions=qa;this.sortType=La}JU(){return this.autoFilterOptions}}Object(r.a)(w,"MacroRecorderRangeColumnSortedOrFilteredPayload",
null,[162]);class m{constructor(qa){this.autoFilterOptions=null;this.autoFilterOptions=qa}JU(){return this.autoFilterOptions}}Object(r.a)(m,"MacroRecorderRangeItemFilteredPayload",null,[162]);var u=a(1152),y=a(41),v=a(376),C=a(193),x=a(60),B=a(167),H=a(216),I=a(48),U=a(44),S=a(12),G=a(249),D=a(1),E=a(189),N=a(22),M=a(282),L=a(21);class aa{constructor(qa,La){this.tableRange=this.tableRanges=null;this.styleIndex=0;this.tableRanges=qa;this.tableRange=y.l(qa.Ranges[0],qa.SheetName);this.styleIndex=La}}
Object(r.a)(aa,"MacroRecorderTableStyleAppliedPayload",null,[162]);class V extends aa{constructor(qa,La,Yb,mc){super(qa,Yb);this.isCreation=this.hasHeaders=!1;this.hasHeaders=La;this.isCreation=mc}}Object(r.a)(V,"MacroRecorderRangeFormatedAsTablePayload",aa,[]);class P{constructor(qa,La,Yb){this.description=this.title=this.tableRange=null;this.tableRange=qa;this.title=La;this.description=Yb}Np(){return this.tableRange}getTitle(){return this.title}getDescription(){return this.description}}Object(r.a)(P,
"MacroRecorderTableAltTextEditedPayload",null,[162]);class ba{constructor(qa,La){this.newName=this.oldName=null;this.oldName=qa;this.newName=La}}Object(r.a)(ba,"MacroRecorderTableRenamedPayload",null,[162]);class Y{constructor(qa){this.originalRange=null;this.originalRange=qa}}Object(r.a)(Y,"MacroRecorderTableResizedPayload",null,[162]);class Z{constructor(qa,La,Yb){this.isPivotTable=!1;this.tableRange=null;this.optionType=0;this.tableRange=qa;this.optionType=La;this.isPivotTable=Yb}}Object(r.a)(Z,
"MacroRecorderTableStyleOptionToggledPayload",null,[162]);var ea=a(29),ra=a(45);class O{constructor(qa){this.tableName=null;this.tableName=qa}}Object(r.a)(O,"MacroRecorderTableConvertedToRangePayload",null,[162]);var da=a(821);class xa{constructor(qa,La,Yb){this.isQueryTable=!1;this.sharedSheetRange=La;this.$=qa;this.Sh=this.$.Jb.zg("UserAction","ConvertToRangeManager");this.tableName=Yb}Hab(){this.Sh.start();const qa=this.$.oa.xa.Wb();return da.i(this.$.oa.xa,this.sharedSheetRange,La=>{this.showDialog(La)},
null,null,null,qa)}showDialog(qa){d.ULS.sendTraceTag(537151193,0,50,`ConvertToRangeManager.ShowDialog: Time taken to show Get IsRangeQueryTable is ${this.Sh.Bc} milliseconds`);qa&&!G.a(qa)&&((this.isQueryTable=qa.Result)?(qa=ea.a.ed(3,2,0,737,0,-66108047,"ConvertToRange"),f.TaskExtensions.za(ra.a(this.$).kj(qa),La=>{d.ULS.sendTraceTag(537151192,0,50,`ConvertToRangeManager.ShowDialog: Time taken for User Input is ${this.Sh.Bc} milliseconds`);0===La.result&&this.dah()},this.$.la,11)):this.eah());this.Sh.stop();
d.ULS.sendTraceTag(537151191,0,50,`ConvertToRangeManager.ShowDialog: Total Time taken for complete operation is ${this.Sh.Bc} milliseconds`)}nye(){const qa={};qa.IsQueryTable=this.isQueryTable;qa.Range=this.sharedSheetRange;return qa}dah(){const qa=this.$.oa.xa;d.ULS.sendTraceTag(537151190,0,50,"Convert To Range initiated for Query Table");this.pgf(194,(La,Yb,mc)=>da.d(qa,this.nye(),La,Yb,mc,null));d.ULS.sendTraceTag(537151189,0,50,"Convert To Range completed for Query Table")}eah(){const qa=this.$.oa.xa;
d.ULS.sendTraceTag(537151188,0,50,"Convert To Range initiated for Normal Table");this.pgf(193,(La,Yb,mc)=>da.c(qa,this.nye(),La,Yb,mc,null),()=>new O(this.tableName));d.ULS.sendTraceTag(537151187,0,50,"Convert To Range completed for Normal Table")}pgf(qa,La,Yb=null){v.a(this.$.userOperationManager,La,mc=>new C.a(qa,0,mc,void 0,Yb),null)}}Object(r.a)(xa,"ConvertToRangeManager",null,[]);var ia=a(1151),Ma=a(965),Ta=a(13);class Da extends Ma.a{constructor(qa,La){super(qa);this.HOb=La}get kc(){return"FormatAsTableDialog"}get IB(){return 215}get el(){return Ta.a.instance.ga(731)}Vj(){const qa=
y.s(this.L$.TableRange);return()=>new V(qa,this.hasHeaders,this.HOb,!0)}GG(){const qa=y.s(this.L$.TableRange),La=this.L$.HasTotalRow;return(Yb,mc,Zb)=>da.h(this.$.oa.xa,qa,this.hasHeaders,!1,La,this.HOb,Yb,mc,Zb,null)}}Object(r.a)(Da,"FormatAsTableReactDialog",Ma.a,[]);Ma=a(285);var fa=a(90);class ua extends Ma.a{constructor(qa){super(qa);this.ZQj=(La,Yb)=>{1===La&&this.KVj(y.D(this.VLf(Yb[ua.tRf])))};this.mxb=La=>{La=this.nhd(La);return this.Aed(La)};this.gridView=L.h(qa);this.qa=this.gridView.ha.qa;
this.brc=this.gridView.tb.Dh(this.qa.activeCell).usedRange;qa=this.HM(this.brc.toString());this.initializeAndShow(Ta.a.instance.ga(732),this.ZQj,qa)}get kc(){return"ResizeTableDialog"}VLf(qa){qa=qa.startsWith("=")?qa.substring(1,qa.length):qa;if(({sheetName:qa,range:La}=y.Y(qa,this.$.va)).returnValue&&La){var La=y.v(La,this.$);La.SheetName=N.a.equals(qa,"",!0)?this.$.na.name:qa;return La}return null}HM(qa){return{[ua.YU]:"ResizeTableDialog",[ua.tRf]:qa,["getInputErrorIfInvalid"]:this.mxb}}nhd(qa){qa=
this.VLf(qa);if(!qa)return 1;const La=y.D(qa);return N.a.equals(qa.SheetName,this.$.na.sheetName,!0)&&this.brc.top===La.top&&this.brc.zd(La)?0:2}Aed(qa){let La="";switch(qa){case 1:La=Ta.a.instance.ga(75);break;case 2:La=fa.a.kf(Ta.a.instance.ga(74))}return La}KVj(qa){this.$.Yc(-1400250766,n.a.zb,8,{["ResizeTableRange"]:qa,["OriginalTableRange"]:this.brc})}}ua.YU="id";ua.tRf="range";Object(r.a)(ua,"ResizeTableDialog",Ma.a,[]);class Fa extends Ma.a{constructor(qa){super(qa);qa=L.h(this.$);qa=qa.tb.Dh(qa.ha.qa.activeCell);
N.a.lh(qa.sTa)?this.nFd="":this.nFd=qa.sTa;N.a.lh(qa.tTa)?this.mFd="":this.mFd=qa.tTa;qa=this.HM(this.nFd,this.mFd);this.initializeAndShow(Ta.a.instance.ga(741),this.OQj,qa)}get kc(){return"TableAltTextDialog"}OQj(qa,La){1===qa&&(qa=La[Fa.qTj],La=La[Fa.Alh],qa===this.nFd&&La===this.mFd||this.$.Yc(868579142,n.a.zb,8,{["Title"]:qa,["Description"]:La}))}HM(qa,La){return{["id"]:"AltTextDialog",["title"]:qa,["description"]:La}}}Fa.YU="id";Fa.qTj="title";Fa.Alh="description";Object(r.a)(Fa,"TableAltTextDialog",
Ma.a,[]);var ca=a(782),ka=a(783),Ca=a(115),fb=a(73),yb=a(55),mb=a(33),nb=a(145),X=a(103),R=a(187),wa=a(105);class na{constructor(qa,La,Yb,mc){this.menuId=null;this.ERa=-1;this.MQi=Zb=>{if(!G.a(Zb)){const Ha=L.h(this.$);var qb=new t.Range(1,1,1,1,!0,!1);qb=y.v(qb,this.$);null!=Zb.Result&&(nb.a("CreateSampleTable.NewSheet"),qb.SheetName=Zb.Result.toString());Ha.qg(qb,null,null,null,0,"TableCommandHandler.OnCreateSampleTableDone")}};this.oJf=()=>{this.oda()};this.I0i=Zb=>{if(!(this.qa.cMa()||(!D.EwaSettings.isChangeGateEnabled("OfficeVSO:4124510_JsCrashOnToggleTableStyleOptionSuccessful")||
G.a(Zb)||this.uMa())&&G.a(Zb)&&this.uMa())){Zb=this.qa.activeCell;var qb=this.qa.activeRange;const Ha=this.tableManager.Dg.usedRange;2===this.ERa&&B.g(this.tableManager.Dg)&&Zb.bottom===Ha.bottom&&(qb=qb.i5?new t.Range(qb.top-1,qb.left,qb.bottom-1,qb.right,!1,!0):new t.Range(qb.top,qb.left,qb.bottom-1,qb.right,!1,!0),Zb=qb.contains(Zb)?Zb:t.Range.Mc(qb.bottom,Zb.left),L.h(this.$).ha.updateSelection(qb,Zb,0,3))}};this.a0i=Zb=>{G.a(Zb)?(d.ULS.sendTraceTag(594130062,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename failed due invalid user input"),
this.$.qf()):d.ULS.sendTraceTag(594130061,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename successful")};this.$_i=()=>{d.ULS.sendTraceTag(594130060,0,15,"TableManager.OnTableRenameFailure-Rename table failed");this.$.qf()};this.b0i=(Zb,qb)=>{qb&&this.gS(qb);G.b(Zb,-569193796)&&(fb.a(this.$).gd.RL(-569193796),this.szi(Zb.Errors[0]))};this.$=qa;this.tableManager=La;this.namedSheetViewPublic=Yb;this.frame=this.$.frame;this.ha=L.h(this.$).ha;this.qa=this.ha.qa;this.XA=D.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");
this.YA=mb.a.YA(this.$);this.tableStyleManager=mc;this.tableStyleManager.DOg(this.oJf)}Hc(qa,La){switch(La){case -544558380:return!(this.tableManager&&this.qa.bK()&&!this.uMa()&&B.d(this.tableManager.Dg));case 1544516694:return!(this.tableManager&&(this.qa.bK()?!this.uMa():this.qa.cMa()));case -697806646:case 323142015:return!this.qa.bK();case 341449783:case 2128797448:return D.EwaSettings.isChangeGateEnabled("OfficeVSO:6083078_HeaderAndTotalRowDisabledFix")?!(this.tableManager&&(this.qa.bK()?!this.uMa():
this.qa.cMa())):!(this.tableManager&&this.tableManager.ytd(this.qa.activeCell));case -123538519:return!(this.qa.bK()&&this.tableStyleManager&&this.tableStyleManager.ztd());case 756677940:return!(D.EwaSettings.isChangeGateEnabled("OfficeVSO:7427871_TableRename")&&this.pli());case 753331043:case 2105103744:case -585683120:return!(this.tableStyleManager&&this.qli());case 844144422:return!this.qa.bK();case -723113214:return!this.qa.bK();case 1371713064:case 875133075:return!mb.a.YA(this.$)||X.k(this.$.dg)}return!1}executeCommand(qa,
La,Yb){var mc;qa=f.TaskExtensions.Tj();const Zb=this.$.oa.xa;let qb=null,Ha=1;const Ya=La.command,Gb=this.$.oa.xa.Wb();let Ja=null;if(this.YA)switch(Ya){case -2058042992:case 504133448:case -798968736:case 477776686:H.d(this.$,Yb.TopCellAddress,Ya,null);break;case -1400250766:H.d(this.$,Yb.OriginalTableRange,Ya,null);break;case -123538519:case 323142015:case 868579142:case 753331043:case 756677940:case 341449783:case 1544516694:case 2128797448:const Qa=L.h(this.$);H.d(this.$,Qa.ha.qa.activeCell,Ya,
null)}switch(Ya){case -2058042992:const Qa=z.a.Xh(Yb[n.a.Pf]);D.EwaSettings.isChangeGateEnabled("OfficeVSO:7010744_RegressionFix_MacroRecording_ClearFilterInAFMenu")&&!Qa.CriteriaType&&(Qa.CriteriaType=0);na.R3f(this.$,Qa);qb=(ha,eb,ta)=>da.a(Zb,Qa,null,null,!1,!1,!1,ca.a.X4a(Ca.a.JGa,ka.a.clearAutoFilter,ha),eb,ta,null);Ha=176;Ja=()=>new m(Qa);break;case 504133448:case -798968736:case 477776686:const Oa=z.a.Xh(Yb[n.a.Pf]),bb=Yb.TopCellAddress;na.R3f(this.$,Oa);const Ga=504133448===La.command?1:-798968736===
La.command?2:3;if(bb){Yb=this.tableManager.Np(bb);if(!Yb){var Na=this.$.va.na;(null===(mc=y.D(Na.v0))||void 0===mc?0:mc.contains(bb))?Yb=y.D(Na.v0):d.ULS.sendTraceTag(527700033,0,15,"TableCommandHandler.executeCommand: unknown sort range; unable to check for protected ranges")}if(!this.$.isEditMode){if(Yb&&!this.$.lZc([Yb],!0,1))break}else if(Yb&&!this.$.Us([Yb],!0,1))break}qb=(ha,eb,ta)=>x.H(Zb,Oa,Ga,M.b(ha,this.b0i),eb,ta,bb,Gb);Ha=177;Ja=()=>new w(Oa,Ga);break;case 341449783:case 2128797448:this.ERa=
341449783===Ya?0:2;({nCa:qb,operationName:Ha,Vj:Ja}=this.toggleTableStyleOption(Zb,Gb));break;case -712419744:this.XA?this.$ff(Yb[k.a.event]):this.$ff(null);break;case 875133075:case 1371713064:let tb=y.r(this.qa.selectedRanges,this.$);if(!tb)break;const wb=this.H2h(Yb);qb=(ha,eb,ta)=>da.e(Zb,tb,wb,M.b(ha,this.MQi),eb,ta,null,Gb);mc="TestHost"===this.$.ya.DocumentHostInfo.HostTier;d.ULS.shipAssertTag(512275419,0,"OneDriveWOPI"===this.$.ya.HostName||mc,"TableCommandHandler.CreateSampleTable: command executed for non-consumer audience and missing macro recorder");
Ha=1025;break;case 1868184698:if(D.EwaSettings.isChangeGateEnabled("OfficeVSO:6224451_CreateTableInEmptyCell")&&({vAb:mc,nCa:qb,Vj:Ja}=this.Mgg(null,Gb),mc)){Ha=206;break}new ia.a(this.$);break;case 844144422:new ua(this.$);break;case 1544516694:case -544558380:if(mc=Yb[n.a.Kc])this.ERa=this.P4h(mc),-1!==this.ERa&&({nCa:qb,operationName:Ha,Vj:Ja}=this.toggleTableStyleOption(Zb,Gb));break;case 756677940:if(this.uMa()&&this.mlf()){d.ULS.sendTraceTag(537151177,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while executing rename command");
break}const lb=Yb.Text,db=this.UXh();if(db){qb=(eb,ta,ya)=>da.j(Zb,lb,db,M.b(eb,this.a0i),M.a(ta,this.$_i),ya,Gb);Ha=217;let ha=null;this.tableManager.Dg?ha=this.tableManager.Dg.name:this.tableManager.THd?ha=this.tableManager.THd.name:d.ULS.sendTraceTag(537151176,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while fetching oldName during executing rename command");ha&&(Ja=()=>new ba(ha,lb))}else return d.ULS.sendTraceTag(537151175,
0,10,"TableCommandHandler.RenameTable: Selected Table Range is null"),yb.Task.Sa(!1);break;case 323142015:if(this.uMa())break;return(new xa(this.$,this.Ued(),this.tableManager.Dg.name)).Hab();case -1400250766:Ha=211;qb=this.tpj(Yb,Zb,Gb);const Pa=y.m(Yb.OriginalTableRange,this.$.va.na);Ja=()=>new Y(Pa);break;case 1872288872:this.tableManager.Naj();break;case -123538519:const ja=this.O4h(Yb);mc=N.a.contains(Yb[n.a.Kc],k.a.sIb,!0)||N.a.contains(Yb[k.a.KF],"TableStyleIcon",!0)?"Preview Gallery":"Pop-out Gallery";
d.ULS.sendTraceTag(51181323,0,50,`TableStyleManager.ApplyTableStyleWebInvocation - Apply Table Style Invoked from ${mc} with style index ${ja.toString()}`);let Ka=this.n7e();Ka&&(qb=(ha,eb,ta)=>da.b(Zb,Ka,ja,ha,eb,ta,null,Gb),Ja=()=>new aa(Ka,ja),Ha=212);break;case 753331043:mc=Yb[n.a.Kc];if(!mc)break;const ub=Number.parseInvariant(mc);if(this.qa.bK()){d.ULS.sendTraceTag(51181321,0,50,`TableCommandHandler.FormatAsTable invoked on existing table with style index: ${ub}`);let ha=this.n7e();ha&&(qb=
(eb,ta,ya)=>da.h(Zb,ha,!1,!1,!1,ub,eb,ta,ya,null,Gb),Ja=()=>new V(ha,!1,ub,!1),Ha=215);break}if(D.EwaSettings.isChangeGateEnabled("OfficeVSO:6224451_CreateTableInEmptyCell")&&({vAb:Yb,nCa:qb,Vj:Ja}=this.Mgg(ub,Gb),Yb)){Ha=215;break}d.ULS.sendTraceTag(51181322,0,50,`TableCommandHandler.FormatAsTable invoked on newly created table with style index: ${ub}`);new Da(this.$,Number.parseInvariant(mc));break;case 71074531:const Kb=Yb.HasHeader,W=Yb.TableRange;if(D.EwaSettings.isChangeGateEnabled("OfficeVSO:7553123_formattablefromrange")){const ha=
null!==(Na=Yb.StyleIndex)&&void 0!==Na?Na:22;let eb=y.s(W);qb=(ta,ya,sb)=>da.h(Zb,eb,Kb,!1,!1,ha,ta,ya,sb,null,Gb);Ja=()=>new V(eb,Kb,ha,!0)}else qb=(ha,eb,ta)=>da.f(Zb,W,Kb,!1,!1,ha,eb,ta,null),Ja=()=>new u.a(Kb,W);Ha=206;break;case -723113214:new Fa(this.$);break;case 868579142:d.ULS.sendTraceTag(526463700,0,50,"AltText on table changed.");Ha=1022;const za=Yb.Title,Sa=Yb.Description,Wa=this.Ued();qb=(ha,eb,ta)=>da.g(Zb,za,Sa,Wa,ha,eb,ta,null);let ab,ma;this.tableManager.Dg&&(ab=N.a.lh(this.tableManager.Dg.sTa)?
"":this.tableManager.Dg.sTa,ma=N.a.lh(this.tableManager.Dg.tTa)?"":this.tableManager.Dg.tTa);Ja=za==ab?()=>new P(Wa,void 0,Sa):Sa==ma?()=>new P(Wa,za,void 0):()=>new P(Wa,za,Sa);break;default:return E.a(Ya)}if(qb){const Qa=Oa=>new C.a(Ha,0,Oa,void 0,Ja);qa=!this.namedSheetViewPublic||-2058042992!==Ya&&504133448!==Ya&&-798968736!==Ya&&477776686!==Ya?v.a(this.$.userOperationManager,qb,Qa,La):this.namedSheetViewPublic.DSa().continueWith(Oa=>{Oa.result&&v.a(this.$.userOperationManager,qb,Qa,La)})}return qa}toggleTableStyleOption(qa,
La){const Yb=this.qa.cMa();d.ULS.sendTraceTag(41996800,0,50,`TableCommandHandler: The selected ${Yb?"PivotTable":"table"} style option ${this.ERa} was toggled.`);const mc=this.Ued();return{nCa:(Zb,qb,Ha)=>da.l(qa,mc,this.ERa,M.b(Zb,this.I0i),qb,Ha,null,La),operationName:196,Vj:()=>new Z(mc,this.ERa,Yb)}}tpj(qa,La,Yb){const mc=qa.OriginalTableRange,Zb=y.m(qa.ResizeTableRange,this.$.va.na),qb=()=>{this.tableManager.Fdg(mc)},Ha=Ya=>{Ya.Errors&&this.tableManager.Fdg(mc)};return(Ya,Gb,Ja)=>da.k(La,Zb,
M.b(Ya,Ha),M.a(Gb,qb),Ja,null,Yb)}O4h(qa){var La=-1;qa[n.a.Kc]&&(La=qa[n.a.Kc],La=N.a.contains(La,k.a.sIb,!0)?this.tableStyleManager.lxb(La):Number.parseInvariant(qa[n.a.Kc]));return La}H2h(qa){return(qa=qa[n.a.Kc])?Number.parseInvariant(qa):0}wc(qa,La){qa=!1;switch(La.command){case -2058042992:case 504133448:case -798968736:case 477776686:case 341449783:case 2128797448:case -712419744:case 1868184698:case 1872288872:case 323142015:case 1544516694:case -544558380:case -1400250766:case -123538519:case 753331043:case 844144422:case 71074531:case -723113214:case 868579142:qa=
!0;break;case 756677940:qa=D.EwaSettings.isChangeGateEnabled("OfficeVSO:7427871_TableRename");break;case 875133075:case 1371713064:qa=mb.a.YA(this.$)}return qa}Nc(qa,La,Yb){qa=!1;switch(La){case "PopulateTableMoreStylesMenu":this.menuId=Yb.MenuId;this.tableStyleManager.ztd()||this.tableStyleManager.Y4a("formatAsTableMenu");qa=this.tableStyleManager.sNf(La,Yb);break;case "PopulateTableAccessibleStylesMenu":this.menuId=Yb.MenuId,this.tableStyleManager.ztd()||this.tableStyleManager.Y4a("accessibilityTab"),
qa=this.tableStyleManager.sNf(La,Yb)}return qa}dispose(){this.tableStyleManager.plj(this.oJf)}oda(){(N.a.contains(this.menuId,"Format",!0)||N.a.contains(this.menuId,"Accessible",!0))&&this.menuId&&this.frame.Yw(this.menuId)}Ued(){return y.v(this.qa.activeCell,this.$)}UXh(){const qa=this.tableManager.Pud;return qa?y.v(qa,this.$):null}$ff(qa){if(this.tableManager){var La=L.h(this.$),Yb=this.qa.activeCell,mc=this.tableManager.Np(Yb),Zb=null;if(!mc||mc.bBa)for(let qb of La.Kha)for(let Ha of qb)La=Ha.qt,
Yb.left>=La[0]&&Yb.left<=La[La.length-1]&&(Zb=(La=Ha.Vr(Yb).OJ())?S.DOMElementExtensions.$j(La,l.a.Gse):null);else{const qb=La.Pb(t.Range.Mc(mc.top,Yb.left));if(this.XA){I.a.instance.create(()=>{qb.invoke(8,qa)},0,U.a.zdg,!0,!0);return}Zb=qb.EKa(56).o6a}Zb&&I.a.instance.create(()=>{S.DOMElementExtensions.Igc(Zb,null)},0,U.a.zdg,!0,!0)}}P4h(qa){qa=Number.parseInvariant(qa);return-1<qa&&8>=qa?qa:-1}uMa(){return!this.tableManager.Dg}mlf(){return this.tableManager.THd?!1:(d.ULS.sendTraceTag(537151173,
0,15,"TableCommandHandler.IsPreviousSelectedTableObjectNull PreviousSelectedTableObject is null"),!0)}qli(){const qa=this.qa.bK(),La=this.qa.Tg&&!L.h(this.$).tb.c5(this.qa.ld);return qa||La}pli(){return this.qa.bK()||!this.mlf()}T4h(qa){const La=[];for(const Yb of qa)if(qa=H.b(this.$,Yb),null===qa||void 0===qa?0:qa.length)for(const mc of qa)mc.usedRange&&!La.includes(mc.usedRange)&&La.push(mc.usedRange);return La}n7e(){const qa=this.qa.selectedRanges;let La=[];if(D.EwaSettings.isChangeGateEnabled("OfficeVSO:3987000_ApplyTableStylesOnMultipleTablesInSingleRange"))La=
this.T4h(qa);else for(const Yb of qa)L.h(this.$).tb.c5(Yb)&&La.push(Yb);return La&&La.length?y.r(La,this.$):null}gS(qa){mb.a.Yka(this.$)&&f.TaskExtensions.za(e.GetServiceTaskFactory.Oa(this.$.da,430,431,1),La=>{La.result.vea(qa);d.ULS.sendTraceTag(537151172,306,50,"TableCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.la,3)}szi(qa){D.EwaSettings.isChangeGateEnabled("OfficeVSO:7477297_MoveSortUtilToNewServices")?void R.a.resolve(wa.n,{Tl:0}).then(La=>{La.gJe(this.$,
qa)}):f.TaskExtensions.za(e.GetServiceTaskFactory.Oa(this.$.da,446,447,0),La=>{La.result.gJe(this.$,qa)},this.$.la,3)}static R3f(qa,La){La.SheetName=qa.na.name;La.NamedObjectView=qa.ea.isNamedObjectViewMode}Mgg(qa,La){let Yb,mc;if(!this.qa.Tg||1!=this.qa.ld.Oy)return{vAb:!1,nCa:Yb,Vj:mc};let Zb=y.v(this.qa.ld,this.$);Zb.LastColumn=Zb.FirstColumn+3-1;Zb.LastRow=Zb.FirstRow+4-1;const qb=y.D(Zb),Ha=L.h(this.$);if(!qb.nz||!Ha.tb.cxa(qb))return{vAb:!1,nCa:Yb,Vj:mc};h.AFrameworkApplication.Tp("XLS-CreateTableInEmptyCell-Treatment;XLS-CreateTableInEmptyCell-Control");
if(!D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CreateTableInEmptyCell",!1))return{vAb:!1,nCa:Yb,Vj:mc};if(null==qa)Yb=(Ya,Gb,Ja)=>da.f(this.$.oa.xa,Zb,!1,!1,!1,Ya,Gb,Ja,La),mc=()=>new u.a(!1,Zb);else{const Ya=y.s(Zb);Yb=(Gb,Ja,Na)=>da.h(this.$.oa.xa,Ya,!1,!1,!1,qa,Gb,Ja,Na,La);mc=()=>new V(Ya,!1,qa,!0)}return{vAb:!0,nCa:Yb,Vj:mc}}}Object(r.a)(na,"TableCommandHandler",null,[222]);class Ba extends b.a{constructor(qa){super(qa)}dispose(){super.dispose()}hd(){const qa=e.GetServiceTaskFactory.create(this.$.da,
134,this.la,this.Xa),La=e.GetServiceTaskFactory.create(this.$.da,330,this.la,this.Xa),Yb=e.GetServiceTaskFactory.Oa(this.$.da,309,310,this.Xa);if(mb.a.YA(this.$)){const mc=e.GetServiceTaskFactory.create(this.$.da,128,this.la,this.Xa);f.TaskExtensions.za(yb.Task.aG(qa,Yb,La,mc),()=>{this.$c([new na(this.$,qa.result,Yb.result,La.result)],[2128797448,341449783,1544516694,-544558380,-123538519,753331043,756677940])},this.$.la,3)}else f.TaskExtensions.za(yb.Task.aG(qa,Yb,La),()=>{this.$c([new na(this.$,
qa.result,Yb.result,La.result)],[2128797448,341449783,1544516694,-544558380,-123538519,753331043,756677940])},this.$.la,3)}static ka(qa){b.a.Md(86,new Ba(qa))}}Object(r.a)(Ba,"TableCommandHandlerFactory",b.a,[]);a.d(F,"a",function(){return Ra});const Ra=()=>{c.a.Fa(qa=>{Ba.ka(qa)})}},1187:function(r,F,a){r=a(0);var c=a(85),b=a(552),e=a(15);class f{constructor(){this.JGc={}}wHg(Ma){this.JGc[Ma.id.toString()]=Ma}TLi(Ma){const Ta=this.JGc;for(let Da in Ta)Ta[Da].notify(Ma,!1);this.JGc={}}U$i(Ma,Ta){Ta&&
this.wHg(Ta);return this.xHf(Ma,Ta)}Y9c(Ma){this.TLi(Ma)}mPe(Ma,Ta){Ma.notify(Ta,!0)}}Object(r.a)(f,"AEventEmitter",null,[710]);var d;(function(Ma){Ma[Ma.notStarted=0]="notStarted";Ma[Ma.waiting=1]="waiting";Ma[Ma.shouldRetry=2]="shouldRetry";Ma[Ma.complete=3]="complete"})(d||(d={}));Object(r.b)("EventResultState",d);class h{constructor(){this._state=0}get state(){return this._state}set state(Ma){e.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",{["OldState"]:d[this._state],["NewState"]:d[Ma]},
"ResultType",this.O6e());this._state=Ma}}Object(r.a)(h,"AEventResult",null,[754]);class l extends h{constructor(){super();this.UTc=this.Glb=null;this.state=0;this.RMc=this.xae=!1}get pR(){return this.Glb}get loa(){return this.UTc}get Kji(){return this.xae}O6e(){return"GetMoreInfo Result"}}Object(r.a)(l,"GetMoreInfoResult",h,[753,754]);var k=a(4),t=a(79),n=a(40),z=a(699),w=a(378),m=a(168),u=a(652),y=a(576),v=a(108),C=a(25);class x{constructor(Ma,Ta,Da,fa,ua,Fa,ca,ka){this.Ma=Ma;this.ph=Ta;this.Wsg=
Da;this.b1=fa;this.he=ua;this.wLc=Fa;this.Jxg=ca;this.wYb=ka}ufj(){this.S9a.Nb(C.a.openUrlInNewTab,v.a.frame,Object(c.a)(this,this.openUrlInNewTab,"openUrlInNewTab"));this.S9a.Nb(C.a.rPa,v.a.frame,Object(c.a)(this,this.rPa,"openDocumentUrl"));k.AFrameworkApplication.rM?this.$rf():this.S9a.Oe(C.a.A8b,v.a.frame,Object(c.a)(this,this.A8b,"documentLoaded"),96)}openUrlInNewTab(Ma,Ta,Da,fa,ua){ua&&ua.MenuItemId&&(e.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:ua.SourceControlId,["AppType"]:y.a[this.nca]}),
n.a.gf(ua.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32}rPa(Ma,Ta,Da,fa,ua){if(ua&&ua.MenuItemId){const Fa=k.AFrameworkApplication.fa.pa("WacInTabOpenMRUIsEnabledForUiHost"),ca=k.AFrameworkApplication.fa.pa("UiHostSupportsDocRebootFeatures");e.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",Fa,ca);if(Fa&&ca){e.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:ua.SourceControlId,["AppType"]:y.a[this.nca]});
Ma=ua.MenuItemId.toString();const ka={};ka[w.a.jQa]="1";ka[w.a.documentUrl]=Ma;ka[w.a.reason]=u.a.open;e.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");k.AFrameworkApplication.uQ().execute(Ca=>{Ca.jj(m.a.SY,ka)})}else this.openUrlInNewTab(Ma,Ta,Da,fa,ua)}return 32}A8b(){this.$rf();return 32}XNa(Ma,Ta,Da=""){if(Ta&&Ta.cF){const fa=z.a[Ta.status];Ta=Ta.cF.getTime();const ua=this.jw()-Ta;e.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",
{["Caller"]:Ma,["RequestStatus"]:fa,["ElapsedMs"]:ua,["StartTime"]:Ta,["Notes"]:Da})}else e.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:Ma})}$rf(){var Ma=k.AFrameworkApplication.fa.pa("QPGVCI"),Ta=t.a.Ux(document.URL,"wdNewAndOpenCt",Ma);if(Ta){Ta=parseInt(Ta);var Da=t.a.Ux(document.URL,"wdPreviousSession",Ma);Ma=t.a.Ux(document.URL,"wdPreviousCorrelation",Ma);var fa=k.AFrameworkApplication.fa.pa("NAOPLP");if(k.AFrameworkApplication.rM){var ua=
k.AFrameworkApplication.rM.getTime();!Ta||Ta>ua?e.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:Ta,["DocumentLoadedTime"]:ua,["SessionId"]:Da,["Correlation"]:Ma}):e.ULS.sendTraceTag(5849683,202,fa?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:ua-Ta,["ClickTimestamp"]:Ta,["SessionId"]:Da,["Correlation"]:Ma})}else e.ULS.sendTraceTag(5849681,202,fa?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",
{["ClickTimestamp"]:Ta,["SessionId"]:Da,["Correlation"]:Ma})}}get S9a(){return this.Ma.value}get gFb(){return this.ph.value}get oxf(){return this.Wsg.value}get nca(){return this.b1.value}get Pnc(){return this.he.value}get jw(){return this.wLc}get t_(){return this.Jxg.value}get supportsGetMoreInfoForPersonalStorage(){return this.wYb.value}static get instance(){return x.La||(x.La=x.BM())}static BM(){return new x(new b.a(()=>k.AFrameworkApplication.rb),new b.a(()=>k.AFrameworkApplication.Bd),new b.a(()=>
k.AFrameworkApplication.sa),new b.a(()=>k.AFrameworkApplication.sa.Qa.Oj),new b.a(()=>k.AFrameworkApplication.ji),()=>(new Date).getTime(),new b.a(()=>k.AFrameworkApplication.sa.Qa.t_),new b.a(()=>k.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage))}}x.La=null;Object(r.a)(x,"NewAndOpenCommonHelpers",null,[709]);var B=a(109);class H{constructor(Ma,Ta,Da){this.IXb=this.Ki=null;this.gSc=0;this.BDg=Ma;this.he=Ta;this.U7d=Da}nQg(){this.gSc=this.Ycb+1}ZNd(Ma){this.Ki&&(this.he.Uo(this.Ki),this.Ki=
null);Ma&&(this.gSc=0)}TNj(Ma){const Ta=this.hTj;0<=Ta?(this.nQg(),this.ZNd(!1),this.Ki=new B.a(4,1,Ta,Ma,107),this.he.fg(this.Ki)):(this.ZNd(!0),e.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.U7d}))}get Ycb(){return this.gSc}get hTj(){return this.Ycb>=this.s3f.length?-1:this.s3f[this.Ycb]}get s3f(){if(!this.IXb){const Ma=(this.BDg.value||"0").split(",");this.IXb=[];for(let Ta=0;Ta<Ma.length;Ta++){const Da=parseInt(Ma[Ta]);isNaN(Da)?e.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",
{["Action"]:this.U7d,["Entry"]:Ma[Ta]}):Array.add(this.IXb,Da)}}return this.IXb}}Object(r.a)(H,"RetryHelper",null,[]);var I=a(39),U=a(30);class S extends f{constructor(Ma,Ta){super();this.G1=Ma;this.gmb=new H(Ta,this.KEb.Pnc,"GetMoreInfo");this.Lo=new l}$Fi(){this.tyd("Document opened")}Ceh(Ma){return()=>{this.tyd(Ma,!0)}}xHf(Ma,Ta=null){e.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:Ma});3===this.Lo.state?(Ta&&this.mPe(Ta,this.Lo),e.ULS.sendTraceTag(5849619,
202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:Ma})):this.tyd(Ma);return this.Lo}tyd(Ma,Ta=!1){this.gmb.ZNd(!Ta);1===this.Lo.state?e.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:Ma,["RetryIndex"]:this.gmb.Ycb}):(e.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:Ma,["RetryIndex"]:this.gmb.Ycb}),this.Lo.state=1,Ta=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.KEb.t_,k.AFrameworkApplication.vi),
this.KEb.gFb.Jga(Ta,1,null,null,[S.Lge,S.Lke],!1,5,this.Fdh(),this.Edh(Ma),null))}Fdh(){return Ma=>{var Ta=!1;let Da=!1;var fa=!1,ua;k.AFrameworkApplication.fa.pa("GetMoreInfoDataFromResponseBody")&&(Ma.data.de?({ht:ua}=I.d(Ma.data.de)).returnValue?ua?(fa=!0,this.Lo.UTc=ua.StorageServiceDisplayName,this.Lo.Glb=S.Fnf(ua.PersonalFileStorageUrl)?ua.PersonalFileStorageUrl:"",""===this.Lo.pR&&"SharePointOnlineConsumer"===k.AFrameworkApplication.fa.Wa("FileSource")&&(this.Lo.Glb=t.a.qda(k.AFrameworkApplication.breadcrumbFolderUrl)),
Ta=""===this.Lo.pR&&""!==this.Lo.loa):e.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):e.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):e.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));fa||((ua=Ma.data.responseHeaders)?
(this.Lo.UTc=(ua[S.Lke]||"").toString(),Ta=(ua[S.Lge]||"").toString(),this.Lo.Glb=S.Fnf(Ta)?Ta:"",""===this.Lo.pR&&"SharePointOnlineConsumer"===k.AFrameworkApplication.fa.Wa("FileSource")?(this.Lo.Glb=t.a.qda(k.AFrameworkApplication.breadcrumbFolderUrl),Ta=""===this.Lo.pR&&""!==this.Lo.loa):Ta=""===Ta&&""!==this.Lo.loa):(e.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),Da=!0));fa=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",
this.gmb.Ycb,Da,Ta,fa);this.KEb.XNa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",Ma.data,fa);this.K3f(3,Ta,Da)}}Edh(Ma){return Ta=>{this.KEb.XNa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",Ta.data,"Failure");this.K3f(2);this.gmb.TNj(this.Ceh(Ma))}}K3f(Ma,Ta=!1,Da=!1){this.Lo.state=Ma;this.Lo.xae=Ta;this.Lo.RMc=Da;this.Y9c(this.Lo)}get KEb(){return this.G1.value}static get instance(){return S.La||(S.La=S.BM())}static BM(){return new S(new b.a(()=>x.instance),new b.a(()=>
k.AFrameworkApplication.eZh))}static Fnf(Ma){if(!Ma)return e.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(U.a.Yk(Ma).startsWith("https://"))return!0;e.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}S.Lge="PersonalFileStorageUrl";S.Lke="StorageServiceDisplayName";S.La=null;Object(r.a)(S,"GetMoreInfoActor",f,[]);var G=a(104),D=a(98);class E{constructor(Ma,Ta,Da,fa,ua){this.pyg=6E4;this.Xdf="inactive";this.yne=
"active";this.LS=!0;this.he=Ma;this.pxg=Ta;this.wLc=Da;this.MYb=fa;this.Za=new D.a;ua&&this.LNj();this.Ace=this.o4e()}ooe(Ma){this.Za.addHandler(this.yne,Ma)}RJg(Ma){this.Za.addHandler(this.Xdf,Ma)}LNj(){const Ma=new B.a(5,2,this.pyg,Object(c.a)(this,this.Pei,"inactiveLoop"),108);this.Qei.fg(Ma)}Pei(){const Ma=this.o4e(),Ta=this.jw()-Ma;Ta>this.tCc&&this.LS&&(e.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:Ta}),this.LS=!1,this.Za.raiseEvent(this.Xdf));Ma-this.Ace>
this.tCc&&(this.LS=!0,this.Za.raiseEvent(this.yne));this.Ace=Ma}get Qei(){return this.he.value}get o4e(){return this.pxg}get jw(){return this.wLc}get tCc(){return this.MYb.value}static get instance(){return E.La||(E.La=E.BM())}static BM(){return new E(new b.a(()=>G.a.instance),()=>k.AFrameworkApplication.svd.getTime(),()=>(new Date).getTime(),new b.a(()=>k.AFrameworkApplication.tCc),!0)}}E.La=null;Object(r.a)(E,"InactivityManager",null,[]);var N=a(84),M=a(925);class L extends h{constructor(){super();
this.Lee=this.Nee=this.Mee=null;this.state=this.Ele=0;this.RMc=!1}get Vzd(){return this.Mee}get Bwf(){return this.Nee}get Uzd(){return this.Lee}get nTj(){return this.Ele}O6e(){return"MruActor Result"}}Object(r.a)(L,"MruResult",h,[755,754]);var aa=a(241);class V{constructor(Ma,Ta,Da){this.task=null;this.hgc=Ma;this.KHi=Ta;this.taskManager=Da;this.retryCount=this.Yzb=0;this.rRc=this.WCb=null}lsi(Ma,Ta){return Ma===aa.a.Fdd||20===Ta||18===Ta||3===Ta}zti(Ma){return 3===Ma||5===Ma||6===Ma||7===Ma||9===
Ma||10===Ma||11===Ma||12===Ma||13===Ma||14===Ma||15===Ma||16===Ma||23===Ma||26===Ma||27===Ma||28===Ma}get Osc(){return this.rRc}reset(){this.Yzb=this.retryCount=0;this.rRc=this.WCb=null;this.task&&(this.taskManager.Uo(this.task),this.task=null)}Tii(Ma,Ta,Da,fa){this.rRc=String.format("{0}_{1}",Da,fa);if(this.retryCount>=this.KHi)return e.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.lsi(Da,fa))return e.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),
!1;if(this.zti(fa)&&1<=this.Yzb)return this.WCb=Da,!1;Ta=Math.max(Ta,this.hgc*Math.pow(2,this.Yzb));if(26===fa)Ta=Math.max(Ta,3E4);else if(27===fa||28===fa)Ta=Math.max(Ta,6E4);9===fa||412===Da&&(null==this.WCb||412!==this.WCb)?Ta=500:this.Yzb+=1;this.WCb=Da;this.retryCount+=1;this.task&&this.taskManager.Uo(this.task);e.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",Ta);this.task=new B.a(2,1,Ta,Ma,107);this.taskManager.fg(this.task);return!0}}Object(r.a)(V,"RetryManager",null,
[]);var P=a(99),ba=a(137),Y=a(146);class Z{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}}Object(r.a)(Z,"WriteOptions",null,[]);var ea=a(558),ra=a(194);class O extends f{constructor(Ma,Ta,Da,fa,ua,Fa,ca){super();this.G1=Ma;this.iAg=Ta;this.ira=new V(k.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",5E3),k.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",
3),this.nD.Pnc);this.Hra=new V(k.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),k.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.nD.Pnc);this.zCg=Da;this.Sme=fa;this.OGg={};this.PS=new L;this.lxg=ua;this.SVb="";this.Nv=Fa;this.S8d=ca}get QFc(){return this.OGg}ohj(){this.nD.S9a.Nb(C.a.renameMostRecentlyUsedFileEntry,v.a.frame,Object(c.a)(this,this.emj,"renameMruEntry"))}emj(){return this.P2d("Rename")}jGi(){this.Fuf("File Opened")}kGi(){this.Fuf("IntervalUpdate")}Fuf(Ma){e.ULS.sendTraceTag(5849670,
202,50,"Starting update of MRU entry {0}",{["Trigger"]:Ma});this.P2d(Ma)}Z3(Ma){(Ma=U.a.Z3(Ma))&&Ma.startsWith(".")&&(Ma=Ma.substring(1,Ma.length));return Ma}r0e(){switch(this.nD.nca){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}y6h(Ma){var Ta=this.lxg();if(!Ta)return null;const Da=new Z;Da.documentUrl=this.S8d.value?encodeURI(Ta):Ta;Da.mruItemId=this.SVb;Da.app=this.r0e();if(Ta=this.Nv())Da.folderName=Ta.breadcrumbFolderName,
Ta=Ta.fn,Da.documentName=U.a.Lp(Ta),Da.documentExt=this.Z3(Ta);Ma&&(Da.documentName?Da.documentName.length?255<=Da.documentName.length?Ma.set("DocumentNameLength","Long"):2084<=Da.documentName.length&&Ma.set("DocumentNameLength","VeryLong"):Ma.set("DocumentNameLength","0"):Ma.set("DocumentNameLength","Null"));return JSON.stringify(Da)}P2d(Ma,Ta=!1){if(4===this.nD.nca&&!k.AFrameworkApplication.Sta)return 2;var Da=ba.a.Pr();Da&&(Da.set("Trigger",Ma),Da.set("IsRetry",Ta?"true":"false"),Da.set("MruIdSent",
this.SVb?"true":"false"),Da.set("URLEncoded",this.S8d.value?"true":"false"));P.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",Da);Ma=this.y6h(Da);if(!Ma)return Ta=!k.AFrameworkApplication.webEditingEnabled,Da&&(Da.set("WebEditingIsEnabled",k.AFrameworkApplication.webEditingEnabled?"true":"false"),Da.set("ProtectedFile",k.AFrameworkApplication.Ysc?"true":"false")),P.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",Ta,!1,Object.assign(new ra.a,{extendedProperties:Da})),2;this.Hra&&
!Ta&&this.Hra.reset();Da=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.nD.t_,this.localeName);this.Sme?this.QFc["X-FileId"]=k.AFrameworkApplication.vi:Da+=String.format("&{0}",k.AFrameworkApplication.vi);k.AFrameworkApplication.Rb&&(this.QFc["X-Office-AudienceGroup"]=Object(N.a)(String,k.AFrameworkApplication.Rb.AudienceGroup)||"");this.QFc["X-Timeout"]=15E3;return this.nD.gFb.Jm(Da,2,Ma,this.QFc,!0,5,Object(c.a)(this,this.z7j,"writeMruV2EntryOnServerSuccessCallback"),Object(c.a)(this,this.kih,
"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")}z7j(Ma){this.T$e(Ma.data)}T$e(Ma){const Ta=ba.a.Pr();this.Hra&&(Ta&&this.Hra.Osc&&(Ta.set("LastError",this.Hra.Osc),Ta.set("NumRetries",this.Hra.retryCount.toString())),this.Hra.reset());const Da=M.c(Ma.de);Da&&Da.diagnostics_data&&(this.SVb=Da.diagnostics_data.mru_id);Ma=+Ma.Y2-+Ma.cF;Ta&&Ta.set("RequestDuration",Ma.toString());P.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new ra.a,{extendedProperties:Ta}))}kih(Ma){if(Ma.data.httpStatus===
aa.a.Ssb)this.T$e(Ma.data);else{var Ta=Ma.data.httpStatus===aa.a.nIb,Da=ba.a.Pr();this.eaf(this.Hra,Ma,this.Yhh(),Da);Da&&(Da.set("StatusCode",Ma.data.httpStatus.toString()),Ta||this.BWc(Ma.data,Da));P.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",Ma.data.httpStatus),Ta,!1,Object.assign(new ra.a,{extendedProperties:Da}))}}Yhh(){return()=>{this.P2d("Retry",!0)}}kZh(){this.Jmc("Polling")}jZh(){this.Jmc("Retry",!0)}bGi(){this.Jmc("Open")}aGi(){this.Jmc("Activity")}Jmc(Ma,
Ta=!1){e.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:Ma});const Da=ba.a.Pr();Da&&(Da.set("Trigger",Ma),Da.set("IsRetry",Ta?"true":"false"));P.Health.instance.recordKpiUsage("GetMru",0,"smartfio",Da);this.ira&&!Ta&&this.ira.reset();this.Gdh(Object(c.a)(this,this.mZh,"getMruV2FromServerSuccessCallback"),Object(c.a)(this,this.iZh,"getMruFromServerFailureCallback"))}BWc(Ma,Ta){Ma&&Ma.responseHeaders&&(Ma=Ma.responseHeaders["X-CorrelationId"])&&Ta.set("ServerCorrelationId",
Ma)}OCi(Ma,Ta){Ma&&(Ta&&Ta.set("RequestDuration",(+Ma.Y2-+Ma.cF).toString()),P.Health.instance.recordKpiSuccess("GetMru",Object.assign(new ra.a,{extendedProperties:Ta})))}mZh(Ma){this.nZh(Ma)}nZh(Ma){var Ta="";let Da=null,fa=null,ua=null;const Fa=M.c(Ma.data.de);Fa&&(Da=Fa.places?Fa.places.items:[],fa=Fa.documents?Fa.documents.items:[],(ua=M.a(Fa,!1))&&(Ta=I.c(ua)));k.AFrameworkApplication.sa&&k.AFrameworkApplication.sa.Qa.UZ&&Y.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(Ta,
!0));Ta=ba.a.Pr();this.ira&&(Ta&&this.ira.Osc&&(Ta.set("LastError",this.ira.Osc),Ta.set("NumRetries",this.ira.retryCount.toString())),this.ira.reset());ua||Da||fa?(this.nD.XNa("MruActor.GetMruV2FromServerSuccessCallback",Ma.data,"Success"),this.pEc(3,ua,Da,fa),this.OCi(Ma.data,Ta)):(this.nD.XNa("MruActor.GetMruV2FromServerSuccessCallback",Ma.data,"Failure: Invalid JSON"),Ta&&this.BWc(Ma.data,Ta),P.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new ra.a,{extendedProperties:Ta})),
this.pEc(3,null,null,null,!0));this.Y9c(this.PS)}eaf(Ma,Ta,Da,fa){let ua=0,Fa=0;const ca=M.c(Ta.data.de);ca&&(null!=ca.response_code&&(ua=ca.response_code,fa&&fa.set("MruResponseCode",ua.toString()),9===ua&&(this.SVb="")),ca.error_data&&null!=ca.error_data.retry_after_ms&&(Fa=ca.error_data.retry_after_ms,fa&&fa.set("ExpectedRetryAfter",Fa.toString())));Ma&&(Ta=Ma.Tii(Da,Fa,Ta.data.httpStatus,ua),fa&&(fa.set("CurrentRetryCount",Ma.retryCount.toString()),fa.set("RetryScheduled",Ta?"true":"false")))}iZh(Ma){this.lZh(Ma)}lZh(Ma){const Ta=
Ma.data.httpStatus===aa.a.nIb,Da=ba.a.Pr();Da&&(Da.set("StatusCode",Ma.data.httpStatus.toString()),Ta||this.BWc(Ma.data,Da));this.nD.XNa("MruActor.GetMruFromServerFailureCallback",Ma.data,"Failure");this.pEc(2);this.eaf(this.ira,Ma,Object(c.a)(this,this.jZh,"getMruFromServerRetryTask"),Da);P.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",Ma.data.httpStatus),Ta,!1,Object.assign(new ra.a,{extendedProperties:Da}));this.Y9c(this.PS);k.AFrameworkApplication.sa&&k.AFrameworkApplication.sa.Qa.UZ&&
Y.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)))}pEc(Ma,Ta=null,Da=null,fa=null,ua=!1){if(3!==this.PS.state||3===Ma)this.PS.Mee=Ta,this.PS.Nee=Da,this.PS.Lee=fa,this.PS.state=Ma,this.PS.RMc=ua,this.PS.Ele=this.nD.jw()}xHf(Ma,Ta){e.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:Ma,["ResultState"]:this.PS.state});Ta&&3===this.PS.state&&this.mPe(Ta,this.PS);return this.PS}Gdh(Ma,Ta){this.pEc(1);
let Da;const fa={};Da=String.format(this.nD.t_+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.r0e(),this.localeName);this.zCg.value||(Da+="&entity=docs");k.AFrameworkApplication.Rb&&(fa["X-Office-AudienceGroup"]=Object(N.a)(String,k.AFrameworkApplication.Rb.AudienceGroup)||"");this.Sme?fa["X-FileId"]=k.AFrameworkApplication.vi:Da+=String.format("&{0}",k.AFrameworkApplication.vi);this.nD.gFb.Jm(Da,1,null,fa,!0,5,Ma,Ta,null)}get nD(){return this.G1.value}get localeName(){return this.iAg.value}static get instance(){return O.La||
(O.La=O.BM())}static BM(){return new O(new b.a(()=>x.instance),new b.a(()=>ea.a.NJ(k.AFrameworkApplication.lcid).name),new b.a(()=>k.AFrameworkApplication.sa.Qa.tv),k.AFrameworkApplication.fa.pa("MruWriteFileIdInHeader"),()=>k.AFrameworkApplication.sa.Qa.Bx,()=>k.AFrameworkApplication.om,new b.a(()=>k.AFrameworkApplication.fa.pa("OICEncodeUrlIsEnabled")))}}O.La=null;Object(r.a)(O,"MruActor",f,[]);class da{constructor(){this.hnb=this.Lhe=this.$a=null;this.Gm=!1}get name(){return"Common.App.NewAndOpen.Core"}Bh(Ma){this.$a=
Ma;Ma.register(709,"Common.INewAndOpenCommonHelpers").qc().yc(()=>x.instance);Ma.register(710,"Common.IEventEmitter<Common.IGetMoreInfoResult>").qc().yc(()=>S.instance);Ma.register(710,"Common.IEventEmitter<Common.IMruResult>").qc().yc(()=>O.instance)}init(){k.AFrameworkApplication.fa.ru(()=>{this.Kzb()})}Kzb(){this.$a.resolve("Common.INewAndOpenCommonHelpers");this.$a.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.$a.resolve("Common.IEventEmitter<Common.IMruResult>");var Ma=!1;x.instance.ufj();
k.AFrameworkApplication.Pla&&(Ma=!0);k.AFrameworkApplication.bSf&&(O.instance.bGi(),0<k.AFrameworkApplication.Cwf&&this.Toe(),this.xDj(),Ma=!0);k.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage&&Ma&&S.instance.$Fi();k.AFrameworkApplication.a1j&&(Ma=O.instance,Ma.ohj(),Ma.jGi(),G.a.instance.fg(this.b1j))}xDj(){E.instance.ooe(Object(c.a)(O.instance,O.instance.aGi,"makeGetMruRequestActivityTrigger"));E.instance.ooe(Object(c.a)(this,this.Toe,"addGetMruFromServerTask"));E.instance.RJg(Object(c.a)(this,
this.flh,"deleteGetMruFromServerTask"))}flh(){G.a.instance.Uo(this.Dwf)}Toe(){G.a.instance.fg(this.Dwf)}get Dwf(){return this.Lhe||(this.Lhe=new B.a(5,2,k.AFrameworkApplication.Cwf,Object(c.a)(O.instance,O.instance.kZh,"getMruFromServerTask"),109))}get b1j(){return this.hnb||(this.hnb=new B.a(2,2,6E4*k.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(c.a)(O.instance,O.instance.kGi,"makeUpdateMruTask"),197))}dispose(){this.Gm||(this.Gm=
!0,this.hnb&&(G.a.instance.Uo(this.hnb),this.hnb=null))}}Object(r.a)(da,"CorePackageManager",null,[3,4,2]);var xa=a(251);a.d(F,"a",function(){return ia});const ia=()=>{Type.registerNamespace("Common.App.NewAndOpen.Core");xa.a.instance.ii(new da)}},1192:function(r,F,a){r=a(0);var c=a(4),b=a(226),e=a(15),f=a(85),d=a(54),h=a(201);class l{constructor(){this.Cje=this.ZSc=!1;const qa=c.AFrameworkApplication.qk;0>=qa||(this.qk=qa,e.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",
{["AccessTokenTtl"]:this.qk,["NowGetTime"]:(new Date).getTime(),["BootTime"]:c.AFrameworkApplication.hha}),h.a.instance.RXc(Object(f.a)(this,this.hPa,"onSessionExpiredDetected")),h.a.instance.PXc(Object(f.a)(this,this.tIf,"onSessionExpiringDetected")))}hPa(){h.a.instance.uMd(Object(f.a)(this,this.hPa,"onSessionExpiredDetected"));e.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.nai()}tIf(){h.a.instance.tMd(Object(f.a)(this,this.tIf,"onSessionExpiringDetected"));this.Cje||this.ZSc||
(e.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.Cje=!0,this.vKj())}nai(){this.ZSc||(c.AFrameworkApplication.CF(d.a.Kxc),this.ZSc=!0,this.uKj())}}Object(r.a)(l,"ASessionExpirationManager",null,[]);var k=a(89),t=a(38),n=a(29),z=a(13),w=a(45),m=a(253),u=a(6),y=a(82),v=a(256),C=a(73);class x extends l{constructor(qa){super();this.Pa=new t.a;this.VG=this.anb=!1;this.$=qa}ure(qa){this.Pa.addHandler("SessionExpired",qa)}uob(qa){this.Pa.addHandler("TokenRefreshed",
qa)}Wuc(qa){this.Pa.removeHandler("TokenRefreshed",qa)}get accessTokenExpiringMessage(){const qa=(new Date(this.qk)).format(this.$.ya.ShortTimeFormat);return String.format(z.a.instance.ob(78),qa)}get tokenExpired(){return this.anb}get ieb(){return!1}get Mba(){return!1}get xKd(){return!1}get o5(){return!1}Oec(){return h.a.instance.SQ(c.AFrameworkApplication.qk)}dispose(){k.a.Ja(this.Pa);this.$=null}vKj(){this.$.isEditMode&&this.nec(!1)}uKj(){this.anb=!0;this.nec(!0);this.Pa.raiseEvent("SessionExpired")}nec(qa){e.ULS.sendTraceTag(537170715,
0,15,`EwaAccessTokenExpirationManager.HandleAccessTokenExpirationDialog: isExpired ${qa}, GotDeploymentOrTimedOutError ${this.$.ea.xZ}`);const La=this.$.qb.To;qa&&La&&La.isVisible&&1299163859===La.error.MessageId&&this.$.qb.To.dv();const Yb=this.ed(qa);w.a(this.$).vr(new m.a(u.a.hw,5,()=>{const mc=C.a(this.$),Zb=mc.gd.activityState;Zb[y.a.d2]=this.$.qqb(this.$.isEditMode);Zb[y.a.QL]=y.a.P9a;Zb[v.a.Dp]=u.a.accessTokenExpiringWarning;mc.gd.Yq([Yb])}))}ed(qa){return qa?n.a.aJe():this.Vgh()}Vgh(){const qa=
n.a.ed(12,1,0,0,0,1299163859,"AccessTokenExpiringWarning");qa.Description=this.accessTokenExpiringMessage;return qa}}Object(r.a)(x,"EwaAccessTokenExpirationManager",l,[260,261,2]);var B=a(7),H=a(174),I=a(79),U=a(649),S=a(28);class G{constructor(qa,La){this.jJb=!1;this.correlationID=qa;this.Q6c=La;this.FCc=!1;this.creationTime=S.a.Ya.Ub}}Object(r.a)(G,"RefreshAccessTokenContext",null,[]);var D=a(59),E=a(60),N=a(163),M=a(44),L=a(112),aa=a(120),V=a(1),P=a(22),ba=a(147),Y=a(36),Z=a(119);class ea{}Object(r.a)(ea,
"Error",null,[]);class ra{}Object(r.a)(ra,"NamedResult",null,[]);class O extends ra{}Object(r.a)(O,"ErrorInfo",ra,[]);class da{constructor(qa,La){this.PYb=qa;this.kG=La}get tokens(){return this.PYb}get errors(){return this.kG}}Object(r.a)(da,"TokenRefreshArgs",null,[255]);class xa{constructor(qa,La){this.documentVisibilityObserver=null;this.Pa=new t.a;this.wx=null;this.afb=this.Zlb=!1;this.Qtc=null;this.qJb=!1;this.sxd=!0;this.Mce=this.ice=this.VG=this.anb=!1;this.AS=null;this.U$e=()=>{if(this.$.ea.Xb)this.saf(!1);
else if(this.sxd){this.sxd=!1;const Yb=C.a(this.$);e.ULS.sendTraceTag(537170709,0,50,`EwaAccessTokenExpirationRefreshManager.HandleOnTokenExpiring - session is not active - postponing refresh current-activity [${Yb.Th?Yb.Th.activityName:"None"}] TimeUntilTokenExpirationInMin [${this.Yeg()}]`)}};this.Rc=(Yb,mc)=>{this.context&&(Yb=this.$.ea,mc.oH&&this.context.jJb&&!this.context.FCc?(this.context.FCc=!0,mc={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - reconnect"},mc.IsUserActive=
Yb.Be.rr,mc.RefreshAccessTokenCorrelationID=this.context.correlationID,mc=D.a.Dc(mc),e.ULS.sendTraceTag(537170708,0,50,mc)):!this.Zlb||Yb.Xb||this.context.Q6c||(mc={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - consider abort ongoing refresh due to reopen"},this.wx&&(this.wx.cancel(),mc.Aborted=!0,mc.ResetStopRefreshRetriesUntilTokenExpired=!0,this.afb=!1),mc.TimeUntilTokenExpirationInMin=this.Yeg(),mc.RefreshAccessTokenCorrelationID=this.context.correlationID,mc=D.a.Dc(mc),e.ULS.sendTraceTag(572019856,
0,50,mc)))};this.Mya=()=>{if(this.context&&this.context.jJb&&!this.context.FCc){var Yb={Name:"EwaAccessTokenExpirationRefreshManager.OnOpenWorkbookFailed"};Yb.CreatedForExpired=this.context.Q6c;Yb.RefreshAccessTokenCorrelationID=this.context.correlationID;Yb.OpenWorkbookErrors=n.a.nc(this.$.ea.rF);Yb.ExecutionContextErrors=n.a.nc(C.a(this.$).gd.errors);Yb.accesstokenTTL=c.AFrameworkApplication.qk;Yb=D.a.Dc(Yb);e.ULS.sendTraceTag(537170707,0,15,Yb)}};this.raf=()=>{this.afb=!1;this.saf(!0)};this.QEd=
()=>{this.qJb&&(this.$.ea.Be.Yza(this.QEd),this.qJb=!1);this.Abg()};this.$=qa;this.ZYd=La;this.uKd=qa.Jb.zg("WebServiceCall","refreshToken");h.a.instance.RXc(this.raf);h.a.instance.PXc(this.U$e);La=this.$.ea;La.Jj(this.Rc);La.X_b(this.Mya);this.NIi=this.$.ya.MinTokenLifetimeForRegularExpirationPromptInMin;this.R7f=this.$.ya.ShortAccessTokenExpirationPromptSeconds;this.rTf=this.$.ya.RefreshAccessTokenDurationLimitInSec;this.Ykg(qa.ea.wLf,c.AFrameworkApplication.qk);qa=JSON.stringify({["AccessTokenTtl"]:c.AFrameworkApplication.qk,
["NowGetTime"]:(new Date).getTime(),["BootTime"]:c.AFrameworkApplication.hha,["WopiTokenExpiresAfterMinutes"]:c.AFrameworkApplication.E2d,["WopiTokenTaskItemPriority"]:c.AFrameworkApplication.G2d});e.ULS.sendTraceTag(537170714,217,50,`Initializing EwaAccessTokenExpirationRefreshManager. ${qa}`);this.$.da.gb(291,Yb=>{this.documentVisibilityObserver=Yb})}ure(qa){this.Pa.addHandler("SessionExpired",qa)}uob(qa){this.Pa.addHandler("TokenRefreshed",qa)}Wuc(qa){this.Pa.removeHandler("TokenRefreshed",qa)}get tokenExpired(){return this.anb}get Mba(){return this.ice}get o5(){return this.Mce}get context(){return this.AS}get ieb(){return this.o5?
!1:this.$.ea.Be.rr?1>Z.a.S5:6>Z.a.T5}get xKd(){return this.Zlb}Oec(){return h.a.instance.SQ(c.AFrameworkApplication.qk)}dispose(){h.a.instance.uMd(this.raf);h.a.instance.tMd(this.U$e);const qa=this.$.ea;qa&&(qa.ik(this.Rc),qa.Yuc(this.Mya));k.a.Ja(this.Pa);this.documentVisibilityObserver=this.$=null}Yeg(){return this.Oec()?0:(c.AFrameworkApplication.qk-(new Date).getTime())/6E4}Ykg(qa,La){if(0<La&&!this.Oec()){const Yb=c.AFrameworkApplication.fa.vd("AccessTokenExpirationPromptSeconds",c.AFrameworkApplication.XX),
mc=(La-qa.getTime())/6E4;e.ULS.shipAssertTag(537170713,0,0<=mc,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime the access-token expiration time should be after token creation time accessTokenTTL [${La}] creationTime [${qa.getTime()}] tokenLifetimeInMin [${mc}]`);mc<this.NIi?(e.ULS.sendTraceTag(537170712,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${this.R7f}] tokenLifetimeInMin [${mc}]`),c.AFrameworkApplication.XX=this.R7f):
c.AFrameworkApplication.XX!==Yb&&(e.ULS.sendTraceTag(537170711,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${Yb}] tokenLifetimeInMin [${mc}]`),c.AFrameworkApplication.XX=Yb)}}lbh(qa){return!this.context||this.context.jJb||this.context.Q6c!==qa?(qa=new G(H.a.create().toString(),qa),this.context&&!this.context.FCc&&e.ULS.sendTraceTag(537170710,0,15,`TokenManager.InitContext: creating new context [${qa.correlationID}] although previeous one [${this.context.correlationID}] not used successfully, isPreviousOneRefreshedSuccessfully [${this.context.jJb}] `),
this.AS=qa,!0):!1}Goj(qa){qa&&this.VG&&!this.Mba&&this.$.ea.Be.rr&&!this.o5&&(this.VG=!1)}saf(qa){this.Goj(qa);if(!(this.Zlb||this.afb&&!qa||this.VG)&&this.ieb){this.Zlb=!0;var La=this.context?this.context.creationTime:null,Yb=this.lbh(qa);this.sxd=!0;var mc=this.$.ea,Zb={Name:"EwaAccessTokenExpirationRefreshManager.HandleTokenRefresh"};Zb.newContextCreated=Yb;Zb.IsUserActive=mc.Be.rr;Zb.IsSessionActive=mc.Xb;Zb.ContainsChangesWorkbookOperations=this.$.userOperationManager.PHa();Zb.isSessionExpired=
qa;Zb.stopRefreshRetriesUntilTokenExpired=this.afb;Zb.FailedToRefreshExpiredToken=this.VG;Zb.numOfFailuresWhileUserIsActive=Z.a.S5;Zb.numOfFailuresWhileUserIsInActive=Z.a.T5;Zb.numOfFailuresWhileOffline=Z.a.qya;Zb.RefreshAccessTokenCorrelationID=this.context.correlationID;Yb&&La&&(Zb.TimeInMinFromPreviosContextCreation=Math.round(aa.b(S.a.Ya,La)/60));La=D.a.Dc(Zb);e.ULS.sendTraceTag(40416199,0,50,La);this.uKd.start();this.ice=mc.Be.rr;this.wx=new U.a;this.eAi(qa);var qb=this.ZYd.ffj(!qa,this.wx?this.wx.token:
null);qb.continueWith(()=>{this.U4g();const Ha=this.ZYd.g$i(qb);this.uKd.stop();const Ya=this.Oec();if(!Ha||V.EwaSettings.isChangeGateEnabled("OfficeVSO:5348973_FishbowlFixDuringTokenRefresh")&&Ya){const Gb=qb.result.errors;Ha&&Ya&&this.aJg(Gb);this.U$h(Gb,qa)}else this.afb=!1,this.W$h(qb.result.tokens,qa);this.Zlb=!1},8)}}aJg(qa){const La=[Object(B.a)(new ea,{Id:"200",Details:"Expired accesstoken recieved on successful token request."})];qa.add(Object(B.a)(new O,{Name:"ExpiredTokenAfterSuccessfulRefresh",
Errors:La}))}eAi(qa){qa&&(this.$.ea.Be.rr?this.Abg():(this.$.ea.Be.A9(this.QEd),this.qJb=!0))}Abg(){this.Qtc=N.AsyncMethodContext.vq(()=>{this.efj()},1E3*this.rTf,M.a.Nej,this.Qtc)}U4g(){this.Qtc&&this.Qtc.cancel();this.qJb&&(this.$.ea.Be.Yza(this.QEd),this.qJb=!1);this.wx=null}efj(){e.ULS.sendTraceTag(537170706,0,15,`EwaAccessTokenExpirationRefreshManager.RefreshTokenDurationThresholdReached durationLimitInSec [${this.rTf}]`);this.wx.cancel()}U$h(qa,La){this.afb=!0;La&&(this.VG||(this.anb=this.VG=
!0),this.ZYd.CBb(qa)&&(this.Mce=!0));const Yb=!La||this.ieb&&!Z.a.vzc?40380379:39982555;La=this.CHe(La);La.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshError";La.FailedToRefreshExpiredToken=this.VG;La.LastErrorIsPermanent=this.o5;if(0<qa.count){var mc=qa.ma(0);La.errorName=mc.Name;0<mc.Errors.length&&(La.ErrorId=mc.Errors[0].Id,mc=mc.Errors[0].Details,La.ErrorDetails=this.hph(mc.toString())?"PiiScrubbed":mc)}La=D.a.Dc(La);e.ULS.sendTraceTag(Yb,0,15,La);this.Pa.raiseEvent("TokenRefreshed",
new da(null,qa))}hph(qa){return P.a.contains(qa,"makes the internet safe for businesses",!0)}CHe(qa){const La={},Yb=this.$.ea;La.Name="";La.IsUserActive=Yb.Be.rr;La.IsSessionActive=Yb.Xb;La.GotDeploymentOrTimedOutError=Yb.xZ;La.TimeInSecFromLastStatefulSuccessfulRequest=Yb.VW;La.TimeFromLastUserActivityInMs=Yb.Be.yfb;La.calledFromSessionExpiredFlow=qa;La.RefreshTokenDurationInMS=this.uKd.Bc;La.numOfFailuresWhileUserIsActive=Z.a.S5;La.numOfFailuresWhileUserIsInActive=Z.a.T5;La.numOfFailuresWhileOffline=
Z.a.qya;La.RefreshAccessTokenCorrelationID=this.context.correlationID;La.accessTokenTTL=c.AFrameworkApplication.qk;La.ContainsChangesWorkbookOperations=this.$.userOperationManager.PHa();La.IsDocumentHidden=this.documentVisibilityObserver?this.documentVisibilityObserver.Wh.toString():"Unknown";La.TimeFromFirstOpenInHr=Math.floor(aa.b(S.a.Ya,L.toUtc(Yb.wLf))/3600);return La}W$h(qa,La){this.VG=!1;this.F2j();this.Ykg(new Date,c.AFrameworkApplication.qk);const Yb=this.$.ea,mc=!La&&Yb.Be.rr,Zb=!this.$.isEditMode&&
Yb.Nbb;La=this.CHe(La);La.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess";La.shouldTriggerSilentReloadAfterExpiring=mc;La.WopiTokenTaskItemPriority=c.AFrameworkApplication.G2d;La.isDirtyViewSession=Zb;La=D.a.Dc(La);e.ULS.sendTraceTag(39982556,0,15,La);this.Pa.raiseEvent("TokenRefreshed",new da(qa,null));Zb?Yb.Be.rr&&(e.ULS.sendTraceTag(537170705,0,15,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: User active after refresh dirty view session. trigger request to connect the same server."),
Yb.Ldd()):Yb.Be.rr?mc&&(qa=C.a(this.$).gd.activityState,qa[Z.a.Tfb]=!0,qa[ba.a.aY]=!0,qa[Y.a.Kr]=this.$.isEditMode,w.a(this.$).vr(new m.a(u.a.Dna,2,null))):Yb.Xb&&E.j(this.$.oa.xa,!0,!1,!1,null,null,null,null,null)}F2j(){void 0!==this.$.ea.workbookContext.WorkbookUri&&null!==this.$.ea.workbookContext.WorkbookUri?(this.$.ea.workbookContext.WorkbookUri=I.a.lT(this.$.ea.workbookContext.WorkbookUri,c.AFrameworkApplication.fP,c.AFrameworkApplication.accessToken),this.$.ea.workbookContext.WorkbookUri=I.a.lT(this.$.ea.workbookContext.WorkbookUri,
c.AFrameworkApplication.YX,c.AFrameworkApplication.qk.toString()),this.$.ea.Qqc()):e.ULS.sendTraceTag(537170704,0,15,"EwaAccessTokenExpirationRefreshManager.UpdateTokensAtContext: WorkbookUri is null");this.$.ya.AccessToken=c.AFrameworkApplication.accessToken;this.$.ya.AccessTokenValidTo=c.AFrameworkApplication.qk;void 0!==this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion&&null!==this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion&&(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion=
I.a.lT(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion,c.AFrameworkApplication.fP,c.AFrameworkApplication.accessToken),this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion=I.a.lT(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion,c.AFrameworkApplication.YX,c.AFrameworkApplication.qk.toString()));void 0!==this.$.ya.EmbedConfiguratorUrl&&null!==this.$.ya.EmbedConfiguratorUrl&&(this.$.ya.EmbedConfiguratorUrl=I.a.lT(this.$.ya.EmbedConfiguratorUrl,c.AFrameworkApplication.fP,c.AFrameworkApplication.accessToken),
this.$.ya.EmbedConfiguratorUrl=I.a.lT(this.$.ya.EmbedConfiguratorUrl,c.AFrameworkApplication.YX,c.AFrameworkApplication.qk.toString()));this.context.jJb=!0}}Object(r.a)(xa,"EwaAccessTokenExpirationRefreshManager",null,[260,261,2]);var ia=a(192),Ma=a(160),Ta=a(84),Da=a(421);class fa{}fa.TZb="ActivityDuration";fa.error="Error";fa.Y$c="Errors";fa.failed="Failed";fa.dIh="FirstActivity";fa.initialized="Initialized";fa.qyi="LastActivity";fa.f_f="RetryOverride";fa.foj="RequestGroups";fa.requests="Requests";
fa.SZf="Responses";fa.Lxc="SessionDuration";fa.status="Status";fa.success="Success";fa.successful="Successful";fa.tokens="Tokens";Object(r.a)(fa,"SessionExpirationStrings",null,[]);var ua=a(109);class Fa{constructor(qa){this.Jo={};this.lX={};this.WBg={};this.Urf=15;this.dce=!1;this.FDg=new Date;this.kVb=new Date;this.he=qa;this.CYb=new ua.a(2,2,6E4*this.Urf,Object(f.a)(this,this.Zng,"writeMeasures"),135,"SL",!1);this.he.fg(this.CYb);this.Thi()}Zng(){e.ULS.sendTraceTag(41964821,217,50,e.ULS.Dc({["Aggregate"]:this.lX,
["Current"]:this.Jo}))}Thi(){this.lX[fa.foj]=0;this.lX[fa.requests]=0;this.lX[fa.SZf]=0;this.lX[fa.status]=fa.initialized;this.lX[fa.dIh]=new Date;this.lX[fa.Lxc]=0;this.lX[fa.TZb]=0;this.lX[fa.Lxc]=0;this.Jo[fa.Lxc]=0;this.lX[fa.TZb]=0;this.Jo[fa.TZb]=0}wnd(qa,La){var Yb=qa[La];Yb=Yb?Yb:0;Yb++;qa[La]=Yb;this.NRd(qa)}NRd(qa){const La=new Date;qa[fa.TZb]=+La-+this.kVb;this.kVb=La;qa[fa.Lxc]=+this.kVb-+this.FDg;qa[fa.qyi]=this.kVb}s0(qa,La){this.Jo[qa]=La;this.NRd(this.Jo)}kRd(qa,La){this.Jo[qa]=La;
this.NRd(this.Jo)}incrementCounter(qa){this.wnd(this.Jo,qa);this.wnd(this.lX,qa);this.wnd(this.WBg,qa)}flush(){this.dce||(this.lX[fa.status]=this.Jo[fa.status],this.Zng(this.CYb),this.he.hna(this.CYb,6E4*this.Urf))}stop(){e.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.dce=!0;this.he.Uo(this.CYb)}}Object(r.a)(Fa,"SessionLogger",null,[321]);var ca=a(99),ka=a(650),Ca=a(30),fb=a(378),yb=a(168),mb=a(956),nb=a(194),X=a(148);class R{constructor(qa,La,Yb,
mc=null,Zb=!1,qb=null,Ha=!1,Ya=!1){this.d9=0;this.U1=this.Ki=null;this.PYb=new ia.a;this.kG=new ia.a;this.Ck=null;this.FWa=!1;this.cnb=this.dnb=null;this.he=qa;this.bhe=La;this.bhe.execute(Gb=>{Gb.Dl(yb.a.Cmd,Object(f.a)(this,this.bVi,"onHostResponseReceived"))});this.sG=Yb;this.Fle=new mb.a("WebServiceCall","TokenRefresh");this.nk=mc||new Fa(qa);this.ADg=Zb;this.aT=qb?qb:ka.SessionStatusManager.instance;this.R8d=Ha;this.ETb=Ya}bVi(qa){if(qa.MessageId!==yb.a.Cmd)X.a(39408099,306,15,"Unexpected message.");
else{var La=new ia.a,Yb=new ia.a;this.nk.incrementCounter(fa.SZf);var mc=qa.Values[fb.a.z3f];if(!mc||0>=mc.length)X.a(40122317,306,15,"Found no tokens in the dictionary"),mc=qa.Values;X.a(40122318,306,100,"The Tokens array contains {0} tokens",mc.length);this.nk.s0("Correlation",qa.CorrelationId);var Zb="";for(let Ya=0;Ya<mc.length;Ya++){this.nk.kRd(fa.tokens,mc.length);var qb=mc[Ya],Ha=qb;if(!Ha||!Ha.Name)continue;this.nk.incrementCounter(Ha.Name);const Gb=qb;if(Gb&&Gb.Value)X.a(39408128,306,100,
"Received token with name: {0}",Gb.Name),La.add(Gb),this.PYb.add(Gb),this.ETb||this.nk.s0(fa.status,fa.success),this.R8d&&this.aT&&this.aT.fpj();else if(qb=this.Q2h(qb),X.a(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",Ha.Name,JSON.stringify(qb),this.U1),Yb.add(qb),this.ETb||(this.kG.add(qb),Zb=JSON.stringify(qb),this.nk.s0(fa.error,JSON.stringify(qb)),this.nk.s0(fa.status,fa.failed)),this.R8d)for(const Ja of qb.Errors)Ha=this.zUh(Ja),this.aT&&this.aT.nLg(Ha)}this.ETb?
(0<Yb.count?this.cnb?this.cnb(new da(La,Yb)):X.a(512267295,306,15,"Received errors but the promise has completed"):this.dnb?this.dnb(new da(La,Yb)):X.a(512267294,306,15,"Received valid tokens but the promise has completed"),X.a(512344162,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",La.count,Yb.count,qa.CorrelationId,this.U1)):(0<Yb.count&&""!==Zb?(mc=Object.assign(new nb.a,{extendedProperties:new Map}),mc.extendedProperties.set("Errors",Zb),mc.extendedProperties.set("RetryCount",
this.d9.toString()),mc.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),mc.extendedProperties.set("IsTokenExpiring",this.FWa.toString()),ca.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,mc)):ca.Health.instance.recordKpiSuccess("WACTokenRefresh",null),X.a(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",La.count,Yb.count,qa.CorrelationId,this.U1),0<Yb.count&&!this.CBb(Yb)?(qa=this.sG.P6e(Yb),
qa!==this.sG.Zcb&&(this.nk.kRd(fa.f_f,qa),this.he.hna(this.Ki,qa))):(this.nk.flush(),this.Ki&&(X.a(39408131,306,100,"Deleting task {0} from task manager",this.Ki.name),this.he.Uo(this.Ki)),this.Ck&&!this.Ck.task.isCompleted?this.Ck.setResult(new da(La,Yb)):X.a(512267293,306,15,"Received results but the task has completed")))}}Q2h(qa){if(!qa)return null;const La=Object.assign(new O,{Name:qa.Name,Errors:[]});for(const Yb of qa.Errors)qa=new ea,qa.Id=Yb.Id,qa.Details=Ca.a.Mid(Yb.Details,500),La.Errors.push(qa);
return La}requestTokensOnce(){this.$Yf()}$Yf(){c.AFrameworkApplication.ula("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.d9>=this.sG.mvf?(X.a(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.U1),this.IHe(this.Ck,"TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts")):(ca.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.K2f())}K2f(){const qa={};qa[fb.a.z3f]=this.sG.tokens;
const La=H.a.create().toString();X.a(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.sG.tokens),this.d9+1,La,this.U1);this.bhe.execute(Yb=>{Yb.jj(yb.a.Mte,qa,La)});this.d9++;this.nk.incrementCounter(fa.requests)}IHe(qa,La,Yb){const mc=new ia.a;for(let Zb=0;Zb<this.sG.tokens.length;Zb++){const qb=Object.assign(new O,{Name:this.sG.tokens[Zb],Errors:[Object.assign(new ea,{Id:La,Details:Yb})]});mc.add(qb);this.kG.add(qb)}this.he.Uo(this.Ki);this.nk.s0(fa.Y$c,
JSON.stringify(this.kG));this.nk.s0(fa.status,fa.failed);qa&&!qa.task.isCompleted&&qa.setResult(new da(new ia.a,this.kG))}ffj(qa,La=null){c.AFrameworkApplication.ula("258ec738;j5j99381");c.AFrameworkApplication.ula("85gid169;g470d326");this.Fle.start();this.FWa=qa;this.U1=H.a.create().toString();X.a(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.U1,this.FWa);this.d9=0;this.kG.clear();this.PYb.clear();const Yb=new Ma.a;this.Ck=Yb;La&&La.R(()=>{const mc=!!Yb&&!Yb.task.isCompleted;
X.a(588096223,306,50,"RefreshTokens Cancelled, TaskId: [{0}]. IsTokenExpiring: [{1}]. isTaskStillRunning [{2}].",this.U1,this.FWa,mc);mc&&this.IHe(Yb,"ABORTED_BY_CALLER","The refresh was aborted by the caller")});this.ETb?this.aZf(this.sG.mvf).then(mc=>{this.Ck&&!this.Ck.task.isCompleted&&this.Ck.setResult(mc);this.cnb=this.dnb=null;this.nk.s0(fa.Y$c,JSON.stringify(this.kG));this.nk.s0(fa.status,fa.success);this.nk.flush()}).catch(mc=>{this.Ck&&!this.Ck.task.isCompleted&&this.Ck.setResult(Object(Ta.a)(255,
mc));this.cnb=this.dnb=null;this.nk.s0(fa.Y$c,JSON.stringify(this.kG));this.nk.s0(fa.status,fa.failed);this.nk.flush()}):(this.Ki=new ua.a(this.sG.priority,2,this.sG.Zcb,Object(f.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,yb.a.Mte,!0),this.ADg&&this.$Yf(),this.he.fg(this.Ki));return this.Ck.task}aZf(qa){const La=this,Yb=new Promise((Ya,Gb)=>{La.dnb=Ya;La.cnb=Gb;ca.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null);La.K2f()}),mc=this,Zb=new Promise((Ya,Gb)=>{window.setTimeout(()=>
{Gb(mc.NHe("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},mc.sG.Zcb)});let qb=qa;const Ha=this;return new Promise((Ya,Gb)=>{qb--;Promise.race([Yb,Zb]).then(Ja=>{ca.Health.instance.recordKpiSuccess("WACTokenRefresh",null);Ya(Ja)}).catch(Ja=>{var Na=Ha.sG.Zcb;if(Object(Da.a)(255,Ja)&&(Ja=Object(Ta.a)(255,Ja),0<Ja.errors.count)){Ha.wCi(Ja.errors);Ha.Yq(Ja.errors);if(Ha.CBb(Ja.errors)){Gb(Ja);return}const Qa=Ha.sG.P6e(Ja.errors);Qa!==Ha.sG.Zcb?(Ha.nk.kRd(fa.f_f,
Qa),Na=Qa):Ha.Qvi(Ja.errors)&&(Na=0)}qb?window.setTimeout(()=>{Ha.aZf(qb).then(Ya).catch(Gb)},Na):(Na=Ha.NHe("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),Ha.Yq(Na.errors),Gb(Na),X.a(512267292,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",Ha.U1))})})}Yq(qa){for(let La of qa)this.kG.add(La)}Qvi(qa){if(!qa.count)return!1;qa=qa.ma(qa.count-1);return qa.Errors.length?"TIMEOUT"==qa.Errors[0].Id:!1}NHe(qa,La){const Yb=
new ia.a;for(let mc=0;mc<this.sG.tokens.length;mc++){const Zb=this.cdh(this.sG.tokens[mc],qa,La);Yb.add(Zb)}return new da(new ia.a,Yb)}cdh(qa,La,Yb){return Object.assign(new O,{Name:qa,Errors:[Object.assign(new ea,{Id:La,Details:Yb})]})}wCi(qa){if(qa.count){qa=qa.ma(qa.count-1);qa=JSON.stringify(qa);var La=Object.assign(new nb.a,{extendedProperties:new Map});La.extendedProperties.set("Errors",qa);La.extendedProperties.set("RetryCount",this.d9.toString());La.extendedProperties.set("NavigatorOnline",
window.navigator.onLine.toString());La.extendedProperties.set("IsTokenExpiring",this.FWa.toString());ca.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,La);this.nk.s0(fa.error,qa);this.nk.s0(fa.status,fa.failed)}}g$i(qa){this.Fle.stop();const La=this.jbi(qa.result.errors);e.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",
!La,this.U1,this.FWa,this.d9,this.kG.count,0<qa.result.errors.count?qa.result.errors.ma(0).Name:"",0<qa.result.errors.count&&0<qa.result.errors.ma(0).Errors.length?qa.result.errors.ma(0).Errors[0].Id:"",0<qa.result.errors.count&&0<qa.result.errors.ma(0).Errors.length?qa.result.errors.ma(0).Errors[0].Details:"");return La?!1:this.f$i(qa.result.tokens)}CBb(qa){return this.sG.CBb(qa)}f$i(qa){for(let La=0;La<qa.count;La++){const Yb=qa.ma(La);if(Yb.Name===fb.a.accessToken){const mc=(new Date).getTime();
Yb.Expiry>c.AFrameworkApplication.qk?(e.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:Yb.Expiry,["NowGetTime"]:mc,["BootTime"]:c.AFrameworkApplication.hha},"PreviousAccessTokenTtl",c.AFrameworkApplication.qk),c.AFrameworkApplication.accessToken=Yb.Value,c.AFrameworkApplication.qk=Math.floor(Yb.Expiry),c.AFrameworkApplication.F2d=mc,c.AFrameworkApplication.uYa=Math.floor(Yb.Expiry)):e.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",
{["AccessTokenTtl"]:Yb.Expiry,["NowGetTime"]:mc,["BootTime"]:c.AFrameworkApplication.hha},"PreviousAccessTokenTtl",c.AFrameworkApplication.qk)}}return!0}jbi(qa){let La=!1;for(let Yb=0;Yb<qa.count;Yb++){La=!0;const mc=qa.ma(Yb);e.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",mc.Name,JSON.stringify(mc.Errors),this.U1)}return La}zUh(qa){let La=d.a.Kxc;qa=parseInt(qa.Id);if(isNaN(qa))La=d.a.T6j;else{switch(qa){case 401:La=d.a.W6j;break;case 403:La=d.a.R6j;
break;case 500:La=d.a.S6j;break;case 503:La=d.a.V6j}La===d.a.Kxc&&(La=500<qa?d.a.U6j:d.a.Q6j)}return La}}Object(r.a)(R,"TokenRefreshManager",null,[256]);class wa{constructor(){this.Zcb=c.AFrameworkApplication.Z6j;this.mvf=c.AFrameworkApplication.X6j;this.tokens=c.AFrameworkApplication.G7h();this.priority=c.AFrameworkApplication.G2d;this.kie=this.gBj();this.sVc=c.AFrameworkApplication.F7h()}CBb(qa){qa=JSON.stringify(qa);if(this.sVc&&0<this.sVc.length)for(const La of this.sVc)if(0<La.length&&0<=qa.indexOf(La))return!0;
return!1}P6e(qa){try{if(qa)for(let La of qa)if(La.Errors)for(const Yb of La.Errors)if(Yb.Id in this.kie)return Number.parseInvariant(this.kie[Yb.Id].toString())}catch(La){e.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",La.toString())}return this.Zcb}gBj(){const qa={};try{if(!c.AFrameworkApplication.Ydc()||0>=c.AFrameworkApplication.Ydc().length||""===c.AFrameworkApplication.Ydc()[0])return qa;for(const La of c.AFrameworkApplication.Ydc())0<La.length&&
(qa[La]=c.AFrameworkApplication.Y6j)}catch(La){e.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",La.toString())}return qa}}Object(r.a)(wa,"TokenRefreshPolicy",null,[254]);class na extends b.a{constructor(qa){super();this.$=qa;this.Db()}create(){c.AFrameworkApplication.iN("Microsoft.Office.Excel.Server.Flighting.IDenyListRefreshAccessTokenSilentlyV2_ManagerCreated");c.AFrameworkApplication.fa.pa("RefreshAccessTokenSilently")?this.nb(this.hdh()):
this.nb(this.$.da.Aa(38)||this.$.da.Ha(38,new x(this.$)))}hdh(){var qa=this.$.da.Aa(38);if(qa)return qa;qa=new R(c.AFrameworkApplication.ji,c.AFrameworkApplication.uQ(),new wa);return this.$.da.Ha(38,new xa(this.$,qa))}static ka(qa){qa.da.Ha(39,new na(qa))}}Object(r.a)(na,"AccessTokenExpirationManagerFactory",b.a,[]);var Ba=a(9);a.d(F,"a",function(){return Ra});const Ra=()=>{Ba.a.Fa(na.ka)}},1224:function(r,F,a){r=a(0);var c=a(85),b=a(150);class e extends b.a{constructor(C){super(!1,!1,!0);this.zRb=
C}start(){const C={["id"]:"AccessibilitySettingsDialog",["bodyControls"]:{["tooltipPersistenceEnabled"]:this.zRb.Imd}};this.initializeAndShow("",Object(c.a)(this,this.dqj,"resultHandler"),C)}dqj(C,x){1===C&&(this.zRb.Imd=x.tooltipPersistenceEnabled)}}Object(r.a)(e,"AccessibilitySettingsDialog",b.a,[]);var f=a(108),d=a(25);class h{constructor(C,x){this.Ma=C;this.zRb=x}Ag(){this.Ma.Nb(d.a.THj,f.a.frame,Object(c.a)(this,this.UHj,"showAccessibilitySettingsDialogHandler"))}UHj(){(new e(this.zRb)).start();
return 32}}Object(r.a)(h,"AccessibilitySettingsDialogActor",null,[345]);var l=a(160),k=a(4);const t=C=>{const x=new l.a;k.AFrameworkApplication.Bd.Jm(n(C),1,null,null,!0,2,B=>{200===B.data.httpStatus?x.setResult("true"===B.data.de.toLowerCase()):x.setResult(!1)},()=>{x.setResult(!1)},null,void 0,void 0,void 0,void 0,"7");return x.task},n=C=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",k.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||"",C,k.AFrameworkApplication.vi);
var z=a(146);class w{constructor(){this.pWa=null}get Imd(){return!!this.pWa}set Imd(C){C!==this.pWa&&(this.pWa=C,z.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(C),this.Ulf()&&k.AFrameworkApplication.Bd.Jm(n("saveHoverableRibbonTooltipIsEnabled"),2,C.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}KAi(){const C=new l.a;if(this.pWa)C.setResult(this.pWa);else if(this.Ulf()){const x=t("getHoverableRibbonTooltipIsEnabled");x.continueWith(()=>
{this.pWa=x.result;z.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(x.result);C.setResult(x.result)},8)}else C.setResult(!1)}Ulf(){const C=k.AFrameworkApplication.fa.pa("IsRoamingServiceEnabled"),x=k.AFrameworkApplication.fa.pa("IsAnonymousUser");return C&&!x}}Object(r.a)(w,"AccessibilitySettingsInfo",null,[253]);var m=a(251),u=a(148);class y{constructor(){this.$a=null}get name(){return"Common.App.AccessibilitySettings"}Bh(C){this.$a=C;this.$a.register(w,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").yc(()=>
new w).qc();this.$a.register(h,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").yc(()=>new h(k.AFrameworkApplication.rb,this.$a.mg("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).qc()}init(){const C=this.$a.mg("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),x=this.$a.mg("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");C&&x?(x.Ag(),C.KAi()):u.a(539637639,
200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){m.a.instance.ii(new y)}}Object(r.a)(y,"AccessibilitySettingsPackage",null,[3,4]);a.d(F,"a",function(){return v});const v=()=>{Type.registerNamespace("Common.App.AccessibilitySettings");y.main()}},1225:function(r,F,a){var c=a(9);r=a(0);var b=a(226),e=a(15),f=a(89),d=a(27),h=a(421),l=a(479),k=a(522),t=a(169),n=a(228),z=a(24),w=a(65),m=a(41),u=a(167),
y=a(216),v=a(48),C=a(44),x=a(12),B=a(74),H=a(131),I=a(1),U=a(11),S=a(21),G=a(345),D=a(240),E=a(14),N=a(159),M=a(96),L=a(5),aa=a(252),V=a(68),P=a(45),ba=a(34);class Y extends M.a{constructor(Ca,fb,yb,mb){super(Ca);this.Gdg=[6];this.Bdg=[26];this.Mr=null;this.rBb=this.ekc=!1;this.fs=this.aba=null;this.onPointerDown=nb=>{if(1!==this.$.Ia.eH())return!0;nb=ba.a(this.$).me(nb);if(this.$A)return!0;var X=P.a(this.$).crd||P.a(this.$).ep();if(this.Zsd||X)return this.Mcb(),!0;this.fs=this.Wm;this.lLd();this.imd();
X=2===nb.vb&&nb.Sn===Sys.UI.MouseButton.leftButton;const R=3===nb.vb;if(X||R)nb=this.ha.Xp(nb.clientPoint,nb.Mb,5,void 0,void 0,!0),nb||(nb=this.fs),this.rBb=X,this.ekc=R,this.fs=this.O8e(nb),this.imd(),X?this.pgj():R&&this.fhj(),aa.b(this.$,!0);return!0};this.Ti=nb=>{nb=ba.a(this.$).me(nb);if(!this.$A)return!1;let X=this.rBb?this.ha.Xp(nb.clientPoint,nb.Mb,5,void 0,void 0,!0):this.ha.Xp(nb.clientPoint,nb.Mb,5,!0,!1,!0);X||(X=this.ha.fpb(nb.clientPoint,nb.Mb,5));X&&(nb=this.O8e(this.Lob(X)),this.n2b(nb.bottomRight),
this.fs.equals(nb)||(this.fs=nb,this.EJb(!1),this.lLd(!1),this.imd(!1),this.fdi(),this.Cb.update(!1)),this.F_j(this.fs));return!0};this.Wg=nb=>{ba.a(this.$).me(nb);if(!this.$A)return!1;this.resizeTable();this.Mcb();return!0};this.$Gb=nb=>{ba.a(this.$).me(nb);if(!this.$A)return e.ULS.shipAssertTag(537151233,0,!0,"TableResizeBehavior.OnTouchUp - OnTouchUp Called without Operation in Progress"),!1;this.resizeTable();this.Mcb();return!0};this.Fca=nb=>{ba.a(this.$).me(nb);this.Mcb();return!0};this.uAf=
()=>{this.$A&&this.Mcb()};this.gridView=fb;this.$=fb.$;this.tableManager=mb;this.ha=fb.ha;this.Cb=fb.Cb;this.parentElement=Ca;this.JZg();d.a.fp||d.a.Bba||D.a.instance.ta(E.a.pointerDown,this.aba,this.onPointerDown);this.Wm=yb;this.ZNc=this.Zsd=!1;this.tableManager.YLg(this.uAf)}get $A(){return this.rBb||this.ekc}get Smf(){return this.ZNc}dispose(){this.Mcb();this.tableManager.ljj(this.uAf);this.Smf||d.a.fp||d.a.Bba||D.a.instance.Ba(E.a.pointerDown,this.aba,this.onPointerDown);if(this.$A){aa.b(this.$,
!1);try{this.Iv()}catch(Ca){e.ULS.sendTraceTag(537151236,0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${Ca}`)}}this.parentElement&&this.parentElement.contains(this.aba)&&this.parentElement.removeChild(this.aba);this.aba=this.parentElement=null;super.dispose()}O8e(Ca){const fb=Ca.bottom-this.Wm.topLeft.bottom-1;return 0<=Ca.right-this.Wm.topLeft.right+1&&0<=fb&&Ca.bottom>=this.Wm.top&&Ca.right>=this.Wm.left?new z.Range(this.Wm.top,this.Wm.left,Ca.bottom,Ca.right,
!1,!1):this.fs}imd(Ca=!0){this.nyc([this.fs],6,Ca);this.Cb.Qq(this.Gdg)}EJb(Ca=!0){this.Cb.Nj(this.Gdg);this.nyc([null],6,Ca)}lLd(Ca=!0){this.Cb.Nj(this.Bdg);this.nyc([null],26,Ca)}fdi(){const Ca=this.YQj();0<Ca.length&&(this.nyc(Ca,26,!1),this.Cb.Qq(this.Bdg))}YQj(){const Ca=[];this.Wm.contains(this.fs)&&(this.Wm.right!==this.fs.right&&Ca.push(new z.Range(this.Wm.top,this.fs.right+1,this.fs.bottom,this.Wm.right,!1,!1)),this.Wm.bottom!==this.fs.bottom&&Ca.push(new z.Range(this.fs.bottom+1,this.Wm.left,
this.Wm.bottom,this.Wm.right,!1,!1)));return Ca}resizeTable(){if(!this.fs.equals(this.Wm)){const Ca=new z.Range(this.Wm.top,this.Wm.left,this.fs.bottom,this.fs.right,!1,!1);this.QVj(Ca);this.Zsd=!0}}onKeyDown(Ca){ba.a(this.$).me(Ca);return!0}w$a(){this.Smf&&(d.a.fp||d.a.Bba||(D.a.instance.ta(E.a.pointerDown,this.aba,this.onPointerDown),this.aba.classList.remove("ewr-table-resize-default-cursor"),this.ZNc=this.aba.disabled=!1),this.ZNc=!1)}JZg(){const Ca=document.createElement("div");Ca.className=
"ewr-table-resize-handle";const fb=document.createElement("div");fb.className="ewr-table-resize-fillhandle-higher";const yb=document.createElement("div");yb.className="ewr-table-resize-fillhandle-broader";Ca.appendChild(fb);Ca.appendChild(yb);this.aba=Ca;this.parentElement.appendChild(this.aba)}n2b(Ca){let fb=60;const yb=this.fs.contains(Ca);let mb=Ca.top,nb=Ca.bottom,X=Ca.left,R=Ca.right,wa=null;if(yb){if(this.gridView.aN(this.Wm.topLeft)&&!this.Wm.bBa)return;Ca.bottom<this.fs.bottom?(mb=Math.max(1,
nb-2,this.Wm.top),fb=16):(X=Math.max(1,R-2,this.Wm.left),fb=4);nb=mb;R=X;wa=new z.Range(mb,X,mb,X,!1,!1)}else Ca.right>=this.Wm.right?(R+=2,fb=8):Ca.bottom>=this.Wm.bottom&&(nb+=2,fb=32),mb=nb,X=R,wa=new z.Range(nb,R,nb,R,!1,!1),fb=16;this.gridView.aN(wa)||(this.Mr?this.Mr.gp||(this.Mr=v.a.instance.create(()=>{this.gridView.pv(wa,fb,"TableResizeBehavior.BringRangeIntoView")},40,C.a.Edg)):this.Mr=v.a.instance.create(()=>{this.gridView.pv(wa,fb,"TableResizeBehavior.BringRangeIntoView")},40,C.a.Edg))}Lob(Ca){let fb=
Ca;if(this.gridView.ib.o4){if(!this.gridView.Pb(Ca.topLeft)){const yb=this.gridView.Wj("TableResizeBehavior.AdjustHiddenRowColumns",this.gridView.jQ,this.fs.top!==Ca.top?1:2);try{yb.Ik=this.fs.top<Ca.top||this.fs.left<Ca.left,yb.xv(Ca.topLeft),fb=yb.$$cu().range}finally{yb&&yb.dispose()}}fb.right=fb.left+Ca.width-1;fb.bottom=fb.top+Ca.height-1}return fb}nyc(Ca,fb,yb=!0){const mb=[];for(const nb of Ca)mb.push(new G.a(nb,w.d(this.$.na)));this.Cb.zB(mb,[fb],!0,void 0,yb)}pgj(){D.a.instance.ta(E.a.yj,
document.documentElement,this.Ti);for(const Ca of this.gridView.yn)D.a.instance.ta(E.a.yj,Ca.domElement,this.Ti);D.a.instance.ta(E.a.Kf,document.documentElement,this.Wg);this.rMe()}fhj(){N.a.instance.ta(E.a.Tf,document.documentElement,this.Ti);for(const Ca of this.gridView.yn)N.a.instance.ta(E.a.Tf,Ca.domElement,this.Ti);N.a.instance.ta(E.a.ve,document.documentElement,this.$Gb);this.rMe()}Iv(){this.rBb&&this.OYj();this.ekc&&this.aZj()}OYj(){D.a.instance.Ba(E.a.yj,document.documentElement,this.Ti);
for(const Ca of this.gridView.yn)D.a.instance.Ba(E.a.yj,Ca.domElement,this.Ti);D.a.instance.Ba(E.a.Kf,document.documentElement,this.Wg);this.pTf()}aZj(){N.a.instance.Ba(E.a.Tf,document.documentElement,this.Ti);for(const Ca of this.gridView.yn)N.a.instance.Ba(E.a.Tf,Ca.domElement,this.Ti);N.a.instance.Ba(E.a.ve,document.documentElement,this.$Gb);this.pTf()}rMe(){this.gridView.mc.e9b(!0)}pTf(){this.gridView.mc.e9b(!1)}QVj(Ca){this.$.Yc(-1400250766,V.a.zb,30,{["ResizeTableRange"]:Ca,["OriginalTableRange"]:this.Wm})}F_j(Ca){if(!this.Wm.contains(Ca)){Ca=
this.XQj();for(const fb of Ca)if(this.tableManager.ytd(fb)){this.gridView.Gg.vp(L.a.HLi);return}}this.gridView.rtl?this.gridView.Gg.vp(L.a.PKi):this.gridView.Gg.vp(L.a.UMi)}Mcb(){if(this.$A){aa.b(this.$,!1);try{this.Iv()}catch(Ca){e.ULS.sendTraceTag(537151232,0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${Ca}`)}}this.Mr&&(this.Mr.cancel(),this.Mr.dispose());this.ekc=this.rBb=!1;this.EJb();this.lLd();aa.b(this.$,!1);this.gridView.Gg.vp(L.a.QU)}XQj(){const Ca=[];
this.Wm.right!==this.fs.right&&Ca.push(new z.Range(this.Wm.top,this.Wm.right+1,this.fs.bottom,this.fs.right,!1,!1));this.Wm.bottom!==this.fs.bottom&&Ca.push(new z.Range(this.Wm.bottom+1,this.Wm.left,this.fs.bottom,this.Wm.right,!1,!1));return Ca}static createInstance(Ca,fb,yb,mb){if(!fb)return null;const nb=Ca.Cb;nb.zB(yb,[27],!0);nb.Qq(Y.QQj);yb=nb.NC(27,Ca.ib.Ai(fb.bottomRight),Y.QTh(fb,yb)).hg;return new Y(yb,Ca,fb,mb)}static QTh(Ca,fb){var yb;for(let mb=0;mb<fb.length;mb++)if((null===(yb=fb[mb])||
void 0===yb?0:yb.range)&&fb[mb].range.equals(Ca))return mb;return 0}}Y.QQj=[27];Object(r.a)(Y,"TableResizeBehavior",M.a,[]);var Z=a(7);M=a(239);class ea{}ea.ozh="ewa-ttrd-buttonarea";Object(r.a)(ea,"CssClassNames",null,[]);var ra=a(49),O=a(127),da=a(94),xa=a(22),ia=a(13),Ma=a(257),Ta=a(128),Da=a(267);class fa extends M.a{constructor(Ca){super(document.createElement("div"));this.WVc=this.iqd=this.QLf=this.wQ=!1;this.KLb=null;this.Gh=()=>{y.c(this.$,this.gridView.ha.qa.activeCell)?(this.dMa=!0,this.usb(!1)):
(this.PZ=this.dMa=!1,this.Gig())};this.zt=()=>{this.dMa?this.usb(!0):this.PZ=!1};this.yAf=()=>{this.WVc=!0;this.dMa&&(this.PZ=!1)};this.onContentReady=()=>{this.$.isEditMode?y.c(this.$,this.gridView.ha.qa.activeCell)&&(this.dMa=!0,this.usb(!1)):this.PZ=!1};this.xya=()=>{this.WVc=!1;this.dMa?this.usb(!1):this.PZ=!1};this.nf=(fb,yb)=>{this.dMa&&(fb=this.gridView.rab(yb.Xc.block.ae.BlockCachePosition.PaneType).JB(yb.Xc.hash))&&(fb.zMd(this.zbf),fb.ZXc(this.zbf))};this.zbf=()=>{this.AXf()};this.$=Ca;
this.gridView=S.h(this.$);this.parentElement=this.domElement;this.parentElement.className=ea.ozh;this.dLa=this.gridView.pj;this.dMa=!0;this.Bhi();this.dUg();this.usb(!1);e.ULS.sendTraceTag(537151201,0,50,"TableTotalRowOptions - React Component Created ")}get PZ(){return this.iqd}set PZ(Ca){this.iqd!==Ca&&(this.iqd=this.isVisible=Ca)}get nCb(){return!!(this.$.qd&16)}get Oqi(){const Ca=this.gridView.ha.qa.activeCell;return Ca.right===Ca.maxColumns}get Dnb(){const Ca=this.gridView.Pb(null);return Ca&&
this.gridView.Eba(Ca.range)?this.wva(Ca):(Ca&&e.ULS.sendTraceTag(537151200,0,50,"TableTotalRowOptions.ActiveCellOffsetBounds - Active Cell not in viewport area"),null)}dispose(){this.$&&this.Ulh();this.$=this.gridView=this.parentElement=this.dLa=null;super.dispose()}IRh(Ca){const fb=this.K5h(this.gridView.Pb(null).range);return fb?`=SUBTOTAL(${Ca},${fb})`:null}K5h(Ca){var fb=S.h(this.$).tb.Dh(Ca);if(!fb)return null;fb=u.a(fb,!1);fb.right=fb.left=Ca.left;return fb.toString()}Bhi(){fa.WL={};fa.WL["100"]=
ia.a.instance.ga(1104);fa.WL["101"]=ia.a.instance.ga(1107);fa.WL["102"]=ia.a.instance.ga(1106);fa.WL["103"]=ia.a.instance.ga(1111);fa.WL["104"]=ia.a.instance.ga(1108);fa.WL["105"]=ia.a.instance.ga(1109);fa.WL["109"]=ia.a.instance.ga(1105);fa.WL["107"]=ia.a.instance.ga(1112);fa.WL["110"]=ia.a.instance.ga(1114);fa.WL["111"]=ia.a.instance.ga(1165)}W3i(){var Ca=this.gridView.Pb(null);if(Ca&&(Ca=Ca.RA?Ca.formulaBarText:null))if("=SUBTOTAL("===Ca.substring(0,10)){if(Ca=Ca.substring(10,13),Ca in fa.WL)return Ca}else return"111";
return"100"}dUg(){this.gridView.Ca.Ns(this.nf);this.gridView.ha.yG(this.Gh);this.gridView.Uu(this.onContentReady);this.gridView.mc.xl(this.yAf);this.gridView.mc.Km(this.xya)}Ulh(){this.gridView&&(this.gridView.ha&&(this.gridView.ha.JK(this.Gh),this.gridView.Ca.Kq(this.nf)),this.gridView.my(this.onContentReady),this.gridView.mc&&(this.gridView.mc.nl(this.yAf),this.gridView.mc.$l(this.xya)),this.Gig())}usb(Ca){this.Q_j(Ca);this.nCb&&(this.uPj(),this.Dnb?(this.QLf||this.oUg(),this.WVc?this.PZ=!1:(this.PZ=
!0,this.AXf())):(e.ULS.sendTraceTag(537151199,0,15,"TableTotalRowOptions.CreateAndShowDropdownInUpdatedPosition : Offset bounds could not be determined"),this.PZ=!1))}AXf(){appChrome.renderTableTotalRowOptions(this.parentElement,fa.WL,fa.WL[this.W3i()].toString(),Math.round(ba.a(this.$).mi(17)),Ca=>{e.ULS.sendTraceTag(537151198,0,50,`TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option : ${Ca}`);let fb={["SelectedOption"]:fa.WL[Ca],["FunctionKeyCode"]:Ca,["Location"]:"canvas"};Ta.b(this.$).rd(O.a.bRj,
fb,null,!0);if("111"===Ca)return this.Uki(),!0;if("100"!==Ca){this.KLb=this.IRh(Ca);if(!this.KLb)return e.ULS.sendTraceTag(537151197,0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option was null"),!0;this.QRa(this.KLb)}else this.QRa("");x.DOMElementExtensions.setFocus(this.gridView.Vb.textBox.domElement);return!0})}Uki(){e.ULS.sendTraceTag(537151196,0,50,"TableTotalRowOptions.InvokeMoreFunctionsDialog - More Functions dialog invoked");const Ca=new da.a(753860909,0,this.$.isEditMode?
2:1,19,null);this.$.Ia.Hb(Ca)}wva(Ca){if(!Ca)return null;var fb=this.gridView.mc.textBox.domElement;var yb=0<x.DOMElementExtensions.getHeight(fb)&&0<x.DOMElementExtensions.getWidth(fb)&&0<=fb.offsetTop&&0<=fb.offsetLeft;if(yb)fb=x.DOMElementExtensions.wva(fb,this.gridView.pj);else{fb=this.gridView.getCellBounds(Ca.cell);var mb=x.DOMElementExtensions.getBoundingClientRect(this.gridView.pj);fb=new Sys.UI.Bounds(fb.x-mb.x,fb.y-mb.y,fb.width,fb.height)}if(fb)if(yb)2<fb.height&&2<fb.height&&(fb.x+=1,fb.y+=
1,fb.height-=2,fb.width-=2);else if(yb=S.h(this.$).LJ(Ca.cell))yb=yb.width,mb=xa.a.equals(Ma.a.Mwb(Ca.cell,this.gridView.rtl),"right",!0),this.gridView.rtl&&mb&&(fb.x=fb.x+fb.width-yb),Ca.Iba&&this.gridView.rtl===mb&&(fb.width=yb);else return null;return fb}Q_j(Ca){var fb=this.Dnb;if(fb){var yb=17>=fb.height?fb.y:fb.y+fb.height-17-2;fb=this.Oqi?this.gridView.rtl?fb.x:fb.x+fb.width-(17<fb.height?17:fb.height):this.gridView.rtl?fb.x-(17<fb.height?17:fb.height):fb.x+fb.width;var mb=ba.a(this.$).Mja(new Sys.UI.Point(fb,
yb));this.parentElement.style.top=U.HelperMethods.sc(mb.y);this.parentElement.style.left=U.HelperMethods.sc(mb.x);ba.a(this.$).xAj(this.parentElement);Ca&&(this.PZ=this.gridView.pkc(new ra.a(fb,yb)))}else this.PZ=!1}oUg(){this.dLa.insertBefore(this.parentElement,this.dLa.firstChild);this.QLf=!0}uPj(){this.wQ||(this.gridView.view.Ps(this.zt),this.wQ=!0)}Gig(){this.wQ&&this.gridView.view&&(this.gridView.view.Mq(this.zt),this.wQ=!1)}QRa(Ca){const fb=this.gridView.Vb,yb=this.gridView.Pb(null);yb&&(Ca=
Object(Z.a)(new Da.a,{Text:Ca}),this.gridView.setCell(Ca,yb.range,0,127,null),fb.endEdit(!0,"TableTotalRowOptions.SetCellContent",0))}}fa.aRj="TableTotalRowDropDownIconButtonId";fa.WL=null;Object(r.a)(fa,"TableTotalRowOptions",M.a,[2]);class ua extends l.a{constructor(Ca){super(S.h(Ca));this.Lqb=this.F0=this.KBc=this.Jqb=null;this.Fte=!1;this.zce=null;this.XSb=0;this.Q6b=null;this.F1b=()=>{const fb={},yb=this.yid();for(let nb in yb){const X=yb[nb];if(!X)continue;const R=this.M4h(X);if(R){if(R in this.MFa){var mb=
this.MFa[R];if(mb.$A){mb.Wm.equals(X)||(mb.Wm=X);delete this.MFa[R];fb[R]=mb;continue}}(mb=Y.createInstance(S.h(this.$),X,this.COh(),this))?fb[R]=mb:e.ULS.sendTraceTag(537151239,0,15,`TableManager.AttachTableResizeBehavior - Attaching Grippie Failed for Range ${X.RC(!1)}`)}}this.R3b(null,null);this.DRb=fb};this.R3b=()=>{const fb=this.MFa;for(let nb in fb){var yb=nb,mb=fb[nb];mb&&(mb.dispose(),delete this.MFa[yb])}this.DRb={}};this.xRf=()=>{this.R3b(null,null);this.F1b(null,null)};this.onFocus=()=>
{this.zce=S.h(this.$).ha.qa.activeCell};this.Y5=()=>{this.$.isEditMode&&this.Gh(null,null)};this.Gh=()=>{!this.Fte&&y.c(this.$,this.gridView.ha.qa.activeCell)&&this.VAi()};this.DV=()=>{this.Ozb(1);this.$.ea.Cn(this.DV)};this.iIb=()=>{this.Fte=!0;this.KBc=new fa(this.$)};this.$=Ca;this.gridView=S.h(this.$);this.$.da.Ha(66,this);this.DRb={};this.F1b(null,null);this.$.va&&this.$.va.Vf(this.xRf);this.JXc(this.F1b);this.$.ea.l2(this.Y5);this.gridView.ha.yG(this.Gh);this.$.isEditMode&&this.Gh(null,null)}JXc(Ca){this.addHandler(l.a.zbb,
Ca)}nMd(Ca){this.removeHandler(l.a.zbb,Ca)}YLg(Ca){this.addHandler("tce",Ca)}ljj(Ca){this.removeHandler("tce",Ca)}get MFa(){return this.DRb}get Pud(){return this.zce}get wIa(){return this.XSb}get Dg(){const Ca=S.h(this.$);return Ca.tb.Dh(Ca.ha.qa.activeCell,!1)}get THd(){return this.Pud?S.h(this.$).tb.Dh(this.Pud,!1):null}ytd(Ca){return!!this.M5e(Ca)}Np(Ca){return this.k1h(this.u6e(Ca))}swb(Ca){return this.u6e(Ca)}chj(Ca){Ca?(this.Lqb?this.Lqb!==Ca&&(f.a.Ja(this.F0),this.F0=null,this.Lqb=Ca):this.Lqb=
Ca,this.F0||(this.F0=H.a.instance.ie(this.Lqb)),this.F0.Ci("focusin")||this.F0.ka("focusin",this.onFocus)):e.ULS.sendTraceTag(537151245,0,15,"TableManager.RegisterToTextboxFocusEvent empty textBoxDomElement recieved")}ejf(Ca,fb){return Ca?Ca.dka&&Ca.top===fb.top:(e.ULS.shipAssertTag(537151244,0,!!Ca,"autofilterRange can't be null"),!1)}Kja(Ca){Ca=this.Jqb?m.I(Ca,this.Jqb):this.view.getRangeInformation(Ca);return 0<Ca.length&&Object(h.a)(n.PivotTableRange,Ca[0])?Ca[0]:null}nni(Ca,fb){return Ca?!Ca.Nhc&&
!!Ca.kJ&&Ca.kJ.zd(fb):(e.ULS.shipAssertTag(537151243,0,!!Ca,"Pivot table can't be null"),!1)}Hti(Ca,fb){return Ca?!Ca.Nhc&&!!Ca.UK&&Ca.UK.zd(fb):(e.ULS.shipAssertTag(537151242,0,!!Ca,"Pivot table can't be null"),!1)}v_b(Ca){super.v_b(Ca);if((Ca=U.HelperMethods.X5e(Ca))&&0<Ca.length){this.Jqb=Array(Ca.length);for(let fb=0;fb<Ca.length;fb++)this.Jqb[fb]=t.a.iQ(Ca[fb])}}xJb(){super.xJb();this.Jqb=null}Fah(Ca,fb){return this.NGe(Ca,fb).returnValue}NGe(Ca,fb){var yb=!1;if(!Ca||!fb)return{returnValue:!1,
mY:yb};Ca=Ca.clone();Ca.right+=1;Ca.left=Ca.right;return!Ca.nz||Ca.top<fb.ib.Ni&&(yb=Ca.clone(),yb.bottom>=fb.ib.Ni&&(yb.bottom=fb.ib.Ni-1),!({mY:yb}=this.MGe(yb,fb)).returnValue)||Ca.bottom>=fb.ib.Ni&&(yb=Ca.clone(),yb.top<=fb.ib.Ni&&(yb.top=fb.ib.Ni),!({mY:yb}=this.MGe(yb,fb)).returnValue)?{returnValue:!1,mY:yb}:{returnValue:!0,mY:yb}}Fdg(Ca){(Ca=this.Np(Ca.topLeft))&&Ca.toString()in this.MFa&&(this.MFa[Ca.toString()].Zsd=!1)}Naj(){this.raiseEvent("tce")}Oh(Ca,fb){if(!this.KBc)return!1;switch(fb){case -569786022:case 541421805:if(this.KBc.PZ){const yb=
document.getElementById(fa.aRj);yb&&v.a.instance.create(()=>{x.DOMElementExtensions.Igc(yb,null)},0,C.a.UQj,!0,!0)}return!0;default:return!1}}dispose(){this.R3b(null,null);this.nMd(this.F1b);this.$.va.sg(this.xRf);this.$.ol(this.R3b);this.DRb=null;this.$.ea&&this.$.ea.K6(this.Y5);this.gridView.ha.JK(this.Gh);this.KBc=null;I.EwaSettings.isChangeGateEnabled("OfficeVSO:7427871_TableRename")&&this.F0&&(f.a.Ja(this.F0),this.F0=null);super.dispose()}Dai(Ca,fb,yb,mb){const nb=this.gridView.tb.Dh(new z.Range(fb,
yb,fb,yb,!1,!1));if(this.Q6b=nb){var X=nb.usedRange,R=Ca.ctrlKey||d.a.isMac&&B.b(Ca),wa=!Ca.shiftKey&&R;Ca=Ca.shiftKey&&!R;I.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&(S.h(this.$).ha.selectionType=3);switch(mb){case 0:this.XSb=0;I.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(fb=this.M6c(Ca,X.top,yb,X.bottom,yb),this.pSd(fb,wa,Ca)):this.qSd(X.top,yb,X.bottom,yb,u.d(nb),u.g(nb),wa);break;case 1:this.XSb=1;I.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?
(fb=this.M6c(Ca,fb,X.left,fb,X.right),this.pSd(fb,wa,Ca)):this.qSd(fb,X.left,fb,X.right,!1,!1,wa);break;case 2:this.XSb=2;I.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(fb=this.M6c(Ca,X.top,X.left,X.bottom,X.right),this.pSd(fb,wa,Ca)):this.qSd(X.top,X.left,X.bottom,X.right,u.d(nb),u.g(nb),wa);break;default:e.ULS.shipAssertTag(537151240,0,!1,`TableManager.HandleTableSelectorsSelection: Table Selector can not be of type: ${mb.toString()}`);return}I.EwaSettings.isChangeGateEnabled("OfficeVSO:5501896_TableSelectionDragSelection")&&
(S.h(this.$).ha.selectionType=3);e.ULS.sendTraceTag(527212953,0,50,"TableManager.handleTableSelectorsSelection: A table selector was clicked using hover arrows")}else e.ULS.shipAssertTag(537151241,0,!1,"TableManager.HandleTableSelectorsSelection: Table for table selector selection can't be null")}cFj(Ca){const fb=this.Q6b.usedRange;return this.rlf(Ca)||1!==this.wIa&&this.rlf(new z.Range(fb.top,Ca.left,fb.bottom,Ca.right,!1,!1))?!0:!1}lJd(Ca){return Ca.Autofilters}MGe(Ca,fb){let yb;yb=!1;const mb=
fb.ib.Ai(Ca),nb=fb.Rf(mb).hi;if(!nb)return e.ULS.sendTraceTag(537151238,0,15,`TableManager.CouldExpandImpl - loadedRange is null. PaneType=${mb}`),{returnValue:!1,mY:yb};if(!nb.we(Ca))return{returnValue:!0,mY:yb};Ca=fb.Wj("TableManager.CouldExpandImpl",Ca,2);try{for(;Ca.$$mn();){if(Ca.$$cu().text||Ca.Nm.cbf)return yb=!0,{returnValue:!1,mY:yb};if(Ca.$$cu().vH)return{returnValue:!1,mY:yb}}}finally{Ca&&Ca.dispose()}return{returnValue:!0,mY:yb}}k1h(Ca){if(!Ca)return null;const fb=new k.AutofilterRange(Ca.top,
Ca.left,Ca.bottom,Ca.right,null,null,null,Ca.id,Ca.dka);fb.bBa=Ca.bBa;const yb=this.gridView.tb.Dh(Ca,!0);if(!yb)return null;for(let mb=0,nb=this.rangeList.length;mb<nb;mb++){const X=this.rangeList[mb],R=this.gridView.tb.Dh(X,!0);R&&R.name===yb.name&&X!==Ca&&this.Msi(X)&&(fb.union(X),X.bBa&&(fb.bBa=!0))}return fb}Msi(Ca){return!!S.h(this.$).tb.Dh(Ca)}COh(){const Ca=[];for(const fb of this.rangeList){const yb=new G.a(this.Np(fb.topLeft),w.d(this.$.na));Ca.push(yb)}return Ca}yid(){const Ca={};for(const fb of this.rangeList){if(!fb)continue;
const yb=this.Np(fb.topLeft);yb&&(Ca[yb.toString()]=this.Np(fb.topLeft))}return Ca}VAi(){this.$.ea.Zf?this.Ozb(0):this.$.ea.Dk(this.DV)}Ozb(Ca){this.$.Vx(fb=>{fb.Jaa(Ca).then(this.iIb)})}M4h(Ca){const fb=this.gridView.tb.Dh(Ca);return fb?fb.name:Ca.toString()}qSd(Ca,fb,yb,mb,nb,X,R){const wa=Ca+(nb?1:0),na=yb-(X?1:0),Ba=this.gridView.inRangePicker||this.gridView.Vh;let Ra=!1;const qa=new z.Range(wa,fb,na,mb,!1,!1);if(nb||X){nb=Ba?G.a.Nsb(this.gridView.ha.rangePicker.DK):this.gridView.ha.qa.selectedRanges;
for(const La of nb){Ra=this.Trb(La,wa,fb,na,mb);nb=this.Trb(La,Ca,fb,yb,mb);if(Ba&&Ra)break;if(!Ba&&(Ra||nb)){this.gridView.ha.updateSelection(La,La.topLeft,0,1);if(R&&nb)return;break}}}Ra&&(qa.top=Ca,qa.bottom=yb);Ca=qa.topLeft;R?this.gridView.ha.updateSelection(qa,Ca,0,1):Ba?this.gridView.ha.ty([qa],0,Ca,0):this.gridView.ha.updateSelection(qa,Ca,0,3)}pSd(Ca,fb,yb){Ca&&(yb=yb?S.h(this.$).ha.qa.activeCell:Ca.topLeft,fb?this.gridView.ha.updateSelection(Ca,yb,0,1):this.gridView.ha.ty([Ca],0,yb,0))}M6c(Ca,
fb,yb,mb,nb){const X=u.d(this.Q6b),R=u.g(this.Q6b),wa=fb+(1!==this.wIa&&X?1:0),na=mb-(1!==this.wIa&&R?1:0),Ba=this.gridView.inRangePicker||this.gridView.Vh;if(Ca){var Ra=I.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&Ba&&!G.a.Nsb(this.gridView.ha.rangePicker.DK).length?new z.Range(wa,yb,na,nb,!1,!1):Ba?this.gridView.ha.rangePicker.activeCell:this.gridView.ha.qa.activeCell;Ra=new z.Range(Ra.top<wa?Ra.top:wa,Ra.left<yb?Ra.left:yb,Ra.bottom>na?Ra.bottom:na,Ra.right>nb?
Ra.right:nb,!1,!1)}else Ra=new z.Range(wa,yb,na,nb,!1,!1);if(1!==this.wIa&&(X||R)&&(!Ca||Ca&&this.Trb(Ra,wa,yb,na,nb))){Ca=Ba?G.a.Nsb(this.gridView.ha.rangePicker.DK):this.gridView.ha.qa.selectedRanges;for(const qa of Ca)if(this.Trb(qa,wa,yb,na,nb)){Ra.top=fb;Ra.bottom=mb;break}}return Ra}rlf(Ca){const fb=this.gridView.inRangePicker||this.gridView.Vh?G.a.Nsb(this.gridView.ha.rangePicker.DK):this.gridView.ha.qa.selectedRanges;for(const yb of fb)if(this.Trb(yb,Ca.top,Ca.left,Ca.bottom,Ca.right))return!0;
return!1}Trb(Ca,fb,yb,mb,nb){return!!Ca&&Ca.top===fb&&Ca.bottom===mb&&Ca.left===yb&&Ca.right===nb}}Object(r.a)(ua,"TableManager",l.a,[697,2]);class Fa extends b.a{constructor(Ca){super();this.tableManager=null;this.$=Ca;this.Db()}create(){this.nb(this.tableManager||(this.tableManager=new ua(this.$)))}}Object(r.a)(Fa,"TableManagerFactory",b.a,[]);var ca=a(1242);a.d(F,"a",function(){return ka});const ka=()=>{c.a.Fa(Ca=>{Ca.da.Ha(134,new Fa(Ca));Ca.da.Ha(330,new ca.a(Ca))})}},1242:function(r,F,a){r=
a(0);var c=a(226),b=a(50),e=a(37),f=a(7),d=a(15),h=a(111),l=a(843),k=a(1489),t=a(739),n=a(1344),z=a(38),w=a(5),m=a(166),u=a(68),y=a(60),v=a(167),C=a(48),x=a(44),B=a(112);a(28);var H=a(197),I=a(29),U=a(249),S=a(1),G=a(22),D=a(13);a(30);class E{}Object(r.a)(E,"TableStyleElement",null,[]);var N=a(763),M=a(214),L=a(92),aa=a(527);class V{static Zsf(ra,O){return V.Idg[ra.Type]-V.Idg[O.Type]}static B4a(ra,O){try{return appChrome.buildTableStyleGalleryIconNew(V.nBa,V.qoa,ra,O)}catch(da){return null}}static Umf(ra){return ra&&
u.a.Kc in ra&&(ra=ra[u.a.Kc])?G.a.MF(ra,w.a.sIb):!1}static eta(ra){const O=[];let da=0;for(const xa of ra){O[da]={};O[da].backgroundColor="white";O[da].color="black";for(let ia in xa)switch(ra=xa[ia],ia){case "background-color":O[da].backgroundColor=ra;break;case "color":O[da].color=ra;break;case "font-size":O[da].fontSize=ra;break;case "border-bottom":O[da].borderBottom=ra;break;case "border-right":O[da].borderRight=ra;break;case "border-left":O[da].borderLeft=ra;break;case "border-top":O[da].borderTop=
ra}da++}return O}static s5b(ra,O){const da=[];if(null===ra||void 0===ra?0:ra.TableStyleElementsList){var xa=0===ra.Category;for(let ia=0;ia<V.qoa;ia++)da.push(...V.FSh(ra,O,xa,ia))}else{if(V.i8c)return V.i8c;ra={color:"black","background-color":"white"};for(O=0;O<V.qoa;O++)for(xa=0;xa<V.nBa;xa++)da.push(ra);V.i8c=da}return da}static N4h(ra,O){if(!ra.TableStyleElementsList)return"";let da="";for(const xa of ra.TableStyleElementsList)if(xa.BackgroundColor&&"#000000"!==xa.BackgroundColor)switch(xa.Type){case 0:da=
xa.BackgroundColor;break;case 5:case 7:if(O.Iha||O.IR)da=xa.BackgroundColor;break;case 3:case 4:if(O.firstCol||O.lastCol)da=xa.BackgroundColor;break;case 2:O.totalRow&&(da=xa.BackgroundColor);break;case 1:O.headerRow&&(da=xa.BackgroundColor)}return da}static u4b(ra){ra=new M.a(parseInt(String("0x"+ra.substr(1,2)),16),parseInt(String("0x"+ra.substr(3,2)),16),parseInt(String("0x"+ra.substr(5,2)),16));return N.a.HKa(ra)}static j8e(ra,O){if(!ra||!O)return"";O=(O=V.N4h(ra,O))?V.u4b(O)+", ":D.a.instance.ga(2069)+
", ";switch(ra.Index){case 0:return O+D.a.instance.ga(2003);case 1:return O+D.a.instance.ga(2004);case 2:return O+D.a.instance.ga(2005);case 3:return O+D.a.instance.ga(2006);case 4:return O+D.a.instance.ga(2007);case 5:return O+D.a.instance.ga(2008);case 6:return O+D.a.instance.ga(2009);case 7:return O+D.a.instance.ga(2010);case 8:return O+D.a.instance.ga(2011);case 9:return O+D.a.instance.ga(2012);case 10:return O+D.a.instance.ga(2013);case 11:return O+D.a.instance.ga(2014);case 12:return O+D.a.instance.ga(2015);
case 13:return O+D.a.instance.ga(2016);case 14:return O+D.a.instance.ga(2017);case 15:return O+D.a.instance.ga(2018);case 16:return O+D.a.instance.ga(2019);case 17:return O+D.a.instance.ga(2020);case 18:return O+D.a.instance.ga(2021);case 19:return O+D.a.instance.ga(2022);case 20:return O+D.a.instance.ga(2023);case 21:return O+D.a.instance.ga(2024);case 22:return O+D.a.instance.ga(2025);case 23:return O+D.a.instance.ga(2026);case 24:return O+D.a.instance.ga(2027);case 25:return O+D.a.instance.ga(2028);
case 26:return O+D.a.instance.ga(2029);case 27:return O+D.a.instance.ga(2030);case 28:return O+D.a.instance.ga(2031);case 29:return O+D.a.instance.ga(2032);case 30:return O+D.a.instance.ga(2033);case 31:return O+D.a.instance.ga(2034);case 32:return O+D.a.instance.ga(2035);case 33:return O+D.a.instance.ga(2036);case 34:return O+D.a.instance.ga(2037);case 35:return O+D.a.instance.ga(2038);case 36:return O+D.a.instance.ga(2039);case 37:return O+D.a.instance.ga(2040);case 38:return O+D.a.instance.ga(2041);
case 39:return O+D.a.instance.ga(2042);case 40:return O+D.a.instance.ga(2043);case 41:return O+D.a.instance.ga(2044);case 42:return O+D.a.instance.ga(2045);case 43:return O+D.a.instance.ga(2046);case 44:return O+D.a.instance.ga(2047);case 45:return O+D.a.instance.ga(2048);case 46:return O+D.a.instance.ga(2049);case 47:return O+D.a.instance.ga(2050);case 48:return O+D.a.instance.ga(2051);case 49:return O+D.a.instance.ga(2052);case 50:return O+D.a.instance.ga(2053);case 51:return O+D.a.instance.ga(2054);
case 52:return O+D.a.instance.ga(2055);case 53:return O+D.a.instance.ga(2056);case 54:return O+D.a.instance.ga(2057);case 55:return O+D.a.instance.ga(2058);case 56:return O+D.a.instance.ga(2059);case 57:return O+D.a.instance.ga(2060);case 58:return O+D.a.instance.ga(2061);case 59:return O+D.a.instance.ga(2062);default:return ra.Name?ra.Name:""}}static LZh(ra){return(ra+1)%V.aei}static cyb(ra,O,da=""){return ra||!da?`${V.tdf}, ${ra.Index.toString()}, -version, ${O.toString()}`:`${V.tdf}, ${da}, -version, ${O.toString()}`}static FSh(ra,
O,da,xa){const ia=[];for(let Ma=0;Ma<V.nBa;Ma++)ia.push(V.Qfd(ra,O,da,xa,Ma));return ia}static Qfd(ra,O,da,xa,ia){ra=ra.TableStyleElementsList;let Ma=new E;const Ta={};if(!ra)return Ta;for(var Da of ra)if(0===Da.Type){Ma=Da;break}Da=!!Ma.BackgroundColor;let fa="";!da&&Ma.TableStyleBorderFromatList&&0<Ma.TableStyleBorderFromatList.length&&(fa=Ma.TableStyleBorderFromatList[0].Color);Ta["background-color"]=Da?Ma.BackgroundColor:"#FFFFFF";Ma.FontColor||(Ma.FontColor="#000000");Ta.color=Ma.FontColor;V.LBe(xa,
ia,Ta,Ma,fa,da,Da);for(const ua of ra)ua&&0!==ua.Type&&(2!==ua.Type||Da||(ua.BackgroundColor=Ma.BackgroundColor),V.ptd(ua,xa,ia,O)&&(ua.BackgroundColor&&(Ta["background-color"]=ua.BackgroundColor),Ta.color=ua.FontColor||Ma.FontColor,V.LBe(xa,ia,Ta,ua,fa,da,Da)));return Ta}static LU(ra,O,da,xa,ia,Ma){da&&(da.Color&&!da.Style&&(da.Style=1),da.Style&&!da.Color&&(da.Color=ia?"#000000":xa?xa:Ma?"#FFFFFF":"#000000"),O[V.borders[ra]]="1px "+V.tV[da.Style]+" "+da.Color)}static ptd(ra,O,da,xa){return-1===
ra.Type?!1:V.rtd(ra,O,da,xa)||V.$ui(ra,O,da,xa)||V.std(ra,O,da,xa)}static $ui(ra,O,da,xa){return!O&&xa.headerRow||O===V.qoa-1&&xa.totalRow?!1:1===O%2&&5===ra.Type&&xa.IR&&xa.headerRow||1<O&&!!((O-1)%(ra.BandSize+1))&&6===ra.Type&&xa.IR&&xa.headerRow||!(O%2)&&5===ra.Type&&xa.IR&&!xa.headerRow||!!(O%(ra.BandSize+1))&&6===ra.Type&&xa.IR&&!xa.headerRow||!(da%2)&&7===ra.Type&&xa.Iha||!!(da%(ra.BandSize+1))&&8===ra.Type&&xa.Iha}static std(ra,O,da,xa){return O===V.qoa-1&&2===ra.Type&&xa.totalRow||da===V.nBa-
1&&O===V.qoa-1&&12===ra.Type&&xa.totalRow&&xa.lastCol||!da&&O===V.qoa-1&&11===ra.Type&&xa.totalRow&&xa.firstCol||da===V.nBa-1&&4===ra.Type&&xa.lastCol}static rtd(ra,O,da,xa){return!O&&1===ra.Type&&xa.headerRow||!da&&3===ra.Type&&xa.firstCol||!da&&!O&&9===ra.Type&&xa.headerRow&&xa.firstCol||da===V.nBa-1&&!O&&10===ra.Type&&xa.headerRow&&xa.lastCol}static LBe(ra,O,da,xa,ia,Ma,Ta){if(xa.TableStyleBorderFromatList)for(const Da of xa.TableStyleBorderFromatList)if(Da.Style)switch(Da.Position){case 0:ra&&
12!==xa.Type&&11!==xa.Type&&2!==xa.Type&&5!==xa.Type&&6!==xa.Type||V.LU(0,da,Da,ia,Ma,Ta);break;case 1:ra!==V.qoa-1&&1!==xa.Type&&10!==xa.Type&&9!==xa.Type&&5!==xa.Type&&6!==xa.Type||V.LU(1,da,Da,ia,Ma,Ta);break;case 2:O&&12!==xa.Type&&10!==xa.Type&&7!==xa.Type&&8!==xa.Type&&4!==xa.Type||V.LU(2,da,Da,ia,Ma,Ta);break;case 3:O!==V.nBa-1&&9!==xa.Type&&11!==xa.Type&&3!==xa.Type&&7!==xa.Type&&8!==xa.Type||V.LU(3,da,Da,ia,Ma,Ta);break;case 5:O!==V.nBa-1&&3!==xa.Type&&4!==xa.Type&&7!==xa.Type&&8!==xa.Type&&
V.LU(3,da,Da,ia,Ma,Ta);break;case 6:ra!==V.qoa-1&&2!==xa.Type&&1!==xa.Type&&5!==xa.Type&&6!==xa.Type&&V.LU(1,da,Da,ia,Ma,Ta)}}static Q4h(){const ra=Array(12);ra[0]=0;ra[7]=1;ra[8]=2;ra[5]=3;ra[6]=4;ra[4]=5;ra[3]=6;ra[1]=7;ra[2]=8;ra[9]=9;ra[10]=10;ra[11]=11;ra[12]=13;return ra}}V.qoa=5;V.nBa=5;V.aei=5;V.tdf="TableStyleIcon";V.tV=[null,L.a.solid,L.a.dashed,L.a.dotted,L.a.dashed,L.a.dotted,L.a.dashed,L.a.double];V.borders=[aa.a.borderTop,aa.a.borderBottom,aa.a.borderLeft,aa.a.borderRight];V.Idg=V.Q4h();
V.i8c=null;Object(r.a)(V,"TableStyleHelper",null,[]);class P{constructor(ra,O,da,xa,ia,Ma){this.headerRow=ra;this.totalRow=O;this.firstCol=da;this.lastCol=xa;this.IR=ia;this.Iha=Ma}equals(ra){return ra?this.headerRow===ra.headerRow&&this.totalRow===ra.totalRow&&this.firstCol===ra.firstCol&&this.lastCol===ra.lastCol&&this.Iha===ra.Iha&&this.IR===ra.IR:!1}}Object(r.a)(P,"TableStyleOptions",null,[]);var ba=a(804);class Y extends z.a{constructor(ra,O,da){super();this.X8i={["height"]:"100%"};this.oJb=
{};this.kIa=this.pjd=0;this.lastSyncTime=new Date;this.Oda=-1;this.IN=null;this.Ima={};this.gL=null;this.sI={};this.vTa={};this.Otc=null;this.gCb=this.$6a=this.isInitialized=this.jlf=!1;this.Uwc=null;this.fBc=this.lOb=this.zZe=!1;this.EUi=(xa,ia,Ma)=>{let Ta=!1;if(U.a(xa))-315732528!==xa.Errors[0].MessageId&&(d.ULS.sendTraceTag(42821707,0,10,`TableStyleManager.OnGetTableStyleSuccess - Webservice call failed with Unexpected error : ${I.a.nc(xa.Errors)}`),this.NDf(null,ia,Ma));else if(d.ULS.sendTraceTag(537151202,
0,50,"TableStyleManager.OnGetTableStyleSuccess - Webservice call Success"),(xa=xa.Result)&&xa.TableStyleItems.length){Ma=60<xa.TableStyleItems.length;var Da=!1,fa=!1;if(this.gL)for(var ua=0;60>ua;++ua){const Fa=xa.TableStyleItems[ua],ca=this.gL.TableStyleItems[ua];if(Fa.HasStyleViolations!==ca.HasStyleViolations){Ta=fa=!0;break}for(let ka=0;9>ka&&!(ka>=Fa.TableStyleElementsList.length);ka++)if(!G.a.equals(Fa.TableStyleElementsList[ka].BackgroundColor,ca.TableStyleElementsList[ka].BackgroundColor,
!1)){Ta=Da=!0;break}}else{this.kIa=0;for(ua of xa.TableStyleItems)ua.TableStyleElementsList&&ua.TableStyleElementsList.sort(V.Zsf),this.sI[ua.Name]=ua}if(Da||fa)for(Da=0;60>Da;++Da)fa=xa.TableStyleItems[Da],this.sI[fa.Name]=fa;if(Ma&&this.gL)for(d.ULS.sendTraceTag(42821700,0,50,`TableStyleManager.OnGetTableStyleSuccess, Number Custom Styles present - ${xa.TableStyleItems.length-60}`),Ta=!0,Ma=60;Ma<xa.TableStyleItems.length;++Ma)Da=xa.TableStyleItems[Ma],Da.Name in this.sI||Da.TableStyleElementsList&&
Da.TableStyleElementsList.sort(V.Zsf),this.sI[Da.Name]=Da;if(ba.a(this.sI).length!==xa.TableStyleItems.length)for(Ta=!0,Da=Ma=60;Da<this.gL.TableStyleItems.length;)Ma>=xa.TableStyleItems.length?delete this.sI[this.gL.TableStyleItems[Da].Name]:Ma>=xa.TableStyleItems.length||!G.a.equals(xa.TableStyleItems[Ma].Name,this.gL.TableStyleItems[Da].Name,!1)?delete this.sI[this.gL.TableStyleItems[Da].Name]:++Ma,++Da;this.gL=xa;this.LTf(Ta);Ta&&this.m0c();ia&&("accessibility"===ia?(this.lOb=!1,this.fBc=!0):
this.fBc=!1);this.jlf||(this.rvi()&&this.$.qf(),this.jlf=!0);this.pjd=0;this.gCb||this.zZe?this.fBc&&this.raiseEvent("RefreshTableStyleGallery"):(this.raiseEvent("RefreshTableStyleGallery"),this.zZe=!0)}};this.NDf=()=>{d.ULS.sendTraceTag(42821712,0,10,"TableStyleManager.OnGetTableStyleFailed - Webservice call failed");this.pjd++;5>this.pjd&&C.a.instance.create(()=>{this.Y4a("getTableStylesFailed")},1E3,x.a.Hdg,!0,!0)};this.nJf=()=>{this.gCb&&(this.gCb=!1,this.Uwc&&this.Uwc(),C.a.instance.create(()=>
{this.Y4a("galleryMenuClosed")},1E3,x.a.Hdg,!0,!0))};this.$=ra;this.Va=O;this.tableManager=da;this.$.da.Ha(329,this);this.I0c=this.Pwb();this.$.Ia.ZYa(this.nJf)}paf(ra){const O=this.tableManager.Dg;if(!O)return!1;ra=ra[u.a.Kc];if(!ra)return!1;switch(Number.parseInvariant(ra)){case 0:return v.d(O);case 1:return v.c(O);case 2:return v.g(O);case 3:return v.e(O);case 4:return v.f(O);case 5:return v.b(O);case 6:return O.hasAutoFilter}return!1}sNf(ra,O){if(h.a.isEmpty(this.sI))return!0;if("PopulateTableMoreStylesMenu"!==
ra&&"PopulateTableAccessibleStylesMenu"!==ra)return!1;if("PopulateTableAccessibleStylesMenu"===ra&&!this.fBc)return this.lOb||(this.lOb=!0,this.Y4a("accessibilityTab")),!0;this.gCb=!0;const da=this.Va.uq("TableStylesMenu"),xa=this.Va.zC("Ribbon.TableTools.TableStyles.Gallery.Custom",7,"Size48by48"),ia=this.Va.zC("Ribbon.TableTools.TableStyles.Gallery.Dark",7,"Size48by48"),Ma=this.Va.zC("Ribbon.TableTools.TableStyles.Gallery.Medium",7,"Size48by48"),Ta=this.Va.zC("Ribbon.TableTools.TableStyles.Gallery.Light",
7,"Size48by48");let Da=-123538519,fa;if(O.MenuId)if(G.a.contains(O.MenuId,"FormatAsTable",!0))Da=753331043,this.$6a=!0;else{fa=D.a.instance.ga(2002);var ua=V.cyb(null,1,"-1");S.EwaSettings.isChangeGateEnabled("OfficeVSO:4185429_NonNullIconNameForSLRGalleryItem")?Ta.Zt("-1",Da,"QueryTableStyle",0,"-1",ua,void 0,void 0,fa):Ta.Zt("-1",Da,"QueryTableStyle",0,"-1",void 0,void 0,void 0,fa);this.$6a=!1}ua=0;const Fa=this.sI;for(let ca in Fa){const ka=Fa[ca];if("PopulateTableAccessibleStylesMenu"===ra&&ka.HasStyleViolations)continue;
let Ca;fa=V.j8e(ka,this.Pwb());Ca=V.cyb(ka,this.kIa);if(ka)switch(ka.Category){case 0:xa.Zt(ka.Index.toString(),Da,"QueryTableStyle",0,ka.Index.toString(),Ca,void 0,void 0,fa);ua++;break;case 3:ia.Zt(ka.Index.toString(),Da,"QueryTableStyle",0,ka.Index.toString(),Ca,void 0,void 0,fa);break;case 2:Ma.Zt(ka.Index.toString(),Da,"QueryTableStyle",0,ka.Index.toString(),Ca,void 0,void 0,fa);break;case 1:Ta.Zt(ka.Index.toString(),Da,"QueryTableStyle",0,ka.Index.toString(),Ca,void 0,void 0,fa)}}0<ua&&this.k2(da,
xa,1970);this.k2(da,Ta,1971);this.k2(da,Ma,1972);this.k2(da,ia,1973);O.MenuItems=da.oE();this.isInitialized||(this.isInitialized=!0);return!0}bld(ra){ra[l.a.On]=!1;let O=ra[u.a.Kc];if(O&&!h.a.isEmpty(this.sI)){G.a.contains(ra.ParentMenuId,"FormatAsTable",!0)?this.$6a=!0:this.$6a=!1;this.$6a||this.rjg();V.Umf(ra)&&(O=this.lxb(O).toString());var da=this.Pwb();ra[l.a.Alt]="-1"===O?D.a.instance.ga(2002):V.j8e(this.ojd(O),da);if(O in this.vTa&&da.equals(this.I0c))this.vNf(ra,O,da,!0);else{if(!this.Otc||
this.Otc&&!this.Otc.gp)this.Ima={},this.Otc=C.a.instance.create(()=>{this.LTf();this.I0c=this.Pwb()},0,x.a.$Qj,!0,!0);this.NGd(da,ra,O)}}}getTableStyleIndexFromName(ra){if(!ra||h.a.isEmpty(this.sI))return-1;if(ra in this.sI)return this.sI[ra].Index;this.Y4a("getTableStyleIndexFromName");return-1}ztd(){return!!this.gL}lxb(ra){this.IN||this.m0c();return ra in this.IN?this.IN[ra]:-1}Y4a(ra){if(this.$.isEditMode){var O=new Date;if(30<B.getElapsedSeconds(this.lastSyncTime,O)||h.a.isEmpty(this.sI)||this.lOb){let da=
this.$.oa.xa.Wb();this.lastSyncTime=O;ra=this.lOb&&"accessibilityTab"===ra||"galleryMenuClosed"===ra;y.m(this.$.oa.xa,ra,this.EUi,this.NDf,null,ra?"accessibility":"normal",da)}}}dispose(){this.IN=this.vTa=this.gL=this.sI=null;this.$.Ia.XJb(this.nJf);super.dispose()}DOg(ra){this.addHandler("RefreshTableStyleGallery",ra)}plj(ra){this.removeHandler("RefreshTableStyleGallery",ra)}m0c(){const ra={};this.tableManager.Dg&&(this.Oda=this.getTableStyleIndexFromName(this.tableManager.Dg.IBc));for(let O=1;7>=
O;O++)ra["preview"+O]=this.NYh(O);this.IN=ra}NYh(ra){var O=this.gL.TableStyleItems.length;O=4>=this.Oda?this.Oda+ra-1:4<this.Oda&&this.Oda<O-4?4===ra?this.Oda:Math.floor(this.Oda+ra-4):this.Oda+ra-1;-1===O||O.toString()in this.vTa||(O=ra-3);return O}rjg(){if(this.tableManager.Dg){let ra=!1;const O=this.getTableStyleIndexFromName(this.tableManager.Dg.IBc);if(O!==this.Oda){if(this.IN){const da=this.IN;for(let xa in da)da[xa]===O&&(ra=!0)}this.Oda=O;ra||h.a.isEmpty(this.vTa)||this.m0c()}}}k2(ra,O,da){const xa=
this.Va.Ec();xa.Hp="Thin";xa.title=D.a.instance.ga(da);xa.buttons.push(O);ra.rc.push(xa)}Pwb(){const ra=this.tableManager.Dg;return this.$6a||!ra?new P(!0,!1,!1,!1,!0,!1):new P(v.d(ra),v.g(ra),v.c(ra),v.e(ra),v.f(ra),v.b(ra))}LTf(ra=!1){const O={},da={},xa=this.Pwb();if(!h.a.isEmpty(this.sI)&&(this.tableManager.Dg&&this.rjg(),!xa.equals(this.I0c)||ra||h.a.isEmpty(this.vTa))){this.kIa=V.LZh(this.kIa);ra=this.sI;for(var ia in ra){const Ma=ra[ia],Ta=V.cyb(Ma,this.kIa);O[Ma.Index.toString()]=V.B4a(V.eta(V.s5b(Ma,
xa)),Ta);da[Ta]=O[Ma.Index.toString()];this.Qza(da)}ia=V.cyb(null,this.kIa,"-1");O["-1"]=V.B4a(V.eta(V.s5b(null,xa)),ia);da[ia]=O["-1"];this.Qza(da);H.c(this.vTa,O,!1)}}rvi(){const ra=m.a(this.$);return ra?ra.pp.Lz===w.a.WIb:!1}NGd(ra,O,da){Number.parseInvariant(da);"-1"===da&&G.a.contains(O.ParentMenuId,"FormatAsTable",!0)||this.vNf(O,da,ra,!1)}vNf(ra,O,da,xa){const ia=V.cyb(null,this.kIa,O);V.Umf(ra)?(ia in this.Ima?da=this.Ima[ia]:(da=V.eta(V.s5b(this.ojd(O),da)),this.Ima[ia]=da),ra[l.a.GalleryButtonProps]=
Object(f.a)(new k.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:ia,Alt:ra[l.a.Alt],MenuItemId:O,TableCellStyles:da,TableStyles:this.X8i})):(ra[t.a.Icon]=ia,ra[l.a.GalleryButtonProps]=Object(f.a)(new n.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:ia,Alt:ra[l.a.Alt],MenuItemId:O}),xa||(xa=[],this.ojd(O),"-1"===O||G.a.contains(ra.ParentMenuId,"FormatAsTable",!0)||(xa=V.s5b(this.gL.TableStyleItems[Number.parseInvariant(O)],da)),this.vTa[O]=V.B4a(V.eta(xa),ia)))}Qza(ra){if(this.gCb)this.Uwc=
()=>{this.Qza(ra)};else{this.Uwc=null;var O=[];for(let xa in ra){var da=xa;da in this.oJb?O.push(da):this.oJb[da]=!0}try{0<O.length&&appChrome.api.unregisterIcons(O),h.a.isEmpty(ra)||appChrome.api.registerIconProvider(()=>ra)}catch(xa){}}}ojd(ra){ra=Number.parseInvariant(ra);if(-1===ra||!this.gL)return null;if(60<ra)for(let O=60;O<this.gL.TableStyleItems.length;++O){const da=this.gL.TableStyleItems[O];if(da.Index===ra)return da}return this.gL.TableStyleItems[ra]}}Object(r.a)(Y,"TableStyleManager",
z.a,[252,2]);var Z=a(55);a.d(F,"a",function(){return ea});class ea extends c.a{constructor(ra){super();this.tableStyleManager=null;this.$=ra;this.Db()}create(){const ra=b.GetServiceTaskFactory.create(this.$.da,102,this.la,this.Xa),O=b.GetServiceTaskFactory.Oa(this.$.da,66,134,this.Xa);e.TaskExtensions.za(Z.Task.aG(ra,O),()=>{this.nb(this.tableStyleManager||(this.tableStyleManager=new Y(this.$,ra.result,O.result)))},this.$.la,8)}}Object(r.a)(ea,"TableStyleManagerFactory",c.a,[])},1255:function(r,F,
a){r=a(0);var c=a(226),b=a(15),e=a(168),f=a(250),d=a(378),h=a(4),l=a(653),k=a(88),t=a(96),n=a(263),z=a(166),w=a(77),m=a(425),u=a(50),y=a(37),v=a(94),C=a(74),x=a(1),B=a(575),H=a(21),I=a(33);class U extends t.a{constructor(aa,V){super(aa);this.NS=[];this.uce=null;this.OKb=P=>{let ba="forward";P.Values[d.a.direction]?ba=P.Values[d.a.direction].toLowerCase():b.ULS.sendTraceTag(537166664,0,15,"Didn't find direction in message values");P=0;let Y=!0;"backward"===ba?(P=this.Mud.length-1,Y=!1):"forward"===
ba?(P=0,Y=!0):b.ULS.sendTraceTag(537166663,0,15,`Received unknown direction to resume focus: ${ba}`);this.vwf(Y,P,!1)};this.NEf=()=>{this.NS=[]};this.XOa=P=>{-411645385===this.$.shortcutKeyManager.mt(P,!0)&&this.Ljf()&&(this.$.Ia.Hb(new v.a(-411645385,1,this.$.xc,6,null),{["event"]:P},P),P.stopPropagation())};this.$Vi=P=>{this.kma(P)};this.jb=V;this.Wt=H.h(this.jb);this.Cc.ka("keydown",this.$Vi);this.Cc.ka("keyup",this.XOa);n.a(V).POg(this.NEf);w.a(V.ya,27)&&y.TaskExtensions.za(u.GetServiceTaskFactory.Oa(V.da,
21,137,1),P=>{P=P.result;P.$n(e.a.Kcf);P.Dl(e.a.Kcf,this.OKb)},V.la)}get $(){return this.jb}get Mud(){this.NS.length||(this.NS=this.l4e());return this.NS}get jla(){return this.uce}set jla(aa){this.uce=aa;this.NS=this.l4e()}dispose(){this.$&&n.a(this.$).Dlj(this.NEf);this.jb=null;this.NS.length=0;super.dispose()}H9i(aa){this.kma(aa)}vwf(aa,V,P=!0,ba=null){var Y=this.oQj(aa,V,P,ba);if(!Y){P=V;var Z=aa?1:-1,ea=this.Mud;do{Y=!1;if(w.a(this.$.ya,27)){if(P+=Z,P>=ea.length||0>P)Y=!0}else P=(P+Z+ea.length)%
ea.length;if(Y){this.$Ei(aa,V,ba);break}else if(Y=this.qdg(aa,V,P,!1,ba))break}while(P!==V)}}oQj(aa,V,P=!0,ba=null){let Y=null;0<=V&&(Y=this.NS[V]);return(null===Y||void 0===Y?0:Y.Ff)&&Y.ag(aa,P)?(ba&&C.g(ba),b.ULS.sendTraceTag(537166669,0,50,`Switched focus inside current section ${Y.Xd} into a sub region`),Y.rj(),!0):!1}qdg(aa,V,P,ba,Y=null){P=this.NS[P];if(x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)){const Z=n.a(this.jb).mw(f.a.Iua),ea=n.a(this.jb).mw(f.a.kyb),
ra=this.Wt.ha.Ra.O4;if(P===ea&&ra||P===Z&&!ba&&!ra)return!1}if((null===P||void 0===P?0:P.Ff)&&P.ag(aa,!1)){Y&&C.g(Y);P.rj();if(aa=this.NS[V])aa.dk(),b.ULS.sendTraceTag(537166668,0,50,`Switched focus from section ${aa.Xd} to ${P.Xd}`);return!0}return!1}$Ei(aa,V,P=null){P&&C.g(P);if(V=this.NS[V])V.dk(),b.ULS.sendTraceTag(537166666,0,50,`Lost focus from section ${V.Xd}`);y.TaskExtensions.za(u.GetServiceTaskFactory.Oa(this.$.da,21,137,0),ba=>{ba.result.jj(e.a.snb,{[d.a.direction]:aa?"forward":"backward"})},
this.$.la)}kma(aa){var V=this.$.isEditMode?z.a(this.$):null;if(!this.$.qb.Xwa||U.qqi(V))if(117===aa.keyCode&&(aa.ctrlKey||C.b(aa))){V=this.f7e(aa.target);var P=!aa.shiftKey;b.ULS.sendTraceTag(537166662,0,50,`AccessibilityManager.OnKeyDownHandler: Ctrl+F6 loop. The root index section is: ${V}`);if(x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)){var ba=n.a(this.jb).mw(f.a.TKb);ba=this.NS.indexOf(ba);h.AFrameworkApplication.sa.Qa.vw&&this.$.WZ&&-1!==ba&&V===ba&&l.ShyRibbon.fJ(this.$.Geb,
0)}else h.AFrameworkApplication.sa.Qa.vw&&this.$.WZ&&1===V&&l.ShyRibbon.fJ(this.$.Geb,0);this.vwf(P,V,!0,aa)}else 117!==aa.keyCode||U.PWe?-411645385===this.$.shortcutKeyManager.mt(aa)?this.Ljf()&&(this.$.Ia.Hb(new v.a(-411645385,1,this.$.xc,6,null),{["event"]:aa},aa),aa.stopPropagation()):1588554917===this.$.shortcutKeyManager.mt(aa)?0===this.mode?(B.a(this.$)||this.$.Ia.Hb(new v.a(1588554917,1,this.$.xc,6,null),{["event"]:aa},aa),aa.preventDefault(),aa.stopPropagation()):3===this.mode&&(aa.preventDefault(),
aa.stopPropagation()):x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)&&1058684758===this.$.shortcutKeyManager.mt(aa)?(V=this.f7e(aa.target),ba=n.a(this.jb).mw(f.a.TKb),P=n.a(this.jb).mw(f.a.Iua),ba=this.NS.indexOf(ba),P=this.NS.indexOf(P),h.AFrameworkApplication.sa.Qa.vw&&this.$.WZ&&-1!==ba&&V===ba&&1===this.$.Geb&&l.ShyRibbon.fJ(1,0),-1!==P&&V!==P&&this.qdg(!0,V,P,!0,aa)):this.A9h(aa):(aa=m.a.WI.notificationBar.M$(k.a.LUh(),!1),I.a.JBb()?aa.image=3:aa.image=0,m.a.WI.notificationBar.gE(aa),
U.PWe=!0)}f7e(aa){const V=this.Mud;for(let P=0,ba=V.length;P<ba;++P){const Y=V[P];if(Y&&Y.sh(aa))return P}return-1}l4e(){const aa=[];for(let V=0,P=this.jla.length;V<P;V++){const ba=n.a(this.$).mw(this.jla[V]);ba&&aa.push(ba)}return aa}Ljf(){return 0===this.mode||4===this.mode}static qqi(aa){return aa?aa.inKeytipMode:!1}}U.PWe=!1;Object(r.a)(U,"AccessibilityManager",t.a,[728,2]);var S=a(153),G=a(22),D=a(13);class E extends U{constructor(aa){super(document.documentElement,aa);this.TB=0;this.DVg=[f.a.CGe,
f.a.kBd,f.a.Zec,f.a.cZd,f.a.TKb,f.a.o0c,f.a.Udd,f.a.N9e,f.a.y_c,f.a.QBc,f.a.BLj,f.a.kyb,f.a.x1c,f.a.Iua,f.a.qTd,f.a.D1c,f.a.Obg,f.a.Aqf,f.a.T_c];this.B5j=[f.a.Zec,f.a.Hmg,f.a.Gmg,f.a.Img];this.i9i=[f.a.Zec,f.a.VOf,f.a.WOf,f.a.YOf];this.C2g=[f.a.JZe,f.a.M9e,f.a.Sdd,f.a.Qdd];this.M8i=[f.a.CGe,f.a.kBd,f.a.o0c,f.a.Udd,f.a.y_c,f.a.QBc,f.a.kyb,f.a.x1c,f.a.Iua,f.a.qTd,f.a.sOf,f.a.D1c,f.a.T_c];this.Y8i=[f.a.kyb,f.a.OZe];const V=D.a.instance.Ta(253);this.ezj=this.$.shortcutKeyManager.gxb(V);this.mode=0;aa.da.Ha(15,
this);y.TaskExtensions.za(u.GetServiceTaskFactory.Oa(aa.da,21,137,1),P=>{P=P.result;P.$n(e.a.snb);P.Dl(e.a.snb,this.OKb)},aa.la)}get mode(){return this.TB}set mode(aa){this.TB=aa;switch(aa){case 0:this.jla=this.DVg;break;case 2:this.jla=this.B5j;break;case 3:this.jla=this.i9i;break;case 4:this.jla=this.C2g;break;case 5:this.jla=this.M8i;break;case 6:this.jla=this.Y8i;break;default:b.ULS.shipAssertTag(537170759,0,!0,"Accessibility Mode value is not in allowed values")}}kma(aa){this.$.qd&65536&&super.kma(aa)}A9h(aa){if(G.a.equals(this.ezj,
this.$.shortcutKeyManager.Wgd(aa),!1)){const V=S.b(this.$);if(null===V||void 0===V?0:V.Ff)C.g(aa),V.ag(!0,!1)}}}Object(r.a)(E,"EwaAccessibilityManager",U,[]);class N extends c.a{constructor(aa){super();this.$=aa;this.Db()}create(){this.nb(this.$.da.Aa(15)||new E(this.$))}static ka(aa){aa.da.Ha(157,new N(aa))}}Object(r.a)(N,"AccessibilityManagerFactory",c.a,[]);var M=a(9);a.d(F,"a",function(){return L});const L=()=>{M.a.Fa(N.ka)}},1256:function(r,F,a){var c=a(9),b=a(161);r=a(0);var e=a(15),f=a(226),
d=a(37),h=a(51),l=a(1),k=a(288),t=a(217);class n{}n.lTe="ewa-svg-icon";Object(r.a)(n,"CssClassNames",null,[]);var z=a(50),w=a(12),m=a(316),u=a(204),y=a(187),v=a(105);class C{constructor(H,I){this.htmlSanitizationHelper=null;this.Jf=()=>{this.Fqf();this.$.ea.Cn(this.Jf)};this.$=H;this.pdg={};this.EXd={};this.htmlSanitizationHelper=I;(I=this.V3e("excelInitialAppSprite"))?(this.Ppe(I),this.$.ea.Zf?this.Fqf():H.ea.Dk(this.Jf),this.$.da.Ha(388,this)):e.ULS.sendTraceTag(537151263,0,15,"window[excelInitialAppSprite].icons returned null.")}dispose(){this.EXd=
null;this.$.ea.Cn(this.Jf)}Oja(H,I,U=null,S=null){let G;(G=this.EXd[H])||(this.EXd[H]=G=this.v4i(this.pdg[H]));if(!G)return e.ULS.shipAssertTag(537151262,0,!1,`SvgIconProvider.GetSvgElement: id ${H} was not found in loaded SVG sprites.`),null;const D=G.cloneNode(!0);if(!D.style){const E=m.b(G),N=m.b(D),M={};M.iconId=H;M.isOriginalNodeStyleNull=void 0===G.style||null===G.style;M.isOriginalNodeCurrentStyleNull=void 0===G.currentStyle||null===G.currentStyle;M.isClonedNodeCurrentStyleNull=void 0===D.currentStyle||
null===D.currentStyle;M.originalNode=E.substring(0,E.indexOf(">")+1);M.clonedNode=N.substring(0,N.indexOf(">")+1);e.ULS.sendTraceTag(537151261,0,10,`SvgIconProvider.GetSvgElement: cloned element's style is undefined. data: ${JSON.stringify(M)}`)}D.setAttribute("style",`height: ${I}px; width: ${I}px;`);S&&(H=document.createElement("title"),l.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&l.EwaSettings.isChangeGateEnabled("OfficeVSO:7128638_SvgIconProviderInnerHtmlCleanup")?
this.htmlSanitizationHelper.Rh(H,S):H.innerHTML=S,D.insertBefore(H,D.childNodes[0]));if(U)for(const E of U)Sys.UI.DomElement.addCssClass(D,E);return D}pba(H,I,U,S,G=0,D=0,E=null,N=null){G&&D||(D=w.DOMElementExtensions.getBoundingClientRect(S),G=D.height,D=D.width);if(E=this.Oja(H,I,E,N))S.appendChild(E),(S=w.DOMElementExtensions.lZ(E,"style",null))?E.setAttribute("style",S+` margin: ${(G-I)/2}px ${(D-U)/2}px;`):e.ULS.sendTraceTag(537151260,0,10,`SvgIconProvider.InsertAndCenterSvgElement: svgElement's GetAttribte("styl") returned null. Icon ID: ${H}`);
return E}Fqf(){l.EwaSettings.isChangeGateEnabled("OfficeVSO:7457857_DynamicScriptLoaderNewService")?void y.a.resolve(v.d,{Tl:0}).then(H=>H("excel-uiSlice20-sprite")).then(()=>this.Ope()):d.TaskExtensions.za(z.GetServiceTaskFactory.Oa(this.$.da,283,284,0),H=>{H=u.c(H.result.Hl.loadScript("excel-uiSlice20-sprite"));d.TaskExtensions.za(H,()=>{this.Ope()},this.$.la,3)},this.$.da.la,3)}Ope(){const H=this.V3e("excelUiSlice20Sprite");H?this.Ppe(H):e.ULS.sendTraceTag(537151259,0,15,"window[excelUiSlice20Sprite].icons returned null.")}Ppe(H){for(const I of H)I.type===
t.a.CXd&&(this.pdg[I.id]=I)}v4i(H){if(!H)return null;const I=H.viewBox;H=H.children;const U=document.createElementNS(k.a.FXd,t.a.CXd);Sys.UI.DomElement.addCssClass(U,n.lTe);U.setAttribute("focusable","false");U.setAttribute("viewBox",I);this.VKg(U,H);return U}VKg(H,I){for(const S of I){const G=document.createElementNS(k.a.FXd,S.type);for(let D in S){I=D;var U=S[D];"className"===I?G.setAttribute("class",U):G.setAttribute(I,U)}H.appendChild(G)}}V3e(H){return(H=window[H])?H.icons:null}}Object(r.a)(C,
"SvgIconProvider",null,[706,2]);class x extends f.a{constructor(H){super();this.$=H;this.Db()}create(){const H=this.CAi();if(l.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&l.EwaSettings.isChangeGateEnabled("OfficeVSO:7128638_SvgIconProviderInnerHtmlCleanup")){const I=z.GetServiceTaskFactory.Oa(this.$.da,498,499,0);d.TaskExtensions.za(d.TaskExtensions.Fd([H,I],this.$.la),()=>{window.excelInitialAppSprite?this.nb(this.$.da.Aa(388)||new C(this.$,I.result)):e.ULS.sendTraceTag(537151258,
0,50,"window.[excelInitialAppSprite] returned null.")},this.la,3)}else d.TaskExtensions.za(H,()=>{window.excelInitialAppSprite?this.nb(this.$.da.Aa(388)||new C(this.$,null)):e.ULS.sendTraceTag(509694111,0,50,"window.[excelInitialAppSprite] returned null.")},this.la,3)}CAi(){if(l.EwaSettings.isChangeGateEnabled("OfficeVSO:7521802_OnboardWdAppChromeVersion")){let H;H=l.EwaSettings.isChangeGateEnabled("OfficeVSO:7457857_DynamicScriptLoaderNewService")?y.a.resolve(v.d,{Tl:this.Xa}).then(I=>Object(b.a)(this,
void 0,void 0,function*(){return I("excel-app-intl")})):z.GetServiceTaskFactory.Oa(this.$.da,283,284,this.Xa).result.Hl.loadScript("excel-app-intl");return Object(u.c)(H)}return h.a.ZQ([129],4,this.Xa,void 0,void 0,void 0,387)}static ka(H){H.da.Ha(387,new x(H))}}Object(r.a)(x,"SvgIconProviderFactory",f.a,[]);a.d(F,"a",function(){return B});const B=()=>{c.a.Fa(x.ka)}},1281:function(r,F,a){var c=a(9);r=a(0);var b=a(226),e=a(21),f=a(479);class d extends f.a{constructor(k,t){super(k);t.Ha(240,this)}U3h(k){for(const t of this.rangeList)if(k.range.contains(t))return t;
return null}lJd(k){return k.GridBlockModel&&(k=gridRenderer.CanvasRendererFactoryGlobal.getModelAccessor(k.GridBlockModel))?k.getSparklineRanges():null}}Object(r.a)(d,"SparklineManager",f.a,[700]);class h extends b.a{constructor(k){super();this.sparklineManager=null;this.$=k;this.Db()}create(){this.nb(this.sparklineManager||(this.sparklineManager=new d(e.h(this.$),this.$.da)))}static ka(k){k.da.Ha(239,new h(k))}}Object(r.a)(h,"SparklineManagerFactory",b.a,[]);a.d(F,"a",function(){return l});const l=
()=>{c.a.Fa(h.ka)}},1302:function(r,F,a){r=a(0);var c=a(149),b=a(604);class e extends b.a{constructor(){super()}dispose(){c.WacAirSpace.dpd()&&c.WacAirSpace.yCc()}animate(h,l,k,t,n){l&&c.WacAirSpace.XK(h.element,l);c.WacAirSpace.animate(h,t,n);k&&c.WacAirSpace.Jhj(h.element,k)}}Object(r.a)(e,"AnimationManager",b.a,[2]);var f=a(102);a.d(F,"a",function(){return d});const d=()=>{f.a.Pl.Ha(141,new e)}},1480:function(r,F,a){a.r(F);r=a(1224);F=a(1187);var c=a(1146),b=a(1147),e=a(1148),f=a(1150);a(1149);
var d=a(1255),h=a(1302),l=a(9),k=a(0),t=a(226),n=a(192),z=a(552),w=a(15),m=a(826),u=a(519),y=a(83),v=a(4),C=a(81),x=a(925);class B extends C.a{constructor(D){super();this.Kvd=null;this.$=D;w.ULS.sendTraceTag(537155201,0,50,"NewAndOpenCoreManager created")}mqj(){const D=new n.a,E=u.a.Rq(y.a.instance.Tb("Common.IEventEmitter<Common.IMruResult>")),N=new z.a(()=>E.result);this.Kvd=new z.a(()=>new m.a(N.value,null));if(!this.Kvd)return D;var M=this.Kvd.value.vZ("NewAndOpenCoreManager",!1);if(!M||3!==M.state||
!M.Uzd)return M?w.ULS.sendTraceTag(544289226,0,50,`NewAndOpenCoreManager.RetrieveMruFiles - the mruResult state: ${M.state}, mruResult MruDocuments is null: ${!M.Uzd}`):w.ULS.sendTraceTag(544289227,0,50,"NewAndOpenCoreManager.RetrieveMruFiles: the mruResult is null"),null;M=M.Uzd;const L=["xlsx","xlsb","xlsm"];for(let V=0;V<M.length;V++){var aa=M[V];if(0>Array.indexOf(L,aa.extension))continue;const P=`${aa.title}.${aa.extension}`,ba=x.b(aa,v.AFrameworkApplication.isRtl);aa=aa.url;P&&ba&&aa?D.add({[B.fileName]:P,
[B.friendlyPath]:ba,[B.section]:"mru",[B.absoluteUrl]:aa}):aa||w.ULS.sendTraceTag(537155200,0,50,"ChangeSourceDialog.GetMruFiles: the DAV url of the file is null")}return D}dispose(){super.dispose()}}B.fileName="FileName";B.friendlyPath="FriendlyPath";B.section="Section";B.absoluteUrl="AbsoluteUrl";Object(k.a)(B,"NewAndOpenCoreManager",C.a,[704,2]);class H extends t.a{constructor(D){super();this.$=D;this.Db()}create(){this.nb(this.$.da.Aa(451)||this.$.da.Ha(451,new B(this.$)))}static ka(D){D.da.Ha(164,
new H(D))}}Object(k.a)(H,"NewAndOpenCoreFactory",t.a,[]);k=a(1179);t=a(1281);C=a(1256);var I=a(1225),U=a(1182),S=a(1173),G=a(1192);a=a(1166);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.GridHighlightsBehavior");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SheetTabBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SvgIconProvider");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Table");Type.registerNamespace("_Ewa");Object(r.a)();Type.registerNamespace("Common.App.AltTextDialog");
Object(F.a)();Object(c.a)();Object(b.a)();Object(e.a)();Object(d.a)();l.a.Fa(H.ka);Object(h.a)();Object(k.a)();Object(t.a)();Object(C.a)();Object(f.a)();Object(I.a)();Object(U.a)();Object(S.a)();Type.registerNamespace("Common.App.SessionExpiration");Object(G.a)();Object(a.a)()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.acc.js.map/ae90ec2b4c182873330b4a36b0f6ef3a/EwaDSEsNext.acc.js.map
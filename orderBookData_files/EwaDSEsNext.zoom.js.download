'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[27],{1154:function(r,F,a){a.d(F,"a",function(){return b});var c=a(512);const b=()=>{c.a.Bi(".ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{background:linear-gradient(120deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{background:linear-gradient(300deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{background:linear-gradient(30deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{background:linear-gradient(210deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:start:decrement,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:end:increment,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-thumb{width:calc(16px/var(--zoom-level,1));height:calc(16px/var(--zoom-level,1));border:solid calc(1px/var(--zoom-level,1)) #363636;background-color:#b1b1b1}@media screen and (-ms-high-contrast:active){.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar{background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-thumb{background-color:WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-corner{background-color:Window}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(120deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(300deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(30deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(210deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}}")}},
1478:function(r,F,a){a.r(F);var c=a(9);r=a(0);var b=a(709),e=a(15),f=a(841),d=a(8),h=a(68),l=a(189),k=a(377),t=a(34),n=a(55);class z{constructor(O){this.$=O}Hc(){return!1}executeCommand(O,da,xa){let ia=!1;O=da.command;const Ma=t.a(this.$);11!==da.Ve&&7!==da.Ve&&6!==da.Ve&&2!==da.Ve&&14!==da.Ve&&15!==da.Ve&&16!==da.Ve&&e.ULS.sendTraceTag(537149787,0,15,`ZoomCommandHandler.ExecuteCommand - unsupported zoom origin ${da.Ve}`);const Ta=6===da.Ve;switch(da.command){case -1365094462:case -1441674458:Ma.YFc(Math.floor(10*
Ma.zoom)/10+.1,Ta);ia=!0;break;case 1056010365:case 1664364901:Ma.YFc(Math.ceil(10*Ma.zoom)/10-.1,Ta);ia=!0;break;case 346087880:Ma.YFc(d.a.v_,Ta);ia=!0;break;case -1918142559:case 1517993347:h.a.Kc in xa?(xa=parseFloat(xa[h.a.Kc]),xa!==Ma.zoom&&Ma.XFc(xa,1517993347===da.command),ia=!0):e.ULS.shipAssertTag(537149786,0,!1,"ZoomCommandHandler.ExecuteCommand - no MenuItemIdKey");break;case -2096586688:case -581733362:da=parseFloat(xa[f.a.Value]);isNaN(da)||Ma.XFc(da/100,!0);ia=!0;break;case 1409187195:Ma.zoomFitToScreen();
ia=!0;break;case -1836771825:Ma.zoomFitToScreenUndo(),ia=!0}return ia?n.Task.Sa(!0):l.a(O)}wc(O,da){switch(da.command){case -1441674458:case 1664364901:case -1918142559:case 346087880:case 1517993347:case -581733362:case 1409187195:case -1836771825:return t.a(this.$).eX();case -1365094462:case 1056010365:case -2096586688:return k.a(this.$);default:return!1}}Nc(){return!1}}Object(r.a)(z,"ZoomCommandHandler",null,[222]);class w extends b.a{constructor(O){super(O)}hd(){this.$c([new z(this.$)])}static ka(O){b.a.Md(370,
new w(O))}}Object(r.a)(w,"ZoomCommandHandlerFactory",b.a,[]);F=a(226);var m=a(89),u=a(27),y=a(83),v=a(544),C=a(49),x=a(5),B=a(166),H=a(65),I=a(294),U=a(127),S=a(41),G=a(33),D=a(12),E=a(11),N=a(106),M=a(21),L=a(309),aa=a(128);class V{constructor(O){this.f6a=this.jgc=0;this.u3b=null;this.Kif=!1;this.$=O;this.Kif=O.rkc}Jpi(){return M.h(this.$).fb?(e.ULS.sendTraceTag(537149795,0,50,"PinchToZoomAdapter.IsGesturePossible A cell is being edited -> don't allow pinch"),!1):this.$.qb.uv?(e.ULS.sendTraceTag(537149794,
0,50,"PinchToZoomAdapter.IsGesturePossible A modal dialog is opened -> don't allow pinch"),!1):!0}YSi(O){this.u3b=new Sys.UI.Point(Math.round(O.Wua.center.x),Math.round(O.Wua.center.y));this.jgc=t.a(this.$).zoom;this.f6a=O.Wua.scale;let da={["InitialZoom"]:this.jgc,["Location"]:"canvas",["InputMethod"]:O.vb};aa.b(this.$).rd(U.a.E5i,da);e.ULS.sendTraceTag(537149793,0,50,`PinchToZoomAdapter.OnGestureStart starting gesture. center (${this.u3b.x},${this.u3b.y}), initial zoom ${this.jgc}, initial scale ${this.f6a}`);
this.t9a(O,"onGestureStart");return!0}XSi(O){if(!this.f6a)return e.ULS.shipAssertTag(537149792,0,!1,"PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be 0"),this.t9a(O,"OnGestureEvent"),!0;if(!isFinite(this.f6a))return e.ULS.sendTraceTag(537149791,0,15,`PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be infinite. initialPinchScale=${this.f6a}`),this.t9a(O,"OnGestureEvent"),!0;const da=O.Wua.scale/this.f6a*this.jgc;t.a(this.$).jog(da,this.u3b);e.ULS.sendTraceTag(537149790,
0,50,`PinchToZoomAdapter.OnGestureEvent processing gesture. New zoom ${da}. Current scale ${O.Wua.scale}`);this.t9a(O,"OnGestureEvent");return!0}WSi(O){t.a(this.$).kog();e.ULS.sendTraceTag(537149789,0,50,"PinchToZoomAdapter.OnGestureEnd end of gesture");this.t9a(O,"OnGestureEnd")}VSi(O){e.ULS.sendTraceTag(537149788,0,50,"PinchToZoomAdapter.OnGestureCancel gesture canceled");this.t9a(O,"OnGestureCancel")}t9a(O,da){var xa,ia,Ma;this.Kif&&(e.ULS.sendTraceTag(536990857,0,50,`PinchToZoomAdapter.markGestureEventAsHandled - Invoked from ${da},        eventArgs non-null: ${isNullOrUndefined(O)}, gestureData non-null: ${isNullOrUndefined(null===
O||void 0===O?void 0:O.Wua)},        srcEvent non-null: ${isNullOrUndefined(null===(xa=null===O||void 0===O?void 0:O.Wua)||void 0===xa?void 0:xa.srcEvent)}`),null===(Ma=null===(ia=null===O||void 0===O?void 0:O.Wua)||void 0===ia?void 0:ia.srcEvent)||void 0===Ma?void 0:Ma.preventDefault())}}Object(r.a)(V,"PinchToZoomAdapter",null,[291]);var P=a(38);class ba extends P.a{constructor(){super()}Xre(O){this.addHandler("ZCIEK",O)}hXf(O){this.removeHandler("ZCIEK",O)}$Xc(O){this.addHandler("ZCUIK",O)}CMd(O){this.removeHandler("ZCUIK",
O)}dcj(){this.raiseEvent("ZCIEK")}ccj(){this.raiseEvent("ZCUIK")}ecj(){this.raiseEvent("ZCEK")}}Object(r.a)(ba,"ZoomEventManager",P.a,[290]);var Y=a(22);class Z extends P.a{constructor(O){super();this.statusBarManager=null;this.PZe=!1;this.$=O;this.$.da.gb(29,da=>{this.statusBarManager=da;da.$I(this)})}pq(O){this.addHandler("Zoom",O)}Lq(O){this.removeHandler("Zoom",O)}rz(){this.un("QueryZoomStatus")&&this.raiseEvent("Zoom")}Tr(O,da){return"QueryZoomStatus"!==O?!1:this.R$h(da)}un(){return t.a(this.$).eX()}dispose(){this.statusBarManager&&
(this.statusBarManager.yF(this),this.statusBarManager=null);this.$=null;super.dispose()}j9e(O){O=this.d7h(O);if(!O)return null;O=O.getElementsByClassName("cui-ctl-mediumlabel");return 1!==O.length?(e.ULS.shipAssertTag(537149764,0,!1,"ZoomStatusBarManager.GetZoomUIElement Cannot find zoom label element"),null):O[0]}R$h(O){if(!this.$)return!1;const da=t.a(this.$).lRb,xa=this.j9e("HandleQueryZoomStatusCommand");xa?Y.a.equals(O.LabelText.toString(),da,!1)||(xa.innerText="",this.y5f(O,da)):this.y5f(O,
da);return!0}y5f(O,da){O.LabelText=da}d7h(O){var da=D.DOMElementExtensions.getElementById(this.$.domElement,"m_excelWebRenderer_ewaCtl_zoomLevel-Medium14");if(!da)return da=(da=this.$.ea.$b)?da.inEmbedView:!1,u.a.fp||da||e.ULS.sendTraceTag(537149763,0,15,`ZoomStatusBarManager.GetZoomBaseElement Cannot find zoom label. Called from ${O}`),null;this.PZe||(this.PZe=!0,e.ULS.sendTraceTag(537149762,0,50,`ZoomManager.GetZoomBaseElement - Zoom label was found first time. Called from ${O}`));return da}}Object(r.a)(Z,
"ZoomStatusBarManager",P.a,[2,200,201]);class ea extends v.a{constructor(O){super(O);this.zoomEventManager=this.wxa=this.dDb=null;this.hDb=-1;this.Iif=!1;this.Uc=()=>{this.hDb=-1};e.ULS.sendTraceTag(537149785,0,50,"AppZoom feature is Enabled.");this.bhb=new Z(O);this.F5i()&&(e.ULS.sendTraceTag(537149784,0,50,"ZoomManager.ZoomManager Attaching pinch to zoom events"),this.bUg());this.phj()}dispose(){this.bhb&&(m.a.Ja(this.bhb),this.bhb=null);this.zoomEventManager&&(this.$.da.jU(419),this.zoomEventManager=
null);this.Iif&&this.umh();super.dispose()}eX(){return!0}jog(O,da){O=this.NJa(O);if(M.h(this.$).rtl){const xa=Math.round(D.DOMElementExtensions.getBounds(this.$.rf).width*t.a(this.$).zoom);this.dDb=new Sys.UI.Point(xa-da.x,da.y)}else this.dDb=da;this.cSa(O,!1,"ZoomWithPinch")}WFc(){return!0}VFc(O,da){var xa=u.a.isMac?.07:.15;O=this.zoom+(O?xa:-xa);O=this.NJa(O);M.h(this.$).rtl?(xa=Math.round(D.DOMElementExtensions.getBounds(this.$.rf).width*t.a(this.$).zoom),this.wxa=new Sys.UI.Point(xa-da.x,da.y)):
this.wxa=da;da=this.zoom;this.cSa(O,!0,"ZoomWithMouse");da={["InitialZoom"]:da,["FinalZoom"]:O,["Location"]:"canvas"};aa.b(this.$).rd(U.a.Y7j,da)}kog(){this.dDb=null}XFc(O,da){this.cSa(this.NJa(O),!1,da?"ZoomWithDropDownFromRibbon":"ZoomWithDropDown")}mog(O){isNaN(O)?e.ULS.sendTraceTag(537149783,0,15,"ZoomManager.ZoomToSelectionForFollowAlongInExcelLive: Invalid zoom value was provided"):this.cSa(this.NJa(O),!1,"ZoomToLevelInExcelLive")}YFc(O,da){this.cSa(this.NJa(O),!0,da?"ZoomWithShortcuts":"ZoomWithButtons")}b7e(O,
da){const xa=M.h(this.$).rtl,[ia,Ma]=this.Xhd(xa),[Ta,Da]=this.Sjd(O,Ma);return this.wxa?(O=this.Hhd(this.wxa,O,da,Ma,ia,"ZoomWithMouse"),this.wxa=null,O):this.dDb?this.Hhd(this.dDb,O,da,Ma,ia,"ZoomWithPinch"):M.h(this.$).ha.Ra.O4?this.X7j(O,da,Ma,ia,Ta,Da,M.h(this.$).rtl):this.Z7j(O,da,Ma,ia,Ta,Da,M.h(this.$).rtl)}$1f(O,da,xa){if(O){e.ULS.sendTraceTag(537149782,0,50,`Zoom To: (${O.x} ${O.y}) (new top-left) from zoom:${da} to zoom:${xa}`);O=new C.a(O.x,O.y);xa=M.h(this.$).rtl;[,xa]=this.Xhd(xa);const [ia,
Ma]=this.Sjd(da,xa);M.h(this.$).Ase(O,ia,Ma,"ApplicationZoom")}else e.ULS.sendTraceTag(537149781,0,50,`Zooming top-left: from zoom:${da} to zoom:${xa}`)}zoomFitToScreen(){const O=this.zoom;var da=M.h(this.$).rtl;const [xa,ia]=this.Xhd(da),[Ma,Ta]=this.Sjd(O,ia);var Da=M.h(this.$).ha.Ra.O4;(da=Da?this.e3e(this.fab,Ma,Ta,!1):this.k7e(this.fab,ia,xa,Ma,Ta,da,!1))?(da=Math.min(Ma/(da.width+100),Ta/(da.height+100)),da=this.zIh(da),this.cSa(da,!0,"ZoomWithFitToScreen"),Da?M.h(this.$).ha.Ra.Msa(M.h(this.$).ha.Ra.dc,
!1):(Da=S.v(M.h(this.$).ha.qa.activeRange,this.$),M.h(this.$).qg(Da,null,null,null,3,"ZoomManager.ZoomFitToScreen")),this.hDb=O,this.Iif||this.ZTg()):e.ULS.sendTraceTag(537149780,0,15,`ZoomManager.ZoomFitToScreen: Bounds found to be null with FloatingObjectSelected: ${Da}`)}zoomFitToScreenUndo(){this.cSa(this.hDb,!1,"ZoomWithFitToScreen")}kUd(){return-1!==this.hDb}ZTg(){const O=M.h(this.$);O&&(O.ha.eC(this.Uc),O.jE(this.Uc))}umh(){const O=M.h(this.$);O&&(O.ha.vB(this.Uc),O.AF(this.Uc))}zIh(O){O=Math.min(O,
d.a.WHi);O=Math.max(O,d.a.PIi);return Math.round(100*O)/100}cSa(O,da,xa){if(this.TFc()){var ia=M.h(this.$).view.visibleArea.toString();O=this.NJa(O);var Ma=H.d(this.$.va.na);Ma||(Ma=v.a.Mxf);M.h(this.$).wh.z0(5,L.a.SFc,xa);M.h(this.$).wh.Fla(L.a.SFc,this.$.ea.se);e.ULS.sendTraceTag(537149779,0,50,`ZoomManager.SetNewZoomLevel Setting zoom ${O} to sheet ${Ma} origin ${xa} prevZoom ${this.zoom}`);this.ICj(Ma,O);this.zoomEventManager.ecj();this.xVj(xa);this.IVj(da);this.hDb=-1;k.b(this.$,xa);O=M.h(this.$).view.visibleArea.toString();
e.ULS.sendTraceTag(537149778,0,50,`ZoomManager.SetNewZoomLevel OldGridVisibleArea: ${ia}, NewGridVisibleArea: ${O}, IsShyRibbonActive: ${this.$.WZ}`)}}bSh(O){return(O=E.HelperMethods.PC(this.$.rf,this.$.domElement,O))?O:new Sys.UI.Point(0,0)}Xhd(O){const da=this.bSh(O);O=this.NWh(da,O);return[da,O]}Sjd(O,da){const xa=D.DOMElementExtensions.getBounds(this.$.rf);return[Math.round((xa.width-da.x)*O),Math.round((xa.height-da.y)*O)]}NWh(O,da){da=E.HelperMethods.PC(M.h(this.$).domElement,this.$.domElement,
da);return da?(O=new Sys.UI.Point(Math.round(da.x-O.x),Math.round(da.y-O.y)),O):new Sys.UI.Point(0,0)}Z7j(O,da,xa,ia,Ma,Ta,Da){return(Da=this.k7e(O,xa,ia,Ma,Ta,Da))?this.Z5e(Da,O,da,xa,ia,Ma,Ta):null}k7e(O,da,xa,ia,Ma,Ta,Da=!0){var fa=S.F(M.h(this.$).ha.qa.selectedRanges);if(Da&&(fa=fa.we(S.F(M.h(this.$).Pdc())),!fa))return e.ULS.sendTraceTag(537149777,0,50,"ZoomManager.GetSelectedRangeBounds No range inside the viewport is selected."),null;const ua=M.h(this.$).Pb(fa.topLeft);fa=M.h(this.$).Pb(fa.bottomRight);
if(!ua||!fa)return e.ULS.sendTraceTag(537149776,0,15,"ZoomManager.GetSelectedRangeBounds Cannot get cells for top-left or bottom-right of the selected range. Will zoom top-left"),null;O=ua.cell.CQ===fa.cell.CQ&&ua.cell.BQ===fa.cell.BQ?this.SQh(O,fa,da,xa,ia,Ta):this.R5h(O,ua,fa,da,xa,ia,Ta);return O?Da?this.HYe(O,ia,Ma):O:(e.ULS.sendTraceTag(537149775,0,15,"ZoomManager.GetSelectedRangeBounds got null bounds"),null)}HYe(O,da,xa){if(0>O.x||O.x>da)O.x=0;if(0>O.y||O.y>xa)O.y=0;O.x+O.width>da&&(O.width=
da-O.x);O.y+O.height>xa&&(O.height=xa-O.y);return O}R5h(O,da,xa,ia,Ma,Ta,Da){da=M.h(this.$).getCellBounds(da.cell);if(!da)return null;const fa=M.h(this.$).getCellBounds(xa.cell);if(!fa)return null;let ua=Ma.x;Da&&(ua=0,da.x=Math.round(Ta/O)-da.x-Math.round(da.width),fa.x=Math.round(Ta/O)-fa.x-Math.round(fa.width));O=new Sys.UI.Bounds(Math.round((da.x-ia.x)*O)-ua,Math.round((da.y-ia.y)*O-Ma.y),Math.round((fa.x+fa.width-da.x)*O),Math.round((fa.y+fa.height-da.y)*O));xa=xa.cell.getRange();e.ULS.sendTraceTag(537149774,
0,50,`ZoomManager.GetTwoCellsBoundsWithZoom - a range with more than 1 cell was selected. Will zoom to range: (t:${xa.top}, b:${xa.bottom}, r:${xa.right}, l:${xa.left}) in bounds (${O.x}, ${O.y}, ${O.width}, ${O.height})`);return O}SQh(O,da,xa,ia,Ma,Ta){const Da=M.h(this.$).getCellBounds(da.cell);if(!Da)return null;let fa=ia.x;Ta&&(fa=0,Da.x=Math.round(Ma/O)-Da.x-Math.round(Da.width));O=new Sys.UI.Bounds(Math.round((Da.x-xa.x)*O)-fa,Math.round((Da.y-xa.y)*O-ia.y),Math.round(Da.width*O),Math.round(Da.height*
O));da=da.cell.getRange();e.ULS.sendTraceTag(537149773,0,50,`ZoomManager.GetCellBoundsWithZoom - single cell was selected. Will zoom to cell: (t:${da.top}, l:${da.left}) in bounds (${O.x}, ${O.y}, ${O.width}, ${O.height})`);return O}X7j(O,da,xa,ia,Ma,Ta){const Da=this.e3e(O,Ma,Ta);return Da?this.Z5e(Da,O,da,xa,ia,Ma,Ta):null}Z5e(O,da,xa,ia,Ma,Ta,Da){O=new Sys.UI.Point(this.D6e(Ta,O.x,O.width),this.D6e(Da,O.y,O.height));return this.Hhd(O,da,xa,ia,Ma)}D6e(O,da,xa){return O===xa?(e.ULS.sendTraceTag(537149772,
0,50,"ZoomManager.GetRelativePointCoordinate returning size/2 since the bounds are the same as the grid bounds"),O/2):O*da/(O-xa)}e3e(O,da,xa,ia=!0){const Ma=M.h(this.$).ha.Ra.dc.domElement;var Ta=E.HelperMethods.PC(Ma,M.h(this.$).domElement,M.h(this.$).rtl);if(!Ta)return e.ULS.sendTraceTag(537149771,0,50,"ZoomManager.GetFloatingObjectBounds got null for floatingObjectPointOnGrid"),null;const Da=M.h(this.$).fyb();Ta=new Sys.UI.Point(Math.round((Ta.x-Da.topLeft.x)*O),Math.round((Ta.y-Da.topLeft.y)*
O));O=new Sys.UI.Bounds(Ta.x,Ta.y,Math.round(Ma.offsetWidth*O),Math.round(Ma.offsetHeight*O));return ia?this.HYe(O,da,xa):O}hyf(){this.bhb.rz()}pMi(O){"ZoomToLevelInExcelLive"===O?this.zoomEventManager.dcj():this.zoomEventManager.ccj()}phj(){this.zoomEventManager=this.$.da.Ha(419,new ba)}Hhd(O,da,xa,ia,Ma,Ta=""){var Da=M.h(this.$).rtl?0:Ma.x;Ma="ZoomWithPinch"===Ta||"ZoomWithMouse"===Ta?new Sys.UI.Point(O.x-Da-Math.round(ia.x*da),O.y-Ma.y-Math.round(ia.y*da)):O;Ma=new Sys.UI.Point(Math.round(Ma.x/
da),Math.round(Ma.y/da));e.ULS.shipAssertTag(537149770,0,!!da,"Original zoom level must be different than 0");Da=xa/da;Ma=new Sys.UI.Point(Math.round(Ma.x*(1-1/Da)),Math.round(Ma.y*(1-1/Da)));"ZoomWithMouse"===Ta||"ZoomWithPinch"===Ta?(Ma.x+=Math.round((ia.x-M.h(this.$).zr)*(Da-1)),Ma.y+=Math.round((ia.y-M.h(this.$).lJ)*(Da-1))):(Da=Math.round(ia.x*(xa-da)),0<Da&&Ma.x>Da&&(Ma.x+=Da),da=Math.round(ia.y*(xa-da)),0<da&&Ma.y>da&&(Ma.y+=da));"ZoomWithMouse"===Ta&&(O.x||(Ma.x=0),O.y||(Ma.y=0));O=M.h(this.$).fyb();
return new Sys.UI.Point(Ma.x+O.topLeft.x,Ma.y+O.topLeft.y)}bUg(){const O=[];y.a.instance.Tb("Common.IGestureInputManager").execute(da=>{0===da.lWh()&&da.Sfj(document.body,new V(this.$),O)})}F5i(){return this.TFc()&&(u.a.cp&&u.a.oMa(67)||this.$.rkc)}ICj(O,da){k.a(this.$)?this.setZoomLevel(O,da,this.U2d,d.a.pOf):this.setZoomLevel(O,da,this.zoomPerSheetId,this.fab)}setZoomLevel(O,da,xa,ia){xa.remove(O);da!==ia&&xa.add(O,da)}xVj(O){this.p6f();this.$.Aza(I.a.qZ("TriggerImmediateZoomOperations"));this.Q2j();
this.pMi(O)}Q2j(){this.Bti()?this.$.qf():this.bhb.rz();const O=this.bhb.j9e("UpdateZoomStatusBar");O&&(O.innerText=this.lRb)}Bti(){const O=B.a(this.$);return O?O.pp.Lz===(G.a.TMa(this.$)?x.a.vtc:this.$.Bb+x.a.y_f):!1}IVj(O){M.h(this.$).W7j(O);this.iQg()}iQg(){const O=N.a(this.$);if(O)for(const da of M.h(this.$).Ca.MA()){if(!da){e.ULS.sendTraceTag(537149768,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - cacheItem is null");continue}if(!da.uk)continue;const xa=da.zi;if(xa)for(let ia=
0;ia<xa.count;ia++)if(2===xa.Xf(ia).type){const Ma=O.pr(xa.Xf(ia).Fg());Ma?(Ma.Aea(!1),e.ULS.sendTraceTag(537149766,0,50,`ZoomManager.AdjustSlicersToZoom - Slicer zoomed to zoom ${this.zoom}`)):e.ULS.sendTraceTag(537149767,0,50,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - control is null")}}else e.ULS.sendTraceTag(537149769,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - floatingObjectManager is null")}}Object(r.a)(ea,"ZoomManager",v.a,[]);class ra extends F.a{constructor(O){super();
this.$=O;this.Db()}create(){const O=new ea(this.$);this.S2j(O);this.$.da.Ha(368,O);this.nb(O)}S2j(O){const da=t.a(this.$);if(da){var xa=da.Xjd("ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager");O.CSd(xa);O.Nwc(da.CDc)}else e.ULS.shipAssertTag(537149765,0,!0,"ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager existingZoomManager is missing (expected to find here a DefaultZoomManager to pass zoom-per-sheet state from)")}static ka(O){O.da.Ha(369,new ra(O))}}Object(r.a)(ra,"ZoomManagerFactory",
F.a,[]);a=a(1154);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Zoom");Type.registerNamespace("_Ewa");(()=>{c.a.Fa(O=>{ra.ka(O);w.ka(O)})})();Object(a.a)()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.zoom.js.map/3df81a8568bb40e016f4b7050d224725/EwaDSEsNext.zoom.js.map
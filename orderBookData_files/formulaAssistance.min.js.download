var formulaAssistance=(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[16],{1070:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.anonymizeFormulaString=t.anonymizeMagnitude=t.kindAnonymizers=t.anonymize=void 0;var r=n(1294);function o(e){return e}function i(e,n){if("string"==typeof n&&null!=a[n])return e;var r=function(e){if("object"==typeof e&&null!==e){var t=e.kind;if("string"==typeof t)return t}}(e),o=void 0!==r?t.kindAnonymizers[r]:void 0;return void 0===o&&(o=c[function(e){var t=typeof e;if("object"===t){if(null===e)return"null";if(Array.isArray(e))return"Array"}return t}(e)]),void 0!==o?o(e,n):"<unexpected>"}t.anonymize=function(e){try{return String(JSON.stringify(i(e,void 0)))}catch(e){if(null==e||"object"!=typeof e)return"<error: ".concat(String(JSON.stringify(e)),">");var t=String(e.name),n=String(e.message);return n.indexOf(t)>=0?"<error ".concat(n,">"):"<error ".concat(t,": ").concat(n,">")}};var a={kind:!0,type:!0,index:!0,length:!0,row:!0,col:!0,rows:!0,cols:!0},c={boolean:o,symbol:function(e){return"symbol"!=typeof e?"<unexpected>":"<symbol ".concat(String(e),">")},undefined:o,null:o,number:function(e){return"number"!=typeof e?"<unexpected>":isFinite(e)?"<number>":e},bigint:function(e){return"bigint"!=typeof e?"<unexpected>":"<bigint>"},string:function(e){return"string"!=typeof e?"<unexpected>":e.length>0?"<string>":e},function:function(e){if("function"!=typeof e)return"<unexpected>";var t=e.name;return"string"==typeof t&&t.length>0?"<function ".concat(t,">"):"<function>"},object:function(e){if("object"!=typeof e)return"<unexpected>";var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=i(e[n],n));return t},Array:function(e){return"object"==typeof e&&Array.isArray(e)?e.map(i):"<unexpected>"}};t.kindAnonymizers=Object.create(null),t.anonymizeMagnitude=function(e){var t=Math.abs(e);return 0===t?-1e4:Math.floor((0,r.mathLog2)(t))};var s=new RegExp("[^=\\[\\]\\.\\\\\\/%@#\\-_\\+,;\\(\\):?\"&<>'!\\{\\}~\\^\\*$¢£¤¥₠₡₢₣₤₥₦₧₨₩₪₫€₭₮₯₰₱₲₳₴₵₶₷₸₹\\sꃂd]","g"),u=/[0-9]/g,l=/d/g;t.anonymizeFormulaString=function(e){return e.toLowerCase().replace(l,"w").replace(u,"d").replace(s,"w")}},1071:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.values=t.prependErrorMessage=t.messageFromError=t.partialArray=t.arrayFill=t.repeat=t.stringEndsWith=t.stringStartsWith=t.isInteger=t.mathLog2=void 0;var r=n(1070),o=n(1294);Object.defineProperty(t,"mathLog2",{enumerable:!0,get:function(){return o.mathLog2}}),t.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},t.stringStartsWith=function(e,t,n){return void 0===n&&(n=0),n+t.length<=e.length&&e.substring(n,n+t.length)===t},t.stringEndsWith=function(e,t){return t.length<=e.length&&e.substring(e.length-t.length,e.length)===t},t.repeat=function(e,t){return Array(t+1).join(e)},t.arrayFill=function(e,t){for(var n=0;n<e.length;n+=1)e[n]=t;return e},t.partialArray=function(e){var t=[];return Object.keys(e).map(Number).forEach((function(n){return t[n]=e[n]})),t},t.messageFromError=function(e){if(null==e||"object"!=typeof e)return(0,r.anonymize)(e);var t=e,n=String(t.name),o=String(t.message);if(null!=t.stack){var i=String(t.stack);return i.indexOf(o)>=0&&i.indexOf(n)>=0?i:"".concat(n,": ").concat(o,"\n").concat(i)}return o.indexOf(n)>=0?o:"".concat(n,": ").concat(o)},t.prependErrorMessage=function(e,t){if(null==e||"object"!=typeof e)return e;var n=e;return n.message="".concat(t," ").concat(String(n.message)),n},t.values=function(e){var t=[];for(var n in e)Object.hasOwnProperty.call(e,n)&&t.push(e[n]);return t}},1072:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.collapseThenable=t.bindMaybeThenable=t.isThenable=t.promiseLoop=t.newPromise=t.promiseFinally=void 0;var r=n(356);function o(e){return(0,r.isDefined)(e)&&"function"==typeof e.then}t.promiseFinally=function(e,t){return e.then((function(e){return t(),e}),(function(e){return t(),Promise.reject(e)}))},t.newPromise=function(){var e;return[new Promise((function(t,n){return e=[t,n]})),e]},t.promiseLoop=function(e,t){var n;return new Promise((function(r,o){Promise.resolve(t).then((function t(i){if(void 0!==i){n=i;try{Promise.resolve(e(n)).then(t,o)}catch(e){o(e)}}else r(n)}),o)}))},t.isThenable=o,t.bindMaybeThenable=function(e,t,n){return o(e)?e.then(t,n):t(e)},t.collapseThenable=function(e){return e}},1073:function(e,t,n){"use strict";var r,o;function i(e){return{kind:r.Success,value:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.javaScriptError=t.ReasonKind=t.isSuccess=t.failure=t.successUndefined=t.success=t.ResultKind=void 0,function(e){e.Success="Success",e.Failure="Failure",e.Paused="Paused",e.Breaked="Breaked"}(r=t.ResultKind||(t.ResultKind={})),t.success=i,t.successUndefined=i(void 0),t.failure=function(e){return{kind:r.Failure,reason:e}},t.isSuccess=function(e){return e.kind===r.Success},function(e){e.JavaScriptError="JavaScriptError"}(o=t.ReasonKind||(t.ReasonKind={})),t.javaScriptError=function(e){return{kind:o.JavaScriptError,error:e}}},1292:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RepairItemPartType=t.CodeActionKind=t.DiagnosticTag=t.DiagnosticSeverity=t.SuggestionKind=t.CompletionItemKind=void 0,function(e){e[e.Function=3]="Function",e[e.NamedRange=100]="NamedRange",e[e.TableHeader=101]="TableHeader",e[e.LetVariable=102]="LetVariable",e[e.RichEntity=103]="RichEntity",e[e.Lambda=104]="Lambda",e[e.CustomFunction=105]="CustomFunction",e[e.Table=106]="Table",e[e.TableSpecialStructRef=107]="TableSpecialStructRef",e[e.RichEntityEmptyCellRef=108]="RichEntityEmptyCellRef",e[e.RangeRef=109]="RangeRef"}(t.CompletionItemKind||(t.CompletionItemKind={})),function(e){e[e.Simple=0]="Simple",e[e.Smart=1]="Smart"}(t.SuggestionKind||(t.SuggestionKind={})),function(e){e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Information=3]="Information",e[e.Hint=4]="Hint"}(t.DiagnosticSeverity||(t.DiagnosticSeverity={})),function(e){e[e.Unnecessary=1]="Unnecessary",e[e.Deprecated=2]="Deprecated"}(t.DiagnosticTag||(t.DiagnosticTag={})),function(e){e[e.Empty=0]="Empty",e[e.QuickFix=1]="QuickFix",e[e.Refactor=2]="Refactor",e[e.RefactorExtract=3]="RefactorExtract",e[e.RefactorInline=4]="RefactorInline",e[e.RefactorRewrite=5]="RefactorRewrite",e[e.Source=6]="Source",e[e.SourceOrganizeImports=7]="SourceOrganizeImports",e[e.SourceFixAll=8]="SourceFixAll"}(t.CodeActionKind||(t.CodeActionKind={})),function(e){e[e.None=0]="None",e[e.Added=1]="Added",e[e.Removed=2]="Removed",e[e.Replaced=3]="Replaced"}(t.RepairItemPartType||(t.RepairItemPartType={}))},1293:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSF32=void 0;var r=function(e,t){return(e<<t|e>>>32-t)>>>0},o=function(){function e(e){this.x=new Uint32Array([4058668781,e,e,e]);for(var t=0;t<20;t+=1)this.nextU32()}return e.prototype.next=function(){return this.nextU32()*(1/4294967296)},e.prototype.nextU32=function(){var e=this.x[0]-r(this.x[1],27)>>>0;return this.x[0]=(this.x[1]^r(this.x[2],17))>>>0,this.x[1]=this.x[2]+this.x[3]>>>0,this.x[2]=this.x[3]+e>>>0,this.x[3]=e+this.x[0]>>>0},e}();t.JSF32=o},1294:function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.mathLog2=void 0,t.mathLog2=null!==(r=Math.log2)&&void 0!==r?r:function(e){return Math.log(e)*Math.LOG2E}},1295:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BinaryHeap=void 0;var r=function(){function e(e){this.items=[],this.cmp=e}return e.prototype.insert=function(e){this.items.push(e);for(var t=this.getCount()-1;t>0;){var n=t-1>>>1,r=this.items[n];if(!(this.cmp(r,e)>0))break;this.items[t]=r,t=n}this.items[t]=e},e.prototype.peek=function(){return this.items[0]},e.prototype.removeMin=function(){var e=this.peek(),t=this.items.pop(),n=this.getCount()-1;if(n<0||void 0===t)return e;var r=0;for(this.items[0]=t;r<n;){var o=r,i=1+(r<<1),a=2+(r<<1);if(i<=n&&this.cmp(this.items[i],t)<0&&(o=i),a<=n&&this.cmp(this.items[a],o===i?this.items[o]:t)<0&&(o=a),r===o)break;this.items[r]=this.items[o],r=o}return this.items[r]=t,e},e.prototype.getCount=function(){return this.items.length},e.prototype.clear=function(){this.items.length=0},e.prototype.forEach=function(e){for(var t=0,n=this.items;t<n.length;t++){if(!e(n[t]))return}},e}();t.BinaryHeap=r},1296:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forEachKeyUntyped=t.forEachKey=t.getNodeCount=t.complement=t.symmetricDiff=t.lazy=t.empty=t.dense=t.compareUntyped=t.combineCmp=t.compare=t.exceptUntyped=t.except=t.meetsUntyped=t.meets=t.intersectUntyped=t.intersect=t.unionUntyped=t.union=t.fromUntyped=t.createFromKey=t.cacheKeySplitting=t.SetKind=void 0;var r,o=n(1),i=n(1).__assign;function a(e,t,n){return void 0===n&&(n=10),function(r){if(void 0!==r.split)return r.split;var o=e(r),i=r===t?0:r.depth;return void 0!==i&&i<n&&(r.split=o,o[0][0].depth=i+1,o[1][0].depth=i+1),o}}function c(e,n){return n===t.empty?t.empty:n===t.dense?t.dense:{setOperations:e,root:n}}function s(e,n){return n===t.empty?e:n===t.dense||e===t.empty?n:e===t.dense?e:c(e.setOperations,u(e.setOperations,e.setOperations.top,e.root,n.root))}function u(e,n,r,o){if(o===t.empty)return r;if(o===t.dense)return o;if(r===t.empty)return o;if(r===t.dense)return r;if(r.isExact&&o.isExact){var i=function(e,n,r,o){var i=r.key,a=o.key,c=e.compare(i,a);if(void 0!==c)return c<0?o:r;var s=e.union(i,a);if(void 0!==s){var u=e.compare(s,n);return void 0!==u&&0===u?t.dense:b(e,n,s,!0)}return}(e,n,r,o);if(void 0!==i)return i}var a=S(e,n,r),c=S(e,n,o),s=e.split(n),l=s[0][0],d=s[1][0];return v(e,l,d,u(e,l,a.left,c.left),u(e,d,a.right,c.right))}function l(e,n,r,o){if(r===t.empty)return r;if(o===t.empty)return o;if(r===t.dense)return o;if(o===t.dense)return r;if(r.isExact&&o.isExact){var i=function(e,n,r,o){var i=r.key,a=o.key;if(!e.meets(i,a))return t.empty;var c=e.compare(i,a);if(void 0!==c)return c<0?r:o;var s=e.intersect(i,a);if(void 0!==s)return b(e,n,s,!0);return}(e,n,r,o);if(void 0!==i)return i}var a=S(e,n,r),c=S(e,n,o),s=e.split(n),u=s[0][0],d=s[1][0];return v(e,u,d,l(e,u,a.left,c.left),l(e,d,a.right,c.right))}function d(e,n,r,o){if(r===t.empty||o===t.empty)return!1;if(r===t.dense||o===t.dense)return!0;if(r.isExact&&o.isExact)return e.meets(r.key,o.key);var i=S(e,n,r),a=S(e,n,o),c=e.split(n),s=c[0][0],u=c[1][0];return d(e,s,i.left,a.left)||d(e,u,i.right,a.right)}function f(e,n){return e===t.empty||n===t.empty?e:n===t.dense?t.empty:e===t.dense?c(n.setOperations,p(n.setOperations,n.setOperations.top,e,n.root)):c(e.setOperations,p(e.setOperations,e.setOperations.top,e.root,n.root))}function p(e,n,r,o){if(r===t.empty)return r;if(o===t.empty)return r;if(o===t.dense)return t.empty;if(r===t.dense){var i=S(e,n,o),a=e.split(n),c=a[0][0],s=a[1][0];return v(e,c,s,p(e,c,t.dense,i.left),p(e,s,t.dense,i.right))}if(r.isExact&&o.isExact){var u=function(e,t,n,r){var o=n.key,i=r.key;if(!e.meets(o,i))return n;var a=e.except(o,i);if(void 0!==a)return b(e,t,a,!0);return}(e,n,r,o);if(void 0!==u)return u}var l=S(e,n,r),d=S(e,n,o),f=e.split(n),h=f[0][0],m=f[1][0];return v(e,h,m,p(e,h,l.left,d.left),p(e,m,l.right,d.right))}function h(e,t){if(void 0!==e&&void 0!==t)return 0===e?t:0===t||e===t?e:void 0}function m(e,n,r,o){if(r===o)return 0;if(r===t.empty)return-1;if(o===t.empty)return 1;if(r===t.dense)return o===t.dense?0:1;if(o===t.dense)return-1;if(r.isExact&&o.isExact)return function(e,t,n){return e.compare(t.key,n.key)}(e,r,o);var i=S(e,n,r),a=S(e,n,o),c=e.split(n),s=c[0][0],u=c[1][0],l=m(e,s,i.left,a.left);if(void 0!==l){var d=m(e,u,i.right,a.right);if(void 0!==d)return h(l,d)}}function v(e,n,r,o,i){return o===t.empty?i===t.empty?t.empty:i===t.dense?g(o,i,void 0,!1,e.infimum(r,r),e.supremum(r,r)):g(o,i,void 0,!1,i.infimum,i.supremum):i===t.empty?o===t.dense?g(o,i,void 0,!1,e.infimum(n,n),e.supremum(n,n)):g(o,i,void 0,!1,o.infimum,o.supremum):o===t.dense?i===t.dense?t.dense:g(o,i,void 0,!1,e.combineInfima(e.infimum(n,n),i.infimum),e.combineSuprema(e.supremum(n,n),i.supremum)):i===t.dense?g(o,i,void 0,!1,e.combineInfima(o.infimum,e.infimum(r,r)),e.combineSuprema(o.supremum,e.supremum(r,r))):g(o,i,void 0,!1,e.combineInfima(o.infimum,i.infimum),e.combineSuprema(o.supremum,i.supremum))}function g(e,t,n,r,o,i){return{key:n,left:e,right:t,isExact:r,infimum:o,supremum:i}}function y(e,n,r){if(!e.meets(n,r))return t.empty;var o=e.compare(n,r);if(void 0!==o)return o<=0?t.dense:b(e,n,r,!0);var i=e.intersect(n,r);return void 0!==i?b(e,n,i,!0):b(e,n,r,!1)}function b(e,t,n,r){return g(void 0,void 0,n,!!r,e.infimum(n,t),e.supremum(n,t))}function S(e,n,r){if(void 0!==r.left)return r;var o=e.split(n),a=o[0][0],c=o[1][0],s=v(e,a,c,y(e,a,r.key),y(e,c,r.key));if(s===t.empty||s===t.dense)throw new Error("incorrect set operations implementation");var u=s;return i(r,{left:u.left,right:u.right})}function C(e,n,r){return function n(o,i){if(i===t.empty)return!0;if(i===t.dense)return r(o);if(i.isExact)return r(i.key);var a=S(e,o,i),c=e.split(o),s=c[0][0],u=c[1][0];return n(s,a.left)&&n(u,a.right)}(e.top,n)}!function(e){e[e.Dense=0]="Dense",e[e.Empty=1]="Empty"}(r=t.SetKind||(t.SetKind={})),t.cacheKeySplitting=a,t.createFromKey=function(e){var t=o.__assign(o.__assign({},e),{split:a(e.split,e.top)});return function(e){return c(t,y(t,t.top,e))}},t.fromUntyped=c,t.union=s,t.unionUntyped=u,t.intersect=function(e,n){return e===t.empty?e:n===t.empty||e===t.dense?n:n===t.dense?e:c(e.setOperations,l(e.setOperations,e.setOperations.top,e.root,n.root))},t.intersectUntyped=l,t.meets=function(e,n){return e!==t.empty&&n!==t.empty&&(e===t.dense||n===t.dense||d(e.setOperations,e.setOperations.top,e.root,n.root))},t.meetsUntyped=d,t.except=f,t.exceptUntyped=p,t.compare=function(e,n){return e===n?0:e===t.empty?-1:n===t.empty?1:e===t.dense?n===t.dense?0:1:n===t.dense?-1:m(e.setOperations,e.setOperations.top,e.root,n.root)},t.combineCmp=h,t.compareUntyped=m,t.dense=r.Dense,t.empty=r.Empty,t.lazy=y,t.symmetricDiff=function(e,t){return s(f(e,t),f(t,e))},t.complement=function(e){return f(t.dense,e)},t.getNodeCount=function(e){return e===t.empty||e===t.dense?0:function e(n){if(void 0===n||n===t.empty||n===t.dense)return 0;return e(n.left)+e(n.right)+1}(e.root)},t.forEachKey=function(e,n){return e===t.empty||C(e.setOperations,e.root,n)},t.forEachKeyUntyped=C},1297:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logCollisionKey=void 0;var r=n(77),o=n(461),i={},a=0;t.logCollisionKey=function(e){!function(e){var t=i[e];i[e]=(void 0===t?0:t)+1,(a+=1)%100==0&&(o.ulsLogger.ULS.traceTag(595858520,r.LogCategory.msoulscat_ES_EWAJS,r.TraceLevel.Info,"calc.common.hashUtils.logCollision: ".concat(JSON.stringify(i),".")),i={})}(function(e){return"object"==typeof e?null===e?"null":"Object {".concat(Object.keys(e),"}"):typeof e}(e))}},1298:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ivlCompare=t.ivlExcept=t.ivlMeetsOrTouches=t.ivlMeets=t.ivlDistance=t.ivlMeet=t.ivlJoin=void 0;var r=n(356);t.ivlJoin=function(e,t){var n=e[0],o=e[1],i=t[0],a=t[1];return[(0,r.fastMin)(n,i),(0,r.fastMax)(o,a)]},t.ivlMeet=function(e,t){var n=e[0],o=e[1],i=t[0],a=t[1];return[(0,r.fastMax)(n,i),(0,r.fastMin)(o,a)]},t.ivlDistance=function(e,t){var n=e[0],o=e[1],i=t[0],a=t[1];return.5*(0,r.fastAbs)(n+o-(i+a))},t.ivlMeets=function(e,t){var n=e[0],o=e[1],i=t[0],a=t[1];return(0,r.fastMax)(n,i)<(0,r.fastMin)(o,a)},t.ivlMeetsOrTouches=function(e,t){var n=e[0],o=e[1],i=t[0],a=t[1];return(0,r.fastMax)(n,i)<=(0,r.fastMin)(o,a)},t.ivlExcept=function(e,t){var n=e[0],r=e[1],o=t[0],i=t[1];return n<o&&i>=r?[n,o]:n>=o&&i<r?[i,r]:void 0},t.ivlCompare=function(e,t){var n=e[0],r=e[1],o=t[0],i=t[1];return n===o&&r===i?0:n>=o&&r<=i?-1:n<=o&&r>=i?1:void 0}},1299:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.remove=t.removeUntyped=t.insert=t.insertUntyped=t.forEach=t.forEachUntyped=t.find=t.findUntyped=t.empty=t.emptyUntyped=t.isLeaf=t.fromUntyped=t.Color=void 0;var r,o,i=n(461);!function(e){e[e.Red=0]="Red",e[e.Black=1]="Black"}(r=t.Color||(t.Color={})),function(e){e[e.DoubleBlack=2]="DoubleBlack"}(o||(o={}));var a=r.Red,c=r.Black,s=o.DoubleBlack,u={c:c,l:void 0,r:void 0},l={c:s,l:void 0,r:void 0};function d(e,t){return{ops:e,root:t}}function f(e){return void 0===e.l}function p(e){return e.c===a}function h(e){return e.c===c&&void 0!==e.l}function m(e){return e.c===c&&void 0===e.l}function v(e,t,n,r,o){return{c:e,l:t,key:n,value:r,r:o}}function g(e,t){return v(e,t.l,t.key,t.value,t.r)}function y(e){return f(e)?u:g(c,e)}function b(e,t,n){if(!f(n)){var r=e.keyCompare(t,n.key);return r<0?b(e,t,n.l):r>0?b(e,t,n.r):n}}function S(e,t){return!!f(t)||!!S(e,t.l)&&(!!e(t.key,t.value)&&S(e,t.r))}function C(e,t,n,r,o){if(e===c){if(p(t)&&p(t.l))return v(a,g(c,t.l),t.key,t.value,v(c,t.r,n,r,o));if(p(o)&&p(o.r))return v(a,v(c,t,n,r,o.l),o.key,o.value,g(c,o.r));if(p(t)&&p(t.r))return v(a,v(c,t.l,t.key,t.value,t.r.l),t.r.key,t.r.value,v(c,t.r.r,n,r,o));if(p(o)&&p(o.l))return v(a,v(c,t,n,r,o.l.l),o.l.key,o.l.value,v(c,o.l.r,o.key,o.value,o.r))}if(e===s){if(p(o)&&p(o.l))return v(c,v(c,t,n,r,o.l.l),o.l.key,o.l.value,v(c,o.l.r,o.key,o.value,o.r));if(p(t)&&p(t.r))return v(c,v(c,t.l,t.key,t.value,t.r.l),t.r.key,t.r.value,v(c,t.r.r,n,r,o))}return v(e,t,n,r,o)}function _(e,t,n,r,o){return e===a&&t.c===s&&h(o)?C(c,v(a,y(t),n,r,o.l),o.key,o.value,o.r):e===a&&h(t)&&o.c===s?C(c,t.l,t.key,t.value,v(a,t.r,n,r,y(o))):e===c&&t.c===s&&h(o)?C(s,v(a,y(t),n,r,o.l),o.key,o.value,o.r):e===c&&h(t)&&o.c===s?C(s,t.l,t.key,t.value,v(a,t.r,n,r,y(o))):e===c&&t.c===s&&p(o)&&h(o.l)?v(c,C(c,v(a,y(t),n,r,o.l.l),o.l.key,o.l.value,o.l.r),o.key,o.value,o.r):e===c&&p(t)&&h(t.r)&&o.c===s?v(c,t.l,t.key,t.value,C(c,t.r.l,t.r.key,t.r.value,v(a,t.r.r,n,r,y(o)))):((0,i.assertTrue)("calc.common.rbTree.rotate: expected R|B",t.c!==s&&o.c!==s),v(e,t,n,r,o))}function P(e,t,n,r){return function(e){return!p(e)||e.l.c!==a&&e.r.c!==a?e:g(c,e)}(function e(t,n,r,o){if(f(o))return v(a,u,n,r,u);var i=t.keyCompare(n,o.key);return i<0?C(o.c,e(t,n,r,o.l),o.key,o.value,o.r):i>0?C(o.c,o.l,o.key,o.value,e(t,n,r,o.r)):v(o.c,o.l,n,r,o.r)}(e,t,n,r))}function x(e,t,n){if(f(n))return n;if(n.c===a&&m(n.l)&&m(n.r))return 0===e.keyCompare(t,n.key)?u:n;if(n.c===c&&m(n.l)&&m(n.r))return 0===e.keyCompare(t,n.key)?l:n;if(n.c===c&&p(n.l)&&m(n.l.l)&&m(n.l.r)&&m(n.r)){var r=e.keyCompare(t,n.key);return r<0?v(c,x(e,t,n.l),n.key,n.value,u):r>0?n:v(c,u,n.l.key,n.l.value,u)}var o=e.keyCompare(t,n.key);if(o<0)return _(n.c,x(e,t,n.l),n.key,n.value,n.r);if(o>0)return _(n.c,n.l,n.key,n.value,x(e,t,n.r));(0,i.assertTrue)("calc.common.rbTree.rem: expected node",!f(n.r));var s=function e(t){if(t.c===a&&m(t.l)&&m(t.r))return[t.key,t.value,u];if(t.c===c&&m(t.l)&&m(t.r))return[t.key,t.value,l];if(t.c===c&&m(t.l)&&p(t.r))return[t.key,t.value,g(c,t.r)];(0,i.assertTrue)("calc.common.rbTree.remMin: expected node",!f(t.l));var n=e(t.l),r=n[0],o=n[1],s=n[2];return[r,o,_(t.c,s,t.key,t.value,t.r)]}(n.r),d=s[0],h=s[1],y=s[2];return _(n.c,n.l,d,h,y)}function k(e,t,n){var r=x(e,t,function(e){return h(e)&&e.l.c===c&&e.r.c===c?g(a,e):e}(n));return(0,i.assertTrue)("calc.common.rbTree.remove: expected R|B",r.c===a||r.c===c),r}t.fromUntyped=d,t.isLeaf=f,t.emptyUntyped=u,t.empty=function(e){return d(e,t.emptyUntyped)},t.findUntyped=b,t.find=function(e,t){return b(t.ops,e,t.root)},t.forEachUntyped=S,t.forEach=function(e,t){return S(e,t.root)},t.insertUntyped=P,t.insert=function(e,t,n){return d(n.ops,P(n.ops,e,t,n.root))},t.removeUntyped=k,t.remove=function(e,t){return d(t.ops,k(t.ops,e,t.root))}},1300:function(e,t,n){"use strict";(function(e,r){Object.defineProperty(t,"__esModule",{value:!0}),t.defaultSetTimeoutInterface=t.clearTimerUnified=t.setImmediateUnified=void 0;var o=n(1),i=n(461);function a(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return{kind:"Immediate",timer:e.apply(void 0,o.__spreadArray([t],n,!1))}}function c(e){switch(e.kind){case"Immediate":r(e.timer);break;case"Timeout":clearTimeout(e.timer);break;case"Mocking":e.delayedCallback.isValid=!1;break;default:(0,i.assertNever)("unknown timer.kind",e)}}t.setImmediateUnified=a,t.clearTimerUnified=c,t.defaultSetTimeoutInterface={setImmediate:a,setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return{kind:"Timeout",timer:setTimeout.apply(void 0,o.__spreadArray([e,t],n,!1))}},clearImmediate:c,clearTimeout:c}}).call(this,n(1301).setImmediate,n(1301).clearImmediate)},1301:function(e,t,n){(function(e){var r=void 0!==e&&e||"undefined"!=typeof self&&self||window,o=Function.prototype.apply;function i(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new i(o.call(setTimeout,r,arguments),clearTimeout)},t.setInterval=function(){return new i(o.call(setInterval,r,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(r,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n(1909),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(330))},1302:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatch=t.ulsStopwatchFactory=void 0;var r=n(77),o={ULS:new r.NulLogger};t.ulsStopwatchFactory=(0,r.initStopwatchFactory)((function(e){return o.ULS.traceTag(595948114,r.LogCategory.msoulscat_ES_EWAJS,r.TraceLevel.Info,e)})),t.initStopwatch=function(e){o.ULS=e}},1303:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResolvablePromise=void 0;var r=n(1072),o=function(){function e(){var e=this;this.promise=new Promise((function(t,n){e._resolve=t,e._reject=n}))}return e.prototype.then=function(e,t){return this.promise.then(e,t)},e.prototype.toPromise=function(){return this.promise},e.prototype.resolve=function(e){return this._resolve(e),(0,r.isThenable)(e)?this.promise.then():void 0},e.prototype.reject=function(e){return this._reject(e),(0,r.isThenable)(e)?this.promise.then():void 0},e}();t.ResolvablePromise=o},1304:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AllMachine=t.MachineRuntime=t.MachineCycle=t.nextOnSuccessReceiver=t.callMachineTransition=t.breakTransition=t.nextTransition=t.TransitionKind=void 0;var r,o=n(1),i=n(1073);function a(e,t,n){return{kind:e,machine:t,receiver:n}}function c(e,t){return a(r.CallMachine,e,t)}!function(e){e[e.Next=1]="Next",e[e.CallMachine=2]="CallMachine",e[e.Break=3]="Break"}(r=t.TransitionKind||(t.TransitionKind={})),t.nextTransition=a(r.Next,void 0,void 0),t.breakTransition=a(r.Break,void 0,void 0),t.callMachineTransition=c;var s={receiveResult:function(e){return(0,i.isSuccess)(e)?t.nextTransition:e}};t.nextOnSuccessReceiver=function(){return s};var u=function(e){function t(t,n){var r=this.constructor,o=e.call(this,"Cycle detected: tried to call an already-running Machine")||this;o.machine=t,o.stackDepth=n;var i=r.prototype;return Object.getPrototypeOf(o)!==i&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(o,i):o.__proto__=i),o}return o.__extends(t,e),t}(Error);t.MachineCycle=u;var l=function(){function e(e){this.numSteps=0,this.stack=[];try{this.pushFrame(c(e,{receiveResult:function(e){return e}})),this.transition=t.nextTransition}catch(e){this.transition=(0,i.failure)((0,i.javaScriptError)(e))}}return e.resetStats=function(){e.maxStackDepth=0,e.numPauses=0,e.numCycles=0},e.prototype.pushFrame=function(t){var n=this.stack.length,r=t.machine;if(!0===r.runStatus)throw e.numCycles+=1,new u(r,n);!1===r.runStatus&&(r.runStatus=!0),this.stack.push(t),e.maxStackDepth<n+1&&(e.maxStackDepth=n+1)},e.prototype.advanceTopFrame=function(){var e=this.stack[this.stack.length-1].machine;return"boolean"!=typeof e.runStatus?e.runStatus:e.next()},e.prototype.step=function(){this.numSteps+=1;var e=this.transition;try{switch(e.kind){case r.Next:return this.transition=this.advanceTopFrame(),t.nextTransition;case r.CallMachine:return this.pushFrame(e),this.transition=this.advanceTopFrame(),t.nextTransition;case r.Break:return this.transition=t.nextTransition,e;default:var n=this.stack.pop();return n?(n.machine.runStatus=e,this.transition=n.receiver.receiveResult(e),t.nextTransition):e}}catch(e){return this.transition=(0,i.failure)((0,i.javaScriptError)(e)),t.nextTransition}},e.prototype.run=function(t){if(void 0===t&&(t=function(){return!1}),this.result)return this.result;try{for(;;){var n=this.step();if(n.kind===r.Break)return n;if(n.kind!==r.Next)return this.result=n;if(t())return e.numPauses+=1,n}}catch(e){return this.result=(0,i.failure)((0,i.javaScriptError)(e))}},e.prototype.runToResult=function(){for(;;){var e=this.run();if(e.kind!==r.Break)return e}},e.maxStackDepth=0,e.numPauses=0,e.numCycles=0,e}();t.MachineRuntime=l;var d=function(){function e(e){this.machines=e,this.runStatus=!1,this.values=[]}return e.prototype.next=function(){return this.values.length<this.machines.length?c(this.machines[this.values.length],this):(0,i.success)(this.values)},e.prototype.receiveResult=function(e){return(0,i.isSuccess)(e)?(this.values.push(e.value),this.next()):e},e}();t.AllMachine=d},1305:function(e,t,n){"use strict";n(531),n(320)},1306:function(e,t,n){"use strict";n(532)},1312:function(e,t,n){"use strict";n.r(t);var r=n(1);function o(e){return i(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function i(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function a(e){return i(e)?e:new Error("(non-Error object) ".concat(function(e){var t=typeof e;switch(t){case"function":case"symbol":case"undefined":return"<".concat(t,">");case"object":return JSON.stringify(e);default:return"".concat(e)}}(e)))}function c(e){return{name:e.name,message:o(e)?e.baseMessage:e.message,stack:e.stack,info:o(e)?(t=e.info,Object(r.__assign)(Object(r.__assign)({},t),{error:t.error?c(t.error):void 0})):void 0};var t}function s(e){return i(e)?{isError:!0,value:c(e)}:{isError:!1,value:e}}var u=function(e){function t(t,n){var o,i=this.constructor,a=this;(a=e.call(this,"".concat(t,"; info = ").concat(JSON.stringify(Object(r.__assign)(Object(r.__assign)({},n),{error:null===(o=n.error)||void 0===o?void 0:o.message}))))||this).baseMessage=t,a.info=n,a.name="WorkerError";var c=i.prototype;return Object.getPrototypeOf(a)!==c&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c),a}return Object(r.__extends)(t,e),t.isWorkerError=o,t}(Error);var l={Error:Error,EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError};function d(e){var t;if("WorkerError"===e.name)t=new u(e.message,function(e){return Object(r.__assign)(Object(r.__assign)({},e),{error:e.error?d(e.error):void 0})}(e.info));else{var n=l[e.name];n?t=new n(e.message):(t=new Error(e.message)).name=e.name}return null!=e.stack&&(t.stack=e.stack),t}function f(e){return e.isError?d(e.value):e.value}var p;function h(){return"undefined"!=typeof Blob&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL&&void 0!==URL.revokeObjectURL&&"undefined"!=typeof Worker}function m(e){if(p)throw new TypeError("setConfig has already been called");p=e}function v(){var e=null!=p?p:{};return{createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls?Object(r.__spreadArray)([],e.importScriptUrls,!0):void 0,typedWorkersUrl:e.typedWorkersUrl,typedWorkersName:e.typedWorkersName,importScriptsMaxRetries:e.importScriptsMaxRetries}}function g(e){setTimeout((function(){throw e}))}function y(){return"undefined"!=typeof self&&"__typed_workers_thread"in self?self:void 0}function b(e){var t=y();if(void 0!==t){var n={kind:1,error:s(e)};t.postMessage(n)}else console.warn(e)}function S(e){var t;try{(null!==(t=null==p?void 0:p.onWorkerError)&&void 0!==t?t:b)(e)}catch(t){console.warn(e),g(t)}}function C(e){var t=y();if(void 0!==t){var n={kind:2,stats:e};t.postMessage(n)}}function _(e){var t;try{(null!==(t=null==p?void 0:p.onCreateWorker)&&void 0!==t?t:C)(e)}catch(e){g(e)}}var P=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return P.transfer.apply(P,Object(r.__spreadArray)([e,void 0],t,!1))};P.transfer=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return{def:e,args:n,transferables:null!=t?t:[]}};var x=n(111),k=Object(x.makeTypedIsChangeGateEnabled)(["OfficeVSO:WINum_CGExample","OfficeVSO:5592319_TypedWorkersProxyPromiseFix"]);Object(x.makeGetTypedFeatureGate)({"Microsoft.Office.Shared.FGExample":!0});function O(e,t){return e.then((function(e){return t(),e}),(function(e){return t(),Promise.reject(e)}))}var E;function w(e,t,n){if(e>1<<30)return n;var r=setTimeout(t,Math.max(0,e));return{resolve:function(e){clearTimeout(r),n.resolve(e)},reject:function(e){clearTimeout(r),n.reject(e)}}}function T(){var e=Object.create(null);return e.key=void 0,delete e.key,e}function j(){return null!=E?E:E=function(){try{return"function"==typeof Proxy&&!0===new Proxy({},{get:function(){return!0}}).k}catch(e){return!1}}()}function M(e,t){var n=T(),r=k("OfficeVSO:5592319_TypedWorkersProxyPromiseFix")?function(t,n){var r;return"then"===n?void 0:null!==(r=t[n])&&void 0!==r?r:t[n]=e(n)}:function(t,n){var r;return null!==(r=t[n])&&void 0!==r?r:t[n]=e(n)};return t?(t.forEach((function(e){return r(n,e)})),n):new Proxy(n,{get:r})}function A(e){throw e}var I=-1,F=function(){function e(e,t){var n,r,o=this;this.idInfo=e,this.port=t,this.isClosed=!1,this.exports={},this.unresolvedCalls=T();var i=function(){var e;return null===(e=o.onClose)||void 0===e?void 0:e.call(o)},a=((n={})[0]=this.onInvoke.bind(this),n[1]=this.onResult.bind(this),n[2]=function(e){var t,n=e.funcNames;null===(t=o.onImports)||void 0===t||t.call(o,M(o.createPostProxy.bind(o),n),M(o.createCallProxy.bind(o),n))},n[3]=i,n),c=((r={})[0]=this.onSendInvokeFailed.bind(this),r[1]=this.onSendResultFailed.bind(this),r[2]=i,r[3]=i,r);this.port.onmessage=function(e){var t=e.data;return a[t.kind](t)},this.port.onmessageerror=function(e){var t=e.data;return c[t.kind](t)}}return e.prototype.setExports=function(e){this.exports=e;var t={kind:2,funcNames:j()?void 0:function(e){for(var t=T();null!=e;){for(var n=0,r=Object.getOwnPropertyNames(e);n<r.length;n++){var o=r[n];try{"function"==typeof e[o]&&(t[o]=!0)}catch(e){}}e=Object.getPrototypeOf(e)}return Object.getOwnPropertyNames(t)}(e)};this.port.postMessage(t)},e.prototype.close=function(){if(!this.isClosed){this.isClosed=!0;for(var e in this.port.postMessage({kind:3}),this.port.close(),this.unresolvedCalls){var t=this.unresolvedCalls[e],n=t.reject,r=t.funcName,o={cause:"Connection",idInfo:this.idInfo,funcName:r};n(new u("Importing Endpoint closed while waiting for ".concat(r," result"),o))}}},e.prototype.onInvoke=function(e){var t=this,n=e.callId,r=e.funcName,o=e.args,i=Promise.resolve().then((function(){var e=t.exports[r];if(e)return e.apply(t.exports,o);var i=n>=0?"call":"post",a={cause:"Connection",idInfo:t.idInfo,callId:n,funcName:r};throw new u("Exporting Endpoint received a ".concat(i," to unknown function ").concat(r),a)}));n>=0?i.then((function(e){return t.sendResult(n,r,!0,e)}),(function(e){return t.sendResult(n,r,!1,e)})):i.catch((function(e){var o=a(e),i={cause:"UnhandledError",idInfo:t.idInfo,error:o,callId:n,funcName:r};S(new u("Exporting Endpoint's ".concat(r," implementation threw or rejected"),i))}))},e.prototype.sendResult=function(e,t,n,r){var o={kind:1,callId:e,funcName:t,isFulfilled:n,resultValue:s(r)};try{this.port.postMessage(o,void 0)}catch(e){this.onSendResultFailed(o,a(e))}},e.prototype.onSendResultFailed=function(e,t){var n=e.callId,r=e.funcName,o=e.resultValue,i=t?"Exporting Endpoint failed to send ".concat(r," result"):"Importing Endpoint failed to deserialize ".concat(r," result"),a={cause:"MessageError",idInfo:this.idInfo,error:t,callId:n,funcName:r},c=new u(i,a);o.isError?S(c):this.sendResult(n,r,!1,c)},e.prototype.takeCallbacks=function(e){var t=this.unresolvedCalls[e];return t&&delete this.unresolvedCalls[e],t},e.prototype.setCallTimeout=function(e,t,n,r){var o=this;if(n>1<<30)return r;return w(n,(function(){var r=o.takeCallbacks(e);if(r){var i={cause:"Timeout",idInfo:o.idInfo,timeout:n,callId:e,funcName:t};r.reject(new u("Importing Endpoint's call to ".concat(t," timed out"),i))}}),r)},e.prototype.sendCall=function(e,t,n,o){var i=this;return new Promise((function(c,s){var l=I+=1,d={kind:0,callId:l,funcName:e,args:t};i.unresolvedCalls[l]=Object(r.__assign)(Object(r.__assign)({},i.setCallTimeout(l,e,n,{resolve:c,reject:s})),{funcName:e});try{i.port.postMessage(d,o)}catch(t){var f=i.takeCallbacks(l);if(f){var p=a(t),h={cause:"MessageError",idInfo:i.idInfo,error:p,callId:l,funcName:e};f.reject(new u("Importing Endpoint failed to send call to ".concat(e),h))}}}))},e.prototype.sendPost=function(e,t,n,r){var o={kind:0,callId:-1,funcName:e,args:t};try{this.port.postMessage(o,r)}catch(t){var i=a(t),c={cause:"MessageError",idInfo:this.idInfo,error:i,callId:-1,funcName:e};n(new u("Importing Endpoint failed to post to ".concat(e),c))}},e.prototype.onSendInvokeFailed=function(e){var t,n=e.callId,r=e.funcName,o=n>=0?"call":"post",i={cause:"MessageError",idInfo:this.idInfo,callId:n,funcName:r},a=new u("Exporting Endpoint failed to deserialize ".concat(o," to ").concat(r),i),c=n>=0?this.takeCallbacks(n):void 0;(null!==(t=null==c?void 0:c.reject)&&void 0!==t?t:S)(a)},e.prototype.onResult=function(e){var t=e.callId,n=e.funcName,r=e.isFulfilled,o=e.resultValue;if(t>=0){var i=this.takeCallbacks(t);if(i)(r?i.resolve:i.reject)(f(o))}else{var a={cause:"InternalError",idInfo:this.idInfo,callId:t,funcName:n};S(new u("Exporting Endpoint sent a result for a post to ".concat(n),a))}},e.prototype.createPostProxy=function(e){var t=this,n=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.transfer.apply(n,Object(r.__spreadArray)([void 0],e,!1))};return n.transfer=function(r){for(var o,i,a,c=[],s=1;s<arguments.length;s++)c[s-1]=arguments[s];if(!t.isClosed){var u=null!==(a=null!==(o=n.onPostMessageError)&&void 0!==o?o:null===(i=t.getOnPostMessageError)||void 0===i?void 0:i.call(t))&&void 0!==a?a:A;t.sendPost(e,c,u,r)}},n},e.prototype.createCallProxy=function(e){var t=this,n=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.transfer.apply(n,Object(r.__spreadArray)([void 0],e,!1))};return n.transfer=function(r){for(var o,i,a,c=[],s=1;s<arguments.length;s++)c[s-1]=arguments[s];if(t.isClosed){var l={cause:"Connection",idInfo:t.idInfo,funcName:e};return Promise.reject(new u("".concat(t.idInfo.side," Endpoint's call.").concat(e," called after close"),l))}var d=null!==(a=null!==(o=n.callTimeout)&&void 0!==o?o:null===(i=t.getCallTimeout)||void 0===i?void 0:i.call(t))&&void 0!==a?a:1/0;return t.sendCall(e,c,d,r)},n.callTimeout=void 0,n},e}();var R=function(){function e(e,t,n){this.callTimeout=1/0,this.onPostMessageError=A,this._idInfo=e,this._state=t,this.createMode=n;var r=function(t){return function(){var n="Outside"===e.side?"inside":"outside",r={cause:"Connection",idInfo:e};throw new u("".concat(e.side," Endpoint's ").concat(t," referenced before the ").concat(n," Endpoint started"),r)}};Object.defineProperties(this,{post:{configurable:!0,enumerable:!1,get:r("post")},call:{configurable:!0,enumerable:!1,get:r("call")}})}return e._create=function(t,n,r){var o,i,a=n.port,c=n.options,s=n.createMode,l={type:"Endpoint",side:t,id:null==c?void 0:c.id};try{o=new F(l,a),i=new e(l,o,s)}catch(e){return Promise.reject(e)}return new Promise((function(e,n){var a;o.getCallTimeout=function(){return i.callTimeout},o.getOnPostMessageError=function(){return i.onPostMessageError},o.onImports=function(e,t){Object.defineProperties(i,{post:{configurable:!0,enumerable:!1,writable:!1,value:e},call:{configurable:!0,enumerable:!1,writable:!1,value:t}}),f.resolve()},o.onClose=function(){return i.close("Force")};var s,d=function(e){var t,n;return null!==(n=null!==(t=null==e?void 0:e.createTimeout)&&void 0!==t?t:null==p?void 0:p.createTimeout)&&void 0!==n?n:3e5}(c),f=w(d,(function(){var e="Outside"===t?"inside":"outside",n={cause:"Timeout",idInfo:l,timeout:d},r=new u("".concat(t," Endpoint timed out waiting for the ").concat(e," to start"),n);f.reject(r)}),{resolve:e,reject:n});i._closedDuringCreate=function(){f.resolve()};try{s=r(i)}catch(e){return f.reject(e)}null===(a=i._state)||void 0===a||a.setExports(s)})).then((function(){return i._closedDuringCreate=void 0,i}),(function(e){return i._closedDuringCreate=void 0,i.close(),Promise.reject(e)}))},e.prototype.hasBeenClosed=function(){return void 0===this._state},e.prototype.close=function(e){var t,n;if(this._state){if(this._closedDuringCreate){if("Force"!==e){var r={cause:"Connection",idInfo:this._idInfo};throw new u("".concat(this._idInfo.side," Endpoint's close called during creation"),r)}this._closedDuringCreate()}var o=this._state;this._state=void 0;try{o.close(),null===(t=this._onClose)||void 0===t||t.call(this),null===(n=this.onClose)||void 0===n||n.call(this)}catch(e){r={cause:"Connection",idInfo:this._idInfo,error:a(e)};S(new u("".concat(this._idInfo.side," Endpoint's close threw an error"),r))}}},e.createOutside=function(t,n){return void 0===n&&(n=function(){}),e._create("Outside",t,n)},e.createInside=function(t,n){return e._create("Inside",t,n)},e}(),L='!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=12)}([function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return o})),r.d(t,"__assign",(function(){return i})),r.d(t,"__rest",(function(){return a})),r.d(t,"__decorate",(function(){return u})),r.d(t,"__param",(function(){return c})),r.d(t,"__metadata",(function(){return f})),r.d(t,"__awaiter",(function(){return l})),r.d(t,"__generator",(function(){return s})),r.d(t,"__createBinding",(function(){return d})),r.d(t,"__exportStar",(function(){return p})),r.d(t,"__values",(function(){return y})),r.d(t,"__read",(function(){return v})),r.d(t,"__spread",(function(){return _})),r.d(t,"__spreadArrays",(function(){return g})),r.d(t,"__spreadArray",(function(){return b})),r.d(t,"__await",(function(){return h})),r.d(t,"__asyncGenerator",(function(){return m})),r.d(t,"__asyncDelegator",(function(){return w})),r.d(t,"__asyncValues",(function(){return O})),r.d(t,"__makeTemplateObject",(function(){return j})),r.d(t,"__importStar",(function(){return S})),r.d(t,"__importDefault",(function(){return P})),r.d(t,"__classPrivateFieldGet",(function(){return T})),r.d(t,"__classPrivateFieldSet",(function(){return x})),r.d(t,"__classPrivateFieldIn",(function(){return E}));var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function u(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function c(e,t){return function(r,n){t(r,n,e)}}function f(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function u(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,u)}c((n=n.apply(e,t||[])).next())}))}function s(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}var d=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function p(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||d(t,e,r)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function _(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function g(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)n[o]=i[a];return n}function b(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function h(e){return this instanceof h?(this.v=e,this):new h(e)}function m(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||u(e,t)}))})}function u(e,t){try{(r=o[e](t)).value instanceof h?Promise.resolve(r.value.v).then(c,f):l(i[0][2],r)}catch(e){l(i[0][3],e)}var r}function c(e){u("next",e)}function f(e){u("throw",e)}function l(e,t){e(t),i.shift(),i.length&&u(i[0][0],i[0][1])}}function w(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:h(e[n](t)),done:"return"===n}:o?o(t):t}:o}}function O(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=y(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function j(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var G=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&d(t,e,r);return G(t,e),t}function P(e){return e&&e.__esModule?e:{default:e}}function T(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function x(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function E(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use \'in\' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var n=r(4),o={};function i(){return"undefined"==typeof __get_feature_gate_dictionary_variable?o:__get_feature_gate_dictionary_variable()}function a(e,t){var r;return null!==(r=i()[e])&&void 0!==r?r:t}t.getFeatureGateDictionary=i,t.getStringFeatureGate=a,t.getBooleanFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===n||"false"!==n&&t},t.getNumberFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===n)return t;if("infinity"===n||"+infinity"===n)return 1/0;if("-infinity"===n)return-1/0;var o=parseFloat(n);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim();if(void 0===n)return t;var o=parseInt(n,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){var t=n.globalThis.__get_feature_gate_dictionary_variable;return n.globalThis.__get_feature_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0;var n=r(4);function o(){return"undefined"==typeof __get_change_gate_dictionary_variable?{}:__get_change_gate_dictionary_variable()}t.getChangeGateDictionary=o,t.isChangeGateEnabled=function(e){var t;return null===(t=o()[e])||void 0===t||t},t.setChangeGateDictionaryGetter=function(e){var t=n.globalThis.__get_change_gate_dictionary_variable;return n.globalThis.__get_change_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);n.__exportStar(r(1),t),n.__exportStar(r(8),t),n.__exportStar(r(2),t),n.__exportStar(r(9),t),n.__exportStar(r(10),t),n.__exportStar(r(11),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalThis=void 0;var n=r(5);t.globalThis=n},function(e,t,r){"use strict";e.exports=r(6)()?globalThis:r(7)},function(e,t,r){"use strict";e.exports=function(){return"object"==typeof globalThis&&(!!globalThis&&globalThis.Array===Array)}},function(e,t){var r=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return r()}try{return __global__||r()}finally{delete Object.prototype.__global__}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var n=r(1);t.makeGetTypedFeatureGate=function(e){return function(t){var r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var n=r(2);t.makeTypedIsChangeGateEnabled=function(e){return function(e){return(0,n.isChangeGateEnabled)(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var n=r(0),o=r(2);function i(e){var t=(0,o.setChangeGateDictionaryGetter)(void 0);return(0,o.setChangeGateDictionaryGetter)((function(){var r=void 0!==t?t():{};return n.__assign(n.__assign({},r),e)})),t}t.overrideChangeGates=i,t.overrideTypedChangeGates=function(e,t){return i(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var n=r(0),o=r(1);function i(e){for(var t,r,i={},a=0,u=Object.keys(e);a<u.length;a++){var c=u[a];i[c]=null===(t=e[c])||void 0===t?void 0:t.toString()}var f=null!==(r=(0,o.setFeatureGateDictionaryGetter)(void 0))&&void 0!==r?r:function(){return{}};return(0,o.setFeatureGateDictionaryGetter)((function(){return n.__assign(n.__assign({},f()),i)})),f}t.overrideFeatureGates=i,t.overrideTypedFeatureGates=function(e,t){return i(t)}},function(e,t,r){"use strict";r.r(t);var n=r(0);function o(e){return i(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function i(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function a(e){return i(e)?e:new Error("(non-Error object) ".concat(function(e){var t=typeof e;switch(t){case"function":case"symbol":case"undefined":return"<".concat(t,">");case"object":return JSON.stringify(e);default:return"".concat(e)}}(e)))}function u(e){return{name:e.name,message:o(e)?e.baseMessage:e.message,stack:e.stack,info:o(e)?(t=e.info,Object(n.__assign)(Object(n.__assign)({},t),{error:t.error?u(t.error):void 0})):void 0};var t}function c(e){throw new ReferenceError("".concat(e," is not defined"))}function f(e,t,r){void 0===r&&(r=c);try{for(var n=t.split("."),o=0,i=n;o<i.length;o++){e=e[i[o]]}return null!=e?e:r(t)}catch(e){return r(t)}}var l=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return l.transfer.apply(l,Object(n.__spreadArray)([e,void 0],t,!1))};l.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var s="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function d(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:s()))}function p(e,t,r){var n=e.indexOf("?");if(n<0)return"".concat(e,"?").concat(t,"=").concat(r);for(var o=e.slice(0,n+1),i=e.slice(n+1).split("&"),a=0;a<i.length&&("="!==i[a][t.length]||i[a].slice(0,t.length)!==t);a+=1);return i[a]="".concat(t,"=").concat(r),o+i.join("&")}function y(e,t){for(var r,n=0;n<=t;n+=1)try{return void importScripts(n>0?p(e,"retries",String(n)):e)}catch(e){r=e}throw r}function v(e,t){if(0!==t)for(var r=0,n=e;r<n.length;r++){y(n[r],t)}else importScripts.apply(void 0,e)}var _=r(3);self.onmessage=function(e){var t,r,c=e.data,l=c.config,p=c.port,y=c.options,g=c.script,b=c.args,h=c.featureGateDictionary,m=c.changeGateDictionary;self.onmessage=null,self.__typed_workers_thread=!0,Object(_.setFeatureGateDictionaryGetter)((function(){return h})),Object(_.setChangeGateDictionaryGetter)((function(){return m}));var w,O=null!==(r=null!==(t=y.importScriptsMaxRetries)&&void 0!==t?t:l.importScriptsMaxRetries)&&void 0!==r?r:0;function j(){var e;if(w)return w;if(void 0===l.typedWorkersUrl)throw new TypeError("importTypedWorkers: typedWorkersUrl is not defined");return v([l.typedWorkersUrl],O),(w=f(self,null!==(e=l.typedWorkersName)&&void 0!==e?e:"typedWorkers")).setConfig(l),w}var G={status:"Pending",start:s()};function S(e,t){var r,n={kind:0,error:e?void 0:i(r=a(t))?{isError:!0,value:u(r)}:{isError:!1,value:r},stopwatch:G};self.postMessage(n),e||setTimeout(self.close.bind(self),6e4)}try{(function(e,t){function r(t){throw d(e,o(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!==(r=d(e,"Success"))&&void 0!==r?r:t}),r)}catch(e){r(e)}})(G,(function(){var e,t;return v(Object(n.__spreadArray)(Object(n.__spreadArray)([],null!==(t=null!==(e=null==y?void 0:y.importScriptUrls)&&void 0!==e?e:l.importScriptUrls)&&void 0!==t?t:[],!0),void 0!==g.scriptUrl?[g.scriptUrl]:[],!0),O),f(self,g.insideInitName).apply(void 0,Object(n.__spreadArray)([{config:l,importTypedWorkers:j,connection:{port:p,options:y,createMode:"Thread"}}],b,!1))})).then((function(){return S(!0)}),(function(e){return S(!1,e)}))}catch(e){S(!1,e)}}}]);',D=-1;var N=function(){function e(e,t){var n,r;try{var o;n=function(e){var t="def"in e?e:P(e),n=t.def,r=t.args,o=t.transferables;if("function"!=typeof n)return[n,r,o,void 0];var i="__generatedInsideInit".concat(D+=1);return[{scriptUrl:void 0,insideInitName:i},r,o,"var ".concat(i," = ").concat(n.toString(),";")]}(t),this.script=n[0],this.args=n[1],this.transferables=n[2];var i=void 0===(o=n[3])?[L]:[o,"\n\n",L];this.blobUrl=URL.createObjectURL(new Blob(i,{type:"application/javascript"}));var a={};null!=e.id&&(a.name=e.id),this.worker=new Worker(this.blobUrl,a)}catch(e){throw null===(r=this.worker)||void 0===r||r.terminate(),this.revokeBlobUrl(),e}}return e.prototype.revokeBlobUrl=function(){void 0!==this.blobUrl&&(URL.revokeObjectURL(this.blobUrl),this.blobUrl=void 0)},e.prototype.createInside=function(e,t){var n=this,a=e.port,c=e.options,s={type:"Thread",side:"Outside",id:c.id},l=this.worker;return O(new Promise((function(e,d){n.createCallbacks={resolve:e,reject:d};var p={config:v(),port:a,options:c,script:n.script,args:n.args,featureGateDictionary:Object(x.getFeatureGateDictionary)(),changeGateDictionary:Object(x.getChangeGateDictionary)()};l.postMessage(p,Object(r.__spreadArray)([a],n.transferables,!0)),l.onerror=function(e){e.preventDefault();var t=function(e,t,n){if(i(n.error)){if(o(n.error))return n.error;var r={cause:"UnhandledError",idInfo:e,error:n.error};return new u("".concat(t," received an unhandled error"),r)}if(null==n.message){var a={cause:"UnhandledError",idInfo:e};return new u("".concat(t," received a non-error (worker script fetch probably failed)"),a)}var c={cause:"UnhandledError",idInfo:e},s="".concat(n.message," at ").concat(n.filename,":").concat(n.lineno,":").concat(n.colno);return new u("".concat(t," received an unhandled error: ").concat(s),c)}(s,"worker.onerror",e);n.createCallbacks?n.createCallbacks.reject(t):S(t)},l.onmessage=function(e){var r,o,i=e.data;switch(i.kind){case 0:return t.insideInit=i.stopwatch,void 0===i.error?null===(r=n.createCallbacks)||void 0===r?void 0:r.resolve():null===(o=n.createCallbacks)||void 0===o?void 0:o.reject(f(i.error));case 1:return S(f(i.error));case 2:return _(i.stats)}}})),(function(){n.createCallbacks=void 0}))},e.prototype.terminate=function(){var e;if(this.worker){var t=this.worker;this.worker=void 0,null===(e=this.createCallbacks)||void 0===e||e.resolve(),t.terminate(),this.revokeBlobUrl()}},e}(),U="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function B(){return{status:"Pending",start:U()}}function z(e,t,n){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=n?n:U()))}function G(e,t){function n(t){throw z(e,o(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var n;return null!==(n=z(e,"Success"))&&void 0!==n?n:t}),n)}catch(e){n(e)}}function W(e){return Math.round(1e3*e)/1e3}function H(e,t,n){return e<t?t:e>n?n:e}function K(e,t,n){var r,o,i,a=H(null!==(r=null==e?void 0:e.start)&&void 0!==r?r:1/0,t,n),c=H(null!==(o=null==e?void 0:e.end)&&void 0!==o?o:1/0,t,n);return{status:null!==(i=null==e?void 0:e.status)&&void 0!==i?i:"Pending",start:W(a-t),end:W(c-t),duration:W(c-a)}}var V=function(){return n(1312)};function J(e,t,n,r,o){var i,a=new MessageChannel,c=a.port1,s=a.port2;return Promise.all([r({port:c,options:e,createMode:t}),G(n.createOutside=B(),(function(){return R.createOutside({port:s,options:e,createMode:t},(function(e){return o(i=e)}))}))]).then((function(){return i}),(function(e){return i?i.close("Force"):s.close(),Promise.reject(e)}))}function q(e,t,n,o){return J(e,"Local",t,(function(e){return function(e,t,n){var o="def"in n?n:P(n),i=o.def,a=o.args;if("function"!=typeof i){var c={cause:"InternalError",idInfo:{type:"Endpoint",side:"Inside",id:e.options.id}};return Promise.reject(new u("Loading an InsideScript to create a local worker is unimplemented",c))}return Promise.resolve().then((function(){return G(t.insideInit=B(),(function(){return i.apply(void 0,Object(r.__spreadArray)([{config:v(),importTypedWorkers:V,connection:e}],a,!1)).then((function(){}))}))}))}(e,t,n)}),o)}function Q(e,t,n,r){var o;t.createThread=B();try{o=new N(e,n)}catch(e){return z(t.createThread,"Error"),Promise.reject(e)}return z(t.createThread,"Success"),J(e,"Thread",t,(function(e){return o.createInside(e,t)}),r).then((function(e){return e.hasBeenClosed()?o.terminate():e._onClose=o.terminate.bind(o),e}),(function(e){return o.terminate(),Promise.reject(e)}))}function Z(e,t,n){void 0===n&&(n=function(){});var r=function(e){var t,n,r=null!==(n=null!==(t=null==e?void 0:e.createMode)&&void 0!==t?t:null==p?void 0:p.createMode)&&void 0!==n?n:"Thread";return"ThreadOrLocal"===r?h()?"Thread":"Local":r}(e),o="local"in t?"Local"===r?t.local:t.thread:t,i="Local"===r?q:Q,a={id:e.id,createMode:r,createWorker:B()};return O(G(a.createWorker,(function(){return i(function(e){return{id:e.id,createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls,importScriptsMaxRetries:e.importScriptsMaxRetries}}(e),a,o,n)})),(function(){var e=function(e){var t=e.id,n=e.createMode,r=e.createWorker,o=e.insideInit,i=e.createOutside,a=e.createThread,c=r.status,s=r.start,u=r.end;if("Pending"!==c&&void 0!==u)return{id:t,createMode:n,createWorker:{status:c,absStart:s,duration:W(u-s)},createThread:"Thread"===n?K(a,s,u):void 0,createOutside:K(i,s,u),insideInit:K(o,s,u)}}(a);e&&_(e)}))}function Y(e,t,n){var r=e.indexOf("?");if(r<0)return"".concat(e,"?").concat(t,"=").concat(n);for(var o=e.slice(0,r+1),i=e.slice(r+1).split("&"),a=0;a<i.length&&("="!==i[a][t.length]||i[a].slice(0,t.length)!==t);a+=1);return i[a]="".concat(t,"=").concat(n),o+i.join("&")}function X(e,t){for(var n,r=0;r<=t;r+=1)try{return void importScripts(r>0?Y(e,"retries",String(r)):e)}catch(e){n=e}throw n}function $(e,t){if(0!==t)for(var n=0,r=e;n<r.length;n++){X(r[n],t)}else importScripts.apply(void 0,e)}function ee(){return"undefined"!=typeof WorkerGlobalScope}function te(){return self.name}n.d(t,"WorkerError",(function(){return u})),n.d(t,"isThreadingSupported",(function(){return h})),n.d(t,"setConfig",(function(){return m})),n.d(t,"dispatchWorkerError",(function(){return S})),n.d(t,"paramInsideDef",(function(){return P})),n.d(t,"Endpoint",(function(){return R})),n.d(t,"createWorker",(function(){return Z})),n.d(t,"importScriptsWithRetry",(function(){return $})),n.d(t,"isWorkerThread",(function(){return ee})),n.d(t,"workerName",(function(){return te}))},1314:function(e,t,n){"use strict";var r,o=n(1),i=n(0),a="formulaRepair-callout",c=n(363),s=n(541),u=n(617),l=n(43),d=n(701),f=n(712),p=n(13),h=n(4),m=n(765),v=n(12),g=n(91),y=n(133),b=g.b.getInstance().getTheme(),S={height:"100%",display:"flex",flexDirection:"column",maxWidth:"fit-content"},C={display:"flex",minHeight:"0px",flexDirection:"column"},_={root:y.e},P=Object(p.c)((function(){var e;return Object(h.db)({"&:hover":(e={},e[h.l]={},e),"&:focus":{outline:"-webkit-focus-ring-color auto 1px"}})})),x=Object(p.c)((function(){return Object(h.cb)(Object(m.b)(b),{linkContent:{color:b.palette.neutralDark,minHeight:28,cursor:"pointer",userSelect:"none","&:hover":Object(o.__assign)({backgroundColor:"#F0F0F0"},v.o)},label:{fontSize:h.j.size12,lineHeight:h.j.size16,flexGrow:"",alignSelf:"center",margin:"0px 0px 0px 0px",overflow:"hidden",textOverflow:"ellipsis","-webkit-line-clamp":"2","-webkit-box-orient":"vertical",display:"-webkit-box",whiteSpace:"normal",wordBreak:"break-all"}})})),k=Object(p.c)((function(){return Object(h.cb)(y.b,{root:{width:340}})})),O={title:{root:{fontSize:h.j.size12,fontWeight:h.k.semibold,lineHeight:h.j.size12,color:b.palette.neutralDark,padding:0}},description:{root:{color:b.palette.neutralSecondary,fontSize:h.j.size12,lineHeight:h.j.size16,fontWeight:h.k.regular,selectors:(r={},r[h.l]={color:"WindowText"},r)}},ignore:{root:{fontSize:h.j.size12,padding:0},label:{margin:"0px 0px 0px 0px",padding:0}}},E=5,w=7,T=n(444),j=n(183),M=n(714),A=n(600),I=function(e){var t=e.onFeedback;return i.createElement(s.a,{horizontal:!0,horizontalAlign:"space-between"},i.createElement(M.a,{styles:O.ignore,text:ExcelRibbonStrings.FormulaAuthoringIgnore}),i.createElement(A.a,{disabled:!1,onClick:t}))},F=n(1198),R=function(e){var t=e.title,n=e.description;return i.createElement(s.a,null,i.createElement(F.a,{styles:O.title},t),i.createElement(F.a,{styles:O.description},n))},L=(i.forwardRef((function(e,t){var n=e.setComponentApi,r=e.onLayoutChange,f=e.getTargetAndBounds,p=e.repairedItems,h=e.title,m=e.description,v=e.callbacks,g=e.activeItemIndex,y=e.hidden,b=i.useRef(null),O=k(),M=i.useCallback((function(e,n){var r=Object(o.__assign)(Object(o.__assign)({},e),{items:null==e?void 0:e.items}),a={style:S},c={style:C};return i.createElement("div",Object(o.__assign)({},a,{ref:t}),i.createElement(s.a,{padding:"".concat(E,"px ").concat(w,"px")},i.createElement(R,{title:h,description:m}),i.createElement(u.a,Object(o.__assign)({disabled:y},c),n(r)),i.createElement(I,{onFeedback:function(e){var t;null===(t=null==v?void 0:v.onFeedback)||void 0===t||t.call(v)}})))}),[v,h,m,t,y]),A=p.map((function(e,t){return{key:e,text:e,onRender:(n=t,function(e,t){var r=n===g;return i.createElement("div",{role:"menuitem",className:P(),ref:r?b:void 0,"data-is-focusable":!0,tabIndex:r?0:-1},i.createElement(c.a,{classNames:x(),hasIcons:!1,index:n,item:e}))})};var n})),F=i.useRef(null),D=i.useCallback((function(){if(!y){var e=document.getElementById(a),t=f(!0),n=t.target,o=t.bounds,i=t.isFloating,c=t.renderDown,s=e.clientHeight,u=e.clientWidth,l=Object(T.a)(n,s,s,u,i,c,o);r(l);for(var d=Object(T.b)(l),p=0,h=Object.entries(d);p<h.length;p++){var m=h[p],v=m[0],g=m[1];e.style.setProperty(v,g)}}}),[f,y,r]);return i.useEffect((function(){n({updatePosition:D})}),[n,D]),i.useEffect((function(){F.current?D():requestAnimationFrame(D)})),i.createElement(d.a,{ref:F,items:A,styles:O,onRenderMenuList:M,isBeakVisible:!1,shouldFocusOnMount:!1,hidden:y,calloutProps:{id:a,styles:_,layerProps:{eventBubblingEnabled:!0}},focusZoneAs:L,focusZoneProps:{disabled:y},onDismiss:function(e){var t,n;(null===(t=null==e?void 0:e.nativeEvent)||void 0===t?void 0:t.keyCode)===l.a.escape&&(null===(n=null==v?void 0:v.onDismiss)||void 0===n||n.call(v))},doNotLayer:Object(j.b)()})})),function(e){return i.createElement(f.a,{disableFirstFocus:!0,forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,className:e.className},e.children)})},133:function(e,t,n){"use strict";n.d(t,"g",(function(){return s})),n.d(t,"c",(function(){return u})),n.d(t,"e",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"d",(function(){return f})),n.d(t,"f",(function(){return p})),n.d(t,"b",(function(){return h}));var r=n(1),o=n(4),i=n(119),a=n(110),c=Object(r.__assign)(Object(r.__assign)({},o.b.fadeIn100),{animationTimingFunction:o.c.easeFunction1}),s="0.467s cubic-bezier(0.5, 0, 0, 1)",u={minHeight:300,maxHeight:415,maxWidth:500},l={animation:"none","will-change":"transform",left:"0px !important",right:"auto !important",top:"var(--top) !important",bottom:"var(--bottom) !important",maxWidth:"var(--max-width) !important",maxHeight:"var(--max-height) !important"},d={root:Object(r.__assign)({borderRadius:4},c),calloutMain:{borderRadius:4}},f={root:{color:Object(a.a)().primary,fontSize:o.j.size12,fontWeight:o.k.semibold,lineHeight:o.j.size16,userSelect:"none",selectors:{"&:active, &:hover, &:active:hover, &:focus":{color:Object(a.a)().primary}}}},p={scrollbarWidth:"thin",scrollbarColor:"#808080 #FFF","-ms-scrollbar-base-color":"#808080","-ms-scrollbar-track-color":"#FFF",selectors:{"::-webkit-scrollbar":{width:14},"::-webkit-scrollbar-thumb":{borderRadius:20,backgroundColor:i.a.gray110,border:"solid 4px transparent",backgroundClip:"content-box"},"::-webkit-scrollbar-thumb:hover":{backgroundColor:i.a.gray120},"::-webkit-scrollbar-button:vertical":{height:4}}},h={container:{height:"100%"},root:{height:"100%",maxWidth:"max-content",boxSizing:"border-box"}}},175:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.revocableSingleton=t.testUtils=t.pledge=t.machine=t.testConfig=t.arrayLogger=t.wrapIntoAsyncModule=t.unicode=t.result=t.mixin=t.promise=t.stopwatch=t.resolvablePromise=t.config=t.codePoint=t.setTimeoutInterfaceModule=t.asyncLoopModule=t.async=t.arrayUtils=t.table=t.split=t.rTree=t.ringBuffer=t.rbTree=t.rbMapTree=t.productSet=t.priorityQueue=t.interval=t.histogram=t.hashTable=t.hashSet=t.dictionary=t.deque=t.bspSet=t.binaryHeap=t.arrayMapTree=t.testUtil=t.core=t.featureConfiguration=t.assertions=t.util=t.anonymizer=t.combinations=t.findIsomorphicSubtrees=t.JSF32=t.fnv1a=t.PackageName=void 0,t.PackageName="excel-online-calc-common";var r=n(1890);Object.defineProperty(t,"fnv1a",{enumerable:!0,get:function(){return r.fnv1a}});var o=n(1293);Object.defineProperty(t,"JSF32",{enumerable:!0,get:function(){return o.JSF32}});var i=n(1891);Object.defineProperty(t,"findIsomorphicSubtrees",{enumerable:!0,get:function(){return i.findIsomorphicSubtrees}});var a=n(1892);Object.defineProperty(t,"combinations",{enumerable:!0,get:function(){return a.combinations}});var c=n(1070);t.anonymizer=c;var s=n(1071);t.util=s;var u=n(461);t.assertions=u;var l=n(656);t.featureConfiguration=l;var d=n(356);t.core=d;var f=n(1893);t.testUtil=f;var p=n(1894);t.arrayMapTree=p;var h=n(1295);t.binaryHeap=h;var m=n(1296);t.bspSet=m;var v=n(1895);t.deque=v;var g=n(1896);t.dictionary=g;var y=n(1897);t.hashSet=y;var b=n(1898);t.hashTable=b;var S=n(1899);t.histogram=S;var C=n(1298);t.interval=C;var _=n(1900);t.priorityQueue=_;var P=n(1901);t.productSet=P;var x=n(1902);t.rbMapTree=x;var k=n(1299);t.rbTree=k;var O=n(1903);t.ringBuffer=O;var E=n(1904);t.rTree=E;var w=n(1905);t.split=w;var T=n(657);t.table=T,t.arrayUtils=n(1906),t.async=n(1907),t.asyncLoopModule=n(1908),t.setTimeoutInterfaceModule=n(1300),t.codePoint=n(1910),t.config=n(1911),t.resolvablePromise=n(1303),t.stopwatch=n(1302),t.promise=n(1072);var j=n(1913);Object.defineProperty(t,"mixin",{enumerable:!0,get:function(){return j.mixin}}),t.result=n(1073),t.unicode=n(1914),t.wrapIntoAsyncModule=n(1915),t.arrayLogger=n(1916),t.testConfig=n(1917),t.machine=n(1304),t.pledge=n(1918),t.testUtils=n(1919),t.revocableSingleton=n(1920)},183:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r=n(111),o=n(13),i=Object(o.c)((function(){return Object(r.getBooleanFeatureGate)("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)})),a=Object(o.c)((function(){return Object(r.getBooleanFeatureGate)("Microsoft.Office.Excel.FormulaAssistanceRedesign",!1)&&Object(r.getBooleanFeatureGate)("Microsoft.Office.Excel.FormulaAssistanceUiPosition",!1)}))},1889:function(e,t,n){"use strict";n.r(t);var r=n(214);n.d(t,"FormulaAssistanceUIFactoryGlobal",(function(){return r.FormulaAssistanceUIFactoryGlobal}))},1890:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fnv1a=void 0;t.fnv1a=function(e){for(var t=2166136261,n=e.length,r=0;r<n;r+=1)t^=e.charCodeAt(r),t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);return t>>>0}},1891:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findIsomorphicSubtrees=void 0,t.findIsomorphicSubtrees=function(e,t,n,r){void 0===n&&(n=function(){return""}),void 0===r&&(r=function(){return 1});for(var o=[e],i=new Set(o),a=0;a<o.length;a+=1)for(var c=0,s=t(o[a]);c<s.length;c++){var u=s[c];i.has(u)||(i.add(u),o.push(u))}i.clear(),o.reverse();var l=new Map,d=[],f=new Map,p=[];o.forEach((function(e,o){var i=t(e).map((function(e){return l.get(e)}));if(i.some((function(e){return void 0===e})))throw new Error("Circular references in the tree");var a=i.map((function(e){return d[e]})),c=function(e){var t=f.get(e);return void 0!==t||(t=f.size,f.set(e,t)),t}(a.join("/")+"/"+n(e));if(d.push(c),void 0===p[c]){var s=a.map((function(e){return p[e]})),u=s.map((function(e){return e.size})).reduce((function(e,t){return e+t}),r(e)),h=s.map((function(e){return e.depth})).reduce((function(e,t){return Math.max(e,t)}),0)+1;p[c]={subtrees:[e],size:u,depth:h}}else p[c].subtrees.push(e);l.set(e,o)}));for(var h=0,m=p;h<m.length;h++){(b=m[h]).subtrees.reverse()}for(var v=new Array(o.length),g=0,y=p;g<y.length;g++){var b=y[g];v[v.length-l.get(b.subtrees[0])-1]=b}return v.filter((function(e){return void 0!==e}))}},1892:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.combinations=void 0;var r=n(1);t.combinations=function e(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(0===t.length)return[[]];for(var o=t[0],i=t.slice(1),a=e.apply(void 0,i),c=[],s=0,u=o;s<u.length;s++)for(var l=u[s],d=0,f=a;d<f.length;d++){var p=f[d];c.push(r.__spreadArray([l],p,!0))}return c}},1893:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomElement=t.randomShuffled=t.randomIndex=t.randomFloat=void 0;var r,o,i=n(461),a=n(1293),c=(r=.4531024141007942,o=null!=Object({NODE_ENV:"production"}).BUILD_BUILDID?r:Math.random()*Date.now(),new a.JSF32(o));function s(e){return(0,i.assertTrue)("calc.common.randomIndex",e>0),Math.min(e-1,Math.floor(c.next()*e))}t.randomFloat=function(){return c.next()},t.randomIndex=s,t.randomShuffled=function(e){return e.map((function(e){return[c.next(),e]})).sort((function(e,t){return e[0]<t[0]?-1:e[0]===t[0]?0:1})).map((function(e){return e[1]}))},t.randomElement=function(e){return e[s(e.length)]}},1894:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.enumerateKeysInOrder=t.enumerateInOrder=t.RootPointer=t.ArrayMapTree=t.floorToPowerOf2=void 0;var r=n(657);function o(e){if(0===e)return 0;var t=e;return t=((t=((t=((t=((t=(t|t>>>1)>>>0)|t>>>2)>>>0)|t>>>4)>>>0)|t>>>8)>>>0)|t>>>16)>>>0,(t+=1)/2}t.floorToPowerOf2=o;var i=function(){function e(e,t,n){this.keyCompare=e,this.keys=t,this.values=n}return e.create=function(t){return new e(t,[],[])},e.prototype.setValue=function(e,t){return this.setValues([[e,t]])},e.prototype.remove=function(e){return void 0===this.getKeyIndex(e)?this:this.filter((function(t){return t!==e}))},e.prototype.getOrSetValue=function(e,t){var n=this.getKeyIndex(e);if(void 0===n){var r=t();return[this.setValue(e,r),r]}return[this,this.values[n]]},e.prototype.filter=function(e){for(var t=[],n=0;n<this.keys.length;n+=1){var r=this.keys[n],o=this.values[n];e(r,o)&&t.push([r,o])}return t.length===this.getCount()?this:this.ofSequence(t)},e.prototype.getCount=function(){return this.keys.length},e.prototype.getValue=function(e){var t=this.getKeyIndex(e);if(void 0!==t)return this.values[t]},e.prototype.getEntry=function(e){var t=this.getKeyIndex(e);if(void 0!==t)return(0,r.entry)(this.keys[t],this.values[t])},e.prototype.contains=function(e){return void 0!==this.getKeyIndex(e)},e.prototype.forEach=function(e){for(var t=0;t<this.keys.length;t+=1)if(!e(this.keys[t],this.values[t]))return!1;return!0},e.prototype.setValues=function(e){var t=this,n=this.keys.map((function(e,n){return[e,t.values[n],n]})),r=n.length;e.forEach((function(e,t){var o=e[0],i=e[1];return n.push([o,i,t+r])})),n.sort((function(e,n){var r=e[0],o=e[2],i=n[0],a=n[2],c=t.keyCompare(r,i);return 0!==c?c:o-a}));for(var o=[],i=void 0,a=0;a<n.length;a+=1){var c=n[a],s=c[0],u=c[1];void 0===i||0!==this.keyCompare(s,i)?(o.push([s,u]),i=s):o[o.length-1]=[s,u]}return this.ofSequence(o)},e.prototype.getKeyIndex=function(e){for(var n=t.RootPointer;n>=0&&n<this.keys.length;){var r=this.keyCompare(e,this.keys[n]);if(0===r)return n;r<0?n=c(n):r>0&&(n=s(n))}},e.prototype.ofSequence=function(n){var r=this,i=n.slice();i.sort((function(e,t){var n=e[0],o=t[0];return r.keyCompare(n,o)}));for(var a=new Array(i.length),u=new Array(i.length),l=function(e){var n=new Array(e);return function e(t,n,r,i){if(t>=n.length)return;var a=function(e){var t=o(e);if(t/2-1<=e-t)return t-1;return e-t/2}(i);n[t]=r+a,e(c(t),n,r,a),e(s(t),n,r+a+1,i-a-1)}(t.RootPointer,n,0,e),n}(i.length),d=0;d<i.length;d+=1){var f=i[l[d]],p=f[0],h=f[1];a[d]=p,u[d]=h}return new e(this.keyCompare,a,u)},e}();function a(e,t){var n=[];return function e(t,n,r){if(n<0||n>=t.keys.length)return;e(t,c(n),r),r.push([t.keys[n],t.values[n]]),e(t,s(n),r)}(e,t,n),n}function c(e){return 2*e+1}function s(e){return 2*e+2}t.ArrayMapTree=i,t.RootPointer=0,t.enumerateInOrder=a,t.enumerateKeysInOrder=function(e,t){return a(e,t).map((function(e){return e[0]}))}},1895:function(e,t,n){"use strict";function r(e,t){return e&t-1}Object.defineProperty(t,"__esModule",{value:!0}),t.Deque=void 0;var o=function(){function e(){this.front=0,this.count=0,this.values=[void 0]}return e.prototype.getCount=function(){return this.count},e.prototype.maybeResize=function(){var e=this.values.length;if(this.count>=e){this.values.length=e<<1;for(var t=0;t<this.front;t+=1)this.values[e+t]=this.values[t],this.values[t]=void 0}else{var n=e>>4;if(n>=1&&this.count<n){for(t=0;t<this.count;t+=1)this.values[r(this.front+t,n)]=this.values[r(this.front+t,e)];this.values.length=n,this.front=r(this.front,n)}}},e.prototype.pushBack=function(e){this.maybeResize(),this.values[r(this.front+this.count,this.values.length)]=e,this.count+=1},e.prototype.pushFront=function(e){this.maybeResize();var t=r(this.front-1,this.values.length);this.values[t]=e,this.front=t,this.count+=1},e.prototype.peekBack=function(){return this.values[r(this.front+this.count-1,this.values.length)]},e.prototype.peekFront=function(){return this.values[this.front]},e.prototype.peekPos=function(e){if(!(e<0||e>=this.count))return this.values[r(this.front+e,this.values.length)]},e.prototype.popBack=function(){var e=r(this.front+this.count-1,this.values.length),t=this.values[e];return void 0!==t&&(this.values[e]=void 0,this.count-=1),t},e.prototype.popFront=function(){var e=this.values[this.front];return void 0!==e&&(this.values[this.front]=void 0,this.front=r(this.front+1,this.values.length),this.count-=1),e},e.prototype.forEach=function(e){for(var t=this.values.length,n=0;n<this.count;n+=1){if(!e(this.values[r(this.front+n,t)]))return!1}return!0},e}();t.Deque=o},1896:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeNumberDict=t.makeStringDict=t.makeDictionary=void 0;var r=n(657),o=n(356);function i(e){function t(e,t){return Object.prototype.hasOwnProperty.call(e,t)}return{entries:(0,o.makeStringMap)(),keyToString:e,getCount:function(){return Object.keys(this.entries).length},getValue:function(e){var n=this.keyToString(e),r=t(this.entries,n)?this.entries[n]:void 0;return(0,o.isDefined)(r)?r.value:void 0},getEntry:function(e){var t=this.getValue(e);return void 0===t?void 0:(0,r.entry)(e,t)},setValue:function(e,n){var i=this.keyToString(e),a=t(this.entries,i)?this.entries[i]:void 0;(0,o.isDefined)(a)?a.value=n:this.entries[i]=(0,r.entry)(e,n)},contains:function(e){var n=this.keyToString(e),r=t(this.entries,n)?this.entries[n]:void 0;return(0,o.isDefined)(r)},remove:function(e){var n=this.keyToString(e);return!!t(this.entries,n)&&(delete this.entries[n],!0)},getOrSetValue:function(e,n){var i=this.keyToString(e),a=t(this.entries,i)?this.entries[i]:void 0;if((0,o.isDefined)(a))return a.value;var c=n();return delete this.entries[i],this.entries[i]=(0,r.entry)(e,c),c},forEach:function(e){for(var n in this.entries){var r=t(this.entries,n)?this.entries[n]:void 0;if((0,o.isDefined)(r)&&!e(r.key,r.value))return!1}return!0},filter:function(e){var t=[];this.forEach((function(n,r){return e(n,r)||t.push(n),!0}));for(var n=0,r=t;n<r.length;n++){var o=r[n];this.remove(o)}}}}t.makeDictionary=i,t.makeStringDict=function(){return i(o.identity)},t.makeNumberDict=function(){return i((function(e){return String(e)}))}},1897:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeHashSet=void 0;var r=n(356),o=n(1297);t.makeHashSet=function(e,t){return{map:{},keyToHash:e,keyEquals:t,nelements:0,add:function(e){var t=this.keyToHash(e);if((0,r.isNone)(this.map[t]))this.map[t]=[e],this.nelements+=1;else{for(var n=this.map[t],i=0;i<n.length;i+=1)if(this.keyEquals(e,n[i]))return;(0,o.logCollisionKey)(e),n.push(e),this.nelements+=1}},contains:function(e){var t=this.keyToHash(e),n=this.map[t];if((0,r.isNone)(n))return!1;for(var i=0;i<n.length;i+=1)if(this.keyEquals(e,n[i]))return!0;return(0,o.logCollisionKey)(e),!1},forEach:function(e){var t=this;Object.keys(this.map).forEach((function(n){t.map[Number(n)].forEach((function(t){e(t)}))}))},size:function(){return this.nelements},remove:function(e){var t=this,n=this.keyToHash(e),i=this.map[n];if((0,r.isNone)(i))return!1;var a=[],c=!1;return i.forEach((function(n){t.keyEquals(e,n)?(t.nelements-=1,c=!0):a.push(n)})),this.map[n]=a,c||(0,o.logCollisionKey)(e),c}}}},1898:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeHashTable=void 0;var r=n(657),o=n(1297),i=n(356);t.makeHashTable=function(e,t){return{map:{},nentries:0,keyToHash:e,keyEquals:t,getCount:function(){return this.nentries},getValue:function(e){var t=this.getEntry(e);return void 0===t?void 0:t.value},getEntry:function(e){var t=this.keyToHash(e),n=this.map[t];if(!(0,i.isNone)(n)){for(var r=0;r<n.length;r+=1){var a=n[r];if(this.keyEquals(e,a.key))return a}(0,o.logCollisionKey)(e)}},contains:function(e){return void 0!==this.getValue(e)},setValue:function(e,t){var n=this.keyToHash(e),i=this.map[n];if(null==i)this.map[n]=[(0,r.entry)(e,t)],this.nentries+=1;else{for(var a=0;a<i.length;a+=1){var c=i[a];if(this.keyEquals(c.key,e))return void(c.value=t)}i.push((0,r.entry)(e,t)),this.nentries+=1,(0,o.logCollisionKey)(e)}},remove:function(e){var t=this.keyToHash(e),n=this.map[t];if((0,i.isNone)(n))return!1;for(var r=[],a=!1,c=0;c<n.length;c+=1){var s=n[c];this.keyEquals(e,s.key)?(this.nentries-=1,a=!0):r.push(s)}return this.map[t]=r,a||(0,o.logCollisionKey)(e),a},getOrSetValue:function(e,t){var n=this.keyToHash(e),a=this.map[n];if((0,i.isNone)(a)){var c=t();return this.map[n]=[(0,r.entry)(e,c)],this.nentries+=1,c}for(var s=0;s<a.length;s+=1){var u=a[s];if(this.keyEquals(e,u.key))return u.value}var l=t();return a.push((0,r.entry)(e,l)),this.nentries+=1,(0,o.logCollisionKey)(e),l},forEach:function(e){var t=this;return Object.keys(this.map).every((function(n){return t.map[Number(n)].every((function(t){return e(t.key,t.value)}))}))},filter:function(e){var t=[];this.forEach((function(n,r){return e(n,r)||t.push(n),!0}));for(var n=0,r=t;n<r.length;n++){var o=r[n];this.remove(o)}}}}},1899:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.binarySearch=t.exponentialBuckets=t.linearBuckets=t.Histogram=void 0;var r=function(){function e(e){var t,n,r=this;this.buckets=e,this.createSampleCounts=function(){return new Array(r.buckets.length+1).fill(0)},this.sampleCounts=this.createSampleCounts(),this.findBucket=(t=function(e,t){return e-t},n=r.buckets.length,function(e){return o(r.buckets,0,n,e,t)})}return e.prototype.addSample=function(e){var t=this.findBucket(e);t<0&&(t=~t),this.sampleCounts[t]+=1},e.prototype.reset=function(){var e={buckets:this.buckets,sampleCounts:this.sampleCounts};return this.sampleCounts=this.createSampleCounts(),e},e}();function o(e,t,n,r,o){for(var i=t,a=t+n-1;i<=a;){var c=i+(a-i>>>1),s=o(e[c],r);if(0===s)return c;s<0?i=c+1:a=c-1}return~i}t.Histogram=r,t.linearBuckets=function(e,t,n){for(var r=(t-e)/(n-1),o=[],i=e,a=0;a<n;i+=r,a+=1)o.push(i);return o},t.exponentialBuckets=function(e,t,n){for(var r=Math.log(e),o=(Math.log(t)-r)/(n-1),i=[],a=0,c=0;c<n;a+=o,c+=1)i.push(Math.exp(r+a));return i},t.binarySearch=o},1900:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PriorityQueue=void 0;var r=n(1295),o=function(){function e(e){this.min=0,this.max=0,this.heap=new r.BinaryHeap((function(t,n){var r=t[0],o=t[1],i=n[0],a=n[1],c=e(r,i);return 0!==c?c:o-a}))}return e.prototype.peek=function(){var e=this.heap.peek();if(void 0!==e)return e[0]},e.prototype.enqueue=function(e){this.max+=1,this.heap.insert([e,this.max])},e.prototype.push=function(e){this.min-=1,this.heap.insert([e,this.min])},e.prototype.pop=function(){var e=this.heap.removeMin();return void 0===e?(this.min=0,void(this.max=0)):e[0]},e.prototype.getCount=function(){return this.heap.getCount()},e.prototype.clear=function(){this.heap.clear()},e}();t.PriorityQueue=o},1901:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.productSetSerializer=t.ProductSetSerializer=t.getSubspaceCount=t.forEachProduct=t.getSubspaces=t.symmetricDiffProduct=t.complementProduct=t.meetsProduct=t.compareProduct=t.exceptProduct=t.intersectProduct=t.unionProduct=t.project=t.createFromProduct=void 0;var r=n(1),o=n(1296),i=n(656),a=function(e,t){var n,r,o=e[0],i=t[0];return n=String(o),r=String(i),n<r?-1:n>r?1:0},c={};var s=function(e){for(var t=[],n=0,r=Object.keys(e);n<r.length;n++){var o=r[n];t.push([o,e[o].id])}var i=function(e){for(var t="",n=0,r=e;n<r.length;n++){var o=r[n];t+=String(o[0]),t+="\0",t+=String(o[1]),t+="\0"}return t}(t.sort(a)),s=c[i];return void 0===s&&(s={box:{},probabilities:{},depth:1},c[i]=s),s};function u(e){return Object.getOwnPropertyNames(e).length>0}var l=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,i.getTypedFeatureGate)("Microsoft.Office.Excel.ProductSetBugFixFromPR1043532")?d.apply(void 0,e):f.apply(void 0,e)};function d(e){return u(e)?{isSubspace:!0,bounds:e}:o.dense}function f(e){for(var t=!0,n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];if(Object.prototype.hasOwnProperty.call(e,i)){t=!1;break}}return t?o.dense:{isSubspace:!0,bounds:e}}function p(e){return e.isSubspace?1:e.subspaceCount}var h=function(e,t,n){return{isSubspace:!1,left:e,right:t,bounds:n,subspaceCount:p(e)+p(t)}};function m(e,t){if(t===o.dense)return t;if(t.isSubspace){for(var n=!1,r=0,i=Object.keys(t.bounds);r<i.length;r++){var a=i[r];if(Object.prototype.hasOwnProperty.call(e,a)){n=!0;break}}if(!n)return o.dense}return{productOperations:e,root:t}}function v(e){return void 0===e?o.dense:e}var g={unzip:function(e){for(var t={},n={},r=0,i=Object.keys(e);r<i.length;r++){var a=i[r];if(Object.prototype.hasOwnProperty.call(e,a)){var c=e[a];if(c===o.empty)return o.empty;if(c===o.dense)continue;t[a]=c.setOperations,n[a]=c.root}}return m(t,l(n))},combineProduct:function(e,t,n,r){for(var i={},a=0,c=Object.keys(e);a<c.length;a++){var s=c[a];if(Object.prototype.hasOwnProperty.call(e,s)){var u=r(e[s],e[s].top,v(t[s]),v(n[s]));if(u===o.empty)return o.empty;if(u===o.dense)continue;i[s]=u}}return i},restrict:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r={},o=0,i=t;o<i.length;o++){var a=i[o];if(Object.prototype.hasOwnProperty.call(e,a)){var c=e[a];r[a]=c}}return r},fromUntypedProduct:function(e,t,n){for(var r={},i=0,a=n;i<a.length;i++){var c=a[i],s=t[c];r[c]=(0,o.fromUntyped)(e[c],void 0!==s?s:o.dense)}return r},denseProduct:function(e){for(var t={},n=0,r=e;n<r.length;n++){t[r[n]]=o.dense}return t}};function y(e,t,n){var r=g.combineProduct(e,t,n,o.unionUntyped);if(r===o.empty)throw new Error("broken invariant: the union of two non-empty products cannot be empty");return r}function b(e,t,n){for(var r=0,i=0,a=Object.keys(e);i<a.length;i++){var c=a[i];if(Object.prototype.hasOwnProperty.call(e,c)){var s=v(t[c]),u=v(n[c]),l=e[c];if(void 0===(r=(0,o.combineCmp)(r,(0,o.compareUntyped)(l,l.top,s,u))))return}}return r}t.createFromProduct=g.unzip.bind(g);var S,C=(S={},function(e,t,n){var i;if(t===S.left&&n===S.right)return S.res;S.left=t,S.right=n;var a,c=b(e,t.bounds,n.bounds);if(void 0!==c)return S.res=c<=0?n:t;for(var s=0,u=Object.keys(e);s<u.length;s++){var d=u[s];if(Object.prototype.hasOwnProperty.call(e,d)&&0!==(0,o.compareUntyped)(e[d],e[d].top,v(t.bounds[d]),v(n.bounds[d]))){if(void 0!==a)return S.res=void 0;a=d}}if(void 0!==a){var f=(0,o.unionUntyped)(e[a],e[a].top,v(t.bounds[a]),v(n.bounds[a]));if(f===o.empty)return S.res=o.empty;if(f===o.dense){var p=t.bounds,h=a,m=(p[h],r.__rest(p,["symbol"==typeof h?h:h+""]));return S.res=l(m)}var g=r.__assign(r.__assign({},t.bounds),((i={})[a]=f,i));return S.res=l(g)}return S.res=void 0});function _(e,t,n){if(n===o.empty)return t;if(n===o.dense)return n;if(t===o.empty)return n;if(t===o.dense)return t;if(!t.isSubspace||!n.isSubspace)return h(t,n,y(e,t.bounds,n.bounds));var r=C(e,t,n);return void 0!==r?r:h(t,n,y(e,t.bounds,n.bounds))}function P(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var a=g.restrict.apply(g,r.__spreadArray([t.bounds],n,!1));if(t.isSubspace)return l(a);var c=P.apply(void 0,r.__spreadArray([e,t.left],n,!1));if(c===o.dense)return o.dense;var s=P.apply(void 0,r.__spreadArray([e,t.right],n,!1));return _(e,c,s)}function x(e,t,n){for(var i=[],a=3;a<arguments.length;a++)i[a-3]=arguments[a];if(t===o.empty||t===o.dense)return t;if(t.isSubspace){var c=g.restrict.apply(g,r.__spreadArray([t.bounds],i,!1));return l(c)}var s=E(e,n),u=s[0],d=s[1],f=w(e,t,u,d),p=f[0],h=f[1],m=x.apply(void 0,r.__spreadArray([e,p,u],i,!1)),v=x.apply(void 0,r.__spreadArray([e,h,d],i,!1));return _(e,m,v)}function k(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(e===o.dense||e===o.empty)return e;var i=g.restrict.apply(g,r.__spreadArray([e.productOperations],t,!1));if(!u(i))return o.dense;var a=x.apply(void 0,r.__spreadArray([i,e.root,s(i)],t,!1));return a===o.empty?a:m(i,a)}function O(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(e===o.dense||e===o.empty)return e;var i=g.restrict.apply(g,r.__spreadArray([e.productOperations],t,!1)),a=P.apply(void 0,r.__spreadArray([i,e.root],t,!1));return a===o.empty?a:m(i,a)}function E(e,t){var n,i,a,c;if(void 0!==t.children)return t.children;for(var s,u,l=t.box,d=t.probabilities,f=0,p=0,h=Object.keys(e);p<h.length;p++){var m=h[p];if(Object.prototype.hasOwnProperty.call(e,m)){var g=d[m],y=e[m];if(void 0===g){s=m,u=y.top;break}if(g>f){var b=v(l[m]);if(b===o.empty)throw new Error("the key split can never return empty");var S=y.top;if(b!==o.dense){if(!b.isExact)throw new Error("the key can always be represented exactly");S=b.key}if(!y.canSplit(S))continue;s=m,f=g,u=S}}}if(void 0===s||void 0===u)throw new Error("there has to be at least one dimension");var C=e[s],_=C.split(u),P=_[0],x=P[0],k=P[1],O=_[1],E=O[0],w=O[1],T=[{box:r.__assign(r.__assign({},l),(n={},n[s]=(0,o.lazy)(C,C.top,x),n)),probabilities:r.__assign(r.__assign({},d),(i={},i[s]=k,i)),depth:t.depth+1},{box:r.__assign(r.__assign({},l),(a={},a[s]=(0,o.lazy)(C,C.top,E),a)),probabilities:r.__assign(r.__assign({},d),(c={},c[s]=w,c)),depth:t.depth+1}];return t.depth<10&&(t.children=T),T}t.project=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,i.getTypedFeatureGate)("Microsoft.Office.Excel.ProductSetBugFixFromPR1043532")?k.apply(void 0,e):O.apply(void 0,e)};var w=function(e,t,n,r){return function e(t,n,r,i){if(n===o.empty)return[o.empty,o.empty];if(n===o.dense)return[l(r),l(i)];var a=b(t,n.bounds,r);if(void 0!==a&&a<=0)return[n,o.empty];var c=g.combineProduct(t,n.bounds,r,o.intersectUntyped);if(c===o.empty)return[o.empty,n];var s=g.combineProduct(t,n.bounds,i,o.intersectUntyped);if(n.isSubspace)return[l(c),s===o.empty?o.empty:l(s)];var u=e(t,n.left,r,i),d=u[0],f=u[1],p=e(t,n.right,r,i),h=p[0],m=p[1];return[_(t,d,h),_(t,f,m)]}(e,t,n.box,r.box)};function T(e,t,n,r,i){var a=E(e,r),c=a[0],s=a[1],u=w(e,t,c,s),l=u[0],d=u[1],f=w(e,n,c,s),p=f[0],h=f[1],m=i(e,l,p,c);return m===o.dense?o.dense:_(e,m,i(e,d,h,s))}function j(e,t,n,r){if(n===o.empty)return t;if(t===o.empty)return n;if(t===o.dense)return t;if(n===o.dense)return n;if(t.isSubspace&&n.isSubspace){var i=C(e,t,n);if(void 0!==i)return i}return T(e,t,n,r,j)}function M(e,t){if(t===o.empty)return e;if(t===o.dense)return t;if(e===o.empty)return t;if(e===o.dense)return e;var n=r.__assign(r.__assign({},e.productOperations),t.productOperations),i=j(n,e.root,t.root,s(n));return i===o.empty?i:m(n,i)}function A(e,t,n,r){if(t===o.empty||n===o.empty)return o.empty;if(t===o.dense)return n;if(n===o.dense)return t;if(t.isSubspace&&n.isSubspace){var i=g.combineProduct(e,t.bounds,n.bounds,o.intersectUntyped);return i===o.empty?o.empty:l(i)}return T(e,t,n,r,A)}function I(e,t,n,i){if(t===o.empty)return t;if(n===o.dense)return o.empty;if(n===o.empty)return t;if(t===o.dense)return T(e,t,n,i,I);if(t.isSubspace&&n.isSubspace){var a=function(e,t,n){var i,a,c=b(e,t.bounds,n.bounds);if(0===c||-1===c)return o.empty;for(var s=0,u=Object.keys(e);s<u.length;s++){var d=u[s];if(Object.prototype.hasOwnProperty.call(e,d)){var f=(0,o.compareUntyped)(e[d],e[d].top,v(t.bounds[d]),v(n.bounds[d]));if(void 0===f||f>0){if(void 0!==a)return;a=d}}}if(void 0!==a){var p=(0,o.exceptUntyped)(e[a],e[a].top,v(t.bounds[a]),v(n.bounds[a]));if(p===o.empty)return o.empty;if(p===o.dense){var h=t.bounds,m=a,g=(h[m],r.__rest(h,["symbol"==typeof m?m:m+""]));return l(g)}var y=r.__assign(r.__assign({},t.bounds),((i={})[a]=p,i));return l(y)}}(e,t,n);if(void 0!==a)return a}return T(e,t,n,i,I)}function F(e,t){if(e===o.empty)return e;if(t===o.empty)return e;if(t===o.dense)return o.empty;if(e===o.dense){var n=I(t.productOperations,o.dense,t.root,s(t.productOperations));return n===o.empty?n:m(t.productOperations,n)}var i=r.__assign(r.__assign({},e.productOperations),t.productOperations),a=I(i,e.root,t.root,s(i));return a===o.empty?a:m(i,a)}function R(e,t,n,r){if(t===o.empty||n===o.empty)return!1;if(t===o.dense||n===o.dense)return!0;if(!function(e,t,n){for(var r=0,i=Object.keys(e);r<i.length;r++){var a=i[r];if(Object.prototype.hasOwnProperty.call(e,a)){var c=v(t[a]),s=v(n[a]),u=e[a];if(!(0,o.meetsUntyped)(u,u.top,c,s))return!1}}return!0}(e,t.bounds,n.bounds))return!1;if(t.isSubspace&&n.isSubspace)return!0;var i=E(e,r),a=i[0],c=i[1],s=w(e,t,a,c),u=s[0],l=s[1],d=w(e,n,a,c),f=d[0],p=d[1];return R(e,u,f,a)||R(e,l,p,c)}t.unionProduct=M,t.intersectProduct=function(e,t){if(e===o.empty)return e;if(t===o.empty)return t;if(e===o.dense)return t;if(t===o.dense)return e;var n=r.__assign(r.__assign({},e.productOperations),t.productOperations),i=A(n,e.root,t.root,s(n));return i===o.empty?i:m(n,i)},t.exceptProduct=F,t.compareProduct=function(e,t){if(e===t)return 0;if(e===o.empty)return-1;if(t===o.empty)return 1;if(e===o.dense)return t===o.dense?0:1;if(t===o.dense)return-1;var n=r.__assign(r.__assign({},e.productOperations),t.productOperations);return function e(t,n,r,i){if(n===r)return 0;if(n===o.empty)return-1;if(r===o.empty)return 1;if(n===o.dense)return r===o.dense?0:1;if(r===o.dense)return-1;if(n.isSubspace&&r.isSubspace)return b(t,n.bounds,r.bounds);var a=E(t,i),c=a[0],s=a[1],u=w(t,n,c,s),l=u[0],d=u[1],f=w(t,r,c,s),p=f[0],h=f[1],m=e(t,l,p,c);return void 0!==m?(0,o.combineCmp)(m,e(t,d,h,s)):void 0}(n,e.root,t.root,s(n))},t.meetsProduct=function(e,t){if(e===o.empty||t===o.empty)return!1;if(e===o.dense||t===o.dense)return!0;var n=r.__assign(r.__assign({},e.productOperations),t.productOperations);return R(n,e.root,t.root,s(n))};t.complementProduct=function(e){return F(o.dense,e)};t.symmetricDiffProduct=function(e,t){return M(F(e,t),F(t,e))},t.getSubspaces=function(e){if(e===o.empty||e===o.dense)return[];var t=[];return function e(n){n.isSubspace?t.push(n.bounds):(e(n.left),e(n.right))}(e.root),t},t.forEachProduct=function(e,n){for(var i=[],a=2;a<arguments.length;a++)i[a-2]=arguments[a];var c=t.project.apply(void 0,r.__spreadArray([e],i,!1));if(c===o.empty)return!0;if(c===o.dense)return n(g.denseProduct(i));var s=c.productOperations,u=c.root;function l(e){return e.isSubspace?n(g.fromUntypedProduct(s,e.bounds,i)):l(e.left)&&l(e.right)}return l(u)},t.getSubspaceCount=function(e){return e===o.empty||e===o.dense?0:p(e.root)};var L=function(){function e(e){void 0===e&&(e=[]),this.buffer=e,this.cursor=0}return e.prototype.putBack=function(e){this.cursor-=1,this.buffer[this.cursor]=e},e.prototype.pick=function(){return this.buffer[this.cursor]},Object.defineProperty(e.prototype,"length",{get:function(){return this.buffer.length-this.cursor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return 0===this.length},enumerable:!1,configurable:!0}),e.prototype.pop=function(){var e=this.pick();return this.cursor+=1,e},e}(),D=function(){var e=this;this.size=0,this.clear=function(){},this.get=function(){},this.set=function(){return e}};function N(e,t){return function(n,o){for(var i=[],a=2;a<arguments.length;a++)i[a-2]=arguments[a];var c=t.get(n);void 0===c?(e.apply(void 0,r.__spreadArray([n,o],i,!1)),t.set(n,t.size)):o.push("__cached__",c)}}function U(e,t){return function(n){for(var o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];if("__cached__"===n.pick()){n.pop();var a=n.pop();return t[a]}var c=e.apply(void 0,r.__spreadArray([n],o,!1));return t.push(c),c}}var B=function(){function e(t){var n,r,i,a,c=this;for(var s in this.globalProductOperations=t,this.cached="undefined"!=typeof Map?new Map:new D,this.cache=[],this.serializers={},this.serializeProductSet=function(e,t){if(e!==o.empty&&e!==o.dense){var n=e,r=c.getDims(n.productOperations);t.push(r),c.serializeUntypedSparseProductCached(n.root,t,r)}else t.push(e)},this.deserializeProductSet=function(e){var t=e.pop();if(t===o.empty||t===o.dense)return t;e.putBack(t);for(var n={},r=e.pop(),i=0,a=r;i<a.length;i++){var s=a[i],u=c.globalProductOperations[s];n[s]=u}return{productOperations:n,root:c.deserializeUntypedSparseProductCached(e,r)}},this.serializeUntypedSparse=function(t,n,r){n.push(null==t?void 0:t.isExact),n.push(c.serializers[r].serializeBound(null==t?void 0:t.infimum)),n.push(c.serializers[r].serializeBound(null==t?void 0:t.supremum));var i=e.normalizeKey(null==t?void 0:t.key);n.push(c.serializers[r].serializeKey(i));for(var a=0,s=[null==t?void 0:t.left,null==t?void 0:t.right];a<s.length;a++){var u=s[a];null==u||u===o.empty||u===o.dense?n.push(u):(n.push("us"),c.serializeUntypedSparseCached(u,n,r))}},this.deserializeUntypedSparse=function(e,t){var n=e.pop(),r=c.serializers[t].deserializeBound(e.pop()),o=c.serializers[t].deserializeBound(e.pop()),i=c.serializers[t].deserializeKey(e.pop()),a=["left","right"].map((function(n){var r=e.pop();return"us"===r?c.deserializeUntypedSparseCached(e,t):r}));return{infimum:r,supremum:o,isExact:n,key:i,left:a[0],right:a[1]}},this.serializeUntypedSparseProduct=function(e,t,n){t.push(e.isSubspace);for(var r=0,o=n;r<o.length;r++){var i=o[r],a=e.bounds[i];c.serializeUntypedSparseCached(a,t,i)}e.isSubspace||(c.serializeUntypedSparseProductCached(e.left,t,n),c.serializeUntypedSparseProductCached(e.right,t,n),t.push(e.subspaceCount))},this.deserializeUntypedSparseProduct=function(e,t){for(var n=e.pop(),r={},o=0,i=t;o<i.length;o++){var a=i[o],s=c.deserializeUntypedSparseCached(e,a);r[a]=s}return n?{isSubspace:n,bounds:r}:{isSubspace:n,bounds:r,left:c.deserializeUntypedSparseProductCached(e,t),right:c.deserializeUntypedSparseProductCached(e,t),subspaceCount:e.pop()}},this.serializeUntypedSparseCached=N(this.serializeUntypedSparse,this.cached),this.deserializeUntypedSparseCached=U(this.deserializeUntypedSparse,this.cache),this.serializeProductSetCached=N(this.serializeProductSet,this.cached),this.deserializeProductSetCached=U(this.deserializeProductSet,this.cache),this.serializeUntypedSparseProductCached=N(this.serializeUntypedSparseProduct,this.cached),this.deserializeUntypedSparseProductCached=U(this.deserializeUntypedSparseProduct,this.cache),t){var u={serializeKey:null!==(n=t[s].serializeKey)&&void 0!==n?n:function(e){return JSON.stringify(e)},deserializeKey:null!==(r=t[s].deserializeKey)&&void 0!==r?r:function(e){return JSON.parse(e)},serializeBound:null!==(i=t[s].serializeBound)&&void 0!==i?i:function(e){return JSON.stringify(e)},deserializeBound:null!==(a=t[s].deserializeBound)&&void 0!==a?a:function(e){return JSON.parse(e)}};this.serializers[s]=u}}return e.prototype.getDims=function(e){return Object.keys(e)},e.prototype.serialize=function(e){this.cached.clear();var t=[];t.push(e.length);for(var n=0,r=e;n<r.length;n++){var o=r[n];this.serializeProductSetCached(o,t)}return JSON.stringify(t)},e.prototype.deserialize=function(e){this.cache.length=0;for(var t=new L(JSON.parse(e)),n=t.pop(),r=[],o=0;o<n;o+=1){var i=this.deserializeProductSetCached(t);r.push(i)}return r},e.normalizeKey=function(e){if("object"==typeof e){var t=r.__assign({},e);return delete t.depth,delete t.split,t}return e},e}();t.ProductSetSerializer=B,t.productSetSerializer=function(e){return new B(e)}},1902:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RedBlackMapTree=void 0;var r=n(1299),o=function(){function e(e,t,n){this.root=e,this.count=t,this.keyCompare=n}return e.create=function(t){return new e(r.emptyUntyped,0,t)},e.prototype.getCount=function(){return this.count},e.prototype.getValue=function(e){var t=(0,r.findUntyped)(this,e,this.root);return null==t?void 0:t.value},e.prototype.getEntry=function(e){return(0,r.findUntyped)(this,e,this.root)},e.prototype.contains=function(e){return void 0!==this.getValue(e)},e.prototype.forEach=function(e){return(0,r.forEachUntyped)(e,this.root)},e.prototype.setValue=function(t,n){return new e((0,r.insertUntyped)(this,t,n,this.root),this.contains(t)?this.count:this.count+1,this.keyCompare)},e.prototype.remove=function(t){return this.contains(t)?new e((0,r.removeUntyped)(this,t,this.root),this.count-1,this.keyCompare):this},e.prototype.getOrSetValue=function(t,n){var o=this.getValue(t);if(void 0!==o)return[this,o];var i=n();return[new e((0,r.insertUntyped)(this,t,i,this.root),this.count+1,this.keyCompare),i]},e.prototype.filter=function(t){var n=this,o=r.emptyUntyped,i=0;return this.forEach((function(e,a){return t(e,a)&&(o=(0,r.insertUntyped)(n,e,a,o),i+=1),!1})),new e(o,i,this.keyCompare)},e}();t.RedBlackMapTree=o},1903:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RingBuffer=void 0;var r=function(){function e(e){void 0===e&&(e=1/0),this.list=e<1/0?new Array(e):new Array,this.counter=0,this.capacity=e,this.readIndex=0,this.writeIndex=0}return e.prototype.count=function(){return this.counter},e.prototype.isEmpty=function(){return 0===this.counter},e.prototype.enqueue=function(e){this.list[this.writeIndex]=e,0!==this.counter&&this.writeIndex===this.readIndex?this.readIndex=(this.readIndex+1)%this.capacity:this.counter++,this.writeIndex=(this.writeIndex+1)%this.capacity},e.prototype.dequeue=function(){if(!this.isEmpty()){var e=this.list[this.readIndex];return this.list[this.readIndex]=void 0,this.readIndex=(this.readIndex+1)%this.capacity,this.counter--,e}},e.prototype.executeOnEveryElement=function(e){for(var t=0;t<this.counter;t++){var n=(this.readIndex+t)%this.capacity,r=this.list[n];if(void 0!==r)if(!e(r))return!1}return!0},e}();t.RingBuffer=r},1904:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RTree=t.RTKind=t.copyExcept=void 0;var r,o=n(1),i=n(356),a=n(657);function c(e,t,n){if(void 0!==n){var r=e.slice();return r[t]=n,r}var o=e.slice(0,-1);return t<e.length-1&&(o[t]=e[e.length-1]),o}function s(e,t,n){return{kind:e,key:t,value:n}}function u(e,t){return s(r.Ptr,e,t)}function l(e,t){return s(r.Leaf,e,t)}function d(e,t){return s(r.Branch,e,t)}t.copyExcept=c,function(e){e[e.Ptr=1]="Ptr",e[e.Leaf=2]="Leaf",e[e.Branch=3]="Branch"}(r=t.RTKind||(t.RTKind={}));var f=function(){function e(e,t,n){this.lattice=e,this.root=t,this.count=n}return e.create=function(t,n,r,o,i){void 0===i&&(i=2);var a=i>1?Math.ceil(i):1;return new e({keyJoin:t,keyMeets:n,keyCompare:r,keyDistance:o,minChildren:a,maxChildren:2*a,keyGe:function(e,t){var n=r(e,t);return void 0!==n&&n>=0},keyLe:function(e,t){var n=r(e,t);return void 0!==n&&n<=0}},void 0,0)},e.prototype.getCount=function(){return this.count},Object.defineProperty(e.prototype,"bounds",{get:function(){var e;return null===(e=this.root)||void 0===e?void 0:e.key},enumerable:!1,configurable:!0}),e.prototype.getValue=function(e){if(void 0!==this.root)return function t(n,o){var i=n.keyCompare(o.key,e);if(o.kind===r.Ptr)return 0===i?o.value:void 0;if(!(void 0===i||i<0))for(var a=0,c=o.value;a<c.length;a++){var s=t(n,c[a]);if(void 0!==s)return s}}(this.lattice,this.root)},e.prototype.getEntry=function(e){var t=this.getValue(e);return void 0===t?void 0:(0,a.entry)(e,t)},e.prototype.setValue=function(t,n,r){void 0===r&&(r=function(e){return!0});var o=y(this.lattice,this.root,t,r,n);return void 0!==o?o===this.root?this:new e(this.lattice,o,this.count):new e(this.lattice,g(this.lattice,this.root,u(t,n)),this.count+1)},e.prototype.filter=function(t){var n=new e(this.lattice,void 0,0);return this.forEach((function(e,r){return t(e,r)&&(n=n.setValue(e,r)),!0})),n},e.prototype.contains=function(e,t){return void 0===t&&(t=function(e){return!0}),void 0!==y(this.lattice,this.root,e,t)},e.prototype.getOrSetValue=function(e,t){var n=this.getValue(e);if(void 0===n){var r=t();return[this.setValue(e,r),r]}return[this,n]},e.prototype.forEach=function(e){return p(this.root,e)},e.prototype.forEachGe=function(e,t){var n=this;return p(this.root,t,(function(t){return n.lattice.keyGe(t,e)}),(function(t){return n.lattice.keyGe(t,e)}))},e.prototype.forEachLe=function(e,t){var n=this;return p(this.root,t,(function(t){return n.lattice.keyMeets(t,e)}),(function(t){return n.lattice.keyLe(t,e)}))},e.prototype.forEachMeets=function(e,t){var n=this;return p(this.root,t,(function(t){return n.lattice.keyMeets(t,e)}),(function(t){return n.lattice.keyMeets(t,e)}))},e.prototype.remove=function(t){var n=this;if(null==this.root)return this;var o=[],a=this.lattice,s=function(e,n){var u=a.keyCompare(e.key,t);if(void 0===u||u<0)return(0,i.pair)(e,1);if(e.kind===r.Leaf){for(var f=e.value,p=0;p<f.length;p+=1)if(0===a.keyCompare(f[p].key,t)){if((b=c(f,p)).length<n){var h=l(e.key,b);return o.push(h),(0,i.pair)(h,3)}return(0,i.pair)(l(m(a,b),b),2)}}else for(f=e.value,p=0;p<f.length;p+=1){var v=s(f[p],a.minChildren),g=v[0],y=v[1];if(3===y){var b;if((b=c(f,p)).length>=n)return(0,i.pair)(d(m(a,b),b),2);h=d(e.key,b);return o.push(h),(0,i.pair)(h,3)}if(2===y)return(0,i.pair)(d(e.key,c(f,p,g)),2)}return(0,i.pair)(e,1)},f=this.root.kind===r.Leaf?1:2,h=s(this.root,f),v=h[0],y=h[1];if(v===this.root)return this;for(var b=3===y?void 0:v,S=0;S<o.length;S+=1)p(o[S],(function(e,t){return b=g(n.lattice,b,u(e,t)),!0}));return new e(this.lattice,b,this.count-1)},e}();function p(e,t,n,o){var i=void 0!==n?n:function(){return!0},a=void 0!==o?o:function(){return!0};if(null==e)return!0;var c=function(e){if(!i(e.key))return!0;if(e.kind===r.Leaf)for(var n=e.value,o=0;o<n.length;o+=1){var s=n[o];if(a(s.key)&&!t(s.key,s.value))return!1}else for(n=e.value,o=0;o<n.length;o+=1)if(!c(n[o]))return!1;return!0};return c(e)}function h(e,t){for(var n=function(e,t){for(var n=0,r=1,o=e.keyDistance(t[0].key,t[1].key),a=2;a<t.length;a+=1)for(var c=0;c<a;c+=1){var s=e.keyDistance(t[c].key,t[a].key);s>o&&(n=c,r=a,o=s)}return(0,i.pair)(n,r)}(e,t),r=n[0],o=n[1],a=t[r].key,c=t[o].key,s=[],u=0;u<t.length;u+=1){var l=t[u];s.push([l,e.keyDistance(a,l.key)-e.keyDistance(c,l.key)])}s.sort((function(e,t){return e[1]-t[1]}));for(var d=e.minChildren;d<t.length-e.minChildren&&s[d][1]<0;d+=1);var f=[],p=[];for(u=0;u<d;u+=1)f.push(s[u][0]);for(u=d;u<t.length;u+=1)p.push(s[u][0]);return(0,i.pair)(f,p)}function m(e,t){for(var n=t[0].key,r=1;r<t.length;r+=1)n=e.keyJoin(n,t[r].key);return n}function v(e,t,n){var r=h(e,n),o=r[0],a=r[1];return(0,i.pair)(s(t,m(e,o),o),s(t,m(e,a),a))}function g(e,t,n){if(null==t)return l(n.key,[n]);var a=function t(a){if(a.kind===r.Leaf){var c=o.__spreadArray(o.__spreadArray([],a.value,!0),[n],!1);if(c.length>e.maxChildren){var s=v(e,a.kind,c),u=s[0],f=s[1];return(0,i.pair)(l(u.key,u.value),f)}return(0,i.pair)(l(e.keyJoin(a.key,n.key),c),void 0)}var p=a.value.slice(),h=function(e,t,n){for(var r=0,o=e.keyDistance(t[0].key,n),i=t[0].value.length,a=1;a<t.length;a+=1){var c=t[a],s=e.keyDistance(c.key,n);(s<o||s===o&&c.value.length<i)&&(r=a,o=s,i=c.value.length)}return r}(e,p,n.key),m=t(p[h]),g=m[0],y=m[1];if(p[h]=g,null!=y&&(p.push(y),p.length>e.maxChildren)){var b=v(e,a.kind,p),S=b[0];f=b[1];return(0,i.pair)(d(S.key,S.value),f)}return(0,i.pair)(d(e.keyJoin(a.key,n.key),p),void 0)}(t),c=a[0],s=a[1];return null!=s?d(e.keyJoin(c.key,s.key),[c,s]):c}function y(e,t,n,o,i){if(void 0!==t)return function t(o){if(o.kind!==r.Leaf)for(i=0;i<o.value.length;i+=1){s=o.value[i];if(e.keyMeets(s.key,n))if(void 0!==(u=t(s)))return d(o.key,c(o.value,i,u))}else for(var i=0;i<o.value.length;i+=1){var s,u;if(void 0!==(u=a(s=o.value[i])))return l(o.key,c(o.value,i,u))}}(t);function a(t){if(0===e.keyCompare(t.key,n))return void 0!==i&&t.value!==i&&o(t.value)?u(t.key,i):t}}t.RTree=f},1905:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.boundedParetoSetOperations=t.boundedParetoSplitter=t.boundedPareto=void 0;var r=n(356),o=n(1298);function i(e,t,n){var r=Math.pow(t,e),o=1-Math.pow(t/n,e),i=Math.pow(n,e),a=i*r,c=i-r,s=-1/e;return{cdf:1===e?function(e){return(1-r/e)/o}:function(t){return(1-r*Math.pow(t,-e))/o},invCdf:1===e?function(e){return 1/((i-e*c)/a)}:function(e){return Math.pow((i-e*c)/a,s)}}}function a(e,t,n){var o=i(e,t,n);return{canSplit:function(e){var t=e[0];return e[1]-t>1},split:function(e){var t=e[0],n=e[1],i=o.cdf(n),a=o.cdf(t+1),c=o.invCdf((i+a)/2),s=(0,r.fastMin)((0,r.fastMax)(Math.round(c),t+1),n-1);return[[[t,s],o.cdf(s)-o.cdf(t+1)],[[s,n],o.cdf(n)-o.cdf(s)]]}}}t.boundedPareto=i,t.boundedParetoSplitter=a,t.boundedParetoSetOperations=function(e,t,n,i,c){var s=a(e,t,n);return{id:c,split:function(e){return s.split(e)},canSplit:function(e){return s.canSplit(e)},meets:o.ivlMeets,intersect:o.ivlMeet,union:function(e,t){return(0,o.ivlMeetsOrTouches)(e,t)?(0,o.ivlJoin)(e,t):void 0},except:o.ivlExcept,compare:o.ivlCompare,top:i,infimum:function(e){return e[0]},supremum:function(e){return e[1]},combineInfima:function(e,t){return(0,r.fastMin)(e,t)},combineSuprema:function(e,t){return(0,r.fastMax)(e,t)}}}},1906:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.broadcastArray2D=t.broadcastArray=t.colArray2D=t.rowArray2D=t.singletonArray2D=t.constantArray2D=t.constantArray=t.array2DToJaggedArray=t.jaggedArray=t.array2DForall2=t.array2DForall=t.NonstrictSparseArray2D=t.NonstrictArray2D=t.StrictSparseArray2D=t.strictArray2D=t.StrictArray2D=void 0;var r=n(461),o=n(356),i=function(){function e(e,t,n){(0,r.assertNatural)("calc.common.StrictArray2D",e),(0,r.assertNatural)("calc.common.StrictArray2D",t);var o=n.length;o<e&&(0,r.assertFalse)("calc.common.StrictArray2D: expected elements.length >= ".concat(e,"; given ").concat(o));for(var i=0;i<o;i+=1){var a=n[i].length;a<t&&(0,r.assertFalse)("calc.common.StrictArray2D: expected elements[".concat(i,"].length >= ").concat(e,"; given ").concat(a))}this.rows=e,this.cols=t,this.elements=n}return e.prototype.get=function(e,t){return(0,r.assertIndex)("calc.common.StrictArray2D.get",e,this.rows),(0,r.assertIndex)("calc.common.StrictArray2D.get",t,this.cols),this.elements[e][t]},e.prototype.strict=function(){return this},e.prototype.map=function(e){var t=this;return new c(this.rows,this.cols,(function(n,r){return e(t.elements[n][r])}))},e}();t.StrictArray2D=i,t.strictArray2D=function(e,t,n){return new i(e,t,n)};var a=function(){function e(e,t,n,o,i,a){(0,r.assertNatural)("calc.common.StrictSparseArray2D",e),(0,r.assertNatural)("calc.common.StrictSparseArray2D",t),(0,r.assertIndex)("calc.common.StrictSparseArray2D",n,e+1),(0,r.assertIndex)("calc.common.StrictSparseArray2D",o,t+1);var c=i.length;c<n&&(0,r.assertFalse)("calc.common.StrictSparseArray2D: expected elements.length >= ".concat(n,"; given ").concat(c));for(var s=0;s<c;s+=1){var u=i[s].length;u<o&&(0,r.assertFalse)("calc.common.StrictSparseArray2D: expected elements[".concat(s,"].length >= ").concat(o,"; given ").concat(u))}this.rows=e,this.cols=t,this.denseRows=n,this.denseCols=o,this.denseElements=i,this.sparseElement=a}return e.prototype.get=function(e,t){return(0,r.assertIndex)("calc.common.StrictSparseArray2D.get",e,this.rows),(0,r.assertIndex)("calc.common.StrictSparseArray2D.get",t,this.cols),e<this.denseRows&&t<this.denseCols?this.denseElements[e][t]:this.sparseElement},e.prototype.getSparse=function(){return this.sparseElement},e.prototype.strict=function(){return this},e.prototype.map=function(e){var t=this;return new s(this.rows,this.cols,this.denseRows,this.denseCols,(function(n,r){return e(t.denseElements[n][r])}),(function(){return e(t.sparseElement)}))},e}();t.StrictSparseArray2D=a;var c=function(){function e(e,t,n){(0,r.assertNatural)("calc.common.NonstrictArray2D",e),(0,r.assertNatural)("calc.common.NonstrictArray2D",t),this.rows=e,this.cols=t,this.func=n}return e.prototype.get=function(e,t){return(0,r.assertIndex)("calc.common.NonstrictArray2D.get",e,this.rows),(0,r.assertIndex)("calc.common.NonstrictArray2D.get",t,this.cols),this.func(e,t)},e.prototype.strict=function(){var e=u(this.rows,this.cols,this.func);return new i(this.rows,this.cols,e)},e.prototype.map=function(t){var n=this;return new e(this.rows,this.cols,(function(e,r){return t(n.func(e,r))}))},e}();t.NonstrictArray2D=c;var s=function(){function e(e,t,n,o,i,a){(0,r.assertNatural)("calc.common.NonstrictSparseArray2D",e),(0,r.assertNatural)("calc.common.NonstrictSparseArray2D",t),(0,r.assertIndex)("calc.common.NonstrictSparseArray2D",n,e+1),(0,r.assertIndex)("calc.common.NonstrictSparseArray2D",o,t+1),this.rows=e,this.cols=t,this.denseRows=n,this.denseCols=o,this.denseFunc=i,this.sparseFunc=a}return e.prototype.get=function(e,t){return(0,r.assertIndex)("calc.common.NonstrictSparseArray2D.get",e,this.rows),(0,r.assertIndex)("calc.common.NonstrictSparseArray2D.get",t,this.cols),e<this.denseRows&&t<this.denseCols?this.denseFunc(e,t):this.sparseFunc()},e.prototype.getSparse=function(){return this.sparseFunc()},e.prototype.strict=function(){var e=u(this.denseRows,this.denseCols,this.denseFunc),t=this.sparseFunc();return new a(this.rows,this.cols,this.denseRows,this.denseCols,e,t)},e.prototype.map=function(t){var n=this;return new e(this.rows,this.cols,this.denseRows,this.denseCols,(function(e,r){return t(n.denseFunc(e,r))}),(function(){return t(n.sparseFunc())}))},e}();function u(e,t,n){for(var r=[],o=0;o<e;o+=1){for(var i=[],a=0;a<t;a+=1)i[a]=n(o,a);r[o]=i}return r}function l(e,t,n){for(var r=[],o=[],i=0;i<t;i+=1)o[i]=n;for(var a=0;a<e;a+=1)r[a]=o;return r}function d(e,t,n){return new c(e,t,(function(e,t){return n}))}t.NonstrictSparseArray2D=s,t.array2DForall=function(e,t){for(var n=0;n<t.rows;n+=1)for(var r=0;r<t.cols;r+=1)if(!e(t.get(n,r)))return!1;return!0},t.array2DForall2=function(e,t,n){for(var r=(0,o.fastMin)(t.rows,n.rows),i=(0,o.fastMin)(t.cols,n.cols),a=0;a<r;a+=1)for(var c=0;c<i;c+=1)if(!e(t.get(a,c),n.get(a,c)))return!1;return!0},t.jaggedArray=u,t.array2DToJaggedArray=function(e){return u(e.rows,e.cols,e.get.bind(e))},t.constantArray=l,t.constantArray2D=d,t.singletonArray2D=function(e){return d(1,1,e)},t.rowArray2D=function(e){return new c(1,e.length,(function(t,n){return e[n]}))},t.colArray2D=function(e){return new c(e.length,1,(function(t,n){return e[t]}))},t.broadcastArray=function(e,t,n,r,o,i){if(e===n&&t===r)return o;if(1===e&&1===t)return l(n,r,void 0===o[0]?i:o[0][0]);var a,c=[];a=1===e?function(e,n){return n<t?o[0][n]:i}:1===t?function(t,n){return t<e?o[t][0]:i}:function(n,r){return n<e&&r<t?o[n][r]:i};for(var s=0;s<n;s+=1){c.push([]);for(var u=0;u<r;u+=1)c[s][u]=a(s,u)}return c},t.broadcastArray2D=function(e,t,n,r){return n.rows===e&&n.cols===t?n:1===n.rows&&1===n.cols?d(e,t,n.get(0,0)):1===n.rows?new c(e,t,(function(e,t){return t<n.cols?n.get(0,t):r})):1===n.cols?new c(e,t,(function(e,t){return e<n.rows?n.get(e,0):r})):new c(e,t,(function(e,t){return e<n.rows&&t<n.cols?n.get(e,t):r}))}},1907:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1908:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.asyncLoop=t.asyncLoopFactory=t.delayPromiseImpl=void 0;var r=n(356),o=n(1072),i=n(1300);function a(e){return function(t){return new Promise((function(n){return e.setTimeout(n,t,void 0)}))}}function c(e){return function(t,n){var i,a,c,s=null!==(i=null==n?void 0:n.timeThreshold)&&void 0!==i?i:10,u=null!==(a=null==n?void 0:n.costThreshold)&&void 0!==a?a:1,l=null!==(c=null==n?void 0:n.macrotaskDelay)&&void 0!==c?c:0,d={iterations:0,microtaskContinues:0,macrotaskContinues:0,macrotaskTotalDelay:0},f=(0,o.newPromise)(),p=f[0],h=f[1],m=h[0],v=h[1];var g=!0;var y=e(l),b=(0,r.now)();return function n(){if(!g||!function(){try{for(var e=0;e<u;){d.iterations+=1;var n=t();if(void 0===n)return!1;e+=n}return!0}catch(e){return v(e),!1}}())return m();var o=(0,r.now)();o-b<s?(Promise.resolve().then(n),d.microtaskContinues+=1):(y.then((function(){y=e(l),b=(0,r.now)(),d.macrotaskTotalDelay+=b-o,n()})),d.macrotaskContinues+=1)}(),{promise:p,stop:function(){g=!1},stats:d}}}t.delayPromiseImpl=a,t.asyncLoopFactory=c,t.asyncLoop=c(a(i.defaultSetTimeoutInterface))},1909:function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var r,o,i,a,c,s=1,u={},l=!1,d=e.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(e);f=f&&f.setTimeout?f:e,"[object process]"==={}.toString.call(e.process)?r=function(e){t.nextTick((function(){h(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?((i=new MessageChannel).port1.onmessage=function(e){h(e.data)},r=function(e){i.port2.postMessage(e)}):d&&"onreadystatechange"in d.createElement("script")?(o=d.documentElement,r=function(e){var t=d.createElement("script");t.onreadystatechange=function(){h(e),t.onreadystatechange=null,o.removeChild(t),t=null},o.appendChild(t)}):r=function(e){setTimeout(h,0,e)}:(a="setImmediate$"+Math.random()+"$",c=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(a)&&h(+t.data.slice(a.length))},e.addEventListener?e.addEventListener("message",c,!1):e.attachEvent("onmessage",c),r=function(t){e.postMessage(a+t,"*")}),f.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var o={callback:e,args:t};return u[s]=o,r(s),s++},f.clearImmediate=p}function p(e){delete u[e]}function h(e){if(l)setTimeout(h,0,e);else{var t=u[e];if(t){l=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{p(e),l=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(330),n(986))},1910:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codePointCapitalD=t.codePointCapitalC=t.codePointCapitalB=t.codePointCapitalA=t.codePointTilde=t.codePointRightCurlyBracket=t.codePointPipe=t.codePointLeftCurlyBracket=t.codePointBacktick=t.codePointUnderscore=t.codePointCircumflexAccent=t.codePointRightSquareBracket=t.codePointBackslash=t.codePointLeftSquareBracket=t.codePointAtSign=t.codePointQuestionMark=t.codePointGreaterThanSign=t.codePointEqualsSign=t.codePointLessThanSign=t.codePointSemicolon=t.codePointColon=t.codePointDigitNine=t.codePointDigitEight=t.codePointDigitSeven=t.codePointDigitSix=t.codePointDigitFive=t.codePointDigitFour=t.codePointDigitThree=t.codePointDigitTwo=t.codePointDigitOne=t.codePointDigitZero=t.codePointSlash=t.codePointFullStop=t.codePointMinusSign=t.codePointComma=t.codePointPlusSign=t.codePointAsterisk=t.codePointRightParen=t.codePointLeftParen=t.codePointSingleQuote=t.codePointAmpersand=t.codePointPercentSign=t.codePointDollarSign=t.codePointHash=t.codePointDoubleQuote=t.codePointExclamationMark=t.codePointSpace=t.codePointCR=t.codePointLF=t.codePointTab=void 0,t.codePointThaiDigitNine=t.codePointThaiDigitZero=t.codePointSmallZ=t.codePointSmallY=t.codePointSmallX=t.codePointSmallW=t.codePointSmallV=t.codePointSmallU=t.codePointSmallT=t.codePointSmallS=t.codePointSmallR=t.codePointSmallQ=t.codePointSmallP=t.codePointSmallO=t.codePointSmallN=t.codePointSmallM=t.codePointSmallL=t.codePointSmallK=t.codePointSmallJ=t.codePointSmallI=t.codePointSmallH=t.codePointSmallG=t.codePointSmallF=t.codePointSmallE=t.codePointSmallD=t.codePointSmallC=t.codePointSmallB=t.codePointSmallA=t.codePointCapitalZ=t.codePointCapitalY=t.codePointCapitalX=t.codePointCapitalW=t.codePointCapitalV=t.codePointCapitalU=t.codePointCapitalT=t.codePointCapitalS=t.codePointCapitalR=t.codePointCapitalQ=t.codePointCapitalP=t.codePointCapitalO=t.codePointCapitalN=t.codePointCapitalM=t.codePointCapitalL=t.codePointCapitalK=t.codePointCapitalJ=t.codePointCapitalI=t.codePointCapitalH=t.codePointCapitalG=t.codePointCapitalF=t.codePointCapitalE=void 0,t.codePointInvertedQuestionMark=t.codePointInvertedExclamationMark=t.codePointRightSingleQuotationMark=t.codePointLeftSingleQuotationMark=t.codePointEuroSign=t.codePointFullwidthLatinSmallZ=t.codePointFullwidthLatinSmallA=t.codePointFullwidthLatinCapitalZ=t.codePointFullwidthLatinCapitalA=t.codePointFullwidthDigitNine=t.codePointFullwidthDigitZero=void 0,t.codePointTab=9,t.codePointLF=10,t.codePointCR=13,t.codePointSpace=32,t.codePointExclamationMark=33,t.codePointDoubleQuote=34,t.codePointHash=35,t.codePointDollarSign=36,t.codePointPercentSign=37,t.codePointAmpersand=38,t.codePointSingleQuote=39,t.codePointLeftParen=40,t.codePointRightParen=41,t.codePointAsterisk=42,t.codePointPlusSign=43,t.codePointComma=44,t.codePointMinusSign=45,t.codePointFullStop=46,t.codePointSlash=47,t.codePointDigitZero=48,t.codePointDigitOne=49,t.codePointDigitTwo=50,t.codePointDigitThree=51,t.codePointDigitFour=52,t.codePointDigitFive=53,t.codePointDigitSix=54,t.codePointDigitSeven=55,t.codePointDigitEight=56,t.codePointDigitNine=57,t.codePointColon=58,t.codePointSemicolon=59,t.codePointLessThanSign=60,t.codePointEqualsSign=61,t.codePointGreaterThanSign=62,t.codePointQuestionMark=63,t.codePointAtSign=64,t.codePointLeftSquareBracket=91,t.codePointBackslash=92,t.codePointRightSquareBracket=93,t.codePointCircumflexAccent=94,t.codePointUnderscore=95,t.codePointBacktick=96,t.codePointLeftCurlyBracket=123,t.codePointPipe=124,t.codePointRightCurlyBracket=125,t.codePointTilde=126,t.codePointCapitalA=65,t.codePointCapitalB=66,t.codePointCapitalC=67,t.codePointCapitalD=68,t.codePointCapitalE=69,t.codePointCapitalF=70,t.codePointCapitalG=71,t.codePointCapitalH=72,t.codePointCapitalI=73,t.codePointCapitalJ=74,t.codePointCapitalK=75,t.codePointCapitalL=76,t.codePointCapitalM=77,t.codePointCapitalN=78,t.codePointCapitalO=79,t.codePointCapitalP=80,t.codePointCapitalQ=81,t.codePointCapitalR=82,t.codePointCapitalS=83,t.codePointCapitalT=84,t.codePointCapitalU=85,t.codePointCapitalV=86,t.codePointCapitalW=87,t.codePointCapitalX=88,t.codePointCapitalY=89,t.codePointCapitalZ=90,t.codePointSmallA=97,t.codePointSmallB=98,t.codePointSmallC=99,t.codePointSmallD=100,t.codePointSmallE=101,t.codePointSmallF=102,t.codePointSmallG=103,t.codePointSmallH=104,t.codePointSmallI=105,t.codePointSmallJ=106,t.codePointSmallK=107,t.codePointSmallL=108,t.codePointSmallM=109,t.codePointSmallN=110,t.codePointSmallO=111,t.codePointSmallP=112,t.codePointSmallQ=113,t.codePointSmallR=114,t.codePointSmallS=115,t.codePointSmallT=116,t.codePointSmallU=117,t.codePointSmallV=118,t.codePointSmallW=119,t.codePointSmallX=120,t.codePointSmallY=121,t.codePointSmallZ=122,t.codePointThaiDigitZero=3664,t.codePointThaiDigitNine=3673,t.codePointFullwidthDigitZero=65296,t.codePointFullwidthDigitNine=65305,t.codePointFullwidthLatinCapitalA=65313,t.codePointFullwidthLatinCapitalZ=65338,t.codePointFullwidthLatinSmallA=65345,t.codePointFullwidthLatinSmallZ=65370,t.codePointEuroSign=8364,t.codePointLeftSingleQuotationMark=8216,t.codePointRightSingleQuotationMark=8217,t.codePointInvertedExclamationMark=161,t.codePointInvertedQuestionMark=191},1911:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initCalcThread=t.initCalcInThread=t.initCalc=t.getCalcAbsUrlOrThrow=t.getCalcAbsUrl=t.isCalcInit=t.maxRetriesForLoadingScript=t.initCalcCalled=void 0;var r=n(1),o=n(77),i=n(1312),a=n(461),c=n(1302),s=n(656),u=n(1071),l=n(1303),d=n(1912);t.initCalcCalled=new l.ResolvablePromise,t.maxRetriesForLoadingScript=9;var f=/^(https)|(http)|(file):\/\//,p=!1,h=void 0;function m(){if(null==h)throw new Error("initCalc was not passed calcAbsUrl");return h}function v(e,n,r,l){if(p){a.ulsLogger.ULS.traceTag(595910878,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"calc.config.initCalc: Calc is already initialized")}else{if(a.ulsLogger.setLogger(e),(0,c.initStopwatch)(e),(0,s.initFeatureConfiguration)(n),null!=r&&!f.test(r)){var m="calc.config.initCalc: calcAbsUrl is not absolute: ".concat(r);a.ulsLogger.ULS.traceTag(595910879,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,m)}i.setConfig(null!=l?l:{importScriptsMaxRetries:t.maxRetriesForLoadingScript,onWorkerError:function(e){var t={error:(0,u.messageFromError)(e),innerError:e.info.error?(0,u.messageFromError)(e.info.error):void 0},n="calc.onWorkerError: ".concat(JSON.stringify(t));a.ulsLogger.ULS.traceTag(593335298,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,n)},onCreateWorker:function(e){var t="calc.onCreateWorker: ".concat(JSON.stringify(e));a.ulsLogger.ULS.traceTag(593335299,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,t)}}),h=r,p=!0;var v=" (".concat("production",")"),g="calc.config.initCalc: Calc version ".concat(d.excelOnlineCalcPackageVersion).concat(v," initialized");a.ulsLogger.ULS.traceTag(594642132,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,g),t.initCalcCalled.resolve(void 0)}}t.isCalcInit=function(){return p},t.getCalcAbsUrl=function(){return h},t.getCalcAbsUrlOrThrow=m,t.initCalc=function(e,t,n){v(e,t,n,void 0)},t.initCalcInThread=function(e,t,n,o){return r.__awaiter(this,void 0,void 0,(function(){var a;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,i.Endpoint.createOutside(e)];case 1:return a=r.sent(),v((c=a.post,s=function(e){return"[".concat((new Date).toISOString(),"] ").concat(e)},{shipAssertTag:function(e,t,n,r){c.shipAssertTag(e,t,n,s(r))},assertTag:function(e,t,n,r){c.assertTag(e,t,n,s(r))},traceTag:function(e,t,n,r){c.traceTag(e,t,n,s(r))},debugTraceTag:function(e,t,n,r){c.debugTraceTag(e,t,n,s(r))},dnmTraceTag:function(e,t,n,r){c.dnmTraceTag(e,t,n,s(r))}}),(function(e){return!0===t[e]}),n,o),[2]}var c,s}))}))},t.initCalcThread=function(e){return r.__awaiter(this,void 0,void 0,(function(){var t,n,o,c,u;return r.__generator(this,(function(r){switch(r.label){case 0:t=m(),n=new MessageChannel,o={port:n.port1,options:{id:"WorkerThreadLogger"}},c={port:n.port2,options:{id:"WorkerThreadLogger"}},r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Promise.all([i.Endpoint.createInside(o,(function(){return a.ulsLogger.noThrowLogger})),e.call.initCalcThreadInside.transfer([c.port],c,(0,s.getFeatures)(),t)])];case 2:return[2,r.sent()[0]];case 3:throw u=r.sent(),o.port.close(),u;case 4:return[2]}}))}))}},1912:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.excelOnlineCalcPackageVersion=void 0,t.excelOnlineCalcPackageVersion="37.1.59"},1913:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mixin=void 0;var r=n(1),o=0;t.mixin=function(e,t,n){for(var i,a=(void 0===(i="___mixinField")&&(i=""),i+(o+=1).toString()),c={},s=function(e){c[e]=function(){for(var t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var i=this[a];return(t=i[e]).call.apply(t,r.__spreadArray([i],n,!1))}},u=0,l=n;u<l.length;u++){s(l[u])}return function(e){function o(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];for(var i=e.apply(this,r)||this,s=t(i),u=0,l=n;u<l.length;u++){var d=l[u];Object.defineProperty(i,d,{value:c[d],enumerable:!1,configurable:!1})}return i[a]=s,i}return r.__extends(o,e),o}(e)}},1914:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetCharCodeBits=t.forEachClassInterval=t.CharCodeBits=t.codePointIterator=t.numCodeUnits=t.stringCodePointAt=t.countCodePoints=t.scanCodePointsBack=t.scanCodePoints=t.stringFromCodePoint=t.surrogatePairToCodePoint=t.isAnySurrogate=t.isLowSurrogate=t.isHighSurrogate=void 0;var r,o=n(356);function i(e){return 55296==(64512&e)}function a(e){return 56320==(64512&e)}function c(e){return 55296==(63488&e)}function s(e,t){if(i(e)&&a(t))return 65536+((1023&e)<<10|1023&t)}function u(e,t){var n=e.charCodeAt(t);if(!c(n))return n;if(t+1>=e.length)return 65533;var r=s(n,e.charCodeAt(t+1));return null!=r?r:65533}function l(e){return e>=65536?2:1}function d(e,t){if(1==(1&e.length))throw new Error("Invalid class length");for(var n=0;n<e.length;n+=2)for(var r=e[n],o=e[n+1],i=r;i<o;i+=1)t(i,r,o)}t.isHighSurrogate=i,t.isLowSurrogate=a,t.isAnySurrogate=c,t.surrogatePairToCodePoint=s,t.stringFromCodePoint=function(e){if(e<=65535)return String.fromCharCode(e);var t=e-65536;return String.fromCharCode(t>>10|55296,1023&t|56320)},t.scanCodePoints=function(e,t,n){for(var r=t,o=0;o<n;o+=1){if(r>=e.length)return;i(e.charCodeAt(r))&&r+1<e.length&&a(e.charCodeAt(r+1))?r+=2:r+=1}return r},t.scanCodePointsBack=function(e,t,n){for(var r=t,o=0;o<n;o+=1){if(r-1<0)return;a(e.charCodeAt(r-1))&&r-2>=0&&i(e.charCodeAt(r-2))?r-=2:r-=1}return r},t.countCodePoints=function(e,t,n){for(var r=0,o=t;o<n;r+=1){i(e.charCodeAt(o))&&o+1<n&&a(e.charCodeAt(o+1))?o+=2:o+=1}return r},t.stringCodePointAt=u,t.numCodeUnits=l,t.codePointIterator=function(e,t){void 0===t&&(t=0);for(var n=[],r=t;r<e.length;){var o=u(e,r);n.push(o),r+=l(o)}return n},function(e){e[e.IdentStartClass=32]="IdentStartClass",e[e.IdentContinueClass=64]="IdentContinueClass"}(r=t.CharCodeBits||(t.CharCodeBits={})),t.forEachClassInterval=d,t.makeGetCharCodeBits=function(e,t){var n;function i(e){n[e]|=r.IdentStartClass}function a(e){n[e]|=r.IdentContinueClass}return function(r){if(void 0===n){var c=(0,o.fastMax)(e[e.length-1],t[t.length-1]);n=new Uint8Array(c),d(e,i),d(t,a)}var s=n[r];return void 0!==s?s:0}}},1915:function(e,t,n){"use strict";function r(){return function(e){return function(e){for(var t=function(e){this.obj=e},n=function(e){t.prototype[e]=function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=(t=this.obj)[e].apply(t,n);return Promise.resolve(o)}},r=0,o=e;r<o.length;r++){n(o[r])}return t}(e)}}Object.defineProperty(t,"__esModule",{value:!0}),t.wrapIntoAsync=t.wrapIntoAsyncClass=void 0,t.wrapIntoAsyncClass=r,t.wrapIntoAsync=function(e,t){return new(r()(t))(e)}},1916:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createArrayLogger=void 0;var r=n(1);t.createArrayLogger=function(e,t,n){void 0===e&&(e=!1),void 0===t&&(t=function(){return!0});var o=new Set,i=new Set;return{log:[],addTriggerListener:function(e){o.add(e)},waitForMessage:function(e,t){var n=this;return new Promise((function(r){var o=setTimeout((function(){console.warn("ArrayLogger.waitForMessage: timed out waiting for message; timeout = ".concat(t)),r(!1)}),t);n.addTriggerListener((function(t){var n=e(t);return n&&(clearTimeout(o),r(!0)),n}))}))},waitForReceivedButDelayedMessages:function(){var e=[];return i.forEach((function(t){return e.push(t)})),Promise.all(e).then((function(){}))},addLogMessage:function(a){var c=this;if(t(a)){var s=new Promise((function(t){var i;i=function(){c.log.push(a),e&&console.log.apply(console,r.__spreadArray([(new Date).toISOString()],a,!1)),o.forEach((function(e){e(a)&&o.delete(e)})),t()},void 0===n?i():setTimeout((function(){return i()}),n)})).then((function(){i.delete(s)}));i.add(s)}},shipAssertTag:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addLogMessage(["shipAssertTag",e]);var n=e[2],r=e[3];if(!n)throw new TypeError("shipAssertTag: ".concat(r))},assertTag:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addLogMessage(["assertTag",e]);var n=e[2],r=e[3];if(!n)throw new TypeError("assertTag: ".concat(r))},traceTag:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addLogMessage(["traceTag",e])},dnmTraceTag:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addLogMessage(["dnmTraceTag",e])},debugTraceTag:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addLogMessage(["debugTraceTag",e])}}}},1917:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.featureEnabledDummyCallback=t.AssertLogger=t.ConsoleLogger=void 0;var r=n(656),o=function(){function e(){}return e.prototype.shipAssertTag=function(e,t,n,r){if(console.assert(n,"shipAssertTag2 ".concat(e," ").concat(t," ").concat(r)),!n)throw new Error("shipAssertTag2 ".concat(e," ").concat(t," ").concat(r))},e.prototype.assertTag=function(e,t,n,r){if(console.assert(n,"assertTag2 ".concat(e," ").concat(t," ").concat(r)),!n)throw new Error("assertTag2 ".concat(e," ").concat(t," ").concat(r))},e.prototype.traceTag=function(e,t,n,r){console.log("traceTag2",e,r,t,n)},e.prototype.dnmTraceTag=function(e,t,n,r){console.log("dnmTraceTag2",e,r,t,n)},e.prototype.debugTraceTag=function(e,t,n,r){console.log("debugTraceTag2",e,r,t,n)},e}();t.ConsoleLogger=o;var i=function(){function e(){this.traceTag=function(){},this.debugTraceTag=function(){},this.dnmTraceTag=function(){}}return e.prototype.shipAssertTag=function(e,t,n,r){if(!n)throw new Error("shipAssertTag2 ".concat(e," ").concat(t," ").concat(r))},e.prototype.assertTag=function(e,t,n,r){if(!n)throw new Error("assertTag2 ".concat(e," ").concat(t," ").concat(r))},e}();t.AssertLogger=i,t.featureEnabledDummyCallback=function(e){switch(e){case r.FeatureName.FeatureCheckingEnabled:return!0;case r.FeatureName.CalcRecordFunctions:case r.FeatureName.CalcNestedRecordFunction:case r.FeatureName.CalcLetRecFunction:case r.FeatureName.CalcLambdaFunction:case r.FeatureName.CalcLambdaBasicFunctions:case r.FeatureName.CalcLambdaHelperFunctions:case r.FeatureName.CalcLambdaOptionalParameters:case r.FeatureName.CalcLambdaDefaultParameters:case r.FeatureName.CalcLambdaCellValues:case r.FeatureName.CalcLambdaArrayLifting:return!0;default:return e.startsWith("OfficeVSO:")}}},1918:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pledge=void 0;var r=n(1304),o=n(1073),i=function(){function e(t,n,o){this.transition=t,this.onFulfilled=n,this.onRejected=o,this.runStatus=!(t instanceof e||t.kind===r.TransitionKind.CallMachine)&&t}return e.prototype.setState=function(e,t,n){return this.onFulfilled=t,this.onRejected=n,this.transition=e,e},e.prototype.next=function(){return this.transition instanceof e?this.transition=(0,r.callMachineTransition)(this.transition,this):this.transition},e.prototype.receiveResult=function(t){var n;try{if((0,o.isSuccess)(t)){if(!this.onFulfilled)return this.setState(t,void 0,void 0);n=this.onFulfilled(t.value)}else{if(!this.onRejected)return this.setState(t,void 0,void 0);n=this.onRejected(t.reason)}}catch(e){return this.setState((0,o.failure)((0,o.javaScriptError)(e)),void 0,void 0)}return n instanceof e?(this.setState(n.transition,n.onFulfilled,n.onRejected),n.setState(this,void 0,void 0),this.next()):this.setState((0,o.success)(n),void 0,void 0)},e.prototype.bind=function(t){return new e(this,t,void 0)},e.prototype.catch=function(t){return new e(this,void 0,t)},e.prototype.finally=function(t){return new e(this,(function(e){return t(),e}),(function(n){return t(),e.reject(n)}))},e.all=function(t){return e.fromMachine(new r.AllMachine(t.map(e.resolve)))},e.prototype.settle=function(){return new r.MachineRuntime(this).runToResult()},e.settleOrThrow=function(e){var t=e.settle();if((0,o.isSuccess)(t))return t.value;throw t.reason.error},e.resolve=function(t){return t instanceof e?t:new e((0,o.success)(t),void 0,void 0)},e.reject=function(t){return new e((0,o.failure)(t),void 0,void 0)},e.undefinedPledge=e.resolve(void 0),e.fromMachine=function(t){if(t instanceof e)return t;var n=new e(e.undefinedPledge,void 0,void 0);return n.transition=(0,r.callMachineTransition)(t,n),n},e.try=function(t){return e.undefinedPledge.bind(t)},e.RepeatMachine=function(){function t(e,t){this.onLoop=e,this.accum=t,this.runStatus=!1}return t.prototype.next=function(){var t=this.onLoop(this.accum);return t instanceof e?(0,r.callMachineTransition)(t,this):this.receiveSuccess(t)},t.prototype.receiveResult=function(e){return(0,o.isSuccess)(e)?this.receiveSuccess(e.value):e},t.prototype.receiveSuccess=function(e){return void 0===e?(0,o.success)(this.accum):(this.accum=e,r.nextTransition)},t}(),e.repeat=function(t,n){return e.resolve(n).bind((function(n){return e.fromMachine(new e.RepeatMachine(t,n))}))},e}();t.Pledge=i},1919:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.throwAfterSteps=t.pauseAfterSteps=void 0,t.pauseAfterSteps=function(e){var t=Math.max(1,Math.floor(e)),n=0;return function(){return(n+=1)>=t}},t.throwAfterSteps=function(e){var t=Math.max(1,Math.floor(e)),n=0;return function(){if((n+=1)<t)return!1;throw t}}},1920:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RevocableSingleton=void 0;var r=function(){function e(e,t){var n=this;this.target=e,this.isRevoked=!1;var r=function(e){if(n.isRevoked)throw new TypeError("".concat(String(e),": ").concat(t))};this.proxy="undefined"==typeof Proxy?e:new Proxy(e,{get:function(e,t,n){return r(t),Reflect.get(e,t,n)},set:function(e,t,n,o){return r(t),Reflect.set(e,t,n,o)}})}return e.prototype.revoke=function(){this.isRevoked=!0},e}(),o=function(){function e(e){this.message=e}return e.prototype.getInstance=function(){var e;return null===(e=this.instance)||void 0===e?void 0:e.proxy},e.prototype.setInstance=function(e){var t;return null===(t=this.instance)||void 0===t||t.revoke(),void 0===e?this.instance=void 0:(this.instance=new r(e,this.message),this.instance.proxy)},e.prototype.revokeInstance=function(){if(this.instance)return this.instance.revoke(),this.instance=new r(this.instance.target,this.message),this.instance.proxy},e}();t.RevocableSingleton=o},214:function(e,t,n){"use strict";var r=n(1292);n.o(r,"CompletionItemKind")&&n.d(t,"CompletionItemKind",(function(){return r.CompletionItemKind})),n.o(r,"SuggestionKind")&&n.d(t,"SuggestionKind",(function(){return r.SuggestionKind}));var o=n(302);n.d(t,"FormulaAssistanceUIFactoryGlobal",(function(){return o.d}));n(1305),n(1306),n(1314),n(278)},278:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0),o=r.createContext({isFeedbackAllowed:!1,zoomLevel:1})},302:function(e,t,n){"use strict";var r,o,i,a=n(1),c=n(175),s=(c.core.makeNewtypeIso,c.core.staticAssertExtends,c.core.staticAssertSame,c.core.staticAssertIs,c.core.staticAssertIsOptional,c.core.identity,c.core.makeStringMap,c.core.cloneStringMap,c.core.numEnumArray,c.core.numEnumMap,c.core.strEnumArray,c.core.safePush,c.core.safeConcat,c.core.isDefined),u=c.core.isNone,l=(c.core.filterOutNones,c.core.pair,c.core.fastMin,c.core.fastMax,c.core.fastAbs,c.core.makeStringCompareCI,c.core.typedInstanceCreator,c.core.singleton,c.core.mapFromArrayOfPairs,c.core.now,n(66)),d=n(70),f=n(239),p=n(531),h=n(532),m=n(281),v=n(120),g=n(65),y=n(40),b=n(0),S=n(278),C=n(183),_=n(320),P=n(445),x=n(1370),k=n(688),O=n(249),E=n(2279),w=n(110),T=n(341),j={subText:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",fontFamily:'Consolas, "Courier New", monospace'}},M=b.memo((function(e){var t=e.isLoaded,n=e.value,r=Object(a.__rest)(e,["isLoaded","value"]),o=t?n||void 0:b.createElement(E.a,{type:"AppSpinnerProps",id:"ValuePreviewSpinner",appColors:Object(w.a)(),spinnerSize:T.a.small});return b.createElement(O.a,null,(function(e){return b.createElement(k.a,Object(a.__assign)({},r,{calloutProps:{styles:Object(x.a)(e),beakWidth:10},content:o,styles:j,directionalHint:g.a.topCenter}))}))})),A=function(){function e(e){this.context={isFeedbackAllowed:!1,zoomLevel:1},this.componentApis={},this.componentRefs={},this.lastGetTargetAndBounds=null,this.stubNewProps={setComponentApi:function(){},onLayoutChange:function(){},getTargetAndBounds:function(){}},this.stubOldProps={target:new m.a},this.lastProps=new Map,this.position={x:0,y:0,renderDown:!0},this.useFixedPosition=!1,e&&(this.context=Object(a.__assign)(Object(a.__assign)({},this.context),e)),this.argumentAssistanceCardRef=b.createRef(),this.autoCompleteMenuRef=b.createRef()}return e.prototype.onLayoutChange=function(e){var t=e.x,n=e.y,r=e.renderDown;this.position.x=t,this.position.y=n,this.position.renderDown=r},e.prototype.getTargetAndBounds=function(e){if(void 0===e&&(e=!1),this.useFixedPosition&&!e){var t=this.position,n=t.x,r=t.y,o=t.renderDown;return{target:{top:r,left:n,right:n,bottom:r},bounds:{top:0,left:0,right:innerWidth,bottom:innerHeight},isFloating:!0,renderDown:o}}u(this.lastGetTargetAndBounds)&&l.a.sendTraceTag(512313119,d.a.msoulscat_ES_EWAJS,f.a.Error,"FormulaAssistanceUIControl.getTargetAndBounds: "+"this.lastGetTargetAndBounds is ".concat(this.lastGetTargetAndBounds,"."));var i=this.lastGetTargetAndBounds();if(u(i)||u(i.target)||u(i.bounds)){var a=JSON.stringify(i);l.a.sendTraceTag(512313118,d.a.msoulscat_ES_EWAJS,f.a.Error,"FormulaAssistanceUIControl.getTargetAndBounds: "+"this.lastGetTargetAndBounds() returned: ".concat(a,"."))}return{target:i.target,bounds:i.bounds,isFloating:!1,renderDown:this.position.renderDown}},e.prototype.renderControl=function(e,t,n,r){var i=this;if(t&&n){this.lastGetTargetAndBounds=r,this.componentRefs[e]||(this.componentRefs[e]=b.createRef());var c,u=Object(a.__assign)({type:e,rendered:!0,ref:this.componentRefs[e],getTargetAndBounds:this.getTargetAndBounds.bind(this),onLayoutChange:this.onLayoutChange.bind(this),setComponentApi:function(t){i.componentApis[e]=t}},this.stubOldProps);switch(e){case o.ArgumentAssistanceCard:c=b.createElement(p.a,Object(a.__assign)({},u,n));break;case o.AutoCompleteMenu:c=b.createElement(h.a,Object(a.__assign)({},u,n,{disableItemReadout:!0}))}l.a.shipAssertTag(520926812,d.a.msoulscat_ES_EWAJS,s(c),"FormulaAssistanceUIControl.renderControl: "+"control is ".concat(c," because the type '").concat(e,"' is unknown.")),y.render(b.createElement(S.a.Provider,{value:this.context},c),t),this.lastProps.set(t,Object(a.__assign)(Object(a.__assign)({},u),n))}},e.prototype.renderArgumentAssistanceCard_deprecated=function(e,t,n){var r;if(e&&t&&n){var i=null!==(r=this.target)&&void 0!==r?r:t;y.render(b.createElement(S.a.Provider,{value:this.context},b.createElement(p.a,Object(a.__assign)({target:i},n,this.stubNewProps,{ref:this.argumentAssistanceCardRef,hidden:!1}))),e),this.lastProps.set(e,Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({type:o.ArgumentAssistanceCard,target:i},n),this.stubNewProps),{rendered:!0}))}},e.prototype.renderAutoCompleteMenu_deprecated=function(e,t,n){var r;if(e&&t&&n){var i=null!==(r=this.target)&&void 0!==r?r:t;y.render(b.createElement(S.a.Provider,{value:this.context},b.createElement(h.a,Object(a.__assign)({target:i},n,this.stubNewProps,{ref:this.autoCompleteMenuRef,disableItemReadout:!0}))),e),this.lastProps.set(e,Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({type:o.AutoCompleteMenu,target:i},n),this.stubNewProps),{rendered:!0}))}},e.prototype.renderArgumentAssistanceCard=function(e,t,n,r){Object(C.a)()?this.renderControl(o.ArgumentAssistanceCard,e,n,r):this.renderArgumentAssistanceCard_deprecated(e,t,n)},e.prototype.renderAutoCompleteMenu=function(e,t,n,r){Object(C.a)()?this.renderControl(o.AutoCompleteMenu,e,n,r):this.renderAutoCompleteMenu_deprecated(e,t,n)},e.prototype.renderValuePreview=function(e,t,n){e&&t&&n&&y.render(b.createElement(M,Object(a.__assign)({},n,{targetElement:t})),e)},e.prototype.dismiss=function(e){if(e)if(this.lastProps.has(e)){var t=this.lastProps.get(e);if(t&&t.rendered)if(t.rendered=!1,Object(C.a)()){var n=null;switch(t.type){case o.AutoCompleteMenu:n=b.createElement(h.a,Object(a.__assign)({},t,{hidden:!0}));break;case o.ArgumentAssistanceCard:n=b.createElement(p.a,Object(a.__assign)({},t,{hidden:!0}))}n&&y.render(b.createElement(S.a.Provider,{value:this.context},n),e)}else switch(t.type){case o.ArgumentAssistanceCard:return void y.render(b.createElement(S.a.Provider,{value:this.context},b.createElement(p.a,Object(a.__assign)({},t,{hidden:!0}))),e);case o.AutoCompleteMenu:return void y.render(b.createElement(S.a.Provider,{value:this.context},b.createElement(h.a,Object(a.__assign)({},t,{hidden:!0}))),e)}}else y.unmountComponentAtNode(e)},e.prototype.focus=function(e){var t=this.getRootElement(e);return!!t&&(Object(v.c)(t),!0)},e.prototype.getRootElement=function(e){var t;if(Object(C.a)())return(null===(t=this.componentRefs[e])||void 0===t?void 0:t.current)||null;switch(e){case o.ArgumentAssistanceCard:return this.argumentAssistanceCardRef.current;case o.AutoCompleteMenu:return this.autoCompleteMenuRef.current;default:return null}},e.prototype.getCalloutElement=function(e){var t;switch(e){case o.ArgumentAssistanceCard:return Object(C.a)()?document.getElementById(_.a.callout):null===(t=document.getElementById(_.a.callout))||void 0===t?void 0:t.parentElement;default:return null}},e.prototype.getDraggableElement=function(e){switch(e){case o.ArgumentAssistanceCard:return document.getElementById(_.a.collapsedPart);default:return null}},e.prototype.setZoomLevel=function(e){this.context.zoomLevel=e},e.prototype.updatePosition=function(e){var t;null===(t=this.componentApis[e])||void 0===t||t.updatePosition()},e.prototype.updateContext=function(e){this.context=Object(a.__assign)(Object(a.__assign)({},this.context),e)},e.prototype.setOverrideTarget=function(e){this.target=e?new m.a(e.left,e.left,e.top,e.top):void 0},e.prototype.getDirectionalHint=function(e){if(e)switch(Object(P.a)(new m.a(e.left,e.left,e.top,e.top))[0]){case g.a.topLeftEdge:return i.Top;case g.a.bottomLeftEdge:return i.Bottom}return i.None},e.prototype.getWindowEdgeBuffer=function(){return P.c},e.prototype.getPosition=function(){return this.position},e.prototype.setFixedPosition=function(e){this.useFixedPosition=s(e),e&&(this.position.x=e.x,this.position.y=e.y,this.position.renderDown=e.renderDown)},e}(),I=n(471),F=function(){function e(){}return e.prototype.create=function(e){return I.a.registerUiSlice20Icons(),new A(e)},e}();n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return R})),function(e){e[e.Expanded=0]="Expanded",e[e.Collapsed=1]="Collapsed",e[e.Hidden=2]="Hidden"}(r||(r={})),function(e){e[e.ArgumentAssistanceCard=0]="ArgumentAssistanceCard",e[e.AutoCompleteMenu=1]="AutoCompleteMenu",e[e.ValuePreview=2]="ValuePreview"}(o||(o={})),function(e){e[e.None=0]="None",e[e.Top=1]="Top",e[e.Bottom=2]="Bottom"}(i||(i={}));var R=new F},320:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={callout:"aa-callout",collapsedPart:"aa-header"}},356:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.mapFromArrayOfPairs=t.singleton=t.now=t.typedInstanceCreator=t.makeStringCompareCI=t.fastAbs=t.fastMax=t.fastMin=t.pair=t.filterOutNones=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.strEnumArray=t.numEnumMap=t.numEnumArray=t.cloneStringMap=t.makeStringMap=t.identity=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.makeNewtypeIso=void 0;var r=n(656);function o(){return function(e){return e}}function i(){var e=Object.create(null);return e.___=void 0,delete e.___,e}function a(e){return Object.keys(e).map((function(e){return Number(e)})).filter((function(e){return!isNaN(e)}))}function c(e,t){for(var n=0,r=t;n<r.length;n++){var o=r[n];e.push(o)}return e}function s(e){return null!=e}t.makeNewtypeIso=function(e,t){return{wrap:e,unwrap:t}},t.staticAssertExtends=function(){},t.staticAssertSame=function(){},t.staticAssertIs=o,t.staticAssertIsOptional=function(e){return e},t.identity=function(e){return e},t.makeStringMap=i,t.cloneStringMap=function(e){var t=i();for(var n in e)t[n]=e[n];return t},t.numEnumArray=a,t.numEnumMap=function(e,t){for(var n={},r=0,o=a(e);r<o.length;r++){var i=o[r];n[i]=t(i)}return n},t.strEnumArray=function(e){return Object.keys(e).map((function(e){return e})).map((function(t){return e[t]})).sort()},t.safePush=c,t.safeConcat=function(e,t){var n=[];c(n,e);for(var r=0,o=t;r<o.length;r++){c(n,o[r])}return n},t.isDefined=s,t.isNone=function(e){return null==e},t.filterOutNones=function(e){return e.filter(s)};t.pair=function(e,t){return[e,t]},t.fastMin=function(e,t){return e<t?e:t},t.fastMax=function(e,t){return e<t?t:e},t.fastAbs=function(e){return e<0?-e:e},t.makeStringCompareCI=function(e){try{var t=new Intl.Collator(function(e){var t=[e],n=e.indexOf("-");return n>0&&t.push(e.substring(0,n)),"en"!==t[t.length-1]&&t.push("en"),t}(e),{sensitivity:"accent"});return t.compare.bind(t)}catch(e){return function(e,t){return e===t?0:e.toLocaleUpperCase().localeCompare(t.toLocaleUpperCase())}}},t.typedInstanceCreator=function(){return function(e){return e}};var u="undefined"!=typeof self&&null!=self.performance&&null!=self.performance.now?function(){return self.performance.now()}:void 0!==e&&null!=e.hrtime?function(){var t=e.hrtime();return 1e3*t[0]+t[1]/1e6}:function(){return Date.now()},l="undefined"!=typeof self&&null!=self.performance&&null!=self.performance.now?function(){return self.performance.now()}:function(){return Date.now()};t.now=(0,r.isTypedChangeGateEnabled)("Microsoft.Office.Excel.ChangeGate.PreciseNowForNodeJS")?u:l,t.singleton=function(e){return function(){function t(){}return t.instance=function(){return void 0===t.value&&(t.value=e()),t.value},t.prototype.instance=function(){return t.instance()},t.value=void 0,t}()},t.mapFromArrayOfPairs=function(e){return e.reduce((function(e,t){var n=t[0],r=t[1];return e[n]=r,e}),{})}}).call(this,n(986))},444:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r=n(133);function o(e,t,n){return e<t?t:e>n?n:e}function i(e){var t=e.x,n=e.y,r=e.maxWidth,o=e.maxHeight,i=e.renderDown,a=i?"0px":"auto",c=i?"auto":"-100vh",s=i?"".concat(Math.round(n),"px"):"calc(".concat(Math.round(n),"px - 100vh)");return{transform:"translate(".concat(Math.round(t),"px, ").concat(s,")"),"--top":a,"--bottom":c,"--max-width":"".concat(r,"px"),"--max-height":"".concat(o,"px")}}function a(e,t,n,i,a,c,s){var u={top:8,left:8,right:window.innerWidth-8,bottom:window.innerHeight-8},l={top:o(s.top,u.top,u.bottom),left:o(s.left,u.left,u.right),right:o(s.right,u.left,u.right),bottom:o(s.bottom,u.top,u.bottom)},d={top:o(e.top,l.top,l.bottom),left:o(e.left,l.left,l.right),right:o(e.right,l.left,l.right),bottom:o(e.bottom,l.top,l.bottom)},f=l.right-l.left,p=function(e,t,n,r,o,i){if(r){var a=i.bottom-t,c=e-i.top,s=(o?a:c)>=n,u=s?o:!o,l=i.bottom-i.top;return!s&&n>a&&n>c&&(u=a>=c),{availableVerticalSpace:l,shouldRenderDown:u}}var d=e-i.top,f=i.bottom-t,p=n<=d,h=n<=f,m=0,v=o;o&&h?m=f:!o&&p?m=d:(v=f>=d,m=Math.max(f,d));return{availableVerticalSpace:m,shouldRenderDown:v}}(d.top,d.bottom,n,a,c,l),h=p.availableVerticalSpace,m=p.shouldRenderDown,v=Math.min(r.c.maxHeight,h),g=Math.min(r.c.maxWidth,f),y=o(d.left,l.left,l.right-Math.min(i,g)),b=0;if(a&&c!==m){var S=d.top;b=m?S-t:S+t}else b=m?d.bottom:d.top;var C=b;return a&&(C=o(b,m?l.top:Math.min(l.bottom,l.top+t),m?Math.max(l.top,l.bottom-t):l.bottom)),{x:y,y:C,maxWidth:g,maxHeight:v,renderDown:m}}},445:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return l}));var r=n(0),o=n(281),i=n(65),a=n(278),c=function(e){var t,n=r.useContext(a.a).zoomLevel;if(e instanceof HTMLElement){var i=e.getBoundingClientRect();t=new o.a(i.x*n,i.right*n,i.y*n,i.bottom*n)}else t=e;var c=s(t),d=c[0],f=c[1],p=c[2];return{targetRect:t,maxDimensions:{maxHeight:Math.min(u.maxHeight,(p?f.top:f.bottom)-l),maxWidth:Math.min(u.maxWidth,window.innerWidth-2*l)},directionalHint:d}},s=function(e){var t={left:e.left,right:window.innerWidth-e.right,top:e.top,bottom:window.innerHeight-e.bottom},n=t.top>t.bottom&&t.bottom<u.minHeight+l;return[n?i.a.topLeftEdge:i.a.bottomLeftEdge,t,n]},u={minHeight:300,maxHeight:415,maxWidth:500},l=8},461:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertPositiveLength=t.assertIndex=t.assertPositiveInteger=t.assertNatural=t.assertInteger=t.assertTrue=t.assertFalse=t.assertNever=t.ulsLogger=void 0;var r=n(77),o=n(1071),i=n(1070);function a(e,t){return function(n,r,o,i){if(e(n,r,o,i),!o)throw new Error("".concat(t," ").concat(n," ").concat(r," ").concat(i))}}function c(e){return{shipAssertTag:a(e.shipAssertTag.bind(e),"shipAssertTag"),assertTag:a(e.assertTag.bind(e),"assertTag"),traceTag:e.traceTag.bind(e),debugTraceTag:e.debugTraceTag.bind(e),dnmTraceTag:e.dnmTraceTag.bind(e)}}function s(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return e.apply(void 0,t)}catch(e){}}}var u=function(){function e(){this.callBufferCapacity=100,this.callBuffer=[],this.shipAssertTag=this.createBufferingCallback("shipAssertTag"),this.assertTag=this.createBufferingCallback("assertTag"),this.traceTag=this.createBufferingCallback("traceTag"),this.dnmTraceTag=this.createBufferingCallback("dnmTraceTag"),this.debugTraceTag=this.createBufferingCallback("debugTraceTag")}return e.prototype.createBufferingCallback=function(e){var t=this;return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];t.callBuffer.length<t.callBufferCapacity&&t.callBuffer.push({method:e,args:n})}},e.prototype.invokeBufferedCalls=function(){var e;if(0!==this.callBuffer.length){var n=this.callBuffer;this.callBuffer=[];var o="calc.common.DefaultLogger.invokeBufferedCalls: ".concat(n.length," calls before initLogger");t.ulsLogger.ULS.traceTag(579736781,r.LogCategory.msoulscat_ES_EWAJS,r.TraceLevel.Warning,o);for(var i=0,a=n;i<a.length;i++){var c=a[i];(e=t.ulsLogger.noThrowLogger)[c.method].apply(e,c.args)}}},e}(),l=function(){function e(){this.logger=new u,this.ULS=c(this.logger),this.noThrowLogger=this.logger}return e.prototype.setLogger=function(e){var t=this.logger;this.logger=e,this.ULS=c(e),this.noThrowLogger=function(e){return{shipAssertTag:s(e.shipAssertTag.bind(e)),assertTag:s(e.assertTag.bind(e)),traceTag:s(e.traceTag.bind(e)),debugTraceTag:s(e.debugTraceTag.bind(e)),dnmTraceTag:s(e.dnmTraceTag.bind(e))}}(e),t instanceof u&&t.invokeBufferedCalls()},e}();function d(e){return t.ulsLogger.ULS.assertTag(595980873,r.LogCategory.msoulscat_ES_EWAJS,!1,e)}t.ulsLogger=new l,t.assertNever=function(e,n){var o=(0,i.anonymize)(n),a="".concat(e,": code should be unreachable because a value has type 'never'; given ").concat(o);return t.ulsLogger.ULS.assertTag(595980872,r.LogCategory.msoulscat_ES_EWAJS,!1,a)},t.assertFalse=d,t.assertTrue=function(e,t){t||d("".concat(e,": expected condition to be true"))},t.assertInteger=function(e,t){(0,o.isInteger)(t)||d("".concat(e,": expected integer; given ").concat((0,i.anonymize)(t)))},t.assertNatural=function(e,t){(!(0,o.isInteger)(t)||t<0)&&d("".concat(e,": expected natural number; given ").concat((0,i.anonymize)(t)))},t.assertPositiveInteger=function(e,t){(!(0,o.isInteger)(t)||t<=0)&&d("".concat(e,": expected positive integer; given ").concat((0,i.anonymize)(t)))},t.assertIndex=function(e,t,n){(!(0,o.isInteger)(t)||t<0||t>=n)&&d("".concat(e,": expected natural number less than ").concat((0,i.anonymize)(n),"; given ").concat((0,i.anonymize)(t)))},t.assertPositiveLength=function(e,t,n){(!(0,o.isInteger)(t)||t<=0||t>n)&&d("".concat(e,": expected positive integer at most ").concat((0,i.anonymize)(n),"; given ").concat((0,i.anonymize)(t)))}},531:function(e,t,n){"use strict";var r,o,i,a=n(0),c=n(541),s=n(320),u=n(1),l=n(43),d=n(907),f=n(1277),p=n(27),h=n.n(p),m=n(13),v=n(4),g=n(119),y=n(12),b=n(133),S=5,C=7,_=20,P=20,x=80,k=340,O=Object(m.c)((function(e){return Object(v.cb)({cardPart:{padding:"".concat(S,"px ").concat(C,"px")},focusTrapCallout:{height:"100%"},root:{display:"flex",width:"min-content",maxHeight:"100%",cursor:"default",flexDirection:"column"},collapsedCard:{width:"max-content",maxWidth:"".concat(b.c.maxWidth,"px"),minWidth:"".concat(k,"px"),direction:"ltr",flexShrink:0,selectors:{":after":j(e)}},expandedCard:Object(u.__assign)(Object(u.__assign)({overflowY:"auto",transition:"max-height ".concat(b.g)},b.f),{":before":j(!e)})})})),E=Object(m.c)((function(){return Object(v.cb)(I(),b.d,M())})),w=Object(m.c)((function(){return Object(v.cb)(I(),{root:{width:P}})})),T=Object(v.cb)(b.a,{calloutMain:{overflow:"hidden"}}),j=function(e){return{content:'""',position:"relative",display:e?"block":"none",margin:"0px ".concat(C,"px 0px ").concat(C,"px"),height:1,backgroundColor:g.a.gray40}},M=Object(m.c)((function(){return{root:{padding:0,width:x},label:{margin:"0px 0px"}}})),A=Object(m.c)((function(){var e;return{root:{height:_,top:2,borderRadius:2,selectors:(e={},e[":hover, :focus"]=Object(u.__assign)({},y.o),e)},icon:{height:16,width:16}}})),I=Object(m.c)((function(){return Object(v.cb)(A(),{icon:{transition:"transform .2s",transform:"var(".concat("--collapse-icon-transform",")")},flexContainer:{marginLeft:1}})})),F=n(2239),R=n(941),L=n(444),D=n(111),N=a.forwardRef((function(e,t){var n=e.hidden,r=e.setComponentApi,o=e.onLayoutChange,i=e.getTargetAndBounds,p=e.renderCompactCard,m=e.renderExpandedCard,v=e.onIsExpandedChange,g=e.isExpanded,y=e.collapsedId,S=e.showCollapseText,C=Object(u.__rest)(e,["hidden","setComponentApi","onLayoutChange","getTargetAndBounds","renderCompactCard","renderExpandedCard","onIsExpandedChange","isExpanded","collapsedId","showCollapseText"]),_=Object(R.a)(s.a.callout),P=a.useState(g),x=P[0],j=P[1],M=a.useState(S),A=M[0],I=M[1],N=a.useRef(null),U=a.useRef(null),B=a.useRef(null),z=a.useRef(null),G=a.useRef(x),W=a.useRef(-1),H=a.useRef(-1),K=Object(D.getBooleanFeatureGate)("Microsoft.Office.Excel.FormulaAuthoringButtonExperiment",!1)&&A,V=a.useCallback((function(e){if(void 0===e&&(e=!1),!n&&_){var t=N.current,r=B.current,a=t.scrollHeight+r.scrollHeight,c=t.scrollWidth,s=i(),u=s.target,l=s.bounds,d=s.isFloating,f=s.renderDown,p=x?a:t.clientHeight,h=d?a:Math.max(a,b.c.minHeight),m=!1;if(d)(W.current!==u.top||H.current!==u.left)&&((m=!f&&!e)&&(u.top-=p,u.bottom=u.top),W.current=u.top,H.current=u.left);var v=Object(L.a)(u,p,h,c,d,f||m,l);o(v);var g=x!==G.current,y=v.renderDown===f&&v.y!==u.top,S=g&&y;G.current=x;var C=Object(L.b)(v);if(S){_.style.transition="transform ".concat(b.g);var P=function(){_.style.transition="",_.ontransitionend=null,_.ontransitioncancel=null};_.ontransitionend=P,_.ontransitioncancel=P}for(var O=0,E=Object.entries(C);O<E.length;O++){var w=E[O],T=w[0],j=w[1];_.style.setProperty(T,j)}var M=v.maxWidth<k;_.style.minWidth="".concat(M?v.maxWidth:k,"px");var A=x&&v.maxHeight<a;r.style.overflow=A?"hidden auto":"hidden";var I=x===v.renderDown;t.style.setProperty("--collapse-icon-transform",I?"scaleY(-1)":"")}}),[i,n,x,o,_]);a.useEffect((function(){if(_){var e=B.current,t=x?e.scrollHeight:0;e.style.maxHeight="".concat(t,"px")}})),a.useEffect((function(){_&&V(!0)})),a.useEffect((function(){r({updatePosition:V})}),[r,V]);var J=O(x),q=function(e){var t=!x;j(t),I(!1),null==v||v(t)},Q=x?ExcelRibbonStrings.FormulaArgumentAssistanceCollapse:ExcelRibbonStrings.FormulaArgumentAssistanceExpand;return a.createElement(f.a,Object(u.__assign)({onKeyDownCapture:function(e){var t,n,r=null!==(t=e.keyCode)&&void 0!==t?t:e.which;!x||r!==l.a.up&&r!==l.a.down||null===(n=B.current)||void 0===n||n.scrollBy({top:r===l.a.up?-100:100,left:0,behavior:"smooth"})},isBeakVisible:!1,styles:T,hidden:n,focusTrapProps:{className:J.focusTrapCallout,forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,disableFirstFocus:!0}},C),a.createElement("div",{ref:t,className:J.root},a.createElement("div",{id:y,className:J.collapsedCard,ref:N},a.createElement(c.a,{className:J.cardPart,horizontal:!0,horizontalAlign:"space-between",reversed:!0},K?a.createElement(d.a,{id:"toggleCardStateButtonId",iconProps:{iconName:h.a.CommonControlChevronDown_16},ariaLabel:Q,onClick:q,styles:E(),text:ExcelRibbonStrings.FormulaArgumentAssistanceShowLess}):a.createElement(F.a,{id:"toggleCardStateButtonId",iconProps:{iconName:h.a.CommonControlChevronDown_16},ariaLabel:Q,customTooltip:Q,onClick:q,styles:w()}),a.createElement("div",{ref:U},p()))),a.createElement("div",{className:J.expandedCard,ref:B,onPointerDown:function(e){e.preventDefault()}},a.createElement("div",{className:J.cardPart,ref:z},m(x)))))})),U=n(65),B=5,z=7,G=20,W=20,H=80,K=340,V=Object(m.c)((function(e,t){return Object(v.cb)({cardPart:{padding:"".concat(B,"px ").concat(z,"px")},root:{display:"flex",cursor:"default",flexDirection:"column"},collapsedCard:{direction:"ltr",flexShrink:0,selectors:{":after":Z(e)}},expandedCard:Object(u.__assign)(Object(u.__assign)({overflowY:t?"auto":"hidden",transition:"height 0.467s cubic-bezier(0.5, 0, 0, 1)"},b.f),{":before":Z(!e)})})})),J=Object(m.c)((function(e){return Object(v.cb)($(e),b.d,Y())})),q=Object(m.c)((function(e){return Object(v.cb)($(e),{root:{width:W}})})),Q=Object(v.cb)(b.a,{calloutMain:{overflow:"hidden"}}),Z=function(e){return{content:'""',position:"relative",display:e?"block":"none",margin:"0px ".concat(z,"px 0px ").concat(z,"px"),height:1,backgroundColor:g.a.gray40}},Y=Object(m.c)((function(){return{root:{padding:0,width:H},label:{margin:"0px 0px"}}})),X=Object(m.c)((function(){var e;return{root:{height:G,top:2,borderRadius:2,selectors:(e={},e[":hover, :focus"]=Object(u.__assign)({},y.o),e)},icon:{height:16,width:16}}})),$=Object(m.c)((function(e){return Object(v.cb)(X(),{icon:{transform:e?"scaleY(-1)":""},flexContainer:{marginLeft:1}})})),ee=n(302),te=n(66),ne=n(70),re=n(239),oe=n(445),ie=a.forwardRef((function(e,t){var n=e.target,r=e.renderCompactCard,o=e.renderExpandedCard,i=e.onCardModeChange,s=e.cardMode,p=e.showCollapseText,m=e.collapsedId,v=Object(u.__rest)(e,["target","renderCompactCard","renderExpandedCard","onCardModeChange","cardMode","showCollapseText","collapsedId"]),g=a.useState(s),y=g[0],b=g[1],S=a.useState(p),C=S[0],_=S[1],P=a.useState(!1),x=P[0],k=P[1],O=a.createRef(),E=a.createRef(),w=a.createRef(),T=a.createRef(),j=Object(oe.b)(n),M=j.targetRect,A=j.maxDimensions,I=j.directionalHint,R=Object(D.getBooleanFeatureGate)("Microsoft.Office.Excel.FormulaAuthoringButtonExperiment",!1)&&C;a.useEffect((function(){requestAnimationFrame((function(){if(O.current&&E.current&&w.current&&T.current){var e=y===ee.b.Expanded,t=R?H:W,n=A.maxWidth>K?Math.max(E.current.scrollWidth+t+2*z,K):A.maxWidth;w.current.style.width=n+"px";var r=e?Math.min(T.current.scrollHeight,A.maxHeight-O.current.scrollHeight):0;w.current.style.height=r+"px",k(!!e&&T.current.scrollHeight>r)}else te.a.sendTraceTag(520714056,ne.a.msoulscat_ES_EWAJS,re.a.Warning,"ExpandingCard: Unexpected refs, collapsed:".concat(!!O.current," collapsedContent:").concat(!!E.current," expanded:").concat(!!w.current," expandedContent:").concat(!!T.current))}))}));var L=V(y===ee.b.Expanded,x),N=function(e){var t=y===ee.b.Expanded?ee.b.Collapsed:ee.b.Expanded;null==i||i(t),b(t),_(!1)},B=function(){return y===ee.b.Expanded?ExcelRibbonStrings.FormulaArgumentAssistanceCollapse:ExcelRibbonStrings.FormulaArgumentAssistanceExpand},G=y===ee.b.Expanded&&I===U.a.bottomLeftEdge||y===ee.b.Collapsed&&I===U.a.topLeftEdge;return a.createElement(f.a,Object(u.__assign)({onKeyDownCapture:function(e){var t,n,r=null!==(t=e.keyCode)&&void 0!==t?t:e.which;y!==ee.b.Expanded||r!==l.a.up&&r!==l.a.down||null===(n=w.current)||void 0===n||n.scrollBy({top:r===l.a.up?-100:100,left:0,behavior:"smooth"})},target:M,isBeakVisible:!1,directionalHint:I,directionalHintForRTL:I,styles:Q,minPagePadding:oe.c,focusTrapProps:{forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,disableFirstFocus:!0}},v),a.createElement("div",{ref:t,className:L.root,style:A},a.createElement("div",{id:m,className:L.collapsedCard,ref:O},a.createElement(c.a,{className:L.cardPart,horizontal:!0,horizontalAlign:"space-between",reversed:!0},y===ee.b.Expanded&&R?a.createElement(d.a,{id:"toggleCardStateButtonId",iconProps:{iconName:h.a.CommonControlChevronDown_16},ariaLabel:B(),onClick:N,styles:J(G),text:ExcelRibbonStrings.FormulaArgumentAssistanceShowLess}):a.createElement(F.a,{id:"toggleCardStateButtonId",iconProps:{iconName:h.a.CommonControlChevronDown_16},ariaLabel:B(),customTooltip:B(),onClick:N,styles:q(G)}),a.createElement("div",{ref:E},r()))),a.createElement("div",{className:L.expandedCard,ref:w,onPointerDown:function(e){e.preventDefault()}},a.createElement("div",{className:L.cardPart,ref:T},o(y===ee.b.Expanded)))))})),ae=n(1962),ce=n(299),se=n(1198),ue=n(110),le={root:b.e},de=Object(m.c)((function(e){return{display:"block",content:"attr(".concat(e,")"),fontSize:v.j.size12,fontWeight:v.k.semibold,height:0,overflow:"hidden",visibility:"hidden"}})),fe={label:{root:{fontSize:v.j.size12,fontWeight:v.k.semibold,lineHeight:v.j.size16,paddingBottom:4,paddingTop:0}},formula:{root:{color:g.a.gray180,fontSize:v.j.size12,fontWeight:v.k.semibold,lineHeight:v.j.size16,selectors:(r={},r[v.l]={color:"WindowText"},r)}},text:{root:{color:g.a.gray180,fontSize:v.j.size12,lineHeight:v.j.size16,selectors:(o={},o[v.l]={color:"WindowText"},o)}},param:{root:{color:Object(ue.a)().shade20,fontSize:v.j.size12,fontWeight:v.k.semibold,lineHeight:v.j.size16,selectors:(i={},i[v.l]={color:"Highlight"},i)}},parametersContainer:{display:"grid",gridTemplateColumns:"auto 1fr",gridGap:1,color:g.a.gray180,fontSize:v.j.size12,lineHeight:v.j.size16},expandedCardPart:{root:{paddingTop:4}}},pe=Object(m.c)((function(e){var t,n;return e?Object(v.cb)({root:{selectors:(n={},n[v.l]={border:"2px solid Highlight"},n)}}):Object(v.cb)({root:{cursor:"pointer",opacity:.5,selectors:(t={},t[v.l]={opacity:1},t)}})})),he=Object(m.c)((function(e){var t={":after":de("formula-text")};return e?Object(v.cb)({root:t}):Object(v.cb)({root:Object(u.__assign)(Object(u.__assign)({},t),{textAlign:"unset",borderBottom:"0px","&:active, &:hover, &:active:hover, &:focus":{color:g.a.gray180}})})})),me={root:{direction:"ltr"}},ve=Object(m.c)((function(e){var t;return Object(v.cb)({param:Object(u.__assign)({backgroundColor:ge(e),padding:"2px 5px 4px 5px",transition:"background-color 150ms linear",cursor:"default"},e?y.o:{}),paramName:{fontWeight:e?v.k.semibold:v.k.regular,":after":de("param-name")}},{param:{selectors:(t={},t[v.l]={transition:"none",border:"1px solid WindowText"},t)}})})),ge=function(e){return e?"rgb(202, 234, 216, 0.6)":"rgb(245, 245, 245)"},ye=function(e){var t=e.description;return a.createElement(c.a,null,a.createElement(ce.a,{styles:fe.label},ExcelRibbonStrings.FormulaArgumentAssistanceDescription),a.createElement(se.a,{styles:fe.text},t))},be=function(e){var t=e.functionName,n=e.params,r=e.selected,o=e.functionNameStyle,i=e.textStyle,c=e.selectedStyle,s=e.listSeparator,u=e.styles,l=e.onClick;return a.createElement(se.a,{styles:Object(v.cb)(me,i,u),onClick:l},a.createElement(se.a,{styles:o},t),a.createElement(a.Fragment,null,"(",n.length>0&&n.map((function(e,t){var n=t===r?c:i;return a.createElement(a.Fragment,{key:t},a.createElement(se.a,{styles:n},e))})).reduce((function(e,t){return[e,"".concat(s," "),t]})),")"))},Se=function(e){var t=e.functionName,n=e.parameters,r=e.listSeparator,o=e.description;return n?a.createElement(c.a,null,a.createElement(ce.a,{styles:fe.label},ExcelRibbonStrings.FormulaArgumentAssistanceExample),a.createElement(be,{functionName:"=".concat(t),params:n.params,selected:n.activeParam,functionNameStyle:fe.text,textStyle:fe.text,selectedStyle:fe.param,listSeparator:r}),o&&a.createElement(se.a,{styles:fe.text},o)):null},Ce=function(e){var t=e.parameters,n=e.descriptions;return a.createElement(a.Fragment,null,t.params&&t.params.length>0&&a.createElement("div",{style:fe.parametersContainer},t.params.map((function(e,r){var o=r===t.activeParam,i=ve(o);return a.createElement(a.Fragment,{key:r},a.createElement("div",{className:[i.param,i.paramName].join(" "),"param-name":e},e),a.createElement("div",{className:i.param},n[r]))}))))},_e=n(1097),Pe=function(e){var t=e.functionName,n=e.signatures,r=e.activeSignature,o=e.listSeparator,i=e.onFormulaClick;return a.createElement(c.a,null,n.map((function(e,n){var c=n===r,s=e.signatureParams.params,u="".concat(t,"(").concat(s.join("".concat(o," ")),")");return c?a.createElement("div",{className:he(c).root,"formula-text":u,id:"aa_function_".concat(n),key:n},a.createElement(be,{functionName:t,params:s,selected:e.signatureParams.activeParam,functionNameStyle:fe.formula,textStyle:fe.text,selectedStyle:fe.param,listSeparator:o,styles:pe(c)})):a.createElement(_e.a,{styles:he(c),key:n,onClick:i(n),"formula-text":u,id:"aa_function_".concat(n)},a.createElement(be,{functionName:t,params:s,selected:e.signatureParams.activeParam,functionNameStyle:fe.formula,textStyle:fe.text,selectedStyle:fe.param,listSeparator:o,styles:pe(c)}))})))},xe=n(600),ke=n(278),Oe=function(e){var t=e.functionName,n=e.isExpanded,r=e.onHelpClick,o=e.onFeedback,i=a.useContext(ke.a).isFeedbackAllowed;return a.createElement(c.a,{horizontal:!0,horizontalAlign:"space-between"},a.createElement(_e.a,{"data-test-id":"learnMoreLinkId",disabled:!n,styles:b.d,onClick:r},"".concat(ExcelRibbonStrings.FormulaArgumentAssistanceLearnMore," ").concat(t)),i&&a.createElement(xe.a,{disabled:!n,onClick:o}))},Ee=n(183);n.d(t,"a",(function(){return we}));var we=a.forwardRef((function(e,t){var n=e.target,r=e.setComponentApi,o=e.onLayoutChange,i=e.getTargetAndBounds,u=e.functionRenderingInfo,l=e.callbacks,d=e.cardMode,f=e.showCollapseText,p=e.isExpanded,h=e.hidden,m=u,v=m.functionName,g=m.functionDescription,y=m.signatures,b=m.activeSignature,S=m.listSeparator,C=a.useState(null!=b?b:0),_=C[0],P=C[1],x=y[_],k=function(e){return function(t){P(e)}},O=function(e){var t;null===(t=null==l?void 0:l.onHelpLink)||void 0===t||t.call(l)},E=function(e){var t;null===(t=null==l?void 0:l.onFeedback)||void 0===t||t.call(l,u)},w=function(){return a.createElement(Pe,{functionName:v,signatures:y,activeSignature:_,listSeparator:S,onFormulaClick:k})},T=function(e){return a.createElement(c.a,{styles:fe.expandedCardPart,tokens:{childrenGap:12}},a.createElement(ye,{description:g}),a.createElement(Se,{functionName:v,parameters:x.exampleParams,listSeparator:S,description:x.exampleDescription}),a.createElement(Ce,{parameters:x.descriptionParams,descriptions:x.descriptions}),a.createElement(Oe,{functionName:v,isExpanded:e,onHelpClick:O,onFeedback:E}))};return Object(Ee.a)()?a.createElement(ae.a,null,a.createElement(N,{getTargetAndBounds:i,setComponentApi:r,onLayoutChange:o,renderCompactCard:w,renderExpandedCard:T,isExpanded:p,onIsExpandedChange:null==l?void 0:l.onIsExpandedChange,ref:t,key:p.toString(),styles:le,hidden:h,id:s.a.callout,collapsedId:s.a.collapsedPart,showCollapseText:f,doNotLayer:Object(Ee.b)(),layerProps:Object(Ee.b)()?void 0:{eventBubblingEnabled:!0}})):a.createElement(ae.a,null,a.createElement(ie,{target:n,renderCompactCard:w,renderExpandedCard:T,cardMode:d,onCardModeChange:null==l?void 0:l.onCardModeChange,ref:t,key:d,hidden:h,showCollapseText:f,id:s.a.callout,collapsedId:s.a.collapsedPart,doNotLayer:Object(Ee.b)(),layerProps:Object(Ee.b)()?void 0:{eventBubblingEnabled:!0}}))}))},532:function(e,t,n){"use strict";var r=n(1),o=n(0),i="ac-callout",a=n(65),c=n(43),s=n(363),u=n(617),l=n(264),d=n(701),f=n(712),p=n(13),h=n(214),m=n(1153),v=n(4),g=n(765),y=n(119),b=n(12),S=n(91),C=n(27),_=n.n(C),P=n(133),x=S.b.getInstance().getTheme(),k=Object(v.W)(0,v.s),O={height:"100%",display:"flex",flexDirection:"column"},E={display:"flex",minHeight:"0px",flexDirection:"column"},w={root:P.e},T="svg > path.OfficeIconColors_HighContrast:not([class*='OfficeIconColors_m'])",j=Object(p.c)((function(){var e,t;return Object(v.db)({"&:hover":(e={},e[v.l]=(t={},t[T]={fill:"HighlightText"},t),e),"&:focus":{outline:"-webkit-focus-ring-color auto 1px"}})})),M=Object(p.c)((function(e,t){var n,o;return Object(v.cb)(Object(g.b)(x),{linkContent:Object(r.__assign)({color:y.a.gray180,minHeight:28,padding:"0px ".concat(12,"px 0px ").concat(12,"px"),cursor:"pointer",userSelect:"none",backgroundColor:e?"#F5F5F5":"","&:hover":Object(r.__assign)({backgroundColor:"#F0F0F0"},b.o)},e?b.o:{}),icon:{alignSelf:"center",width:16,height:16,margin:"0px ".concat(4,"px"),selectors:(n={},n[k]={fontSize:"",width:""},n[v.l]={selectors:(o={},o[T]={fill:e?"HighlightText":""},o)},n)},label:{font:"12px Segoe UI",lineHeight:v.j.size16,flexGrow:"",overflow:t?"hidden":"",textOverflow:t?"elipsis":"",alignSelf:"center",margin:"0px 0px 0px ".concat(6,"px"),display:t?"-webkit-box":void 0,whiteSpace:t?"normal":void 0,wordBreak:t?"break-all":void 0,WebkitLineClamp:t?"1":void 0,WebkitBoxOrient:t?"vertical":void 0},secondaryText:Object(r.__assign)({color:y.a.gray130,fontSize:v.j.size10,lineHeight:v.j.size12,textAlign:"left",whiteSpace:"normal",padding:"2px 0px 2px 8px",alignSelf:"center"},D(e))})})),A={margin:"2px 0px 2px ".concat(4,"px"),width:8,color:y.a.gray130,fontSize:v.j.size12},I=Object(p.c)((function(e,t,n,o){var i,a=t?9:0,c=Math.min(228+a,n.maxHeight);return Object(v.cb)({root:{width:e?void 0:340,minWidth:e?240:void 0,maxWidth:e?340:n.maxWidth,paddingTop:4},subComponentStyles:{menuItem:{divider:{height:1,margin:4,selectors:(i={},i[v.l]={backgroundColor:"WindowText"},i)}}},simpleSection:Object(r.__assign)({maxHeight:c-(4+28*o+a),overflowY:"auto"},P.f)})})),F=Object(p.c)((function(e,t,n){var o,i=t?9:0,a=228+i;return Object(v.cb)(P.b,{root:{width:e?void 0:340,minWidth:e?240:void 0,maxWidth:e?340:void 0,paddingTop:4},subComponentStyles:{menuItem:{divider:{height:1,margin:4,selectors:(o={},o[v.l]={backgroundColor:"WindowText"},o)}}},simpleSection:Object(r.__assign)({maxHeight:a-(4+28*n+i),overflowY:"auto"},P.f)})})),R={footer:{root:{padding:"4px ".concat(12,"px 8px ").concat(12,"px")}},feedback:{root:{float:"right",fontSize:v.j.size10,lineHeight:v.j.size14}}},L=function(e){switch(e.kind){case h.CompletionItemKind.Function:return e.type===h.SuggestionKind.Simple?_.a.FormulaBar_16:_.a.Intelligence_16;case h.CompletionItemKind.RichEntity:return _.a.Tag_16;case h.CompletionItemKind.LetVariable:return _.a.FormulaLet_16;case h.CompletionItemKind.NamedRange:return _.a.NameRange_16;case h.CompletionItemKind.Table:return _.a.Table_16;case h.CompletionItemKind.TableHeader:return _.a.SelectColumn_16;case h.CompletionItemKind.RichEntityEmptyCellRef:return _.a.AbsoluteReference_16;default:return""}},D=function(e){var t;return{selectors:(t={},t[v.l]={color:e?"HighlightText":"WindowText"},t)}},N=n(541),U=n(600),B=n(278),z=function(e){var t=e.onFeedback,n=o.useContext(B.a).isFeedbackAllowed;return o.createElement(N.a,{styles:R.footer,tokens:{childrenGap:8}},n&&o.createElement("div",null,o.createElement(U.a,{styles:R.feedback,disabled:!1,onClick:t})))},G=n(444),W=n(183),H=n(445),K=n(111),V=n(941),J=n(66),q=n(70),Q=n(239);n.d(t,"a",(function(){return Z}));var Z=o.forwardRef((function(e,t){var n,f=e.target,p=e.setComponentApi,v=e.onLayoutChange,g=e.getTargetAndBounds,b=e.completionItems,S=e.callbacks,C=e.activeItemIndex,_=e.hidden,x=e.disableItemReadout,k=o.useRef(null);o.useLayoutEffect((function(){k.current&&k.current.scrollIntoView({block:"nearest"})}));var T=o.useMemo((function(){return Object(m.a)(b)}),[b]),R=o.useMemo((function(){return T.reduce((function(e,t){return e[t.type]=!0,e}),{})}),[T]),D=R[h.SuggestionKind.Smart],N=D&&!R[h.SuggestionKind.Simple],U=D&&R[h.SuggestionKind.Simple],B=Object(W.a)()?{targetRect:void 0,maxDimensions:void 0,directionalHint:void 0}:Object(H.b)(f),K=B.targetRect,J=B.maxDimensions,q=B.directionalHint;N&&(q=a.a.bottomLeftEdge);var Q=Object(W.a)()?F(N,U,T.filter((function(e){return e.type===h.SuggestionKind.Smart})).length):I(N,U,J,T.filter((function(e){return e.type===h.SuggestionKind.Smart})).length),Z=function(e){return function(t){var n;e!==C&&(null===(n=null==S?void 0:S.onCompletionItemSelected)||void 0===n||n.call(S,T[e],e),t.target.offsetHeight<t.target.scrollHeight&&t.target.setAttribute("title",T[e].label))}},$=function(e){return function(t){var n;t.preventDefault(),null===(n=null==S?void 0:S.onCompletionItemCommitted)||void 0===n||n.call(S,T[e])}},ne=function(e){return function(t){var n;t.nativeEvent.keyCode===c.a.enter&&(t.preventDefault(),null===(n=null==S?void 0:S.onCompletionItemCommitted)||void 0===n||n.call(S,T[e]))}},re=function(e){return function(t){var n,r;e!==C&&(t.stopPropagation(),null===(n=null==S?void 0:S.onCompletionItemSelected)||void 0===n||n.call(S,T[e],e),null===(r=t.currentTarget)||void 0===r||r.focus())}},oe=o.useCallback((function(e,n){var i=Object(r.__assign)(Object(r.__assign)({},e),{items:null==e?void 0:e.items.filter((function(e){return"smart-section"===e.key}))}),a=Object(r.__assign)(Object(r.__assign)({},e),{items:null==e?void 0:e.items.filter((function(e){return"simple-section"===e.key}))}),c=Object(W.a)()?{style:O}:{},s=Object(W.a)()?{style:E}:{};return o.createElement("div",Object(r.__assign)({},c,{ref:t}),o.createElement(u.a,Object(r.__assign)({disabled:_},s),n(i),o.createElement("div",{className:Q.simpleSection},n(a))),(te()||D)&&o.createElement(z,{onFeedback:function(e){var t;null===(t=null==S?void 0:S.onFeedback)||void 0===t||t.call(S)}}))}),[D,S,Q.simpleSection,t,_]),ie=o.useCallback((function(e,t){return function(n,r){var i=X(n.item.text,t);return o.createElement(o.Fragment,null,r.renderItemIcon(n),o.createElement("span",{id:e?"ac_selected_function":void 0,className:n.classNames.label},n.item.text),t&&ae(t,i),e&&r.renderSecondaryText(n))}}),[]),ae=function(e,t){return o.createElement(o.Fragment,null,o.createElement("span",{style:A},"="),o.createElement("span",{style:(n=t,{display:"-webkit-box",whiteSpace:"normal",wordBreak:"break-all",width:n,minWidth:n,margin:"2px 0px 2px ".concat(4,"px"),color:y.a.gray130,WebkitLineClamp:1,WebkitBoxOrient:"vertical",textOverflow:"elipsis",overflow:"hidden",font:"12px Segoe UI"})},e));var n},ce=T.map((function(e,t){var n,r;return{key:e.label+e.kind,text:e.label,secondaryText:e.detail,iconProps:{iconName:L(e)},onRender:(r=t,function(e,t){var n=r===C,i=T[r].type===h.SuggestionKind.Smart,a=n&&!N;return o.createElement("div",{role:"menuitem",className:j(),"data-test-id":"menuItemId".concat(r),onMouseMove:Z(r),onMouseDown:$(r),onKeyDown:ne(r),onFocus:re(r),ref:n?k:void 0,"data-is-focusable":!0,tabIndex:n?0:-1,"aria-label":x?" ":void 0},o.createElement(s.a,{classNames:M(a,i),hasIcons:!0,index:r,item:e}))}),onRenderContent:ee()?ie(e.type===h.SuggestionKind.Simple&&t===C,null!==(n=e.evaluation)&&void 0!==n?n:void 0):ie(!N&&t===C),data:e.type}})),se={key:"smart-section",itemType:l.a.Section,sectionProps:{items:ce.filter((function(e){return e.data===h.SuggestionKind.Smart})),bottomDivider:U}},ue={key:"simple-section",itemType:l.a.Section,sectionProps:{items:ce.filter((function(e){return e.data===h.SuggestionKind.Simple})),bottomDivider:!1}},le=function(e){var t,n;(null===(t=null==e?void 0:e.nativeEvent)||void 0===t?void 0:t.keyCode)===c.a.escape&&(null===(n=null==S?void 0:S.onDismiss)||void 0===n||n.call(S))},de=null!==(n=null==S?void 0:S.onRestoreFocus)&&void 0!==n?n:void 0,fe=[se,ue];if(Object(W.a)()){var pe=Object(V.a)(i),he=o.useCallback((function(){if(!_&&pe){var e=g(),t=e.target,n=e.bounds,r=e.isFloating,o=e.renderDown,i=pe.clientHeight,a=pe.clientWidth,c=r||N?i:Math.max(i,P.c.minHeight),s=Object(G.a)(t,i,c,a,r,o||N,n);v(s);for(var u=Object(G.b)(s),l=0,d=Object.entries(u);l<d.length;l++){var f=d[l],p=f[0],h=f[1];pe.style.setProperty(p,h)}}}),[g,_,v,N,pe]);return o.useEffect((function(){p({updatePosition:he})}),[p,he]),o.useEffect((function(){pe&&he()})),o.createElement(d.a,{items:fe,styles:Q,onRenderMenuList:oe,isBeakVisible:!1,shouldFocusOnMount:!1,hidden:_,calloutProps:{id:i,styles:w,layerProps:Object(W.b)()?void 0:{eventBubblingEnabled:!0}},focusZoneAs:Y,focusZoneProps:{disabled:_},onDismiss:le,doNotLayer:Object(W.b)(),onRestoreFocus:de})}return o.createElement(d.a,{target:K,items:fe,styles:Q,onRenderMenuList:oe,isBeakVisible:!1,shouldFocusOnMount:!1,directionalHint:q,directionalHintForRTL:q,hidden:_,calloutProps:{id:i,styles:P.a,minPagePadding:H.c,layerProps:Object(W.b)()?void 0:{eventBubblingEnabled:!0}},focusZoneAs:Y,focusZoneProps:{disabled:_},onDismiss:le,doNotLayer:Object(W.b)(),onRestoreFocus:de})})),Y=function(e){return o.createElement(f.a,{disableFirstFocus:!0,forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,className:e.className},e.children)},X=function(e,t){if(void 0!==e&&void 0!==t){var n=$(e),r=$(t);if(n+r>=270){J.a.sendTraceTag(509445899,q.a.msoulscat_ES_EWAJS,Q.a.Info,"FormulaAutoCompleteMenu.getEvaluationWidth: The needed width is bigger than the card limit,\n      suggestionWidth: ".concat(n,", evaluationWidth:  ").concat(r,"."));if(r>90){r=90;var o=180-n;o>0&&(r+=o)}}return r}},$=function(e){var t=document.createElement("canvas").getContext("2d");return t.font="12px Segoe UI",t.measureText(e).width},ee=Object(p.c)((function(){return Object(K.isChangeGateEnabled)("OfficeVSO:7144245_EvaluatingSmartSuggestion")})),te=Object(p.c)((function(){return Object(K.isChangeGateEnabled)("OfficeVSO:7271892_addFeedbackToAutocompleteCard")}))},600:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1),o=n(1097),i=n(4),a=n(0),c=n(133),s=function(e){var t=e.disabled,n=e.onClick,s=Object(r.__rest)(e,["disabled","onClick"]);return a.createElement(o.a,{disabled:t,styles:Object(i.cb)(c.d,s.styles),onClick:n},ExcelRibbonStrings.FormulaAuthoringGiveFeedback)}},656:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isTypedChangeGateEnabled=t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.getTypedFeatureGate=t.getFeatures=t.isFeatureEnabled=t.initFeatureConfiguration=t.FeatureName=void 0;var r,o=n(461),i=n(77),a=n(111);!function(e){e.FeatureCheckingEnabled="FeatureCheckingEnabled",e.CalcPreventSpillingHack="CalcPreventSpillingHack",e.CalcLegacyImplicitIntersection="CalcLegacyImplicitIntersection",e.CalcRecordFunctions="CalcRecordFunctions",e.CalcNestedRecordFunction="CalcNestedRecordFunction",e.CalcLetRecFunction="CalcLetRecFunction",e.CalcLambdaFunction="CalcLambdaFunction",e.CalcLambdaBasicFunctions="CalcLambdaBasicFunctions",e.CalcLambdaHelperFunctions="CalcLambdaHelperFunctions",e.CalcLambdaOptionalParameters="CalcLambdaOptionalParameters",e.CalcLambdaDefaultParameters="CalcLambdaDefaultParameters",e.CalcLambdaCellValues="CalcLambdaCellValues",e.CalcLambdaArrayLifting="CalcLambdaArrayLifting"}(r=t.FeatureName||(t.FeatureName={}));var c=function(e){var t="calc.common.isFeatureEnabledCallback: called with ".concat(e," before initCalc");return o.ulsLogger.ULS.traceTag(526989323,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,t),!1},s={};function u(e){return void 0===s[e]&&(s[e]=c(e)),s[e]}t.initFeatureConfiguration=function(e){"function"==typeof e&&(c=e)},t.isFeatureEnabled=u,t.getFeatures=function(){var e={};for(var t in r){var n=r[t];null!=n&&(e[n]=u(n))}return e};t.getTypedFeatureGate=(0,a.makeGetTypedFeatureGate)({"Microsoft.Office.Excel.ProseFormulaRepairExperimentLogBuggyIsEnabled":!1,"Microsoft.Office.Excel.ProseFormulaRepairExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSDemoFeatureGateString":"DummyStringValue","Microsoft.Office.Excel.CalcTSDemoFeatureGateInt":42,"Microsoft.Office.Excel.CalcTSDemoFeatureGateBoolean":!1,"Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSUnitExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSExceLintExperimentIsEnabled":!1,"Microsoft.Office.Excel.SmartFormulaBarAutocompleteIsEnabled":!1,"Microsoft.Office.Excel.SmartFormulaBarUseDevScheduler":!1,"Microsoft.Office.Excel.x10DoNotThrowOnDoublePluginRegistration":!0,"Microsoft.Office.Excel.ProductSetBugFixFromPR1043532":!0,"Microsoft.Office.ExcelOnline.ArgumentAssistancePlugin":!1,"Microsoft.Office.Excel.AutocompleteRangeSuggestionPlugin":!1,"Microsoft.Office.Excel.x10AutocompletionPrecisionMeasurementsIsEnabled":!1,"Microsoft.Office.Excel.x10AutocompletionAuthoringPrecisionMeasurementsIsEnabled":!1,"Microsoft.Office.Excel.x10AutocompleteWrapperPluginIsEnabled":!1,"Microsoft.Office.Excel.x10AutocompleteBinaryModelExperimentPlugin":!1,"Microsoft.Office.Excel.x10AutocompleteGroundTruthMeasurementsIsEnabled":!1,TESTING_ONLY_RECALC_SERVICE_IMPORTSCRIPTS_FAIL:!1,TESTING_ONLY_SCHEDULER_IMPORTSCRIPTS_FAIL:!1,TESTING_ONLY_TEST_PLUGIN_IMPORTSCRIPTS_FAIL:!1,"Microsoft.Office.Excel.FormulaAssistanceRedesign":!1,"Microsoft.Office.Excel.ParenthesesCoupling":!1,"Microsoft.Office.Excel.ColoredReferences":!1,"Microsoft.Office.Excel.FormulaCollection":!1,"Microsoft.Office.Excel.FormulaAssistanceValuePreview":!1,"Microsoft.Office.Excel.x10ParserPerformanceMeasurements":!1,"Microsoft.Office.Excel.ArgumentAssistanceOnMainThread":!1,"Microsoft.Office.Excel.AutoCompleteOnMainThread":!1,"Microsoft.Office.Excel.UnitExpLogDNM":!1,"Microsoft.Office.Excel.UnitlessTimeAndDate":!1,"Microsoft.Office.Excel.UnitExpIgnoreDivMul":!1,"Microsoft.Office.Excel.x10PythonAutocompletionEnabled":!1,"Microsoft.Office.Excel.MockWorkerThreadPlugin":!1,"Microsoft.Office.Excel.EnableFullSessionLogging":!1,"Microsoft.Office.Excel.UseAggregatedLogging":!1,"Microsoft.Office.Excel.SyntaxErrors":!1});var l=n(111);Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return l.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return l.setFeatureGateDictionaryGetter}}),t.isTypedChangeGateEnabled=(0,a.makeTypedIsChangeGateEnabled)(["OfficeVSO:XXX_TestChangeGate","Microsoft.Office.Excel.ChangeGate.PreciseNowForNodeJS","OfficeVSO:6409219_addPluginNameToPluginDataLog","OfficeVSO:6476056_OnlySendNestedDotNotationPath","Microsoft.Office.Excel.ChangeGate.ParseEditEqFix","Microsoft.Office.Excel.ChangeGate.RCBracketFix","Microsoft.Office.Excel.ChangeGate.LocErrorTokensFix","Microsoft.Office.Excel.ChangeGate.BadlyNestedBracketsFix","OfficeVSO:7125313_handleUnavailableFormat","OfficeVSO:7396249_getTableHeadersFromServer","OfficeVSO:7536593_resolveCorrelatedRequestsWithNoPlugins","OfficeVSO:7549315_ArgumentAssistance"])},657:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.entry=t.makeEmptyTable=void 0;var r={getCount:function(){return 0},getValue:function(){},getEntry:function(){},contains:function(){return!1},forEach:function(){return!0}};t.makeEmptyTable=function(){return r},t.entry=function(e,t){return{key:e,value:t}}},941:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),o=n(66),i=n(70),a=n(239);function c(e){var t=Object(r.useRef)(0),n=Object(r.useState)(null),c=n[0],s=n[1];return Object(r.useEffect)((function(){var n=-1,r=function(){var c=document.getElementById(e);c?s(c):t.current<10?(t.current++,n=requestAnimationFrame(r)):o.a.sendTraceTag(509634701,i.a.msoulscat_ES_EWAJS,a.a.Error,"useElementById couldn't find #".concat(e," ")+"in less than ".concat(t.current," frames."))};return r(),function(){return cancelAnimationFrame(n)}}),[e]),c}}},[[1889,2,0,1]]]);
//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/formulaAssistance.min.js.map/d730be2afc07cbbf722292b89dc66d31/formulaAssistance.min.js.map
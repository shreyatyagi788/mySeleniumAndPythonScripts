'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1099:function(r,F,a){a.d(F,"a",function(){return b});var c=a(512);const b=()=>{c.a.Bi('.ewa-ac{position:absolute;z-index:102;margin-top:1px;width:auto}.ewa-ac .ewa-ac-param{white-space:nowrap;margin-bottom:3px;direction:ltr}.ewa-ac .ewa-ac-param function_param_table{position:absolute}.ewa-ac .ewa-ac-param .ewa-function-help-link{text-decoration:underline}.ewa-lb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#262626;font-size:12px;font-family:"Segoe UI";z-index:102;height:auto;margin:0 8px;touch-action:manipulation;vertical-align:middle}.ewa-lb.ewa-fb-refactor{position:relative;margin:0}.ewa-lb table{left:0;right:0;border-collapse:collapse}.ewa-lb table td{white-space:nowrap}.ewa-lb table td div.clip16x16{margin:0 0 0 2px}.ewa-lb table td.list-item{height:24px;padding:0 8px}.ewa-lb table td.list-item-selected{background-color:#d3f0e0}@media screen and (-ms-high-contrast:active){.ewa-lb table td.list-item-selected{border:2px solid #fff}}.ewa-lb table.list-table-touch td.list-item{height:35px}div#suggested_cells_list_box{margin:0}div#suggested_cells_list_box .list-table .ewa-suggested-cell-name{float:left;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}@font-face{font-family:"Segoe UI Semibold";font-weight:600;src:local("Segoe UI Semibold"),local("Segoe UI")}.ewa-lb table td.columnName-header{color:#666;font-size:12px;font-family:"Segoe UI Semibold";text-align:left;padding:3px 8px;text-overflow:ellipsis}.ewa-tt{background-color:#f7f7f7;border:1px solid #a2a6ab;color:#444;height:auto;vertical-align:middle;width:auto;z-index:102;font-size:8pt;margin:0;padding-bottom:3px;padding-top:2px}.ewa-root-ltr .ewa-tt{text-align:left;padding-left:5px;padding-right:7px}.ewa-root-rtl .ewa-tt{text-align:right;padding-left:7px;padding-right:5px}.ewa-dlg-function-link-container .ewa-fdb-help-link,.ewa-tt-rtl .ewa-fdb-help-link,.ewa-tt-ltr .ewa-fdb-help-link{color:#00f;text-decoration:underline}.ewa-function-link-container .ewa-function-udf-name,.ewa-function-link-container-udf .ewa-function-help-link{display:none}.ewa-root.rtl .ewa-function-link-container{text-align:left}')}},
1100:function(r,F,a){a.d(F,"a",function(){return c});r=a(0);class c{constructor(b,e){this.command=0;this.selectedRanges=null;this.command=b;this.selectedRanges=e}mt(){return this.command}}Object(r.a)(c,"MacroRecorderRangeOperationAppliedPayload",null,[162])},1101:function(r,F,a){a.d(F,"a",function(){return b});var c=a(512);const b=()=>{c.a.Bi(".TabsContainer{width:100%}.TabTitlesContainer{width:100%;display:table;table-layout:fixed;padding:0}.TabTitlesContainer>.TabTitle{display:table-cell;text-align:center}.TabTitlesContainer>.TabTitle:hover:not(.TabTitleActive){font-weight:bold}.TabTitleText{text-decoration:none}div#valueFieldSettingTabs .TabTitlesContainer{border-bottom:solid 1px #c3cbd0}div#valueFieldSettingTabs .TabTitle{text-align:center;cursor:default}div#valueFieldSettingTabs .TabTitleText{display:inline-block}div#valueFieldSettingTabs .TabTitleActive{color:#217346;font-weight:bold}div#valueFieldSettingTabs .TabTitleActive>.TabTitleText{padding-bottom:10px;border-bottom:solid 4px}div#dataFieldCustomLabel,div#dataFieldSourceLabel{font-weight:600;padding-left:10px}div#summarizeValuesByControlBody{background-color:#fff;padding:10px}.valueFielsSettingsControlTitle{font-weight:bold;border-bottom:1px solid #a2a6ab}div#summarizeValuesByControlBody>.summarizeValuesByControlDescription{font-weight:600}div#summarizeValuesByControlBody>select{width:100%}div#showValueAsControlBody{background-color:#fff;padding:10px}select#showValueAsSelect{width:100%;margin-bottom:5px}select#showValueAsBaseFieldSelect{width:100%}select#showValueAsBaseItemSelect{width:100%;overflow:hidden}div#showValueAsControlBody>.showValueAsControlSelectRegion{width:48%;display:inline-block;position:relative}div#showValueAsControlBody>.showValueAsControlSelectRegionSeparator{width:4%;display:inline-block}.showValueAsControlSelectRegion>div{width:100%}input#valueFieldsSettingsFieldName{width:273px}div#valueFieldSettingTabs{width:380px}")}},
1102:function(r,F,a){a.d(F,"a",function(){return"FieldInfoListContextLoaded"});a.d(F,"h",function(){return"GetFieldInfoListContextOperationFailed"});a.d(F,"d",function(){return"Days from Today"});a.d(F,"g",function(){return"Years from Today"});a.d(F,"c",function(){return"Day of the Week"});a.d(F,"f",function(){return"Month of the Year"});a.d(F,"e",function(){return"End of Month"});a.d(F,"b",function(){return"Next Day"})},1103:function(r,F,a){a.d(F,"a",function(){return b});var c=a(512);const b=()=>
{c.a.Bi(".ewa-dv{position:relative;z-index:100;width:auto}.ewa-dv-buttonarea{position:absolute;border:0;padding:1;z-index:100;margin:0;overflow:hidden;width:auto;height:auto}.ewa-dv-listbutton{margin:0;cursor:pointer}.ewa-dv-listbutton span.clip17x17{display:inline-block;margin:0}.ewa-dlb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:100;height:auto;margin:0}.ewa-dlb table{left:0;right:0;border-collapse:collapse;empty-cells:show}.ewa-dlb table td{white-space:nowrap;padding:0 2px 0 2px}.ewa-dlb table.list-table td.list-item{height:24px}.ewa-dlb table.list-table td.list-item-selected{height:24px;background-color:#d3f0e0;color:#444}.ewa-dlb table.list-table-touch td.list-item{height:35px}.ewa-dlb table.list-table-touch td.list-item-selected{height:35px;background-color:#d3f0e0;color:#444}@media screen and (-ms-high-contrast:active){.ewa-dlb table.list-table td.list-item-selected{background-color:highlight;-ms-high-contrast-adjust:none;color:highlighttext}}.ewa-dpb{position:absolute;border:1px solid #a2a6ab;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:99;margin:0;max-width:230px}.ewa-dpb p{padding:0 2px 0 2px;margin:0;border-collapse:collapse;width:230px}.ewa-dv-ltr .ewa-dpb p{text-align:left}.ewa-dv-rtl .ewa-dpb p{text-align:right}.ewa-dpb p.dv-prompt-title{font-weight:bold}.ewa-dpb p.dv-prompt-message{word-wrap:break-word;overflow:hidden}")}},
1104:function(r,F,a){a.d(F,"a",function(){return b});var c=a(512);const b=()=>{c.a.Bi(".TabsContainer{width:100%}.TabTitlesContainer{width:100%;display:table;table-layout:fixed;padding:0}.TabTitlesContainer>.TabTitle{display:table-cell;text-align:center}.TabTitlesContainer>.TabTitle:hover:not(.TabTitleActive){font-weight:bold}.TabTitleText{text-decoration:none}.DataValidationDialogPanel{min-width:0}.DataValidationDialogPanel .TabTitlesContainer{width:300px}.DataValidationDialogPanel div#WACDialogBodyPanel{height:312px}.TabTitlesContainer{border-bottom:solid 1px #c3cbd0}.TabTitle{text-align:center;cursor:default}.TabTitleText{display:inline-block}.TabTitleActive{color:#217346;font-weight:bold}.TabTitleActive>.TabTitleText{padding-bottom:10px;border-bottom:solid 4px}.DataValidationEditTabContent{padding-top:7px}.DataValidationButtonPanel{float:none}.AppRtl .DataValidationButtonPanel{float:none}.DataValidationButtonClearAll{float:left;margin-left:0;margin-right:10px}.AppRtl .DataValidationButtonClearAll{float:right;margin-left:10px;margin-right:0}.DataValidationRow{margin-bottom:10px;display:table}.DataValidationNonBorderRow{margin-bottom:8px;display:table}.DataValidationEditElementLabel{width:95px;display:inline-block;margin-top:4px;margin-bottom:4px;vertical-align:top}.DataValidationEditElement{display:inline-block;margin-top:0;margin-bottom:0;padding:1px;font-size:9pt;font:inherit;border:solid 1px #c3cbd0}.DataValidationEditNoBorderElement{display:inline-block;margin-top:0;margin-bottom:0;font-size:9pt;font:inherit;width:210px;height:22px}.DataValidationEditSelect{width:calc(210px + 4px);height:calc(22px + 4px);padding:0;color:#000}.DataValidationEditSelect:disabled{color:graytext}.DataValidationEditSelectFocus:focus{outline:-webkit-focus-ring-color auto 5px !important}.DataValidationEditInput{width:210px;height:22px}.DataValidationEditTextArea{width:210px;height:50px;resize:none;overflow-y:auto;overflow-x:hidden}.DataValidationEditErrorMessage{margin-bottom:-15px;margin-top:-6px;font-size:9pt;color:#d90000;width:300px;height:65px}.DataValidationEditCheckBoxWithText{margin-top:0;margin-bottom:0;display:inline-block}.DataValidationEditCheckBoxNoText{margin-top:6px;margin-bottom:0;display:inline-block}.DataValidationEditRadio{margin-top:0;margin-bottom:0}.DataValidationEditLabel{margin-top:5px;margin-bottom:0;display:inline-block}div#listDescriptionSubDivID{height:37px;width:210px}label#listDescriptionLabelId{font-size:8pt;margin-top:0}div#ignoreBlankCheckboxDivID{margin-bottom:8px}")}},
1105:function(r,F,a){a.d(F,"a",function(){return c});r=a(0);var c;(function(b){b[b.anyValue=0]="anyValue";b[b.wholeNumber=1]="wholeNumber";b[b.decimal=2]="decimal";b[b.list=3]="list";b[b.date=4]="date";b[b.time=5]="time";b[b.textLength=6]="textLength";b[b.custom=7]="custom"})(c||(c={}));Object(r.b)("DataValidationRuleType",c)},1107:function(r,F,a){a.d(F,"a",function(){return b});var c=a(512);const b=()=>{c.a.Bi(".ewa-facp-text-box{position:absolute}")}},1108:function(r,F,a){a.d(F,"b",function(){return"MinorThemeFont"});
a.d(F,"a",function(){return"MajorThemeFont"})},1110:function(r,F,a){a.d(F,"a",function(){return b});var c=a(512);const b=()=>{c.a.Bi('.ewa-sharedUi-launchButton,.ewa-sharedUi-launchButtonWithText{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#fff;padding:2px;cursor:default;width:fit-content}.ewa-sharedUi-launchButton:hover{background-color:#c6c6c6}.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#b1b1b1;padding:1px;cursor:default;width:fit-content}@media(forced-colors:active){.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{background-color:Highlight;color:HighlightText;border-color:CanvasText;forced-color-adjust:none}.ewa-sharedUi-launchButtonClick svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButton:active svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButtonWithTextClick svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-sharedUi-launchButtonWithText .clip16x16,.ewa-sharedUi-launchButtonWithTextClick .clip16x16{float:left}.ewa-sharedUi-launchButton input{cursor:default}.ewa-sharedUi-launchButton .clip16x16,.ewa-sharedUi-launchButtonClick .clip16x16{padding:0}.ewa-sharedUi-launchButtonText{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif;font-size:10pt;overflow:hidden;padding-left:2px;cursor:pointer}')}},
1111:function(r,F,a){a.d(F,"a",function(){return l});r=a(0);F=a(239);var c=a(5),b=a(33),e=a(11),f=a(21),d=a(34),h=a(4);class l extends F.a{constructor(k){super(document.createElement("div"));this.YQ=this.KIa=this.JIa=this.LIa=this.NIa=this.MIa=!1;this.CI=null;this.visible=void 0;this.tpc=(t,n)=>{this.zt(t,n)};this.MLa=()=>{this.eb.textBox.ZE=!0};this.Qya=()=>{this.Ny(!0)};this.Xzf=()=>{this.eb.textBox.focus()};this.Gh=()=>{f.h(this.$).inRangePicker||(this.re=!1)};this.$=k;f.h(k)&&f.h(k).ha&&f.h(this.$).ha.yG(this.Gh);
this.Nk=b.a.D4(k)}get KH(){return this.au.KH}get re(){return this.au.re}set re(k){this.au.re=k}get eb(){return this.CI}set eb(k){(this.CI=k)&&this.CI.e2d.add(this)}get oKh(){return b.a.WM(this.$)?-5:-40}get_visible(){return void 0!==this.visible?this.visible:this.visible=super.get_visible()}set_visible(k){if(this.visible===k)return k;this.visible=k;return super.set_visible(k)}zt(){this.TBa(!1);this.au.zt()}dispose(){this.$&&f.h(this.$)&&f.h(this.$).ha&&f.h(this.$).ha.JK(this.Gh);this.$=null;super.dispose()}Oh(k,
t,n=!1){k=!1;if((this.q1a||n)&&!this.Uwa()&&this.get_visible()&&this.re)switch(this.Nk&&this.KDc(t),t){case 1872288872:this.re=!1;k=!0;break;case -798660877:this.au.fB(1);k=!0;break;case 137938150:this.au.fB(-1);k=!0;break;case 2091832999:this.au.fB(this.KH-1);k=!0;break;case 742457698:this.au.fB(-(this.KH-1));k=!0;break;case 125627505:k=this.Ny(!1);break;case 267796030:b.a.D4(this.$)&&(k=this.Ny(!1))}return k}TBa(k){if(this.re||k){var t=f.h(this.$);k=t.domElement;var n=this.CI.textBox.domElement,
z=d.a(this.$).mi(n.offsetHeight),w=d.a(this.$).mi(n.offsetTop),m=d.a(this.$).mi(n.offsetWidth);n=d.a(this.$).mi(n.offsetLeft);t=t.Ql;var u=h.AFrameworkApplication.sa&&h.AFrameworkApplication.sa.Qa.df,y=$get(this.$.Bb+c.a.u0a,this.$.domElement);u&&(y=document.getElementById("EditorContainer"));var v=new Sys.UI.Point(t?this.au.Vac:0,t?this.oKh:l.y8h);z=y.offsetTop+v.y+(b.a.WM(this.$)&&t?0:z+w);this.$.QZ||(w=$get(c.a.isa,this.$.domElement),z+=w&&!u?w.offsetHeight:0);w=this.domElement;w.style.top=e.HelperMethods.sc(z);
n=y.offsetLeft+n+v.x;!b.a.WM(this.$)&&this.$.isChromeRtl?w.style.right=e.HelperMethods.sc(t?this.au.Vac:k.offsetLeft+k.offsetWidth-n-m):w.style.left=e.HelperMethods.sc(n)}}jTa(k){this.au&&(k&&!this.YQ?(this.au.w9(this.Xzf),this.au.N_b(this.MLa),this.au.zob(this.Qya),this.YQ=!0):this.YQ&&(this.au.uda(this.Xzf),this.au.Ouc(this.MLa),this.au.dKb(this.Qya),this.YQ=!1))}KDc(k){switch(k){case -798660877:case 137938150:case 2091832999:case 742457698:this.MIa=!0;break;case 125627505:this.LIa=!0;break;case 267796030:b.a.D4(this.$)&&
(this.JIa=!0)}}}l.Vac=0;l.y8h=1;Object(r.a)(l,"AutoCompleteControl",F.a,[557])},1112:function(r,F,a){a.d(F,"a",function(){return c});r=a(0);class c extends Sys.EventArgs{constructor(b,e=0,f="",d=""){super();this.length=b;this.selectedIndex=e;this.GF=f;this.description=d}}Object(r.a)(c,"ListEventArgs",Sys.EventArgs,[])},1113:function(r,F,a){a.d(F,"a",function(){return w});r=a(0);var c=a(15),b=a(27);F=a(856);var e=a(786),f=a(5),d=a(68),h=a(33),l=a(12),k=a(1),t=a(116),n=a(21),z=a(929);class w extends F.a{constructor(m,
u){super(m,u,new z.a(e.a.listItem,e.a.zDb,e.a.CDb,e.a.DDb));this.jec=!1;this.tmb=this.Vo=null;this.NZe=!1;this.visible=void 0;this.iBa(!0);this.NZe=k.EwaSettings.isChangeGateEnabled("OfficeVSO:5893822_FixFormulaBarXOffsetCrash")}get Vac(){if(h.a.WM(this.$)){var m=document.getElementById(this.$.Bb+f.a.MZe);return!this.NZe||m?l.DOMElementExtensions.getBoundingClientRect(m).x:0}m=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddNamedRange",!1)?document.getElementById(f.a.dAd):document.getElementById(this.$.Bb+
f.a.dAd+"-"+f.a.Qwf);c.ULS.shipAssertTag(537170323,0,!!m||this.$.fK,"AutoCompleteListBox.FormulaBarXOffset : Can't find the name box combobox element.");return m?m.offsetWidth:0}get ee(){return this.tmb}set ee(m){this.tmb=m}get re(){return void 0!==this.visible?this.visible&&0<this.Vo.length:(this.visible=l.DOMElementExtensions.isVisible(this.Df))&&0<this.Vo.length}set re(m){this.visible!==m&&(l.DOMElementExtensions.setVisible(this.Df,m),l.DOMElementExtensions.setVisible(this.MTa,m),this.visible=
m);const u=n.h(this.$).view;m?this.jec||(u.Ps(this.HGa.tpc),this.jec=!0):(this.Vo.length=0,this.jec&&(u.Mq(this.HGa.tpc),this.jec=!1))}gya(){var m=460;const u=n.h(this.$);var y=u.domElement,v=this.MTa.style;const C=this.Df.offsetTop+this.Ej.offsetHeight*this.Ej.sectionRowIndex-this.Df.scrollTop;v.width="auto";v.whiteSpace="nowrap";v.position="absolute";const x=y.offsetLeft+y.offsetWidth-(this.domElement.offsetLeft+this.Df.offsetLeft+this.Df.offsetWidth+3);y=this.domElement.offsetLeft-3-(y.offsetLeft+
this.Vac);m=Math.min(this.MTa.offsetWidth,m,Math.max(x,y));l.DOMElementExtensions.Jv(this.MTa,m);v.whiteSpace="";v.position="absolute";C+3>this.Df.offsetTop+this.Df.offsetHeight||C<this.Df.offsetTop||(m=this.Df.offsetLeft-3-this.MTa.offsetWidth,v=this.Df.offsetLeft+this.Df.offsetWidth+3,l.DOMElementExtensions.updatePosition(this.MTa,y>x!==u.rtl?m:v,C,!1))}fB(m){super.fB(m);this.gya()}zt(){this.gya()}asa(){const m=this.wn,u=this.Df,y=3===d.a.zb||b.a.fp,v=y?this.vEb:this.KH;this.re=!0;u.style.height=
"auto";this.HGa.set_visible(!0);this.dob(m,y);this.Vo.length>v&&(l.DOMElementExtensions.yI(u,Math.floor(u.offsetHeight*v/this.Vo.length)),u.style.overflowY="auto");l.DOMElementExtensions.Jv(u,m.offsetWidth+(this.Vo.length>v?t.a.Bu:0))}}Object(r.a)(w,"AutoCompleteListBox",F.a,[])},1114:function(r,F,a){a.d(F,"a",function(){return n});r=a(0);var c=a(227),b=a(14),e=a(110),f=a(240);F=a(239);var d=a(747),h=a(5),l=a(51),k=a(12),t=a(74);class n extends F.a{constructor(z,w,m,u,y,v,C,x,B,H){super(document.createElement("a"));
this.cx=!1;this.fd=I=>{this.raiseEvent("ClickButton",I);return!0};this.onKeyDown=I=>{this.raiseEvent("KeyDown",I);return!1};this.Cw=()=>{this.hovered=!0;this.raiseEvent("PointerOver");return!1};this.AN=()=>{this.hovered=!1;this.raiseEvent("PointerOut");return!1};this.onBlur=I=>{t.g(I);this.focused=!1;this.raiseEvent("Blur")};this.onFocus=I=>{t.g(I);this.focused=!0;this.raiseEvent("Focus")};this.dsh=x;this.snh=B;this.HI=n.pb(this.domElement,w,m,u,y,v,C,H);this.Cc.ka("contextmenu",I=>{t.g(I)});this.enable();
this.focused=this.hovered=!1;z.appendChild(this.domElement)}mXc(z){this.get_events().addHandler("ClickButton",z)}QLd(z){this.get_events().removeHandler("ClickButton",z)}xXc(z){this.get_events().addHandler("KeyDown",z)}bMd(z){this.get_events().removeHandler("KeyDown",z)}a0b(z){this.get_events().addHandler("PointerOver",z)}lMd(z){this.get_events().removeHandler("PointerOver",z)}$_b(z){this.get_events().addHandler("PointerOut",z)}kMd(z){this.get_events().removeHandler("PointerOut",z)}kob(z){this.get_events().addHandler("Blur",
z)}QJb(z){this.get_events().removeHandler("Blur",z)}w9(z){this.get_events().addHandler("Focus",z)}uda(z){this.get_events().removeHandler("Focus",z)}get Bl(){return this.HI}get isEnabled(){return this.cx}enable(){this.domElement&&(this.domElement.classList.remove(d.a.$T),this.domElement.style.cursor="",c.a.instance.ta(b.a.click,this.domElement,this.fd),e.KeyInputManager.instance.ta(b.a.Sb,this.domElement,this.onKeyDown),f.a.instance.ta(b.a.pointerOver,this.domElement,this.Cw),f.a.instance.ta(b.a.pointerOut,
this.domElement,this.AN),this.Cc.Ci("blur")||this.Cc.ka("blur",this.onBlur),this.Cc.Ci("focus")||this.Cc.ka("focus",this.onFocus),this.domElement.title=this.dsh,this.cx=!0)}disable(){this.domElement&&(this.domElement.classList.add(d.a.$T),this.domElement.style.cursor="",this.isEnabled&&(c.a.instance.Ba(b.a.click,this.domElement,this.fd),e.KeyInputManager.instance.Ba(b.a.Sb,this.domElement,this.onKeyDown),f.a.instance.Ba(b.a.pointerOver,this.domElement,this.Cw),f.a.instance.Ba(b.a.pointerOut,this.domElement,
this.AN)),this.domElement.title=this.snh,this.cx=!1)}dispose(){this.isEnabled&&(c.a.instance.Ba(b.a.click,this.domElement,this.fd),e.KeyInputManager.instance.Ba(b.a.Sb,this.domElement,this.onKeyDown),f.a.instance.Ba(b.a.pointerOver,this.domElement,this.Cw),f.a.instance.Ba(b.a.pointerOut,this.domElement,this.AN),this.cx=!1);k.DOMElementExtensions.setVisible(this.domElement,!1);super.dispose()}static pb(z,w,m,u,y,v,C,x){z.removeAttribute("Href");z.setAttribute(h.a.Cd,h.a.Qs);z.className=w;z.tabIndex=
x;w=document.createElement("span");w.className=C;w.classList.add(m);w.tabIndex=-1;z.appendChild(w);z=document.createElement("img");z.src=l.a.qe(u);z.className=y;z.alt=v;z.tabIndex=-1;w.appendChild(z);return z}}Object(r.a)(n,"ListButton",F.a,[598,2])},1115:function(r,F,a){a.d(F,"a",function(){return d});r=a(0);var c=a(114),b=a(28),e=a(1),f=a(740);class d{constructor(k){this.awf=k;this.SV=Object.assign({},l);this.eub=[];this.Ymc=-1;(this.$vf=e.EwaSettings.isChangeGateEnabled("OfficeVSO:5999949_formulaTelemetryMetriThresholds"))&&
k&&(this.SV.countAboveThresholds={},k.forEach(t=>this.SV.countAboveThresholds[t]=0))}static get wYd(){return b.a.Ya.ue.m}aTa(){this.Ymc=d.wYd}B3(k,t=null){if(-1!==this.Ymc||Object(f.b)(t))k?(this.aob(d.wYd-(t||this.Ymc)),this.Ymc=-1):this.SV.failedCount++}JXe(){this.SV.excludingFirstAction=d.IXe(this.eub);this.eub.push(this.SV.firstAction);this.SV.includingFirstAction=d.IXe(this.eub)}aob(k){this.SV.count?1E3>this.SV.count&&this.eub.push(k):this.SV.firstAction=k;this.$vf&&this.awf&&this.awf.forEach(t=>
{k>t&&this.SV.countAboveThresholds[t]++});this.SV.count++}static IXe(k){const t=Object.assign({},h);0<k.length&&(c.i(k),t.median=k[Math.floor(.5*k.length)],t.P75=k[Math.floor(.75*k.length)],t.P95=k[Math.floor(.95*k.length)],t.max=k[k.length-1],t.average=c.g(k,n=>n)/k.length);return t}}Object(r.a)(d,"PerformanceMeasurement",null,[]);const h={average:0,max:0,median:0,P75:0,P95:0},l={count:0,countAboveThresholds:void 0,failedCount:0,firstAction:0,includingFirstAction:Object.assign({},h),excludingFirstAction:Object.assign({},
h)}},1161:function(r,F,a){function c(cb){var Mb=Object(H.h)(cb),kc=Object(U.a)(cb);const Uc=Mb.ni;var qd=Mb.mc.Jkf;qd=Mb.Ql||qd&&kc;kc=b((qd?kc:Uc).textBox.domElement);if(qd)Mb={top:0,left:0,right:innerWidth,bottom:innerHeight};else if(Mb=b(Mb.domElement),{zoom:cb}=Object(S.a)(cb),1!==cb)for(const va of[kc,Mb])for(const rb in va)va[rb]*=cb;return{target:kc,bounds:Mb}}function b(cb){const {top:Mb,left:kc,right:Uc,bottom:qd}=cb.getBoundingClientRect();return{top:Mb,left:kc,right:Uc,bottom:qd}}function e(cb){var Mb;
if(cb){var kc=new Jb(0===cb.kind);cb=null===(Mb=null===cb||void 0===cb?void 0:cb.rangeInfo)||void 0===Mb?void 0:Mb.positionKindInfo;if(!cb)return kc;kc.eF=0===cb.firstRow;kc.dF=0===cb.firstColumn;kc.aK=0===cb.secondRow;kc.$J=0===cb.secondColumn;return kc}}var f=a(9),d=a(0),h=a(709),l=a(50),k=a(37),t=a(15),n=a(19),z=a(388),w=a(68);class m{}m.wbd="!";m.$Kf="[";m.ZKf="]";m.openParen="(";m.closeParen=")";m.Qng=" /.(*\\".split("");m.Z8b="...";m.DHb="param_help_link";m.KFd="param_help_udf";m.ped="function_list_box";
m.kLh="function_param_box";m.sed="function_reader_description";m.ked="function_description_box";m.e_e="function_param_table";m.K3i="param_row_";m.rrc="param_set";m.LLf="param_row_0";m.MLf="param_row_1";m.lLh="<div id='{0}' class='{1}'></div>";m.jLh="<div id='{0}' class='{1} {2} {3}'>\r\n\t<table id='{4}'>\r\n\t\t{5}\r\n\t\t{6}\r\n\t</table>\r\n</div> ";m.NLf="<tr>\r\n\t<td id='{0}'>\r\n\t\t<span id='{0}_{1}' class='{2}'></span>\r\n\t\t<a href = '#' id='{0}_{3}' class='{4}'></a>\r\n\t\t<span id ='{0}_{5}'></span>\r\n\t</td>\r\n</tr>";
m.hLh="<div id='{0}' class='{1} {2} {3}'></div>";m.dLh="<div id='{0}' class='{1} {2} {3} {4}'></div>";m.cqf="[@";m.Iah=1;m.Hah=3;m.Nkh=500;m.wvf=50;Object(d.a)(m,"FormulaAssistanceConstants",null,[]);var u=a(13),y=a(285),v=a(8),C=a(5),x=a(94),B=a(11),H=a(21),I=a(357),U=a(117),S=a(34),G=a(105),D=a(187),E=a(1);const N=(cb,Mb,kc)=>{if(cb){const Uc=cb.da.Aa(491);Uc?Uc.YI("lm"):t.ULS.sendTraceTag(523551513,0,50,"FormulaAssistanceExtensions: logHelpLinkClick getService returned a null formulaAssistanceManager");
kc?L(cb,Mb,kc):(kc=new x.a(-859308420,w.a.zb,cb.xc,0,null),cb.Ia.Hb(kc,{[w.a.Kc]:C.a.WU,[w.a.Pf]:"HelpID="+Mb}))}},M=(cb,Mb,kc)=>{const Uc={};Uc[C.a.wM]=Mb;Mb={};Mb.FunctionName=kc;Uc[C.a.acd]=Mb;cb.Yc(802602464,0,8,Uc)},L=(cb,Mb,kc)=>{if(kc){if(Mb&&(!Mb||Mb.startsWith("http://")||Mb.startsWith("https://"))){if(cb.ra(147)){let Uc;if(E.EwaSettings.isChangeGateEnabled("OfficeVSO:7574381_RemoveResolveSyncV2"))Uc=D.a.TKa(G.l);else try{Uc=D.a.hAa(G.l)}catch(qd){}if(Uc&&Uc.OBa(Mb))return}B.HelperMethods.gf(Mb,
"_blank",I.a)}}else B.HelperMethods.LV(cb.WF,"XLWAEndUser_"+Mb,cb.mS)},aa=cb=>{let Mb=v.a.v_;const kc=cb.da.Aa(368);kc&&!Object(H.h)(cb).Ql&&(Mb=kc.zoom);return Mb};var V=a(265),P=a(4),ba=a(30),Y=a(740);class Z{constructor(cb){this.$=cb;this.a$d={};this.Tbb={};this.Ece=void 0;this.JQg=u.a.instance.ga(1032);this.XJd=u.a.instance.ga(1033);this.dFe=u.a.instance.ga(1031);this.eLh="InsertFunctionDialog";this.NSf="recentlyUsedFunctions";this.GHi=15;this.Mfi=()=>{this.sfa=this.$.da.Aa(19);this.sfa.eJa({Filter:null,
FilterType:2,IncludeOneOfEachGroupUI:!0},!0);this.mNe(this.Nfi,this.egi,this.wfi)};this.egi=()=>{if(this.bkf){this.xbf=this.DWh();this.Tbb=JSON.parse(this.localStorage.GKa(this.NSf));this.Tbb||(this.Tbb={});const Mb=this.Tbb[this.xbf];Mb&&(Array.isArray(Mb)&&Mb.every(this.Gpi)?this.Iza=Mb:ra("initRecentlyUsedFunctions: Recently used functions are not an array of numbers as expected"))}this.Iza||(this.Iza=this.sfa.CKa(this.dFe).map(ea))};this.Nfi=()=>{this.E0b=this.sfa.ebc.filter(this.Gkf);this.E0b.forEach(Mb=>
{this.a$d[Mb.FunctionIndex]=Mb})};this.wfi=()=>{this.categories=this.functionInfoManager.awb.filter(Mb=>Mb!==this.dFe);this.categories.unshift(this.XJd)};this.G$i=Mb=>{this.Iza?(this.Iza=this.Iza.filter(kc=>kc!==Mb).slice(0,this.GHi-1),this.Iza.unshift(Mb),this.bkf&&(this.Tbb[this.xbf]=this.Iza,this.localStorage.yMb(this.NSf,JSON.stringify(this.Tbb)))):ra("pushFunctionToRecentlyUsed: Recently used functions array was not initialized.")};this.Gkf=Mb=>!this.sfa.dic(Mb);this.mNe=(...Mb)=>{if(this.sfa.hV)Mb.forEach(kc=>
kc());else{const kc=()=>{this.sfa.qcb(kc);Mb.forEach(Uc=>{Uc()})};this.sfa.$Fa(kc)}};this.DWh=()=>{const Mb=P.AFrameworkApplication.fa.Wa("LoggableUserId");return Mb?ba.a.Yu(Mb).toString():"0"};this.Gpi=Mb=>"number"===typeof Mb&&Object(Y.b)(this.functionInfoManager.Rgd(Mb));this.localStorage=new V.a;this.bkf=this.localStorage.Fe();this.Mfi()}static instance(cb){this.La||(this.La=new Z(cb));return this.La}get functionInfoManager(){return this.sfa}get fLh(){return this.a$d}get awb(){return this.categories}get eIh(){var cb;
return null!==(cb=this.Ece)&&void 0!==cb?cb:this.XJd}CKa(cb){this.Ece=cb;return cb===this.XJd?this.Iza:this.sfa.CKa(cb).filter(this.Gkf).map(ea)}IGh(cb=""){cb=cb.toLocaleLowerCase();const Mb=this.E0b.filter(({NameUI:kc})=>kc.toLocaleLowerCase().startsWith(cb));3<=cb.length&&(Mb.push(...this.E0b.filter(kc=>kc.NameUI.toLocaleLowerCase().includes(cb)&&!Mb.includes(kc))),Mb.push(...this.E0b.filter(kc=>kc.Help.toLocaleLowerCase().includes(cb)&&!Mb.includes(kc))));return Mb.map(ea)}}Object(d.a)(Z,"FunctionDialogUtils",
null,[]);const ea=cb=>cb.FunctionIndex,ra=cb=>{t.ULS.sendTraceTag(509670041,0,10,`FunctionDialogUtils.${cb}`)};var O=a(266),da=a(22),xa;(function(cb){cb.functionInfo="functionInfo";cb.giveFeedbackCallback="giveFeedbackCallback";cb.listSeparator="listSeparator"})(xa||(xa={}));Object(d.b)("SignatureDialogPropKeys",xa);class ia extends y.a{static show(cb,Mb){cb=Z.instance(Mb).functionInfoManager.Rgd(cb);new ia(cb,Mb)}constructor(cb,Mb){super(Mb);this.functionInfo=cb;this.Spg=(kc,Uc)=>{1===kc?(this.hide(),
kc=new x.a(1117706454,0,this.$.xc,8,null),this.$.Ia.Hb(kc,{[Qa.dbc]:Uc.selectedFunctionInfo,["argumentsDialogSource"]:2})):2===kc&&(this.hide(),Uc=new x.a(753860909,0,this.$.xc,8,null),this.$.Ia.Hb(Uc))};this.$Cd=kc=>{this.hide();M(this.$,"functionSignatureDialog",kc)};this.el=u.a.instance.ga(1034);this.Nnd()}Nnd(){this.initializeAndShow(this.el,this.Spg,{[ia.it]:this.kc,[xa.functionInfo]:this.functionInfo,[xa.giveFeedbackCallback]:this.$Cd.bind(this),[xa.listSeparator]:this.$.listSeparator})}get kc(){return"FunctionSignatureDialog"}}
Object(d.a)(ia,"FunctionSignatureDialog",y.a,[]);var Ma;(function(cb){cb[cb.FunctionsDialog=0]="FunctionsDialog";cb[cb.RibbonButton=1]="RibbonButton";cb[cb.SignatureDialog=2]="SignatureDialog"})(Ma||(Ma={}));Object(d.b)("ArgumentsDialogSource",Ma);class Ta extends y.a{static show(cb,Mb,kc,Uc,qd){new Ta(cb,Mb,kc,Uc,qd)}constructor(cb,Mb,kc,Uc,qd){super(cb);this.functionInfo=Mb;this.formulaAuthoringHelper=kc;this.cag=Uc;this.pTg=qd;this.aLh=(va,rb)=>{var fc;this.hide();if(1===va){va=this.functionInfo.NameUI;
for(rb=null!==(fc=rb.functionArgs)&&void 0!==fc?fc:[];1<rb.length&&da.a.lh(rb[rb.length-1]);)rb.pop();fc={[w.a.Kc]:va,["functionArgs"]:rb,["ibdk"]:!0};rb=new x.a(-433697611,0,this.$.xc,8,null);this.$.Ia.Hb(rb,fc)}else if(2===va)switch(this.pTg){case Ma.FunctionsDialog:fc=new x.a(753860909,0,this.$.xc,8,null);this.$.Ia.Hb(fc);break;case Ma.SignatureDialog:ia.show(this.functionInfo.FunctionIndex,this.$)}};this.LV=()=>L(this.$,this.functionInfo.HelpId,!1);this.kWh=()=>this.formulaAuthoringHelper.hasRepeatingParams(this.functionInfo)?
va=>this.formulaAuthoringHelper.getFunctionParamByIndex(this.cag,this.functionInfo,va):void 0;this.feedbackCallback=va=>M(this.$,"functionArgumentsDialog",va);this.el=u.a.instance.ga(1034);this.rangePickerController=Object(H.h)(this.$).Gg.Rxb();this.ig()}get kc(){return"FunctionArgumentsDialog"}ig(){this.Ob=1;this.wq={[O.a.it]:this.kc,["functionInfo"]:this.functionInfo,["initialArgs"]:this.formulaAuthoringHelper.getMinimalParamArray(this.cag,this.functionInfo),["generateArgByIndex"]:this.kWh(),["helpCallback"]:this.LV,
["giveFeedbackCallback"]:this.feedbackCallback,["isModal"]:!1,["rangePickerController"]:this.rangePickerController};this.initializeAndShow(this.el,this.aLh,this.wq)}hide(){E.EwaSettings.isChangeGateEnabled("OfficeVSO:7428201_supportStopRangePickerWithoutSupplyingTextboxId")&&this.rangePickerController.disposeRangePicker(void 0);super.hide()}}Object(d.a)(Ta,"FunctionArgumentsDialog",y.a,[]);var Da;(function(cb){cb.CategoryList="categoryList";cb.FunctionsMap="functionsMap";cb.FunctionIdsToDisplay="functionIdsToDisplay";
cb.RefreshListCallback="refreshListCallback";cb.HelpCallback="helpCallback";cb.feedbackCallback="giveFeedbackCallback";cb.InitialCategory="initialCategory";cb.AllCategoryName="allFunctionsCategoryName"})(Da||(Da={}));Object(d.b)("PropsKeys",Da);class fa extends y.a{static show(cb){new fa(cb)}constructor(cb){super(cb);this.ZZe=(Mb,kc)=>{if(1===Mb){this.hide();Mb=this.functionInfoManager.r3e(kc.functionName);kc={[Qa.dbc]:Mb,["ibdk"]:!0,["argumentsDialogSource"]:0};const Uc=new x.a(0<Mb.Params.length?
1117706454:-433697611,0,this.$.xc,8,null);this.$.Ia.Hb(Uc,kc);this.utils.G$i(Mb.FunctionIndex)}};this.Nnd=()=>{const Mb=this.utils.eIh;this.wq={[fa.it]:this.kc,[Da.CategoryList]:this.utils.awb,[Da.FunctionsMap]:this.utils.fLh,[Da.FunctionIdsToDisplay]:this.utils.CKa(Mb),[Da.RefreshListCallback]:this.sVi.bind(this),[Da.feedbackCallback]:this.$Cd.bind(this),[Da.HelpCallback]:this.pci,[Da.InitialCategory]:Mb,[Da.AllCategoryName]:this.utils.JQg};this.initializeAndShow(this.el,this.ZZe,this.wq)};this.pci=
Mb=>{L(this.$,Mb,!1)};this.$Cd=Mb=>{this.hide();M(this.$,this.utils.eLh,Mb)};this.el=u.a.instance.ga(1034);this.utils=Z.instance(cb);this.ig()}get kc(){return"FunctionDialog"}get functionInfoManager(){return this.utils.functionInfoManager}ig(){this.Ob=1;this.utils.mNe(this.Nnd)}N_j(cb){this.wq[Da.FunctionIdsToDisplay]=cb;this.dUa(this.el,this.U4a(this.ZZe),this.wq)}sVi(cb,Mb){cb=Mb?this.utils.IGh(Mb):this.utils.CKa(cb);this.N_j(cb)}}Object(d.a)(fa,"FunctionDialog",y.a,[]);var ua=a(55),Fa=a(71),ca=
a(33),ka=a(89),Ca=a(27),fb=a(215),yb=a(72),mb=a(87),nb=a(229),X=a(51),R=a(750),wa=a(12),na=a(74);const Ba=yb.a.rvh,Ra=yb.a.zvh,qa=yb.a.Avh,La=yb.a.YRe,Yb=yb.a.tvh,mc=yb.a.vvh,Zb=yb.a.SRe,qb=yb.a.bSe,Ha=yb.a.uvh,Ya=yb.a.VRe;class Gb extends fb.a{constructor(cb,Mb){super(cb,u.a.instance.ga(1034),void 0,void 0,void 0,E.EwaSettings.ra(350));this.cwb=this.irf=this.g_e=this.d_e=this.lja=this.c_e=this.ewb=this.$Ja=this.mja=this.aKa=null;this.Ild=!1;this.Yyb=this.$Eb=this.k3b=null;this.onFunctionInfoLoaded=
()=>{if(!this.$Ja.count){const kc=this.functionInfoManager.awb;for(let Uc=0,qd=kc.length;Uc<qd;++Uc)this.$Ja.dY(kc[Uc],kc[Uc],!1).className=yb.a.svh;this.$Ja.selectedIndex=0;ka.a.pc([this.k3b,this.$Eb,this.Yyb]);this.k3b=this.Ae.ie(this.aKa);this.$Eb=this.Ae.ie(this.mja);this.Yyb=this.Ae.ie(this.cwb);this.k3b.ka("change",this.pDf);this.$Eb.ka("change",this.SSi);this.$Eb.ka("dblclick",this.TSi);this.Yyb.ka("click",this.Dca);this.Yyb.ka("keyup",this.ZUi);wa.DOMElementExtensions.setVisible(this.mja,
!0);wa.DOMElementExtensions.setVisible(this.c_e,!1);this.$.D7c&&wa.DOMElementExtensions.setVisible(this.irf,!0)}this.pDf(null);this.getButton(0).get_element().disabled=!1;this.aKa.disabled=!1;this.XRa();this.Ild=!0};this.Dca=()=>{this.T$&&N(this.$,this.T$.HelpId,this.T$.IsDynamicUdf)};this.ZUi=kc=>{13!==kc.keyCode&&32!==kc.keyCode||this.Dca(kc)};this.pDf=()=>{const kc=this.functionInfoManager.CKa(this.$Ja.ee.value);this.S3a(kc);this.mja.scrollTop=0;this.t4f()};this.SSi=()=>{this.t4f()};this.TSi=kc=>
{this.T$&&(na.g(kc),this.close(0))};this.Rc=(kc,Uc)=>{nb.b(Uc)&&this.dv()};this.functionInfoManager=cb.da.Aa(19);this.formulaAssistanceControl=cb.da.Aa(221);if(this.Uvb=ca.a.fV(this.$))this.formulaAssistanceManager=cb.da.Aa(464);this.qU=Mb}get kc(){return"FunctionDeprecatedDialog"}get T$(){if(!this.mja||!this.mja.firstChild)return null;const cb=Number.parseInvariant(this.mja.children[this.mja.selectedIndex].value);return this.functionInfoManager.Rgd(cb)}initialize(){this.Fb.classList.add(yb.a.qvh);
if(E.EwaSettings.isChangeGateEnabled("OfficeVSO:7262176_FunctionDeprecatedDialogReduceInnerHtml")){var cb=document.createElement("div");cb.classList.add(yb.a.RRe);var Mb=document.createElement("label");Mb.setAttribute("for",Gb.jed);Mb.innerText=u.a.instance.ga(1037)+" ";cb.appendChild(Mb);Mb=document.createElement("select");Mb.id=Gb.jed;Mb.classList.add(Ba);Mb.setAttribute("disabled","true");cb.appendChild(Mb);this.Fb.appendChild(cb);cb=document.createElement("div");cb.classList.add(mb.a.Nl);cb.innerText=
u.a.instance.ga(1038);this.Fb.appendChild(cb);cb=document.createElement("div");cb.classList.add(yb.a.QRe);Mb=document.createElement("select");Mb.id=Gb.b_e;Mb.classList.add(Ra,Ca.a.sw?qa:null,n.a.io,n.a.jo);Mb.size=7;cb.appendChild(Mb);Mb=document.createElement("div");Mb.classList.add(mc);Mb.innerText=u.a.instance.ga(735);cb.appendChild(Mb);this.Fb.appendChild(cb);cb=document.createElement("div");cb.classList.add(yb.a.TRe);Mb=document.createElement("div");Mb.classList.add(Ya);Mb.style.direction="ltr";
var kc=document.createElement("span");kc.classList.add(Ha,n.a.io);const Uc=document.createElement("span");Uc.classList.add(n.a.Or,yb.a.URe);const qd=document.createElement("img");qd.title=u.a.instance.ob(3);qd.classList.add(n.a.RUe);qd.src=X.a.qe(13);Uc.appendChild(qd);kc.appendChild(Uc);Mb.appendChild(kc);kc=document.createElement("span");kc.id=Gb.med;kc.classList.add(qb);Mb.appendChild(kc);kc=document.createElement("a");kc.tabIndex=0;kc.title=u.a.instance.ga(1039);kc.classList.add(Yb);Mb.appendChild(kc);
kc=document.createElement("span");kc.id=Gb.cbc;Mb.appendChild(kc);cb.appendChild(Mb);Mb=document.createElement("div");Mb.classList.add(Zb);Mb.id=Gb.led;cb.appendChild(Mb);this.Fb.appendChild(cb)}else this.Fb.innerHTML=Gb.MG();this.If||(this.tt(),this.Tra());super.initialize();cb=wa.DOMElementExtensions.$j(this.Fb,Ya);this.rtl&&(cb.align="right",this.cwb.style.marginLeft="5px");this.If&&(cb.style.padding="1px");this.functionInfoManager.eJa({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0)}dispose(){this.functionInfoManager&&
(this.functionInfoManager.qcb(this.onFunctionInfoLoaded),this.functionInfoManager.$.ea.ik(this.Rc));ka.a.pc([this.k3b,this.$Eb,this.Yyb,this.$Ja,this.ewb]);super.dispose()}tt(){this.aKa=wa.DOMElementExtensions.$j(this.Fb,Ba);this.mja=wa.DOMElementExtensions.$j(this.Fb,Ra);this.aKa.setAttribute(C.a.Cd,C.a.k1b);this.$Ja=new R.a(this.aKa,!0);this.ewb=new R.a(this.mja,!0);this.c_e=wa.DOMElementExtensions.$j(this.Fb,mc);this.cwb=wa.DOMElementExtensions.$j(this.Fb,Yb);this.g_e=wa.DOMElementExtensions.$j(this.Fb,
qb);this.irf=wa.DOMElementExtensions.$j(this.Fb,Ha);this.d_e=$get(Gb.cbc,this.Fb);this.lja=wa.DOMElementExtensions.$j(this.Fb,Zb);this.If&&(this.lja.style.paddingLeft="1px");this.functionInfoManager.$Fa(this.onFunctionInfoLoaded);this.functionInfoManager.$.ea.Jj(this.Rc)}DQ(cb){this.$.da.gb(40,()=>{this.$Ja.DQ(cb)})}$p(){this.Uvb?this.formulaAssistanceManager.b8b():this.formulaAssistanceControl.set_visible(!1);super.$p();this.Ild||(this.getButton(0).get_element().disabled=!0)}setFocus(){!this.aKa.disabled&&
this.Ild&&wa.DOMElementExtensions.setFocus(this.aKa)}commit(){return!0}Orb(){let cb=this.T$.NameDataStrings;const Mb=new x.a(-433697611,0,this.$.xc,8,null);this.$.Ia.Hb(Mb,{[w.a.Kc]:cb,["ibdk"]:!0})}Gsa(){this.Uvb?this.formulaAssistanceManager.Bda():this.formulaAssistanceControl.zpb()}S3a(cb){this.ewb.clear();const Mb=Gb.cbc+" "+Gb.led;for(let kc=0,Uc=cb.length;kc<Uc;++kc){const qd=this.ewb.dY(cb[kc].NameUI,cb[kc].FunctionIndex.toString(),!1);Ca.a.sw&&qd.classList.add(La);qd.setAttribute(C.a.ZL,Gb.med);
qd.setAttribute(C.a.DG,Mb)}this.ewb.selectedIndex=0}t4f(){if(this.T$){this.cwb.parentNode.className=yb.a.VRe+(this.functionInfoManager.dic(this.T$)?"-udf":"");var cb=this.T$.NameDataStrings;this.g_e.innerText=cb;this.cwb.innerText=cb;this.lja.innerText=this.T$.Help;cb=this.T$.Params.split(m.wbd);this.d_e.innerText=m.openParen+(1<cb.length?m.Z8b:cb[0])+m.closeParen}}static MG(){return String.format("<div class='"+yb.a.RRe+"'>\r\n\t<label for='{6}'>{0}</label>\r\n\t<select id='{6}' class='{9}' disabled='true'></select>\r\n</div>\r\n<div class='"+
mb.a.Nl+"'>{1}</div>\r\n<div class='"+yb.a.QRe+"'>\r\n\t<select id='{16}' class='{17} "+n.a.io+" "+n.a.jo+"' size='{8}'></select>\r\n\t<div class='{11}' >{2}</div>\r\n</div>\r\n<div class='"+yb.a.TRe+"'>\r\n\t<div style='direction:ltr' class='{15}'>\r\n\t\t<span class='{14} "+n.a.io+"'>\r\n\t\t\t<span class='"+n.a.Or+" "+yb.a.URe+"'>\r\n\t\t\t\t<img title='{3}' class='"+n.a.RUe+"' src='{4}'/>\r\n\t\t\t</span>\r\n\t\t</span>\r\n\t\t<span id='{19}' class='{13}'></span>\r\n\t\t<a tabindex='0' title='{5}' class='{10}'></a>\r\n\t\t<span id='{7}'></span>\r\n\t</div>\r\n\t<div id='{18}' class='{12}'></div>\r\n</div>",
u.a.instance.ga(1037),u.a.instance.ga(1038),u.a.instance.ga(735),u.a.instance.ob(3),X.a.qe(13),u.a.instance.ga(1039),Gb.jed,Gb.cbc,7,Ba,Yb,mc,Zb,qb,Ha,Ya,Gb.b_e,Ra+(Ca.a.sw?" "+qa:""),Gb.led,Gb.med)}}Gb.cbc="function_dialog_param_string";Gb.led="function_dialog_function_description";Gb.med="function_dialog_function_name";Gb.b_e="function_list";Gb.jed="function_category";Object(d.a)(Gb,"FunctionDeprecatedDialog",fb.a,[]);var Ja=a(7),Na=a(267);class Qa{constructor(cb,Mb,kc){this.$=cb;this.Va=Mb;this.functionInfoManager=
kc;this.gLh="FinancialFns LogicalFns TextFns DateTimeFns LookupReferenceFns MathTrigFns StatisticalFns EngineeringFns CubeFns InformationFns".split(" ");this.menuId=null;this.onFunctionInfoLoaded=()=>{this.menuId&&this.gLh.includes(this.menuId)&&this.frame.Yw(this.menuId)};this.fV=ca.a.fV(this.$);this.sBb=ca.a.zkf();this.fV&&(this.formulaAssistanceManager=this.$.da.Aa(464));this.oY={};this.frame=this.$.frame;this.functionInfoManager.$Fa(this.onFunctionInfoLoaded);this.formulaAssistanceTelemetryManager=
cb.da.Aa(491)}Hc(cb,Mb){switch(Mb){case 753860909:case -2060563418:case 1117706454:case 917756490:case -1756230110:case -1702465186:case -977299160:case 2135922458:case -1960662393:case -1999560076:case 493672674:case -1031255406:case 548833656:case 641360851:case -433697611:return cb=H.h(this.$).ni,cb.a6a||!cb.fb||0>=cb.text.length?!1:!0;default:return!1}}executeCommand(cb,Mb,kc){var Uc,qd;Mb=Mb.command;cb=H.h(this.$);const va=cb.ni;switch(Mb){case 753860909:case -2060563418:null===(Uc=this.formulaAssistanceManager)||
void 0===Uc?void 0:Uc.b8b();cb.inRangePicker&&va.qE(!1);this.sBb?fa.show(this.$):(new Gb(this.$,va)).kg();this.formulaAssistanceTelemetryManager.K3a.dialogShownCounter++;break;case 1117706454:null===(qd=this.formulaAssistanceManager)||void 0===qd?void 0:qd.b8b();cb.inRangePicker&&va.qE(!1);void 0===kc.argumentsDialogSource&&(kc.argumentsDialogSource=1,kc[Qa.dbc]=this.functionInfoManager.r3e(kc[w.a.Kc]));const rb=kc[Qa.dbc];if(rb.Params.includes("!")){ia.show(rb.FunctionIndex,this.$);break}const fc=
da.a.OUf(rb.Params).split(this.$.listSeparator).filter(xd=>"..."!==xd);k.TaskExtensions.c3(l.GetServiceTaskFactory.Oa(this.$.da,520,521,0),xd=>{Ta.show(this.$,rb,xd.result,fc,kc.argumentsDialogSource)},this.$.la,3);kc.ibdk?this.formulaAssistanceTelemetryManager.K3a.argsDialogOpenedByDialogCounter++:this.formulaAssistanceTelemetryManager.K3a.argsDialogOpenedByRibbonCounter++;break;case -433697611:Uc=kc.functionArgs;kc.ibdk&&(void 0!==Uc?this.formulaAssistanceTelemetryManager.K3a.argsDialogCommitedCounter++:
this.formulaAssistanceTelemetryManager.K3a.dialogCommitedCounter++);let Nc=kc[w.a.Kc]+m.openParen;this.sBb&&(void 0!==Uc&&(Nc+=Uc.join(this.$.listSeparator)),Nc+=m.closeParen);kc.UILocation&&this.$.Yc(-1075437823,-1,0,null);cb.view.visibleArea.contains(cb.xg(null))||cb.pv(cb.ha.qa.activeCell,3,"FormulaAssistanceCommandHandler.ExecuteCommand");const hd=va.textBox;Uc=va.textBox.caretPosition;va.fb?(qd=va.text,Mb=Uc?qd.substring(0,Uc):"=",va.text=Mb+Nc+qd.substring(Uc+(hd.qy?hd.qy.length:0),qd.length),
hd.caretPosition=Mb.length+Nc.length):this.sBb?cb.setCell(Object(Ja.a)(new Na.a,{Text:`=${Nc}`}),cb.ha.qa.activeCell,0,127,null):k.TaskExtensions.za(cb.startEdit(!0,1),()=>{va.text="="+Nc;const xd=Nc.length+1;hd.Fdb(xd);hd.caretPosition=xd},this.$.la,11,Fa.a.current);cb.Ql&&(cb=cb.Vb,cb.text=hd.text,cb.setCaretPosition(hd.caretPosition));this.fV?this.formulaAssistanceManager.Bda():(cb=va.v2.get(z.a.dwb),null===cb||void 0===cb?void 0:cb.wY(!1));break;case -1334919469:N(this.$,"154468",!1)}return ua.Task.Sa(!0)}wc(cb,
Mb){switch(Mb.command){case 753860909:case -2060563418:case -433697611:case -1334919469:return!0;case 1117706454:return this.sBb;default:return!1}}cMh(cb,Mb){Mb=this.Va.uq(Mb);const kc=this.Va.Ec();var Uc=this.functionInfoManager.CKa(cb);if(!Uc)return t.ULS.sendTraceTag(537162067,0,15,"FormulaAssistanceCommandHandler.GenerateFunctionMenu: functionList is null"),Mb.oE();const qd=this.sBb?1117706454:-433697611;for(let va=0;va<Uc.length;++va){const rb=Uc[va].NameUI,fc=this.Va.JP(280,"Formulas."+cb+"MenuItem_"+
Uc[va].FunctionIndex.toString(),qd,null,1,"None",0,0,rb,!1,0);fc.label=rb;const Nc=Uc[va].Params.split(m.wbd);fc.TR(rb+" "+(m.openParen+(1<Nc.length?m.Z8b:Nc[0])+m.closeParen)+"\n"+Uc[va].Help);kc.buttons.push(fc)}cb=this.Va.Ec();Uc=this.Va.JP(280,"Formulas.MoreFunctionsMenuItem",-2060563418,n.a.hVe,3,"Image16by16",1036,0,"Formulas.MoreFunctionsMenuItem",!1,0);cb.buttons.push(Uc);Mb.rc.push(kc);Mb.rc.push(cb);return Mb.oE()}Nc(cb,Mb,kc){cb=this.cWh(Mb);if(-1===cb)return!1;this.menuId=kc.MenuId;if(!this.functionInfoManager.hV)return this.functionInfoManager.eJa({Filter:null,
FilterType:2,IncludeOneOfEachGroupUI:!0},!0),!1;cb=this.functionInfoManager.awb[cb];this.oY[cb]=this.oY[cb]||this.cMh(cb,kc.MenuId);kc.MenuItems=this.oY[cb];return!0}cWh(cb){switch(cb){case "PopulateFinancialFnsMenu":return 2;case "PopulateLogicalFnsMenu":return 9;case "PopulateTextFnsMenu":return 8;case "PopulateDateTimeFnsMenu":return 3;case "PopulateLookupReferenceFnsMenu":return 6;case "PopulateMathTrigFnsMenu":return 4;case "PopulateStatisticalFnsMenu":return 5;case "PopulateEngineeringFnsMenu":return 11;
case "PopulateCubeFnsMenu":return 12;case "PopulateInformationFnsMenu":return 10;default:return-1}}}Qa.dbc="functionInfo";Object(d.a)(Qa,"FormulaAssistanceCommandHandler",null,[222]);class Oa extends h.a{constructor(cb){super(cb)}hd(){const cb=l.GetServiceTaskFactory.create(this.$.da,102,this.la,this.Xa),Mb=l.GetServiceTaskFactory.create(this.$.da,153,this.la,this.Xa);k.TaskExtensions.za(k.TaskExtensions.Fd([cb,Mb],this.la),()=>{this.$c([new Qa(this.$,cb.result,Mb.result)])},this.la,3)}static ka(cb){h.a.Md(92,
new Oa(cb))}}Object(d.a)(Oa,"FormulaAssistanceCommandHandlerFactory",h.a,[]);var bb=a(226);class Ga{constructor(cb,Mb){this.bKa=this.Nua=this.gja=null;this.ZGf=(kc,Uc)=>{this.qdj(Uc.functionName,Uc.qed)};this.aHf=(kc,Uc)=>{this.odj(Uc.qed,Uc.eQd,Uc.L3i)};this.$Gf=(kc,Uc)=>{kc=[];for(var qd of Uc.eQd)(!this.ywa||void 0!==qd&&null!==qd)&&(Uc=qd.trim())&&kc.push(Uc);if(!this.ywa||kc.length){qd="";for(Uc=0;Uc<kc.length;Uc++){const va=this.k0c(kc[Uc]),rb=Ga.PGd(Uc,kc.length);qd+=va+rb;rb&&(qd+=this.ariaLiveNotifier.Lxa)}this.ariaLiveNotifier.readText(qd)}};
this.bHf=(kc,Uc)=>{this.ariaLiveNotifier.sdj(Uc.GF,Uc.description,Uc.selectedIndex.toString(),Uc.length.toString())};this.VGf=(kc,Uc)=>{this.ariaLiveNotifier.cSf(Uc.description,Uc.length)};this.jDf=()=>{this.ariaLiveNotifier.Ibb(u.a.instance.ga(883),C.a.DGa)};this.bDf=()=>{this.ariaLiveNotifier.readText(u.a.instance.ga(884))};this.eDf=()=>{this.ariaLiveNotifier.readText(u.a.instance.ga(885))};this.$=Mb;this.ariaLiveNotifier=cb;this.$.da.Ha(219,this);this.ywa=ca.a.D4(Mb)}dispose(){this.C_d();this.bKa=
this.Nua=this.gja=null}LZc(cb){cb&&(this.gja=cb,this.gja.Oqe(this.ZGf),this.gja.Gre(this.aHf),this.ywa&&this.gja.Fre(this.$Gf))}MZc(cb){cb&&(this.Nua=cb,this.ywa&&(this.Nua.Mqe(this.jDf),this.Nua.Kqe(this.bDf)),this.Nua.Lqe(this.eDf))}NZc(cb){cb&&(this.bKa=cb,this.bKa.NXc(this.bHf),this.bKa.S_b(this.VGf))}C_d(){var cb,Mb,kc;this.gja&&(this.gja.uWf(this.ZGf),this.gja.SWf(this.aHf),this.ywa&&this.gja.RWf(this.$Gf));this.bKa&&(this.bKa.qMd(this.bHf),this.bKa.Ruc(this.VGf));this.ywa&&(null===(cb=this.Nua)||
void 0===cb?void 0:cb.tWf(this.jDf),null===(Mb=this.Nua)||void 0===Mb?void 0:Mb.rWf(this.bDf));null===(kc=this.Nua)||void 0===kc?void 0:kc.sWf(this.eDf)}qdj(cb,Mb){if(Mb){let kc="";this.ywa||(kc+=u.a.instance.ob(57)+this.ariaLiveNotifier.Lxa);for(let Uc=0;Uc<Mb.length;Uc++)kc+=cb+this.ariaLiveNotifier.Lxa+this.k0c(Mb[Uc])+Ga.PGd(Uc,Mb.length);this.ywa&&(kc+=u.a.instance.ga(882)+this.ariaLiveNotifier.Lxa);this.ariaLiveNotifier.readText(kc)}}odj(cb,Mb,kc){if(cb){let qd="",va=0;if(Mb){for(let rb=0;rb<
Mb.length;rb++){if(kc>=cb[rb].split(this.$.listSeparator).length){va++;continue}var Uc=Mb[rb].trim();if(!Uc)return;Uc=this.k0c(Uc);const fc=Ga.PGd(rb-va,Mb.length-va);qd+=Uc+fc;fc&&(qd+=this.ariaLiveNotifier.Lxa)}this.ariaLiveNotifier.readText(qd)}}}k0c(cb){if(!cb)return"";var Mb=cb.split(this.$.listSeparator);cb="";for(const kc of Mb){if(Ga.rqd(kc))cb+=kc;else{const Uc=(Mb=Ga.Xri(kc))?kc.replace("[","").replace("]",""):kc;cb+=String.format(Mb?u.a.instance.ob(59):u.a.instance.ob(58),Uc)}cb+=this.ariaLiveNotifier.Lxa}return cb}static PGd(cb,
Mb){return cb>=Mb||1===Mb?(t.ULS.shipAssertTag(537161997,0,cb<Mb,"FormulaAssistanceControl.PositionInList: requested item index >= list length."),""):String.format(u.a.instance.ob(55),cb+1,Mb)+"\r\n"}static rqd(cb){return da.a.contains(cb,m.Z8b,!0)}static Xri(cb){return cb.trimStart().startsWith(m.$Kf)||cb.trimEnd().endsWith(m.ZKf)}}Object(d.a)(Ga,"FormulaAssistanceReadoutHandler",null,[568,2]);class tb extends bb.a{constructor(cb){super();this.$=cb;this.Db()}create(){const cb=this.$.da;k.TaskExtensions.za(l.GetServiceTaskFactory.Oa(cb,
211,212,this.Xa),Mb=>{Mb=cb.Aa(219)||new Ga(Mb.result,this.$);this.nb(Mb)},this.la,3)}static ka(cb){cb.da.Ha(220,new tb(cb))}}Object(d.a)(tb,"FormulaAssistanceReadoutHandlerFactory",bb.a,[]);var wb=a(649),lb=a(111),db=a(1E3),Pa=a(59),ja=a(41),Ka=a(113);class ub{constructor(){this.aRa={}}ijd(cb){return this.aRa&&cb in this.aRa?this.aRa[cb]:null}kcg(cb,Mb){this.aRa||(this.aRa={});this.aRa[cb]=Mb}IZ(){this.aRa=null}}Object(d.a)(ub,"FormulaAssistanceContextualPreviewCache",null,[]);var Kb=a(60);const W=
(cb,Mb,kc,Uc,qd,va,rb=null)=>{rb=cb.Na(1,rb);rb.getPartialCalcResultsParameters=Mb;return Kb.g(cb,"GetPartialCalcResults",rb,kc,Uc,qd,va,4)};var za=a(563);class Sa{constructor(cb){this.tHi=30;this.calcManager=null;this.Ed=!1;this.qPa=this.SHb=this.Fab=null;this.Dw=()=>{this.qha.IZ()};this.$=cb;this.qha=new ub;this.YYf=-1;this.$.ea.oA(this.Dw)}dispose(){this.Ed||(this.$&&(this.$.ea.uB(this.Dw),this.$=null),this.qha=this.SHb=null,this.Ed=!0)}Lfd(cb,Mb,kc,Uc){if(Mb&&0>=Mb.length)throw Error.argumentNull("GetContextualFormulaPreviewResults - currentFormula is null or empty");
if(!cb)throw Error.argumentNull("GetContextualFormulaPreviewResults - formulaSubExpressionObject is null");this.calcManager=Object(za.a)({W5:266,new:G.b,registry:this.$.da,O3:E.EwaSettings.gX});if(!this.calcManager)throw Error.invalidOperation("GetContextualFormulaPreviewResults failed - No CalcManager");let qd="="+Mb.substring(kc.start,kc.end);E.EwaSettings.ra(512)&&(qd=this.calcManager.v4h(H.h(this.$).ha.qa.activeCell,cb,kc));const va=this.kSh(qd,kc);if(E.EwaSettings.ra(512)){if(va&&!this.calcManager.isFormulaSubExpressionVolatile(cb))return Promise.resolve(va)}else if(va)return Promise.resolve(va);
return this.mSh(qd,kc).then(rb=>{if(this.h2c(Uc))throw Error.create("OperationCanceledException");if(!rb||rb.gqj||rb.ina.startsWith("##UNSUPPORTED:"))return this.L1e(Mb,qd,kc,Uc);this.qha.kcg(qd,rb.ina);return Promise.resolve(rb)})}kSh(cb,Mb){return(cb=this.qha.ijd(cb))?new db.a(cb,Mb.start,Mb.end,0):null}mSh(cb,Mb){if(!cb||0>=cb.length||!Mb)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");return this.calcManager.g0g(H.h(this.$).ha.qa.activeCell,
cb,this.tHi,Mb)}L1e(cb,Mb,kc,Uc){if(!cb||0>=cb.length||!Mb||0>=Mb.length||!kc)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");if(this.qPa)return this.lSh(cb,Mb,kc,Uc);const qd={};qd.PartialFormula=Mb;qd.Formula=cb;qd.SourceRange=ja.v(H.h(this.$).ha.qa.activeCell,this.$);return this.qPa=new Promise((va,rb)=>{this.SHb=new wb.a;this.YYf=this.$.ea.se;this.Fab=W(this.$.oa.xa,qd,fc=>{this.z1i(Mb,kc,Uc,fc,va,rb)},fc=>{this.Fab=
this.qPa=null;rb(fc)},null,null,null);this.SHb.token.register(()=>{this.Q1g(rb)})})}z1i(cb,Mb,kc,Uc,qd,va){this.Fab=this.qPa=null;if(this.YYf!==this.$.ea.se)va(Error.create("OperationCanceledException"));else if(Uc.Result)if(Uc=Pa.a.Xh(Uc.Result),!Uc||lb.a.isEmpty(Uc))qd(null);else{for(let rb in Uc)this.qha.kcg(rb,Uc[rb]);this.h2c(kc)?va(Error.create("OperationCanceledException")):(cb=this.qha.ijd(cb))?(""===cb&&(cb=" "),qd(new db.a(cb,Mb.start,Mb.end,0))):va(Error.create("SubexpressionNotFoundException"))}else qd(null)}lSh(cb,
Mb,kc,Uc){return new Promise((qd,va)=>{this.qPa.then(()=>{this.KZf(cb,Mb,kc,Uc,qd,va)}).catch(()=>{this.KZf(cb,Mb,kc,Uc,qd,va)})})}KZf(cb,Mb,kc,Uc,qd,va){if(this.h2c(Uc))va(Error.create("OperationCanceledException"));else{const rb=this.qha.ijd(Mb);rb?qd(new db.a(rb,kc.start,kc.end,0)):this.L1e(cb,Mb,kc,Uc).then(fc=>{qd(fc)}).catch(fc=>{va(fc)})}}Q1g(cb){this.Fab&&(Ka.a.Nt(this.Fab.Rs)?(this.qPa=this.Fab=null,cb(Error.create("PendingWebReqeuestCancelled"))):t.ULS.sendTraceTag(537162063,0,10,"Failed to cancel the pending web request!"))}IZ(){this.R1g();
this.qha&&this.qha.IZ()}R1g(){this.SHb&&this.SHb.cancel()}h2c(cb){return this.Ed||cb.cK}}Object(d.a)(Sa,"FormulaAssistanceContextualPreviewCalculator",null,[2]);var Wa=a(160),ab=a(217);class ma{}ma.cwh="ewa-facp-text-box";Object(d.a)(ma,"CssClassNames",null,[]);class ha{constructor(cb){this.Gqa=this.lTa=this.L2a=this.IP=this.F$=this.eb=null;this.sld=!1;this.Pc=cb}dispose(){(this.F$||this.IP)&&this.dcf();this.eb=this.Gqa=null}z_j(cb,Mb,kc,Uc){cb&&Mb&&Uc&&Mb.ina&&!(1>Mb.ina.length)&&(this.eb=cb,this.uVf(),
this.L2a=Mb,this.lTa=Uc,this.wIj(Mb,kc,Uc))}dcf(){this.Cci();this.uVf();this.lTa=this.L2a=null}wIj(cb,Mb,kc){if(cb.ina&&!(1>cb.ina.length)){var Uc=Object(za.a)({W5:266,new:G.b,registry:this.Pc.da,O3:E.EwaSettings.gX});if(Uc){var qd=Uc.rYh();qd&&k.TaskExtensions.za(this.HDb,()=>{if(Mb)if(E.EwaSettings.ra(512)&&this.eb.fb&&0<kc.length){this.hzb(cb.YJa,kc[0].start,null);var va=this.a8e(kc[0],qd),rb=this.eb.text.substring(kc[0].start,kc[0].end).trim();rb=this.eb.text.indexOf(rb);rb=this.eb.text.substring(0,
rb).lastIndexOf("\n");this.hzb(0>rb||1>=kc.length?kc[0].start:rb+1,kc[0].end,va?String.format(va,.3):null);for(var fc=1;fc<kc.length;fc++)va=this.a8e(kc[fc],qd),rb=this.eb.text.substring(kc[fc].start,kc[fc].end).trim(),rb=this.eb.text.indexOf(rb),rb=this.eb.text.substring(kc[fc-1].end,rb).lastIndexOf("\n"),this.hzb(0>rb?kc[fc-1].end:rb+1+kc[fc-1].end,kc[fc].end,va?String.format(va,.3):null);rb=this.eb.text.substring(kc[kc.length-1].end,cb.Pua).indexOf("\n");this.hzb(0>rb?kc[kc.length-1].end:rb+1+
kc[kc.length-1].end,cb.Pua,null);t.ULS.sendTraceTag(537162061,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Colored highlighting and partial evaluation completed")}else this.hzb(cb.YJa,cb.Pua,null),t.ULS.sendTraceTag(537162060,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Default highlighting and partial evaluation completed");this.F$||(this.F$=document.createElement(ab.a.div),this.eb.textBox.domElement.appendChild(this.F$));
this.IP||(this.IP=document.createElement(ab.a.div),this.IP.className=ma.cwh,this.Pc.domElement.appendChild(this.IP));va=cb.Pua;E.EwaSettings.ra(512)&&this.eb.fb&&kc&&0<kc.length&&kc[0].start<va&&kc[0].start!==cb.YJa&&!this.eb.textBox.qy.length&&(va=kc[0].start);fc=da.a.contains(this.eb.textBox.Je.id,"FormulaBar",!0)&&da.a.contains(this.eb.text.substring(cb.YJa,cb.Pua),"\n",!0);rb=this.eb.fb?this.eb.textBox.caretPosition:0;va=excelOnline.utils.getBoundingRectForText(this.eb.textBox.Je,fc?rb:cb.YJa,
fc?rb:va,E.EwaSettings.ra(512));this.IP.style.left=B.HelperMethods.sc(va.left);this.IP.style.top=B.HelperMethods.sc(va.top);this.IP.style.width=B.HelperMethods.sc(va.width);this.IP.style.height=B.HelperMethods.sc(va.height);dialogControls.renderToolTip(this.F$,`FormulaAssistancePreviewToolTip_${cb.Pua}_${cb.Pua}`,cb.ina,this.IP,0,!1,!1,1)},this.Pc.la,3)}}}a8e(cb,Mb){const kc=this.eb.text;var Uc=kc.substring(cb.start,cb.end);Uc=Uc.trim();cb=kc.indexOf(Uc,cb.start);Mb=kc.indexOf(Mb,cb);Uc=kc.substring(cb,
Mb);Uc=Uc.trim();return this.eb.colors.getItem(cb+"-"+(cb+Uc.length))}Cci(){this.eb&&this.F$&&this.IP&&k.TaskExtensions.za(this.HDb,()=>{this.eb.textBox.domElement.contains(this.F$)&&(dialogControls.clearToolTip(this.F$),this.eb.textBox.domElement.removeChild(this.F$),this.F$=null);this.Pc.domElement.contains(this.IP)&&(this.Pc.domElement.removeChild(this.IP),this.IP=null)},this.Pc.la,3)}hzb(cb,Mb,kc){!this.eb||cb>=Mb||(this.eb.textBox.formatText(cb,Mb-cb,{["background"]:kc||"#E3DDCC"}),this.sld=
!0)}uVf(){if(this.eb&&this.L2a&&this.sld){var cb=this.L2a.Pua;E.EwaSettings.ra(512)&&0<this.lTa.length&&this.lTa[this.lTa.length-1].end>cb&&(cb=this.lTa[this.lTa.length-1].end);this.eb.textBox.formatText(this.L2a.YJa,cb-this.L2a.YJa,{["background"]:!1});this.sld=!1}}get HDb(){if(this.Gqa)return this.Gqa;const cb=new Wa.a;this.Pc.Vx(Mb=>{k.TaskExtensions.za(Mb.gwd(),()=>{cb.setResult(!0)},this.Pc.la,3)});return this.Gqa=cb.task}}Object(d.a)(ha,"FormulaAssistanceContextualPreviewControl",null,[2]);
var eb=a(84),ta=a(48),ya=a(44);class sb{constructor(cb){this.C7=0;this.Rdd=cb}F9f(cb,Mb,kc){kc?this.Mch(cb,Mb,kc):this.g$e(cb,Mb,kc,!0)}Koj(){this.C7=0}Mch(cb,Mb,kc){this.C7++;const Uc=this.C7;ta.a.instance.create(()=>{this.g$e(cb,Mb,kc,Uc===this.C7)},500,ya.a.eKh,!0,!0)}g$e(cb,Mb,kc,Uc){const qd=this.Rdd.Lfd(cb,Mb);qd&&qd.then(va=>{Uc&&this.Rdd.ard(Mb)&&this.Rdd.y_j(cb,va,kc)}).catch(va=>{va=Object(eb.a)(Error,va);"OperationCanceledException"===va.message?t.ULS.sendTraceTag(537162059,0,50,`GetContextualFormulaPreviewResults - caught exception: ${va}`):
t.ULS.sendTraceTag(537162058,0,10,`GetContextualFormulaPreviewResults - caught exception: ${va}`)})}}Object(d.a)(sb,"FormulaAssistanceContextualPreviewHoverManager",null,[]);var Qb=a(177);class oc{constructor(cb){this.Tsb=this.oha=this.calcManager=this.eb=null;this.w$a=()=>{this.D5a(!1,!1)};this.$=cb;this.Tvb=new ha(cb);this.Sac=new Sa(cb);this.Tac=new sb(this);H.h(cb).Vb.Km(this.w$a);this.$.da.Ha(317,this)}dispose(){this.j1c();ka.a.pc([this.Tvb,this.Sac]);this.Tac=this.Sac=this.Tvb=null;this.$&&
H.h(this.$).Vb.$l(this.w$a);this.oha=this.eb=this.$=null}xIj(cb,Mb){Mb&&Qb.f(Mb.text)&&!(Mb.Lwa||Mb.textBox.qy||this.eb&&this.eb.textBox.qy)&&(this.eb=Mb,this.calcManager=Object(za.a)({W5:266,new:G.b,registry:this.$.da,O3:E.EwaSettings.gX}))&&(t.ULS.sendTraceTag(537162056,0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnHover: Highlighting and partial evaluation initiated"),cb=B.HelperMethods.Gwb(cb),cb=this.calcManager.s4h(H.h(this.$).ha.qa.activeCell,this.eb.text,cb.x,
cb.y),Mb=this.calcManager.getSubExpressionSpan(cb),!Mb||Mb.end<=Mb.start||this.ard(Mb)||(this.oha=Mb,this.Tac.F9f(cb,Mb,!0)))}JUd(cb){if(cb&&Qb.f(cb.text))if(cb.textBox.qy&&cb.textBox.qy.trim()){if(this.eb=cb,this.calcManager=Object(za.a)({W5:266,new:G.b,registry:this.$.da,O3:E.EwaSettings.gX})){t.ULS.sendTraceTag(537162054,0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnSelection: Highlighting and partial evaluation initiated");cb={};var Mb=this.eb.textBox.qy.trim();
cb.start=this.eb.text.indexOf(Mb,this.eb.textBox.caretPosition);cb.end=cb.start+Mb.length;(Mb=this.calcManager.getFormulaSubExpressionObject(H.h(this.$).ha.qa.activeCell,this.eb.text,this.eb.textBox.qy))&&!this.ard(cb)&&(this.oha=cb,this.Tac.F9f(Mb,cb,!1))}}else this.D5a(!1,!0)}D5a(cb,Mb){!this.eb||Mb&&this.eb.textBox.qy||(this.oha=null,cb&&(this.j1c(),this.Sac.IZ(),this.Tac.Koj()),this.Tvb&&this.Tvb.dcf(),this.eb.Lwa||(this.eb.Lwa=!1,this.eb=null))}Lfd(cb,Mb){if(!this.eb||this.eb.Lwa)return null;
this.j1c();this.Tsb=new wb.a;return this.Sac.Lfd(cb,this.eb.text,Mb,this.Tsb.token)}y_j(cb,Mb,kc){this.Tsb=null;!cb||!Mb||!Mb.ina||0>=Mb.ina.length?this.D5a(!1,!1):(cb=this.calcManager.t4h(H.h(this.$).ha.qa.activeCell,cb,this.eb.text),this.Tvb.z_j(this.eb,Mb,kc,cb))}ard(cb){return this.oha?cb.start===this.oha.start&&cb.end===this.oha.end&&cb.pre===this.oha.pre&&cb.post===this.oha.post:!1}j1c(){this.Tsb&&this.Tsb.cancel()}}Object(d.a)(oc,"FormulaAssistanceContextualPreviewManager",null,[584,2,585]);
var kb=a(227),jb=a(14),Wb=a(192),wc=a(1111),Jc=a(64),zc=a(786),gd=a(31),Va=a(24),Eb=a(65),hc=a(284),Ab=a(250),Bb=a(167);class ec{constructor(cb=!1){this.MS=0;this.Uae=!1;this.hWa=this.vce=null;this.xzg=cb;this.textEdit=null}e5f(cb){this.MS=0;this.Uae=cb.IsCompatibility;this.set_name(cb.NameDataStrings);this.hWa=cb.Help}Lyj(cb){this.MS=1;this.set_name(cb.Name)}nyj(cb){this.MS=2;this.set_name(cb.name);this.hWa=cb.tooltip}Rzj(cb){this.MS=3;this.set_name(cb.name);this.hWa=cb.toolTip}B6f(cb){this.MS=4;
this.set_name(cb.name)}iCj(cb){this.MS=5;this.set_name(cb.name);this.hWa=cb.toolTip}hCj(cb){this.MS=7;this.set_name(cb.name)}IAj(){this.MS=6;this.set_name(u.a.instance.ob(192));this.hWa=u.a.instance.ob(193)}get itemType(){return this.MS}get tni(){return this.Uae}get name(){return this.label}set_name(cb){return this.vce=cb}get label(){return this.vce}get lja(){return this.hWa}get cCb(){return this.xzg}static ghh(){return Object(Ja.a)(new ec(!0),{})}}Object(d.a)(ec,"AutoCompleteItem",null,[631]);class Qd{constructor(){this.sheetName=
this.namedRange=this.tooltip=this.name=null;this.type=0}}Object(d.a)(Qd,"DefinedNameInfo",null,[]);var dc=a(169);class dd{constructor(cb){this.dLe={};this.$=cb}get cLe(){const cb=[];if(!this.$.yb||!this.$.yb.items)return cb;let Mb=0;const kc=E.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest")&&ca.a.fV(this.$);for(const Uc of this.$.yb.items)if(Uc&&(3===Uc.type&&Uc.usedRange||kc&&2===Uc.type)){const qd=new Qd;qd.tooltip=Uc.sheetName+Jc.a.exclamation+Uc.usedRange.toString();
qd.name=Uc.name;qd.namedRange=this.P$g(Uc.usedRange);qd.sheetName=Uc.sheetName;qd.type=this.H$g(Uc.type);cb.push(qd);this.dLe[Uc.name.toUpperCase()]=qd;++Mb;if(!E.EwaSettings.isChangeGateEnabled("OfficeVSO:7395300_FixTableAutoCompleteMissingInfo")&&Mb===m.wvf){t.ULS.sendTraceTag(537162076,0,15,`Maximum number of defined names reached for formula assistance: ${m.wvf}`);break}}return cb}NWj(cb){var Mb=this.dLe[cb.toUpperCase()];if(!Mb)return{returnValue:!1,sheetName:"",range:null};cb=Mb.sheetName;Mb=
this.z$g(Mb.namedRange);return{returnValue:!0,sheetName:cb,range:Mb}}P$g(cb){if(null!=cb&&void 0!=cb)return{top:cb.top,left:cb.left,bottom:cb.bottom,right:cb.right,maxRows:cb.maxRows,maxColumns:cb.maxColumns,sheetName:void 0}}z$g(cb){if(null!=cb&&void 0!=cb)return new dc.a(cb.top,cb.left,cb.bottom,cb.right,cb.maxRows,cb.maxColumns)}H$g(cb){switch(cb){case 2:return 0;case 3:return 1;default:return-1}}}Object(d.a)(dd,"DefinedNameInfoManager",null,[]);var jd=a(133),md=a(268),vd=a(264),wd=a(239);class Pd extends Sys.EventArgs{constructor(cb,
Mb){super();this.functionName=cb;this.qed=Mb}}Object(d.a)(Pd,"FormulaAssistanceFunctionChangedEventArgs",Sys.EventArgs,[]);class ic extends Sys.EventArgs{constructor(cb){super();this.eQd=cb}}Object(d.a)(ic,"FormulaAssistanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);class cd extends Sys.EventArgs{constructor(cb,Mb,kc){super();this.qed=cb;this.eQd=Mb;this.L3i=kc}}Object(d.a)(cd,"FormulaAssitanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);var Hd=a(263);class he{constructor(cb,Mb,
kc,Uc,qd=null){this.ahc=this.Y0c=!1;this.$=cb;this.formulaAssistanceUIControl=Mb;this.IZe=kc;this.vuj=Uc;this.A$e=qd;this.ahc=E.EwaSettings.isChangeGateEnabled("OfficeVSO:6592066_FixAutoCompleteCardFocusBug")}get Ff(){return this.Y0c}set Ff(cb){this.Y0c!==cb&&(cb?Hd.a(this.$).Yh(this):Hd.a(this.$).Ez(this),this.Y0c=cb)}get Xd(){return this.vuj}get jc(){return this.formulaAssistanceUIControl.getRootElement(this.IZe)}ag(cb,Mb){cb=!1;Mb||(H.h(this.$).ni.textBox.ZE=!0,cb=this.formulaAssistanceUIControl.focus(this.IZe));
return cb}sh(cb){const Mb=this.jc;return!(void 0===Mb||null===Mb)&&wa.DOMElementExtensions.Af(Mb,cb)}rj(){this.A$e&&this.A$e();const cb=H.h(this.$).ni.textBox;this.selection=cb.selection;cb.removeSelection()}dk(){H.h(this.$).ni.textBox.selection=this.selection}dispose(){Hd.a(this.$).Ez(this)}}Object(d.a)(he,"FormulaAssistanceFocusManager",null,[54,2]);var Lb=a(38),Ic=a(376),Ob=a(193),Kc=a(35),Ac=a(249),Yc=a(282),td=a(931);class $d extends Lb.a{constructor(cb,Mb){super();this.exg=[];this.ued={};this.ved=
{};this.JS=null;this.A8=[];this.cKa={};this.HDf=(kc,Uc)=>{t.ULS.sendTraceTag(537161987,0,50,"FunctionInfoManager.OnGetFunctionListPartialSucceeded");this.rDf(kc,!!Uc&&1!==Uc.FilterType,!0)};this.GDf=()=>{t.ULS.sendTraceTag(537161986,0,50,"FunctionInfoManager.OnGetFunctionListPartialFailed -  reset varaible to ensure we will re-issue the webservice call");this.JS=null};this.oDf=kc=>{t.ULS.sendTraceTag(537161985,0,50,"FunctionInfoManager.OnFullFunctionListLoaded - full list was loaded");this.oKd(kc.nja,
!0,!1)};this.FDf=kc=>{t.ULS.sendTraceTag(537161984,0,50,"FunctionInfoManager.OnGetFunctionListFullSucceeded");this.rDf(kc,!0,!1)};this.rNc=this.tNc=!1;this.jb=cb;this.pluginScheduler=Mb;this.$.da.Ha(19,this)}$Fa(cb){this.addHandler("FunctionInfoLoaded",cb)}qcb(cb){this.removeHandler("FunctionInfoLoaded",cb)}UMg(cb){this.addHandler("FunctionInfoReset",cb)}bkj(cb){this.removeHandler("FunctionInfoReset",cb)}get hV(){return this.tNc}get rpi(){return this.rNc}get ebc(){var cb=this.JS,Mb=td.a(this.$);if(!Mb)return cb;
Mb=Mb.tVh();const kc=Mb.length;if(0>=kc)return cb;const Uc=[];Uc.push(...cb);for(cb=0;cb<kc;cb++){const qd=Mb[cb],va={};va.FunctionIndex=Uc.length;va.HelpId=va.GroupUI=null;va.Help=qd.description;va.IsCommonlyUsed=va.IsCompatibility=!1;va.NameDataStrings=qd.name;va.NameUI=qd.name;va.Params=null;va.ParamsHelp=null;Uc.push(va)}return Uc}get awb(){return this.A8}get $(){return this.jb}dispose(){const cb=this.$.da.Aa(268);cb&&cb.WLd(this.oDf);this.jb=null;super.dispose()}qZf(){this.raiseEvent("FunctionInfoReset")}INd(){this.qZf();
this.tNc=!1;this.JS=null;this.rNc=!0}eJa(cb,Mb=!1){if(this.hV)this.KQf();else{t.ULS.sendTraceTag(537161991,0,50,`Retrieving the list of function names for culture '${this.$.ya.UICultureTag}' from the server.`);let Uc=null;(Uc=this.$.da.Aa(268))||t.ULS.sendTraceTag(537161990,0,50,"instantaneousSupportInformationManager == null");if((null===Uc||void 0===Uc?0:Uc.nja)&&0<Uc.nja.length)E.EwaSettings.ra(114)?Uc.IJh(this.FDf):this.oKd(Uc.nja,!0,!1);else{var kc=this.$.oa.xa.Wb();cb&&(this.$.ea.Xb||Mb)&&!this.rpi&&
(Mb?Ic.a(this.$.userOperationManager,(qd,va,rb)=>Kb.o(this.$.oa.xa,cb,Yc.b(qd,this.HDf),Yc.a(va,this.GDf),rb,cb,kc),qd=>new Ob.a(130,0,qd,16),null):Kb.o(this.$.oa.xa,cb,this.HDf,this.GDf,null,cb,kc));!this.hV&&this.$.ea.Xb&&(Uc?(t.ULS.sendTraceTag(537161989,0,50,`FunctionInfoManager.EnsureFunctionInfoAsync - Functions not loaded yet, wait for them. IsFullyLoaded=${this.hV}, IsSessionActive=${this.$.ea.Xb}`),Uc.Nqe(this.oDf)):(t.ULS.sendTraceTag(537161988,0,50,"FunctionInfoManager.EnsureFunctionInfoAsync - instantaneousSupportInformationManager is null"),
Kb.o(this.$.oa.xa,{FilterType:0},this.FDf,null,null,null,kc),this.rNc=!1))}}}Rgd(cb){return 0>cb||cb>=this.JS.length?null:this.JS[cb]}Sgd(cb){return Kc.a.Fc(this.ued,cb.toUpperCase())}r3e(cb){return Kc.a.Fc(this.ved,cb.toUpperCase())}CKa(cb){return Kc.a.Fc(this.cKa,cb)}dic(cb){return!cb.GroupUI}rDf(cb,Mb,kc){const Uc=Ac.a(cb);t.ULS.sendTraceTag(537161955,0,50,`FunctionInfoManager.OnFunctionListSuceeded: areNonStatusMessagesPresentInResult=${Uc}`);Uc?(H.h(this.$).endEdit(!1,"FunctionInfoManager.OnFunctionListSuceeded"),
this.$.ea.Tn(cb.Errors)):(this.oKd(cb.Result,Mb,kc),ca.a.gV(this.$)&&!ca.a.fV(this.$)&&this.U1j())}oKd(cb,Mb,kc){t.ULS.sendTraceTag(537161954,0,50,`FunctionInfoManager.RefreshFunctionList: functionsInfo count = ${cb.length}, isCategorized = ${Mb}, partialResult = ${kc} IsFullyLoaded = ${this.hV}`);this.hV||(this.JS=cb,this.UXg(Mb),this.tNc=!kc,this.KQf())}KQf(){this.raiseEvent("FunctionInfoLoaded")}U1j(){const cb=this.ebc;this.pluginScheduler.notifier().setFunctionsInfo(cb);t.ULS.sendTraceTag(512278604,
0,50,`FuntionInfoManager.updateSchedulerFunctionArgumentAssistanceList update functions info with ${null===cb||void 0===cb?void 0:cb.length} functions}`)}UXg(cb){var Mb=u.a.instance.ga(1031),kc=[];this.cKa={};this.A8=[];this.cKa[Mb]=kc;const Uc=u.a.instance.ga(1032),qd=[];this.A8.push(Mb);this.A8.push(Uc);for(let rb=0,fc=this.JS.length;rb<fc;rb++){Mb=this.JS[rb];Mb.IsCompatibility||qd.push(Mb);var va=Mb.NameUI;const Nc=Mb.NameDataStrings;this.ued[Nc.toUpperCase()]||(this.ued[Nc.toUpperCase()]=Mb);
this.ved[va.toUpperCase()]||(this.ved[va.toUpperCase()]=Mb);if(!this.dic(Mb)){if(cb){va=Mb.GroupUI;let hd=Kc.a.Fc(this.cKa,va);hd||(hd=[],this.cKa[va]=hd,this.A8.push(va));hd.push(Mb)}Mb.IsCommonlyUsed&&kc.push(Mb);Mb.IsCompatibility||this.exg.push(Nc)}}this.cKa[Uc]=qd;cb&&($d.IUf(kc,[2,3,0,5,4,9,1,7,8,6]),kc=Array(14),kc[0]=0,kc[1]=1,kc[2]=7,kc[3]=11,kc[4]=5,kc[5]=2,kc[6]=6,kc[7]=10,kc[8]=9,kc[9]=3,kc[10]=4,kc[11]=13,kc[12]=12,kc[13]=8,$d.IUf(this.A8,kc),kc=[],kc.push(...this.A8),kc.splice(13,1),
this.A8=kc);kc=(rb,fc)=>rb.NameUI.localeCompare(fc.NameUI);this.JS=[...this.JS];this.JS.sort((rb,fc)=>rb.NameDataStrings.localeCompare(fc.NameDataStrings));for(let rb=1,fc=this.A8.length;rb<fc&&cb;rb++)this.cKa[this.A8[rb]].sort(kc);for(let rb=0,fc=this.JS.length;rb<fc;rb++)this.JS[rb].FunctionIndex=rb}static IUf(cb,Mb){const kc=[...cb];for(let Uc=0;Uc<kc.length&&Uc<Mb.length;Uc++)cb[Uc]=kc[Mb[Uc]]}}Object(d.a)($d,"FunctionInfoManager",Lb.a,[559,560,2]);var be=a(240),ke=a(96),Pe=a(49),Dd=a(724);class ge extends ke.a{constructor(cb,
Mb,kc,Uc=null){super(cb,Uc);this.s3=null;this.pOb=this.kXd=!1;this.offsetParent=this.t7=this.h2a=null;this.PLc=!1;this.SCd=qd=>this.c6(qd);this.RCd=qd=>this.rN(qd);this.gCf=qd=>{const va=B.HelperMethods.oo(qd);va.button===Sys.UI.MouseButton.leftButton&&2===qd.vb&&(this.zqd(va.target)||this.ZSa(va));return!1};this.w8d=Mb;kc&&(this.kXd=!0,be.a.instance.ta(jb.a.pointerDown,this.UNe,this.gCf));this.ifa=!1}get L8b(){return this.ifa}get UNe(){return this.w8d}get wbi(){return this.PLc}dispose(){this.kXd&&
(be.a.instance.Ba(jb.a.yj,this.UNe,this.gCf),this.kXd=!1);this.pOb&&(this.pOb=!1,be.a.instance.Ba(jb.a.Kf,this.domElement.ownerDocument.body,this.SCd),be.a.instance.Ba(jb.a.yj,this.domElement.ownerDocument.body,this.RCd));this.s3=this.w8d=null;super.dispose()}Hoe(cb){this.s3?this.s3.push(cb):this.s3=[cb]}zqd(cb){if(this.s3)for(let Mb=0,kc=this.s3.length;Mb<kc;++Mb)if(wa.DOMElementExtensions.Af(this.s3[Mb],cb))return!0;return!1}ZSa(cb){this.L8b||(this.ifa=!0,da.a.equals(this.domElement.currentStyle.position,
"absolute",!0)||(this.domElement.style.position="absolute"),this.eth(),be.a.instance.ta(jb.a.Kf,this.domElement.ownerDocument.body,this.SCd),be.a.instance.ta(jb.a.yj,this.domElement.ownerDocument.body,this.RCd),this.pOb=!0,this.drag(!0,cb))}drag(cb,Mb){na.g(Mb);var kc=new Pe.a(0,0),Uc=new Sys.UI.Point(Mb.clientX,Mb.clientY);Mb=this.domElement.parentNode;Uc=Dd.a.Gu(kc,Mb,Uc,this.isRtl());cb?(kc=Dd.a.TE(kc,Mb,this.domElement,this.isRtl()),this.h2a=Dd.a.FD(Uc,kc),this.t7=Uc,this.PLc=!1):!this.wbi&&this.sbi(Uc,
this.t7)&&(this.PLc=!0);kc=Dd.a.FD(Uc,this.h2a);Dd.a.Ldb(Mb,this.domElement,kc,this.isRtl(),cb)}fw(cb){this.pOb&&(this.pOb=!1,be.a.instance.Ba(jb.a.Kf,this.domElement.ownerDocument.body,this.SCd),be.a.instance.Ba(jb.a.yj,this.domElement.ownerDocument.body,this.RCd));na.g(cb);this.ifa=!1;this.t7=this.h2a=null}c6(cb){const Mb=B.HelperMethods.oo(cb);Mb.button===Sys.UI.MouseButton.leftButton&&2===cb.vb&&this.fw(Mb);return!1}rN(cb){2===cb.vb&&this.drag(!1,B.HelperMethods.oo(cb));return!1}sbi(cb,Mb){return Mb.x<
cb.x-2||Mb.x>cb.x+2||Mb.y<cb.y-2||Mb.y>cb.y+2}eth(){this.offsetParent=this.domElement.offsetParent||this.domElement.ownerDocument.body;wa.DOMElementExtensions.getLocation(this.offsetParent)}}Object(d.a)(ge,"BaseDraggableBehavior",ke.a,[]);class ne extends ge{constructor(cb,Mb,kc=null,Uc=!1){super(cb,Mb,!1,kc);this.fSa(Uc);this.Xi=da.a.equals("rtl",cb.dir,!0)}setVisible(cb){wa.DOMElementExtensions.setVisible(this.domElement,cb);cb||(this.domElement.style.top="auto",this.domElement.style.left="auto")}isRtl(){return this.Xi}fSa(cb){const Mb=
this.domElement.style;Mb.cursor="move";Mb.position=cb?"relative":"absolute"}}Object(d.a)(ne,"FunctionParamBoxDraggableItem",ge,[]);class ce{constructor(){this.onDismissClick=this.onFeedback=this.onHelpLink=this.onIsExpandedChange=this.onCardModeChange=null}}Object(d.a)(ce,"FormulaArgumentAssistanceCallbacks",null,[]);class we{constructor(){this.callbacks=this.functionRenderingInfo=null;this.cardMode=0;this.showCollapseText=this.isExpanded=!1}}Object(d.a)(we,"FormulaArgumentAssistanceRenderingInfo",
null,[]);var ve=a(86),Re=a(110),rf=a(156);class We{constructor(cb){this.fv=cb;this.VA=this.rSa=this.Ci=!1;this.onKeyDown=Mb=>!this.VA&&Mb.keyCode===ve.a.Kea&&Mb.altKey&&Mb.ctrlKey?(this.F2a(),Mb.stopPropagation(),Mb.preventDefault(),!0):!1;this.hla=Mb=>{if(!this.VA)return!1;if(Mb.eventName===jb.a.Sb){const kc=Mb.Ea.ctrlKey?1:Mb.Ea.shiftKey?50:10;switch(Mb.Ea.keyCode){case ve.a.Woa:this.tK(0,-kc);break;case ve.a.R7:this.tK(0,kc);break;case ve.a.S7:this.tK(-kc,0);break;case ve.a.eCa:this.tK(kc,0);break;
case ve.a.ZF:case ve.a.Lh:this.rSa=!0;break;default:return!1}}Mb.eventName===jb.a.Ld&&this.rSa&&this.vM(!0);Mb.Ea.preventDefault();return!0};this.hza=Mb=>{if(!this.VA)return!1;Mb.Ea.preventDefault();this.vM();return!0};this.onBlur=()=>{if(!this.VA)return!1;this.vM();return!0};this.to=Re.KeyInputManager.instance;this.pointerInputManager=be.a.instance}ka(cb){(this.root=cb)&&!this.Ci&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.Ci=!0)}detach(){this.root&&this.Ci&&(this.root.addEventListener("keydown",
this.onKeyDown,!0),this.Ci=!1)}F2a(){this.root&&(this.target=this.fv.TGb("move",!0),this.KWd=this.target.getBoundingClientRect(),this.VA=!0,this.rSa=!1,this.Et(),this.iya||this.Hsb(),this.target.appendChild(this.iya))}vM(cb=!1){this.fv.gpc(cb);this.VA=!1;this.FJb();this.vJb();this.KWd=this.target=void 0}Et(){this.to.capture(this.hla,null);this.pointerInputManager.ms(jb.a.pointerDown,this.target,this.hza,!0);this.target.addEventListener("blur",this.onBlur)}vJb(){this.to.releaseCapture();this.pointerInputManager.ys(jb.a.pointerDown,
this.target,this.hza,!0);this.target.removeEventListener("blur",this.onBlur)}FJb(){var cb;this.target&&(null===(cb=this.iya)||void 0===cb?void 0:cb.parentNode)===this.target&&this.target.removeChild(this.iya)}tK(cb,Mb){const kc=this.target.getBoundingClientRect();this.fv.onMove(cb+kc.left-this.KWd.left,Mb+kc.top-this.KWd.top)}Hsb(){this.iya=rf.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")}}Object(d.a)(We,"FormulaAssistanceMoveAdapter",null,[]);var Ye=a(280);class bf{constructor(cb){this.fv=
cb;this.Ci=!1}I4(){return this.Ci&&!!this.UC}Dya(cb){this.UC.style.cursor="grabbing";this.mOj=cb.clientPoint.x;this.nOj=cb.clientPoint.y;this.fv.TGb("drag");return!0}Bca(cb){this.fv.onMove(cb.clientPoint.x-this.mOj,cb.clientPoint.y-this.nOj);return!0}Aca(){this.fw()}zca(){this.fw()}ka(cb){if(this.UC=cb)this.UC.style.cursor="grab",Ye.a.instance.jW(this.UC,this),this.Ci=!0}detach(){this.Ci&&this.UC&&(this.UC.style.cursor="",Ye.a.instance.O0(this.UC,this),this.Ci=!1)}fw(){this.UC.style.cursor="grab";
this.fv.gpc()}}Object(d.a)(bf,"FormulaAssistanceDragAdapter",null,[660]);class Ve{get EFc(){return this.UJa.getWindowEdgeBuffer()+1}constructor(cb,Mb){this.UJa=cb;this.formulaAssistanceTelemetryManager=Mb;this.Ci=!1;this.BGa=E.EwaSettings.isChangeGateEnabled("OfficeVSO:7376612_argumentAssistanceOrderedActionsTelemetry");this.T0={[Za.Drag]:0,[Za.Move]:0};this.NEb=new We(this);this.$tb=new bf(this)}ka(cb,Mb,kc,Uc){this.root=cb;this.render=kc;this.dismiss=Uc;this.detach();Mb&&(this.$tb.ka(Mb),this.NEb.ka(cb.firstChild),
this.Ci=!0)}detach(){this.Ci&&(this.$tb.detach(),this.NEb.detach(),this.Ci=!1);wa.DOMElementExtensions.vf(this.placeholder)}clear(){this.UJa.setOverrideTarget(void 0);this.detach();this.wKb()}TGb(cb,Mb=!1){this.T0[cb]+=1;this.QAc=this.root.firstChild.getBoundingClientRect();this.placeholder=this.root.cloneNode(!0);cb=this.placeholder.firstChild;cb.style.animationDuration="0ms";this.root.parentElement.appendChild(this.placeholder);Mb&&(this.XPa=document.activeElement,cb.tabIndex=0,cb.focus());this.dismiss();
return cb}onMove(cb,Mb){this.placeholder.firstChild.style.transform=`translate(${Math.min(Math.max(cb,this.EFc-this.QAc.left),window.innerWidth-this.QAc.right-this.EFc)}px, ${Math.min(Math.max(Mb,this.EFc-this.QAc.top),window.innerHeight-this.QAc.bottom-this.EFc)}px)`}gpc(cb=!0){const Mb=this.placeholder.firstChild.getBoundingClientRect(),kc=this.UJa.getDirectionalHint({top:Mb.top,left:Mb.left});this.UJa.setOverrideTarget({top:1===kc?Mb.bottom:Mb.top,left:Mb.left});this.render();window.requestAnimationFrame(()=>
{wa.DOMElementExtensions.vf(this.placeholder);this.XPa&&(cb&&this.XPa.focus(),this.XPa=void 0)})}wKb(){const cb=this.T0[Za.Drag],Mb=this.T0[Za.Move];0<cb&&(this.formulaAssistanceTelemetryManager.YI("d"),this.BGa||(this.formulaAssistanceTelemetryManager.mP.argumentAssistanceDragTotalCounter+=cb),this.T0[Za.Drag]=0);0<Mb&&(this.formulaAssistanceTelemetryManager.YI("m"),this.BGa||(this.formulaAssistanceTelemetryManager.mP.argumentAssistanceMoveTotalCounter+=Mb),this.T0[Za.Move]=0)}}Object(d.a)(Ve,"FormulaAssistanceDragControl",
null,[]);var Za;(function(cb){cb.Drag="drag";cb.Move="move"})(Za||(Za={}));Object(d.b)("FormulaAssistanceDragMode",Za);class Xb extends wd.a{constructor(cb,Mb,kc,Uc,qd,va,rb){super(Xb.fKa(ca.a.D4(cb),E.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage"),rb));this.$=cb;this.pj=Mb;this.functionInfoManager=kc;this.formulaAssistanceUIControl=Uc;this.formulaAssistanceTelemetryManager=qd;this.pluginScheduler=va;this.htmlSanitizationHelper=rb;this.j2a=null;this.T9=0;this.yq=null;this.nZc=
!1;this.lla=this.Co=null;this.Nka=E.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");this.hkf=E.EwaSettings.isChangeGateEnabled("OfficeVSO:6592409_startArgumentAssistanceTimerBeforeAutocompleteCalculation");this.onCardModeChange=fc=>{this.W_d(fc);1===fc?this.formulaAssistanceTelemetryManager.YI("c"):this.formulaAssistanceTelemetryManager.YI("e")};this.IRa=fc=>{const Nc={};Nc[C.a.wM]="ArgumentAssistanceCard";const hd={};hd.FunctionName=fc.functionName;Nc[C.a.acd]=
hd;this.$.Yc(802602464,0,8,Nc)};this.$f=()=>{this.fv.clear()};this.RSi=fc=>{fc.button===Sys.UI.MouseButton.leftButton&&fc.target&&(na.g(fc),this.j2a&&this.j2a.ZSa(fc))};this.zt=()=>{void 0!==this.Co&&null!==this.Co&&this.Co()};this.Nk=ca.a.D4(cb);this.$wi=E.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage");this.Nk?(this.KRd(),this.yq=new he(this.$,this.formulaAssistanceUIControl,0,Ab.a.Qdd),E.EwaSettings.isChangeGateEnabled("OfficeVSO:7457690_ArgumentAssistanceOnEditEnded")&&
H.h(this.$).mc.Km(this.$f),this.fv=new Ve(this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager),E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&this.$.domElement.appendChild(this.domElement)):(this.j2a=new ne(this.domElement,this.$.wE,void 0,ca.a.WM(this.$)),this.Cc.ka("mousedown",this.RSi),cb=$get(m.ped,this.pj),this.pj.insertBefore(this.domElement,cb));H.h(this.$).view.Ps(this.zt)}Oqe(cb){this.addHandler("FAFunctionNameUpdated",cb)}uWf(cb){this.removeHandler("FAFunctionNameUpdated",
cb)}Gre(cb){this.addHandler("FAParameterSelectionChangedOld",cb)}SWf(cb){this.removeHandler("FAParameterSelectionChangedOld",cb)}Fre(cb){this.addHandler("FAParameterSelectionChanged",cb)}RWf(cb){this.removeHandler("FAParameterSelectionChanged",cb)}set_visible(cb){this.Nk?cb||this.a8b():Sys.UI.Control.prototype.set_visible.call(this,cb);return cb}a8b(){this.formulaAssistanceUIControl&&(this.Co=null,this.fv.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),this.lla=null,this.yq.Ff=!1)}show(cb){this.Nk||
(this.formulaAssistanceTelemetryManager.ED(["argumentAssistanceRender"]),this.j2a.setVisible(!!cb),this.formulaAssistanceTelemetryManager.gw(["argumentAssistanceRender"]),this.nZc&&(this.nZc=!1,this.formulaAssistanceTelemetryManager.iua("argumentAssistanceOverall")))}tNd(){this.formulaAssistanceTelemetryManager.ED(["argumentAssistanceOverall"]);this.formulaAssistanceTelemetryManager.ED(["argumentAssistanceComputation"]);const cb=H.h(this.$).ni,Mb={content:cb.text,caretPosition:cb.textBox.caretPosition};
(this.Nka?this.pluginScheduler.getRequester().argumentAssistance(Mb,0):this.pluginScheduler.requester().argumentAssistance(Mb)).then(kc=>{0===kc.kind?kc.payload?(this.formulaAssistanceTelemetryManager.gw(["argumentAssistanceComputation"]),this.aIj(this.xsc(kc.payload),cb.textBox.domElement)):this.a8b():this.formulaAssistanceTelemetryManager.gw(["argumentAssistanceComputation"],!1);return null})}update(cb,Mb,kc,Uc){if(!this.Nk&&cb){this.formulaAssistanceTelemetryManager.ED(["argumentAssistanceComputation",
"argumentAssistanceOverall"]);this.nZc=!0;var qd=this.$.listSeparator;try{var va=$get(m.sed,this.pj);const rb=$get(m.ked,this.pj);va.innerText="";rb.innerText="";const fc=$get(m.e_e,this.pj),Nc=cb.Params.split(m.wbd);va=[];for(let hd=0,xd=fc.rows.length;hd<xd;hd++){const ae=fc.rows[hd];wa.DOMElementExtensions.setVisible(ae,hd<Nc.length);let Wd=Nc[hd];const Ne=m.K3i+hd+"_",Ue=cb.NameDataStrings;$get(Ne+m.DHb,ae).innerText=Ue;$get(Ne+m.KFd,ae).innerText=Ue;if(Wd){const xe=Nc[hd].split(qd),Ze=Xb.rqd(xe[xe.length-
1]),tf=Xb.csi(cb);Ze&&(tf&&(2<xe.length?(xe[xe.length-2]+="1",xe[xe.length-3]+="1"):t.ULS.sendTraceTag(537162073,0,50,"pair params formula should have at least 2 params. at UpdateParameterAssistance. formula '{0}', {1} params, currentParameterIndex = {3}.",Ue,xe.length.toString(),Mb)),Xb.dSg(xe,tf,Mb,cb));Wd=xe.join(qd.toString()+" ");Nc[hd]=Wd;kc<xe.length?(va[hd]=xe[kc],t.ULS.shipAssertTag(537162072,0,!!xe[kc]&&1<=xe[kc].length,"Emphasized parameter is too short or empty selectedParameterIndex = {0}, currRowParamsArray.Length = {1}, formula name = {3}, current row = {4}",
kc,xe.length,Ue,hd),xe[kc]=`${"<b>"}${xe[kc]}${"</b>"}`,Wd=xe.join(qd.toString()+" ")):t.ULS.shipAssertTag(537162071,0,!1,"the current param index is larger than the param list count. selectedParameterIndex = "+kc+"currRowParamsArray.Length = "+xe.length+", current row = "+hd);Uc&&t.ULS.sendTraceTag(558474578,0,50,`formula '${Ue}', ${xe.length} params, isElipsis = ${Ze}, isPairsParamsFormula = ${tf}, currentParameterIndex = ${Mb}`)}this.$wi?this.htmlSanitizationHelper.Rh($get(Ne+m.rrc,ae),"("+(Wd||
"")+")"):$get(Ne+m.rrc,ae).innerHTML="("+(Wd||"")+")"}Uc?this.raiseEvent("FAFunctionNameUpdated",new Pd(cb.NameDataStrings,Nc)):this.raiseEvent("FAParameterSelectionChangedOld",new cd(Nc,va,kc));fc.className=zc.a.Iwh+(this.functionInfoManager.dic(cb)?"-udf":"")}catch(rb){throw t.ULS.shipAssertTag(558474577,0,!1,"UpdateParameterAssistance Exception. formula '{0}', {1} params. \nException: {4}",cb.NameDataStrings,Mb,rb),rb;}this.formulaAssistanceTelemetryManager.gw(["argumentAssistanceComputation"])}}dispose(){this.Nk||
(this.Cc.DC(),ka.a.Ja(this.Cc),H.h(this.$).view.Mq(this.zt),ka.a.Ja(this.j2a),this.j2a=null);this.Nk&&(ka.a.Ja(this.yq),E.EwaSettings.isChangeGateEnabled("OfficeVSO:7457690_ArgumentAssistanceOnEditEnded")&&H.h(this.$).mc.$l(this.$f));this.functionInfoManager=this.$=null;super.dispose()}xsc(cb){const Mb=new we;Mb.functionRenderingInfo=cb;Mb.cardMode=this.T9;this.UKd(Mb);return Mb}UKd(cb){cb.callbacks=new ce;cb.callbacks.onHelpLink=this.bhd(cb.functionRenderingInfo);cb.callbacks.onCardModeChange=this.onCardModeChange;
cb.callbacks.onFeedback=this.IRa}aIj(cb,Mb){if(this.formulaAssistanceUIControl){this.formulaAssistanceTelemetryManager.ED(["argumentAssistanceRender"]);const kc={};kc.zoomLevel=aa(this.$);this.formulaAssistanceUIControl.updateContext(kc);this.Co=()=>{this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,Mb,cb,()=>{})};this.Co();this.Dvc();this.Orc(cb);this.fv.ka(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),this.Co,
()=>this.formulaAssistanceUIControl.dismiss(this.domElement));this.yq.Ff=!0;this.formulaAssistanceTelemetryManager.gw(["argumentAssistanceRender"]);this.formulaAssistanceTelemetryManager.iua("argumentAssistanceOverall")}}bhd(cb){return()=>{N(this.$,cb.helpID,cb.isUDF)}}KRd(){const cb=jd.a.get(C.a.npb);this.T9=cb?parseInt(cb,10):Xb.c8c;this.formulaAssistanceTelemetryManager.M3f(this.T9)}Orc(cb){var Mb=cb.functionRenderingInfo.functionName;this.lla&&da.a.equals(this.lla,Mb,!0)?(Mb=md.a.map(cb.functionRenderingInfo.signatures,
kc=>{let Uc="";0<=kc.signatureParams.activeParam&&kc.signatureParams.activeParam<kc.signatureParams.params.length&&(Uc=kc.signatureParams.params[kc.signatureParams.activeParam]);return Uc}),this.raiseEvent("FAParameterSelectionChanged",new ic(Mb))):(this.lla=Mb,cb=md.a.map(cb.functionRenderingInfo.signatures,kc=>kc.signatureParams.params.join(", ")),this.raiseEvent("FAFunctionNameUpdated",new Pd(Mb,cb)))}W_d(cb){this.T9=cb;try{jd.a.Cv(C.a.npb,cb.toString(),vd.AFrame.M0)}catch(Mb){t.ULS.sendTraceTag(537162070,
0,15,`Failed setting ArgumentAssistanceCardCollapseState cookie with error message: ${Mb.message}`)}}Dvc(){const cb=this.formulaAssistanceUIControl.getPosition().renderDown?"rd":"ru";this.formulaAssistanceTelemetryManager.YI(cb)}static rqd(cb){return da.a.contains(cb,m.Z8b,!0)}static csi(cb){return!!cb&&da.a.x2a(cb.NameDataStrings,"IFS")}static dSg(cb,Mb,kc,Uc){try{if(!cb||2>cb.length)t.ULS.shipAssertTag(537162069,0,!1,`Requested not on elipsis function, formula '${Uc.NameDataStrings}', ${cb?cb.length.toString():
"currRowParamsArray == null"} params, isPairsParamsFormula = ${Mb}, currentParameterIndex = ${kc}.`);else{var qd=cb.pop().toString();for(let va=cb.length-1;va<kc;va++){const rb=cb[va].trim();if(Mb){const fc=cb[va-1].trim();cb.push(Xb.UMh(fc,rb))}else{const fc=Xb.bef(rb);cb.push(Xb.H_e(fc))}}cb.push(qd)}}catch(va){throw t.ULS.shipAssertTag(537162068,0,!1,`AppendNewOptionalParameters Exception. formula '${Uc.NameDataStrings}', ${cb?cb.length.toString():"currRowParamsArray == null"} params, isPairsParamsFormula = ${Mb}, currentParameterIndex = ${kc}.
Exception: ${va}`),va;}}static UMh(cb,Mb){cb=Xb.bef(cb);const kc=Xb.P5e(cb);Mb=Xb.P5e(Mb);return Xb.H_e(cb,!0,!!kc&&!!Mb&&kc!==Mb)}static bef(cb){var Mb=cb.match(Xb.LBd);cb=da.a.trimEnd(da.a.trimStart(cb,m.$Kf),m.ZKf);if(Mb&&Mb.length){Mb=Mb[Mb.length-1];const kc=Number.parseLocale(Mb)+1;cb=cb.replace(Mb,kc.toString())}else cb=`${cb}${1}`;return cb}static H_e(cb,Mb=!1,kc=!1){let Uc="[{0}]";Mb&&(Uc=kc?"[{0}":"{0}]");return String.format(Uc,cb)}static P5e(cb){return(cb=cb.match(Xb.LBd))&&cb.length?
cb[0]:null}static fKa(cb,Mb,kc){if(cb)return document.createElement("div");cb=String.format(m.NLf,m.LLf,m.KFd,zc.a.qSe,m.DHb,zc.a.pSe,m.rrc);var Uc=String.format(m.NLf,m.MLf,m.KFd,zc.a.qSe,m.DHb,zc.a.pSe,m.rrc);cb=String.format(m.jLh,m.kLh,zc.a.mTe,zc.a.huh,n.a.io,m.e_e,cb,Uc);Uc=document.createElement("div");Mb?kc.Rh(Uc,cb):Uc.innerHTML=cb;return Uc.firstChild}}Xb.LBd=RegExp("\\d+");Xb.c8c=0;Object(d.a)(Xb,"FormulaArgumentAssistanceControlDeprecated",wd.a,[630]);class ib{constructor(){this.Hha=this.Tsa=
this.Usa=!1;this.OKf=40;this.GDe=41;this.x0a=this.pFd=this.qFd=this.EHb=0;this.GBf=!0;this.WDd=!1;this.tYe=this.TPd=-1}}Object(d.a)(ib,"ParseContext",null,[]);var Rb=a(421),lc=a(930),nc=a(326),Oc=a(857),Ib=a(966);class gc extends lc.a{constructor(cb,Mb,kc,Uc){super(cb,Mb);this.formulaAssistanceControl=kc;this.formulaAssistanceTelemetryManager=Uc;this.xKf=!1;this.wSa=null;this.rnd=0;this.vIa=this.pIc=null;this.RP=0;this.Mpb=Mb.textBox;this.Nk=ca.a.D4(cb);this.nij=E.EwaSettings.wb()}get DAb(){return Object(Rb.a)(Gb,
this.$.qb.$g)}get eK(){return this.formulaAssistanceControl.re}set eK(cb){this.formulaAssistanceControl.re=cb}get a6a(){return this.eb.a6a}get Nei(){var cb=this.Mpb.text;let Mb=!1;if(0>=cb.length)return Mb;const kc=this.$.Jb.Gc("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),Uc=H.h(this.$).ha.qa.activeCell.clone();var qd=cb.charCodeAt(0);this.vIa="";this.RP=this.h2g(cb,this.Mpb.caretPosition);qd=61===qd&&-1!==this.RP;if(!E.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing"))qd&&
(Mb=!0);else if(qd){if(E.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){qd=0;for(var va=this.RP-1;1<=va&&!(this.RP-va>gc.svf);va--)if(gc.Zxe.includes(cb.charAt(va))){qd=va;break}qd=cb.substring(qd+1,this.RP);cb=""!==qd?this.$.yb.getItemByName(qd):null;va=this.RP;for(var rb=this.RP+1;rb<=this.eb.textBox.caretPosition;rb++)if("["===this.eb.text.charAt(rb))va=rb;else break;this.RP=va}else{qd=cb.lastIndexOf("[");va=0;for(rb=qd-1;1<=rb&&!(qd-rb>gc.svf);rb--)if(gc.Zxe.includes(cb.charAt(rb))){va=
rb;break}qd=cb.substring(va+1,qd);cb=""!==qd?this.$.yb.getItemByName(qd):null}cb&&2===cb.type?(Mb=!0,this.vIa=qd):H.h(this.$).tb.Dh(Uc)&&(Mb=!0,this.vIa="")}kc.stop();this.rnd=kc.Bc;t.ULS.sendTraceTag(575776011,0,50,`FormulaAutoCompleteListAutoCompleteBehavior.InTableHeaderMode: Regression time in cell edit due to column header mode parsing is ${this.rnd} milliseconds`);return Mb}get key(){return z.a.dwb}get calcManager(){this.pIc||(this.pIc=Object(za.a)({W5:266,new:G.b,registry:this.$.da,O3:E.EwaSettings.gX}));
return this.pIc}get iUd(){if(null!=this.wSa)return this.wSa;if(!E.EwaSettings.ra(128))return this.wSa=!1;const cb=H.h(this.$).ha.qa.activeCell.clone();if(1!==cb.Xuf||!cb.left||H.h(this.$).ha.qa.Eic())return!1;let Mb=this.formulaAssistanceControl.tableManager.Np(cb);if(Mb)return this.wSa=!1;--cb.left;--cb.right;if(!cb.nz)return!1;Mb=this.formulaAssistanceControl.tableManager.Np(cb);return this.wSa=!!Mb&&cb.top===Mb.top&&this.formulaAssistanceControl.tableManager.Fah(Mb,H.h(this.$))}Oh(cb,Mb){this.formulaAssistanceControl.eb=
this.eb;-1470715894!==Mb&&-1231471547!==Mb||!this.eMe()||(this.eK=!1);return super.Oh(cb,Mb)}iCd(){var cb=this.a6a;if(cb||this.iUd)if(this.formulaAssistanceControl.eb=this.eb,this.formulaAssistanceTelemetryManager.Spb.formulaAssistanceRequestAttemptedCounter++,this.eMe())if(!cb&&this.iUd)this.formulaAssistanceControl.Ove();else if(E.EwaSettings.isChangeGateEnabled("OfficeVSO:6518663_FlightRemovalAutocompleteTableColumnHeaders")&&this.Nei){if(cb=this.$.Jb.Gc("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),
this.formulaAssistanceControl.Qve(),cb.stop(),this.Mpb.text.endsWith("[")&&"["!==this.Mpb.text.charAt(this.Mpb.text.length-2)){const Mb=""===this.vIa?this.formulaAssistanceControl.tableManager.Dg:Object(eb.a)(nc.a,this.$.yb.getItemByName(this.vIa));t.ULS.sendTraceTag(575776010,0,50,`FormulaAutoCompleteListAutoCompleteBehavior.OnAutoCompleteTimerTick: AutoComplete List Box for Table Column Headers is shown after user types =[ inside a table with id ${Mb.Hi} in ${cb.Bc} ms with cell edit regression time of ${this.rnd} ms and popup visibility - ${this.eK}`)}}else this.formulaAssistanceControl.zpb(),
this.xKf&&(this.xKf=this.eK=!1);else this.formulaAssistanceTelemetryManager.Spb.formulaAssistanceRequestOptimizedCounter++;else this.eK=!1}Ri(){this.nij||(this.wSa=null,this.iUd&&this.formulaAssistanceControl.oZ())}$f(){this.eK=!1;this.formulaAssistanceControl.set_visible(!1);this.formulaAssistanceControl.Mvc();this.Nk&&this.MCi()}CId(cb,Mb){return this.formulaAssistanceControl.Oh(cb,Mb)}MCi(){E.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.formulaAssistanceControl.aaa&&
!this.formulaAssistanceControl.mia&&!this.formulaAssistanceControl.eoa&&(this.formulaAssistanceTelemetryManager.dJ.dismissSmartSuggestionImplicitlyCounter++,this.formulaAssistanceControl.aaa=!1);this.formulaAssistanceControl.pI&&(this.formulaAssistanceTelemetryManager.$G.smartSuggestionShownCounter++,this.formulaAssistanceControl.pI=!1,Object(Oc.a)(Ib.a));this.formulaAssistanceControl.eoa&&(this.formulaAssistanceTelemetryManager.$G.smartSuggestionSelectedCounter++,this.formulaAssistanceControl.eoa=
!1,Object(Oc.a)(Ib.c));this.formulaAssistanceControl.USa&&(this.formulaAssistanceTelemetryManager.$G.smartSuggestionCommittedCounter++,this.formulaAssistanceControl.USa=!1);this.formulaAssistanceControl.isCellContentOnlyEqualDuringEdit&&(this.formulaAssistanceTelemetryManager.$G.isCellContentOnlyEqualDuringEditCounter++,this.formulaAssistanceControl.isCellContentOnlyEqualDuringEdit=!1);this.formulaAssistanceControl.kMa&&(this.formulaAssistanceTelemetryManager.$G.isCellContentFormulaCounter++,this.formulaAssistanceControl.kMa=
!1)}h2g(cb,Mb){let kc=0,Uc;for(;-1!==kc;)if(kc=cb.indexOf("[",kc+1),-1!==kc&&kc<Mb&&(Uc=cb.indexOf("]",kc+1),-1===Uc||Uc>=Mb))return kc;return-1}eMe(){const cb=this.eb.text,Mb=this.eb.textBox.caretPosition,kc=this.formulaAssistanceControl.Uba,Uc=this.formulaAssistanceControl.nla;if(this.eK&&da.a.equals(cb,kc,!0)&&Mb===Uc)return!1;this.formulaAssistanceControl.Uba=cb;this.formulaAssistanceControl.nla=Mb;return!0}}gc.Zxe=" !%&'()*+,-/:;<=>@[]^{|}~".split("");gc.svf=255;Object(d.a)(gc,"FormulaAutoCompleteListAutoCompleteBehavior",
lc.a,[]);var Fc;(function(cb){cb[cb.function=0]="function";cb[cb.field=1]="field";cb[cb.definedName=2]="definedName";cb[cb.letVariable=3]="letVariable";cb[cb.tableColHeaderName=4]="tableColHeaderName";cb[cb.tableSpecialStructRef=5]="tableSpecialStructRef";cb[cb.pendingData=6]="pendingData";cb[cb.tableNamedObject=7]="tableNamedObject"})(Fc||(Fc={}));Object(d.b)("ItemType",Fc);var Vc=a(1113),ed=a(1112);class Sd{constructor(cb){this.index=cb}execute(cb){cb.push(this.index)}}Object(d.a)(Sd,"AppendIndexOperation",
null,[659]);class Zd{execute(){}}Object(d.a)(Zd,"NopIndexOperation",null,[659]);class pa{constructor(cb,Mb){this.Q8i=cb;this.txf=Mb}execute(cb){for(let Mb=0;Mb<cb.length;Mb++)cb[Mb]===this.Q8i&&(cb[Mb]=this.txf)}}Object(d.a)(pa,"ReplaceIndexOperation",null,[659]);var zb=a(80);class Vb{constructor(cb,Mb){this.$=cb;this.items=Mb;this.BMa=ca.a.BMa(this.$)}xIe(cb,Mb){const kc=new Sd(Mb);if(!this.BMa)return kc;cb=this.exi(cb,Mb);return null!=cb?this.items[cb].cCb?new pa(cb,Mb):new Zd:kc}exi(cb,Mb){const kc=
this.items[Mb];t.ULS.shipAssertTag(537162075,0,!!kc,"Internal error: invalid item index");cb=zb.where(zb.asEnumerable(cb),Uc=>this.items[Uc].name===kc.name);return zb.Ct(cb)?zb.first(cb):null}}Object(d.a)(Vb,"FilterItemOperationFactory",null,[]);var xc=a(116),Sc=a(856);class Jd{constructor(){this.evaluation=this.textEdit=this.label=null;this.kind=0;this.shouldRequestAutocompleteOnCommit=this.isPrefixed=this.detail=this.type=null}}Object(d.a)(Jd,"CompletionItem",null,[]);const ye=`<tr>\r\n\t{0}\r\n\t<td id='name_cell{4}' class='{1}'>{2}</td>\r\n\t<td id='${"description_cell"}{4}' class='${n.a.io}'>{3}</td>\r\n\t<td id='${"item_type_cell"}' class='${n.a.io}'>{5}</td>\r\n</tr>`,
pe=`<tr>\r\n\t{0}\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='${"description_cell"}{1}' class='${n.a.io}'></td>\r\n\t<td id='${"item_type_cell"}' class='${n.a.io}'>{2}</td>\r\n</tr>`,re=`<td>\r\n\t<div class='${n.a.Or}'>\r\n\t\t<img class='{0}' src='{1}' alt='{2}'/>\r\n\t</div>\r\n</td>`,He=`<tr>\r\n\t<td><b>{0}</b></td>\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='${"description_cell"}{1}' class='${n.a.io}'>{5}</td>\r\n\t<td id='${"item_type_cell"}' class='${n.a.io}'>{2}</td>\r\n</tr>`;
class ze extends Vc.a{constructor(cb,Mb,kc,Uc,qd,va){super(cb,Mb);this.htmlSanitizationHelper=qd;this.sra=null;this.Oeb=this.pxc=0;this.Vrb=null;this.f_e=kc;this.bwb=Uc;this.formulaAssistanceControl=va;this.Vo=[];this.ZV=[];this.Nk=ca.a.D4(cb);this.gqi=E.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")}NXc(cb){this.addHandler("FLBSelectedRowChanged",cb)}qMd(cb){this.removeHandler("FLBSelectedRowChanged",cb)}S_b(cb){this.addHandler("ACLBUpdated",cb)}Ruc(cb){this.removeHandler("ACLBUpdated",
cb)}get Qjc(){return 0<this.Oeb&&this.Oeb===this.Vo.length}get Dui(){return 0<this.Oeb}get re(){return super.re}set re(cb){super.re=cb;cb||(this.pxc=0,this.ee=null);0===this.pxc?wa.DOMElementExtensions.setVisible(this.bwb,cb&&!this.Nk):wa.DOMElementExtensions.setVisible(this.bwb,!1)}get Ej(){return this.sra}set Ej(cb){this.BBa(this.Ej);if(cb){this.f_e.innerText="";this.sra=cb;var Mb=this.BBa(this.Ej);const kc=cb.rowIndex+1,Uc=$get("description_cell"+kc,cb);this.bwb.innerText=Uc.innerText;const qd=
$get("item_type_cell",cb);this.ee=Mb=Mb.innerText;this.pxc="field"===qd.innerText?1:"definedName"===qd.innerText?2:"letVariable"===qd.innerText?3:"tableColHeaderName"===qd.innerText?4:"tableSpecialStructRef"===qd.innerText?5:"pendingData"===qd.innerText?6:"tableNamedObject"===qd.innerText?7:0;this.raiseEvent("FLBSelectedRowChanged",new ed.a(this.Vo.length,kc,Mb,Uc.innerText));this.$wc(cb)}}get MTa(){return this.bwb}get HGa(){return this.formulaAssistanceControl}get k0(){return this.pxc}dispose(){super.dispose();
this.sra=this.f_e=this.bwb=null}ABc(cb,Mb,kc,Uc=0){this.Nk||this.w7(!1);let qd="";kc&&(qd+=`<table aria-live='off' id='${"list_column_header"}'><tr><td class='${zc.a.Q6g}'>${kc}</td></tr></table>`);qd+=`<table class='${this.v5}' aria-live='off'><tbody>`;const va=new Wb.a;for(let fc=0,Nc=this.ZV.length;fc<Nc;fc++)qd+=this.i8e(cb[this.ZV[fc]],fc+1,Mb,Uc),this.Nk&&va.add(this.F1e(cb[this.ZV[fc]]));let rb=this.ZV.length;for(let fc=0,Nc=this.Vo.length;fc<Nc;fc++)this.ZV.includes(this.Vo[fc])||(rb++,qd+=
this.i8e(cb[this.Vo[fc]],rb,Mb,Uc),this.Nk&&va.add(this.F1e(cb[this.Vo[fc]])));qd+="</tbody></table>";this.gqi?this.htmlSanitizationHelper.Rh(this.Df,qd):this.Df.innerHTML=qd;this.wn=wa.DOMElementExtensions.$j(this.domElement,this.v5);this.Nk&&(this.Vrb=va.toArray());this.Nk?(this.re=!0,this.HGa.set_visible(!0)):(this.w7(!0),this.YPg(!!kc))}IJa(cb,Mb,kc,Uc="",qd=0,va=!1){if(cb){var rb=[],fc=[];this.Oeb=0;var Nc=new Vb(this.$,cb);if(Mb){var hd=!!Mb&&0<qd,xd=hd&&91===Mb.charCodeAt(qd+1)?qd+2:qd+1;va=
hd?Mb.length===xd:!1;hd&&Mb.length===qd&&E.EwaSettings.ra(128)&&(va=!0);var ae=null;!va&&hd&&Mb.length>qd+1&&(ae=Mb.substring(xd,Mb.length));if(Mb)for(let Wd=0,Ne=cb.length;Wd<Ne;Wd++)if(hd=cb[Wd].name,!cb[Wd].tni){xd=Nc.xIe(rb,Wd);cb[Wd].cCb&&this.Oeb++;if(!ae&&!va||0===cb[Wd].itemType)({gef:rb,UNf:fc}=this.BXe(Mb,hd,kc,xd,rb,fc));ae&&1===cb[Wd].itemType&&({gef:rb,UNf:fc}=this.BXe(ae,hd,!0,xd,rb,fc));va&&1===cb[Wd].itemType&&xd.execute(rb)}}else for(kc=0;kc<cb.length;++kc)if(cb[kc].cCb||va)ae=Nc.xIe(rb,
kc),ae.execute(rb),ae.execute(fc),cb[kc].cCb&&this.Oeb++;this.ZV=fc;this.Vo=rb;this.ABc(cb,Mb,Uc,qd)}}U0j(cb){if(cb&&!(1<cb.length)){var Mb=[],kc=[];Mb.push(0);kc.push(0);this.ZV=Mb;this.Vo=kc;this.ABc(cb,"","",0)}}gya(){this.Ej&&super.gya()}pbj(cb,Mb){this.raiseEvent("ACLBUpdated",new ed.a(cb,void 0,void 0,Mb))}Dkg(cb){const Mb=this.wn.rows[cb];return(!this.Ej||this.Ej!==Mb)&&cb<this.wn.rows.length?(this.Ej=Mb,!0):!1}static G1e(cb){switch(cb){case 0:return 3;case 2:return 100;case 1:case 6:return 103;
case 3:return 102;case 4:return 101;case 5:return 107;case 7:return 106;default:return 3}}onItemClick(cb){na.g(cb.Ea);0===this.k0||2===this.k0||3===this.k0||4===this.k0||5===this.k0||7===this.k0?(this.raiseEvent(Sc.a.e5a),this.gya()):1===this.k0?this.HGa.Ny(!1):(this.HGa.Ny(!1),cb=H.h(this.$),cb.Fo(!1),cb.focus());return!0}YPg(cb){this.asa();if(cb){var Mb=this.wn.offsetWidth+(this.Vo.length>this.KH?xc.a.Bu:0);cb=$get("list_column_header");cb.offsetWidth>Mb&&wa.DOMElementExtensions.Jv(this.Df,cb.offsetWidth);
Mb=this.Df.getElementsByClassName(this.uV);for(let kc=0;kc<Mb.length;kc++)Mb[kc].style.width=B.HelperMethods.sc(cb.offsetWidth)}}i8e(cb,Mb,kc,Uc){if(1===cb.itemType){const qd=ba.a.yg(cb.name),va=ba.a.yg(Uc?kc.substring(Uc+1,kc.length):kc);let rb=0;qd.substring(0,va.length).toLowerCase()!==va.toLowerCase()&&(rb=ze.UNj(qd,m.Qng,va));kc="";kc=0<=rb?kc+(qd.substring(0,rb)+"<b>"+qd.substring(rb,rb+va.length)+"</b>"+qd.substring(rb+va.length,qd.length)):kc+qd;Uc=Uc?String.format(re,n.a.NTe,ba.a.YJ(X.a.qe(0)),
u.a.instance.ga(711)):"";return String.format(pe,Uc,Mb,Fc[cb.itemType],this.uV,kc)}if(5===cb.itemType)return String.format(He,"",Mb,Fc[cb.itemType],this.uV,ba.a.yg(cb.name),ba.a.yg(cb.lja));if(4===cb.itemType)return String.format(He,"(...)",Mb,Fc[cb.itemType],this.uV,ba.a.yg(cb.name));if(6===cb.itemType)return Uc=Uc?String.format(re,n.a.NTe,ba.a.YJ(X.a.qe(0)),u.a.instance.ga(711)):"",String.format(ye,Uc,this.uV,ba.a.yg(cb.name),ba.a.yg(cb.lja),Mb,Fc[cb.itemType]);Uc=String.format(re,2===cb.itemType||
3===cb.itemType?n.a.Pzh:n.a.Nzh,ba.a.YJ(X.a.qe(0)),u.a.instance.ga(708));return String.format(ye,Uc,this.uV,ba.a.yg(cb.name),ba.a.yg(cb.lja),Mb,Fc[cb.itemType])}F1e(cb){const Mb=new Jd;Mb.label=cb.label;Mb.textEdit=cb.textEdit;Mb.kind=ze.G1e(cb.itemType);Mb.type=cb.cCb?1:0;if(E.EwaSettings.isChangeGateEnabled("OfficeVSO:5607789_FunctionShortDescriptions")&&3===Mb.kind){const kc=this.formulaAssistanceControl.dWh(cb.label);Mb.detail=kc?kc:cb.lja}else Mb.detail=cb.lja;return Mb}BXe(cb,Mb,kc,Uc,qd,va){da.a.equals(Mb,
"Pretend this is the line.",!1)&&0<qd.length||da.a.MF(Mb,cb)?(Uc.execute(qd),Uc.execute(va)):kc&&cb.length>=m.Iah&&ze.qlh(Mb,m.Qng,cb)?Uc.execute(qd):!kc&&cb.length>=m.Hah&&da.a.contains(Mb,cb,!0)&&Uc.execute(qd);return{gef:qd,UNf:va}}static qlh(cb,Mb,kc){for(const Uc of Mb)if(Mb=cb.split(Uc),!(2>Mb.length))for(const qd of Mb)if(da.a.MF(qd,kc))return!0;return!1}static UNj(cb,Mb,kc){for(const Uc of Mb)if(Mb=cb.toLowerCase().indexOf((Uc+kc).toLowerCase()),0<Mb)return Mb+1;return-1}}Object(d.a)(ze,"FormulaAutoCompleteListBox",
Vc.a,[629]);class ef{constructor(){this.j9=this._name=null}get name(){return this._name}get toolTip(){return this.j9}}Object(d.a)(ef,"LETVariableInfo",null,[]);class $a{constructor(){this._name=null}get name(){return this._name}}Object(d.a)($a,"TableColHeaderNameInfo",null,[]);class Nb{constructor(){this._name=null}get name(){return this._name}}Object(d.a)(Nb,"TableNamedObjectInfo",null,[]);class qc{constructor(){this.j9=this._name=null}get name(){return this._name}get toolTip(){return this.j9}}Object(d.a)(qc,
"TableSpecialStructRefInfo",null,[]);var Lc=a(163),sd=a(29),Fd=a(101),Td=a(927),ue=a(254),Ae=a(52),Le=a(145);class df{constructor(){this.onRestoreFocus=this.onDismiss=this.onFeedback=this.onCompletionItemCommitted=this.onCompletionItemSelected=null}}Object(d.a)(df,"FormulaAutoCompleteCallbacks",null,[]);class Oe{constructor(){this.callbacks=this.completionItems=null;this.activeItemIndex=0}}Object(d.a)(Oe,"FormulaAutoCompleteRenderingInfo",null,[]);class cf{}Object(d.a)(cf,"RunExperimentRequest",null,
[]);class vf extends wc.a{constructor(cb,Mb,kc,Uc,qd,va,rb,fc,Nc,hd){super(cb);this.functionInfoManager=Mb;this.calcManager=Uc;this.instantaneousSupportInformationManager=qd;this.formulaAssistanceUIControl=rb;this.formulaAssistanceTelemetryManager=fc;this.pluginScheduler=Nc;this.$ec=!1;this.l5=this.qud=this.oV=this.Dg=this.IGa=this.yq=null;this.G6b=this.GOb=this.Ytb=this.BNe=this.r3=this.fbc=this.L3a=0;this.xzc=!1;this.yrc=this.Oia=null;this.columnName="";this.yAe=this.l8c=!1;this.VJa=[];this.QP=
null;this.UNb=[];this.a8=this.ted=this.Co=null;this.mia=this.aaa=this.kMa=this.isCellContentOnlyEqualDuringEdit=this.USa=this.eoa=this.pI=this.xfa=!1;this.Uba=null;this.nla=0;this.$4d=null;this.ipd=!1;this.onRestoreFocus=()=>{};this.Vgb=void 0;this.Nka=E.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");this.hkf=E.EwaSettings.isChangeGateEnabled("OfficeVSO:6592409_startArgumentAssistanceTimerBeforeAutocompleteCalculation");this.rkd=()=>{this.Nk&&this.raiseEvent(vf.xdd,
null)};this.xXe=()=>{this.Oia=!1;this.oV=this.eb.text;this.Qg.IJa(this.dr,this.oV,!0,this.columnName,void 0,!1);1===this.Qg.Vo.length&&1===this.Qg.ZV.length?(this.set_visible(!1),this.yAe||this.lnd()):this.show()};this.qDd=xd=>{if(Ac.a(xd))-315732528!==xd.Errors[0].MessageId&&t.ULS.sendTraceTag(537162013,0,10,`FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call failed with Unexpected error : ${sd.a.nc(xd.Errors)}`);else if((xd=xd.Result)&&xd.length){this.Dg.pO||(this.Dg.pO={},this.Dg.pO.HeadersList=
[]);this.Dg.pO.IsFullTableHeaders=!0;for(let ae=0;ae<xd.length;++ae)this.Dg.pO.HeadersList[ae]={},this.Dg.pO.HeadersList[ae].Index=ae,this.Dg.pO.HeadersList[ae].Name=xd[ae];this.uNf(!0);this.oV=this.h8e();this.Qg.IJa(this.dr,this.oV,!0,void 0,void 0,!0);this.show()}else t.ULS.sendTraceTag(537162012,0,10,"FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call returned no results")};this.pDd=xd=>{xd=Ka.a.Pe(xd.data);t.ULS.sendTraceTag(537162011,0,10,`FormulaAssistanceControl.OnGetTableColHeadersFailure - Webservice call failed with Errors: ${sd.a.nc(xd)}`)};
this.nzf=(xd,ae)=>{this.gridView.fb||this.gridView.Vh||this.rFb(null===ae||void 0===ae?void 0:ae.cell)};this.a6=(xd,ae)=>{this.cPd(ae.newValue)};this.Uc=()=>{(E.EwaSettings.isChangeGateEnabled("OfficeVSO:6518663_FlightRemovalAutocompleteTableColumnHeaders")||this.Nk)&&this.set_visible(!1)};this.qDf=()=>{this.a8=this.IGa=null};this.ij=()=>{this.Nk&&this.Y1a()};this.onFunctionInfoLoaded=()=>{this.zpb()};this.Eya=()=>{this.nka?(this.IGa=this.a8=null,this.zpb()):this.Og.Pk&&this.Ove()};this.Dca=()=>{this.QP&&
N(this.$,this.QP.HelpId,this.QP.IsDynamicUdf);return!0};this.Gca=(xd,ae)=>{0==ae.Iq&&(170==ae.Lf.operation.operationName&&this.formulaAssistanceTelemetryManager.olc++,this.$.userOperationManager.Un(this.Gca))};this.cPa=(xd,ae)=>{0==ae.Iq&&(12==ae.Lf.operation.operationName&&this.$.userOperationManager.Zq(this.Gca),this.$.userOperationManager.Un(this.cPa))};this.Y1a=()=>{this.Nk&&this.ywd();E.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.pI&&(this.aaa=!0);
this.fF&&this.eb.fb&&this.Yma();this.Co=null;this.formulaAssistanceUIControl&&(this.formulaAssistanceUIControl.dismiss(this.J1b),this.yq.Ff=!1);this.ipd=!1};this.jIf=()=>{this.fF&&this.Yma();this.B$f();1===this.w2f.type&&E.EwaSettings.wb()&&!this.eb.text.includes("\n")&&this.zHd(this.w2f)};this.onDismiss=()=>{this.re=!1;this.gridView.ni.textBox.focus()};this.IRa=()=>{const xd={};xd[C.a.wM]=this.Qg.Qjc?"SmartSuggestionsCard":this.Qg.Dui?"FunctionAndSmartSuggestionsCard":"SimpleAutoCompleteCard";this.$.Yc(802602464,
0,8,xd)};this.ICd=(xd,ae)=>{this.Qg.Dkg(ae);this.Nk&&(this.NIa=!0)};this.HCd=xd=>{this.Nk&&(this.KIa=!0);this.fF?(this.VEe(),this.Z0f(),this.gridView.oaa.C3f(),this.gridView.ni.endEdit(!0,"FormulaAssistanceControl.OnCompletionItemClicked",0)):xd.textEdit?this.Prb(xd.textEdit):this.Ny(!0)};this.gridView=H.h(cb);this.domElement.className=zc.a.bRe;this.Og=va.K5c(cb,kc);this.v7b=new dd(cb);this.$Eg=kc;vf.Gfc||(vf.Gfc=vf.fKa());E.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")?
hd.Rh(this.domElement,vf.Gfc):this.domElement.innerHTML=vf.Gfc;this.LBd=RegExp("\\d+");ue.d(this.style,this.$.isChromeRtl);this.fja=new Xb(this.$,this.domElement,this.functionInfoManager,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager,this.pluginScheduler,hd);Mb=$get(m.ped,this.domElement);kc=$get(m.ked,this.domElement);Uc=$get(m.sed,this.domElement);this.$wg=new ze(this.$,Mb,Uc,kc,hd,this);this.Og.J_b(this.Eya);this.functionInfoManager.$Fa(this.onFunctionInfoLoaded);this.functionInfoManager.UMg(this.qDf);
this.J1b=this.domElement;this.Nk&&(this.$.va.Vf(this.ij),this.Qg.NXc(this.jIf),E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&(this.J1b=document.createElement("div")));this.jTa(!0);this.Ocg(!0);this.$.domElement.appendChild(this.J1b);this.RSc=0;(hd=U.a(cb))&&this.VJa.push(new gc(cb,hd,this,this.formulaAssistanceTelemetryManager));this.VJa.push(new gc(cb,this.gridView.Vb,this,this.formulaAssistanceTelemetryManager));this.Vvb=this.VJa[0];this.Zqb=this.VJa[this.VJa.length-
1];cb.da.Ha(221,this);this.instantaneousSupportInformationManager||this.$.da.gb(268,xd=>{this.instantaneousSupportInformationManager=xd});this.RWe=E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",!1);this.TSa=ca.a.BMa(this.$);this.DGj=ca.a.Lpb(this.$);this.lBd=E.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");this.D_c=E.EwaSettings.isChangeGateEnabled("OfficeVSO:6488306_BlockFormulasuggestionInPivotTable");ca.a.gV(this.$)&&this.god();
ca.a.WM(this.$)&&Mb.classList.add("ewa-fb-refactor");this.Nk?this.gridView.ha.eC(this.Uc):this.gridView.ha.rT(this.Uc);this.yq=new he(this.$,this.formulaAssistanceUIControl,1,Ab.a.Sdd,this.rkd)}Mqe(cb){this.addHandler(vf.Ydd,cb)}tWf(cb){this.removeHandler(vf.Ydd,cb)}Kqe(cb){this.addHandler(vf.xdd,cb)}rWf(cb){this.removeHandler(vf.xdd,cb)}Lqe(cb){this.addHandler("FormulaAutoCompleteShown",cb)}sWf(cb){this.removeHandler("FormulaAutoCompleteShown",cb)}get au(){return this.Qg}get dr(){return this.a8}get KLb(){return this.Qg.ee}get a_e(){return this.Qg}get HZe(){return this.fja}get Qg(){return this.$wg}get q1a(){return this.TSa?
this.eb?this.eb.text:null:this.oV}get Fkf(){var cb;return 0===(null===(cb=this.sYe)||void 0===cb?void 0:cb.type)}get Mui(){var cb;return 1===(null===(cb=this.sYe)||void 0===cb?void 0:cb.type)}get_visible(){return void 0!==this.Vgb?this.Vgb:this.Vgb=super.get_visible()}set_visible(cb){if(this.Vgb===cb)return this.Nk&&!cb&&this.Y1a(),cb;this.fja.set_visible(cb);this.Nk&&!cb&&this.Y1a();Sys.UI.Control.prototype.set_visible.call(this,cb);return this.Vgb=cb}get re(){return this.au.re}set re(cb){this.Nk&&
!cb&&this.Y1a();this.au.re=cb}get tableManager(){return this.$Eg}get nka(){return 0<this.TY}get fF(){return this.xfa}get tb(){return this.gridView.tb}q1g(cb,Mb){this.re&&(cb+=m.openParen,Mb++,this.OFd(cb,Mb));var kc=Mb===cb.length||cb.charAt(Mb)===m.closeParen;if(!(0<Mb&&cb.charAt(Mb-1)===m.openParen&&kc))return t.ULS.sendTraceTag(537162053,0,50,`FormulaAssistanceControl.CanInsertFormulaArguments Caret position: ${Mb} is invalid. Is cell empty: ${!cb.length}. Function exists in cell: ${!!this.QP}`),
!1;kc=cb.substring(0,Mb).lastIndexOf(this.$.listSeparator);const Uc=cb.substring(0,Mb-1).lastIndexOf(m.openParen);cb=cb.substring(-1===kc&&-1===Uc?1:Math.max(kc,Uc)+1,Mb-1).trim();return this.functionInfoManager.Sgd(cb)?!0:(t.ULS.sendTraceTag(537162052,0,50,`FormulaAssistanceControl.CanInsertFormulaArguments No valid function name before caret. Function exists in cell: ${!!this.QP}`),!1)}lji(cb,Mb){var kc=this.q1g(cb,Mb);if(!kc||!this.QP)return t.ULS.shipAssertTag(537162051,0,!kc||kc&&!!this.QP,"FormulaAssistanceControl.InsertFormulaArgumentsFromCaretPosition currentFunctionInfo is null"),
{returnValue:null,pxf:0,uYe:0};kc=this.QP.Params;kc=kc.replace(RegExp("[\\[\\]]","g"),"");const Uc=cb.charAt(Mb-1)===m.openParen,qd=Uc?"":"(",va=Mb===cb.length?")":"";var rb=this.$.listSeparator;rb=kc.includes(rb)?kc.indexOf(rb):kc.length;return{returnValue:cb.substring(0,Mb)+qd+kc+va+cb.substring(Mb,cb.length),pxf:Uc?Mb:Mb+1,uYe:rb}}zt(cb,Mb){this.Nk&&void 0!==this.Co&&null!==this.Co&&this.Co();this.Nk||super.zt(cb,Mb)}get u1b(){return this.$4d}get TY(){return this.BNe}set TY(cb){this.BNe=cb;cb||
(this.r3=0)}get gGj(){if(null==this.yrc){const cb=this.$.$b;this.yrc=!!cb&&!cb.inEmbedView}return this.yrc}get w2f(){return this.Qg.Vrb[this.Qg.Ej.rowIndex]}get sYe(){var cb,Mb;return null===(Mb=null===(cb=this.Qg)||void 0===cb?void 0:cb.Vrb)||void 0===Mb?void 0:Mb[0]}get i_e(){!this.ted&&this.pluginScheduler&&(this.ted=this.pluginScheduler.getFunctionsShortDescriptions());return this.ted}dispose(){if(this.$){this.jTa(!1);const cb=this.gridView;this.$.userOperationManager.Un(this.Gca);this.$.userOperationManager.Un(this.cPa);
cb&&(cb.ha&&(this.Nk?cb.ha.vB(this.Uc):cb.ha.AR(this.Uc),ca.a.gV(this.$)&&cb.ha.Zma(this.nzf)),cb.view.Mq(this.tpc));this.Nk&&this.$.va&&this.$.va.sg(this.ij)}this.functionInfoManager&&(this.functionInfoManager.qcb(this.onFunctionInfoLoaded),this.functionInfoManager.bkj(this.qDf));this.Og&&this.Og.Juc(this.Eya);this.Nk&&this.Qg&&this.Qg.qMd(this.jIf);ca.a.bhc&&this.eb&&this.eb.RJb(this.a6);this.Ocg(!1);ka.a.Ja(this.Qg);ka.a.Ja(this.u1b);ka.a.Ja(this.fja);ka.a.Ja(this.yq);this.eb=this.functionInfoManager=
this.Og=null;ka.a.pc(this.VJa);this.Dg=this.a8=this.fja=this.VJa=null;super.dispose()}Uwa(){return!this.dr}Fqi(){return!this.IGa}BZj(cb){this.Mui&&1872288872===cb&&(this.formulaAssistanceTelemetryManager.gw(["autoCompleteSmartSuggestionActiveDismissing"]),this.mia=!0)}Oh(cb,Mb){if(!this.Uwa()){E.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.BZj(Mb);if(this.Nk&&this.fF){if(125627505===Mb||267796030===Mb)return this.Nk&&this.KDc(Mb),this.VEe(),this.Z0f(),
!1;if(1872288872===Mb)return this.Yma(),this.re=!1,!0;if(this.Qg.Qjc&&(-798660877===Mb||137938150===Mb))return!1}if(1!==this.Qg.k0||125627505!==Mb&&267796030!==Mb)if(6===this.Qg.k0){var kc=cb.keyCode;13!==kc&&9!==kc||this.Ny(!1)}else{if(4===this.Qg.k0||5===this.Qg.k0)return super.Oh(cb,Mb,!0);1===this.Qg.ZV.length&&(kc=cb.keyCode,this.yAe=8===kc||127===kc||46===kc?!0:!1)}else{if(this.Ny(!1)&&!this.nka)return this.gridView.ha.Oh(cb,Mb);if(125627505===Mb&&this.nka)return!0}}return super.Oh(cb,Mb)}Mvc(){this.Og.Pcb();
this.a8=null;null==this.Oia||this.Oia||this.Slc("NoFieldChosen",1,2,1);this.Oia=null;this.TY=0;this.l5=this.qud=this.yrc=null}zpb(){this.hkf&&this.formulaAssistanceTelemetryManager.ED(["argumentAssistanceOverall"]);const cb=!!this.eb&&!Eb.f(this.$.na);let Mb=null;cb&&(Mb=this.eb.text,Mb.startsWith("=")&&(this.kMa=!0,1===Mb.length&&(this.isCellContentOnlyEqualDuringEdit=!0)));if(this.DGj&&cb){const kc={content:Mb,caretPosition:null};(this.Nka?this.pluginScheduler.getRequester().functionSuggestion(kc,
0):this.pluginScheduler.requester().functionSuggestion(kc)).then(Uc=>{if(0===Uc.kind){t.ULS.shipAssertTag(537162050,0,!!Uc&&!!Uc.payload.items,"FormulaAssistanceControl.AssistFormula - x10Scheduler returned `null` suggestion");const qd=zb.toArray(zb.select(zb.asEnumerable(Uc.payload.items),va=>vf.w$g(va)));this.gridView.oaa.PRd(Uc.payload,Mb);this.TSa&&(this.UNb=qd,P.AFrameworkApplication.rg||(this.D_c&&this.tb.b5(this.gridView.ha.qa.activeCell)?this.formulaAssistanceTelemetryManager.$G.smartSuggestionWouldSuggestInsidePivotCounter++:
this.Pve(cb,!0)))}return null})}this.TSa&&cb||this.Pve(cb,!1)}h8e(){if(E.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){var cb=this.gridView.Ql?this.Vvb.RP:this.Zqb.RP;this.GOb="@"===this.eb.text.charAt(cb+1)&&this.eb.textBox.caretPosition>cb+1?cb+2:cb+1}else{cb=this.eb.text.lastIndexOf(m.cqf);const Mb=this.eb.text.lastIndexOf("[");this.GOb=cb+1>=Mb?cb+2:Mb+1}return this.eb.text.substring(this.GOb,this.eb.textBox.caretPosition)}Qve(){this.O$f()&&(this.whh(),
this.dr&&(this.Oia=!1,this.oV=this.h8e(),this.Qg.IJa(this.dr,this.oV,!0,void 0,void 0,!0),this.show(),E.EwaSettings.isChangeGateEnabled("OfficeVSO:5516893_fixInTableHeaderModeAccordingToCaretPoisiton")&&this.fja.a8b()))}Ove(){this.O$f()&&(this.u1b&&this.u1b.cancel(),this.Og.W6a?(this.Uwa()&&this.kHe(!0),this.get_visible()?this.xXe():this.$4d=Lc.AsyncMethodContext.vq(this.xXe,m.Nkh,ya.a.fKh,this.u1b)):this.oZ())}O$f(){return this.eb?0<this.$.qb.oR||!this.eb.text||!this.eb.fb?(this.set_visible(!1),
!1):Eb.f(this.$.na)?!1:!0:!1}Prb(cb){this.eb&&this.re&&(this.vod(this.eb.text,cb),this.eb.textBox.caretPosition=cb.range.start.character+cb.newText.length,this.set_visible(!1))}Ny(){var cb;if(!this.eb||!this.re)return!1;const Mb=this.Qg.k0;this.formulaAssistanceTelemetryManager.YXf(ze.G1e(Mb));let kc="";var Uc=0;const qd=this.gridView;var va=this.eb.text,rb=0,fc=this.Qg.ee,Nc=!1;if(0===Mb||2===Mb||3===Mb||7===Mb)kc+=va.substr(0,this.L3a)+this.Qg.ee,0!==Mb||this.Qg.ee.endsWith(")")||(kc+="("),Uc=kc.toString().length,
kc+=va.substr(this.fbc),2===Mb&&(rb=4,fc="DefinedName",Nc=!0,this.set_visible(!1));else if(1===Mb)if(this.Oia=!0,this.nka){kc+=va.substr(0,this.TY+2);!kc.toString().endsWith(Jc.a.oU)&&E.EwaSettings.ra(128)&&(kc+=Jc.a.oU);rb=this.Qg.ee;rb=rb.replace("'","''");rb=rb.replace("[","'[");rb=rb.replace("]","']");if(this.l8c||this.LFh(rb))rb=Jc.a.Gzi+rb+Jc.a.erj,Nc=!0;kc+=rb;Uc=kc.length;rb=3;Le.a("PulloutFieldAccepted")}else return this.eb.text=this.Qg.ee,this.set_visible(!1),qd.Fo(!1),qd.focus(),this.Slc("FieldName",
1,1,1),Le.a("TableHeaderAutoCompleteSuggestionAccepted"),!0;else if(5===Mb)t.ULS.sendTraceTag(537162048,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableSpecialStructRef listbox item"),kc+=va.substr(0,this.GOb),da.a.equals(this.Qg.ee,"@ - "+this.instantaneousSupportInformationManager.Ie.ThisRowStructRefString,!1)?kc+="@":(kc+=this.Qg.ee,Nc=!0,this.set_visible(!1)),Uc=kc.length;else if(4===Mb){t.ULS.sendTraceTag(575776009,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableColHeaderName listbox item}");
kc+=va.substr(0,this.GOb);Nc="";Uc=!1;var hd=[39,91,93,64,35];for(let xd=0;xd<this.Qg.ee.length;xd++){const ae=this.Qg.ee.charCodeAt(xd);hd.includes(ae)&&(Nc+="'");Nc+=this.Qg.ee.charAt(xd).toString();Uc||da.a.isNumeral(ae)||da.a.Tjf(ae)||(Uc=!0)}hd=this.gridView.Ql?this.Vvb.RP:this.Zqb.RP;va=E.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?"@"===va.charAt(hd+1)&&Uc:va.lastIndexOf(m.cqf)+1>=va.lastIndexOf("[")&&Uc;kc+=va?"["+Nc+"]":Nc;Nc=!0;this.set_visible(!1);
Uc=kc.toString().length}else if(6===Mb)kc+=va.substr(0,this.Ytb);else return t.ULS.sendTraceTag(537162019,0,10,"Autocomplete item type was not set on AutoComplete ListBox"),!1;this.eb.text=kc;this.eb.textBox.caretPosition=Uc;this.eb.ixa()&&(null===(cb=qd.Qr)||void 0===cb?0:cb.Oua)&&qd.Qr.RLb(this.eb.text,this.eb.textBox.caretPosition,this.eb.textBox.caretPosition,this.eb.textBox.qy.length);qd.Ql&&(cb=qd.Vb,cb.text=this.eb.text,cb.setCaretPosition(this.eb.textBox.caretPosition));fc=(null==this.Oia?
0:this.Oia)?"FieldName":fc;this.Qg.Ej.sectionRowIndex>=this.Qg.ZV.length?this.Slc(fc,4,rb,0):this.Slc(fc,1,rb,0);Nc||(5===Mb||4===Mb?this.Qve():E.EwaSettings.isChangeGateEnabled("OfficeVSO:7386867_dontShowAutocompleteAfterCommitingTableName")&&7===Mb?this.set_visible(!1):this.zpb());return!0}oZ(cb=null,Mb=null){cb?(this.Og.Pcb(),this.Og.oZ(cb,!1,!1,Mb)):(cb=this.gridView,cb.ha.qa.Tg&&(cb=ja.v(cb.ha.qa.ld,this.$),this.Og.oZ(cb,!0,!0,Mb)))}Yma(){this.xfa=!1;this.eb.FMe()}dWh(cb){cb=this.calcManager.getWorksheetFuncId(cb);
return this.i_e?this.i_e.descriptionsMap.get(cb):null}kHe(cb){if(this.Fqi()){if(this.Og.W6a&&this.Og.Pk&&(!this.Og.Pk.length||!this.Og.Pk[0].FieldInfoDataList))return;this.OZj(cb)}cb=zb.asEnumerable(this.IGa);cb=zb.concat(cb,this.jYh(this.eb.text));E.EwaSettings.isChangeGateEnabled("OfficeVSO:5501880_NamedObjectAutoCompleteDropdown")&&this.Nk&&(cb=zb.concat(cb,this.rZh()));zb.OBc(cb,Mb=>Mb.name,new Td.a);this.TSa&&(cb=zb.concat(zb.asEnumerable(this.UNb),cb),E.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")?
0<this.UNb.length?(this.pI||this.formulaAssistanceTelemetryManager.ED(["autoCompleteSmartSuggestionActiveDismissing","autoCompleteSmartSuggestionAccepted"]),this.pI=!0):this.pI&&this.Fkf&&(this.aaa=!0):0<this.UNb.length&&(this.pI=!0),this.UNb=[]);this.a8=zb.toArray(cb)}whh(){var cb=this.eb.text;if(E.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing")){var Mb=this.gridView.Ql?this.Vvb.vIa:this.Zqb.vIa,kc=!0;if(E.EwaSettings.isChangeGateEnabled("OfficeVSO:5962126_tableColHeadersListJSCrashFix")){if(""!==
Mb&&(this.Dg=Object(eb.a)(nc.a,this.$.yb.getItemByName(Mb))),this.Dg||(this.Dg=this.tableManager.Dg,kc=!1),!this.Dg){t.ULS.sendTraceTag(527234895,0,50,"FormulaAssistanceControl.createTableColHeaderAutoCompleteList - current table object is null. Total number of named objects in workbook: %d. Is target table name empty? %d");return}}else this.Dg=Object(eb.a)(nc.a,this.$.yb.getItemByName(Mb)),this.Dg||(this.Dg=this.tableManager.Dg,kc=!1);this.Dg.pO&&this.Dg.pO.IsFullTableHeaders?this.uNf(kc):Bb.d(this.Dg)?
(t.ULS.sendTraceTag(537162017,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Getting column headers for table with xluid - %s"),hc.q(this.$.oa.xa,this.Dg.Hi,this.qDd,this.pDd,null,null)):t.ULS.sendTraceTag(537162018,0,15,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Table with xluid %s has header rows turned off.")}else if(this.calcManager&&this.tableManager.Dg)if(Mb=this.calcManager.byb(this.tableManager.Dg))if(this.calcManager.Nse(this.tableManager.Dg,Mb)){cb=
zb.empty();if(91===this.eb.text.charCodeAt(this.eb.text.length-1)){const Uc=this.l1a("@ - "+this.instantaneousSupportInformationManager.Ie.ThisRowStructRefString);cb=zb.concat(cb,(kc=new Wb.a,kc.add(Uc),kc))}cb=zb.concat(cb,zb.select(zb.asEnumerable(Mb.toArray()),Uc=>{const qd=new ec,va=new $a;va._name=Uc.toString();qd.B6f(va);return qd}));this.a8=zb.toArray(cb)}else cb.endsWith("[")&&"["!==cb.charAt(cb.length-2)&&t.ULS.sendTraceTag(572381130,0,50,`FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns partial table header data with ${Mb.count} columns for a table with id ${this.tableManager.Dg.Hi} of size ${this.tableManager.Dg.usedRange.right-
this.tableManager.Dg.usedRange.left+1}`);else cb.endsWith("[")&&"["!==cb.charAt(cb.length-2)&&t.ULS.sendTraceTag(573149408,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns null inside a table during table column header autocomplete list creation")}LFh(cb){if(!cb)return!1;let Mb=cb.charCodeAt(0);if(46===Mb||48<=Mb&&57>=Mb||63===Mb)return!0;for(let kc=0;kc<cb.length;kc++,Mb=cb.charCodeAt(kc))if(!((E.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?
da.a.isLetter(Mb):da.a.qrd(Mb))||92===Mb||95===Mb||63===Mb||48<=Mb&&57>=Mb))return!0;return!1}OFd(cb,Mb){let kc=!1,Uc=!1;var qd=!1,va=0;let rb=0;this.L3a=0;this.fbc=Mb;this.G6b=1;for(let fc=Mb-1;0<=fc;--fc)switch(cb.charCodeAt(fc)){case 39:Uc=!Uc;break;case 34:kc=!kc;break;case 91:++va;qd=va>rb;break;case 93:++rb}qd=Object(Ja.a)(new ib,{Tsa:!kc,Usa:!Uc,Hha:!qd,EHb:1});va=this.f4i(cb,Mb,qd);Mb=this.g4i(cb,Mb,qd.Tsa,qd.Usa,qd.Hha);this.G6b=va+Mb;if(this.RSc=va-1)this.xzc=!1;this.AGh(cb,kc,Uc,qd.pFd,
qd.qFd)}god(){this.gridView.ha.Mga(this.nzf);const cb=ca.a.gAb()?this.gridView.Pb(null):void 0;this.rFb(cb);ca.a.bhc&&this.gridView.ni.UYa(this.a6);vf.ePd(this.pluginScheduler);this.TSa&&this.L3g()}cFh(){return this.TSa||this.RWe}h4i(){var cb=this.l5;if(!this.gGj||!cb)return this.TY=0,this.IGa=this.a8=null,!1;cb=cb.endsWith(Jc.a.oU);let Mb;if(E.EwaSettings.ra(128)&&({sheetRange:Mb}=this.dXj(this.l5.substring(0,this.r3))).returnValue){const kc=this.l5.substring(0,this.TY);if(cb&&kc!==this.qud)return this.qud=
kc,this.TY=this.l5.length-(cb?1:0),this.oZ(Mb,this.l5),this.Oia=!1,t.ULS.sendTraceTag(537162015,0,50,"Begin dot notation autocomplete"),!0}return!1}jYh(cb){const Mb=new Wb.a;this.calcManager&&E.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")&&t.ULS.shipAssertTag(537162014,0,!!this.calcManager.gta(Va.Range.Mc(1,1)),"FormulaAssistanceControl.GetLetVariables() - ConvertToSheetGridCell() is null");if(this.calcManager&&this.RWe&&(cb=this.calcManager.extractLetVariables(cb,
this.eb.textBox.caretPosition)))for(const kc of cb){cb=new ef;cb._name=kc;cb.j9=u.a.instance.ga(2218);const Uc=new ec;Uc.Rzj(cb);Mb.add(Uc)}return Mb}rZh(){const cb=new Wb.a,Mb=this.$.yb.items;for(let Uc=0,qd=Mb.length;Uc<qd;Uc++){var kc=Mb[Uc];if(!Eb.n(kc))continue;const va=new Nb;va._name=kc.name;kc=new ec;kc.hCj(va);cb.add(kc)}return cb}l1a(cb){const Mb=new ec,kc=new qc;kc._name=cb;Mb.iCj(kc);return Mb}uNf(cb){const Mb=new Wb.a,kc=this.eb.text.charCodeAt(this.eb.text.length-1),Uc=this.eb.textBox.caretPosition-
1;if(E.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?91===this.eb.text.charCodeAt(Uc):91===kc){var qd=this.l1a("@ - "+this.instantaneousSupportInformationManager.Ie.ThisRowStructRefString);Mb.add(qd)}for(var va of this.Dg.pO.HeadersList){qd=new ec;const rb=new $a;rb._name=va.Name;qd.B6f(rb);Mb.add(qd)}va=this.gridView.Ql?this.Vvb.RP:this.Zqb.RP;qd=this.eb.text.charCodeAt(va+1);(E.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?
!cb||Uc!==va&&35!==qd:!cb||91!==kc&&35!==kc)||(cb=this.l1a("#"+this.instantaneousSupportInformationManager.Ie.AllStructRefString),Mb.add(cb),cb=this.l1a("#"+this.instantaneousSupportInformationManager.Ie.DataStructRefString),Mb.add(cb),cb=this.l1a("#"+this.instantaneousSupportInformationManager.Ie.HeadersStructRefString),Mb.add(cb),cb=this.l1a("#"+this.instantaneousSupportInformationManager.Ie.TotalsStructRefString),Mb.add(cb));Mb&&(this.a8=Mb.toArray())}OZj(cb){let Mb=zb.empty();!cb&&this.functionInfoManager.hV&&
(Mb=zb.concat(Mb,zb.select(zb.asEnumerable(this.functionInfoManager.ebc),kc=>{const Uc=new ec;Uc.e5f(kc);return Uc})),cb=this.v7b.cLe,0<cb.length&&(Mb=zb.OBc(zb.concat(Mb,zb.select(zb.asEnumerable(cb),kc=>{const Uc=new ec;Uc.nyj(kc);return Uc})),kc=>kc.name,new Td.a)));if(this.Og.W6a&&this.Og.Pk){if(!this.Og.Pk.length||!this.Og.Pk[0].FieldInfoDataList)return;Mb=zb.OBc(zb.concat(Mb,zb.select(zb.asEnumerable(this.Og.Pk[0].FieldInfoDataList),kc=>{const Uc=new ec;Uc.Lyj(kc);return Uc})),kc=>kc.name,new Td.a);
this.columnName=this.Og.Pk[0].ColumnName}this.IGa=zb.toArray(Mb)}rFb(cb){var Mb;const kc=this.gridView.ha.qa.activeCell;if(kc){var Uc=this.calcManager.gta(kc,!1);if(Uc){var qd=this.$.va,va=Uc.sheet.index;0>=qd.count||0>va||va>=qd.count?t.ULS.sendTraceTag(512278611,0,50,`FormulaAssistanceControl.NotifyActiveCellChanged invalid sheet index. ewaSheetsCount = ${qd.count}, currentSheetIndex = ${va}.`):(va=qd=null,this.lBd&&void 0!==this.calcManager&&null!==this.calcManager&&(cb=null!==(Mb=null===cb||void 0===
cb?void 0:cb.cell)&&void 0!==Mb?Mb:this.gridView.Ca.Ur(kc))&&(Mb=this.calcManager.$cc(cb.hj),void 0!==Mb&&null!==Mb&&(qd=Mb.FormatString,va=Mb.Builtin)),this.pluginScheduler.notifier().setActiveCell({colIndex:Uc.range.col,rowIndex:Uc.range.row,sheetIndex:this.$.va.getItem(Uc.sheet.index).sheetId,docName:Uc.sheet.document.name,docPath:Uc.sheet.document.path,formatString:qd,builtIn:va}),t.ULS.sendTraceTag(512278610,0,50,`FormulaAssistanceControl.NotifyActiveCellChanged sent notification to the scheduler. col: ${Uc.range.col}, row: ${Uc.range.row}, format: ${qd}`))}else t.ULS.sendTraceTag(512278612,
0,50,"FormulaAssistanceControl.NotifyActiveCellChanged ISheetGridCell location is null")}else t.ULS.sendTraceTag(512278613,0,50,"FormulaAssistanceControl.NotifyActiveCellChanged activeCell range is null")}Z0f(){this.formulaAssistanceTelemetryManager.FH={Yj:this.gridView.ha.qa.activeCell,s3b:this.gridView.Vb.text,Rrb:!0};this.formulaAssistanceTelemetryManager.jDb=this.$.ea.se;this.formulaAssistanceTelemetryManager.mlc=this.$.va.na.sheetId;this.$.userOperationManager.Zq(this.cPa)}L3g(){this.gridView.Ql?
this.Vvb.wY(!1):this.Zqb.wY(!1)}Dnf(cb){let Mb;Mb=E.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?da.a.isLetter(cb):da.a.qrd(cb);return 48<=cb&&57>=cb||46===cb||95===cb||Mb}show(){if(this.dr){var cb=this.Qg.Dkg(0);this.Nk?0<this.Qg.Vo.length?(this.formulaAssistanceTelemetryManager.ZXf(this.Qg.Vrb),cb||this.B$f()):this.Y1a():((cb=0<this.Qg.Vo.length)&&this.formulaAssistanceTelemetryManager.ED(["autoCompleteRender"]),!this.re&&this.columnName&&
cb&&this.Qg.pbj(this.Qg.Vo.length,this.columnName),this.re=cb,this.fja.show(this.QP),this.TBa(!0),this.Qg.gya(),cb&&this.formulaAssistanceTelemetryManager.gw(["autoCompleteRender"]))}}g4i(cb,Mb,kc,Uc,qd){for(kc=Object(Ja.a)(new ib,{OKf:41,GDe:40,Tsa:kc,Usa:Uc,Hha:qd});Mb<cb.length&&!this.RLf(cb,Mb,kc);++Mb);return kc.EHb}f4i(cb,Mb,kc){for(--Mb;0<=Mb&&!this.RLf(cb,Mb,kc);--Mb);return kc.EHb}RLf(cb,Mb,kc){const Uc=cb.charCodeAt(Mb);0>=this.r3&&(this.r3=cb.substring(0,Mb).lastIndexOf(Jc.a.oU));46===
Uc&&(Mb<this.r3?this.r3=Mb:Mb>this.Ytb&&(this.TY=this.Ytb=Mb));if(!this.Dnf(Uc)&&!vf.Awi(Uc)&&(!this.nka||Mb<=this.r3||!vf.mei(Uc,kc))){kc.GBf&&(kc.GBf=!1,this.L3a=Mb+1);if(kc.WDd){kc.qFd=Mb+1;if(this.functionInfoManager.Sgd(cb.substring(kc.qFd,kc.pFd)))return!0;kc.WDd=!1}switch(Uc){case 39:kc.Usa=!kc.Usa;break;case 34:kc.Tsa=!kc.Tsa;break;case 91:kc.Hha=!1;break;case 93:kc.Hha=!0}Uc===this.$.listSeparator.toString().charCodeAt(0)&&kc.Usa&&kc.Tsa&&!kc.x0a&&(!this.nka||kc.Hha)&&(Mb<kc.TPd||-1===kc.TPd)&&
(kc.EHb+=1,this.G6b++);Uc===kc.GDe&&kc.Tsa&&kc.Usa&&(!this.nka||kc.Hha)?kc.x0a+=1:Uc===kc.OKf&&kc.Tsa&&kc.Usa&&(!this.nka||kc.Hha)?0<kc.x0a?--kc.x0a:(kc.TPd=kc.tYe,kc.tYe=Mb,0<Mb&&this.Dnf(cb.charCodeAt(Mb-1))&&(kc.WDd=!0,kc.pFd=Mb)):this.nka&&46===Uc&&Mb>this.r3&&(Mb<this.r3?this.r3=Mb:Mb>this.Ytb&&(this.TY=this.Ytb=Mb))}return!1}AGh(cb,Mb,kc,Uc,qd){this.fbc>this.L3a&&0<=this.L3a?Mb||kc||(this.oV=cb.substring(this.L3a,this.fbc)):this.oV=null;Uc!==qd?(cb=cb.substring(qd,Uc),this.QP&&da.a.equals(this.QP.NameDataStrings,
cb,!0)||(this.xzc=!0),this.QP=this.functionInfoManager.Sgd(cb)):(this.xzc=!1,this.QP=null)}Ocg(cb){const Mb=$get(m.LLf+"_"+m.DHb,this.domElement),kc=$get(m.MLf+"_"+m.DHb,this.domElement);cb&&!this.$ec?(Mb&&kb.a.instance.ta(jb.a.click,Mb,this.Dca),kc&&kb.a.instance.ta(jb.a.click,kc,this.Dca),this.$ec=!0):this.$ec&&(Mb&&kb.a.instance.Ba(jb.a.click,Mb,this.Dca),kc&&kb.a.instance.Ba(jb.a.click,kc,this.Dca),this.$ec=!1)}dXj(cb){let Mb;Mb=null;var kc;if(({sheetName:Uc,range:kc}=ja.Y(cb,this.$.ea.va)).returnValue&&
kc){if(!Uc){var Uc=Object(eb.a)(Fd.a,this.$.na);if(!Uc)return{returnValue:!1,sheetRange:Mb};Uc=Uc.name}Mb=ja.v(kc,this.$);Mb.SheetName=Uc;this.l8c=!1;return{returnValue:!0,sheetRange:Mb}}return({sheetName:Uc,range:kc}=this.v7b.NWj(cb)).returnValue?(Mb=ja.v(kc,this.$),Mb.SheetName=Uc,this.l8c=!0,{returnValue:!0,sheetRange:Mb}):{returnValue:!1,sheetRange:Mb}}cPd(cb){cb={content:cb,isCellContentOnlyEqualDuringEdit:this.isCellContentOnlyEqualDuringEdit};this.Nka?this.pluginScheduler.getRequester().runAuthoringExperiment(cb,
0):this.pluginScheduler.requester().runAuthoringExperiment(cb)}lnd(){if(1===this.Qg.ZV.length&&this.dr.length){var cb=this.dr[this.Qg.ZV[0]];if(1===cb.itemType){var Mb=cb.name;cb=this.eb.text;Mb=Mb.substring(cb.length,Mb.length);Mb.length&&(this.eb.text=cb+Mb,this.eb.textBox.selectRange(cb.length,this.eb.text.length))}}else t.ULS.shipAssertTag(537162007,0,!1,`InCellAutoComplete should only be called when there is 1 item (number of items: ${this.Qg.ZV.length})`)}Slc(cb,Mb,kc,Uc){const qd={};qd.a=cb;
qd.b=Mb;qd.c=kc;qd.d=Uc;Ae.b().Se(38,qd,!0)}Pve(cb,Mb){if(!this.functionInfoManager.hV){if(cb)if(this.OFd(this.eb.text,this.eb.textBox.caretPosition),this.TSa||this.oV){const kc={};kc.Filter=this.oV?this.oV.charAt(0).toString():"";kc.FilterType=1;kc.IncludeOneOfEachGroupUI=!1;this.functionInfoManager.eJa(kc)}else E.EwaSettings.isChangeGateEnabled("OfficeVSO:6518663_FlightRemovalAutocompleteTableColumnHeaders")&&this.get_visible()&&this.set_visible(!1);if(!Mb)return}0<this.$.qb.oR||this.eb&&!this.eb.fb?
this.set_visible(!1):cb&&(this.OFd(this.eb.text,this.eb.textBox.caretPosition),this.fja.update(this.QP,this.G6b,this.RSc,this.xzc),this.l5=this.eb.text.substring(1,this.eb.textBox.caretPosition),this.r3=this.l5.indexOf(Jc.a.oU),this.TY=this.l5.lastIndexOf(Jc.a.oU),this.h4i()?(cb=new ec,cb.IAj(),this.IGa=this.a8=cb=[cb],this.Qg.U0j(cb),this.show()):((this.cFh()||this.Uwa())&&this.kHe(!1),0<this.TY?this.Qg.IJa(this.dr,this.l5,!1,void 0,this.l5.lastIndexOf(Jc.a.oU),!1):this.Qg.IJa(this.dr,this.oV,!1,
void 0,this.TY,!1),this.show(),this.Nk&&(this.Qg.Vo.length||this.gridView.ni.GK?this.fja.a8b():(this.fja.tNd(),this.Nk&&this.Y1a()))))}B$f(){if(0<this.Qg.Vo.length){this.formulaAssistanceTelemetryManager.ED(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){const cb={};cb.zoomLevel=aa(this.$);this.formulaAssistanceUIControl.updateContext(cb);this.Co=()=>{this.formulaAssistanceUIControl.renderAutoCompleteMenu(this.J1b,this.gridView.ni.textBox.domElement,this.vcc(),()=>{})};this.Co();this.Nk&&
this.Qg.Qjc&&this.raiseEvent(vf.Ydd,null);this.ipd||this.Qg.Qjc||this.raiseEvent("FormulaAutoCompleteShown");this.ipd=this.yq.Ff=!0}this.formulaAssistanceTelemetryManager.gw(["autoCompleteRender"]);E.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.pI&&this.Fkf&&(this.aaa=!0)}}ywd(){this.MIa&&(this.formulaAssistanceTelemetryManager.dJ.selectByArrowKeyCounter++,this.MIa=!1);this.NIa&&(this.formulaAssistanceTelemetryManager.dJ.selectByMouseHoverCounter++,this.NIa=
!1);this.LIa&&(this.formulaAssistanceTelemetryManager.dJ.commitByTabKeyCounter++,this.LIa=!1);this.JIa&&(this.formulaAssistanceTelemetryManager.dJ.commitByEnterKeyCounter++,this.JIa=!1);this.KIa&&(this.formulaAssistanceTelemetryManager.dJ.commitByMouseClickCounter++,this.KIa=!1);E.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.mia&&(this.formulaAssistanceTelemetryManager.dJ.dismissSmartSuggestionExplicitlyCounter++,this.mia=!1)}vcc(){const cb=new Oe;cb.completionItems=
this.Qg.Vrb;cb.activeItemIndex=this.Qg.Ej?this.Qg.Ej.rowIndex:-1;this.QKd(cb);return cb}QKd(cb){cb.callbacks=new df;cb.callbacks.onCompletionItemSelected=this.ICd;cb.callbacks.onCompletionItemCommitted=this.HCd;cb.callbacks.onFeedback=this.IRa;cb.callbacks.onDismiss=this.onDismiss;cb.callbacks.onRestoreFocus=this.onRestoreFocus}zHd(cb){this.xfa=!0;const Mb=cb.textEdit.newText;this.eb.$na(Mb.substring(this.eb.text.length-cb.textEdit.range.start.character,Mb.length))}VEe(){E.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&
this.formulaAssistanceTelemetryManager.gw(["autoCompleteSmartSuggestionAccepted"]);this.Ny(!0);this.xfa=this.re=!1;this.USa=this.eoa=!0}vod(cb,Mb){this.eb.text=cb.substring(0,Mb.range.start.character)+Mb.newText+cb.substring(Mb.range.end.character,cb.length);this.gridView.Ql&&(this.gridView.Vb.text=this.eb.text)}static ePd(cb){E.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUse")?cb.getRequester().runExperiment(new cf,0):cb.requester().runExperiment(new cf)}static w$g(cb){const Mb=
ec.ghh(),kc={IsCompatibility:!1};kc.NameDataStrings=cb.label;kc.Help=cb.detail;Mb.e5f(kc);Mb.textEdit=cb.textEdit;return Mb}static fKa(){const cb=String.format(m.lLh,m.sed,gd.a.tSe),Mb=String.format(m.hLh,m.ped,zc.a.O9b,n.a.jo,n.a.io),kc=String.format(m.dLh,m.ked,zc.a.O9b,n.a.jo,zc.a.mTe,n.a.io);return`${cb}
${Mb}
${kc}`}static Awi(cb){return 36===cb||58===cb||33===cb||39===cb||32===cb}static mei(cb,Mb){return 32===cb||91===cb||!Mb.Hha}}vf.Ydd="FACardOpened";vf.xdd="FAFocusOnSmartSuggestionsCard";vf.Gfc=null;Object(d.a)(vf,"FormulaAssistanceControl",wc.a,[586,557,2,587,588]);class hf{constructor(cb){this.fv=cb;this.VA=this.rSa=this.Ci=!1;this.onKeyDown=Mb=>this.VA||"Space"!==Mb.code&&" "!==Mb.key||!Mb.altKey||!Mb.ctrlKey?!1:(this.F2a(),Mb.stopPropagation(),Mb.preventDefault(),!0);this.hla=Mb=>{if(!this.VA)return!1;
if(Mb.eventName===jb.a.Sb){const kc=Mb.Ea.ctrlKey?1:Mb.Ea.shiftKey?50:10;switch(Mb.Ea.keyCode){case ve.a.Woa:this.tK(0,-kc);break;case ve.a.R7:this.tK(0,kc);break;case ve.a.S7:this.tK(-kc,0);break;case ve.a.eCa:this.tK(kc,0);break;case ve.a.ZF:case ve.a.Lh:this.rSa=!0;break;default:return!1}}Mb.eventName===jb.a.Ld&&this.rSa&&this.vM(!0);Mb.Ea.preventDefault();return!0};this.hza=Mb=>{if(!this.VA)return!1;Mb.Ea.preventDefault();this.vM();return!0};this.onBlur=()=>{if(!this.VA)return!1;this.vM();return!0};
this.to=Re.KeyInputManager.instance;this.pointerInputManager=be.a.instance}ka(cb){(this.root=cb)&&!this.Ci&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.Ci=!0)}detach(){this.root&&this.Ci&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.Ci=!1)}F2a(){this.root&&(this.fv.TGb("move",!0),this.root.focus(),this.VA=!0,this.rSa=!1,this.Et(),this.iya||this.Hsb(),this.root.appendChild(this.iya))}vM(cb=!1){this.VA&&(this.VA=!1,this.fv.gpc(cb),this.FJb(),this.vJb())}Et(){this.to.capture(this.hla,
null);this.pointerInputManager.ms(jb.a.pointerDown,this.root,this.hza,!0);this.root.addEventListener("blur",this.onBlur)}vJb(){this.to.releaseCapture();this.pointerInputManager.ys(jb.a.pointerDown,this.root,this.hza,!0);this.root.removeEventListener("blur",this.onBlur)}FJb(){var cb;null===(cb=this.iya)||void 0===cb?void 0:cb.remove()}tK(cb,Mb){const kc=this.fv.getPosition();kc.x+=cb;kc.y+=Mb;this.fv.setPosition(kc)}Hsb(){this.iya=rf.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",
!0,"")}}Object(d.a)(hf,"FormulaAssistanceMoveAdapter",null,[]);class Mf{constructor(cb){this.fv=cb;this.startOffset={x:0,y:0};this.ubg=!0;this.Ci=!1;this.mZc=E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeArgumentAssistanceDragCursorToMove",!1)}I4(){return this.Ci&&!!this.UC}Dya(cb){this.mZc||(this.UC.style.cursor="grabbing");const Mb=this.fv.getPosition();this.ubg=Mb.renderDown;this.startOffset.x=Mb.x-cb.clientPoint.x;this.startOffset.y=Mb.y-cb.clientPoint.y;this.fv.TGb("drag");
return!0}Bca(cb){this.fv.setPosition({x:cb.clientPoint.x+this.startOffset.x,y:cb.clientPoint.y+this.startOffset.y,renderDown:this.ubg});return!0}Aca(){this.fw()}zca(){this.fw()}ka(cb,Mb){this.UC=Mb;this.root=cb;this.UC&&(this.UC.style.cursor=this.mZc?"move":"grab",Ye.a.instance.jW(this.UC,this,!1),this.Ci=!0)}detach(){this.Ci&&this.UC&&(this.UC.style.cursor="",Ye.a.instance.O0(this.UC,this),this.Ci=!1)}fw(){this.mZc||(this.UC.style.cursor="grab")}}Object(d.a)(Mf,"FormulaAssistanceDragAdapter",null,
[660]);class xf{get getPosition(){return this.sxg}get setPosition(){return this.Hje}constructor(cb){this.formulaAssistanceTelemetryManager=cb;this.Ci=!1;this.BGa=E.EwaSettings.isChangeGateEnabled("OfficeVSO:7376612_argumentAssistanceOrderedActionsTelemetry");this.T0={[sc.Drag]:0,[sc.Move]:0};this.NEb=new hf(this);this.$tb=new Mf(this)}ka(cb,Mb,kc,Uc){this.sxg=kc;this.Hje=Uc;this.NEb.ka(cb);this.$tb.ka(cb,Mb);this.Ci=!0}detach(){this.Ci&&(this.$tb.detach(),this.NEb.detach(),this.Ci=!1)}clear(){var cb;
null===(cb=this.Hje)||void 0===cb?void 0:cb.call(this,null);this.detach();this.wKb()}TGb(cb,Mb=!1){this.T0[cb]++;Mb&&(this.XPa=document.activeElement)}gpc(cb=!0){this.XPa&&(cb&&this.XPa.focus(),this.XPa=null)}wKb(){const cb=this.formulaAssistanceTelemetryManager.mP,Mb=this.T0[sc.Drag],kc=this.T0[sc.Move];0<Mb&&(this.formulaAssistanceTelemetryManager.YI("d"),this.BGa||(cb.argumentAssistanceDragTotalCounter+=Mb),this.T0[sc.Drag]=0);0<kc&&(this.formulaAssistanceTelemetryManager.YI("m"),this.BGa||(cb.argumentAssistanceMoveTotalCounter+=
kc),this.T0[sc.Move]=0)}}Object(d.a)(xf,"FormulaAssistanceDragControl",null,[]);var sc;(function(cb){cb.Drag="drag";cb.Move="move"})(sc||(sc={}));Object(d.b)("FormulaAssistanceDragMode",sc);class ad extends wd.a{constructor(cb,Mb,kc){super(ad.fKa());this.$=cb;this.formulaAssistanceUIControl=Mb;this.formulaAssistanceTelemetryManager=kc;this.showCollapseText=this.isExpanded=!0;this.T9=0;this.lla=this.Co=this.yq=null;this.Ru=!1;this.setPosition=Uc=>{this.formulaAssistanceUIControl.setFixedPosition(Uc);
this.formulaAssistanceUIControl.updatePosition(0)};this.getPosition=()=>this.formulaAssistanceUIControl.getPosition();this.Uc=()=>{this.visible=!1};this.onCardModeChange=Uc=>{this.W_d(Uc);this.showCollapseText=!1;1===Uc?this.formulaAssistanceTelemetryManager.YI("c"):this.formulaAssistanceTelemetryManager.YI("e")};this.onIsExpandedChange=Uc=>{this.I0j(Uc);this.showCollapseText=!1;Uc?this.formulaAssistanceTelemetryManager.YI("e"):this.formulaAssistanceTelemetryManager.YI("c")};this.IRa=Uc=>{M(this.$,
"ArgumentAssistanceCard",Uc.functionName);this.formulaAssistanceTelemetryManager.YI("gf")};this.zt=()=>{this.N4?this.formulaAssistanceUIControl.updatePosition(0):void 0!==this.Co&&null!==this.Co&&this.Co()};this.$f=()=>{this.N4?this.fv.clear():this.l9c.clear()};this.N4=E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceUiPosition",!1);this.KRd();this.yq=new he(this.$,this.formulaAssistanceUIControl,0,Ab.a.Qdd);this.grid=Object(H.h)(cb);this.grid.view.Ps(this.zt);this.grid.ha.eC(this.Uc);
this.N4?this.fv=new xf(this.formulaAssistanceTelemetryManager):this.l9c=new Ve(this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);this.grid.mc.Km(this.$f);E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&this.$.domElement.appendChild(this.domElement)}Oqe(cb){this.addHandler("FAFunctionNameUpdated",cb)}uWf(cb){this.removeHandler("FAFunctionNameUpdated",cb)}Gre(cb){this.addHandler("FAParameterSelectionChangedOld",cb)}SWf(cb){this.removeHandler("FAParameterSelectionChangedOld",
cb)}Fre(cb){this.addHandler("FAParameterSelectionChanged",cb)}RWf(cb){this.removeHandler("FAParameterSelectionChanged",cb)}get visible(){return this.Ru}set visible(cb){cb||this.dismiss();this.Ru=cb}dismiss(){this.Ru=!1;this.formulaAssistanceUIControl&&(this.Co=null,this.N4?this.fv.detach():this.l9c.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),this.lla=null,this.yq.Ff=!1)}WKj(cb,Mb){this.Ru=!0;const kc=this.xsc(cb);if(this.formulaAssistanceUIControl){this.formulaAssistanceTelemetryManager.ED(["argumentAssistanceRender"]);
cb={};cb.zoomLevel=aa(this.$);this.formulaAssistanceUIControl.updateContext(cb);const Uc=()=>{};E.EwaSettings.isChangeGateEnabled("OfficeVSO:5470368_FormulaAssistanceScroll")?(this.Co=()=>{this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,Mb,kc,Uc)},this.Co()):this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,Mb,kc,Uc);this.Dvc();this.Orc(kc);this.l9c.ka(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),
this.Co,()=>this.formulaAssistanceUIControl.dismiss(this.domElement));this.yq.Ff=!0;this.formulaAssistanceTelemetryManager.gw(["argumentAssistanceRender"]);this.formulaAssistanceTelemetryManager.iua("argumentAssistanceOverall")}}show(cb,Mb){this.N4?this.XKj(cb):this.WKj(cb,Mb)}XKj(cb){this.Ru=!0;const Mb=this.xsc(cb);if(this.formulaAssistanceUIControl){this.formulaAssistanceTelemetryManager.ED(["argumentAssistanceRender"]);const kc=()=>c(this.$);this.Co=()=>{this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,
void 0,Mb,kc)};this.Co();this.Dvc();this.Orc(Mb);this.fv.ka(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),this.getPosition,this.setPosition);this.yq.Ff=!0;this.formulaAssistanceTelemetryManager.gw(["argumentAssistanceRender"]);this.formulaAssistanceTelemetryManager.iua("argumentAssistanceOverall")}}dispose(){this.$&&this.grid&&(this.grid.ha&&this.grid.ha.vB(this.Uc),this.grid.view.Mq(this.zt),this.grid.mc.$l(this.$f));ka.a.Ja(this.yq);
this.$=null}xsc(cb){const Mb=new we;Mb.functionRenderingInfo=cb;Mb.showCollapseText=this.showCollapseText;this.N4?Mb.isExpanded=this.isExpanded:Mb.cardMode=this.T9;this.UKd(Mb);return Mb}UKd(cb){cb.callbacks=new ce;cb.callbacks.onHelpLink=this.bhd(cb.functionRenderingInfo);this.N4?cb.callbacks.onIsExpandedChange=this.onIsExpandedChange:cb.callbacks.onCardModeChange=this.onCardModeChange;cb.callbacks.onFeedback=this.IRa}bhd(cb){return()=>{N(this.$,cb.helpID,cb.isUDF)}}KRd(){const cb=jd.a.get(C.a.npb);
this.N4?(cb?(this.isExpanded="false"!==cb,this.showCollapseText=!1):(this.isExpanded=ad.gkh,this.formulaAssistanceTelemetryManager.L3f()),this.formulaAssistanceTelemetryManager.nxj(this.isExpanded)):(cb?(this.T9=parseInt(cb,10),this.showCollapseText=!1):(this.T9=ad.c8c,this.formulaAssistanceTelemetryManager.L3f()),this.formulaAssistanceTelemetryManager.M3f(this.T9))}Orc(cb){var Mb=cb.functionRenderingInfo.functionName;this.lla&&da.a.equals(this.lla,Mb,!0)?(Mb=md.a.map(cb.functionRenderingInfo.signatures,
kc=>{let Uc="";0<=kc.signatureParams.activeParam&&kc.signatureParams.activeParam<kc.signatureParams.params.length&&(Uc=kc.signatureParams.params[kc.signatureParams.activeParam]);return Uc}),this.raiseEvent("FAParameterSelectionChanged",new ic(Mb))):(this.lla=Mb,cb=md.a.map(cb.functionRenderingInfo.signatures,kc=>kc.signatureParams.params.join(", ")),this.raiseEvent("FAFunctionNameUpdated",new Pd(Mb,cb)))}W_d(cb){this.T9=cb;try{jd.a.Cv(C.a.npb,cb.toString(),vd.AFrame.M0)}catch(Mb){t.ULS.sendTraceTag(537162074,
0,15,`Failed setting ArgumentAssistanceCardCollapseState cookie with error message: ${Mb.message}`)}}I0j(cb){this.isExpanded=cb;try{jd.a.Cv(C.a.npb,cb.toString(),vd.AFrame.M0)}catch(Mb){t.ULS.sendTraceTag(512267714,0,15,`Failed setting ArgumentAssistanceCardCollapseState cookie with error message: ${Mb.message}`)}}static fKa(){return document.createElement("div")}Dvc(){const cb=this.getPosition().renderDown?"rd":"ru";this.formulaAssistanceTelemetryManager.YI(cb)}}ad.c8c=0;ad.gkh=!0;Object(d.a)(ad,
"FormulaArgumentAssistanceControl",wd.a,[634]);var gb;(function(cb){cb[cb.Dismissed=0]="Dismissed";cb[cb.Smart=1]="Smart";cb[cb.Simple=2]="Simple";cb[cb.Mixed=3]="Mixed"})(gb||(gb={}));Object(d.b)("UIState",gb);class Hb extends wd.a{constructor(cb,Mb,kc){super(Hb.fKa());this.$=cb;this.formulaAssistanceUIControl=Mb;this.formulaAssistanceTelemetryManager=kc;this.yq=this.eb=this.gridView=null;this.aaa=this.mia=this.KIa=this.JIa=this.LIa=this.NIa=this.MIa=!1;this.dr=null;this.yW=0;this.Co=null;this.USa=
this.eoa=this.pI=this.xfa=this.Ru=!1;this.JPb=gb.Dismissed;this.onRestoreFocus=()=>{};this.dismiss=()=>{this.Ru=!1;this.i7a&&this.pI&&this.AMa&&(this.aaa=!0);this.ywd();this.fF&&this.eb.fb&&this.Yma();this.Co=null;this.formulaAssistanceUIControl&&(this.formulaAssistanceUIControl.dismiss(this.domElement),this.yq.Ff=!1,this.JPb=gb.Dismissed)};this.rkd=()=>{this.raiseEvent("FAFocusOnSmartSuggestionsCard",null)};this.Gca=(Uc,qd)=>{0==qd.Iq&&(170==qd.Lf.operation.operationName&&this.formulaAssistanceTelemetryManager.olc++,
this.$.userOperationManager.Un(this.Gca))};this.cPa=(Uc,qd)=>{0==qd.Iq&&(12==qd.Lf.operation.operationName&&this.$.userOperationManager.Zq(this.Gca),this.$.userOperationManager.Un(this.cPa))};this.nRi=()=>{this.dismiss();this.gridView.ni.textBox.focus()};this.IRa=()=>{const Uc={};Uc[C.a.wM]=this.yKf?"SmartSuggestionsCard":this.ZVd?"FunctionAndSmartSuggestionsCard":"SimpleAutoCompleteCard";this.$.Yc(802602464,0,8,Uc)};this.$f=()=>{E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartSuggestionSurvey",
!1)&&1===this.formulaAssistanceTelemetryManager.$G.smartSuggestionShownCounter&&this.pI&&this.$.Yc(1073817162,-1,0,null);this.AMa&&this.xQg()};this.ICd=(Uc,qd)=>{this.Agb(qd);this.NIa=!0};this.Uc=()=>{this.visible=!1};this.HCd=Uc=>{this.KIa=!0;this.Prb(Uc)};this.ij=()=>{this.dismiss()};this.zt=()=>{this.N4?this.formulaAssistanceUIControl.updatePosition(1):void 0!==this.Co&&null!==this.Co&&this.Co()};this.gridView=H.h(this.$);this.yq=new he(this.$,this.formulaAssistanceUIControl,1,Ab.a.Sdd,this.rkd);
this.gridView.view.Ps(this.zt);this.gridView.ha.eC(this.Uc);this.$.va.Vf(this.ij);this.AMa=E.EwaSettings.isChangeGateEnabled("OfficeVSO:5523443_FormulaSuggestionsCardUserInteractionTelemetry");this.N4=E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceRedesign",!1)&&E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceUiPosition",!1);this.i7a=E.EwaSettings.isChangeGateEnabled("OfficeVSO:6650011_LogSuggestionsDismissal");this.AMa&&this.gridView.mc.Km(this.$f);
E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&this.$.domElement.appendChild(this.domElement)}Mqe(cb){this.addHandler("FACardOpened",cb)}tWf(cb){this.removeHandler("FACardOpened",cb)}Kqe(cb){this.addHandler("FAFocusOnSmartSuggestionsCard",cb)}rWf(cb){this.removeHandler("FAFocusOnSmartSuggestionsCard",cb)}Lqe(cb){this.addHandler("FormulaAutoCompleteShown",cb)}sWf(cb){this.removeHandler("FormulaAutoCompleteShown",cb)}NXc(cb){this.addHandler("SelectedRowChanged",
cb)}qMd(cb){this.removeHandler("SelectedRowChanged",cb)}S_b(cb){this.addHandler("ListBoxUpdated",cb)}Ruc(cb){this.removeHandler("ListBoxUpdated",cb)}dispose(){this.$&&(this.$.userOperationManager.Un(this.Gca),this.$.userOperationManager.Un(this.cPa),this.gridView&&(this.gridView.ha&&this.gridView.ha.vB(this.Uc),this.gridView.mc&&this.AMa&&this.gridView.mc.$l(this.$f),this.gridView.view.Mq(this.zt)),this.$.va&&this.$.va.sg(this.ij));ka.a.Ja(this.yq);this.$=null}mMg(cb){this.addHandler("CVIC",cb)}zjj(cb){this.removeHandler("CVIC",
cb)}get visible(){return this.Ru}set visible(cb){cb||this.dismiss();this.Ru=cb}get fF(){return this.xfa}get ZVd(){var cb,Mb;return 1===(null===(Mb=null===(cb=this.dr)||void 0===cb?void 0:cb.items[0])||void 0===Mb?void 0:Mb.type)}get yKf(){return 1===this.dr.items.length&&this.ZVd}Oh(cb,Mb){if(!this.visible)return!1;this.KDc(Mb);let kc;return(kc=this.F$h(Mb)).Eec?kc.result:this.JFj(Mb)}pyb(cb){if(!this.visible)return!1;let Mb=!1;switch(cb){case 1872288872:this.fF&&this.Yma();this.i7a&&this.ZVd&&(this.formulaAssistanceTelemetryManager.gw(["autoCompleteSmartSuggestionActiveDismissing"]),
this.mia=!0);this.visible=!1;Mb=!0;break;case -798660877:this.Agb(this.Xxb(this.yW+1));Mb=!0;break;case 137938150:this.Agb(this.Xxb(this.yW-1));Mb=!0;break;case 2091832999:this.Agb(this.Xxb(this.yW+8));Mb=!0;break;case 742457698:this.Agb(this.Xxb(this.yW-8));Mb=!0;break;case 125627505:case 267796030:this.Prb(this.dr.items[this.yW]),Mb=!0}return Mb}show(cb){this.eb=this.gridView.ni;this.Ru=!0;this.yW=0;this.dr=cb;0<this.dr.items.length&&(this.render(),this.Agb(this.Xxb(this.yW)),this.i7a?this.AMa&&
(1===this.dr.items[0].type?(this.pI||this.formulaAssistanceTelemetryManager.ED(["autoCompleteSmartSuggestionActiveDismissing","autoCompleteSmartSuggestionAccepted"]),this.pI=!0):this.pI&&(this.aaa=!0)):1===this.dr.items[0].type&&this.AMa&&(this.pI=!0));this.formulaAssistanceTelemetryManager.ZXf(cb.items)}Yma(){this.xfa=!1;this.eb.FMe()}JFj(cb){return[1872288872,-798660877,137938150,2091832999,742457698,125627505,267796030].includes(cb)}F$h(cb){return this.fF?125627505===cb||267796030===cb?(this.Prb(this.dr.items[this.yW]),
{Eec:!0,result:!1}):!this.yKf||-798660877!==cb&&137938150!==cb?{Eec:!1}:{Eec:!0,result:!1}:{Eec:!1}}render(){this.formulaAssistanceTelemetryManager.ED(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){if(this.N4){const cb=()=>c(this.$);this.Co=()=>{this.formulaAssistanceUIControl.renderAutoCompleteMenu(this.domElement,void 0,this.vcc(),cb)}}else{const cb={};cb.zoomLevel=aa(this.$);this.formulaAssistanceUIControl.updateContext(cb);this.Co=()=>{this.formulaAssistanceUIControl.renderAutoCompleteMenu(this.domElement,
this.eb.textBox.domElement,this.vcc(),()=>{})}}this.Co();this.ebj();this.yq.Ff=!0;this.jsh()}}jsh(){this.formulaAssistanceTelemetryManager.gw(["autoCompleteRender"]);this.formulaAssistanceTelemetryManager.iua("autoCompleteOverall");const cb=this.dr.items.some(kc=>1===kc.type),Mb=this.dr.items.some(kc=>0===kc.type);cb&&Mb?this.formulaAssistanceTelemetryManager.iua("autoCompleteOverallSimpleAndSmart"):cb?this.formulaAssistanceTelemetryManager.iua("autoCompleteOverallSmartOnly"):Mb&&this.formulaAssistanceTelemetryManager.iua("autoCompleteOverallSimpleOnly")}ebj(){const cb=
this.JPb;this.JPb=this.U5h(this.dr.items);cb!==gb.Dismissed&&cb!==gb.Smart||this.JPb!==gb.Simple&&this.JPb!==gb.Mixed||this.raiseEvent("FormulaAutoCompleteShown")}Nbj(){var cb;if(0!==this.dr.items.length){var Mb=0<=this.yW?this.yW:0,kc=this.dr.items[Mb];kc={GF:kc.label,description:null!==(cb=kc.detail)&&void 0!==cb?cb:"",selectedIndex:Mb+1,length:this.dr.items.length};this.raiseEvent("SelectedRowChanged",kc)}}Prb(cb){if(this.eb&&this.visible){var Mb=cb.textEdit;this.vod(this.eb.text,Mb);this.eb.textBox.caretPosition=
Mb.range.start.character+Mb.newText.length;this.fF&&(this.xfa=!1,this.AMa&&(this.i7a&&this.formulaAssistanceTelemetryManager.gw(["autoCompleteSmartSuggestionAccepted"]),this.USa=this.eoa=!0),this.Vzj(),this.gridView.oaa.C3f(),this.eb.endEdit(!0,"FormulaAutoCompleteControl.CommitAutoCompletion",0));this.visible=!1;this.raiseEvent("CVIC",{shouldRequestAutocompleteOnCommit:cb.shouldRequestAutocompleteOnCommit});this.formulaAssistanceTelemetryManager.YXf(cb.kind)}}Vzj(){this.formulaAssistanceTelemetryManager.FH=
{Yj:this.gridView.ha.qa.activeCell,s3b:this.gridView.Vb.text,Rrb:!0};this.formulaAssistanceTelemetryManager.mlc=this.$.va.na.sheetId;this.formulaAssistanceTelemetryManager.jDb=this.$.ea.se;this.$.userOperationManager.Zq(this.cPa)}xQg(){this.i7a&&this.aaa&&!this.mia&&!this.eoa&&(this.formulaAssistanceTelemetryManager.dJ.dismissSmartSuggestionImplicitlyCounter++,this.aaa=!1);this.pI&&(this.formulaAssistanceTelemetryManager.$G.smartSuggestionShownCounter++,this.pI=!1,Object(Oc.a)(Ib.a));this.eoa&&(this.formulaAssistanceTelemetryManager.$G.smartSuggestionSelectedCounter++,
this.eoa=!1,Object(Oc.a)(Ib.c));this.USa&&(this.formulaAssistanceTelemetryManager.$G.smartSuggestionCommittedCounter++,this.USa=!1)}vcc(){const cb=new Oe;cb.completionItems=this.dr.items;cb.activeItemIndex=this.yW;this.QKd(cb);return cb}QKd(cb){cb.callbacks=new df;cb.callbacks.onCompletionItemSelected=this.ICd;cb.callbacks.onCompletionItemCommitted=this.HCd;cb.callbacks.onFeedback=this.IRa;cb.callbacks.onDismiss=this.nRi;cb.callbacks.onRestoreFocus=this.onRestoreFocus}zHd(cb){this.xfa=!0;const Mb=
cb.textEdit.newText;this.eb.$na(Mb.substring(this.eb.text.length-cb.textEdit.range.start.character,Mb.length))}Agb(cb){const Mb=this.yW;this.yW=cb;const kc=this.dr.items[cb];this.fF&&this.Yma();Mb!==cb&&this.render();1===kc.type&&E.EwaSettings.wb()&&!this.gridView.ni.text.includes("\n")&&this.zHd(kc);this.Nbj()}Xxb(cb){return 0>cb?0:Math.min(cb,this.dr.items.length-1)}vod(cb,Mb){this.eb.text=cb.substring(0,Mb.range.start.character)+Mb.newText+cb.substring(Mb.range.end.character,cb.length);this.gridView.Ql&&
(this.gridView.Vb.text=this.eb.text)}ywd(){this.MIa&&(this.formulaAssistanceTelemetryManager.dJ.selectByArrowKeyCounter++,this.MIa=!1);this.NIa&&(this.formulaAssistanceTelemetryManager.dJ.selectByMouseHoverCounter++,this.NIa=!1);this.LIa&&(this.formulaAssistanceTelemetryManager.dJ.commitByTabKeyCounter++,this.LIa=!1);this.JIa&&(this.formulaAssistanceTelemetryManager.dJ.commitByEnterKeyCounter++,this.JIa=!1);this.KIa&&(this.formulaAssistanceTelemetryManager.dJ.commitByMouseClickCounter++,this.KIa=
!1);this.i7a&&this.mia&&(this.formulaAssistanceTelemetryManager.dJ.dismissSmartSuggestionExplicitlyCounter++,this.mia=!1)}KDc(cb){switch(cb){case -798660877:case 137938150:case 2091832999:case 742457698:this.MIa=!0;break;case 125627505:this.LIa=!0;break;case 267796030:this.JIa=!0}}static fKa(){return document.createElement("div")}U5h(cb){return cb.reduce((Mb,kc)=>Mb|=0===kc.type?gb.Simple:gb.Smart,gb.Dismissed)}}Object(d.a)(Hb,"FormulaAutoCompleteControl",wd.a,[632,2,587]);class ac{constructor(cb,
Mb){var kc,Uc;this.Og=cb;this.$=Mb;this.FBc=new Map;this.jfb=null;this.Eya=()=>{this.Q$b.resolve(this.Og.Pk);this.Khg()};this.zDf=()=>{this.Q$b.reject(null);this.Khg()};this.$f=()=>{this.Og.Pcb();this.Uud=null;this.FBc.clear();this.bne()};this.qDd=(qd,va)=>{if(va!==this.Kpf)t.ULS.sendTraceTag(509678923,0,15,"onGetTableColHeadersSuccess called with a tableName different than the one saved for last request"),this.oBa.reject();else if(Object(Ac.a)(qd))this.oBa.reject();else{var rb=qd.Result;Object(Y.b)(rb)&&
0!==rb.length?(this.FBc.set(va,rb),void this.oBa.resolve(qd.Result)):this.oBa.reject()}};this.pDd=()=>{this.oBa.reject()};null===(Uc=null===(kc=H.h(this.$))||void 0===kc?void 0:kc.mc)||void 0===Uc?void 0:Uc.Km(this.$f);this.qLj=E.EwaSettings.isChangeGateEnabled("OfficeVSO:6476169_skipGetFieldInfoListContextIfContextLoaded")}getRichValueFieldListContext(cb,Mb,kc,Uc){const qd={n$:cb,CNe:Mb};var va;if(va=Object(Y.b)(this.Uud))va=this.Uud,va=!(qd.n$.FirstRow===va.n$.FirstRow&&qd.n$.FirstColumn===va.n$.FirstColumn&&
qd.n$.LastRow===va.n$.LastRow&&qd.n$.LastColumn===va.n$.LastColumn&&qd.n$.SheetName===va.n$.SheetName&&qd.CNe===va.CNe);va&&this.Og.Pcb();this.Uud=qd;this.qLj&&this.Og.W6a||this.Og.oZ(cb,kc,Uc,Mb);this.Q$b=new Y.a;this.Og.W6a?this.Q$b.resolve(this.Og.Pk):this.Lfj();return this.Q$b.promise}getTableColHeaders(cb){if(this.jfb&&3>=this.jfb.status&&cb===this.Kpf)return this.oBa.promise;this.oBa=new Y.a;if(this.FBc.has(cb))this.oBa.resolve(this.FBc.get(cb));else{this.bne();this.Kpf=cb;const Mb=this.$.yb.getItemByName(cb).Hi;
this.jfb=Object(hc.q)(this.$.oa.xa,Mb,kc=>this.qDd(kc,cb),this.pDd,null,null)}return this.oBa.promise}dispose(){var cb,Mb;null===(Mb=null===(cb=H.h(this.$))||void 0===cb?void 0:cb.mc)||void 0===Mb?void 0:Mb.$l(this.$f)}Lfj(){this.Og.J_b(this.Eya);this.Og.WMg(this.zDf)}Khg(){this.Og.Juc(this.Eya);this.Og.dkj(this.zDf)}bne(){Object(Y.b)(this.jfb)&&(P.AFrameworkApplication.Bd.Nt(this.jfb.Rs),this.jfb=null)}}Object(d.a)(ac,"ServerDataProvider",null,[633]);var Ec=a(323),pd=a(580),Bd=a(345),de=a(891);class Jb{constructor(cb){this.$J=
this.aK=this.dF=this.eF=!1;this.TZ=cb}}Object(d.a)(Jb,"MarqueeRangeData",null,[]);class tc{constructor(cb,Mb,kc,Uc=!1){this.qYd=cb;this.WOb=Mb;this.C7a=Uc;kc?(this.TZ=kc.TZ,this.eF=kc.eF,this.dF=kc.dF,this.aK=kc.aK,this.$J=kc.$J):t.ULS.shipAssertTag(510255180,0,!1,"MarqueeMetadata.Ctor: rangeData is null")}}Object(d.a)(tc,"MarqueeMetadata",null,[]);const fd="rgba(95, 140, 237, {0});rgba(235, 94, 96, {0});rgba(141, 97, 194, {0});rgba(45, 150, 57, {0});rgba(191, 76, 145, {0});rgba(227, 130, 34, {0});rgba(55, 127, 158, {0})".split(";");
class Ad{constructor(cb,Mb,kc){this.$=cb;this.pluginScheduler=Mb;this.formulaAssistanceTelemetryManager=kc;this.ZJ=this.ifb=!1;this.CR=null;this.XMa=E.EwaSettings.XMa();this.xya=()=>{this.ZJ=!1;this.CR=null};this.gridView=H.h(cb);this.gridView.Vb.Km(this.xya);this.g8a=E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ParenthesesCoupling",!1)}get coloredReferencesManager(){this.sVa||(this.sVa=this.$.da.Aa(281));return this.sVa}AXj(cb,Mb,kc){return isNullOrUndefined(this.coloredReferencesManager)?
!1:this.coloredReferencesManager.bgb(cb,Mb,kc)}bgb(cb,Mb,kc){var Uc;cb.textBox.addEventLogRecord("FormulaHighlightsControl.TryUpdateFormulaHighlights");if(this.ifb||cb.fF)return!1;const qd=isNullOrUndefined(Mb)?cb.text:Mb;if(1>=qd.length)return this.qkg(cb,qd,Object(Y.b)(Mb));kc=this.e6h(cb,Mb,kc);kc=null===(Uc=this.A4a(qd,kc))||void 0===Uc?void 0:Uc.formulaHighlights;if(!kc)return t.ULS.sendTraceTag(512349465,0,50,"FormulaHighlightsControl.tryUpdateFormulaHighlights: formulaHighlights is null (might be an invalid formula)"),
this.qkg(cb,qd,Object(Y.b)(Mb));const {QRj:va,tcj:rb,rcj:fc,SGi:Nc}=this.RWh(kc,qd);this.Iyc(cb,va,!!Mb);Mb=cb.textBox.text;if(!da.a.equals(Mb,qd,!1))return t.ULS.shipAssertTag(38114182,0,!1,`FormulaHighlightsControl.UpdateColoredReferences: The text we created is different from the original text. Setting the original text back. currentTextLength [${Mb.length}], updatedTextLength [${qd.length}]`),Mb=cb.textBox.caretPosition,cb.textBox.text=qd,cb.textBox.caretPosition=Mb,!0;this.cz(rb,fc,Nc);return this.ZJ=
!0}PEb(cb,Mb,kc){if(!cb||!Mb||!kc)return t.ULS.shipAssertTag(512349463,0,!!cb,"FormulaHighlightsControl.MoveMarqueeRange: cellContentEditor is null"),t.ULS.shipAssertTag(512349462,0,!!Mb,"FormulaHighlightsControl.MoveMarqueeRange: highlightState is null"),t.ULS.shipAssertTag(512349461,0,!!kc,"FormulaHighlightsControl.MoveMarqueeRange: newRange is null"),!1;const Uc=Object(eb.a)(tc,Mb.metadata);if(!Uc)return t.ULS.shipAssertTag(512349460,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: marqueeMetadata is null"),
!1;var qd=Uc.qYd,va=Uc.WOb,rb=this.gridView.tb.oqd(kc)?kc.Twb(Uc.dF,Uc.eF):kc.LKa(Uc.dF,Uc.eF,Uc.$J,Uc.aK);if(!rb)return t.ULS.shipAssertTag(512349459,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: newText is null"),!1;const fc=va.indexOf("!");-1!==fc&&(rb=va.substring(0,fc+1)+rb);if(!cb.textBox.changeTextInExistingTextPart(qd,va,rb))return t.ULS.shipAssertTag(38926105,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: failed to change the text part"),!1;Uc.WOb=rb;qd=!0;for(va=1;4>=va;va++)(rb=H.h(this.$).Cb.NC(3,
va,Mb.QT))?(rb.range=kc,rb.metadata=Uc):(t.ULS.shipAssertTag(512349458,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: highlightStateInPane is null"),qd=!1);this.gridView.Cb.update(!1,!1);this.gridView.Ql&&(this.gridView.mc.textBox.text=cb.text);this.gridView.mc.cQa(new Ec.a({IAb:!0}));return qd}ari(cb){if(3!==cb.Aq)return t.ULS.shipAssertTag(512349457,0,!1,"FormulaHighlightsControl.IsMarqueeHighlightDraggable: not HighlightDivIndex.Marquee."),!1;cb=Object(eb.a)(tc,cb.metadata);return cb?cb.TZ&&
!cb.C7a:(t.ULS.shipAssertTag(512349456,0,!1,"FormulaHighlightsControl.IsMarqueeHighlightDraggable: marqueeMetadata is null."),!1)}lBa(cb,Mb){t.ULS.sendTraceTag(512349455,0,50,"FormulaHighlightsControl.SuspendResumeColoredReferences: "+(Mb?"suspending":"resuming")+" colored references");Mb&&this.ZJ&&(this.ZJ=!1,this.cz(null,null),cb.textBox.LCe());this.ifb=Mb}dispose(){this.gridView&&this.gridView.Vb&&this.gridView.Vb.$l(this.xya)}izb(cb){this.formulaAssistanceTelemetryManager.ED(["highlightPreviewRanges"]);
var Mb=this.A4a(cb,de.a);if(isNullOrUndefined(Mb))this.ahc&&this.cz(null,null);else{var kc=this.Jja(),Uc=[],qd=new Kc.a(!1),va=[];Mb=Mb.formulaHighlights;for(const rb of Mb)if(Mb=rb.kind,0===Mb||2===Mb||1===Mb)Mb=ja.B(rb.rangeInfo.sharedRange),Object(Y.b)(Mb)&&(Uc.push(new Bd.a(Mb,kc)),this.nZ(Mb,qd,1),va.push(new tc(rb.span.start,cb.substring(rb.span.start,rb.span.end),e(rb),!0)));this.cz(Uc,qd,va);this.formulaAssistanceTelemetryManager.gw(["highlightPreviewRanges"],!0)}}C0j(cb,Mb){cb&&this.formulaAssistanceTelemetryManager.Xac.formulaHighlightsCounter++;
Mb&&this.formulaAssistanceTelemetryManager.Xac.parenthesesCouplingCounter++}qkg(cb,Mb,kc){this.cz(null,null);if(this.ZJ){this.ZJ=!1;if(!this.XMa){const Uc=cb.textBox.caretPosition;cb.textBox.setPlainText(Mb);cb.textBox.caretPosition=Math.min(Uc,Mb.length)}if(kc)return!0}return!1}e6h(cb,Mb,kc){let Uc=kc;Object(Y.b)(Mb)?Object(Y.b)(kc)||(Uc={index:Mb.length,length:0}):Uc=cb.textBox.selection;return Uc}A4a(cb,Mb){if(this.g8a&&this.mti({content:cb,selection:Mb}))return this.CR.result;this.formulaAssistanceTelemetryManager.ED(["formulaHighlightsRequest"]);
const kc=this.pluginScheduler.syncRequester().formulaHighlighting({content:cb,caretPosition:Mb.index,selectionLength:Mb.length});this.g8a&&(this.CR={content:cb,selection:Mb,result:kc});this.formulaAssistanceTelemetryManager.gw(["formulaHighlightsRequest"]);return kc}nZ(cb,Mb,kc){let Uc=Mb.getItem(cb.toString());Uc||(Uc=fd[Mb.count%fd.length],Mb.add(cb.toString(),Uc));return String.format(Uc,kc)}hE(cb,Mb,kc,Uc,qd=null,va=null){t.ULS.shipAssertTag(512349453,0,kc<=Uc,"FormulaHighlightsControl.AddTextPart: startIndex cannot be larger than endIndex");
kc<Uc&&(Mb=Mb.substring(kc,Uc),cb.push(Object(Ja.a)(new pd.a,{text:Mb,color:qd,backgroundColor:va})))}cz(cb,Mb,kc=null){cb&&cb.length?(t.ULS.sendTraceTag(512349452,0,50,"FormulaHighlightsControl.HighlightRanges: number of ranges to highlight: "+cb.length),cb.reverse(),kc.reverse(),this.gridView.Cb.zB(cb,[3],!0,(Uc,qd)=>{if(Uc&&Uc.range&&qd){t.ULS.shipAssertTag(512349448,0,Mb.hb(Uc.range.toString()),`FormulaHighlightsControl.HighlightRanges: The range '${Uc.range.toString()}' doesn't exist in the range to color dictionary`);
var va=this.nZ(Uc.range,Mb,.1),rb=this.nZ(Uc.range,Mb,1);this.$.frame&&this.$.frame.WC&&this.$.frame.WC.VM||(qd.style.background=va);qd.style.borderColor=rb;kc&&(qd.setAttribute(C.a.c6a,Uc.QT.toString()),Uc.metadata=kc[Uc.QT])}else t.ULS.shipAssertTag(512349451,0,!!Uc,"FormulaHighlightsControl.HighlightRanges: state is null"),t.ULS.shipAssertTag(512349450,0,!!Uc.range,"FormulaHighlightsControl.HighlightRanges: state.Range is null"),t.ULS.shipAssertTag(512349449,0,!!qd,"FormulaHighlightsControl.HighlightRanges: div is null")})):
(cb=this.$.Jb.Gc("UserAction","HideRangesHighlightsStopwatch"),this.gridView.Cb.Nj([3]),this.gridView.Cb.$Ra(new Bd.a(null,this.Jja()),[3]),cb.stop())}Iyc(cb,Mb,kc){const Uc=cb.textBox;Uc.ZE=!0;var qd=Uc.selection;const va=qd.index;qd=va+qd.length;Uc.setTextFromTextParts(Mb);Mb=Uc.text.length;Uc.selectRange(Math.min(va,Mb),Math.min(qd,Mb));kc&&cb.cQa(new Ec.a);Uc.ZE=!1}ddc(){return this.gridView.Jq&&this.gridView.Jq.sF?this.gridView.Jq.sF:this.$.na}Jja(){return this.ddc().sheetId}RWh(cb,Mb){const kc=
[],Uc=new Kc.a(!1),qd=[],va=[],rb=[];let fc=!1;var Nc=!1;let hd=0;const xd=this.Jja();for(const ae of cb){this.hE(qd,Mb,hd,ae.span.start,null);switch(ae.kind){case 0:case 1:case 2:cb=ja.B(ae.rangeInfo.sharedRange);if(isNullOrUndefined(cb)){t.ULS.sendTraceTag(512349464,0,10,`FormulaHighlightsControl.tryUpdateFormulaHighlights: Received formula highlight with undefined range, HighlightKind:${ae.kind.toString()}`);this.hE(qd,Mb,ae.span.start,ae.span.end,null);break}Nc=this.nZ(cb,Uc,1);this.hE(qd,Mb,
ae.span.start,ae.span.end,Nc);kc.push(new Bd.a(cb,xd));va.push({Start:ae.span.start,End:ae.span.end});Nc=qd.length-1;rb.push(new tc(Nc,qd[Nc].text,e(ae)));Nc=!0;break;case 3:this.hE(qd,Mb,ae.span.start,ae.span.end,null,"rgba(229, 229, 229, 1)"),fc=!0}hd=ae.span.end}this.hE(qd,Mb,hd,Mb.length);this.C0j(Nc,fc);return{QRj:qd,tcj:kc,rcj:Uc,SGi:rb}}mti(cb){return Object(Y.b)(this.CR)&&this.CR.content===cb.content&&this.CR.selection.index===cb.selection.index&&this.CR.selection.length===cb.selection.length}}
Object(d.a)(Ad,"FormulaHighlightsControl",null,[608,2]);class me{constructor(cb,Mb,kc,Uc,qd,va,rb){this.$=cb;this.functionInfoManager=Mb;this.calcManager=kc;this.pluginScheduler=Uc;this.formulaAssistanceUIControl=qd;this.formulaAssistanceTelemetryManager=va;this.Og=rb;this.kMa=this.isCellContentOnlyEqualDuringEdit=!1;this.Uba=null;this.nla=-1;this.Sca=0;this.Nka=E.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");this.ddd=E.EwaSettings.getBooleanFeatureGate("OfficeVSO:7135425_fixSetFunctionsInfoNotification",
!1);this.E0d=E.EwaSettings.isChangeGateEnabled("OfficeVSO:7262196_updateRequestCacheOnAutoCompleteCommit");this.jmf=E.EwaSettings.isChangeGateEnabled("OfficeVSO:7395449_isSendingSchedulerWorkbookClosingNotificationEnabled");this.uc=(fc,Nc)=>{Nc.Bf||Nc.lqd||this.pluginScheduler.notifier().notifyWorkbookClosing()};this.Gh=(fc,Nc)=>{this.gridView.fb||this.gridView.Vh||this.rFb(null===Nc||void 0===Nc?void 0:Nc.cell)};this.onFunctionInfoLoaded=()=>{this.ddd||this.functionInfoManager.qcb(this.onFunctionInfoLoaded);
this.Akg();this.Bda()};this.Wzf=(fc,Nc)=>{var hd=this.eb;fc=hd.text;hd=hd.textBox.caretPosition;0<this.Sca&&this.formulaAssistanceTelemetryManager.dJ.commitWhileRequestPending++;this.formulaAssistanceTelemetryManager.ED(["argumentAssistanceComputation","argumentAssistanceOverall"]);Nc.shouldRequestAutocompleteOnCommit?this.L2f(fc,hd):this.tNd(fc,hd)};this.$f=()=>{this.isCellContentOnlyEqualDuringEdit&&(this.formulaAssistanceTelemetryManager.$G.isCellContentOnlyEqualDuringEditCounter++,this.isCellContentOnlyEqualDuringEdit=
!1);this.kMa&&(this.formulaAssistanceTelemetryManager.$G.isCellContentFormulaCounter++,this.kMa=!1);E.EwaSettings.isChangeGateEnabled("OfficeVSO:6103891_dismissControlOnEditEnded")&&this.b8b()};this.a6=(fc,Nc)=>{this.cPd(Nc.newValue)};this.vj=()=>{this.ujg()};this.ujg=()=>{const fc=this.v7b.cLe;this.pluginScheduler.notifier().setDefinedNamesInfo(fc);t.ULS.sendTraceTag(512278605,0,50,`FormulaAssistanceManager.updateDefinedNamesList updated defined names info with ${null===fc||void 0===fc?void 0:fc.length} names}`)};
this.A4a=(fc,Nc)=>{fc=this.pluginScheduler.syncRequester().formulaHighlighting({content:fc,caretPosition:null===Nc||void 0===Nc?void 0:Nc.index,selectionLength:null===Nc||void 0===Nc?void 0:Nc.length});if(isNullOrUndefined(fc)||isNullOrUndefined(fc.formulaHighlights))t.ULS.sendTraceTag(521211933,0,10,`FormulaAssistanceManager.getFormulaHighlights: formulaHighlightingResult is null or undefined, formulaHighlights array is null:${!isNullOrUndefined(fc)}`);else return fc};this.functionInfoManager=Mb;
this.formulaAssistanceUIControl=qd;this.pluginScheduler=Uc;this.gridView=H.h(this.$);this.ykf=E.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest");this.lBd=E.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");this.D_c=E.EwaSettings.isChangeGateEnabled("OfficeVSO:6488306_BlockFormulasuggestionInPivotTable");this.ykf&&(this.v7b=new dd(cb),this.gridView.Ca.Tv(this.vj),this.ujg());this.fWa=new ad(this.$,this.formulaAssistanceUIControl,
this.formulaAssistanceTelemetryManager);this.z8=new Hb(this.$,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);this.Api=ca.a.tH(cb);this.iMj=ca.a.Lpb(cb);this.ami=E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AuthoringPerCharExp",!1);this.Nui=E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.x10AutocompleteWrapperPluginIsEnabled",!1);this.Api&&(this.lqa=new Ad(this.$,this.pluginScheduler,this.formulaAssistanceTelemetryManager));cb.da.Ha(464,this);this.calcManager=
kc;ca.a.gV(this.$)&&this.god();this.gridView.mc.Km(this.$f);this.ddd&&(this.functionInfoManager.$Fa(this.onFunctionInfoLoaded),this.functionInfoManager.hV?this.Akg():this.functionInfoManager.eJa({}))}get hja(){return this.z8}get GZe(){return this.fWa}get LA(){return this.lqa}get aIb(){return this.eb.Hsi?1:0}get eb(){return this.gridView.ni}get tb(){return this.gridView.tb}dispose(){if(this.$){const cb=this.gridView;cb&&(cb.ha&&ca.a.gV(this.$)&&cb.ha.Zma(this.Gh),this.ykf&&cb.Ca&&cb.Ca.Nw(this.vj));
this.jmf&&this.$.ol(this.uc)}this.gridView.mc.$l(this.$f);this.z8.zjj(this.Wzf);this.functionInfoManager&&this.functionInfoManager.qcb(this.onFunctionInfoLoaded);ca.a.bhc&&this.eb&&this.eb.RJb(this.a6);ka.a.Ja(this.fWa);ka.a.Ja(this.z8);this.z8=this.fWa=this.functionInfoManager=this.$=null}woj(){this.nla=-1;this.Uba=null}b8b(){this.z8.visible=!1;this.fWa.visible=!1}Oh(){this.Bda();return!1}Bda(){if(!this.eb.GK)if(this.formulaAssistanceTelemetryManager.Spb.formulaAssistanceRequestAttemptedCounter++,
this.wGj()){this.ddd||this.functionInfoManager.hV||(this.functionInfoManager.$Fa(this.onFunctionInfoLoaded),this.functionInfoManager.eJa({}));var cb=this.eb,Mb=cb.text;cb=cb.textBox.caretPosition;Mb.startsWith("=")&&(this.kMa=!0,1===Mb.length&&(this.isCellContentOnlyEqualDuringEdit=!0));this.formulaAssistanceTelemetryManager.ED("argumentAssistanceComputation autoCompleteComputation argumentAssistanceOverall autoCompleteOverall autoCompleteOverallSmartOnly autoCompleteOverallSimpleOnly autoCompleteOverallSimpleAndSmart".split(" "));
this.L2f(Mb,cb);this.ami&&this.joj(Mb,cb)}else this.formulaAssistanceTelemetryManager.Spb.formulaAssistanceRequestOptimizedCounter++}L2f(cb,Mb){const kc=this.pluginScheduler.batchRequester().functionSuggestionAndArgumentAssistance({functionSuggestion:{content:cb,caretPosition:Mb},argumentAssistance:{content:cb,caretPosition:Mb},inCellSuggestion:{content:cb,caretPosition:Mb}});this.Sca+=1;this.E0d&&(this.Uba=cb,this.nla=Mb);kc.then(Uc=>{--this.Sca;0===Uc.kind&&(this.Y9e(Uc.payload.argumentAssistance),
this.E9h(Uc.payload.functionSuggestion,cb));return null})}joj(cb,Mb){Mb={content:cb,caretPosition:Mb,enableAutocompleteWrapperPlugin:this.Nui&&!this.iMj};this.Nka&&(Mb=this.pluginScheduler.getRequester().runPerCharacterExperiment(Mb,this.aIb),this.Sca+=1,Mb.then(kc=>{--this.Sca;if(0===kc.kind)for(const Uc of kc.payload.results)0===Uc.kind&&this.gridView.oaa.PRd(Uc.value,cb);return null}))}tNd(cb,Mb){const kc={content:cb,caretPosition:Mb};this.E0d&&(this.Uba=cb,this.nla=Mb);cb=this.Nka?this.pluginScheduler.getRequester().argumentAssistance(kc,
this.aIb):this.pluginScheduler.requester().argumentAssistance(kc);this.Sca+=1;cb.then(Uc=>{--this.Sca;0===Uc.kind&&this.Y9e(Uc.payload)})}wGj(){var cb=this.eb;const Mb=cb.text;cb=cb.textBox.caretPosition;if(this.z8.visible&&da.a.equals(Mb,this.Uba,!0)&&!Qb.e(Mb)&&cb===this.nla)return!1;this.E0d||(this.Uba=Mb,this.nla=cb);return!0}ePd(){this.Nka?this.pluginScheduler.getRequester().runExperiment(new cf,this.aIb):this.pluginScheduler.requester().runExperiment(new cf)}Y9e(cb){cb&&this.eb.fb?(this.formulaAssistanceTelemetryManager.gw(["argumentAssistanceComputation"]),
this.fWa.show(cb,this.eb.textBox.domElement)):this.fWa.dismiss()}E9h(cb,Mb){cb&&0<cb.items.length&&this.eb.fb&&this.eb.text===this.Uba?this.D_c&&this.tb.b5(this.gridView.ha.qa.activeCell)?(this.formulaAssistanceTelemetryManager.$G.smartSuggestionWouldSuggestInsidePivotCounter++,this.z8.dismiss()):(this.formulaAssistanceTelemetryManager.gw(["autoCompleteComputation"]),this.z8.show(cb)):this.z8.dismiss();this.gridView.oaa.PRd(cb,Mb)}cPd(cb){cb={content:cb,isCellContentOnlyEqualDuringEdit:this.isCellContentOnlyEqualDuringEdit};
this.Nka?this.pluginScheduler.getRequester().runAuthoringExperiment(cb,this.aIb):this.pluginScheduler.requester().runAuthoringExperiment(cb)}rFb(cb){var Mb;const kc=this.gridView.ha.qa.activeCell;if(kc){var Uc=this.calcManager.gta(kc,!1);if(Uc){var qd=this.$.va,va=Uc.sheet.index;0>=qd.count||0>va||va>=qd.count?t.ULS.sendTraceTag(512278608,0,50,`FormulaAssistanceManager.NotifyActiveCellChanged invalid sheet index. ewaSheetsCount = ${qd.count}, currentSheetIndex = ${va}.`):(va=qd=null,this.lBd&&void 0!==
this.calcManager&&null!==this.calcManager&&(cb=null!==(Mb=null===cb||void 0===cb?void 0:cb.cell)&&void 0!==Mb?Mb:this.gridView.Ca.Ur(kc))&&(Mb=this.calcManager.$cc(cb.hj),void 0!==Mb&&null!==Mb&&(qd=Mb.FormatString,va=Mb.Builtin)),this.pluginScheduler.notifier().setActiveCell({colIndex:Uc.range.col,rowIndex:Uc.range.row,sheetIndex:this.$.va.getItem(Uc.sheet.index).sheetId,docName:Uc.sheet.document.name,docPath:Uc.sheet.document.path,formatString:qd,builtIn:va}),t.ULS.sendTraceTag(512278607,0,50,`FormulaAssistanceManager.NotifyActiveCellChanged sent notification to the scheduler. col: ${Uc.range.col}, row: ${Uc.range.row}, format: ${qd}`))}else t.ULS.sendTraceTag(537162002,
0,50,"FormulaAssistanceManager.NotifyActiveCellChanged ISheetGridCell location is null")}else t.ULS.sendTraceTag(512278609,0,50,"FormulaAssistanceManager.NotifyActiveCellChanged activeCell range is null")}Akg(){const cb=this.functionInfoManager.ebc;this.pluginScheduler.notifier().setFunctionsInfo(cb);t.ULS.sendTraceTag(512278606,0,50,`FormulaAssistanceManager.updateSchedulerFunctionList update functions info with ${null===cb||void 0===cb?void 0:cb.length} functions}`)}god(){this.gridView.ha.Mga(this.Gh);
const cb=ca.a.gAb()?this.gridView.Pb(null):void 0;this.rFb(cb);ca.a.bhc&&this.eb.UYa(this.a6);this.ePd();this.z8.mMg(this.Wzf);this.pluginScheduler.setServerDataProvider(new ac(this.Og,this.$));this.Bda();this.jmf&&this.$.nj(this.uc)}bgb(cb,Mb,kc){kc=Object(Y.b)(Mb)?this.A4a(Mb,Object(Y.b)(kc)?kc:de.a):this.A4a(cb.text,cb.textBox.selection);return this.lqa.AXj(cb,Mb,kc)}}Object(d.a)(me,"FormulaAssistanceManager",null,[583,2]);var Vd=a(204);class oe extends bb.a{constructor(cb){super();this.$=cb;this.Db()}create(){var cb=
ca.a.gV(this.$);const Mb=E.EwaSettings.ra(329),kc=E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",!1),Uc=ca.a.fV(this.$),qd=this.$.da,va=l.GetServiceTaskFactory.create(qd,134,this.la,this.Xa),rb=l.GetServiceTaskFactory.Oa(this.$.da,12,477,this.Xa);let fc;fc=ca.a.D4(this.$)?l.GetServiceTaskFactory.create(this.$.da,449,this.$.la,1):ua.Task.Sa(null);let Nc;Nc=ca.a.gV(this.$)?l.GetServiceTaskFactory.create(this.$.da,414,this.$.la,1):ua.Task.Sa(null);let hd;hd=E.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&
!Uc?l.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Xa):ua.Task.Sa(null);if(kc||cb){let xd;xd=E.EwaSettings.dK()?Object(Vd.c)(D.a.resolve(G.b,{Tl:this.Xa})):l.GetServiceTaskFactory.Oa(qd,266,265,this.Xa);const ae=l.GetServiceTaskFactory.Oa(qd,219,220,this.Xa),Wd=l.GetServiceTaskFactory.Oa(qd,491,492,this.Xa);cb=[xd,Nc,fc,ae,Wd,hd];E.EwaSettings.isChangeGateEnabled("OfficeVSO:7252917_FunctionInfoManagerFactoryInvalidOperationFix")&&cb.push(va,rb);k.TaskExtensions.za(k.TaskExtensions.Fd(cb,this.la),
()=>{const Ne=qd.Aa(19)||new $d(this.$,Nc.result),Ue=ae.result;if(Uc){var xe=qd.Aa(464);xe||(xe=new me(this.$,Ne,xd.result,Nc.result,fc.result,Wd.result,rb.result.K5c(this.$,va.result)),Ue.LZc(xe.GZe),Ue.MZc(xe.hja),Ue.NZc(xe.hja))}else xe=qd.Aa(221),xe||(xe=new vf(this.$,Ne,va.result,xd.result,null,rb.result,fc.result,Wd.result,Nc.result,hd.result),Ue.LZc(xe.HZe),Ue.NZc(xe.a_e),Ue.MZc(xe)),Mb&&(qd.Aa(317)||new oc(this.$));this.nb(Ne)},this.la,3)}else{const xd=l.GetServiceTaskFactory.Oa(qd,219,220,
this.Xa),ae=l.GetServiceTaskFactory.Oa(qd,491,492,this.Xa);cb=[xd,fc,Nc,hd];E.EwaSettings.isChangeGateEnabled("OfficeVSO:7252917_FunctionInfoManagerFactoryInvalidOperationFix")&&cb.push(va,rb,ae);k.TaskExtensions.za(k.TaskExtensions.Fd(cb,this.la),()=>{const Wd=qd.Aa(19)||new $d(this.$,Nc.result),Ne=xd.result;let Ue=qd.Aa(221);Ue||(Ue=new vf(this.$,Wd,va.result,null,null,rb.result,fc.result,ae.result,Nc.result,hd.result),Ne.LZc(Ue.HZe),Ne.NZc(Ue.a_e),Ne.MZc(Ue));Mb&&(qd.Aa(317)||new oc(this.$));this.nb(Wd)},
this.la,3)}}static ka(cb){cb.da.Ha(153,new oe(cb))}}Object(d.a)(oe,"FunctionInfoManagerFactory",bb.a,[]);a.d(F,"a",function(){return Me});const Me=()=>{f.a.Fa(cb=>{Oa.ka(cb);tb.ka(cb);oe.ka(cb)})}},1163:function(r,F,a){var c=a(0),b=a(709),e=a(153),f=a(7),d=a(15),h=a(83),l=a(4),k=a(160),t=a(1094),n=a(1092),z=a(734),w=a(5),m=a(464),u=a(564),y=a(68),v=a(59),C=a(926),x=a(127),B=a(41),H=a(193),I=a(60),U=a(50),S=a(763),G=a(140),D=a(37),E=a(113),N=a(214),M=a(94),L=a(74),aa=a(35),V=a(29),P=a(249),ba=a(1),
Y=a(189),Z=a(13),ea=a(62),ra=a(282),O=a(21),da=a(128),xa=a(782),ia=a(783),Ma=a(129),Ta=a(115),Da=a(52),fa=a(34),ua=a(428);class Fa{constructor(){this.Sections=this.Id=null}}Object(c.a)(Fa,"AutoFilterMenu",null,[]);class ca{constructor(){this.Disabled=!1;this.RibbonCommand=this.Identifier=this.Type=0;this.SubMenu=this.Label=this.CommandData=null;this.IsChecked=!1;this.TooltipText=this.Id=this.IconName=null}}Object(c.a)(ca,"MenuItem",null,[]);class ka{constructor(){this.Title=this.MenuItems=this.Id=
null;this.DisplayType=0}}Object(c.a)(ka,"MenuSection",null,[]);class Ca{constructor(){this.isSuccess=!1}}Object(c.a)(Ca,"ApplyFilterByValueResponse",null,[]);class fb{constructor(){this.displayText=null;this.state=0;this.children=this.parent=this.key=null;this.indentationLevel=0;this.expanded=!1}}Object(c.a)(fb,"FilterByValueItem",null,[]);class yb{constructor(){this.selectedFilterIcon=this.selectedFilterFontColor=this.selectedFilterCellColor=this.selectedSortIcon=this.selectedSortFontColor=this.selectedSortCellColor=
this.getColorName=this.icons=this.fontColors=this.cellColors=null}}Object(c.a)(yb,"GetColorsAndIconsResponse",null,[]);class mb{constructor(){this.filterByValueItems=null;this.hasMoreRecords=!1;this.searchText=null}}Object(c.a)(mb,"GetFilterByValueItemsResponse",null,[]);class nb{constructor(){this.autoFilterMenu=this.targetPoint=null}}Object(c.a)(nb,"ShowSortFilterMenuParams",null,[]);class X{constructor(){this.focusShiftOnMenuDismiss=this.onMenuItemClick=this.applyFilterByValueRequest=this.getFilterByValueItemsRequest=
null;this.autoFilterMenuWidth=0;this.applyFilterByColorOrIconRequest=this.applySortByColorOrIconRequest=null}}Object(c.a)(X,"SortFilterControllerFactoryParams",null,[]);class R{constructor(){this.top=this.left=0}}Object(c.a)(R,"TargetPoint",null,[]);var wa=a(55),na=a(204),Ba=a(33),Ra=a(162),qa=a(230),La=a(8),Yb=a(187),mc=a(105);const Zb=w.a.V9g;class qb extends z.a{constructor(gb,Hb,ac,Ec){super(gb,"PopulateAutoFilterContextMenu",1675506831,1651433993,Zb,!0,!1,"AutoFilterContextMenuRoot",Hb,ac,!1,
Ec);this.$Yc=this.PTa=this.sheetName=this.Xsb=null;this.j3a=this.drf=!1;this.X6c=this.Aab=this.PJe=this.HPa=this.cdc=this.ubd=this.Seb=this.kIb=null;this.DV=()=>{this.yAc();this.$.ea.Cn(this.DV)};this.ADf=pd=>{this.j3a||da.b(this.$).rd(x.a.BDf,this.sm(),void 0,!0);var Bd={};this.$.ak(Bd);var de=this.$.ea.isNamedObjectViewMode;const Jb=v.a.Xh(this.$Yc);Jb.SheetName=de?Bd.NamedObjectName:Bd.SheetName;Jb.NamedObjectView=de;Bd=!!pd.searchText;de=586;this.j3a&&(Bd&&(Jb.ItemListOptions=this.Mbh(pd.searchText),
de=597),da.b(this.$).rd(x.a.BDf,{["UserOperation"]:de.toString()},void 0,!0));const tc=this.jDd(Bd),fd=this.ATi(),Ad=this.$.oa.xa.Wb();this.PJe=Ad.RequestId;this.j3a&&this.cdc&&!this.cdc.dequeueUtcTime&&(this.$.userOperationManager.Jta(this.cdc),this.L1g());pd=new H.a(de,0,(me,Vd,oe)=>this.X6c=I.n(this.$.oa.xa,Jb,ra.b(me,tc),this.j3a?ra.a(Vd,fd):Vd,oe,null,Ad),80);this.cdc=this.$.userOperationManager.Jc(pd,null);this.Aab=this.X6c;this.HPa=this.PJe};this.onMenuItemClick=(pd,Bd,de)=>{da.b(this.$).rd(x.a.tYi,
this.sm(),void 0,!0);Bd={["CommandValueId"]:Bd,["MenuItemId"]:Bd,["InputMethod"]:de,["TopCellAddress"]:this.PTa};const Jb=new M.a(pd,de,this.$.isEditMode?2:1,19,null);this.$.Ia.Hb(Jb,Bd);d.ULS.sendTraceTag(537167131,0,50,`AutoFilterContextMenu::OnMenuItemClick ${pd}, ${de}`)};this.focusShiftOnMenuDismiss=()=>{O.h(this.$).focus()};this.Mzf=pd=>{if(pd.checkedItems&&pd.checkedItems.length){da.b(this.$).rd(x.a.Nzf,this.sm(),void 0,!0);var Bd=v.a.Xh(this.$Yc),de={};this.$.ak(de);de.FirstRow=0;de.FirstColumn=
Bd.Column;var Jb=this.$.ea.isNamedObjectViewMode;Bd.NamedObjectView=Jb;Bd.SheetName=Jb?de.NamedObjectName:de.SheetName;var tc=me=>{if(xa.a.zzc(me)){const Vd=xa.a.Bbc(me);this.QMa?xa.a.NQa(ia.a.applyItemFilter,Vd.MessageIdName,Ta.a.JGa,!0,xa.a.isSessionEndingError(Vd.MessageId)):d.ULS.sendTraceTag(537167129,0,10,`AutoFilterContextMenu::OnApplyFilterByValue failed with AutoFilterException -${Vd.MessageIdName}`)}P.a(me)||(d.ULS.sendTraceTag(537167128,0,50,"AutoFilterContextMenu::OnApplyFilterByValue service call succeeded"),
da.b(this.$).rd(x.a.tDf,this.sm(),void 0,!0),me=Object(f.a)(new Ca,{isSuccess:!0}),this.Seb.onApplyFilterByValueFinish(me),this.gS(this.PTa))},fd=this.w5c(Bd,de),Ad=new H.a(208,0,(me,Vd,oe)=>I.a(this.$.oa.xa,fd,pd.checkedItems,ra.b(me,tc),Vd,oe,null,null),6,()=>new C.a(pd.checkedItems,fd));this.GJj(()=>{this.$.userOperationManager.Jc(Ad,null)})}else d.ULS.sendTraceTag(537167130,0,15,"AutoFilterContextMenu::OnApplyFilterByValue Received Zero checked items to apply filter on")};this.ave=pd=>{const Bd=
B.o(this.PTa,this.$),de=B.v(this.PTa,this.$);var Jb=Object(f.a)(new t.a,{SortConditionType:pd.type,RowColOffset:Bd.FirstColumn-de.FirstColumn,SortColor:pd.color,SortIconSet:pd.icon.IconSet,SortIcon:pd.icon.Icon,IsAscending:!0});Jb=Object(f.a)(new n.a,{OperationType:1,ActiveCell:Bd,SelectedRange:de,SortConditions:[Jb],SortTopToBottom:!0,GuessHeader:!0,IsCaseSensitive:!1});const tc={};tc.SortOptions=Jb;tc.SelectedRange=de;tc.OriginalActiveCell=Bd;tc.ShouldRestoreSelection=!1;tc.ShouldPromptNamedSheetViewTeachingDialog=
!0;d.ULS.sendTraceTag(537167119,0,50,`AutoFilterContextMenu.ApplySortByColorOrIcon: Aplying Sort, type: ${pd.type}`);this.$.Yc(-1089513346,y.a.zb,19,{["CustomSortCommandData"]:tc})};this.QMa=xa.a.jpd();this.XA=ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")}get Hw(){return"PopulateAutoFilterContextMenu"}get tB(){return w.a.CRf}executeCommand(gb,Hb,ac){gb=Hb.command;switch(gb){case 1701016594:return z.a.UDh(ac),wa.Task.Sa(!0);case 966232027:if(ba.EwaSettings.cl()){const Ec=new k.a;
D.TaskExtensions.za(U.GetServiceTaskFactory.Oa(this.$.da,8,9,0),pd=>{this.laf(Hb,ac,pd.result);Ec.setResult(!0)},this.la,3).continueWith(()=>{Ec.setResult(!1)},5,this.la,qa.a.instance);return Ec.task}this.laf(Hb,ac);return wa.Task.Sa(!0);default:return Y.a(gb)}}laf(gb,Hb,ac){const Ec=Hb.domEvent;if(L.e(Ec.rawEvent)&&(L.g(Ec),Ec.target)){var pd=new G.a(this.$.va);if(pd.Pd(4096)||pd.Pd(2048)){var Bd=v.a.Xh(Hb[y.a.Pf]);this.J8f(Bd)&&(this.drf?this.mvc(Ec,Ec.target,Bd,gb,ac):(this.kIb=()=>{this.J8f(Bd)&&
(this.wii(),this.mvc(Ec,Ec.target,Bd,gb,ac),this.j3a=ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FilterByValueSearch",!1),this.drf=!0)},this.yAc()))}}}wc(gb,Hb,ac){if(gb=!!ac)switch(Hb.command){case 1701016594:case 966232027:ba.EwaSettings.cl()||m.a(this.$)||(gb=!1,Hb=Da.b().Cj(Hb.command),d.ULS.sendTraceTag(537167137,0,15,`AutoFilterContextMenu.CanExecuteCommand: ContextMenuManager is not ready. RibbonCommand was ${Hb}`));break;default:gb=!1}return gb}GGd(gb){gb.MenuSectionList.push(...this.Xsb)}wii(){ua.a(()=>
{ba.EwaSettings.isChangeGateEnabled("OfficeVSO:7271429_FocusShiftOnMenuDismiss_ViewportRegressionFix")?this.Seb=sortFilter.SortFilterControllerFactoryGlobal.createSortFilterController(Object(f.a)(new X,{getFilterByValueItemsRequest:this.ADf,applyFilterByValueRequest:this.Mzf,onMenuItemClick:this.onMenuItemClick,focusShiftOnMenuDismiss:this.focusShiftOnMenuDismiss,autoFilterMenuWidth:qb.ZZc,applySortByColorOrIconRequest:this.ave})):this.Seb=sortFilter.SortFilterControllerFactoryGlobal.createSortFilterController(Object(f.a)(new X,
{getFilterByValueItemsRequest:this.ADf,applyFilterByValueRequest:this.Mzf,onMenuItemClick:this.onMenuItemClick,autoFilterMenuWidth:qb.ZZc,applySortByColorOrIconRequest:this.ave}))});this.ubd=h.a.instance.mg("Common.IExternalUICommandDefinitionMapping")||new u.a(this.$.Bb,this.$)}mvc(gb,Hb,ac,Ec,pd){da.b(this.$).rd(x.a.mvc,this.sm(),void 0,!0);if(ac){gb=this.qPh(ac,pd);Ec=Sys.UI.DomElement.getBounds(Hb);Hb=Ec.x+Ec.width;Ec=Ec.y;if(this.XA&&!ac.IsHeaderSnapped){if(!z.a.Opd(this.$,ac.Cell))return;ac=
z.a.Kfd(this.$,ac.Cell,!0);Hb=ac.x;Ec=ac.y}ac=O.h(this.$).rtl?new Sys.UI.Point(Hb-fa.a(this.$).oGa(qb.ZZc),Ec):new Sys.UI.Point(Hb,Ec);ac=fa.a(this.$).Mja(ac);ac=Object(f.a)(new nb,{targetPoint:Object(f.a)(new R,{left:ac.x,top:ac.y}),autoFilterMenu:gb});this.Seb.showSortFilterMenu(ac);this.$.Yc(-544117314,-1,0,null)}else d.ULS.shipAssertTag(537167135,0,!!ac,"Attempt at opening AutoFilterContextMenu failed, autoFilterData is null.")}J8f(gb){return(null===gb||void 0===gb?0:gb.Cell.SheetName)?O.h(this.$).X4?
gb.Cell.SheetName===this.$.na.name:gb.Cell.SheetName===this.$.na.sheetName:!0}qPh(gb,Hb){return(gb=this.rPh(gb,Hb))?this.pPf(gb):null}pPf(gb){const Hb=[];for(const ac of gb.Sections){if(Object(Ra.g)(this.$)&&ba.EwaSettings.isChangeGateEnabled("OfficeVSO:6122433_NSVTitleEnabled")&&ac.Title===Z.a.instance.ga(1950))continue;const Ec=this.z9i(ac);Hb.push(Ec)}return Object(f.a)(new Fa,{Id:gb.Id,Sections:Hb})}z9i(gb){const Hb=[];for(const ac of gb.MenuItems)if(2===ac.Identifier)this.$Yc=ac.CommandData;
else switch(ac.Type){case 3:case 2:Hb.push(this.x9i(ac,2===ac.Type));break;case 1:Hb.push(this.y9i(ac))}return Object(f.a)(new ka,{MenuItems:Hb,DisplayType:gb.DisplayType,Id:this.HMh(gb)})}y9i(gb){({label:pd,ILa:Ec}=this.K_e(gb));const Hb=this.pPf(gb.SubMenu),ac=this.B_e(gb);var Ec=this.ubd.pcc(Ec);var pd=pd||gb.Label;return Object(f.a)(new ca,{Disabled:gb.Disabled,Type:gb.Type,Identifier:gb.Identifier,Id:ac,CommandData:gb.CommandData,Label:pd,SubMenu:Hb,IsChecked:gb.IsChecked,IconName:"MissingIcon_20"===
Ec?null:Ec})}x9i(gb,Hb){let ac;({label:Hb,ILa:pd,yr:ac}=this.lbc(gb,Hb&&gb.IsChecked));const Ec=this.Eed(gb,Hb);var pd=this.ubd.pcc(pd);return Object(f.a)(new ca,{Disabled:gb.Disabled,Type:gb.Type,Identifier:gb.Identifier,Id:Ec,RibbonCommand:ac,CommandData:gb.CommandData,Label:Hb||gb.Label,SubMenu:null,IsChecked:gb.IsChecked,IconName:"MissingIcon_20"===pd?null:pd})}rPh(gb,Hb){var ac;this.PTa=ac=B.C(gb.Cell);this.sheetName=this.$.na.sheetName;Hb=Hb||m.a(this.$);if(gb.IsHeaderSnapped)ac=Hb.Z$b.LWh(ac);
else{Hb=O.h(this.$).Ca.IKa(ac);if(!Hb)return this.QMa?xa.a.NQa(ia.a.ERf,Ma.a.o8h,Ta.a.Rpb,!0,!1):(gb=O.h(this.$).view.visibleArea,d.ULS.sendTraceTag(537167134,0,10,`AutoFilterContextMenu.GetAutoFilterMenuProps: gridModelCellProxy that is supposed to hold model is null. Range requested ${ac}, visible range: ${gb}`)),null;ac=Hb.autoFilterMenu}if(!ac)return this.QMa?xa.a.NQa(ia.a.ERf,Ma.a.iIi,Ta.a.Rpb,!0,!1):d.ULS.sendTraceTag(537167133,0,10,"AutoFilterContextMenu.GetMenuPropsFromCachedBlock: a cell that's supposed to have an autofilter menu returned a null menu."),
null;this.Ptb=gb.Cell.FirstRow+"_"+gb.Cell.FirstColumn;return ac}yAc(){let gb=()=>U.GetServiceTaskFactory.Oa(this.$.da,283,284,1);ba.EwaSettings.isChangeGateEnabled("OfficeVSO:7457857_DynamicScriptLoaderNewService")&&(gb=()=>na.c(Yb.a.resolve(mc.e,{Tl:1})));if(this.$.ea.Zf){const Hb=gb();D.TaskExtensions.za(Hb,()=>{this.QMa?Hb.result.Hl.loadScript("sortFilter").then(()=>{this.kIb()},ac=>{ea.a.Fj(ac,"AutoFilterContextMenu.SortFilterScriptLoad");xa.a.NQa(ia.a.yAc,Ma.a.xMj,Ta.a.Rpb,!1,!1)}):D.TaskExtensions.za(na.c(Hb.result.Hl.loadScript("sortFilter")),
()=>{this.kIb()},this.$.la,3)},this.$.la,3)}else this.$.ea.Dk(this.DV)}Mbh(gb){const Hb={};Hb.SearchText=gb;Hb.Page=1;Hb.DateNodeType=-1;return Hb}L1g(){this.HPa&&(d.ULS.sendTraceTag(537167132,0,15,`AutoFilterContextMenu.CancelGetAutoFilterItemListWebRequest Cancelling pending getAutoFilterItemList request with ID=${this.HPa}`),I.h(this.$.oa.xa,this.HPa,null,null,null),this.HPa=null);this.Aab&&(l.AFrameworkApplication.Bd.Nt(this.Aab.Rs),this.Aab=null)}jDd(gb){return Hb=>{this.Aab=this.HPa=null;if(xa.a.zzc(Hb)){var ac=
xa.a.Bbc(Hb);this.QMa?xa.a.NQa(gb?ia.a.searchAutoFilterItemList:ia.a.getAutoFilterItemList,ac.MessageIdName,Ta.a.Rpb,!0,!0):d.ULS.sendTraceTag(537167127,0,10,`AutoFilterContextMenu::OnGetFilterByValueItemsSuccessCallback failed with AutoFilterException -${ac.MessageIdName}`)}if(!P.a(Hb)){d.ULS.sendTraceTag(537167126,0,50,"AutoFilterContextMenu::OnGetFilterByValueItems service call succeeded");ac=Hb.Result;Hb=new aa.a(!0);var Ec=ac.AutoFilterDateNodes?!0:!1;ac.AutoFilterItems&&Hb.add("AutoFilterItemsCount",
ac.AutoFilterItems.length);Ec&&Hb.add("AutoFilterDateItemsCount",ac.AutoFilterDateNodes.length);Hb.add("Location","contextMenu");Ec=this.j3a?Object(f.a)(new mb,{filterByValueItems:this.nGe(ac),hasMoreRecords:ac.ItemListMaxExceeded,searchText:ac.SearchText}):Object(f.a)(new mb,{filterByValueItems:this.nGe(ac),hasMoreRecords:ac.ItemListMaxExceeded});this.Seb.onGetFilterByValueItemsFinish(Ec);gb||(d.ULS.shipAssertTag(529063959,0,null!==ac.FontColors&&null!==ac.CellColors&&null!==ac.Icons&&null!==ac.SelectedSortFontColors&&
null!==ac.SelectedSortCellColors&&null!==ac.SelectedSortIcons,"AutoFilterContextMenu.onGetFilterByValueItemsSuccessCallback: SortByColor items should not be null"),Ec=Object(f.a)(new yb,{fontColors:ac.FontColors,cellColors:ac.CellColors,icons:ac.Icons,selectedSortFontColor:0<ac.SelectedSortFontColors.length?ac.SelectedSortFontColors[0]:null,selectedSortCellColor:0<ac.SelectedSortCellColors.length?ac.SelectedSortCellColors[0]:null,selectedSortIcon:0<ac.SelectedSortIcons.length?ac.SelectedSortIcons[0]:
null,getColorName:this.getColorName}),ba.EwaSettings.isChangeGateEnabled("OfficeVSO:7573807_IsColorOrIconPresent")&&(ac=1<ac.FontColors.length||1<ac.CellColors.length||1<ac.Icons.length)&&Hb.add("AutoFilterColorOrIconPresent",ac),da.b(this.$).rd(x.a.jDd,Hb.tu,void 0,!0),this.Seb.onGetColorsAndIconsFinish(Ec))}}}ATi(){return gb=>{this.Aab=this.HPa=null;gb=E.a.Pe(gb.data);gb=V.a.nc(gb);d.ULS.sendTraceTag(537167125,0,10,`AutoFilterContextMenu.OnGetFilterByValueItemsFailureCallback Errors: [${gb}].`)}}nGe(gb){const Hb=
this.v$g(gb),ac=this.C$g(gb.AutoFilterItems),Ec=[],pd=[];let Bd=0,de=0;gb.HasBlanks&&(gb=qb.L5c(Z.a.instance.ga(781),gb.IsBlanksSelected?1:0,w.a.Fwe),Ec[Bd++]=gb);for(const Jb of Hb)Ec[Bd++]=Jb;if(ba.EwaSettings.isChangeGateEnabled("OfficeVSO:6892133_ErrorsOnTop_FilterMenu_Fix"))for(const Jb of ac)-1!==Array.indexOf(La.a.V$c,Jb.displayText)?pd[de++]=Jb:Ec[Bd++]=Jb;else for(const Jb of ac)Ec[Bd++]=Jb;return Array.prototype.concat(pd,Ec)}v$g(gb){const Hb=[];if(!gb.AutoFilterDateNodes||!gb.AutoFilterDateNodes.length)return Hb;
const ac=[this.E4a(gb.YearKeys,gb.YearValues),this.E4a(gb.MonthKeys,gb.MonthValues),this.E4a(gb.DayKeys,gb.DayValues),this.E4a(gb.HourKeys,gb.HourValues),this.E4a(gb.MinuteKeys,gb.MinuteValues),this.E4a(gb.SecondKeys,gb.SecondValues)];let Ec=!1,pd=!1,Bd=0;var de=null;const Jb=Array(6);var tc=null;for(const fd of gb.AutoFilterDateNodes){Jb[0]&&(tc.Year!==fd.Year?(Ec=!0,Bd=0,de=null):tc.Month!==fd.Month?(pd=!0,Bd=1,de=Jb[0]):tc.Day!==fd.Day?(Bd=2,de=Jb[1]):gb.ShowTime&&(tc.Hour!==fd.Hour?(Bd=3,de=Jb[2]):
tc.Minute!==fd.Minute?(Bd=4,de=Jb[3]):(Bd=5,de=Jb[4])));for(;6>Bd;){let Ad;switch(Bd){case 0:Ad=fd.Year;tc=ac[0].getItem(Ad.toString());break;case 1:Ad=fd.Month;tc=ac[1].getItem(Ad.toString());break;case 2:Ad=fd.Day;tc=ac[2].getItem(Ad.toString());break;case 3:Ad=fd.Hour;tc=ac[3].getItem(Ad.toString());break;case 4:Ad=fd.Minute;tc=ac[4].getItem(Ad.toString());break;case 5:Ad=fd.Second;tc=ac[5].getItem(Ad.toString());break;default:throw Error.invalidOperation("Unknown AutoFilterDateNodeType.");}tc=
qb.L5c(tc,-1!==fd.NodeType&&Bd>=fd.NodeType?1:0,de?de.key+";"+Ad:w.a.$Zc+Ad,!1,[]);de=de?de.children:Hb;de=de[de.length]=tc;Jb[Bd]=tc;switch(Bd){case 5:Bd=6;break;case 2:Bd=gb.ShowTime?Bd+1:6;break;default:Bd++}}tc=fd}Ec||(Jb[0].expanded=!0,pd||(Jb[1].expanded=!0));return Hb}C$g(gb){const Hb=[];if(!gb)return Hb;let ac=0;for(const Ec of gb)Hb[ac++]=qb.L5c(Ec.DisplayString,Ec.Selected?1:0,w.a.a_c+Ec.DisplayString);return Hb}E4a(gb,Hb){const ac=new aa.a(!0);if(!gb||!Hb)return ac;const Ec=gb.length<Hb.length?
gb.length:Hb.length;for(let pd=0;pd<Ec;pd++)ac.add(gb[pd].toString(),Hb[pd]);return ac}w5c(gb,Hb){const ac={};ac.Location=Hb;ac.FieldId=gb.Id.toString();ac.DataSourceIndex=-1;ac.FilterType=gb.AutoFilterType;ac.AnchorType=0;ac.ChartId=null;ac.AnchorValue1=-1;ac.AnchorValue2=-1;ac.Property=gb.RichProperty;return ac}gS(gb){Ba.a.Yka(this.$)&&D.TaskExtensions.za(U.GetServiceTaskFactory.Oa(this.$.da,430,431,1),Hb=>{Hb.result.vea(gb);d.ULS.sendTraceTag(537167123,306,50,"AutoFilterContextMenu:TriggerPivotTableHandRaise Trigger hand raise from filter context menu.")},
this.$.la,3)}sm(){return{["Location"]:"contextMenu"}}getColorName(gb){return S.a.HKa(N.a.aH(gb))}GJj(gb){D.TaskExtensions.za(U.GetServiceTaskFactory.Oa(this.$.da,309,310,3),Hb=>{Hb.result.DSa().continueWith(ac=>{ac.result&&gb()})},this.$.la,3)}static L5c(gb=null,Hb=0,ac=null,Ec=!1,pd=null){return Object(f.a)(new fb,{displayText:gb?z.a.kf(gb):gb,state:Hb,key:ac,parent:null,children:pd,indentationLevel:0,expanded:Ec})}}qb.ZZc=268;Object(c.a)(qb,"AutoFilterContextMenu",z.a,[]);var Ha=a(739),Ya=a(84),
Gb=a(192),Ja=a(64),Na=a(19);class Qa{}Qa.yXe=26;Qa.tcd=[227,228,0,98,0,94,93];Object(c.a)(Qa,"Constants",null,[]);class Oa{constructor(gb,Hb,ac,Ec){this.EAg=gb;this.lvg=Hb;this.pvg=ac;this.SEg=Ec}get fri(){return 3===this.p6b}get evi(){return 4===this.p6b&&!!this.subMenu}get subMenu(){return this.SEg}get Jvf(){return this.EAg}get p6b(){return this.lvg}get l7c(){return this.pvg}}Object(c.a)(Oa,"FiltersMenuData",null,[]);class bb extends Oa{constructor(gb,Hb){super(gb,2,0,null);this.Gwe=Hb}}Object(c.a)(bb,
"AutoFilterFiltersMenuData",Oa,[]);class Ga{}Ga.IRj=[new Oa(99,2,0,null),new Oa(100,2,1,null),new Oa(0,3,0,null),new Oa(169,2,2,null),new Oa(171,2,4,null),new Oa(0,3,0,null),new Oa(173,2,6,null),new Oa(174,2,7,null),new Oa(0,3,0,null),new Oa(107,0,0,null)];Ga.FMi=[new Oa(99,2,0,null),new Oa(100,2,1,null),new Oa(0,3,0,null),new Oa(101,2,8,null),new Oa(102,2,10,null),new Oa(103,2,12,null),new Oa(0,3,0,null),new Oa(104,1,0,null),new bb(105,1),new bb(106,2),new Oa(0,3,0,null),new Oa(107,0,0,null)];Ga.ujh=
[new Oa(99,2,0,null),new Oa(0,3,0,null),new Oa(111,2,10,null),new Oa(112,2,8,null),new Oa(103,2,12,null),new Oa(0,3,0,null),new bb(109,8),new bb(108,9),new bb(110,10),new Oa(0,3,0,null),new bb(114,11),new bb(113,12),new bb(115,13),new Oa(0,3,0,null),new bb(116,14),new bb(117,15),new bb(118,16),new Oa(0,3,0,null),new bb(119,17),new bb(120,18),new bb(121,19),new Oa(0,3,0,null),new bb(122,20),new bb(123,21),new bb(124,22),new Oa(0,3,0,null),new bb(125,23),new Oa(126,2,12,[new bb(127,24),new bb(128,25),
new bb(129,26),new bb(130,27),new Oa(0,3,0,null),new bb(131,28),new bb(132,29),new bb(133,30),new bb(134,31),new bb(135,32),new bb(136,33),new bb(137,34),new bb(138,35),new bb(139,36),new bb(140,37),new bb(141,38),new bb(142,39)]),new Oa(0,3,0,null),new Oa(107,0,0,null)];Object(c.a)(Ga,"Constants",null,[]);var tb=a(927),wb=a(80);class lb extends z.a{constructor(gb,Hb,ac,Ec){super(gb,"PopulateAutoFilterFieldListContextMenu",474690375,216058793,lb.HFh,!0,!1,lb.bLb,Hb,ac,!1,Ec);this.qm=null}get Hw(){return"PopulateAutoFilterFieldListContextMenu"}get tB(){return w.a.DRf}executeCommand(gb,
Hb,ac){gb=Hb.command;switch(gb){case -699941697:this.applyAutoFilterFieldList(Hb,ac);break;case 216058793:break;case -1494291901:break;default:return Y.a(gb)}return wa.Task.Sa(!0)}Bfd(gb,Hb){return!gb||gb.length<=Hb?(d.ULS.sendTraceTag(537167117,0,10,"AutoFilterFieldListContextMenu:GetCommandId - incomplete id list"),-1):parseInt(gb[Hb],10)}lId(gb,Hb,ac,Ec,pd,Bd){const de=this.Bfd(pd,Bd);0>de&&d.ULS.sendTraceTag(537167116,0,10,"AutoFilterFieldListContextMenu:ProcessCommand - command id not found");
switch(Qa.tcd[de]){case 98:gb=new M.a(-2058042992,Hb.method,Hb.mode,Hb.Ve,Hb.tabName);this.qm.FG.cvb(this.$,Ec,0,gb);break;case 227:gb=new M.a(504133448,Hb.method,Hb.mode,Hb.Ve,Hb.tabName);this.qm.FG.cvb(this.$,Ec,0,gb);break;case 228:gb=new M.a(-798968736,Hb.method,Hb.mode,Hb.Ve,Hb.tabName);this.qm.FG.cvb(this.$,Ec,0,gb);break;case 232:gb=new M.a(-1677817820,Hb.method,Hb.mode,Hb.Ve,Hb.tabName);this.qm.FG.cvb(this.$,Ec,0,gb);break;case 94:this.IPf(gb,Hb,Ec,ac,pd,Bd+1);break;case 93:this.qm.FG.azi(this.$,
Ec)}}IPf(gb,Hb,ac,Ec,pd,Bd){const de=this.Bfd(pd,Bd);0>de&&d.ULS.sendTraceTag(537167115,0,10,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand - command id not found");if(!Ec||de>=Ec.length)d.ULS.sendTraceTag(537167114,0,15,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand() - no menuData.");else switch(Ec=Ec[de],Ec.p6b){case 1:this.qm.FG.uzi(this.$,ac);break;case 2:(pd=Object(Ya.a)(bb,Ec))?(gb=new M.a(-2058042992,Hb.method,Hb.mode,Hb.Ve,Hb.tabName),this.qm.FG.cvb(this.$,ac,pd.Gwe,gb)):this.qm.FG.Qpf(this.$,
gb,ac,Ec.l7c);break;case 0:this.qm.FG.Qpf(this.$,gb,ac,Ec.l7c);break;case 4:this.IPf(gb,Hb,ac,Ec.subMenu,pd,Bd+1)}}applyAutoFilterFieldList(gb,Hb){var ac=Hb[Ha.a.KF];if(ac)if(ac=ac.split(Ja.a.oU),3>ac.length)d.ULS.sendTraceTag(537167112,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - unexpected SourceIdControl string.");else{var Ec=this.Bfd(ac,1),pd=this.uKa(Ec),Bd=this.Evf(Ec).returnValue;Bd?this.lId(Hb,gb,Bd,pd,ac,2):d.ULS.sendTraceTag(537167111,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - menu data not found for index "+
Ec.toString()+Ja.a.oU)}else d.ULS.sendTraceTag(537167113,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - SourceIdControl string is null.")}wc(gb,Hb){if(gb=this.$.isEditMode)switch(Hb.command){case 216058793:break;case -699941697:break;case -1494291901:gb=!0;break;default:gb=!1}return gb}w0(gb,Hb,ac){this.$.isEditMode&&((this.qm=Object(Ya.a)(348,ac))||d.ULS.sendTraceTag(537167110,0,10,"AutoFilterFieldListContextMenu:ShowDropDown() - filterInfoManager not found."),this.FY(),super.w0(gb,
Hb,null,null,!0))}E5c(){if(!this.qm||!this.qm.Pk||1!==this.qm.Pk.length)return d.ULS.sendTraceTag(537167109,0,15,"AutoFilterFieldListContextMenu:CreateContextMenuItemList() - incorrect fields list."),null;const gb=this.qm.Pk[0];let Hb=new Gb.a;Hb.add(Z.a.instance.ga(248));Hb=wb.OBc(wb.concat(Hb,wb.select(wb.asEnumerable(gb.FieldInfoDataList),ac=>ac.Name)),ac=>ac,new tb.a);return wb.toArray(Hb)}fieldIndex(gb){if(!this.qm||!this.qm.Pk||1!==this.qm.Pk.length||!this.qm.Pk[0].FieldInfoDataList)return-1;
for(let Hb=0;Hb<this.qm.Pk[0].FieldInfoDataList.length;++Hb)if(this.qm.Pk[0].FieldInfoDataList[Hb].Name===gb)return Hb;return-1}uKa(gb){return 0>gb||!this.qm||!this.qm.Pk||1!==this.qm.Pk.length||!this.qm.Pk[0].FieldInfoDataList||this.qm.Pk[0].FieldInfoDataList.length<gb?null:this.qm.Pk[0].FieldInfoDataList[gb].Name}FY(){var gb=this.E5c();if(!gb||!gb.length)return null;const Hb=this.Va,ac=Hb.Ec();for(let de=0;de<gb.length;++de){const Jb=gb[de],tc=0<de?this.fieldIndex(Jb):-1,fd=lb.Oag+tc.toString()+
Ja.a.oU;let Ad=null;const me=this.qm.FG.lbi(0<de?Jb:null),Vd=this.P5c(Hb,me,lb.Oag+tc.toString(),Jb);for(let oe=0;oe<Qa.tcd.length;++oe){var Ec=Qa.tcd[oe],pd=fd+oe.toString();Ad||(Ad=Hb.Ec());switch(Ec){case 227:Ad.buttons.push(Hb.Lc(223,pd,-699941697,this.qm.FG.Pui(0<de?Jb:null)?Na.a.b$b:Na.a.oJa,8,227,!1,null));break;case 228:Ad.buttons.push(Hb.Lc(224,pd,-699941697,this.qm.FG.Qui(0<de?Jb:null)?Na.a.c$b:Na.a.pJa,8,228,!1,null));break;case 232:Ad.buttons.push(Hb.Lc(225,pd,-699941697,Na.a.$9b,1,232,
!1,null));break;case 98:Ec=this.iZg(Jb);pd=Hb.$Ha(pd+(me?".enabled":".disabled"),Ec,-699941697,null,"None",null,!me,void 0,!0);pd.VR("Image16by16",8,Na.a.V2a);Ad.buttons.push(pd);break;case 94:var Bd=void 0;const Me=({HXe:Bd,isChecked:Ec}=this.Evf(tc)).returnValue;if(!Me)return null;Bd=this.P5c(Hb,Ec&&me,pd,Bd);pd=this.P_e(Bd.menu,Hb,pd+Ja.a.oU,Me,Ec&&me);Bd.menu.rc.push(pd);Ad.buttons.push(Bd);break;case 0:Ad&&(Vd.menu.rc.push(Ad),Ad=null);break;default:pd=Hb.$Ha(pd,Z.a.instance.ga(Ec),-699941697,
null,"None",null,!1,void 0,!0),this.e4f(pd,me&&93===Ec&&this.qm.FG.filter(),Z.a.instance.ga(Ec)),Ad.buttons.push(pd)}}Vd.menu.rc.push(Ad);ac.buttons.push(Vd)}gb=Hb.uq(this.menuId);gb.rc.push(ac);return gb}P_e(gb,Hb,ac,Ec,pd){let Bd=null;for(let Ad=0;Ad<Ec.length;++Ad){var de=Ec[Ad],Jb=ac+Ad.toString(),tc=!1;switch(de.p6b){case 1:tc=pd&&this.qm.FG.tg.IsTop10;break;case 2:tc=Object(Ya.a)(bb,de);tc=pd&&this.qm.FG.Gni(tc?tc.Gwe:0,de.l7c);break;case 0:tc=pd&&this.qm.FG.tg.IsCustomSupportedAndNotPresent}Bd||
(Bd=Hb.Ec());if(de.fri)Bd&&(gb.rc.push(Bd),Bd=null);else if(de.evi){var fd=Z.a.instance.ga(de.Jvf);fd=this.P5c(Hb,tc,Jb,fd);fd.menu.rc.push(this.P_e(fd.menu,Hb,Jb+Ja.a.oU,de.subMenu,tc));Bd.buttons.push(fd)}else de=Z.a.instance.ga(de.Jvf),Jb=Hb.$Ha(Jb,de,-699941697,null,"None",null,!1,void 0,!0),this.e4f(Jb,tc,de),Bd.buttons.push(Jb)}return Bd}e4f(gb,Hb,ac){Hb?gb.VR("Image16by16",8,Na.a.sua):gb.VR("None",0,null);gb.TR(ac);gb.label=ac}P5c(gb,Hb,ac,Ec){return Hb?gb.F5c(ac,this.menuId,Ec,798637440,8,
Na.a.sua):gb.$v(ac,this.menuId,Ec,798637440)}lh(gb){return!gb||!gb.length}Evf(gb){var Hb=0>gb?0:this.qm.Pk[0].FieldInfoDataList[gb].MajorityDataTypeForField;var ac=null;gb=this.qm.FG.kbi(Hb);switch(Hb){case 0:ac=95;Hb=Ga.IRj;break;case 1:ac=94;Hb=Ga.FMi;break;case 2:ac=96;Hb=Ga.ujh;break;default:return d.ULS.sendTraceTag(537167108,0,10,"AutoFilterFieldListContextMenu:MenuDataForDataType() - unknown data type."),{returnValue:null,HXe:ac,isChecked:gb}}ac=Z.a.instance.ga(ac);return{returnValue:Hb,HXe:ac,
isChecked:gb}}iZg(gb){!gb||this.lh(gb.trim())?gb=Z.a.instance.ga(97):gb.length>Qa.yXe?(gb=gb.substring(0,Qa.yXe),gb=String.format(Z.a.instance.ob(155),gb)):gb=String.format(Z.a.instance.ob(156),gb);return gb}}lb.HFh=w.a.U9g;lb.bLb="AutoFilterFieldListContextMenuRoot";lb.Oag="ApplyAutoFilterFieldList.";Object(c.a)(lb,"AutoFilterFieldListContextMenu",z.a,[]);var db=a(548),Pa=a(855),ja=a(11),Ka=a(124),ub=a(377),Kb=a(784);class W extends z.a{constructor(gb,Hb,ac,Ec,pd="PopulateFloatingObjectContextMenu",
Bd=-2017893763,de=1350204367,Jb=w.a.a$g,tc=!0,fd=!1){super(gb,pd,Bd,de,Jb,tc,fd,Jb,Hb,ac,!0,Ec);this.floatingObject=null;this.vb=0;this.$mc=!0}get Hw(){return"PopulateFloatingObjectContextMenu"}get tB(){return w.a.LRf}executeCommand(gb,Hb,ac){gb=Object(Ya.a)(db.a,ac.eventArgs);switch(Hb.command){case -1372040782:ac=O.h(this.$).ha.Ra.dc;d.ULS.shipAssertTag(537167048,0,!!ac);ac&&(this.floatingObject=ac.floatingObject,this.vb=Hb.method,Hb=this.Zbc(gb),this.xp(Hb,!0,gb.vb));break;case 848910589:gb&&(Hb=
[Pa.a.q7f],gb=new Sys.UI.Point(gb.Ea.clientX,gb.Ea.clientY),this.showFloatie(Hb,new Sys.UI.Bounds(gb.x,gb.y,0,0),2))}return wa.Task.Sa(!0)}wc(gb,Hb,ac){switch(Hb.command){case -1372040782:return!!ac&&this.Nmf(gb);case 848910589:return gb=O.h(this.$).ha.Ra.dc,!!ac&&!!gb&&gb.fb;default:return!1}}Nmf(gb){switch(gb){case 8:case 2:case 64:case 4:case 256:return!0;default:return!1}}yWc(gb,Hb,ac){ub.a(this.$)?O.h(this.$).ib.fj||(fa.a(this.$).kUd()?ac.buttons.push(gb.pb(265)):ac.buttons.push(gb.pb(264))):
(this.$.isEditMode&&3===this.vb&&!this.Aac()&&ac.buttons.push(gb.pb(101)),5!==this.floatingObject.type||Ka.a.qH(this.floatingObject.Ab)||this.floatingObject.Ab.IsGroup||(this.Tsd()?ac.buttons.push(gb.pb(186)):ac.buttons.push(gb.pb(147))),this.Aac()||this.Tsd()||ac.buttons.push(gb.pb(146)),ba.EwaSettings.isChangeGateEnabled("OfficeVSO:7439032_ChangeFOZOrder")&&(this.HLh(ac),this.jNh(ac)),ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&0===this.floatingObject.type&&
ac.buttons.push(gb.pb(287)),ba.EwaSettings.ra(155)&&0===this.floatingObject.type&&ac.buttons.push(gb.pb(249)),5===this.floatingObject.type&&O.h(this.$).ha.Ra.dc.e5()&&this.$.Vka&&this.$.lP&&ac.buttons.push(gb.pb(273)))}xKa(gb){const Hb=[];if(ub.a(this.$))return Hb;3===gb?(gb=!!this.$.$d.get(5)&&this.floatingObject.sXd(),this.Aac()||(this.$.isEditMode?(gb&&Hb.push(Pa.a.JIh),5===O.h(this.$).ha.Ra.zA.floatingObject.type&&Hb.push(Pa.a.EDj)):gb&&Hb.push(Pa.a.copy)),Hb.push(Pa.a.KIh)):2===gb&&(ba.EwaSettings.isChangeGateEnabled("OfficeVSO:4840604_JsCrashInGetFloatieGroupsForSelection")?
O.h(this.$).ha.Ra.dc&&this.R4e(O.h(this.$).ha.Ra.dc,Hb):this.R4e(O.h(this.$).ha.Ra.zA,Hb));return Hb}FY(){const gb=this.Va,Hb=gb.uq(this.menuId);var ac=ub.a(this.$);if(this.$.isEditMode){var Ec=gb.Ec();this.yWc(gb,Hb,Ec);Hb.rc.push(Ec)}this.$.$d.get(5)&&this.floatingObject.sXd()&&!this.Aac()&&!ac&&(Ec=gb.Ec(),this.PIg(gb,Ec),Hb.rc.push(Ec));(Ec=this.$.va.na)&&Ec.Zd&&(Ec=Ec.Zd.kz||Ec.Zd.hK,!ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||0!==this.floatingObject.type||
!Kb.g(this.$)||this.$.ea.isNamedObjectViewMode||ac||this.$.isMobileMode||Ec||(ac=gb.Ec(),this.GKg(gb,ac),Hb.rc.push(ac)));return Hb}Zbc(gb){var Hb=O.h(this.$).ha.Ra.dc;gb=gb&&1!==gb.vb&&gb.clientPoint?gb.clientPoint:Sys.UI.DomElement.getLocation(Hb.domElement);const ac=this.$.domElement,Ec=O.h(this.$).rtl;(Hb=ja.HelperMethods.PC(Hb.ug.domElement,ac,Ec))?(gb.y=Math.max(gb.y,Hb.y),gb.x=Math.max(gb.x,Hb.x)):d.ULS.sendTraceTag(537167047,5,15,`FloatingObjectContextMenu.GetContextMenuClientPoint sheetContentDivLocation is null if the offset parent is null. IsShuttingdown : ${l.AFrameworkApplication.rg}`);
return gb}Tsd(){const gb=O.h(this.$).ha.Ra.dc;return!!gb&&gb.fb}PIg(gb,Hb){if(this.$.isEditMode){Hb.buttons.push(gb.pb(42));Hb.buttons.push(gb.pb(43));const ac=this.$.da.Aa(254,!0);(ac&&2===ac.aDb()||this.Tsd())&&Hb.buttons.push(gb.pb(44))}else Hb.buttons.push(gb.pb(43))}GKg(gb,Hb){Hb.buttons.push(gb.pb(274))}Aac(){return ba.EwaSettings.ra(407)&&!!O.h(this.$).ha.Ra.Wn}R4e(gb,Hb){5===gb.floatingObject.type?gb.fb?Hb.push(Pa.a.q7f):Hb.push(Pa.a.ADj):Hb.push(z.a.LYe)}HLh(gb){const Hb=this.Va.Ec();Hb.buttons.push(this.Va.pb(282));
Hb.buttons.push(this.Va.pb(281));const ac=this.Va.$v("BringToFront","BringToFrontMenuId",Z.a.instance.ga(821),-1777747317);ac.menu.rc.push(Hb);gb.buttons.push(ac)}jNh(gb){const Hb=this.Va.Ec();Hb.buttons.push(this.Va.pb(284));Hb.buttons.push(this.Va.pb(283));const ac=this.Va.$v("SendToBack","SendToBackMenuId",Z.a.instance.ga(822),-1777747317);ac.menu.rc.push(Hb);gb.buttons.push(ac)}}Object(c.a)(W,"FloatingObjectContextMenu",z.a,[]);var za=a(801),Sa=a(103),Wa=a(557),ab=a(517);const ma=w.a.X9g;class ha extends W{constructor(gb,
Hb,ac,Ec){super(gb,Hb,ac,Ec,"PopulateChartContextMenu",-498523270,1640762262,ma);this.isPivotChart=this.refresh=this.bZ=this.dwa=this.XAa=!1}get Hw(){return"PopulateChartContextMenu"}get tB(){return w.a.FRf}executeCommand(gb,Hb,ac){const Ec=this.$;this.vb=Hb.method;Hb=ac[ha.W1c];if(!(gb&68)){if(!Hb){if(8===gb)Hb=ab.a(Ec).Wc;else{var pd=O.h(Ec).ha.Ra.dc;if(null===pd||void 0===pd?0:pd.floatingObject)Hb=pd.floatingObject.Wc}if(!Hb)return wa.Task.Sa(!0)}this.isPivotChart=!!(Hb.Attributes&4)}if(this.isPivotChart||
Ec.isEditMode)if(this.refresh=this.bZ=this.dwa=this.XAa=!1,pd=O.h(this.$).ha.Ra.dc,d.ULS.shipAssertTag(537167107,0,!!pd),pd){this.floatingObject=pd.floatingObject;pd=Wa.a(Ec);if(null===pd||void 0===pd?0:pd.KTd)this.XAa=pd=Sa.f(Ec.dg),this.dwa=!pd;pd=Ec.$b;this.bZ=!!za.a(Ec)&&!!Hb&&!!(Hb.Attributes&512)&&!(gb&8)&&pd.t2(32768);pd.allowManualDataRefresh&&pd.allowInteractivity&&(this.refresh=!0);gb=this.Zbc(Object(Ya.a)(db.a,ac.eventArgs));this.xp(gb,!0)}return wa.Task.Sa(!0)}wc(gb,Hb,ac){return-149612405===
Hb.command&&!!ac&&this.Nmf(gb)}yWc(gb,Hb,ac){this.isPivotChart&&(this.refresh&&ac.buttons.push(gb.pb(100)),this.bZ&&ac.buttons.push(gb.pb(99)),this.XAa?ac.buttons.push(gb.pb(59)):this.dwa&&ac.buttons.push(gb.pb(58)));super.yWc(gb,Hb,ac)}static get W1c(){return"chartMetaData"}}Object(c.a)(ha,"ChartContextMenu",W,[]);var eb=a(12);const ta=w.a.Z9g;class ya extends z.a{constructor(gb,Hb,ac,Ec){super(gb,"PopulateFieldListContextMenu",-1045020714,-170383950,ta,!0,!1,ta,Hb,ac,!1,Ec);this.qL=this.lo=null;
this.uXd=this.isOlap=this.kV=this.MZ=!1}get Hw(){return"PopulateFieldListContextMenu"}get tB(){return w.a.vJd}executeCommand(gb,Hb,ac){gb=Hb.command;switch(gb){case 330754562:Hb=ac.domElement;this.isOlap=ac.isOlap;this.qL=ac.versionkey;this.lo=ac.fieldItem;this.MZ=ac.isChart;this.kV=ac.isPpm;this.uXd="supportsImplicitMeasures"in ac?ac.supportsImplicitMeasures:!1;O.h(this.$).Fo(!0);Hb=eb.DOMElementExtensions.getBounds(Hb);Hb=new Sys.UI.Point(Hb.x+Hb.width,Hb.y+Hb.height/2);"isKeyboardInput"in ac&&
ac.isKeyboardInput?this.xp(Hb,!1,1):this.xp(Hb,!1);break;case 926905850:this.uXd&&this.lo&&5===this.lo.TypeTag&&!this.lo.IsCollapsible&&d.ULS.sendTraceTag(537167057,0,50,"Add implicit measurement from field list.");Wa.a(this.$).zJ(this.lo,8,-1,this.qL,Hb);break;case -67292059:Wa.a(this.$).zJ(this.lo,1,-1,this.qL,Hb);break;case 745182485:Wa.a(this.$).zJ(this.lo,2,-1,this.qL,Hb);break;case 359279088:Wa.a(this.$).zJ(this.lo,4,-1,this.qL,Hb);break;case 547535945:Wa.a(this.$).Hcj(this.lo);break;default:return Y.a(gb)}return wa.Task.Sa(!0)}wc(gb,
Hb,ac){gb=!1;switch(Hb.command){case 330754562:gb=!!ac;break;case 926905850:case -67292059:case 745182485:case 359279088:case 547535945:gb=!0}return gb}FY(){const gb=this.Va.uq(this.menuId);this.Y6i(gb);this.MZ||this.isOlap||this.X6i(gb);return gb}Y6i(gb){const Hb=this.Va,ac=Hb.Ec();let Ec=!1;ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1)&&(Ec=this.isOlap&&!this.kV&&this.uXd&&5===this.lo.TypeTag&&!this.lo.IsCollapsible);3!==this.lo.TypeTag&&37!==this.lo.TypeTag||
this.lo.IsSet?17===this.lo.TypeTag||this.kV?(ac.buttons.push(Hb.pb(79)),ac.buttons.push(Hb.pb(this.MZ?91:80)),ac.buttons.push(Hb.pb(this.MZ?92:81)),ac.buttons.push(Hb.pb(82))):13===this.lo.TypeTag||this.lo.IsSet?(ac.buttons.push(Hb.pb(83)),ac.buttons.push(Hb.pb(this.MZ?91:80)),ac.buttons.push(Hb.pb(this.MZ?92:81)),ac.buttons.push(Hb.pb(86))):(ac.buttons.push(Hb.pb(79)),ac.buttons.push(Hb.pb(this.MZ?91:80)),ac.buttons.push(Hb.pb(this.MZ?92:81)),ac.buttons.push(Hb.pb(Ec?82:86))):(ac.buttons.push(Hb.pb(83)),
ac.buttons.push(Hb.pb(this.MZ?93:84)),ac.buttons.push(Hb.pb(this.MZ?94:85)),ac.buttons.push(Hb.pb(82)));gb.rc.push(ac)}X6i(gb){const Hb=this.Va.Ec();Hb.buttons.push(this.Va.pb(78));gb.rc.push(Hb)}}Object(c.a)(ya,"FieldListContextMenu",z.a,[]);var sb=a(421),Qb=a(65);class oc{constructor(gb){this.$=gb;this.lN={}}get(gb,Hb,ac){const Ec=this.Sgg(gb,"PivotFilterContextMenuCache.Get");return Ec&&this.lN[Ec]?this.lN[Ec][oc.Ahd(Hb,this.$,gb,ac)]:null}set(gb,Hb,ac,Ec){const pd=this.Sgg(gb,"PivotFilterContextMenuCache.Set");
pd&&(this.lN[pd]||(this.lN[pd]={}),this.lN[pd][oc.Ahd(Hb,this.$,gb,Ec)]=ac)}O8b(gb){gb in this.lN&&this.lN[gb]&&(this.lN[gb]=null)}Sgg(gb,Hb){return Qb.f(this.$.na)?this.$.activeItemName:(gb=this.AWj(gb,Hb))?gb.Zc:null}AWj(gb,Hb){gb=B.C(gb);gb=O.h(this.$).Ca.ova(gb,this.$.activeItemName);d.ULS.shipAssertTag(537167008,0,!!gb,`PivotFilterContextMenuBase.TryGetBlockModelProxyFromCell: Can't query the menuCache as block wasn't found in the BlockManager (returned null). Called from: ${Hb}`);return gb}static Ahd(gb,
Hb,ac,Ec){return ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&0===Ec?Hb.na.index+"_"+gb.id+"_"+ac.FirstRow.toString()+"_"+ac.FirstColumn.toString():Hb.na.index+"_"+gb.id}}Object(c.a)(oc,"PivotFilterContextMenuCache",null,[]);class kb{constructor(){this.cell=null;this.dataSourceIndex=0;this.Bo=this.pivotName=null}}Object(c.a)(kb,"ShowPivotFilterData",null,[]);var jb=a(461),Wb=a(1317),wc=a(51);const Jc=w.a.bGe;class zc extends z.a{constructor(gb,Hb,ac,Ec,pd,Bd,de,Jb=Jc){super(gb,
Hb,ac,Ec,Jb,!0,!1,"PivotFilterMenuRootName",pd,Bd,!1,de);this.roc=this.MBd=this.pivotData=this.rnb=this.Vof=this.y6b=null;this.iY=this.D3b=this.CFb=0;this.Xsb=null;this.VTi=(tc,fd)=>{if(fd)if(P.a(tc))this.Hyd(fd,!1);else if(tc=tc.Result){this.Ptb=oc.Ahd(fd,this.$,this.pivotData.cell,this.iY);var Ad=this.Fvf(tc.MenuModel.Sections);this.Xsb=Ad;zc.lN.set(this.pivotData.cell,fd,Ad,this.iY);Wb.a(this.$).YOj(tc);this.Hyd(fd,!0)}};this.UTi=(tc,fd)=>{this.Hyd(fd,!1)};this.nf=(tc,fd)=>{zc.lN.O8b(fd.Xc.hash)};
this.Tm=(tc,fd)=>{zc.lN.O8b(fd.Xc.hash)};this.Gza=null;this.FBe=this.D3b=this.NBd=this.CFb=-1;this.lte=this.iY=0;this.XA=ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");zc.lN||(zc.lN=new oc(this.$),O.h(this.$).Ca.Ns(this.nf),O.h(this.$).Ca.zG(this.Tm),O.h(this.$).Ca.v9(this.nf))}zbd(gb,Hb){const ac=gb.rawEvent,Ec=gb.cell,pd=gb.requiresConfirmation;jb.a(this.$).Cx(pd,Bd=>{if(Bd){Bd=ac?new Sys.UI.DomEvent(ac):null;this.pivotData=new kb;this.pivotData.pivotName=gb.pivotName;this.pivotData.dataSourceIndex=
gb.dataSourceIndex;this.pivotData.cell=Ec;this.pivotData.Bo=gb.optionalPivotMenuAnchorParameter;if(this.pivotData.Bo&&0<this.pivotData.Bo.AnchorType){this.roc=gb.objectId;this.CFb=gb.objectVersion;const de=this.pivotData.Bo.AnchorType;if(4===de||5===de||6===de||11===de||9===de||10===de||8===de)this.rnb=gb.location}else this.MBd=this.roc=null,this.NBd=this.CFb=-1;O.h(this.$).Fo(!0);this.$.ak(Ec);this.w0(Bd,Bd?Bd.target:gb.domElement,this.pivotData,Hb,this.rMa())}});return!0}w0(gb,Hb,ac,Ec){if(Object(sb.a)(kb,
ac)){this.pivotData=ac;this.y6b=Hb;this.Vof=gb;this.D3b=this.pivotData.Bo?this.pivotData.Bo.AnchorValue1:-1;this.iY=this.pivotData.Bo?this.pivotData.Bo.AnchorType:0;var pd=!1,Bd=null;Bd=zc.lN.get(this.pivotData.cell,Hb,this.iY);pd=!!Bd;var de=!0;switch(this.iY){case 4:case 5:case 6:this.Gza=new Sys.UI.Point(this.rnb.x,this.rnb.y);de=!1;break;case 7:var Jb=Sys.UI.DomElement.getBounds(Hb);de=Jb.x+(0<=Jb.x?0:Jb.width);Jb=Jb.y+(0<=Jb.y?0:Jb.height);this.Gza=new Sys.UI.Point(0<=de?de:0,0<=Jb?Jb:0);de=
!1;break;case 8:case 10:case 9:case 11:this.Gza=new Sys.UI.Point(this.rnb.x,this.rnb.y);break;default:this.Gza=null}pd&&this.roc===this.MBd&&this.CFb===this.NBd&&this.D3b===this.FBe&&this.iY===this.lte?(d.ULS.sendTraceTag(537167042,0,50,"PivotFilterContextMenuBase.ShowDropDown: rendering pivot filter context menu from menu cache"),this.Xsb=Bd,this.Gza?this.xp(this.Gza,this.rMa()):this.XA?z.a.Opd(this.$,this.pivotData.cell)&&this.xp(z.a.Kfd(this.$,this.pivotData.cell,!1),this.rMa()):super.w0(gb,Hb,
ac,Ec,this.rMa())):1!==zc.TUh(Hb)&&(de&&(Hb.parentNode.menuFetchStates=1,this.ayj(Hb),this.O3f(!0)),this.$.userOperationManager.Jc(new H.a(126,0,(tc,fd,Ad)=>{const me=this.$;return I.p(me.oa.xa,this.pivotData.cell,this.pivotData.dataSourceIndex,this.pivotData.pivotName,me.domElement.id,me.isChromeRtl,me.workbookContext.NovMode,ra.b(tc,this.VTi),ra.a(fd,this.UTi),Ad,Hb,this.pivotData.Bo)},16),Ec))}}GGd(gb){gb.MenuSectionList.push(...this.Xsb)}Hyd(gb,Hb){gb.parentNode.menuFetchStates=2;this.O3f(!1);
if(Hb){if(this.y6b!==gb||this.jIi())this.xp(this.Gza,this.rMa());else if(this.XA&&!this.Gza){if(!z.a.Opd(this.$,this.pivotData.cell))return;this.xp(z.a.Kfd(this.$,this.pivotData.cell,!1),this.rMa())}else super.w0(this.Vof,gb,null,null,this.rMa());this.MBd=this.roc;this.NBd=this.CFb;this.lte=this.iY;this.FBe=this.D3b}}rMa(){return 8!==this.iY&&9!==this.iY&&10!==this.iY&&11!==this.iY}jIi(){switch(this.pivotData.Bo?this.pivotData.Bo.AnchorType:0){case 1:case 2:case 3:case 4:case 5:case 6:case 7:return!0;
default:return!1}}O3f(gb){const Hb=this.y6b;if(Hb){if(ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5041973_FixDropdownImageDisappearing")){var ac=eb.DOMElementExtensions.lZ(Hb,"ewaprevsrc","");ac=!!ac&&"null"!==ac}else ac=!!eb.DOMElementExtensions.lZ(Hb,"ewaprevsrc","");gb&&ac||!gb&&!ac||(gb?(Hb.setAttribute("ewaprevsrc",Hb.src),Hb.src=wc.a.current.qo(98)):(gb=eb.DOMElementExtensions.lZ(Hb,"ewaprevsrc",""),Hb.src=gb,Hb.setAttribute("ewaprevsrc",null)))}}ayj(gb){this.y6b=gb}static TUh(gb){const Hb=
gb.parentNode.menuFetchStates;void 0===Hb&&(gb.parentNode.menuFetchStates=0);return Hb}}zc.lN=null;Object(c.a)(zc,"PivotFilterContextMenuBase",z.a,[]);const gd="FieldList"+w.a.bGe;class Va extends zc{constructor(gb,Hb,ac,Ec){super(gb,"PopulateFieldListPivotMenu",-1793121409,1378457149,Hb,ac,Ec,gd)}get Hw(){return"PopulateFieldListPivotMenu"}get tB(){return w.a.JRf}executeCommand(gb,Hb,ac){return this.zbd(ac,Hb)?wa.Task.Sa(!0):Y.a(Hb.command)}wc(gb,Hb,ac){return-1065117584===Hb.command&&!!ac}}Object(c.a)(Va,
"FieldListPivotContextMenu",zc,[]);var Eb=a(268),hc=a(30),Ab=a(89),Bb=a(765);class ec{}Object(c.a)(ec,"PivotValueFieldSettingsApplyData",null,[]);class Qd{}Qd.smg="valueFieldSettingTabs";Qd.$ih="dataFieldCustomLabel";Qd.dKe="dataFieldSourceLabel";Qd.uVd="showValueAsSelect";Qd.sVd="showValueAsBaseFieldSelect";Qd.tVd="showValueAsBaseItemSelect";Qd.I1d="valueFieldsSettingsFieldName";Object(c.a)(Qd,"CssElementIds",null,[]);var dc=a(87);class dd{constructor(gb,Hb,ac){this.baseItemIndex=this.baseFieldIndex=
this.dataFormat=0;this.dataFormat=gb;this.baseFieldIndex=Hb;this.baseItemIndex=ac}}Object(c.a)(dd,"MacroRecorderPivotFieldShowValueAsParameters",null,[]);class jd{constructor(gb,Hb,ac,Ec,pd){this.externalSourceIndex=0;this.pivotFieldTitle=this.activeCell=null;this.summarizeBy=0;this.showAsValueParameters=null;this.externalSourceIndex=gb;this.activeCell=Hb;this.pivotFieldTitle=ac;this.summarizeBy=Ec;this.showAsValueParameters=pd}getActiveCell(){return this.activeCell}}Object(c.a)(jd,"MacroRecorderPivotValueFieldSettingAppliedPayload",
null,[162]);var md=a(239);class vd{}Object(c.a)(vd,"PivotValueFieldShowValueAsApplyData",null,[]);var wd=a(750),Pd=a(45);const ic=`<div id='showValueAsControlBody'><label for='${Qd.uVd}' class='${dc.a.Nl} valueFielsSettingsControlTitle'>{0}</label><div><select size=1 id='${Qd.uVd}' class='${dc.a.Px}'></select></div><div class='showValueAsControlSelectRegion'><label for='${Qd.sVd}'>{1}</label><div><select size=6 id='${Qd.sVd}' class='${dc.a.Px}'></select></div></div><div class='showValueAsControlSelectRegionSeparator'></div><div class='showValueAsControlSelectRegion'><label for='${Qd.tVd}'>{2}</label><div><select size=6 id='${Qd.tVd}' class='${dc.a.Px}'></select></div></div></div>`;
class cd extends md.a{constructor(gb,Hb,ac,Ec,pd,Bd,de,Jb,tc){super(gb);this.htmlSanitizationHelper=this.C7d=this.m5d=this.l5d=this.S1b=this.a7b=this.bD=null;this.JBf=()=>{var fd=parseInt(this.X$.ee.value,10);this.z1g(fd)?(this.nP.qp.disabled=!0,this.oP.qp.disabled=!0,this.oP.clear(),cd.Pgf(fd)?(this.nP.qp.disabled=!1,this.RPb(!1)):cd.Qgf(fd)?(this.nP.qp.disabled=!1,this.oP.qp.disabled=!1,this.RPb(!0),this.Gqf()):this.RPb(!1)):(fd=V.a.ed(1,0,0,1130,0,7896227,"FormatRequiresBaseFieldsOrBaseItems"),
Pd.a(this.$).Jt([fd]),this.X$.aqj())};this.yOi=()=>{0>this.nP.selectedIndex||this.oP.qp.disabled||(this.RPb(!0),this.Gqf())};this.OUi=fd=>{this.bD.fTa();this.oP.qp.style.overflowY="scroll";if(fd&&!P.a(fd)){fd=fd.Result;this.oP.clear();for(const Ad of fd.BaseItems)this.oP.dY(Ad.DisplayString,Ad.Id.toString(),Ad.Id===fd.SelectedBaseItem);this.RPb(!1)}};this.get_visible=this.Uja;this.set_visible=this.Mna;this.$=Hb;this.cell=ac;this.Bo=Ec;this.externalSourceIndex=pd;this.Sd=Bd;this.cta=de;this.Dri=Jb;
this.htmlSanitizationHelper=tc;this.g1j=ba.EwaSettings.isChangeGateEnabled("OfficeVSO:4859461_DisableOKButtonWhenLoadingIndictorIsOn");this.pka()}Uja(){return this.isVisible}Mna(gb){return this.isVisible=gb}get title(){return Z.a.instance.ga(1118)}get Gxb(){const gb=this.X$.ee?parseInt(this.X$.ee.value,10):-1,Hb=this.nP.ee?parseInt(this.nP.ee.value,10):-1,ac=this.oP.ee?parseInt(this.oP.ee.value,10):-1;return Object(f.a)(new vd,{SelectedDataFormat:0<=gb?gb:-1,SelectedBaseField:Hb,SelectedBaseItem:ac})}get nP(){return this.l5d}get oP(){return this.m5d}get X$(){return this.C7d}setFocus(){eb.DOMElementExtensions.setFocus(this.X$.qp)}render(gb){gb.appendChild(this.domElement)}dispose(){Ab.a.pc([this.X$,
this.nP,this.oP,this.a7b,this.S1b]);super.dispose()}NAj(gb){Ab.a.pc([this.a7b,this.S1b]);this.X$.clear();for(const Hb of gb.DataFormatTypes)this.X$.dY(cd.cTh(Hb),Hb.toString(),Hb===gb.SelectedDataFormat);this.a7b=this.Ae.ie(this.X$.domElement);this.a7b.ka("change",this.JBf);this.nP.clear();for(const Hb of gb.BaseFieldList)this.nP.dY(Hb.DisplayString,Hb.Id.toString(),Hb.Id===gb.SelectedBaseField);this.S1b=this.Ae.ie(this.nP.domElement);this.S1b.ka("change",this.yOi);this.bD=this.cta.Rsb(this.oP.qp.parentNode,
1E3,null,"",735);this.bD.fTa();this.JBf(null)}DQ(gb){this.X$.DQ(gb);this.nP.DQ(gb);this.oP.DQ(gb)}pka(){this.htmlSanitizationHelper.Rh(this.domElement,String.format(ic,Z.a.instance.ga(1119),Z.a.instance.ga(1120),Z.a.instance.ga(1121)));this.C7d=new wd.a(eb.DOMElementExtensions.getElementById(this.domElement,Qd.uVd),!1);this.l5d=new wd.a(eb.DOMElementExtensions.getElementById(this.domElement,Qd.sVd),!1);this.m5d=new wd.a(eb.DOMElementExtensions.getElementById(this.domElement,Qd.tVd),!1)}z1g(gb){return this.Dri||
!cd.Pgf(gb)&&!cd.Qgf(gb)?!0:!!this.nP.count}getValueFieldSettingsShowValueAsBaseItemsInfo(){this.$.userOperationManager.Jc(new H.a(108,0,(gb,Hb,ac)=>{var Ec=this.$.oa.xa,pd=parseInt(this.nP.ee.value,10);gb=ra.b.call(null,gb,this.OUi);const Bd=I.L(Ec,this.cell,this.externalSourceIndex,this.Bo);Bd.selectedBaseField=pd;return I.g(Ec,"GetPivotValueFieldSettingsShowValueAsBaseItems",Bd,gb,Hb,ac,null,4)},16),this.Sd)}Gqf(){this.oP.clear();this.nP.ee&&(this.bD.$Sa(),this.oP.qp.style.overflowY="hidden",this.getValueFieldSettingsShowValueAsBaseItemsInfo())}RPb(gb){const Hb=
document.getElementById("WACDialogActionButton");this.g1j&&Hb&&(Hb.disabled=gb)}static cTh(gb){switch(gb){case 0:return Z.a.instance.ga(1122);case 1:return Z.a.instance.ga(1123);case 2:return Z.a.instance.ga(1124);case 3:return Z.a.instance.ga(1125);case 4:return Z.a.instance.ga(1126);case 5:return Z.a.instance.ga(1127);case 6:return Z.a.instance.ga(1128);case 7:return Z.a.instance.ga(1129);case 8:return Z.a.instance.ga(1131);case 9:return Z.a.instance.ga(1132);case 10:return Z.a.instance.ga(1133);
case 11:return Z.a.instance.ga(1134);case 12:return Z.a.instance.ga(1135);case 13:return Z.a.instance.ga(1136);case 14:return Z.a.instance.ga(1137);default:return""}}static Pgf(gb){return 11===gb||12===gb||14===gb||13===gb||4===gb}static Qgf(gb){return 1===gb||3===gb||2===gb}}Object(c.a)(cd,"ShowValueAsControl",md.a,[370,2]);class Hd{}Object(c.a)(Hd,"PivotValueFieldSummarizeValueByApplyData",null,[]);const he="<div id='summarizeValuesByControlBody'>"+`<label class='${dc.a.Nl} valueFielsSettingsControlTitle' for='${"pivotDataFieldSelect"}'>{0}</label>`+
`<div id='${"pivotDataFieldSelectDescription"}' class='${dc.a.Nl} summarizeValuesByControlDescription'>{1}</div>`+`<div><select class='${dc.a.Px}' size=6 id='${"pivotDataFieldSelect"}' style='width: 100%' ${w.a.DG}='${"pivotDataFieldSelectDescription"}'></select></div>`+"</div>";class Lb extends md.a{constructor(gb,Hb){super(gb);this.htmlSanitizationHelper=this.Pge=null;this.get_visible=this.Uja;this.set_visible=this.Mna;this.htmlSanitizationHelper=Hb;this.pka()}get Gxb(){const gb=this.ml.ee?parseInt(this.ml.ee.value,
10):-1;return Object(f.a)(new Hd,{Aggregation:0<=gb?gb:-1})}Uja(){return this.isVisible}Mna(gb){return this.isVisible=gb}get title(){return Z.a.instance.ga(1117)}get enabled(){return!this.ml.qp.disabled}set enabled(gb){this.ml.qp.disabled=!gb}get ml(){return this.Pge}setFocus(){eb.DOMElementExtensions.setFocus(this.ml.qp)}render(gb){gb.appendChild(this.domElement)}dispose(){Ab.a.Ja(this.ml);super.dispose()}focus(){eb.DOMElementExtensions.setFocus(this.ml.qp)}MAj(gb){this.ml.rWd();for(const Hb of gb.AggregationTypes){const ac=
Hb===gb.SelectedAggregation;this.ml.wWc(Lb.AOh(Hb),Hb.toString(),ac,"")}this.ml.g$c();this.ml.qp.disabled=gb.AggregationsDisabled}Xpj(){this.ml.Ypj()}pka(){this.htmlSanitizationHelper.Rh(this.domElement,String.format(he,Z.a.instance.ga(1102),Z.a.instance.ga(1103)));this.Pge=new wd.a(eb.DOMElementExtensions.getElementById(this.domElement,Lb.JMf),!1)}static AOh(gb){switch(gb){case 0:return Z.a.instance.ga(1105);case 1:return Z.a.instance.ga(1106);case 2:return Z.a.instance.ga(1107);case 3:return Z.a.instance.ga(1108);
case 4:return Z.a.instance.ga(1109);case 5:return Z.a.instance.ga(1110);case 6:return Z.a.instance.ga(1111);case 7:return Z.a.instance.ga(1112);case 8:return Z.a.instance.ga(1113);case 9:return Z.a.instance.ga(1114);case 10:return Z.a.instance.ga(1115);case 11:return Z.a.instance.ga(1116);default:return""}}}Lb.JMf="pivotDataFieldSelect";Object(c.a)(Lb,"SummarizeValuesByControl",md.a,[370,2]);var Ic=a(215),Ob=a(469),Kc=a(1261);class Ac extends Bb.a{constructor(gb,Hb,ac,Ec,pd,Bd,de,Jb,tc,fd){super(pd,
Z.a.instance.ob(61),!0,2,!0);this.n9f=!0;this.htmlSanitizationHelper=this.aUc=this.A7c=this.ntb=this.Ifa=this.JSa=this.vme=null;this.mOi=Ad=>{Eb.a.any(Ad.Errors,me=>-103190598===me.MessageId)&&this.nTa.Xpj()};this.NUi=Ad=>{Ad&&!P.a(Ad)&&(Ad=Ad.Result,this.htmlSanitizationHelper.J4f(this.A7c,Z.a.instance.ga(1100)+hc.a.yg(Ad.ValueFieldSourceName)),this.isOlap&&!this.kV?(this.nTa.enabled=!1,this.Ifa.activeTab=this.Ifa.EBc-1):(this.nTa.enabled=!0,this.Ifa.activeTab=0),this.nTa.MAj(Ad.PivotValueFieldSettingsSummarizeValueByInfo),
this.JSa.NAj(Ad.PivotValueFieldShowValueAsInitialInfo),this.kg())};this.cell=gb;this.Bo=Hb;this.externalSourceIndex=ac;this.rmg=Ec;this.Sd=Bd;this.cta=de;this.isOlap=Jb;this.kV=tc;this.htmlSanitizationHelper=fd}get kc(){return"ValueFieldSettingsDialog"}get gCa(){return this.vme}get ZEb(){return this.Ifa}get nTa(){return this.aUc}get IB(){return 560}dispose(){this.A7c=this.ntb=this.JSa=this.aUc=null;Ab.a.Ja(this.Ifa);this.Ifa=null;super.dispose()}initialize(){let gb="<div id='"+Qd.dKe+"' class='"+
dc.a.Nl+"'></div><div id='"+Qd.$ih+"' class='"+dc.a.Nl+"'><label for='"+Qd.I1d+"'>{0}</label><input type='text' id='"+Qd.I1d+"' value='{1}' class='"+dc.a.Px+" UIFont' /></div><div id='"+Qd.smg+"'></div>";gb=String.format(gb,Z.a.instance.ga(1101),hc.a.yg(this.rmg));this.htmlSanitizationHelper.Rh(this.Fb,gb);this.If||(this.Tra(),this.tt());this.vme=[-103190598];this.D6h();super.initialize()}close(gb){1===gb&&(this.n9f=!1);super.close(gb)}nMe(gb){this.isDisabled=gb;this.domElement.disabled=gb;const Hb=
["input","option","select"];for(let ac=0,Ec=Hb.length;ac<Ec;++ac){const pd=this.domElement.getElementsByTagName(Hb[ac]);for(let Bd=0;Bd<pd.length;++Bd)pd[Bd].disabled=gb}}tt(){this.ntb=document.getElementById(Qd.I1d);this.A7c=eb.DOMElementExtensions.getElementById(this.Fb,Qd.dKe);const gb=eb.DOMElementExtensions.getElementById(this.Fb,Qd.smg);this.aUc=new Lb(document.createElement("div"),this.htmlSanitizationHelper);this.JSa=new cd(document.createElement("div"),this.$,this.cell,this.Bo,this.externalSourceIndex,
this.Sd,this.cta,!this.isOlap,this.htmlSanitizationHelper);let Hb;this.Ifa=new Kc.a(gb,(Hb=new Gb.a,Hb.add(this.nTa),Hb.add(this.JSa),Hb));this.Ifa.mXf()}RGd(){const gb=new Ac(this.cell,this.Bo,this.externalSourceIndex,this.rmg,this.$,this.Sd,this.cta,this.isOlap,this.kV,this.htmlSanitizationHelper);gb.initialize();gb.kg()}GQb(){const gb=new Ob.a;if(!this.n9f)return gb.isValid=!0,gb;this.ntb.value.length?gb.isValid=!0:(this.nMe(!0),gb.error=V.a.ed(1,0,750,765,0,1783218700,"PivotTableValueFieldNoBlank"),
this.isDisabled=!0,this.If||(this.Ry.disabled=!0),gb.isValid=!1);return gb}p$e(){this.isDisabled=!1;this.If||(this.Ry.disabled=!1);this.nMe(!1)}Bya(gb){const Hb=new M.a(2105621672,0,this.$.xc,30,null);this.$.Ia.Hb(Hb);this.Hz(5,gb.vb,"Number Format");return!0}$p(){this.xoa=String.format(Z.a.instance.ob(61),null);super.$p()}setFocus(){if(this.If){const gb=eb.DOMElementExtensions.getElementById(this.Fb,Lb.JMf);Ic.a.m_d(gb)}else this.Ifa.setFocus()}Vj(){const gb=this.JSa.Gxb,Hb=new dd(gb.SelectedDataFormat,
gb.SelectedBaseField,gb.SelectedBaseItem);return()=>new jd(this.externalSourceIndex,this.cell,this.ntb.value,this.nTa.Gxb.Aggregation,Hb)}GG(){const gb=Object(f.a)(new ec,{PivotValueFieldSummarizeValueByApplyData:this.nTa.Gxb,PivotValueFieldShowValueAsApplyData:this.JSa.Gxb,PivotValueFieldTitle:this.ntb.value});return(Hb,ac,Ec)=>{var pd=this.$.oa.xa;Hb=ra.b(Hb,this.mOi);const Bd=I.L(pd,this.cell,this.externalSourceIndex,this.Bo);Bd.pivotValueFieldSettingsApplyData=gb;return I.g(pd,"ApplyPivotValueFieldSettings",
Bd,Hb,ac,Ec,null,0)}}DQ(gb){this.$.da.gb(40,()=>{this.JSa.DQ(gb)})}D6h(){this.$.userOperationManager.Jc(new H.a(123,0,(gb,Hb,ac)=>{var Ec=this.$.oa.xa;gb=ra.b.call(null,gb,this.NUi);const pd=I.L(Ec,this.cell,this.externalSourceIndex,this.Bo);return I.g(Ec,"GetPivotValueFieldSettingsInitial",pd,gb,Hb,ac,null,4)},16),this.Sd)}}Object(c.a)(Ac,"ValueFieldSettingsDialog",Bb.a,[]);const Yc=w.a.$9g;class td extends z.a{constructor(gb,Hb,ac,Ec){super(gb,"PopulateFieldWellContextMenu",1374696078,495005930,
Yc,!0,!1,Yc,Hb,ac,!1,Ec);this.Bo=this.lo=this.cell=null;this.S2d=this.externalSourceIndex=-1;this.WSa=0;this.AAc=-1;this.qL=null;this.i3a=this.kV=this.isOlap=!1}get Hw(){return"PopulateFieldWellContextMenu"}get tB(){return w.a.wJd}executeCommand(gb,Hb,ac,Ec){gb=Hb.command;switch(gb){case -1453503574:Ec=ac.domElement;this.lo=ac.fieldItem;this.S2d=ac.zoneCount;this.WSa=ac.sourceAxis;this.AAc=ac.sourceAxisPos;this.Bo=ac.optionalPivotMenuAnchorParameter;this.qL=ac.versionkey;this.isOlap=ac.isOlap;this.kV=
ac.isPpm;this.i3a="fieldItemsupportsImplicitMeasures"in ac?ac.fieldItemsupportsImplicitMeasures:!1;this.cell=ac.cell;this.externalSourceIndex=ac.externalSourceIndex;O.h(this.$).Fo(!0);Ec=eb.DOMElementExtensions.getBounds(Ec);gb=new Sys.UI.Point(Ec.x,Ec.y+Ec.height);this.$.isChromeRtl&&(gb.x+=Ec.width);"isKeyboardInput"in ac&&ac.isKeyboardInput?this.xp(gb,!1,1):this.xp(gb,!1);break;case 495005930:break;case -1170196828:Wa.a(this.$).zJ(this.lo,this.WSa,this.AAc-1,this.qL,Hb);break;case -889576107:Wa.a(this.$).zJ(this.lo,
this.WSa,this.AAc+2,this.qL,Hb);break;case 2033235475:Wa.a(this.$).zJ(this.lo,this.WSa,this.S2d,this.qL,Hb);break;case 389774337:Wa.a(this.$).zJ(this.lo,this.WSa,0,this.qL,Hb);break;case -96230454:Wa.a(this.$).zJ(this.lo,4,-1,this.qL,Hb);break;case 74086617:Wa.a(this.$).zJ(this.lo,1,-1,this.qL,Hb);break;case 1529312473:Wa.a(this.$).zJ(this.lo,2,-1,this.qL,Hb);break;case 563292088:this.i3a&&d.ULS.sendTraceTag(537167056,0,50,"Move a field into values area as implicit measurement.");Wa.a(this.$).zJ(this.lo,
8,-1,this.qL,Hb);break;case -1092351914:Wa.a(this.$).zJ(this.lo,0,-1,this.qL,Hb);break;case -2141589616:const pd=U.GetServiceTaskFactory.Oa(this.$.da,12,477,Ec.f4()),Bd=U.GetServiceTaskFactory.Oa(this.$.da,498,499,Ec.f4());return D.TaskExtensions.za(D.TaskExtensions.Fd([pd,Bd],this.$.la),()=>{(new Ac(this.cell,this.Bo,this.externalSourceIndex,this.lo.Name,this.$,Hb,pd.result,this.isOlap,this.kV,Bd.result)).initialize()},this.la);default:return Y.a(gb)}return wa.Task.Sa(!0)}wc(gb,Hb,ac){gb=!1;switch(Hb.command){case -1453503574:gb=
!!ac;break;case 495005930:case -1170196828:case -889576107:case 2033235475:case 389774337:case -96230454:case 74086617:case 1529312473:case 563292088:case -1092351914:case -2141589616:gb=!0}return gb}FY(){const gb=this.Va.uq(this.menuId);this.e7i(gb,this.AAc,this.S2d);this.f7i(gb,this.WSa);this.g7i(gb);8===this.WSa&&this.c7i(gb);return gb}e7i(gb,Hb,ac){const Ec=this.Va,pd=Ec.Ec();Hb||Hb!==ac-1?!Hb&&Hb<ac-1?(pd.buttons.push(Ec.pb(64)),pd.buttons.push(Ec.pb(61)),pd.buttons.push(Ec.pb(66)),pd.buttons.push(Ec.pb(63))):
0<Hb&&Hb<ac-1?(pd.buttons.push(Ec.pb(60)),pd.buttons.push(Ec.pb(61)),pd.buttons.push(Ec.pb(62)),pd.buttons.push(Ec.pb(63))):0<Hb&&Hb===ac-1&&(pd.buttons.push(Ec.pb(60)),pd.buttons.push(Ec.pb(65)),pd.buttons.push(Ec.pb(62)),pd.buttons.push(Ec.pb(67))):(pd.buttons.push(Ec.pb(64)),pd.buttons.push(Ec.pb(65)),pd.buttons.push(Ec.pb(66)),pd.buttons.push(Ec.pb(67)));gb.rc.push(pd)}f7i(gb,Hb){const ac=this.Va,Ec=ac.Ec(),pd=1!==Hb&&(!this.isOlap||this.kV||8!==Hb||this.i3a),Bd=2!==Hb&&(!this.isOlap||this.kV||
8!==Hb||this.i3a),de=8!==Hb&&-2!==this.lo.PivotTableIndex&&(!this.isOlap||this.kV||this.i3a);Ec.buttons.push(ac.pb(4===Hb||this.lo.IsSet||-2===this.lo.PivotTableIndex||this.isOlap&&!this.kV&&8===Hb&&!this.i3a?72:68));8===this.Bo.AnchorType||10===this.Bo.AnchorType?(Ec.buttons.push(ac.pb(pd?95:97)),Ec.buttons.push(ac.pb(Bd?96:98))):(Ec.buttons.push(ac.pb(pd?69:73)),Ec.buttons.push(ac.pb(Bd?70:74)));Ec.buttons.push(ac.pb(de?71:75));gb.rc.push(Ec)}g7i(gb){const Hb=this.Va.Ec();Hb.buttons.push(this.Va.pb(76));
gb.rc.push(Hb)}c7i(gb){const Hb=this.Va.Ec();Hb.buttons.push(this.Va.pb(77));gb.rc.push(Hb)}}Object(c.a)(td,"FieldWellContextMenu",z.a,[]);var $d=a(1243);class be extends zc{constructor(gb,Hb,ac,Ec){super(gb,"PopulatePivotContextMenu",2123758504,912277356,Hb,ac,Ec)}get Hw(){return"PopulatePivotContextMenu"}get tB(){return w.a.PRf}executeCommand(gb,Hb,ac){let Ec=!1;const pd=Hb.command;switch(pd){case 37023044:Ec=this.zbd(ac,Hb);break;case 541421805:case -569786022:Ec=this.$kd(gb,Hb)}return Ec?wa.Task.Sa(!0):
Y.a(pd)}wc(gb,Hb,ac){gb=!1;switch(Hb.command){case 37023044:gb=!!ac;break;case 541421805:case -569786022:gb=!0}return gb}$kd(gb,Hb){var ac=8===gb,Ec=this.$,pd=ab.a(Ec),Bd=O.h(Ec).ha.Ra.dc;let de=gb=null;ac&&pd?(gb=pd.chartId,de=pd.Wc):!ac&&Bd&&(gb=Bd.floatingObject.id,de=Bd.floatingObject.Wc);return be.jve(de,260)?(ac={},Ec.ak(ac),ac.FirstColumn=ac.FirstRow=-1,Ec={["rawEvent"]:null,["pivotName"]:null,["cell"]:ac,["requiresConfirmation"]:be.jve(de,64),["dataSourceIndex"]:de.ExternalSourceIndex},Bd?
(pd=Bd.floatingObject,Ec.domElement=Bd.domElement,Ec.objectId=pd.id,Ec.objectVersion=pd.version):pd&&(Ec.domElement=pd.Bl,Ec.objectId=pd.chartId,Ec.objectVersion=pd.IBe),Bd={AnchorType:7},Bd.ChartId=gb,Bd.AnchorValue1=-1,Bd.AnchorValue2=-1,Ec.optionalPivotMenuAnchorParameter=Bd,this.zbd(Ec,Hb)):!1}static jve(gb,Hb){return(gb.Attributes&Hb)===Hb}}Object(c.a)(be,"PivotFilterContextMenu",zc,[]);var ke=a(1316);const Pe=(gb,Hb,ac,Ec,pd,Bd,de,Jb,tc,fd=null)=>{fd=gb.Na(41,fd);fd.activeCell=Hb;fd.operationType=
ac;fd.fieldCaption=Ec;fd.prevFieldCaption=pd;return I.g(gb,"ExecutePivotTableOperation",fd,Bd,de,Jb,tc,0)},Dd=(gb,Hb,ac,Ec,pd,Bd,de,Jb=null)=>{Jb=gb.Na(41,Jb);Jb.activeCell=Hb;Jb.pivotValueFieldSettingsApplyData=ac;return I.g(gb,"ApplyValueFieldSettingsToPivotTable",Jb,Ec,pd,Bd,de,0)};var ge=a(152),ne=a(376),ce=a(284),we=a(28),ve=a(22);const Re=w.a.d$g,rf=Re+".RemoveField",We=Re+".Subtotal",Ye=Re+".ClearFilter",bf=Re+".LayoutSameColumn",Ve=Re+".LayoutNextColumn";class Za extends z.a{constructor(gb,
Hb,ac,Ec){super(gb,"PopulatePivotTableContextMenu",-1475408662,1114549926,Re,!0,!1,"PivotTableContextMenuRootName",Hb,ac,!0,Ec);this.v2d=this.activeCell=this.fc=null;this.bZ=this.refresh=this.expandCollapse=this.Dqd=this.bkc=!1;this.Zab=this.ub=this.Y0a=this.Sz=this.ze=null;this.Aba=!1;this.gUi=pd=>{pd&&!V.a.Wf(pd.Errors)&&this.fc&&(this.fc.Qo=pd.Result,this.iMb());this.showPivotTableContextMenu()};this.fUi=()=>{};this.PXi=()=>{this.Ocb()};this.OXi=()=>{this.Ocb()};this.rOi=()=>{this.Ocb()};this.qOi=
()=>{this.Ocb()};this.fy=()=>{this.K_d();this.Aba=!1};this.Gq=()=>{if(this.Aba){d.ULS.sendTraceTag(537167E3,0,50,"PivotTableContextMenu.OnAfterAllBlocksUpdated: Context menu was closed after changes were made by other users");const pd=this.fc;this.grid.tb.Yo(this.grid.ha.qa.activeCell)!==pd&&(this.Ocb(),this.Nci())}};this.qph=new DOMParser;this.ZEj=!0;this.grid=O.h(gb);this.$mc=!0}get Hw(){return"PopulatePivotTableContextMenu"}get tB(){return w.a.QRf}executeCommand(gb,Hb,ac){Hb=Hb.command;gb=null;
this.grid=O.h(this.$);this.activeCell=B.o(this.grid.ha.qa.activeCell,this.$);if(this.$.isEditMode&&(this.fc=this.grid.tb.Yo(this.grid.ha.qa.activeCell),!this.fc))return d.ULS.sendTraceTag(537167007,0,10,"No PivotTable range found."),D.TaskExtensions.Yaa();this.v2d=this.$.oa.xa;this.Y0a=Object(Ya.a)(db.a,ac.eventArgs);switch(Hb){case 671488277:this.WGj()?this.V_h():(this.Ocb(),this.showPivotTableContextMenu());break;case 1801458190:this.performPivotTableOperation(1801458190,1);break;case -2016405815:this.performPivotTableOperation(-2016405815,
6);break;case 671485366:this.performPivotTableOperation(671485366,7);break;case 772221736:this.performPivotTableOperation(772221736,8);break;case 1600778266:this.performPivotTableOperation(1600778266,2);break;case -556893687:this.performPivotTableOperation(-556893687,3);break;case -1966978671:this.performPivotTableOperation(-1966978671,4);break;case -1951357930:this.performPivotTableOperation(-1951357930,5);break;case -1390365353:this.performPivotTableOperation(-1390365353,9);break;case -1457478532:this.performPivotTableOperation(-1457478532,
10);break;case -771066011:this.Sz.PivotValueFieldSummarizeValueByApplyData.Aggregation=2;this.applyValueFieldSettingsToPivotTable(-771066011,!0);break;case 1746132849:this.Sz.PivotValueFieldSummarizeValueByApplyData.Aggregation=1;this.applyValueFieldSettingsToPivotTable(1746132849,!0);break;case 1475494885:this.Sz.PivotValueFieldSummarizeValueByApplyData.Aggregation=6;this.applyValueFieldSettingsToPivotTable(1475494885);break;case 376946683:this.Sz.PivotValueFieldSummarizeValueByApplyData.Aggregation=
11;this.applyValueFieldSettingsToPivotTable(376946683,!0);break;case 835007294:this.Sz.PivotValueFieldSummarizeValueByApplyData.Aggregation=3;this.applyValueFieldSettingsToPivotTable(835007294,!0);break;case 929115636:this.Sz.PivotValueFieldSummarizeValueByApplyData.Aggregation=4;this.applyValueFieldSettingsToPivotTable(929115636,!0);break;case 1935475057:this.Sz.PivotValueFieldSummarizeValueByApplyData.Aggregation=5;this.applyValueFieldSettingsToPivotTable(1935475057,!0);break;case 588680636:this.Sz.PivotValueFieldSummarizeValueByApplyData.Aggregation=
7;this.applyValueFieldSettingsToPivotTable(588680636);break;case -910892852:this.Sz.PivotValueFieldSummarizeValueByApplyData.Aggregation=8;this.applyValueFieldSettingsToPivotTable(-910892852);break;case -1255320719:this.Sz.PivotValueFieldSummarizeValueByApplyData.Aggregation=0;this.applyValueFieldSettingsToPivotTable(-1255320719,!0);break;case 1668427539:this.Sz.PivotValueFieldSummarizeValueByApplyData.Aggregation=9;this.applyValueFieldSettingsToPivotTable(1668427539);break;case -1751371357:this.Sz.PivotValueFieldSummarizeValueByApplyData.Aggregation=
10;this.applyValueFieldSettingsToPivotTable(-1751371357);break;case -841863025:this.iSa(0,0);this.applyValueFieldSettingsToPivotTable(-841863025);break;case -178796371:this.iSa(7,0);this.applyValueFieldSettingsToPivotTable(-178796371);break;case 786592977:this.iSa(6,0);this.applyValueFieldSettingsToPivotTable(786592977);break;case 767774849:this.iSa(5,0);this.applyValueFieldSettingsToPivotTable(767774849);break;case 282586693:this.iSa(9,0);this.applyValueFieldSettingsToPivotTable(282586693);break;
case -1067664355:this.iSa(10,0);this.applyValueFieldSettingsToPivotTable(-1067664355);break;case -2031744961:ac=Number.parseInvariant(ac.MenuItemId.split(".")[2]);this.iSa(11,ac);this.applyValueFieldSettingsToPivotTable(-2031744961);break;case -1007663920:this.applyPivotSort(1);break;case 234234584:this.applyPivotSort(2);break;case 1194992911:this.$.Yc(-1556797033,y.a.zb,8,null);break;case 1514686611:this.izi();break;case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:ac=
Number.parseInvariant(ac.MenuItemId);this.k5g(ac);break;case 1778578888:ac=Number.parseInvariant(ac.MenuItemId);this.vSg(ac);break;case 2059542618:this.performPivotTableOperation(2059542618,11);break;case 713270357:this.performPivotTableOperation(713270357,12);break;case -1842411134:this.performPivotTableOperation(-1842411134,13);break;case 2054968064:this.performPivotTableOperation(2054968064,14);break;case 74278997:this.performPivotTableOperation(74278997,15);break;case 8572743:this.performPivotTableOperation(8572743,
16);break;case 833996216:this.performPivotTableOperation(833996216,17);break;case 139202061:this.performPivotTableOperation(139202061,18);break;default:gb=Y.a(Hb)}return gb||D.TaskExtensions.Yaa()}wc(gb,Hb){gb=!1;switch(Hb.command){case 671488277:gb=Kb.f(this.grid);break;case 1801458190:case -2016405815:case 671485366:case 772221736:gb=!0;break;case 1600778266:gb=!0;break;case -556893687:gb=!0;break;case -1966978671:gb=!0;break;case -1951357930:gb=!0;break;case -1390365353:case -1457478532:gb=!0;
break;case -249874296:case -771066011:case 1746132849:case 1475494885:case 376946683:case 835007294:case 929115636:case 1935475057:case 588680636:case -910892852:case -1255320719:case 1668427539:case -1751371357:gb=!0;break;case -1128612833:case -841863025:case -178796371:case 767774849:case 786592977:case 282586693:case -1067664355:case -2031744961:gb=!0;break;case -1007663920:case 234234584:case 1194992911:gb=!0;break;case 1514686611:case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:case 1778578888:gb=
!0;break;case 2059542618:case 713270357:case -1842411134:case 2054968064:case 74278997:case 8572743:case 833996216:case 139202061:gb=ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",!1)}return gb}WGj(){if(!this.$.isEditMode||this.fc.Nhc)return!1;let gb=this.i8f(!1);return ba.EwaSettings.isChangeGateEnabled("OfficeVSO:6214209_EnableFullRightClickMenuForExtNativePT")?!this.fc.isOlap||gb:!this.fc.Oic()||gb}Hc(gb,Hb){let ac=!1;switch(Hb){case -249874296:case -1128612833:case 1801458190:case -1951357930:case -1390365353:case -1457478532:case 1600778266:case -556893687:case -1966978671:case 1514686611:case 1778578888:case 2059542618:case 713270357:case -1842411134:case 2054968064:case 74278997:case 8572743:case 833996216:case 139202061:ac=
this.cL();break;case -1007663920:case 234234584:ac=this.rFj()||this.cL();break;case 1194992911:ac=this.sFj()||this.cL();break;case 1217404289:ac=!ke.j(this.ub.LabelOrDateFilterType)||this.cL();break;case -743135194:ac=!ke.m(this.ub.ValueFilterType)&&!ke.l(this.ub.ValueFilterType)||this.cL();break;case 771421327:ac=0===this.ub.LabelOrDateFilterType&&0===this.ub.ValueFilterType&&!this.ub.HasManualFilter||this.cL();break;case 1015867427:ac=!ke.i(this.ub.LabelOrDateFilterType)||this.cL();break;case 1105960559:ac=
!ke.k(this.ub.LabelOrDateFilterType)||this.cL()}return ac||super.Hc(gb,Hb)}Ocb(){this.Zab=this.ub=this.ze=null}fXd(){this.grid.oT(this.Gq);this.$.Ia.ZYa(this.fy)}K_d(){this.grid.QN(this.Gq);this.$.Ia.XJb(this.fy)}iMb(){if(this.fc&&this.fc.Qo){this.ze=this.fc.Qo;this.ub=this.fc.ccc();if(this.Y8f()){const gb=this.fc.SK[4===this.ze.CellType?this.fc.C7c-1:this.ze.CurrentFieldIndex-1];gb&&(this.Zab=-2===gb.Index?this.fc.iKe:gb.Caption)}this.Bgi();this.ub&&8===this.ze.CellArea&&(this.Sz.PivotValueFieldSummarizeValueByApplyData.Aggregation=
this.ub.DataFieldAggregationType,this.Sz.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=this.ub.DataFieldFormatType,this.Sz.PivotValueFieldShowValueAsApplyData.SelectedBaseField=this.ub.BaseFieldIndex,this.Sz.PivotValueFieldTitle=this.ub.Caption)}}i8f(gb){return this.fc?this.fc.isOlap&&!this.fc.oNa(!gb):!1}zFj(){const gb=ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1);return 1!==this.ub.MeasureType&&(!this.fc.Elf||gb&&2===this.ub.MeasureType)}FY(){const gb=
this.Va.uq(this.menuId),Hb=this.Va.Ec(),ac=O.h(this.$).Pb(null);if(this.fc)this.ze&&this.fc.Qo&&this.ze!==this.fc.Qo&&d.ULS.shipAssertTag(537167006,0,!1,"CurrentCellInfo is out of sync with cell info from PivotTable Range"),this.ub&&this.ub!==this.fc.ccc()&&d.ULS.shipAssertTag(537167005,0,!1,"CurrentField is out of sync with field from PivotTable Range");else return gb;this.LLh(gb);if(this.$.isEditMode){this.refresh&&this.bNh(gb);if(this.ze&&this.ub){var Ec=this.Va.Ec();this.rNh(Ec);this.$Lh(Ec);
gb.rc.push(Ec)}this.bZ&&Hb.buttons.push(this.Va.pb(99));this.ze&&this.ub&&this.zMh(gb);if(this.expandCollapse){Ec=this.Va.$v("ContextMenu.PivotExpandCollapse",null,Z.a.instance.ga(1166),589118293);const pd=this.Va.Ec();pd.buttons.push(this.Va.pb(243));pd.buttons.push(this.Va.pb(244));pd.buttons.push(this.Va.pb(245));pd.buttons.push(this.Va.pb(246));Ec.menu.rc.push(pd);Ec&&0<pd.buttons.length&&Hb.buttons.push(Ec)}this.ze&&(Ec=this.Va.Ec(),ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",
!1)&&this.KMh(Ec),this.cNh(Ec),0<Ec.buttons.length&&gb.rc.push(Ec));this.ze&&this.ub&&8===this.ze.CellArea&&8!==this.ze.CellType&&(Ec=this.Va.Ec(),this.zFj()&&this.tNh(Ec),3!==this.ze.CellType&&this.oNh(Ec),gb.rc.push(Ec));!this.fc.Oic()&&""!==(null===ac||void 0===ac?void 0:ac.text)&&this.ze&&0===this.ze.CellType&&ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)&&this.nNh(gb);this.qsi()?Hb.buttons.push(this.Va.pb(257)):Hb.buttons.push(this.Va.pb(258));this.Dqd?
Hb.buttons.push(this.Va.pb(59)):Hb.buttons.push(this.Va.pb(58))}gb.rc.push(Hb);return gb}ySa(){return this.ub&&this.ub.Caption?20<this.ub.Caption.length:!1}vKa(gb){return this.ub&&this.ub.Caption?gb?this.ub.Caption.substring(0,20)+"...":this.ub.Caption:""}pva(gb){return ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5548525_FixLoggingColumnNameInButtonId")?ve.a.hashCode(gb).toString():gb}rNh(gb){if(this.ze&&this.ub&&4!==this.ze.CellArea){var Hb=this.oja(this.dH("PivotTableContextMenu.Sort",this.pva(this.ub.Caption)),
-1777747317,0,0!==this.ub.SortInfo,Z.a.instance.ga(226)),ac=this.Va.Ec();ac.buttons.push(this.Rd("PivotTableContextMenu.SortAscending",-1007663920,0,1===this.ub.SortInfo,Z.a.instance.ga(227)));ac.buttons.push(this.Rd("PivotTableContextMenu.SortDescending",234234584,0,2===this.ub.SortInfo,Z.a.instance.ga(228)));1!==this.ze.CellArea&&2!==this.ze.CellArea||ac.buttons.push(this.Rd("PivotTableContextMenu.SortByValue",1194992911,0,3===this.ub.SortInfo||4===this.ub.SortInfo,Z.a.instance.ga(153)));Hb.menu.rc.push(ac);
Hb&&0<ac.buttons.length&&gb.buttons.push(Hb)}}$Lh(gb){if(this.ze&&this.ub&&(1===this.ze.CellArea||2===this.ze.CellArea)){var Hb=this.VGj();const Bd=this.oja(this.dH("PivotTableContextMenu.Filter",this.pva(this.ub.Caption)),-1777747317,0,Hb,Z.a.instance.ga(650)),de=this.Va.Ec();var ac="",Ec=this.ySa(),pd=String.format(Z.a.instance.ob(156),this.vKa(Ec));Ec&&(ac=String.format(Z.a.instance.ob(156),this.ub.Caption));Hb=this.pva(this.ub.Caption)+"."+(Hb?"enabled":"disabled");ac=this.Rd(this.dH(Ye,Hb),771421327,
0,!1,pd,"0",ac,8,Na.a.V2a);Hb=this.pva(this.ub.Caption)+"."+this.ub.LabelOrDateFilterType.toString();this.ub.IsDateField?(pd=this.oja(this.dH("PivotTableContextMenu.DateFilter",Hb),-1777747317,0,0!==this.ub.LabelOrDateFilterType,Z.a.instance.ga(96)),this.OLh(pd.menu)):(pd=this.oja(this.dH("PivotTableContextMenu.LabelFilter",Hb),-1777747317,0,0!==this.ub.LabelOrDateFilterType,Z.a.instance.ga(648)),this.yMh(pd.menu));Hb=this.pva(this.ub.Caption)+"."+this.ub.ValueFilterType.toString();Hb=this.oja(this.dH("PivotTableContextMenu.ValueFilter",
Hb),-1777747317,0,0!==this.ub.ValueFilterType,Z.a.instance.ga(649));this.FNh(Hb.menu);Ec=this.Va.Ec();Ec.buttons.push(this.Rd("PivotTableContextMenu.ManualFilter",1514686611,0,this.ub.HasManualFilter,Z.a.instance.ga(93)));de.buttons.push(ac);de.buttons.push(pd);de.buttons.push(Hb);Bd.menu.rc.push(de);Bd.menu.rc.push(Ec);Bd&&0<de.buttons.length&&gb.buttons.push(Bd)}}OLh(gb){gb.rc.push(this.xcc(!0,!1));gb.rc.push(this.gTh());gb.rc.push(this.fTh());gb.rc.push(this.YUh());gb.rc.push(this.aVh());gb.rc.push(this.ZUh());
gb.rc.push(this.$Uh());gb.rc.push(this.bVh());gb.rc.push(this.cVh());gb.rc.push(this.USh())}DLh(gb){gb.rc.push(this.xcc(!0,!0));gb.rc.push(this.U0h());gb.rc.push(this.bZh())}yMh(gb){gb.rc.push(this.xcc(!0,!1));gb.rc.push(this.G2e(!0));gb.rc.push(this.wPh());gb.rc.push(this.eSh());gb.rc.push(this.E1e(!0));gb.rc.push(this.I0e(!0))}FNh(gb){gb.rc.push(this.xcc(!1,!1));gb.rc.push(this.G2e(!1));gb.rc.push(this.E1e(!1));gb.rc.push(this.I0e(!1));gb.rc.push(this.x5h())}x5h(){const gb=this.Va.Ec();gb.buttons.push(this.Rd("PivotTableContextMenu.Top10",
-1611233597,0,ke.l(this.ub.ValueFilterType),Z.a.instance.ga(104)));return gb}eSh(){const gb=this.Va.Ec();this.ub&&(gb.buttons.push(this.Rd("PivotTableContextMenu.Contains",786260386,0,10===this.ub.LabelOrDateFilterType,Z.a.instance.ga(651),"10")),gb.buttons.push(this.Rd("PivotTableContextMenu.DoesNotContain",786260386,0,11===this.ub.LabelOrDateFilterType,Z.a.instance.ga(652),"11")));return gb}wPh(){const gb=this.Va.Ec();this.ub&&(gb.buttons.push(this.Rd("PivotTableContextMenu.BeginsWith",786260386,
0,6===this.ub.LabelOrDateFilterType,Z.a.instance.ga(653),"6")),gb.buttons.push(this.Rd("PivotTableContextMenu.DoesNotBeginWith",786260386,0,7===this.ub.LabelOrDateFilterType,Z.a.instance.ga(654),"7")),gb.buttons.push(this.Rd("PivotTableContextMenu.EndsWith",786260386,0,8===this.ub.LabelOrDateFilterType,Z.a.instance.ga(655),"8")),gb.buttons.push(this.Rd("PivotTableContextMenu.DoesNotEndWith",786260386,0,9===this.ub.LabelOrDateFilterType,Z.a.instance.ga(656),"9")));return gb}G2e(gb){const Hb=this.Va.Ec();
if(this.ub){const ac=gb?ke.c:ke.f;Hb.buttons.push(this.Rd(this.dH("PivotTableContextMenu.Equals",ac),786260386,0,gb?4===this.ub.LabelOrDateFilterType:18===this.ub.ValueFilterType,Z.a.instance.ga(99),gb?"4":"18"));Hb.buttons.push(this.Rd(this.dH("PivotTableContextMenu.DoesNotEqual",ac),786260386,0,gb?5===this.ub.LabelOrDateFilterType:19===this.ub.ValueFilterType,Z.a.instance.ga(100),gb?"5":"19"))}return Hb}E1e(gb){const Hb=this.Va.Ec();if(this.ub){const ac=gb?ke.c:ke.f;Hb.buttons.push(this.Rd(this.dH("PivotTableContextMenu.GreaterThan",
ac),786260386,0,gb?12===this.ub.LabelOrDateFilterType:20===this.ub.ValueFilterType,Z.a.instance.ga(101),gb?"12":"20"));Hb.buttons.push(this.Rd(this.dH("PivotTableContextMenu.GreaterThanOrEqualTo",ac),786260386,0,gb?13===this.ub.LabelOrDateFilterType:21===this.ub.ValueFilterType,Z.a.instance.ga(657),gb?"13":"21"));Hb.buttons.push(this.Rd(this.dH("PivotTableContextMenu.LessThan",ac),786260386,0,gb?14===this.ub.LabelOrDateFilterType:22===this.ub.ValueFilterType,Z.a.instance.ga(102),gb?"14":"22"));Hb.buttons.push(this.Rd(this.dH("PivotTableContextMenu.LessThanOrEqualTo",
ac),786260386,0,gb?15===this.ub.LabelOrDateFilterType:23===this.ub.ValueFilterType,Z.a.instance.ga(658),gb?"15":"23"))}return Hb}I0e(gb){const Hb=this.Va.Ec();if(this.ub){const ac=gb?ke.c:ke.f;Hb.buttons.push(this.Rd(this.dH("PivotTableContextMenu.Between",ac),786260386,0,gb?16===this.ub.LabelOrDateFilterType:24===this.ub.ValueFilterType,Z.a.instance.ga(103),gb?"16":"24"));Hb.buttons.push(this.Rd(this.dH("PivotTableContextMenu.NotBetween",ac),786260386,0,gb?17===this.ub.LabelOrDateFilterType:25===
this.ub.ValueFilterType,Z.a.instance.ga(659),gb?"17":"25"))}return Hb}xcc(gb,Hb){const ac=this.Va.Ec();if(this.ub){var Ec=Z.a.instance.ga(97);const Bd=gb?this.ub.LabelOrDateFilterType.toString():this.ub.ValueFilterType.toString();var pd=["PivotTableContextMenu.ClearFilter",this.pva(this.ub.Caption),Bd];gb=gb?this.ub.IsDateField?Hb?1015867427:1105960559:1217404289:-743135194;pd.push(gb.toString());pd=pd.join(".");Ec=this.Rd(pd,gb,0,!1,Ec,Bd,Ec,8,Na.a.V2a);ac.buttons.push(Ec)}return ac}gTh(){const gb=
this.Va.Ec();this.ub&&gb.buttons.push(this.Rd(this.dH("PivotTableContextMenu.Equals",ke.d),786260386,0,26===this.ub.LabelOrDateFilterType,Z.a.instance.ga(99),"26"));return gb}fTh(){const gb=this.Va.Ec();this.ub&&(gb.buttons.push(this.Rd("PivotTableContextMenu.Before",786260386,0,27===this.ub.LabelOrDateFilterType,Z.a.instance.ga(111),"27")),gb.buttons.push(this.Rd("PivotTableContextMenu.After",786260386,0,28===this.ub.LabelOrDateFilterType,Z.a.instance.ga(112),"28")),gb.buttons.push(this.Rd("PivotTableContextMenu.Between",
786260386,0,29===this.ub.LabelOrDateFilterType,Z.a.instance.ga(103),"29")));return gb}YUh(){const gb=this.Va.Ec();this.ub&&(gb.buttons.push(this.Rd("PivotTableContextMenu.Tomorrow",1778578888,0,30===this.ub.LabelOrDateFilterType,Z.a.instance.ga(109),"30")),gb.buttons.push(this.Rd("PivotTableContextMenu.Today",1778578888,0,31===this.ub.LabelOrDateFilterType,Z.a.instance.ga(108),"31")),gb.buttons.push(this.Rd("PivotTableContextMenu.Yesterday",1778578888,0,32===this.ub.LabelOrDateFilterType,Z.a.instance.ga(110),
"32")));return gb}aVh(){const gb=this.Va.Ec();this.ub&&(gb.buttons.push(this.Rd("PivotTableContextMenu.NextWeek",1778578888,0,33===this.ub.LabelOrDateFilterType,Z.a.instance.ga(114),"33")),gb.buttons.push(this.Rd("PivotTableContextMenu.ThisWeek",1778578888,0,34===this.ub.LabelOrDateFilterType,Z.a.instance.ga(113),"34")),gb.buttons.push(this.Rd("PivotTableContextMenu.LastWeek",1778578888,0,35===this.ub.LabelOrDateFilterType,Z.a.instance.ga(115),"35")));return gb}ZUh(){const gb=this.Va.Ec();this.ub&&
(gb.buttons.push(this.Rd("PivotTableContextMenu.NextMonth",1778578888,0,36===this.ub.LabelOrDateFilterType,Z.a.instance.ga(116),"36")),gb.buttons.push(this.Rd("PivotTableContextMenu.ThisMonth",1778578888,0,37===this.ub.LabelOrDateFilterType,Z.a.instance.ga(117),"37")),gb.buttons.push(this.Rd("PivotTableContextMenu.LastMonth",1778578888,0,38===this.ub.LabelOrDateFilterType,Z.a.instance.ga(118),"38")));return gb}$Uh(){const gb=this.Va.Ec();this.ub&&(gb.buttons.push(this.Rd("PivotTableContextMenu.NextQuarter",
1778578888,0,39===this.ub.LabelOrDateFilterType,Z.a.instance.ga(119),"39")),gb.buttons.push(this.Rd("PivotTableContextMenu.ThisQuarter",1778578888,0,40===this.ub.LabelOrDateFilterType,Z.a.instance.ga(120),"40")),gb.buttons.push(this.Rd("PivotTableContextMenu.LastQuarter",1778578888,0,41===this.ub.LabelOrDateFilterType,Z.a.instance.ga(121),"41")));return gb}bVh(){const gb=this.Va.Ec();this.ub&&(gb.buttons.push(this.Rd("PivotTableContextMenu.NextYear",1778578888,0,42===this.ub.LabelOrDateFilterType,
Z.a.instance.ga(122),"42")),gb.buttons.push(this.Rd("PivotTableContextMenu.ThisYear",1778578888,0,43===this.ub.LabelOrDateFilterType,Z.a.instance.ga(123),"43")),gb.buttons.push(this.Rd("PivotTableContextMenu.LastYear",1778578888,0,44===this.ub.LabelOrDateFilterType,Z.a.instance.ga(124),"44")));return gb}cVh(){const gb=this.Va.Ec();if(this.ub){gb.buttons.push(this.Rd("PivotTableContextMenu.YearToDate",1778578888,0,45===this.ub.LabelOrDateFilterType,Z.a.instance.ga(125),"45"));const Hb=this.oja("PivotTableContextMenu.AllDatesInThePeriod",
1778578888,0,ke.i(this.ub.LabelOrDateFilterType),Z.a.instance.ga(126));this.DLh(Hb.menu);gb.buttons.push(Hb)}return gb}USh(){const gb=this.Va.Ec();this.ub&&gb.buttons.push(this.Rd("PivotTableContextMenu.CustomFilter",786260386,0,this.RGj(this.ub.LabelOrDateFilterType),Z.a.instance.ga(107),"26"));return gb}U0h(){const gb=this.Va.Ec();this.ub&&(gb.buttons.push(this.Rd("PivotTableContextMenu.Quarter1",1778578888,0,46===this.ub.LabelOrDateFilterType,Z.a.instance.ga(127),"46")),gb.buttons.push(this.Rd("PivotTableContextMenu.Quarter2",
1778578888,0,47===this.ub.LabelOrDateFilterType,Z.a.instance.ga(128),"47")),gb.buttons.push(this.Rd("PivotTableContextMenu.Quarter3",1778578888,0,48===this.ub.LabelOrDateFilterType,Z.a.instance.ga(129),"48")),gb.buttons.push(this.Rd("PivotTableContextMenu.Quarter4",1778578888,0,49===this.ub.LabelOrDateFilterType,Z.a.instance.ga(130),"49")));return gb}bZh(){const gb=this.Va.Ec();this.ub&&(gb.buttons.push(this.Rd("PivotTableContextMenu.January",1778578888,0,50===this.ub.LabelOrDateFilterType,Z.a.instance.ga(131),
"50")),gb.buttons.push(this.Rd("PivotTableContextMenu.February",1778578888,0,51===this.ub.LabelOrDateFilterType,Z.a.instance.ga(132),"51")),gb.buttons.push(this.Rd("PivotTableContextMenu.March",1778578888,0,52===this.ub.LabelOrDateFilterType,Z.a.instance.ga(133),"52")),gb.buttons.push(this.Rd("PivotTableContextMenu.April",1778578888,0,53===this.ub.LabelOrDateFilterType,Z.a.instance.ga(134),"53")),gb.buttons.push(this.Rd("PivotTableContextMenu.May",1778578888,0,54===this.ub.LabelOrDateFilterType,Z.a.instance.ga(135),
"54")),gb.buttons.push(this.Rd("PivotTableContextMenu.June",1778578888,0,55===this.ub.LabelOrDateFilterType,Z.a.instance.ga(136),"55")),gb.buttons.push(this.Rd("PivotTableContextMenu.July",1778578888,0,56===this.ub.LabelOrDateFilterType,Z.a.instance.ga(137),"56")),gb.buttons.push(this.Rd("PivotTableContextMenu.August",1778578888,0,57===this.ub.LabelOrDateFilterType,Z.a.instance.ga(138),"57")),gb.buttons.push(this.Rd("PivotTableContextMenu.September",1778578888,0,58===this.ub.LabelOrDateFilterType,
Z.a.instance.ga(139),"58")),gb.buttons.push(this.Rd("PivotTableContextMenu.October",1778578888,0,59===this.ub.LabelOrDateFilterType,Z.a.instance.ga(140),"59")),gb.buttons.push(this.Rd("PivotTableContextMenu.November",1778578888,0,60===this.ub.LabelOrDateFilterType,Z.a.instance.ga(141),"60")),gb.buttons.push(this.Rd("PivotTableContextMenu.December",1778578888,0,61===this.ub.LabelOrDateFilterType,Z.a.instance.ga(142),"61")));return gb}zMh(gb){const Hb=this.Va.Ec();if(this.Y8f()){var ac=this.fc.SK[4===
this.ze.CellType?this.fc.C7c-1:this.ze.CurrentFieldIndex-1];if(ac&&this.Zab){var Ec=this.Va.$v("ContextMenu.PivotTableLayout",null,Z.a.instance.ga(646),-1777747317);var pd=this.Va.Ec();const Bd=String.format(Z.a.instance.ob(169),this.Zab),de=String.format(Z.a.instance.ob(170),this.Zab);pd.buttons.push(this.Rd(Ve,-1457478532,0,!ac.IsCompactLayout,Bd));pd.buttons.push(this.Rd(bf,-1390365353,0,ac.IsCompactLayout,de));Ec.menu.rc.push(pd);Ec&&Hb.buttons.push(Ec)}}if(1===this.ze.CellArea||2===this.ze.CellArea)this.ub.Caption&&
(ac="",pd=this.ySa(),Ec=String.format(Z.a.instance.ob(159),this.vKa(pd)),pd&&(ac=String.format(Z.a.instance.ob(159),this.ub.Caption)),1===this.ze.CellArea?(ac=this.oja("ContextMenu.PivotTableSubtotal",1801458190,0,this.ub.ShowSubtotal,Ec),Ec=this.Va.Ec(),Ec.buttons.push(this.Va.pb(259)),Ec.buttons.push(this.Rd("ContextMenu.PivotTableSubtotalOnTop",671485366,638,this.ub.ShowSubtotal&&this.ub.ShowSubtotalAtTop)),Ec.buttons.push(this.Rd("ContextMenu.PivotTableSubtotalOnBottom",772221736,639,this.ub.ShowSubtotal&&
!this.ub.ShowSubtotalAtTop)),ac.menu.rc.push(Ec),ac&&0<Ec.buttons.length&&Hb.buttons.push(ac)):(pd=pd?this.dH(We,this.pva(Ec)):We,Hb.buttons.push(this.Rd(pd,1801458190,0,this.ub.ShowSubtotal,Ec,null,ac)))),Hb.buttons.push(this.Rd("ContextMenu.RepeatItemLabels",-556893687,641,this.ub.RepeatItemLabels));1===this.ze.CellArea&&Hb.buttons.push(this.Rd("ContextMenu.PivotBlankLineAfterEachItem",1600778266,640,this.ub.ShowBlankLineAfterEachItem));gb.rc.push(Hb)}nNh(gb){const Hb=this.Va.Ec();Hb.buttons.push(this.Va.pb(247));
gb.rc.push(Hb)}KMh(gb){if(this.$.isEditMode&&this.grid){var Hb=this.grid.ha.qa.activeRange;if(Hb.top===Hb.bottom&&Hb.left===Hb.right&&0!==this.ze.MoveItemsMenuState){Hb=this.oja("PivotTableContextMenu.Move",-1777747317,0,!1,Z.a.instance.ga(73));var ac=this.Va.Ec();this.Uua(ac,"PivotTableContextMenu.MoveToBeginning",2059542618,String.format(Z.a.instance.ob(162),this.ze.MoveItemName),0===(this.ze.MoveItemsMenuState&1));this.Uua(ac,"PivotTableContextMenu.MoveUp",713270357,String.format(Z.a.instance.ob(163),
this.ze.MoveItemName),0===(this.ze.MoveItemsMenuState&2));this.Uua(ac,"PivotTableContextMenu.MoveDown",-1842411134,String.format(Z.a.instance.ob(160),this.ze.MoveItemName),0===(this.ze.MoveItemsMenuState&4));this.Uua(ac,"PivotTableContextMenu.MoveToEnd",2054968064,String.format(Z.a.instance.ob(161),this.ze.MoveItemName),0===(this.ze.MoveItemsMenuState&8));Hb.menu.rc.push(ac);ac=this.Va.Ec();this.Uua(ac,"PivotTableContextMenu.MoveDataItemTop",74278997,String.format(Z.a.instance.ob(167),this.vKa(this.ySa())),
0===(this.ze.MoveItemsMenuState&16));this.Uua(ac,"PivotTableContextMenu.MoveDataItemUp",8572743,String.format(Z.a.instance.ob(164),this.vKa(this.ySa())),0===(this.ze.MoveItemsMenuState&32));this.Uua(ac,"PivotTableContextMenu.MoveDataItemDown",833996216,String.format(Z.a.instance.ob(165),this.vKa(this.ySa())),0===(this.ze.MoveItemsMenuState&64));this.Uua(ac,"PivotTableContextMenu.MoveDataItemBottom",139202061,String.format(Z.a.instance.ob(166),this.vKa(this.ySa())),0===(this.ze.MoveItemsMenuState&
128));Hb.menu.rc.push(ac);gb.buttons.push(Hb)}}}cNh(gb){var Hb="";let ac="";var Ec=!1;3===this.ze.CellType?Hb=Z.a.instance.ga(643):8===this.ze.CellType?this.fc&&(Hb=String.format(Z.a.instance.ob(168),this.fc.iKe)):this.ub&&((Ec=this.ySa())&&(ac=String.format(Z.a.instance.ob(168),this.ub.Caption)),Hb=String.format(Z.a.instance.ob(168),this.vKa(Ec)));Hb&&(Ec=Ec?this.dH(rf,this.pva(Hb)):rf,Hb=this.Rd(Ec,-1951357930,0,!1,Hb,null,ac,8,Na.a.Xad),gb.buttons.push(Hb))}LLh(gb){const Hb=this.Va.Ec();Hb.buttons.push(this.Va.pb(43));
this.ub&&this.ze&&this.$.isEditMode&&(0===this.ze.CellType||4===this.ze.CellType)&&Hb.buttons.push(this.Va.pb(136));if(ba.EwaSettings.isChangeGateEnabled("OfficeVSO:7094993_ShowImageDetailsInPivotTableContextMenu")&&ba.EwaSettings.ra(102)&&this.grid&&this.grid.ha){const ac=this.grid.ha.qa.selectedRanges;ac&&1===ac.length&&(ac[0].isSingle||this.grid.tb.eNa(ac[0]))&&this.grid.tb.hxa(ac[0])&&!this.grid.tb.iAb(ac[0])&&Hb.buttons.push(this.Va.pb(this.grid.tb.chf(ac[0])?217:216))}gb.rc.push(Hb)}bNh(gb){const Hb=
this.Va.Ec();Hb.buttons.push(this.Va.pb(100));gb.rc.push(Hb)}tNh(gb){const Hb=2===this.ub.MeasureType&&!this.ub.IsNumeric,ac=this.Va.$v("ContextMenu.SummarizeValuesBy",null,Z.a.instance.ga(644),-249874296),Ec=this.Va.Ec();Ec.buttons.push(this.Rd("ContextMenu.SummarizeValuesBySum",-1255320719,1105,0===this.ub.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,Hb));Ec.buttons.push(this.Rd("ContextMenu.SummarizeValuesByCount",1746132849,1106,1===this.ub.DataFieldAggregationType));Ec.buttons.push(this.Rd("ContextMenu.SummarizeValuesByAverage",
-771066011,1107,2===this.ub.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,Hb));Ec.buttons.push(this.Rd("ContextMenu.SummarizeValuesByMax",835007294,1108,3===this.ub.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,Hb));Ec.buttons.push(this.Rd("ContextMenu.SummarizeValuesByMin",929115636,1109,4===this.ub.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,Hb));Ec.buttons.push(this.Rd("ContextMenu.SummarizeValuesByProduct",1935475057,1110,5===this.ub.DataFieldAggregationType,
void 0,void 0,void 0,void 0,void 0,this.i8f(!0)||Hb));2!==this.ub.MeasureType&&(Ec.buttons.push(this.Rd("ContextMenu.SummarizeValuesByCountNumbers",1475494885,1111,6===this.ub.DataFieldAggregationType)),Ec.buttons.push(this.Rd("ContextMenu.SummarizeValuesByStdDeviation",588680636,1112,7===this.ub.DataFieldAggregationType)),Ec.buttons.push(this.Rd("ContextMenu.SummarizeValuesByStdDeviationPercent",-910892852,1113,8===this.ub.DataFieldAggregationType)),Ec.buttons.push(this.Rd("ContextMenu.SummarizeValuesByVariant",
1668427539,1114,9===this.ub.DataFieldAggregationType)),Ec.buttons.push(this.Rd("ContextMenu.SummarizeValuesByVariantPercent",-1751371357,1115,10===this.ub.DataFieldAggregationType)));this.fc&&this.fc.Oic()&&Ec.buttons.push(this.Rd("ContextMenu.SummarizeValuesByDistinctCountPPM",376946683,1116,11===this.ub.DataFieldAggregationType));ac.menu.rc.push(Ec);gb.buttons.push(ac)}oNh(gb){const Hb=this.Va.$v("ContextMenu.ShowValuesAs",null,Z.a.instance.ga(645),-1128612833),ac=this.Va.Ec();ac.buttons.push(this.Rd("ContextMenu.ShowValuesAsNoCalculation",
-841863025,1122,0===this.ub.DataFieldFormatType));ac.buttons.push(this.Rd("ContextMenu.ShowValuesAsPercentOfGrandTotal",-178796371,1129,7===this.ub.DataFieldFormatType));ac.buttons.push(this.Rd("ContextMenu.ShowValuesAsPercentOfColumnTotal",786592977,1128,6===this.ub.DataFieldFormatType));ac.buttons.push(this.Rd("ContextMenu.ShowValuesAsPercentOfRowTotal",767774849,1127,5===this.ub.DataFieldFormatType));ac.buttons.push(this.Rd("ContextMenu.ShowValuesAsPercentOfParentRowTotal",282586693,1132,9===this.ub.DataFieldFormatType));
ac.buttons.push(this.Rd("ContextMenu.ShowValuesAsParentColumnTotal",-1067664355,1133,10===this.ub.DataFieldFormatType));if(this.fc&&this.fc.SK&&0<this.fc.SK.length||this.fc.z$&&0<this.fc.z$.length){const Ec=this.oja("ContextMenu.ShowValuesAsPercentOfParentTotal",-1128612833,1134,11===this.ub.DataFieldFormatType),pd=this.Va.Ec(),Bd=this.sNh();for(let de=0;de<Bd.length;de++){const Jb=Bd[de];pd.buttons.push(this.Rd("ContextMenu.ShowValuesAsPercentOfParentTotal."+Jb.Caption,-2031744961,1134,11===this.ub.DataFieldFormatType&&
this.ub.BaseFieldIndex===Jb.Index,Jb.Caption,"ContextMenu.ShowValuesAsPercentOfParentTotal."+Jb.Index))}Ec.menu.rc.push(pd);ac.buttons.push(Ec)}Hb.menu.rc.push(ac);gb.buttons.push(Hb)}showPivotTableContextMenu(){this.Dqd=!0;this.expandCollapse=this.bZ=this.refresh=!1;var gb=this.$,Hb=O.h(gb),ac=jb.a(gb).MKa();if(ac){var Ec=Wa.a(gb);if(null===Ec||void 0===Ec?0:Ec.KTd)this.Dqd=Sa.f(gb.dg);Ec=gb.$b;this.bZ=ac.supportsBIExplore&&!!za.a(gb)&&Ec.t2(32768);Ec.allowInteractivity&&(gb=Hb.Pb(null),(null===
gb||void 0===gb?0:gb.cell)&&(gb.cell.V0c||gb.cell.V8f)&&(this.expandCollapse=!0),Ec.allowManualDataRefresh&&(this.refresh=!0))}gb=null;ac=1;this.Y0a&&1!==this.Y0a.vb?(gb=new Sys.UI.Point(this.Y0a.clientPoint.x,this.Y0a.clientPoint.y),ac=this.Y0a.vb):(Hb=Kb.e(Hb,this.$))&&(gb=new Sys.UI.Point(Hb.x+(this.$.isChromeRtl?0:Hb.width),Hb.y+Hb.height));y.a.zb=ac;this.bkc=3===ac;this.xp(gb,!0,ac);this.Aba=!0;this.fXd()}Nci(){const gb=new M.a(1114549926,0,this.$.xc,19,null);this.$.Ia.Hb(gb)}V_h(){if(this.fc&&
this.fc.Qo){var gb=this.fc.Qo.CurrentCol;if(this.fc.Qo.CurrentRow===this.activeCell.FirstRow&&gb===this.activeCell.FirstColumn){this.iMb();this.showPivotTableContextMenu();return}}gb=new H.a(228,0,(Hb,ac,Ec)=>ce.l(this.$.oa.xa,this.activeCell,ra.b(Hb,this.gUi),ra.a(ac,this.fUi),Ec,null),16);this.$.userOperationManager.Jc(gb,null)}qsi(){if(Ba.a.Ad(this.$)){var gb=this.$.da.Aa(441);if(gb)return gb.Sr}else if(gb=this.$.da.Aa(346))return gb.Sr;return!1}dH(gb,Hb){return gb+"."+Hb}performPivotTableOperation(gb,
Hb){const ac=we.a.Ya.Ub;if(!this.fc||!this.ub&&this.ze&&3!==this.ze.CellType)this.kj();else{var Ec=this.fc.isOlap;jb.a(this.$).Cx(Ec,pd=>{pd&&this.$.Jc(gb,(Bd,de,Jb)=>Pe(this.v2d,this.activeCell,Hb,this.ub?this.ub.Caption:null,this.Zab,ra.b(Bd,this.PXi),ra.a(de,this.OXi),Jb,null,this.$.oa.xa.Wb()),ac,0,4,229)})}}applyValueFieldSettingsToPivotTable(gb,Hb=!1){const ac=we.a.Ya.Ub;this.fc&&this.ub?(Hb&&2===this.ub.MeasureType&&d.ULS.sendTraceTag(537167002,0,50,"change aggregation type for an implicit measure from right click context menu."),
Hb=this.fc.isOlap,jb.a(this.$).Cx(Hb,Ec=>{Ec&&this.$.Jc(gb,(pd,Bd,de)=>Dd(this.v2d,this.activeCell,this.Sz,ra.b(pd,this.rOi),ra.a(Bd,this.qOi),de,null,this.$.oa.xa.Wb()),ac,0,4,231)})):this.kj()}Rd(gb,Hb,ac,Ec,pd=null,Bd=null,de=null,Jb=8,tc=null,fd=!1){Ec&&(gb+=".Checked");fd&&(gb+=".Disabled");this.Va.spd(gb)&&this.Va.jLd(gb);ac=pd||Z.a.instance.ga(ac);gb=this.Va.$Ha(gb,ac,Hb,null,"None",Bd,fd,null);gb.dyc(null);de&&gb.TR(de);Ec?gb.VR("Image16by16",3,Na.a.saa):tc?gb.VR("Image16by16",Jb,tc):gb.Y3b();
return gb}oja(gb,Hb,ac,Ec,pd=null){ac=pd||Z.a.instance.ga(ac);this.Va.spd(gb)?this.Va.jLd(gb):this.Va.jLd(gb+".Checked");Ec&&(gb+=".Checked");this.ZEj&&(ac=this.qph.parseFromString(ac,"text/html").body.innerText);gb=this.Va.F5c(gb,null,ac,Hb,3,Na.a.saa);gb.Ndf=Ec;!Ec&&ba.EwaSettings.isChangeGateEnabled("OfficeVSO:4877664_HidePivotTableContextMenuFlyoutCheckmark")&&gb.Y3b();return gb}Bgi(){this.Sz=Object(f.a)(new ec,{PivotValueFieldSummarizeValueByApplyData:Object(f.a)(new Hd,{Aggregation:-1}),PivotValueFieldShowValueAsApplyData:Object(f.a)(new vd,
{SelectedDataFormat:-1,SelectedBaseField:-1,SelectedBaseItem:-1}),PivotValueFieldTitle:null})}iSa(gb,Hb){this.Sz.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=gb;this.Sz.PivotValueFieldShowValueAsApplyData.SelectedBaseField=Hb;this.Sz.PivotValueFieldShowValueAsApplyData.SelectedBaseItem=-1}sNh(){const gb=[];if(this.fc&&this.fc.z$&&0<this.fc.z$.length)for(const Hb of this.fc.z$)Hb&&gb.push(Hb);if(this.fc&&this.fc.SK&&0<this.fc.SK.length)for(const Hb of this.fc.SK)Hb&&gb.push(Hb);gb.sort((Hb,
ac)=>Hb.Index-ac.Index);return gb}Y8f(){if(!this.ze||!this.fc||!this.fc.SK)return!1;const gb=1===this.ze.CellArea||4===this.ze.CellType&&this.ze.IsRowAxis,Hb=4===this.ze.CellType?0<this.fc.C7c:0<this.ze.CurrentFieldIndex;return 1<this.fc.SK.length&&gb&&Hb}xKa(gb){const Hb=[];3===gb?this.$.isEditMode?Hb.push(...[Pa.a.LMf,Pa.a.NMf,Pa.a.J5i]):Hb.push(...[Pa.a.copy]):2===gb&&Hb.push(Pa.a.hBe);return Hb}kj(){const gb=V.a.ed(1,0,0,647,0,104573951,"PivotTableContextMenuOperationFailure");Pd.a(this.$).kj(gb)}VGj(){return this.ub?
0!==this.ub.LabelOrDateFilterType||0!==this.ub.ValueFilterType||this.ub.HasManualFilter:!1}RGj(gb){return 62<=gb&&65>=gb}izi(){if(this.activeCell&&this.ub&&this.fc){var gb={};gb.cell=this.activeCell;gb.dataSourceIndex=this.fc.externalSourceIndex;gb.fieldId=this.ub.Index.toString();gb.isOlap=this.fc.isOlap;gb.confirmationRequired=this.fc.confirmationRequiredForDataOps;var Hb={};Hb.showPivotFilterDialogCommandData=gb;this.$.Yc(492140419,y.a.zb,19,Hb)}}k5g(gb){this.activeCell&&this.ub&&this.fc&&this.$.userOperationManager.Jc(new H.a(153,
0,(Hb,ac,Ec)=>I.A(this.$.oa.xa,this.activeCell,this.fc.externalSourceIndex,this.ub.Index.toString(),gb,Hb,ac,Ec,null,null)),null)}vSg(gb){!(30>gb||61<gb)&&this.activeCell&&this.ub&&this.fc&&this.$.userOperationManager.Jc(new H.a(152,0,(Hb,ac,Ec)=>I.e(this.$.oa.xa,this.activeCell,this.fc.externalSourceIndex,this.ub.Index.toString(),gb,Hb,ac,Ec,null,null)),null)}applyPivotSort(gb){if(this.fc&&this.ub&&this.activeCell&&this.ze){var Hb=1===this.ze.CellArea||2===this.ze.CellArea;8===this.ze.CellArea?ne.a(this.$.userOperationManager,
(ac,Ec,pd)=>ce.b(this.$.oa.xa,this.activeCell,gb,this.ub.Caption,ac,Ec,pd,null),ac=>new H.a(1015,0,ac,void 0,null),null):Hb&&(Hb=1===this.ze.CellArea?1:2,this.$.ra(600)?ge.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.fc.externalSourceIndex,this.ub.Index.toString(),this.ub.Caption,this.fc.isOlap?"":this.ub.Caption,Hb,1===gb):ge.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.fc.externalSourceIndex,this.ub.Index.toString(),1===
gb))}}cL(){return!this.fc||!this.fc.isActionable}rFj(){return(this.ze||this.fc)&&4!==this.ze.CellType&&(0!==this.ze.CellType||8!==this.ze.CellArea||this.fc.z$&&this.fc.z$.length||this.fc.SK&&this.fc.SK.length)?!1:!0}sFj(){return this.ze&&this.fc&&(1===this.ze.CellArea||2===this.ze.CellArea)&&this.fc.KQb&&this.fc.KQb.length?!1:!0}Uua(gb,Hb,ac,Ec,pd){gb.buttons.push(this.Rd(Hb,ac,0,!1,Ec,null,null,8,null,pd))}}Object(c.a)(Za,"PivotTableContextMenu",z.a,[]);class Xb{compare(gb,Hb){return(gb||"").localeCompare(Hb||
"",void 0,{numeric:!0,sensitivity:"accent"})}}Object(c.a)(Xb,"DigitsAsNumberComparer",null,[363]);var ib=a(1102),Rb=a(157),lc=a(347),nc=a(267),Oc=a(24),Ib=a(145);const gc=w.a.f$g;class Fc extends z.a{constructor(gb,Hb,ac,Ec){super(gb,"PopulateTableFieldListContextMenu",-751848458,-1085236154,gc,!0,!1,"TableFieldListContextMenuRoot",Hb,ac,!1,Ec);this.D6b=null;this.BBd=0;this.SEa=null;this.grid=O.h(gb)}get Hw(){return"PopulateTableFieldListContextMenu"}get tB(){return w.a.SRf}get FK(){this.SEa||(this.SEa=
this.$.da.Aa(261));return this.SEa}executeCommand(gb,Hb,ac){gb=Hb.command;switch(gb){case 639960842:this.applyTableFieldList(ac);this.FK.Dda();break;case -1085236154:d.ULS.sendTraceTag(537166999,0,50,`TableFieldListContextMenu:TableFieldListContextMenuClose, ColWithEntities, ${this.BBd}`);this.FK.Dda();break;case 1833782813:this.FK.showCallout();break;default:return Y.a(gb)}return wa.Task.Sa(!0)}applyTableFieldList(gb){var Hb=gb.MenuItemId.toString();ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5239502_UpdatePulloutFieldNameContainingSplChars")&&
(Hb=Hb.replace("'","''"),Hb=Hb.replace("[","'["),Hb=Hb.replace("]","']"));var ac=Object(Ya.a)(String,gb.SourceControlId);const Ec={};Ec.PulloutField=Hb;Ec.PulloutCardPath=gb.SourceCardKeyPath;Ec.PulloutCardSourceRow=gb.SourceCardRow;Ec.PulloutCardSourceColumn=gb.SourceCardColumn;if(this.FK.eN){d.ULS.sendTraceTag(38887748,0,50,"Table Pullout operation started");Ec.ParameterType=2;gb=gb.ColumnIndex;if(void 0===gb||null===gb){if(void 0===ac||null===ac){d.ULS.shipAssertTag(537166998,0,!1,"TableFieldListContextMenu: ApplyTableFieldList, must specifiy ColumnIndex or SourceControlId");
return}gb=0<=this.FK.ZPf?this.FK.ZPf:parseInt(ac.substring(20+Hb.length+1,ac.length),10);if(isNaN(gb)){d.ULS.shipAssertTag(537166997,0,!1,`TableFieldListContextMenu:ApplyTableFieldListMalformatHTMLAttribute, Attribute, ${ac}`);return}}Ec.PulloutRichColumnSourceIndex=gb;if(this.SEa.SPg){this.GQg(Hb,Ec);return}}else d.ULS.sendTraceTag(38887749,0,50,"Grid Pullout operation started"),Ec.ParameterType=4,ac=this.FK.selectedRange.right,Ba.a.BAb()&&this.SEa.Hwa&&(Ec.ParameterType=8,gb=this.FK.Sla.top,gb=
Oc.Range.BP(ac)+gb,Hb==ib.d?(Hb="=DAYS("+gb+", TODAY())",Ib.a("DateFormulaPulledOut_DaysFromToday")):Hb==ib.g?(Hb="=IF(TODAY() < "+gb+", DATEDIF(TODAY(), "+gb+', "Y"), DATEDIF('+gb+', TODAY(), "Y"))',Ib.a("DateFormulaPulledOut_YearsFromToday")):Hb==ib.c?(Hb="=TEXT("+gb+', "dddd")',Ib.a("DateFormulaPulledOut_DayOfWeek")):Hb==ib.f?(Hb="=TEXT("+gb+', "mmmm")',Ib.a("DateFormulaPulledOut_MonthOfYear")):Hb==ib.e?(Hb="EOMONTH("+gb+", 0)",Hb="=DATE(YEAR("+Hb+"), MONTH("+Hb+"), DAY("+Hb+"))",Ib.a("DateFormulaPulledOut_EndOfMonth")):
Hb==ib.b&&(Hb="="+gb+" + 1",Ib.a("DateFormulaPulledOut_AddOneDay"))),void 0!==Ec.PulloutCardSourceColumn&&null!==Ec.PulloutCardSourceColumn&&(ac=Ec.PulloutCardSourceColumn+1),Ec.PulloutRichColumnSourceIndex=ac;this.vRd(Hb,Ec)}vRd(gb,Hb,ac=0){d.ULS.sendTraceTag(537166996,0,50,`TableFieldListContextMenu:ApplyTableFieldList, ColWithEntities, ${this.BBd}, SelectedColumnIndex, ${Hb.PulloutRichColumnSourceIndex}`);gb=Object(f.a)(new nc.a,{Text:gb});this.grid.setCell(gb,this.FK.Sla,0,127,Hb,ac);this.grid.focus();
this.D6b=null;this.FK.Dda();this.FK.Woj()}wc(gb,Hb,ac){if(gb=this.$.isEditMode&&ba.EwaSettings.ra(128)&&!!this.FK)switch(Hb.command){case -1085236154:break;case 639960842:gb=!!ac;break;case 1833782813:gb=this.FK.xwa&&this.FK.oDb;break;default:gb=!1}return gb}w0(gb,Hb,ac){this.$.isEditMode&&(this.D6b=this.FMh(Object(Ya.a)(346,ac)),super.w0(gb,Hb,null,null,!1))}FY(){return this.D6b}E5c(gb){if(!this.FK||!gb||!gb.Pk)return d.ULS.shipAssertTag(537166994,0,!!this.FK,"TableFieldListContextMenu:CreateContextMenuItemList PulloutManager null"),
d.ULS.shipAssertTag(537166993,0,!!gb,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager null"),gb&&d.ULS.shipAssertTag(537166992,0,!!gb.Pk,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager.FieldInfoListContextList null"),null;let Hb=new Gb.a;for(const Ec of gb.Pk){gb=new Gb.a;gb.add(Ec.ColumnName);gb.add(Ec.ColumnIndex.toString());let pd=new Gb.a;var ac=null;Ba.a.BAb()&&this.SEa.Hwa?pd=wb.toList(wb.select(wb.asEnumerable(Ec.FieldInfoDataList),Bd=>Bd.Name)):(ac=
ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5860557_CompareDigitsAsNumberRichDataProperties")?new Xb:new tb.a,pd=wb.OBc(wb.concat(pd,wb.select(wb.asEnumerable(Ec.FieldInfoDataList),Bd=>Bd.Name)),Bd=>Bd,ac));ac=new Gb.a;ac.add(wb.toArray(wb.concat(gb,pd)));Hb=wb.toList(wb.concat(Hb,ac))}return wb.toArray(Hb)}FMh(gb){var Hb=this.E5c(gb);if(!Hb||!Hb.length)return this.D6b=null;gb=this.Va;const ac=gb.uq(this.menuId);let Ec=gb.Ec();const pd=1<Hb.length,Bd=Ba.a.BAb()&&this.SEa.Hwa;this.BBd=Hb.length;
for(const de of Hb){Bd?Ec.title="Calculate Date Information":pd||(Ec.title=de[0]);Hb=gb.Ec();for(let Jb=2,tc=de.length;Jb<tc;++Jb)!Bd||de[Jb]!=ib.d&&de[Jb]!=ib.e||(ac.rc.push(Ec),Ec=gb.Ec()),(pd?Hb.buttons:Ec.buttons).push(gb.$Ha("ApplyTableFieldList."+de[Jb]+"."+de[1],de[Jb],639960842,null,"None",de[Jb],!1,void 0,!0));if(pd){const Jb=gb.$v("ApplyTableFieldList."+de[0],this.menuId,de[0],798637440);Jb.menu.rc.push(Hb);Ec.buttons.push(Jb)}}ac.rc.push(Ec);return ac}GQg(gb,Hb){const ac=V.a.ed(12,1,0,
899,0,2007340793,"RichValuePulloutIntoNonEmptyRange");if(ba.EwaSettings.mz()){const Ec=new lc.a(this.$,ac);Ec.gP(()=>{2===Ec.returnValue&&this.vRd(gb,Hb,8)})}else{const Ec=new Rb.ErrorDialog(this.$,ac);Ec.gP(()=>{2===Ec.returnValue&&this.vRd(gb,Hb,8)});Ec.kg()}}}Object(c.a)(Fc,"PulloutFieldListContextMenu",z.a,[]);const Vc=w.a.URf;class ed extends z.a{constructor(gb,Hb,ac,Ec){super(gb,"PopulateRichTextContextMenu",679816325,1151222423,Vc,!0,!1,Vc,Hb,ac,!0,Ec);this.grid=O.h(gb)}get Hw(){return"PopulateRichTextContextMenu"}get tB(){return w.a.URf}wc(gb,
Hb,ac){return-1687037502===Hb.command&&!!ac&&this.grid.fb}executeCommand(gb,Hb,ac){this.showRichTextFloatie(ac);return wa.Task.Sa(!0)}xKa(){return[Pa.a.M2g]}showRichTextFloatie(gb){var Hb=Object(Ya.a)(db.a,gb.eventArgs);Hb&&(gb=this.xKa(Hb.vb),Hb=new Sys.UI.Point(Hb.Ea.clientX,Hb.Ea.clientY),this.showFloatie(gb,new Sys.UI.Bounds(Hb.x,Hb.y,0,0),2))}}Object(c.a)(ed,"RichTextContextMenu",z.a,[]);var Sd=a(101),Zd=a(429);const pa=w.a.e$g;class zb extends z.a{constructor(gb,Hb,ac,Ec){super(gb,"PopulateSheetOpsContextMenu",
274207288,-1497523576,pa,!0,!1,"SheetTabContextMenuRootName",Hb,ac,!1,Ec);this.Tjc=this.lic=!1}get Hw(){return"PopulateSheetOpsContextMenu"}get tB(){return w.a.VRf}executeCommand(gb,Hb,ac){if(ub.a(this.$))return wa.Task.Sa(!0);this.$.isEditMode&&(gb=ac[w.a.L7f],gb=gb.x&&gb.y?new Sys.UI.Point(gb.x+(this.$.isChromeRtl?10:-10),gb.y):eb.DOMElementExtensions.getLocation(ac[w.a.M7f]),this.xp(gb,!1));return wa.Task.Sa(!0)}wc(gb,Hb,ac){return-1075099431===Hb.command&&!!ac}FY(){const gb=this.Va.uq(this.menuId),
Hb=this.$.isEditMode;this.d2j();this.tMh(gb,Hb);this.iMh(gb);this.mNh(gb);return gb}r_b(gb,Hb,ac,Ec){gb.push(this.Va.pb(Hb?ac:Ec))}tMh(gb,Hb){var ac=this.Va;const Ec=ac.Ec();Ec.buttons.push(ac.pb(54));this.r_b(Ec.buttons,this.Tjc,127,56);Ec.buttons.push(ac.pb(55));Hb&&this.r_b(Ec.buttons,this.Tjc,126,125);Ec.buttons.push(ac.pb(158));Hb=this.$.va.na;ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)&&!this.$.fK&&!this.$.ea.isNamedObjectViewMode&&!this.$.isMobileMode&&
Hb&&Hb.Zd&&(Hb.Zd.kz||Hb.Zd.hK||Ec.buttons.push(ac.pb(299)));this.$.ea.SMb&&l.AFrameworkApplication.XBb(Zd.b)&&(Hb=Object(Ya.a)(Sd.a,this.$.na))&&Qb.p(Hb)&&this.$.isEditMode&&(Ec.buttons.push(ac.pb(277)),Hb.isLockPausedInSession?Ec.buttons.push(ac.pb(279)):Hb.Ph&&Ec.buttons.push(ac.pb(278)));Hb=ac.$v("ContextMenu.TabColor",null,Z.a.instance.ga(517),1841703919);ac=ac.C5c(467002767,1549407384,540,-221093529,this.tB);Hb.menu.rc.push(ac);Ec.buttons.push(Hb);gb.rc.push(Ec)}iMh(gb){const Hb=this.Va.Ec();
this.r_b(Hb.buttons,this.Tjc,114,112);this.r_b(Hb.buttons,!this.lic,115,113);gb.rc.push(Hb)}mNh(gb){if(ba.EwaSettings.ra(418)&&!Qb.e(this.$.va.na)){var Hb=this.Va,ac=Hb.Ec();ac.buttons.push(Hb.pb(263));gb.rc.push(ac)}}d2j(){let gb,Hb;({m5c:gb,QGe:Hb}=this.$.l5c());this.Tjc=1===gb;this.lic=0<Hb}}Object(c.a)(zb,"SheetOpsContextMenu",z.a,[]);var Vb=a(518);class xc extends z.a{constructor(gb,Hb,ac,Ec){super(gb,"PopulateSlicerContextMenu",-1920954846,723126814,"SlicerContextMenu",!0,!1,"SlicerContextMenuRootName",
Hb,ac,!0,Ec)}get Hw(){return"PopulateSlicerContextMenu"}get tB(){return w.a.WRf}Hc(gb,Hb){var ac=!0;switch(Hb){case -231711729:ac=!1;break;case -1909381757:ac=this.wdc();ac=!!ac&&ac.Yoi;break;case 1312363469:ac=!0}return!ac||super.Hc(gb,Hb)}executeCommand(gb,Hb,ac){if(!this.$.isEditMode)return D.TaskExtensions.Yaa();gb=Hb.command;Hb=this.wdc();let Ec=null;switch(gb){case 2108047455:Hb&&Hb.hDe();break;case -231711729:d.ULS.shipAssertTag(537166990,0,!1,"Shouldn't be hitting Slicer Refresh - NYI");break;
case -1909381757:Hb&&Hb.f4b();break;case 1312363469:this.showSlicerContextMenu(ac);break;default:Ec=Y.a(gb)}return Ec||D.TaskExtensions.Yaa()}wc(gb,Hb,ac){gb=!1;switch(Hb.command){case -231711729:case 2108047455:case -1909381757:gb=!0;break;case 1312363469:gb=!!ac}return gb}FY(){const gb=this.Va.uq(this.menuId);var Hb=this.Va.Ec();Hb.buttons.push(this.Va.pb(252));Hb.buttons.push(this.Va.pb(253));Hb.buttons.push(this.Va.pb(254));gb.rc.push(Hb);Hb=this.Va.Ec();this.Jui()?Hb.buttons.push(this.Va.pb(266)):
Hb.buttons.push(this.Va.pb(267));gb.rc.push(Hb);return gb}Jui(){if(Ba.a.Ad(this.$)){var gb=this.$.da.Aa(439);if(gb)return gb.Sr}else if(gb=this.$.da.Aa(371))return gb.Sr;return!1}showSlicerContextMenu(gb){var Hb=Object(Ya.a)(db.a,gb.eventArgs);gb=this.Zbc(Object(Ya.a)(db.a,gb.eventArgs));Hb=Hb.vb;y.a.zb=Hb;this.xp(gb,!1,Hb)}O_e(gb){const Hb=this.Va.Ec(),ac=this.Va.Ec();ac.buttons.push(this.Va.pb(255));ac.buttons.push(this.Va.pb(256));const Ec=this.Va.F5c("ContextMenu.SlicerSort",null,Z.a.instance.ga(2178),
-814639094,0,Na.a.QTe);Ec.menu.rc.push(ac);Hb.buttons.push(Ec);gb.rc.push(Hb)}mHj(gb){return ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5103035_SlicerCornerResizePointContextMenuUseOnlyClientPoint")&&gb.Mb.className===Na.a.Iad||ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5185773_SlicerShortcutContextMenuSkipFramePoint")&&1===gb.vb}Zbc(gb){var Hb=O.h(this.$).ha.Ra.dc;let ac=gb&&1!==gb.vb&&gb.clientPoint?gb.clientPoint:Sys.UI.DomElement.getLocation(Hb.domElement);if(this.mHj(gb)){var Ec=this.wdc();
Ec&&(gb.Mb.className===Na.a.Iad&&(ac=ja.HelperMethods.Gwb(gb.Ea)),1===gb.vb&&(ac=fa.a(this.$).Mja(eb.DOMElementExtensions.getLocation(Ec.frame))))}else if(gb=this.wdc())gb=this.XVh(gb.frame),(Ec=ja.HelperMethods.PC(this.$.rf,this.$.domElement,O.h(this.$).rtl,!1))?(gb.x=fa.a(this.$).mi(gb.x-Ec.x)+Ec.x,gb.y=fa.a(this.$).mi(gb.y-Ec.y)+Ec.y):d.ULS.sendTraceTag(537166989,0,15,"Cannot get constant pane size."),ac.y+=gb.y,ac.x+=gb.x;gb=this.$.domElement;Ec=O.h(this.$).rtl;Hb=ja.HelperMethods.PC(Hb.ug.domElement,
gb,Ec);ac.y=Math.max(ac.y,Hb.y);ac.x=Math.max(ac.x,Hb.x);return ac}wdc(){const gb=O.h(this.$).ha.Ra.dc;d.ULS.shipAssertTag(537166988,0,!!gb);return Vb.a(this.$).jH(gb.floatingObject.id)}XVh(gb){let Hb=new Sys.UI.Point(gb.offsetParent.offsetLeft,gb.offsetParent.offsetTop);var ac=O.h(this.$);if(!ac)return Hb;const Ec=O.h(this.$).rtl;Hb=ja.HelperMethods.PC(gb,this.$.ar.ownerDocument.body,Ec);ac.JGe(Hb);Hb.x=Ec?this.$.ar.clientWidth-Hb.x-gb.clientWidth:Hb.x;gb=ac.view.jqb;ac=Ec?-ac.MR.pca(gb.x):gb.x;
Hb.x-=ac;Hb.y-=gb.y;return Hb}}Object(c.a)(xc,"SlicerContextMenu",z.a,[]);class Sc{constructor(gb,Hb,ac){this.type=gb;this.c$g=Hb;this.yr=ac}}Object(c.a)(Sc,"TimeSlicerRibbonButtonParameter",null,[]);class Jd extends z.a{constructor(gb,Hb,ac,Ec){super(gb,"PopulateTimeSlicerLevelMenu",-227942804,1634477200,Jd.JSj,!0,!1,Jd.bLb,Hb,ac,!1,Ec);this.t1a=0;this.GOe=this.rva=this.Lsa=null}get Hw(){return"PopulateTimeSlicerLevelMenu"}get tB(){return w.a.ZRf}executeCommand(gb,Hb,ac){gb=Hb.command;switch(gb){case 2000085697:gb=
ac.DOMElement;this.Lsa=ac.ChangeLevelCallback;this.rva=ac.GetLevelLabelCallback;this.t1a=ac.CurrentLevel;const Ec=ac.DomEvent;L.g(Ec);const pd=ac.location;ac=ac.levelLabelText;this.GOe=eb.DOMElementExtensions.fz(document.activeElement,"iframe")&&ac?ac.parentNode:null;ac=Sys.UI.DomElement.getBounds(ac);ac.x=pd.x;ac.y=pd.y;this.w0(Ec,gb,ac,Hb,!0);break;case -649826274:this.Lsa(0);break;case 149600865:this.Lsa(1);break;case -2012435159:this.Lsa(2);break;case -1979934975:this.Lsa(3);break;case 1634477200:eb.DOMElementExtensions.setFocus(this.GOe);
break;default:return Y.a(gb)}return wa.Task.Sa(!0)}wc(gb,Hb,ac){gb=!1;switch(Hb.command){case 2000085697:gb=!!ac;break;case -649826274:case 149600865:case -2012435159:case -1979934975:case 1634477200:gb=!0}return gb}w0(gb,Hb,ac){gb=Sys.UI.DomElement.getBounds(Hb);ac.x=fa.a(this.$).mi(ac.x);ac.y=fa.a(this.$).mi(ac.y);gb.x=fa.a(this.$).mi(gb.x);gb.y=fa.a(this.$).mi(gb.y);gb=new Sys.UI.Point(gb.x+ac.x,gb.y+ac.y);this.showContextMenu(new Sys.UI.Bounds(gb.x,gb.y-ac.height,ac.width,ac.height))}FY(){const gb=
this.Va,Hb=gb.uq(this.menuId),ac=gb.Ec();for(let pd=0;3>=pd;pd++){const Bd=this.rva(pd);var Ec=Jd.mQh(pd);Ec=gb.ibh(Ec.c$g,Ec.yr,this.t1a===pd,Jd.hCe);Ec.label=Bd;Ec.TR(Bd);this.t1a===pd?Ec.VR("Image16by16",8,Jd.hCe):Ec.Y3b();ac.buttons.push(Ec)}Hb.rc.push(ac);return Hb}static mQh(gb){let Hb=null;switch(gb){case 0:Hb=new Sc(87,"ContextMenu.TimeSlicerLevelYear",-649826274);break;case 1:Hb=new Sc(88,"ContextMenu.TimeSlicerLevelQuater",149600865);break;case 2:Hb=new Sc(89,"ContextMenu.TimeSlicerLevelMonth",
-2012435159);break;case 3:Hb=new Sc(90,"ContextMenu.TimeSlicerLevelDay",-1979934975)}return Hb}}Jd.JSj=w.a.g$g;Jd.bLb="TimeSlicerLevelMenuRootName";Jd.hCe=Na.a.sua;Object(c.a)(Jd,"TimeSlicerLevelMenu",z.a,[]);var ye=a(318),pe=a(3);class re extends b.a{constructor(gb){super(gb)}hd(){const gb=this.$,Hb=qa.a.m1a(Da.b(),this.la,"Task","IRootUser"),ac=e.a(gb);let Ec=null;Ec=(de,Jb)=>{ac.NWf(Ec);Hb.setResult(Jb.o5b)};ac.lre(Ec);ac.E5e();const pd=U.GetServiceTaskFactory.create(gb.da,102,gb.la,this.Xa),Bd=
U.GetServiceTaskFactory.Oa(gb.da,342,338,this.Xa);D.TaskExtensions.za(D.TaskExtensions.Fd([Hb.task,pd,Bd],this.la),()=>{const de=pd.result,Jb=Hb.task.result,tc=Bd.result;this.$c([new qb(gb,Jb,de,tc),new ha(gb,Jb,de,tc),new ya(gb,Jb,de,tc),new Va(gb,Jb,de,tc),new td(gb,Jb,de,tc),new W(gb,Jb,de,tc),new $d.GridContextMenu(gb,Jb,de,tc),new be(gb,Jb,de,tc),new zb(gb,Jb,de,tc),new Jd(gb,Jb,de,tc),new Fc(gb,Jb,de,tc),new lb(gb,Jb,de,tc),new Za(gb,Jb,de,tc),new xc(gb,Jb,de,tc),new ed(gb,Jb,de,tc)])},gb.la,
3)}static initData(){const gb=ye.a.r9;gb(2000085697,20479,0,0);gb(-227942804,pe.a.oc|24576,0,0);gb(1634477200,pe.a.oc|131072,0,0);gb(-649826274,4095,0,0);gb(149600865,4095,0,0);gb(-2012435159,4095,0,0);gb(-1979934975,4095,0,0);gb(1247109494,pe.a.oc|24576,0,0);gb(-2064931494,pe.a.oc|131072,0,0);gb(-1396319072,pe.a.Ga,128,0);gb(-425234874,pe.a.Ga,128,0);gb(-1253126584,pe.a.Ga,0,0);gb(274207288,pe.a.oc|24576,0,0);gb(-1497523576,pe.a.oc|131072,0,0);gb(-498523270,pe.a.oc|24576,64,0);gb(1640762262,pe.a.oc|
131072,64,0);gb(-2017893763,pe.a.oc|24576,0,0);gb(1350204367,pe.a.oc|131072,0,0);gb(-889576107,pe.a.Wv,128,0);gb(-1170196828,pe.a.Wv,128,0);gb(389774337,pe.a.Wv,128,0);gb(1529312473,pe.a.Wv,128,0);gb(2033235475,pe.a.Wv,128,0);gb(-96230454,pe.a.Wv,128,0);gb(74086617,pe.a.Wv,128,0);gb(563292088,pe.a.Wv,128,0);gb(-1092351914,pe.a.Wv,128,0);gb(-2141589616,pe.a.Wv|16384,128,0);gb(745182485,pe.a.Wv,0,0);gb(359279088,pe.a.Wv,128,0);gb(-67292059,pe.a.Wv,128,0);gb(926905850,pe.a.Wv,128,0);gb(547535945,pe.a.Wv,
128,0);gb(1374696078,pe.a.oc|24576,0,0);gb(495005930,pe.a.oc|212992,0,0);gb(-1045020714,pe.a.oc|24576,0,0);gb(-170383950,pe.a.oc|212992,0,0);gb(324156914,pe.a.Ga,0,0);gb(-1085236154,pe.a.$u,0,0);gb(-751848458,pe.a.al|16384,0,0);gb(216058793,pe.a.$u,0,0);gb(474690375,pe.a.al|16384,0,0);gb(-1920954846,pe.a.oc|24576,0,0);gb(723126814,pe.a.oc|131072,0,0);gb(2108047455,128,128,0);gb(-231711729,128,128,0);gb(-1909381757,128,128,0);gb(-814639094,128,128,0);gb(1701016594,pe.a.oc|3072,128,0);gb(-1475408662,
pe.a.oc|24576,0,0);gb(1114549926,pe.a.oc|131072,32,0)}static ka(gb){b.a.Md(10,new re(gb))}}Object(c.a)(re,"ContextMenuCommandHandlerFactory",b.a,[]);var He=a(226),ze=a(1425),ef=a(95),$a=a(180);class Nb{constructor(gb,Hb){this.ksb=Hb;this.$=gb}dispose(){}daa(){this.ksb.o3()}GC(){this.ksb.GC()}HUd(gb,Hb,ac){Kb.i(this.$,Kb.b);this.ksb.showContextMenu(Object(f.a)(new ze.a,{x:Hb.x,y:Hb.y}),ac,gb);ef.EventHandlerManager.instance.Idd()}Rzc(gb,Hb,ac){Kb.i(this.$,Kb.b);this.ksb.showFloatie(Object(f.a)(new ze.a,
{x:Hb.x,y:Hb.y}),gb,ac);$a.a(()=>{ef.EventHandlerManager.instance.Idd()},this.$.la)}GUd(gb,Hb,ac,Ec){Kb.i(this.$,Kb.b);this.ksb.GUd(Object(f.a)(new ze.a,{x:Hb.x,y:Hb.y}),gb,ac,Ec)}}Object(c.a)(Nb,"ReactContextMenuController",null,[249,2]);class qc extends He.a{constructor(gb){super();this.yef=!1;this.Mnd=()=>{let Hb;(Hb=this.$.da.Aa(342))?this.nb(Hb):this.$.Vx(ac=>{ac.bgc().then(Ec=>{(Hb=this.$.da.Aa(342))?this.nb(Hb):(Hb=new Nb(this.$,Ec),this.nb(this.$.da.Ha(342,Hb)))})})};this.$=gb;this.Db()}dispose(){this.yef&&
this.$&&this.$.ea.Cn(this.Mnd);super.dispose()}create(){this.$.ea.Zf?(d.ULS.sendTraceTag(537167065,0,50,`ContextMenuControllerFactory.InitReactUISurfacesAndRegisterControllerIfNeeded: GFI = ${this.$.ea.Zf}`),this.Mnd(null,null)):(this.yef=!0,this.$.ea.Dk(this.Mnd))}static ka(gb){gb.da.Ha(338,new qc(gb))}}Object(c.a)(qc,"ContextMenuControllerFactory",He.a,[]);var Lc=a(159);class sd{constructor(){this.dictionary=this.Sd=null}}Object(c.a)(sd,"RibbonCommandParams",null,[]);class Fd{constructor(){this.menuModel=
null;this.AJe=0}}Object(c.a)(Fd,"HeaderSnappedAutoFilterMenuCacheEntry",null,[]);class Td{constructor(){this.Xec={}}zQh(gb){return(gb=this.Xec[gb.toString()])?gb.menuModel:null}U_g(gb,Hb){this.Xec[Hb.toString()]=Object(f.a)(new Fd,{menuModel:gb,AJe:ja.HelperMethods.Kb()})}O8b(gb){this.Xec[gb.toString()]=null}o5h(gb){return(gb=this.Xec[gb.toString()])?gb.AJe:-1}}Object(c.a)(Td,"FilterMenuCache",null,[]);var ue=a(14),Ae=a(181),Le=a(227);class df{constructor(){this.Zc=this.Hwe=this.cell=null}}Object(c.a)(df,
"AutoFilterEventRegistrationArgs",null,[]);class Oe{constructor(gb){this.d_a=null;this.aUd=!1;this.qDb=0;this.iad=1;this.VQe=0;this.mGb=Hb=>{this.rQf(Hb.domElement,Hb.hashCode)};this.oUf=Hb=>{let ac=0;for(;window.performance.now()-Hb<this.cuh&&0<this.d_a.length;)this.rpe(this.d_a.shift()),ac++;d.ULS.sendTraceTag(537167052,1,50,`FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Batch number: ${this.iad}, Events Registered in this frame: ${ac}, Events in queue: ${this.d_a.length}`);0<this.d_a.length?
this.qDb=window.requestAnimationFrame(this.oUf):(Hb=window.performance.now()-this.VQe,d.ULS.sendTraceTag(537167051,1,50,`FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Finished batch number: ${this.iad}, Total time in MS: ${Hb}`),this.iad++,this.qDb=0)};this.onPointerDown=Hb=>{ge.a.slim(Hb.Ea.rawEvent);return!1};this.$=gb;this.gridView=O.h(this.$);this.Efi();this.cuh=10}dispose(){window.cancelAnimationFrame(this.qDb);this.gridView&&this.gridView.Muc(this.mGb);this.gridView=null}Efi(){if(this.aUd=
ja.HelperMethods.z7a)this.d_a=[];this.fKg();this.gridView.L_b(this.mGb)}fKg(){for(const gb of this.gridView.yn){const Hb=gb.iCa;for(let ac in Hb){const Ec=Hb[ac];this.rQf(Ec.domElement,Ec.hashCode)}}}rQf(gb,Hb){if(O.h(this.$).Ca.Am.b2a(Hb))if(gb){gb=gb.querySelectorAll('[id^="'+w.a.scd+'"]');for(let pd=0;pd<gb.length;pd++){var ac=gb[pd],Ec=ac.getAttribute(w.a.LGh);const Bd=ac.getAttribute(w.a.DGh);d.ULS.shipAssertTag(537167053,0,!!Ec&&!!Bd,`FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Row and Column attributes should exist in AF input element. AutoFilterId: ${ac.id}, BlockHash: ${Hb}`);
Ec=Oc.Range.Mc(parseInt(Ec,10),parseInt(Bd,10));ac=Object(f.a)(new df,{cell:Ec,Hwe:ac,Zc:Hb});this.aUd?(this.d_a.push(ac),this.qDb||(this.VQe=window.performance.now(),this.qDb=window.requestAnimationFrame(this.oUf))):this.rpe(ac)}}else d.ULS.sendTraceTag(537167054,0,50,`FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block DOM element is null. BlockHash: ${Hb}`);else d.ULS.sendTraceTag(537167055,0,50,`FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block model does not exist yet. Handlers will be added when block is rendered. BlockHash: ${Hb}`)}rpe(gb){const Hb=
this.gridView.Ca.IKa(gb.cell,gb.Zc);Hb?this.eKg(gb.Hwe,Hb):d.ULS.sendTraceTag(537167050,1,10,`FilterMenuManager.AddPointerHandlersToAutoFilterInCell: GetModelCellFromRange returned null. BlockHash: ${gb.Zc}, AutoFilter Cell: ${gb.cell}`)}eKg(gb,Hb){Hb.hasAutoFilter?this.hIg(gb,Hb.mvb):Hb.p4?this.cKg(gb,Hb.mvb,Hb.$rd):d.ULS.sendTraceTag(537167049,1,50,"FilterMenuManager.AddPointerEventHandlersToAutoFilter: Cell must have either AutoFilter or PivotFilter if reached here!");Lc.a.instance.ta(ue.a.pf,
gb,this.onPointerDown);Ae.a.instance.ta(ue.a.kya,gb,this.onPointerDown)}hIg(gb,Hb){Le.a.instance.ta(ue.a.click,gb,ac=>{Hb&&ge.a.hrc(ac.Ea.rawEvent,966232027,Hb,null);return!0})}cKg(gb,Hb,ac){const Ec=v.a.Xh(Hb);Le.a.instance.ta(ue.a.click,gb,pd=>{ac?ge.a.spf(document.getElementById(Ec.EwaElementId),Ec.Cell,Ec.DataSourceIndex,Ec.FieldId,Ec.IsOlap,Ec.RequiresConfirmation,pd.Ea.rawEvent,Ec.OptionalPivotMenuAnchor):ge.a.spfm(pd.Ea.rawEvent,Ec.RequiresConfirmation,Ec.Cell,Ec.DataSourceIndex,Ec.PivotName,
Ec.OptionalPivotMenuAnchor);return!1})}}Object(c.a)(Oe,"FilterMenuPointerEventsManager",null,[2]);class cf{constructor(gb){this.CXe=null;this.$=gb;this.z9a=new Td;ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||(this.CXe=new Oe(this.$))}dispose(){ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||this.CXe.dispose();
this.$=null}LWh(gb){const Hb=O.h(this.$).Ca.d$(gb,this.$.activeItemName);return Hb&&Hb.blockPresentInViewportTimeStamp>this.z9a.o5h(gb.left)?Hb.Vr(gb).autoFilterMenu:this.z9a.zQh(gb.left)}XUi(gb,Hb,ac){this.z9a&&this.z9a.U_g(gb.menuModel[Hb],ac)}YUi(gb){this.z9a&&this.z9a.O8b(gb)}}Object(c.a)(cf,"FilterMenuManager",null,[248,2]);var vf=a(209),hf=a(171);class Mf{constructor(gb,Hb,ac){this.pAc={};this.Ed=!1;this.Xl=(Ec,pd=null)=>{this.showContextMenu(pd)};this.BBf=(Ec,pd)=>{pd.mIi===Mf.f8h&&O.h(this.$).focus()};
this.iR=(Ec,pd)=>{Ec=this.$.Ia.Naa(pd.Sd.command);(null===Ec||void 0===Ec?0:Ec.dismissesContextualUI)&&this.o3()};this.Y5=()=>{this.$.da.jU(342);D.TaskExtensions.za(U.GetServiceTaskFactory.create(this.$.da,338,this.$.la,3),Ec=>{Ec=Ec.result;for(let pd of this.pAc)pd.XTf(Ec)},this.$.la)};this.$=gb;this.contextMenuController=ac;this.u9d=new cf(this.$);gb.da.Ha(8,this);for(ac=0;ac<Hb.length;ac++)this.pAc[Mf.h$g[ac]]=Hb[ac];this.ha=O.h(gb).ha;this.ha.F_b(this.Xl);this.$.Ia.ZYa(this.BBf);Lc.a.instance.TBj();
ba.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ia.YFa(this.iR);ba.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.l2(this.Y5)}get Z$b(){return this.u9d}Jfd(gb){return aa.a.Fc(this.pAc,gb)}dispose(){this.Ed?d.ULS.sendTraceTag(537167062,1,50,"ContextMenuManager.Dispose: Dispose has been called more than once"):(this.Ed=!0,this.$&&(this.$.pl(Mf.dd),this.$.da.jU(8),this.ha&&this.ha.Fuc(this.Xl),
this.$.Ia.XJb(this.BBf),ba.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ia&&this.$.Ia.Vza(this.iR),ba.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.K6(this.Y5)),this.$=this.ha=null,this.Z$b.dispose(),this.pAc=this.u9d=null)}showContextMenu(gb,Hb=null,ac=null){this.QGj(gb)&&(Kb.i(this.$,Kb.j),gb=this.xch(gb,Hb,ac),this.$.Ia.Hb(gb.Sd,gb.dictionary))}o3(){this.contextMenuController?this.contextMenuController.daa():
d.ULS.sendTraceTag(537167061,1,10,"ContextMenuManager.DismissContextualUI: Context menu controller is null.")}QGj(gb){return Pd.a(this.$).ep()?(d.ULS.sendTraceTag(537167060,1,50,"ContextMenuManager.OnContextMenu: Ignoring ContextMenu event because it is not allowed in partial interactivity mode"),Pd.a(this.$).cW(hf.a.grid,vf.a.showContextMenu),!1):!this.$.Ia.nEh&&(!gb||gb.Mb!==O.h(this.$).domElement&&!ve.a.equals(gb.Mb.tagName,"INPUT",!0))}xch(gb,Hb=null,ac=null){ac={["eventArgs"]:gb,["creationParams"]:ac};
gb=gb?gb.vb:-1;const Ec=this.ha.Ra.dc;let pd=1441131127;Ec?(Hb=Ec.floatingObject,d.ULS.shipAssertTag(537167059,0,!!Hb,"floatingObj shouldn't be null."),Mf.ktd(Hb)?pd=1312363469:Mf.isPivotChart(Hb)?(ac[ha.W1c]=Hb?Hb.Wc:null,pd=-149612405):pd=-1372040782):Mf.dlf(Hb)?(ac[ha.W1c]=Hb,pd=-149612405):!Kb.h(this.$)&&Kb.f(O.h(this.$))&&(pd=671488277);Hb=new M.a(pd,gb,this.$.xc,30,null);return Object(f.a)(new sd,{Sd:Hb,dictionary:ac})}static ka(gb){gb.Lk(Mf.dd)}static isPivotChart(gb){return!!gb&&0===gb.type&&
Mf.dlf(gb.Wc)}static ktd(gb){return!!gb&&2===gb.type}static dlf(gb){return!!gb&&!!(gb.Attributes&4)}}Mf.h$g="autoFilter chart fieldList fieldListPivotFilter fieldWell floatingObject grid pivotFilter sheetOps timeSlicerLevel tableFieldList autoFilterRichFieldList slicer richText".split(" ");Mf.f8h="GridContextMenu";Mf.dd=gb=>{(gb=Object(Ya.a)(7,gb))&&U.GetServiceTaskFactory.create(gb.da,9,gb.la,0)};Object(c.a)(Mf,"ContextMenuManager",null,[229,2]);class xf extends He.a{constructor(gb){super();this.$=
gb;this.Db()}create(){const gb=this.$,Hb=gb.$b;if(Hb.allowSelection||Hb.allowEdits||Hb.allowFiltering||Hb.allowSorting||Hb.allowPivotSpecificOperations){const ac=U.GetServiceTaskFactory.create(gb.da,10,gb.la,this.Xa),Ec=U.GetServiceTaskFactory.Oa(gb.da,342,338,this.Xa);D.TaskExtensions.za(D.TaskExtensions.Fd([ac,Ec],this.la),()=>{this.nb(m.a(gb)||new Mf(gb,ac.result,Ec.result))},this.$.la,3)}else d.ULS.sendTraceTag(537167058,0,15,"ContextMenuManagerFactory.Create: no client permissions to allow creating ConetxtMenuManager. Returning null."),
gb.da.jU(8),this.nb(null)}static ka(gb){gb.da.Ha(9,new xf(gb))}}Object(c.a)(xf,"ContextMenuManagerFactory",He.a,[]);var sc=a(9);a.d(F,"a",function(){return ad});const ad=()=>{re.initData();sc.a.Fa(gb=>{qc.ka(gb);xf.ka(gb);re.ka(gb);Mf.ka(gb)})}},1174:function(r,F,a){var c=a(9);r=a(0);var b=a(709),e=a(15);const f=X=>{switch(X){case 0:X="Between";break;case 1:X="NotBetween";break;case 2:X="Equal";break;case 3:X="NotEqual";break;case 4:X="GreaterThan";break;case 5:X="LessThan";break;case 6:X="GreaterThanOrEqual";
break;case 7:X="LessThanOrEqual";break;default:X="Unknown"}return X},d=X=>{switch(X){case 0:X="AnyValue";break;case 1:X="WholeNumber";break;case 2:X="Decimal";break;case 3:X="List";break;case 4:X="Date";break;case 5:X="Time";break;case 6:X="TextLength";break;case 7:X="Custom";break;default:X="Unknown"}return X};var h=a(127),l=a(41),k=a(376),t=a(193),n=a(284);class z{constructor(X=null,R=!1){this.S4=X?X.IsIgnoreBlank:!0;this.T4=X?X.IsInCellDropDown:!0;this.DN=!X||R&&3!==X.RuleType?"":X.LowerBoundary;
this.EN=!X||R&&3!==X.RuleType?"":X.UpperBoundary;this.wB=X?X.ConditionType:0;this.ruleType=R?3:X?X.RuleType:0;this.LZ=X?X.IsAlertBlocking:!0;this.uT=X?X.AlertTitle:"";this.tT=X?X.AlertMessage:"";this.aV=X?X.InputMessage:"";this.aF=X?X.InputTitle:"";this.f5=X?X.IsShowErrorAlert:!0;this.g5=X?X.IsShowInputMessage:!0}isEqual(X){return X?this.S4===X.S4&&this.T4===X.T4&&this.DN===X.DN&&this.EN===X.EN&&this.wB===X.wB&&this.ruleType===X.ruleType&&this.LZ===X.LZ&&this.uT===X.uT&&this.tT===X.tT&&this.aV===
X.aV&&this.aF===X.aF&&this.f5===X.f5&&this.g5===X.g5:(e.ULS.shipAssertTag(537163233,0,!1,"DataValidationEditDialogState.IsEqual: State should not be Null"),!1)}}Object(r.a)(z,"DataValidationEditDialogState",null,[]);var w=a(249),m=a(189),u=a(282),y=a(21),v=a(128),C=a(52),x=a(55);class B{constructor(X,R){this.Ay=this.iia=this.selectedRanges=null;this.lOe=!1;this.Sh=null;this.kTi=wa=>{this.wDf(wa);this.eOf(!0)};this.lTi=wa=>{this.wDf(wa);this.eOf(!1)};this.tEh=wa=>{this.Hz("DataValidationEdit.ExpandExistingDialog",
wa);this.Ay.c=B.NY(wa);1===wa?this.K$(new z(this.iia)):2===wa?this.K$(new z):this.gmc()};this.uEh=wa=>{this.Hz("DataValidationEdit.ExpandExistingListDialog",wa);this.Ay.c=B.NY(wa);1===wa?this.K$(new z(this.iia,!0)):2===wa?this.K$(new z(null,!0)):this.gmc()};this.n3i=wa=>{this.Hz("DataValidationEdit.OverrideExistingDialog",wa);this.Ay.c=B.NY(wa);1===wa?this.K$(new z):this.gmc()};this.kLf=wa=>{this.Hz("DataValidationEdit.OverrideExistingListDialog",wa);this.Ay.c=B.NY(wa);1===wa?this.K$(new z(null,!0)):
this.gmc()};this.$=X;this.D1a=R}Hc(){return!1}executeCommand(X,R){-1728432249!==R.command&&739109630!==R.command&&m.a(R.command);this.selectedRanges=l.r(y.h(this.$).ha.qa.selectedRanges,this.$);y.h(this.$).FSa(!0);this.getDataValidationInitialState(R.command);this.Sh=this.$.Jb.Gc("UserAction","DataValidationEditTimeToDialogOpen");this.lOe?e.ULS.sendTraceTag(537163285,0,50,"Open data validation edit dialog - NOT first time in session"):(e.ULS.sendTraceTag(23667778,0,50,"Open data validation edit dialog - FIRST time in session"),
this.lOe=!0);return x.Task.Sa(!0)}wc(X,R){return-1728432249===R.command||739109630===R.command}Nc(){return!1}getDataValidationInitialState(X=null){const R=this.$.oa.xa.Wb(),wa=739109630===X;k.a(this.$.userOperationManager,(na,Ba,Ra)=>n.g(this.$.oa.xa,this.selectedRanges,u.b(na,wa?this.kTi:this.lTi),u.a(Ba),Ra,R),na=>new t.a(120,0,na,16),null)}wDf(X){e.ULS.sendTraceTag(537163284,0,50,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback");!X||w.a(X)?e.ULS.sendTraceTag(537163283,
0,10,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback, failed to get expected results."):this.iia=X.Result}eOf(X=!1){var R=this.Ay={};let wa;switch(this.iia.Command){case 0:wa="CreateNew";break;case 1:wa="CreateNewFromRule";break;case 2:wa="ExpandExisting";break;case 3:wa="OverrideExisting";break;default:wa="Unknown"}R.a=wa;this.Sh&&(this.Sh.stop(),this.Ay.r=this.Sh.id);switch(this.iia.Command){case 0:this.Ay.b=!1;this.Ay.c="None";this.K$(new z(null,X));break;case 1:this.Ay.b=
!1;this.Ay.c="None";X&&this.iia&&3!==this.iia.RuleType?this.D1a.eHe(this.$,this.kLf):this.K$(new z(this.iia,!1));break;case 2:this.Ay.b=!0;X?this.D1a.rbh(this.$,this.uEh):this.D1a.sbh(this.$,this.tEh);break;case 3:this.Ay.b=!0;X?this.D1a.eHe(this.$,this.kLf):this.D1a.ubh(this.$,this.n3i);break;default:e.ULS.sendTraceTag(537163282,0,10,"DataValidationEditCommandHandler.PrepareUserDialog, unexpected command type.")}}K$(X){this.D1a.K$(this.$,this.selectedRanges,X,this.iia.Command);this.NEi(X)}NEi(X){B.Gtb(X,
this.Ay);this.Ay.d=!0;C.b().Se(48,this.Ay,!0)}gmc(){this.Ay.d=!1;C.b().Se(48,this.Ay,!0)}Hz(X,R){X={["ButtonType"]:B.NY(R),["DialogName"]:X,["Location"]:"dialog",["NumberOfSelectedRanges"]:y.h(this.$).ha.qa.gD};v.b(this.$).rd(h.a.Dtb,X)}static Gtb(X,R){R.e=d(X.ruleType);R.f=f(X.wB);R.g=!!X.DN;R.h=!!X.EN;R.i=X.S4;R.j=X.T4;R.k=X.g5;R.l=!!X.aF;R.m=!!X.aV;R.n=X.f5;R.o=X.LZ;R.p=!!X.uT;R.q=!!X.tT}static NY(X){switch(X){case 1:return"Yes";case 2:return"No";case 0:return"Cancel";default:return e.ULS.shipAssertTag(537163281,
0,!1,"DataValidationEditCommandHandler.DialogButtonToString: Unknown DialogButton"),"Unknown"}}}Object(r.a)(B,"DataValidationEditCommandHandler",null,[222]);var H=a(135),I=a(814),U;(function(X){X[X.between=0]="between";X[X.notBetween=1]="notBetween";X[X.equal=2]="equal";X[X.notEqual=3]="notEqual";X[X.greaterThan=4]="greaterThan";X[X.lessThan=5]="lessThan";X[X.greaterThanOrEqual=6]="greaterThanOrEqual";X[X.lessThanOrEqual=7]="lessThanOrEqual"})(U||(U={}));Object(r.b)("DataValidationRuleConditionType",
U);var S=a(1105),G=a(150),D=a(190);class E{static get og(){return G.a.zq(E.Ll,"")}static get TLe(){return G.a.zq(E.Emh,D.a.ga(1669),D.a.ga(1684),D.a.ga(1685),D.a.ga(1686),D.a.ga(1687),D.a.ga(1688),D.a.ga(1689),D.a.ga(1690),D.a.ga(1691),D.a.ga(1670),D.a.ga(1694),D.a.ga(1695),D.a.ga(1696),D.a.ga(1697),D.a.ga(1698),D.a.ga(1699),D.a.ga(1700),D.a.ga(1701),D.a.ga(1671),D.a.ga(1672),D.a.ga(1692),D.a.ga(1693),D.a.ga(1683),"255")}static get XLe(){return G.a.zq(E.Fmh,D.a.ga(1706),D.a.ga(1710),D.a.ga(1711),
"255","32")}static get $Le(){return G.a.zq(E.Gmh,D.a.ga(1705),D.a.ga(1708),D.a.ga(1707),D.a.ga(1709),D.a.ga(1710),D.a.ga(1711),"255","32")}}E.seg=255;E.Ll="<div class='WACDialogRow' id='dataValidationTabsId'> </div> <div class='DataValidationEditErrorMessage WACDialogRowNoBreak' id='ErrorContainer'> <label id='validationErrorMessageId' class='WACDialogLabel' role='alert' >{0}</label> </div>";E.Emh="<div class='DataValidationEditTabContent' id='ConditionDivID'> <div class='DataValidationRow' id='allowConditionRow'> <label id='allowConditionSelectionLabelId' class='DataValidationEditElementLabel' for='allowConditionSelectionId'>{0}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='allowConditionSelectionId'> <option value='0'>{1}</option> <option value='1'>{2}</option> <option value='2'>{3}</option> <option value='3'>{4}</option> <option value='4'>{5}</option> <option value='5'>{6}</option> <option value='6'>{7}</option> <option value='7'>{8}</option> </select> </div> <div class='DataValidationRow' id='operatorSelectionDivId'> <label id='operatorSelectionLabelId' class='DataValidationEditElementLabel' for='operatorSelectionId'>{9}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='operatorSelectionId'> <option value='0'>{10}</option> <option value='1'>{11}</option> <option value='2'>{12}</option> <option value='3'>{13}</option> <option value='4'>{14}</option> <option value='5'>{15}</option> <option value='6'>{16}</option> <option value='7'>{17}</option> </select> </div> <div class='DataValidationRow' id='operatorInputDivId1'> <label id='operatorInputLableId1' class='DataValidationEditElementLabel' for='operatorInputId1'>{18}</label> <input type='text' id='operatorInputId1' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='operatorInputDivId2'> <label id='operatorInputLableId2' class='DataValidationEditElementLabel' for='operatorInputId2'>{19}</label> <input type='text' id='operatorInputId2' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationNonBorderRow' id='listDescriptionDivId'> <div id='listDescriptionDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='listDescriptionSubDivID'> <label id='listDescriptionLabelId' class='DataValidationEditLabel' for='listDescriptionSubDivID'>{20}</label> </div> </div> <div class='DataValidationNonBorderRow' id='ignoreBlankCheckboxDivID'> <div id='ignoreBlankCheckboxDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='ignoreBlankCheckboxSubDivID'> <input type='checkbox' id='ignoreBlankCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{21}'></input> <label id='\"\"' class='WACDialogLabel' for='ignoreBlankCheckBoxId' >{21}</label> </div> </div> <div class='DataValidationNonBorderRow' id='inCellDropdownDivId'> <div id='inCellDropdownDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='inCellDropdownSubDivId'> <input type='checkbox' id='inCellDropdownCheckboxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{22}'></input> <label id='\"\"' class='WACDialogLabel' for='inCellDropdownCheckboxId' >{22}</label> </div> </div> </div>";
E.Fmh="<div class='DataValidationEditTabContent' id='inputDivID'> <div class='DataValidationNonBorderRow' id='inputMessageCheckBoxDivID'> <label id='showInputCheckBoxLabelId' class='DataValidationEditElementLabel' for='showInputCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='inputMessageCheckBoxSubDivID'> <input type='checkbox' id='showInputCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='inputTitleDivID'> <label id='inputTitleLabelId' class='DataValidationEditElementLabel' for='textForInputTitleId'>{1}</label> <input type='text' id='textForInputTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={4} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='inputMessageDivID'> <label id='inputMessageLabelId' class='DataValidationEditElementLabel' for='textForInputMessageId'>{2}</label> <textarea id='textForInputMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={3} autocomplete=\"off\"></textarea> </div> </div>";
E.Gmh="<div class='DataValidationEditTabContent' id='alertDivID'> <div class='DataValidationNonBorderRow' id='showAlertCheckBoxDivID'> <label id='showAlertCheckBoxLabelId' class='DataValidationEditElementLabel' for='showAlertCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='showAlertCheckBoxSubDivID'> <input type='checkbox' id='showAlertCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='blockWarnRadioDivID'> <label id='blockWarnRadioLabelId' class='DataValidationEditElementLabel' for='blockWarnRadioSubDivID'>{1}</label> <div class='DataValidationEditRadio DataValidationEditNoBorderElement' id='blockWarnRadioSubDivID'> <input type='radio' id='blockingId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{2}' title='{2}'></input> <label id='blockingId' class='WACDialogLabel' for='blockingId' >{2}</label> <input type='radio' id='warningId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{3}' title='{3}'></input> <label id='blockingId' class='WACDialogLabel' for='warningId' >{3}</label> </div> </div> <div class='DataValidationRow' id='alertTitleDivID'> <label id='alertTitleLabelId' class='DataValidationEditElementLabel' for='textForAlertTitleId'>{4}</label> <input type='text' id='textForAlertTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={7} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='alertMessageDivID'> <label id='alertMessageLabelId' class='DataValidationEditElementLabel' for='textForAlertMessageId'>{5}</label> <textarea id='textForAlertMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={6} autocomplete=\"off\"></textarea> </div> </div>";
Object(r.a)(E,"DataValidationEditDialogHtml",null,[]);var N=a(86),M=a(554),L=a(14),aa=a(192),V=a(239),P=a(12),ba=a(13),Y=a(1);class Z extends V.a{constructor(X,R,wa,na){super(R);this.jFd=this.Wqc=this.wPa=this.eab=this.PNa=this.$5a=this.Zya=this.Yya=this.BK=this.vT=this.Ufc=this.lwa=null;this.lIh=[[12,12,12,12,12,12,12,12],[0,0,2,2,0,1,0,1],[0,0,2,2,0,1,0,1],[3,3,3,3,3,3,3,3],[5,5,7,7,5,6,5,6],[8,8,10,10,8,9,8,9],[0,0,11,11,0,1,0,1],[4,4,4,4,4,4,4,4]];this.kuj=[[12,12],[1,1],[1,1],[12,12],[6,6],[9,
9],[1,1],[12,12]];this.ypc=Ba=>{let Ra=!1;(null===Ba||void 0===Ba?0:Ba.Ea)&&(Ba.Ea.keyCode===N.a.Kea||Ba.Ea.keyCode===N.a.Lh)&&(Ra=this.Eca(Ba),this.vT.blur(),this.BK.blur());return Ra};this.Eca=()=>{const Ba=this.vT.selectedIndex,Ra=this.BK.selectedIndex;this.Wqc.innerText=this.Zwb(Ba,Ra);this.jFd.innerText=this.Nid(Ba,Ra);switch(Ba){case 0:return this.BK.disabled=!0,P.DOMElementExtensions.setVisible(this.eab,!1),P.DOMElementExtensions.setVisible(this.wPa,!1),P.DOMElementExtensions.setVisible(this.$5a,
!1),P.DOMElementExtensions.setVisible(this.PNa,!1),this.lwa.disabled=!0,!1;case 3:return this.BK.disabled=!0,P.DOMElementExtensions.setVisible(this.eab,!0),P.DOMElementExtensions.setVisible(this.wPa,!1),P.DOMElementExtensions.setVisible(this.$5a,!0),P.DOMElementExtensions.setVisible(this.PNa,!0),this.lwa.disabled=!1;case 7:return this.BK.disabled=!0,P.DOMElementExtensions.setVisible(this.eab,!0),P.DOMElementExtensions.setVisible(this.wPa,!1),P.DOMElementExtensions.setVisible(this.$5a,!1),P.DOMElementExtensions.setVisible(this.PNa,
!1),this.lwa.disabled=!1;default:this.lwa.disabled=!1,P.DOMElementExtensions.setVisible(this.eab,!0),P.DOMElementExtensions.setVisible(this.PNa,!1)}switch(Ra){case 0:case 1:P.DOMElementExtensions.setVisible(this.wPa,!0);break;default:P.DOMElementExtensions.setVisible(this.wPa,!1)}this.BK.disabled=!1;this.Wqc.disabled=!1;P.DOMElementExtensions.setVisible(this.$5a,!1);P.DOMElementExtensions.setVisible(this.PNa,!1);return!1};this.get_visible=this.Uja;this.set_visible=this.Mna;this.WQ=new aa.a;this.WQ.add(ba.a.instance.ga(1671));
this.WQ.add(ba.a.instance.ga(1672));this.WQ.add(ba.a.instance.ga(1675));this.WQ.add(ba.a.instance.ga(1673));this.WQ.add(ba.a.instance.ga(1674));this.WQ.add(ba.a.instance.ga(1676));this.WQ.add(ba.a.instance.ga(1677));this.WQ.add(ba.a.instance.ga(1678));this.WQ.add(ba.a.instance.ga(1679));this.WQ.add(ba.a.instance.ga(1680));this.WQ.add(ba.a.instance.ga(1681));this.WQ.add(ba.a.instance.ga(1682));this.WQ.add("");this.$=X;this.Jk=wa;this.pka(na)}get title(){return ba.a.instance.ga(1702)}get C8g(){return this.vT.selectedIndex}DAa(X){this.vT.selectedIndex=
X.ruleType;this.BK.selectedIndex=X.wB;this.Ufc.checked=X.T4;this.lwa.checked=X.S4;this.Yya.value=X.DN;this.Zya.value=X.EN;this.Eca(null)}Bqb(X){X.S4=this.lwa.checked;X.T4=this.Ufc.checked;X.wB=this.BK.selectedIndex;X.ruleType=this.vT.selectedIndex;X.DN=this.Yya.value;X.EN=this.Zya.value}dispose(){this.Sj();this.Jk=this.jFd=this.Wqc=this.wPa=this.eab=this.PNa=this.$5a=this.Ufc=this.Zya=this.Yya=this.BK=this.vT=this.lwa=null;super.dispose()}render(X){X.appendChild(this.domElement)}Uja(){return this.isVisible}Mna(X){return this.isVisible=
X}setFocus(){}Zwb(X,R){return this.z5e(X,R,this.lIh)}Nid(X,R){return 0!==R&&1!==R?"":this.z5e(X,R,this.kuj)}pka(X){Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7126092_ReduceInnerHTMLUsageForDataValidationEditConditionsControl")?X.Rh(this.domElement,E.TLe):this.domElement.innerHTML=E.TLe;this.lwa=P.DOMElementExtensions.getElementById(this.domElement,"ignoreBlankCheckBoxId");this.vT=P.DOMElementExtensions.getElementById(this.domElement,
"allowConditionSelectionId");this.BK=P.DOMElementExtensions.getElementById(this.domElement,"operatorSelectionId");this.Yya=P.DOMElementExtensions.getElementById(this.domElement,"operatorInputId1");this.Zya=P.DOMElementExtensions.getElementById(this.domElement,"operatorInputId2");this.Wqc=P.DOMElementExtensions.getElementById(this.domElement,"operatorInputLableId1");this.jFd=P.DOMElementExtensions.getElementById(this.domElement,"operatorInputLableId2");this.$5a=P.DOMElementExtensions.getElementById(this.domElement,
"inCellDropdownDivId");this.PNa=P.DOMElementExtensions.getElementById(this.domElement,"listDescriptionDivId");this.eab=P.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId1");this.wPa=P.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId2");this.Ufc=P.DOMElementExtensions.getElementById(this.domElement,"inCellDropdownCheckboxId");this.Aj()}z5e(X,R,wa){return wa.length<X||wa[X].length<R?(e.ULS.sendTraceTag(537163280,0,10,`DataValidationEditDialog.GetOperatorLabel: wrong parameters conditionOption=${X} operatorOption=${R}, cannot get label.`),
""):this.WQ.ma(wa[X][R])}Aj(){M.a.instance.ta(L.a.Sb,this.vT,this.ypc);M.a.instance.ta(L.a.Sb,this.BK,this.ypc);M.a.instance.ta(L.a.change,this.vT,this.Eca);M.a.instance.ta(L.a.change,this.BK,this.Eca);M.a.instance.ta(L.a.change,this.BK,this.Jk);M.a.instance.ta(L.a.change,this.vT,this.Jk);M.a.instance.ta(L.a.change,this.Yya,this.Jk);M.a.instance.ta(L.a.Sb,this.Yya,this.Jk);M.a.instance.ta(L.a.change,this.Zya,this.Jk);M.a.instance.ta(L.a.Sb,this.Zya,this.Jk)}Sj(){M.a.instance.Ba(L.a.Sb,this.vT,this.ypc);
M.a.instance.Ba(L.a.Sb,this.BK,this.ypc);M.a.instance.Ba(L.a.change,this.vT,this.Eca);M.a.instance.Ba(L.a.change,this.BK,this.Eca);M.a.instance.Ba(L.a.change,this.BK,this.Jk);M.a.instance.Ba(L.a.change,this.vT,this.Jk);M.a.instance.Ba(L.a.change,this.Yya,this.Jk);M.a.instance.Ba(L.a.Sb,this.Yya,this.Jk);M.a.instance.Ba(L.a.change,this.Zya,this.Jk);M.a.instance.Ba(L.a.Sb,this.Zya,this.Jk)}static rja(){let X;return X=new aa.a,X.add("operatorInputId1"),X.add("operatorInputId2"),X}}Object(r.a)(Z,"DataValidationEditConditionsControl",
V.a,[370,2,616]);var ea=a(60);const ra=(X,R,wa,na,Ba,Ra,qa,La=null)=>{La=X.Na(9,La);La.selectedRanges=R;La.ruleOptions=wa;return ea.g(X,"CreateOrEditDataValidation",La,na,Ba,Ra,qa,0)};var O=a(29),da=a(22),xa=a(177),ia=a(33);class Ma extends I.a{constructor(X,R,wa,na){super(X);this.UPd=this.wvb=null;this.sNa=this.disposed=this.Dka=!1;this.Sh=null;this.R4j=(Ba,Ra)=>{let qa;this.gcc(Ba);if(({errorString:Ba,xq:qa}=this.A1d()).returnValue)return this.YLa(121,this.dTh(this.$,Ra),0,this.Cba,!1),"";this.vla("OkInvalidByClient",
qa);return Ba};this.E7c=Ba=>{this.Hz(Ba,Ma.NY(Ba));this.Sh=this.$.Jb.Gc("UserAction","DataValidationEditTimeToDialogTryClose");0===Ba&&this.cma()};this.selectedRanges=R;this.lTb=wa;this.command=na;3===na&&(this.Dka=!0);this.Ob=2;this.ax=!1}get yd(){return this.lTb}get kc(){return"DataValidationEditDialog"}rVd(){var X={["RuleType"]:this.yd.ruleType,["RuleOperatorType"]:this.yd.wB,["OperatorInput1"]:this.yd.DN,["OperatorInput2"]:this.yd.EN,["IsIgnoreBlank"]:this.yd.S4,["IsInCellDropDown"]:this.yd.T4,
["IsAlertBlocking"]:this.yd.LZ,["AlertTitle"]:this.yd.uT,["AlertMessage"]:this.yd.tT,["InputTitle"]:this.yd.aF,["InputMessage"]:this.yd.aV,["IsShowErrorAlert"]:this.yd.f5,["IsShowInputMessage"]:this.yd.g5};this.tc(2,ba.a.instance.ga(1668));X={[Ma.it]:this.kc,["validateDialogValues"]:this.R4j,["RangePickerController"]:y.h(this.$).Gg.Rxb(),["isModal"]:!1,["bodyProps"]:X};this.initializeAndShow(ba.a.instance.ga(1667),this.E7c,X);e.ULS.sendTraceTag(537163278,0,50,"DataValidationEditDialog dialog opened.")}dispose(){this.disposed||
(super.dispose(),this.disposed=!0)}get p3b(){return 3===this.yd.ruleType}rja(){return Z.rja()}dTh(X,R){return(wa,na,Ba)=>{const Ra=X.oa.xa.Wb();return ra(this.$.oa.xa,this.selectedRanges,this.ZYg(),this.h0a(wa,this.LCd(R)),u.a(na),Ba,Ra)}}LCd(X){return R=>{e.ULS.sendTraceTag(537163277,0,50,"DataValidationEditDialog.OnDataValidationEditSuccessCallback");let wa;w.a(R)?(e.ULS.sendTraceTag(537163276,0,15,`DataValidationEditDialog.OnDataValidationEditSuccessCallback - request has expected errors: ${R?
O.a.nc(R.Errors):null}.`),R.Errors&&1===R.Errors.length&&((wa=this.Vfd(R.Errors[0].MessageId))?this.vla("OkInvalidByServer",R.Errors[0].MessageIdName):(this.vla("OkValid","None"),this.hide()),X(wa)),e.ULS.sendTraceTag(537163275,0,15,`DataValidationEditDialog.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: ${O.a.nc(R.Errors)}`)):this.hide()}}ZYg(){const X={};X.Command=this.command;X.RuleType=this.yd.ruleType;X.ConditionType=this.yd.wB;X.IsIgnoreBlank=this.yd.S4;X.IsInCellDropDown=
this.yd.T4;X.LowerBoundary=this.yd.DN;X.UpperBoundary=this.yd.EN;X.IsAlertBlocking=this.yd.LZ;X.IsShowErrorAlert=this.yd.f5;X.IsShowInputMessage=this.yd.g5;X.AlertTitle=this.yd.uT;X.AlertMessage=this.yd.tT;X.InputTitle=this.yd.aF;X.InputMessage=this.yd.aV;X.ShouldIgnoreFormulaError=this.sNa;return X}Vfd(X){switch(X){case 1173235830:return ba.a.instance.ga(1720);case 43935303:return ba.a.instance.ga(1721);case -1323438439:return ba.a.instance.ga(1723);case 2112020473:return ba.a.instance.ga(1717);
case -219503282:return ba.a.instance.ga(1718);case 1689335445:return ba.a.instance.ga(1719);case 2146493810:return ba.a.instance.ga(1722);case -2104909922:return String.format(ba.a.instance.ob(105),this.wvb,this.UPd);case -869372599:return String.format(ba.a.instance.ob(104),this.wvb);case -885132625:return ba.a.instance.ga(1715);case -1181828368:return ba.a.instance.ga(1725);case -758480861:return ba.a.instance.ga(1726);case -13729088:return ba.a.instance.ga(1727);case -846654055:return ba.a.instance.ga(1728);
case 751854001:return ba.a.instance.ga(1729);case -453846397:return ba.a.instance.ga(1730);case 1102013489:return ba.a.instance.ga(1731);case 835813260:return ia.a.hrd()?ba.a.instance.ga(1733):ba.a.instance.ga(1732);case 1577787509:return ba.a.instance.ga(1734);case 2083564019:return ba.a.instance.ga(1724);default:e.ULS.sendTraceTag(537163274,0,15,`DataValidationEditDialog.GetDataValidationServerErrorString - unexpected error: ${X.toString()}.`)}return null}cma(){this.vla("Cancel","None")}Hz(X,R){e.ULS.sendTraceTag(537163273,
0,50,`DataValidationEditDialog ${1===X?"Ok":"Cancel"} was clicked.`);X={["ButtonType"]:R,["DialogName"]:this.kc,["Location"]:"dialog",["NumberOfSelectedRanges"]:y.h(this.$).ha.qa.gD};v.b(this.$).rd(h.a.Dtb,X)}vla(X,R){const wa={};Ma.Gtb(this.yd,wa);wa.o=X;wa.p=R;wa.n=this.Dka;this.Sh&&(this.Sh.stop(),wa.q=this.Sh.id);C.b().Se(49,wa,!0)}gcc(X){this.yd.ruleType=X.RuleType;this.yd.wB=X.RuleOperatorType;this.yd.DN=X.OperatorInput1;this.yd.EN=X.OperatorInput2;this.yd.LZ=X.IsAlertBlocking;this.yd.f5=X.IsShowErrorAlert;
this.yd.uT=X.AlertTitle;this.yd.tT=X.AlertMessage;this.yd.g5=X.IsShowInputMessage;this.yd.aF=X.InputTitle;this.yd.aV=X.InputMessage;this.yd.S4=X.IsIgnoreBlank;this.yd.T4=X.IsInCellDropDown;this.wvb=X.firstOperatorLabel;this.UPd=X.secondOperatorLabel}FQb(X,R,wa){let na,Ba;Ba=na=null;if(!X)return wa?(na=String.format(ba.a.instance.ob(105),this.wvb,this.UPd),Ba="DataValidationEditNoMinMaxError"):ia.a.hrd()&&3===R?(na=ba.a.instance.ga(1715),Ba="DataValidationEditNoValueListError"):(na=String.format(ba.a.instance.ob(104),
this.wvb),Ba="DataValidationEditNoValueError"),{returnValue:!1,errorString:na,xq:Ba};if(X.length>E.seg)return na=ba.a.instance.ga(1724),{returnValue:!1,errorString:na,xq:Ba};if(xa.d(X))return{returnValue:!0,errorString:na,xq:Ba};if(1===R||2===R||6===R){if(!da.a.Y4(X))return na=ba.a.instance.ga(1717),{returnValue:!1,errorString:na,xq:Ba};if(1===R&&!da.a.isInteger(X))return na=ba.a.instance.ga(1718),{returnValue:!1,errorString:na,xq:Ba};if(6===R){if(!da.a.isInteger(X))return na=ba.a.instance.ga(1718),
{returnValue:!1,errorString:na,xq:Ba};if(0>parseInt(X,10))return na=ba.a.instance.ga(1719),{returnValue:!1,errorString:na,xq:Ba}}}return{returnValue:!0,errorString:na,xq:Ba}}A1d(){let X,R;R=X=null;const wa=this.yd.DN,na=this.yd.EN,Ba=S.a[this.yd.ruleType];var Ra=U[this.yd.wB];if(0===Ba)return{returnValue:!0,errorString:X,xq:R};Ra=(0===Ra||1===Ra)&&3!==Ba&&7!==Ba;return!({errorString:X,xq:R}=this.FQb(wa,Ba,Ra)).returnValue||Ra&&!({errorString:X,xq:R}=this.FQb(na,Ba,Ra)).returnValue?{returnValue:!1,
errorString:X,xq:R}:Ra&&(1===Ba||2===Ba||6===Ba)&&!xa.d(wa)&&!xa.d(na)&&parseFloat(wa)>parseFloat(na)?(X=ba.a.instance.ga(1722),{returnValue:!1,errorString:X,xq:"DataValidationEditMaximumLessMinimumError"}):{returnValue:!0,errorString:X,xq:R}}static NY(X){switch(X){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return e.ULS.shipAssertTag(537163272,0,!1,"DataValidationEditDialog.DialogButtonToString: Unknown DialogButton"),"Unknown"}}static Gtb(X,R){R.a=d(X.ruleType);R.b=f(X.wB);
R.c=!!X.DN;R.d=!!X.EN;R.e=X.S4;R.f=X.T4;R.g=X.g5;R.h=!!X.aF;R.i=!!X.aV;R.j=X.f5;R.k=X.LZ;R.l=!!X.uT;R.m=!!X.tT}}Object(r.a)(Ma,"DataValidationEditDialog",I.a,[]);var Ta=a(89);I=a(266);class Da{}Da.ojh="DataValidationDialogPanel";Da.njh="DataValidationButtonPanel";Da.mjh="DataValidationButtonClearAll";Object(r.a)(Da,"CssClassNames",null,[]);class fa extends V.a{constructor(X,R,wa){super(X);this.nba=this.oba=this.mba=null;this.Apc=()=>{this.mba.checked?(this.oba.disabled=!1,this.nba.disabled=!1):(this.oba.disabled=
!0,this.nba.disabled=!0);return!1};this.get_visible=this.Uja;this.set_visible=this.Mna;this.Jk=R;this.pka(wa)}get title(){return ba.a.instance.ga(1704)}render(X){X.appendChild(this.domElement)}Uja(){return this.isVisible}Mna(X){return this.isVisible=X}setFocus(){}dispose(){this.Sj();this.Jk=this.oba=this.nba=this.mba=null;super.dispose()}pka(X){Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7126093_ReduceInnerHTMLUsageForDataValidationEditInputControl")?
X.Rh(this.domElement,E.XLe):this.domElement.innerHTML=E.XLe;this.mba=P.DOMElementExtensions.getElementById(this.domElement,"showInputCheckBoxId");P.DOMElementExtensions.getElementById(this.domElement,"inputMessageDivID");this.oba=P.DOMElementExtensions.getElementById(this.domElement,"textForInputTitleId");this.nba=P.DOMElementExtensions.getElementById(this.domElement,"textForInputMessageId");this.mba.checked=!0;this.Aj();this.Apc(null)}DAa(X){this.oba.value=void 0===X.aF||null===X.aF?"":X.aF;this.nba.value=
void 0===X.aV||null===X.aV?"":X.aV;this.mba.checked=X.g5;this.Apc(null)}Bqb(X){X.aF=this.oba.value;X.aV=this.nba.value;X.g5=this.mba.checked}Aj(){M.a.instance.ta(L.a.change,this.mba,this.Apc);M.a.instance.ta(L.a.change,this.mba,this.Jk);M.a.instance.ta(L.a.change,this.oba,this.Jk);M.a.instance.ta(L.a.Sb,this.oba,this.Jk);M.a.instance.ta(L.a.change,this.nba,this.Jk);M.a.instance.ta(L.a.Sb,this.nba,this.Jk)}Sj(){M.a.instance.Ba(L.a.change,this.mba,this.Apc);M.a.instance.Ba(L.a.change,this.mba,this.Jk);
M.a.instance.Ba(L.a.change,this.oba,this.Jk);M.a.instance.Ba(L.a.Sb,this.oba,this.Jk);M.a.instance.Ba(L.a.change,this.nba,this.Jk);M.a.instance.Ba(L.a.Sb,this.nba,this.Jk)}}Object(r.a)(fa,"DataValidationEditInputControl",V.a,[370,2,622]);class ua extends V.a{constructor(X,R,wa){super(X);this.J9=this.K9=this.EUa=this.eha=this.I9=null;this.zpc=()=>{this.I9.checked?(this.eha.disabled=!1,this.EUa.disabled=!1,this.K9.disabled=!1,this.J9.disabled=!1):(this.eha.disabled=!0,this.EUa.disabled=!0,this.K9.disabled=
!0,this.J9.disabled=!0);return!1};this.get_visible=this.Uja;this.set_visible=this.Mna;this.Jk=R;this.pka(wa)}get title(){return ba.a.instance.ga(1703)}render(X){X.appendChild(this.domElement)}Uja(){return this.isVisible}Mna(X){return this.isVisible=X}setFocus(){}dispose(){this.Sj();this.Jk=this.K9=this.J9=this.EUa=this.eha=this.I9=null;super.dispose()}pka(X){Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7126094_ReduceInnerHTMLUsageForDataValidationEditMessagesControl")?
X.Rh(this.domElement,E.$Le):this.domElement.innerHTML=E.$Le;this.I9=P.DOMElementExtensions.getElementById(this.domElement,"showAlertCheckBoxId");this.eha=P.DOMElementExtensions.getElementById(this.domElement,"blockingId");this.EUa=P.DOMElementExtensions.getElementById(this.domElement,"warningId");this.K9=P.DOMElementExtensions.getElementById(this.domElement,"textForAlertTitleId");this.J9=P.DOMElementExtensions.getElementById(this.domElement,"textForAlertMessageId");this.I9.checked=!0;this.eha.checked=
!0;this.Aj();this.zpc(null)}DAa(X){this.eha.checked=X.LZ;this.EUa.checked=!X.LZ;this.K9.value=void 0===X.uT||null===X.uT?"":X.uT;this.J9.value=void 0===X.tT||null===X.tT?"":X.tT;this.I9.checked=X.f5;this.zpc(null)}Bqb(X){X.uT=this.K9.value;X.tT=this.J9.value;X.LZ=this.eha.checked;X.f5=this.I9.checked}Aj(){M.a.instance.ta(L.a.change,this.I9,this.zpc);M.a.instance.ta(L.a.change,this.I9,this.Jk);M.a.instance.ta(L.a.change,this.eha,this.Jk);M.a.instance.ta(L.a.change,this.EUa,this.Jk);M.a.instance.ta(L.a.change,
this.K9,this.Jk);M.a.instance.ta(L.a.Sb,this.K9,this.Jk);M.a.instance.ta(L.a.change,this.J9,this.Jk);M.a.instance.ta(L.a.Sb,this.J9,this.Jk)}Sj(){M.a.instance.Ba(L.a.change,this.I9,this.zpc);M.a.instance.Ba(L.a.change,this.I9,this.Jk);M.a.instance.ta(L.a.change,this.eha,this.Jk);M.a.instance.ta(L.a.change,this.EUa,this.Jk);M.a.instance.Ba(L.a.change,this.K9,this.Jk);M.a.instance.Ba(L.a.Sb,this.K9,this.Jk);M.a.instance.Ba(L.a.change,this.J9,this.Jk);M.a.instance.Ba(L.a.Sb,this.J9,this.Jk)}}Object(r.a)(ua,
"DataValidationEditMessagesControl",V.a,[370,2,615]);class Fa{constructor(X,R){this.options=this.cellRange=null;this.cellRange=X;this.options=R}}Object(r.a)(Fa,"MacroRecorderRangeDataValidationChangedPayload",null,[162]);var ca=a(1261);class ka extends I.a{constructor(X,R,wa,na,Ba){super(X);this.Z2=this.ugc=this.knc=this.ZEb=null;this.sNa=this.disposed=this.Dka=!1;this.htmlSanitizationHelper=this.Sh=null;this.LCd=Ra=>{e.ULS.sendTraceTag(537163269,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback");
if(this.disposed)e.ULS.sendTraceTag(537163268,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback: Callback not handled since dialog was already disposed");else{if(w.a(Ra)){e.ULS.sendTraceTag(537163267,0,15,`DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - request has expected errors: ${Ra?O.a.nc(Ra.Errors):null}.`);if(Ra.Errors&&1===Ra.Errors.length){const qa=Ra.Errors[0].MessageId,La=this.Vfd(qa);if(La){this.CHj(qa)?this.BCj(La):this.Jt(La);this.vla("OkInvalidByServer",
Ra.Errors[0].MessageIdName);return}}e.ULS.sendTraceTag(537163266,0,15,`DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: ${O.a.nc(Ra.Errors)}`)}this.vla("OkValid","None");this.hide()}};this.E7c=Ra=>{this.Hz(Ra,ka.NY(Ra));2!==Ra&&(this.Sh=this.$.Jb.Gc("UserAction","DataValidationEditTimeToDialogTryClose"));1===Ra?this.N$a():2===Ra?this.Bya():this.cma()};this.Eca=()=>{this.n_j();this.sNa?this.bDe():this.JCe();return this.Dka=!1};this.selectedRanges=
R;this.lTb=wa;this.command=na;this.htmlSanitizationHelper=Ba;3===na&&(this.Dka=!0);this.Ob=2;this.ax=!1;this.og=E.og}get yd(){return this.lTb}get kc(){return"DataValidationEditDialog"}rVd(){const X={["key"]:this.yd};this.initializeAndShow(ba.a.instance.ga(1667),this.E7c,X);e.ULS.sendTraceTag(537163271,0,50,"DataValidationEditDialogDeprecated dialog opened.")}dispose(){this.disposed||(this.ugc=this.knc=this.Z2=null,Ta.a.Ja(this.ZEb),this.ZEb=null,v.b(this.$)&&v.b(this.$).ZAc("DataValidationDialogCorellation"),
super.dispose(),this.disposed=!0)}get jD(){return()=>{this.Hz(1,ka.NY(1));this.N$a()}}ry(X){super.ry(X);this.tc(2,ba.a.instance.ga(1668));X=this.KJ(2);var R=this.KJ(1),wa=this.KJ(0),na=R.parentNode;na.appendChild(X);na.appendChild(R);na.appendChild(wa);X.parentNode.classList.add(Da.njh);X.classList.add(Da.mjh);X=document.getElementById("dataValidationTabsId");R=new Z(this.$,document.createElement("div"),this.Eca,this.htmlSanitizationHelper);wa=new fa(document.createElement("div"),this.Eca,this.htmlSanitizationHelper);
na=new ua(document.createElement("div"),this.Eca,this.htmlSanitizationHelper);this.Eii(R,wa,na);let Ba;this.ZEb=new ca.a(X,(Ba=new aa.a,Ba.add(R),Ba.add(wa),Ba.add(na),Ba));this.ZEb.mXf();this.ZP=document.getElementById("validationErrorMessageId");this.DAa();v.b(this.$)&&v.b(this.$).NAc("DataValidationDialogCorellation")}CD(){super.CD();document.getElementById(this.Fh("WACDialogPanel")).classList.add(Da.ojh)}get qY(){return!1}get p3b(){return 3===this.Z2.C8g}rja(){return Z.rja()}mgd(){return"validationErrorMessageId"}Eii(X,
R,wa){this.Z2=X;this.ugc=R;this.knc=wa}kvj(){const X={};X.IsClearAll=this.Dka;X.Command=this.command;X.RuleType=this.yd.ruleType;X.ConditionType=this.yd.wB;X.IsIgnoreBlank=this.yd.S4;X.IsInCellDropDown=this.yd.T4;X.LowerBoundary=this.yd.DN;X.UpperBoundary=this.yd.EN;X.IsAlertBlocking=this.yd.LZ;X.IsShowErrorAlert=this.yd.f5;X.IsShowInputMessage=this.yd.g5;X.AlertTitle=this.yd.uT;X.AlertMessage=this.yd.tT;X.InputTitle=this.yd.aF;X.InputMessage=this.yd.aV;X.ShouldIgnoreFormulaError=this.sNa;const R=
this.$.oa.xa.Wb(),wa=()=>new Fa(this.selectedRanges,X);k.a(this.$.userOperationManager,(na,Ba,Ra)=>ra(this.$.oa.xa,this.selectedRanges,X,u.b(na,this.LCd),u.a(Ba),Ra,R),na=>new t.a(121,0,na,void 0,wa),null)}CHj(X){return 1577787509===X}BCj(X){this.ZP.innerText=X;this.lI(this.KJ(0));this.sNa=!0}bDe(){this.sNa=!1;this.ZP.innerText=""}Vfd(X){switch(X){case 1173235830:return ba.a.instance.ga(1720);case 43935303:return ba.a.instance.ga(1721);case -1323438439:return ba.a.instance.ga(1723);case 2112020473:return ba.a.instance.ga(1717);
case -219503282:return ba.a.instance.ga(1718);case 1689335445:return ba.a.instance.ga(1719);case 2146493810:return ba.a.instance.ga(1722);case -2104909922:return String.format(ba.a.instance.ob(105),this.Z2.Zwb(this.yd.ruleType,this.yd.wB),this.Z2.Nid(this.yd.ruleType,this.yd.wB));case -869372599:return String.format(ba.a.instance.ob(104),this.Z2.Zwb(this.yd.ruleType,this.yd.wB));case -1181828368:return ba.a.instance.ga(1725);case -758480861:return ba.a.instance.ga(1726);case -13729088:return ba.a.instance.ga(1727);
case -846654055:return ba.a.instance.ga(1728);case 751854001:return ba.a.instance.ga(1729);case -453846397:return ba.a.instance.ga(1730);case 1102013489:return ba.a.instance.ga(1731);case 835813260:return ba.a.instance.ga(1732);case 1577787509:return ba.a.instance.ga(1734);case 2083564019:return ba.a.instance.ga(1724);default:e.ULS.sendTraceTag(537163265,0,15,`DataValidationEditDialogDeprecated.GetDataValidationServerErrorString - unexpected error: ${X.toString()}.`)}return null}N$a(){e.ULS.sendTraceTag(537163264,
0,50,"DataValidationEditDialogDeprecated 'Ok' was clicked.");this.gcc();let X,R;if(!({errorString:X,xq:R}=this.A1d()).returnValue)return this.Jt(X),this.vla("OkInvalidByClient",R),!1;this.kvj();return!0}cma(){this.gcc();this.vla("Cancel","None");this.hide()}Bya(){e.ULS.sendTraceTag(537163235,0,50,"DataValidationEditDialogDeprecated 'ClearAll' was clicked.");this.sNa?this.bDe():this.JCe();this.Eoj();this.Dka=!0}Hz(X,R){X={["ButtonType"]:R,["DialogName"]:this.kc,["Location"]:"dialog",["NumberOfSelectedRanges"]:y.h(this.$).ha.qa.gD};
v.b(this.$).rd(h.a.Dtb,X)}Eoj(){this.lTb=new z;this.DAa()}DAa(){this.knc.DAa(this.yd);this.ugc.DAa(this.yd);this.Z2.DAa(this.yd)}gcc(){this.Z2.Bqb(this.yd);this.knc.Bqb(this.yd);this.ugc.Bqb(this.yd)}vla(X,R){const wa={};ka.Gtb(this.yd,wa);wa.o=X;wa.p=R;wa.n=this.Dka;this.Sh&&(this.Sh.stop(),wa.q=this.Sh.id);C.b().Se(49,wa,!0)}FQb(X,R){let wa,na;na=wa=null;if(!X)return R?(wa=String.format(ba.a.instance.ob(105),this.Z2.Zwb(this.yd.ruleType,this.yd.wB),this.Z2.Nid(this.yd.ruleType,this.yd.wB)),na="DataValidationEditNoMinMaxError"):
(wa=String.format(ba.a.instance.ob(104),this.Z2.Zwb(this.yd.ruleType,this.yd.wB)),na="DataValidationEditNoValueError"),{returnValue:!1,errorString:wa,xq:na};if(X.length>E.seg)return wa=ba.a.instance.ga(1724),{returnValue:!1,errorString:wa,xq:na};if(xa.d(X))return{returnValue:!0,errorString:wa,xq:na};if(1===this.yd.ruleType||2===this.yd.ruleType||6===this.yd.ruleType){if(!da.a.Y4(X))return wa=ba.a.instance.ga(1717),{returnValue:!1,errorString:wa,xq:na};if(1===this.yd.ruleType&&!da.a.isInteger(X))return wa=
ba.a.instance.ga(1718),{returnValue:!1,errorString:wa,xq:na};if(6===this.yd.ruleType){if(!da.a.isInteger(X))return wa=ba.a.instance.ga(1718),{returnValue:!1,errorString:wa,xq:na};if(0>parseInt(X,10))return wa=ba.a.instance.ga(1719),{returnValue:!1,errorString:wa,xq:na}}}return{returnValue:!0,errorString:wa,xq:na}}A1d(){let X,R;R=X=null;if(this.Dka||0===this.yd.ruleType)return{returnValue:!0,errorString:X,xq:R};const wa=(0===this.yd.wB||1===this.yd.wB)&&3!==this.yd.ruleType&&7!==this.yd.ruleType;return!({errorString:X,
xq:R}=this.FQb(this.yd.DN,wa)).returnValue||wa&&!({errorString:X,xq:R}=this.FQb(this.yd.EN,wa)).returnValue?{returnValue:!1,errorString:X,xq:R}:wa&&(1===this.yd.ruleType||2===this.yd.ruleType||6===this.yd.ruleType)&&!xa.d(this.yd.DN)&&!xa.d(this.yd.EN)&&parseFloat(this.yd.DN)>parseFloat(this.yd.EN)?(X=ba.a.instance.ga(1722),{returnValue:!1,errorString:X,xq:"DataValidationEditMaximumLessMinimumError"}):{returnValue:!0,errorString:X,xq:R}}set jD(X){super.jD=X}static NY(X){switch(X){case 0:return"Cancel";
case 1:return"Ok";case 2:return"ClearAll";default:return e.ULS.shipAssertTag(537163234,0,!1,"DataValidationEditDialogDeprecated.DialogButtonToString: Unknown DialogButton"),"Unknown"}}static Gtb(X,R){R.a=d(X.ruleType);R.b=f(X.wB);R.c=!!X.DN;R.d=!!X.EN;R.e=X.S4;R.f=X.T4;R.g=X.g5;R.h=!!X.aF;R.i=!!X.aV;R.j=X.f5;R.k=X.LZ;R.l=!!X.uT;R.m=!!X.tT}}Object(r.a)(ka,"DataValidationEditDialogDeprecated",I.a,[]);class Ca{constructor(X){this.htmlSanitizationHelper=null;this.htmlSanitizationHelper=X}K$(X,R,wa,na){Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataValidationReactDialog",
!1)?(new Ma(X,R,wa,na)).rVd():(new ka(X,R,wa,na,this.htmlSanitizationHelper)).rVd()}sbh(X,R){const wa=new H.StandardDialog;wa.Ob=3;wa.Zna(X.qb.Iaa,ba.a.instance.ga(1712),R)}ubh(X,R){const wa=new H.StandardDialog;wa.Ob=1;wa.YR(X.qb.Iaa,ba.a.instance.ga(1713),R)}rbh(X,R){const wa=new H.StandardDialog;wa.Ob=3;wa.Zna(X.qb.Iaa,ba.a.instance.ga(1714),R)}eHe(X,R){const wa=new H.StandardDialog;wa.Ob=1;wa.YR(X.qb.Iaa,ba.a.instance.ga(1716),R)}}Object(r.a)(Ca,"DataValidationEditDialogFactory",null,[567]);var fb=
a(50),yb=a(37);class mb extends b.a{constructor(X){super(X)}hd(){const X=Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7126077_ReduceInnerHTMLUsageForDataValidationEditConditionsControl")&&!Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataValidationReactDialog",!1)?fb.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Xa):x.Task.Sa(null);yb.TaskExtensions.za(X,()=>{this.$c([new B(this.$,new Ca(X.result))])},this.$.la,
3)}static ka(X){b.a.Md(245,new mb(X))}}Object(r.a)(mb,"DataValidationEditCommandHandlerFactory",b.a,[]);a.d(F,"a",function(){return nb});const nb=()=>{c.a.Fa(mb.ka)}},1177:function(r,F,a){function c(lb,db,Pa,ja,Ka,ub){if(0===ja)return Object(fa.a)(Qa.UnsupportedZeroResize);if(0>ja||0===Pa.length)return Object(fa.a)(Qa.InvalidInput);if(lb.Lbi())return Object(fa.a)(Qa.UnsupportedSkeletonInView);const Kb=lb.Mj("ResizeCSE");if(!Object(Na.c)(Kb))return Object(fa.a)(Qa.NullSPD);var W=Kb.value.M3e(Pa);if(W&&
0<W.length)return Object(fa.a)(W.length.toString()+" "+Qa.UnsupportedHiddenInRange);a:{for(const Sa of Pa)Ka?Sa.right=Z.a.Ug:Sa.bottom=Z.a.Vg;W=lb.O$("EditGridAction.IsMergeCellAcrossBlocksExistInRanges",Pa);try{for(W.$$rst();W.$$mn();)if(W.Nm.MMj){var za=!0;break a}}finally{W&&W.dispose()}za=!1}if(za)return Object(fa.a)(Qa.UnsupportedMergeCell);if(N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase2",!1)&&!Ka&&"undefined"!==typeof gridRenderer)for(const Sa of Pa)gridRenderer.CanvasRendererGlobals.resetColWidthCacheByCol(Sa.left);
lb=lb.Ca;za=Ja.a.create().toString();Kb.value.G0d(Pa,ja,Ka);ub=lb.WZj(Ka,ub);db.Lej(Pa,Ka);lb.zQf(ub,za,Ka?"row":"column");return Object(fa.d)(ja)}var b=a(9);r=a(0);var e=a(226),f=a(7),d=a(15),h=a(89);a(268);var l=a(192),k=a(421),t=a(84),n=a(785),z=a(169),w=a(243),m=a(24),u=a(890),y=a(41);class v{}v.sLh="GalleryGeneral";v.uLh="GalleryNumber";v.qLh="GalleryCurrency";v.oLh="GalleryAccounting";v.xLh="GalleryShortDate";v.tLh="GalleryLongDate";v.zLh="GalleryTime";v.vLh="GalleryPercentage";v.rLh="GalleryFraction";
v.wLh="GalleryScientific";v.yLh="GalleryText";v.l_g="ButtonComma";v.buttonPercentage="ButtonPercentage";v.keyboardNumber="KeyboardNumber";v.keyboardCurrency="KeyboardCurrency";v.keyboardDate="KeyboardDate";v.keyboardTime="KeyboardTime";v.keyboardPercentage="KeyboardPercentage";Object(r.a)(v,"RibbonFormatKind",null,[]);var C=a(60),x=a(296),B=a(624),H=a(623),I=a(622);class U extends x.a{constructor(lb,db,Pa,ja,Ka,ub,Kb,W,za,Sa,Wa,ab=null,ma=null){super(11,0,W,Wa);this.OJh=lb;this.Ndd=db;this.format=
ja;this.activeCell=Pa;this.Tue=Ka;this.RMf=ub;this.MMf=Kb;this.zFa=za;this.clientCorrelationId=Sa;this.Nmb=ab;this.ejb=ma}get Kt(){return this.Nmb}get xaa(){return this.ejb}get OEc(){return this.zFa}D2(lb){return super.D2(lb)||this.OJh.D2(this.Ndd,this.activeCell,this.format,this.Tue,this.RMf,this.MMf,this.B0b,this.zFa,this.clientCorrelationId,this.Nmb,this.ejb)}Vj(){const lb=[];if(this.hec)for(const db of this.hec)lb.push(I.a(db));else lb.push(new H.a(this.format,this.Ndd,this.activeCell));return()=>
new B.a(lb)}Dfb(){const lb={OperationType:0};lb.FormatCellsMultiRange=this.Ndd;lb.ActiveCell=this.activeCell;lb.Format=this.format;lb.ApplyFormatOnPivotTableValueField=this.Tue;lb.PivotTableXluid=this.RMf;lb.PivotTableFieldCaption=this.MMf;return lb}}Object(r.a)(U,"FormatCellsBatchOperation",x.a,[]);var S=a(33),G=a(213);class D{}D.editCell="Edited";D.dependentCell="Dependents";Object(r.a)(D,"RecalcPriorityGroupType",null,[]);var E=a(205),N=a(1);const M=lb=>{switch(lb.alignment){case "Center":return 2;
case "Left":return 1;case "Right":return 3;default:return d.ULS.sendTraceTag(537162194,0,10,"CalcInterfaceAdapter.GetHorizontalAlignmentFromFormattedValue: unknown horizontal alignment!"),0}},L=lb=>{if(lb=lb.color){if("String"===Object.getType(lb).getName())return E.a.Wo(lb);if("Number"===Object.getType(lb).getName())return null}else return null;d.ULS.sendTraceTag(537162193,0,10,"CalcInterfaceAdapter.GetFontColorFromFormattedValue: unknown color type!");return null},aa=(lb,db)=>{lb=excelOnlineCalc.calc.getCellValueKind(lb.rangeDelta.data.value);
switch(lb){case "number":case "string":case "boolean":return!0;case "Blank":return!0;case "Error":if(N.EwaSettings.isChangeGateEnabled("OfficeVSO:7317053_CalcErrorValueTypeSupported"))return!0;db.numberOfUnsupportedErrorCellTypes++;return!1;case "Rich":return db.numberOfUnsupportedRichCellTypes++,!1;default:return d.ULS.shipAssertTag(537162192,0,!1,`CalcInterfaceAdapter.IsCellValueTypeSupported: Unexpected unsupported type ${lb}`),!1}},V=lb=>{lb=excelOnlineCalc.calc.getCellValueKind(lb.rangeDelta.data.value);
let db=0;switch(lb){case "number":db=1;break;case "string":db=2;break;case "boolean":db=3;break;case "Error":db=4;break;case "Blank":db=0;break;default:d.ULS.shipAssertTag(537162191,0,!1,`CalcInterfaceAdapter.GetCellValueType: Unexpected unsupported type ${lb}`)}return db},P=lb=>{const db=lb.value;switch(lb.type){case 2:return void 0===db||null===db?"":db;case 1:return lb=parseFloat(db),isNaN(lb)?null:lb;case 3:return lb=parseFloat(db),isNaN(lb)?null:1===lb;case 4:return lb=parseFloat(db),isNaN(lb)?
null:excelOnlineCalc.calc.errorValue(lb);default:return excelOnlineCalc.calc.blankValue}},ba=(lb,db)=>{const Pa=Y(db);var ja=!(void 0===db.rangeDelta.data.format||null===db.rangeDelta.data.format);d.ULS.shipAssertTag(537162187,0,0===Pa||!ja,`CalcInterfaceAdapter.GetRecalcInferredFormat: Format inference expected for Edited cell only ${db.priorityGroup}`);lb=Math.max(lb.cell.hj,0);ja&&(ja=excelOnlineCalc.calc.getCellFormatKind(db.rangeDelta.data.format.format),"number"===ja?lb=db.rangeDelta.data.format.format:
"string"===ja?d.ULS.sendTraceTag(537162186,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind string"):"Unavailable"===ja?d.ULS.sendTraceTag(537162185,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind unavailable"):d.ULS.shipAssertTag(537162184,0,!1,"CalcInterfaceAdapter.GetRecalcInferredFormat: unknown format kind!"));return lb},Y=lb=>{if(lb.priorityGroup===D.editCell)return 0;if(lb.priorityGroup===D.dependentCell)return 1;d.ULS.sendTraceTag(537162183,0,10,"CalcInterfaceAdapter.GetRecalcPriorityGroup: unknown priority group!");
return 2};var Z=a(8);class ea{constructor(lb=0,db="",Pa=0,ja="",Ka=""){this.oC=lb;this.cellValue=db;this.ifmt=Pa;this.priorityGroup=ja;this.KA=Ka}}Object(r.a)(ea,"RecalcAccuracyObject",null,[]);class ra{}ra.string="String";ra.blank="Blank";ra.general="General";ra.BIh="Flexible";Object(r.a)(ra,"FormattedUnitKind",null,[]);class O{constructor(lb=0,db=0,Pa=0,ja=0,Ka=0,ub=0,Kb=0,W=0,za=0,Sa=0,Wa=0,ab=0,ma=0,ha=0,eb=0,ta=!1,ya="",sb=0,Qb=null,oc=null,kb=null,jb=null,Wb=null,wc=null,Jc=null){this.numberOfDependentRecalcedCellsInBatch=
this.numberOfEditedRecalcedCellsInBatch=this.newProcessingTimeLimit=this.originalProcessingTimeLimit=this.totalExecutionTime=this.numberOfSkippedCellsDueToMissingLocaleInfo=this.numberOfUnsupportedRichCellTypes=this.numberOfUnsupportedBlankCellTypes=this.numberOfUnsupportedErrorCellTypes=this.numberOfCellsWithNoFormattedCell=this.numberOfCellsSkippedDueToTimeout=this.numberOfCellsUpdatedAlreadyByServer=this.numberOfUpdatedCells=this.numberOfNonUpdatedCells=this.totalNumberOfCellsInBatch=0;this.isNewTask=
!1;this.lastSetCellInstantaneousOperation=null;this.taskId=0;this.numberOfHashFormattedValues=this.numberOfMeasureTextWidthCalls=this.newNumberFormatterFinalizeFailures=this.totalNumberFormatterTime=this.numberOfRecalcedCellsWithoutFormattedValue=this.numberOfRecalcedCellsWithFormattedValue=this.isNewNumberFormatter=null;this.totalNumberOfCellsInBatch=lb;this.numberOfNonUpdatedCells=db;this.numberOfUpdatedCells=Pa;this.numberOfCellsUpdatedAlreadyByServer=ja;this.numberOfCellsSkippedDueToTimeout=Ka;
this.numberOfCellsWithNoFormattedCell=ub;this.numberOfUnsupportedErrorCellTypes=Kb;this.numberOfUnsupportedBlankCellTypes=W;this.numberOfUnsupportedRichCellTypes=za;this.numberOfSkippedCellsDueToMissingLocaleInfo=Sa;this.totalExecutionTime=Wa;this.originalProcessingTimeLimit=ab;this.newProcessingTimeLimit=ma;this.numberOfEditedRecalcedCellsInBatch=ha;this.numberOfDependentRecalcedCellsInBatch=eb;this.isNewTask=ta;this.lastSetCellInstantaneousOperation=ya;this.taskId=sb;this.isNewNumberFormatter=Qb;
this.numberOfRecalcedCellsWithFormattedValue=oc;this.numberOfRecalcedCellsWithoutFormattedValue=kb;this.totalNumberFormatterTime=jb;this.newNumberFormatterFinalizeFailures=Wb;this.numberOfMeasureTextWidthCalls=wc;this.numberOfHashFormattedValues=Jc}}Object(r.a)(O,"RecalcResultProcessingStatistics",null,[]);class da{constructor(lb,db,Pa,ja){this.rangeDelta=lb;this.stateId=db;this.isFinished=Pa;this.priorityGroup=ja}}Object(r.a)(da,"RecalcedCellInfo",null,[]);var xa=a(114),ia=a(11),Ma=a(22),Ta=a(55),
Da=a(71),fa=a(292),ua=a(187),Fa=a(105);class ca{constructor(lb,db,Pa){this.ida=[];this.calcManager=this.rBc=this.lastSetCellInstantaneousOperation=null;this.FPf=ja=>{var Ka;if(ja&&ja.rangeDeltas){var ub=this.ida.length;for(let Kb=0;Kb<ja.rangeDeltas.length;Kb++)(null===(Ka=ja.rangeDeltas[Kb])||void 0===Ka?0:Ka.data)&&void 0!==ja.rangeDeltas[Kb].data.value&&null!==ja.rangeDeltas[Kb].data.value&&void 0!==ja.rangeDeltas[Kb].range&&null!==ja.rangeDeltas[Kb].range&&this.ida.push(new da(ja.rangeDeltas[Kb],
ja.stateId,ja.isFinished,ja.priorityGroup));d.ULS.sendTraceTag(574993422,0,50,`CalcResultProcessor.ProcessResults stateId=${ja.stateId}, priorityGroup=${ja.priorityGroup}, recalcFinished=${ja.isFinished}, cellsFromCalc=${ja.rangeDeltas.length}, initialCellsToRender=${ub}, recalcedCells=${this.ida.length}, lastSetCellInstantaneousOperation=${this.lastSetCellInstantaneousOperation}`);!ub&&this.ida.length&&this.dHf(!1,0)}};this.$=lb;this.grid=db;this.Nh=Pa;this.eda=ca.PKe;this.$.da.gb(268,ja=>{this.rBc=
ja});N.EwaSettings.dK()?void ua.a.resolve(Fa.b).then(ja=>{this.calcManager=ja}):this.$.da.gb(266,ja=>{this.calcManager=ja})}dispose(){this.calcManager=this.rBc=this.Nh=this.grid=this.$=null}vcd(lb,db,Pa,ja,Ka,ub,Kb){if(!db)return Object(fa.a)("Null");var W=excelOnlineCalc.numfmt.renderCallback(ja,Sa=>gridRenderer.CanvasRendererGlobals.measureTextWidth(Sa,Ka,!0,N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1)),Kb);let za=lb.renderValue(db,W);if(!excelOnlineCalc.util.isSuccess(za))return Object(fa.a)("Finalize");
ja=null;if(Kb=excelOnlineCalc.numfmt.isHashesValue(za.value)){if(za=lb.renderHashesValue(za.value,W),!excelOnlineCalc.util.isSuccess(za))return Object(fa.a)("Hashes")}else ja=ca.$Jh(db,za.value);W=za.value;lb=excelOnlineCalc.numfmt.renderedValueToString(W);db=M(W);W=L(W);return Object(fa.d)({text:lb,valueType:Pa,fontColor:W,hj:ub,COa:ja,horizontalAlignment:db,isHashesValue:Kb})}dHf(lb,db){this.$&&this.grid&&this.calcManager&&this.rBc&&this.calcManager.jB?(lb&&(this.eda=this.rBc.Cff),this.Y9i(this.grid,
this.calcManager.jB,lb,db),!this.eda&&this.ida.length?Ta.Task.delay(0).So(Pa=>{this.dHf(!0,Pa.id);return!0},0,null,Da.a.current):Ta.Task.Sa(!0)):(d.ULS.sendTraceTag(537162181,0,50,"CalcResultProcessor.OnRecalcResultsTask: one of the objects required for processing is null. Aborting..."),Ta.Task.Sa(!1))}Y9i(lb,db,Pa,ja){const Ka=ia.HelperMethods.Kb();for(Pa=new O(this.ida.length,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,this.eda,void 0,void 0,void 0,Pa,void 0,ja,!0,0,0,
0,0,0,0);0<this.ida.length;){ja=ia.HelperMethods.Kb()-Ka;if(!this.eda||ja>this.eda){Pa.numberOfCellsSkippedDueToTimeout=this.ida.length;break}ja=Array.dequeue(this.ida);if(aa(ja,Pa)){var ub=m.Range.Mc(ja.rangeDelta.range.row+1,ja.rangeDelta.range.column+1);(ub=lb.Pb(ub))?ca.f1g(ja.stateId,ub.cell)?(ca.doc(lb,ub,ja,Pa),this.HSg(db,ub,ja,Pa)):Pa.numberOfCellsUpdatedAlreadyByServer++:Pa.numberOfCellsWithNoFormattedCell++}}ja=Math.round(ia.HelperMethods.Kb()-Ka);this.C2j(ja);this.RPj(Pa,ja);this.Mnj(Pa)}HSg(lb,
db,Pa,ja){var Ka,ub,Kb,W;const za=ba(db,Pa),Sa=Pa.rangeDelta.data.formatted,Wa=V(Pa),ab=Y(Pa);lb=this.vcd(lb,Sa,Wa,db.cell.rBa,db.cell.bia,za,!1);if(Object(fa.c)(lb))db.text!==lb.value.text&&(this.Nh.epb(db,lb.value),Pa=Y(Pa),0===Pa?Pa=1:1===Pa?Pa=2:(d.ULS.sendTraceTag(537162182,0,10,"CalcInterfaceAdapter.GetInstantaneousUpdatedCellType: unknown updated cell type!"),Pa=0),this.Nh.CPe(db,this.lastSetCellInstantaneousOperation,1,Pa,!0,!0),0===ab&&N.EwaSettings.isChangeGateEnabled("OfficeVSO:6487996_CalcNotifiesRecalcComplete")&&
(this.calcManager?this.calcManager.Zxf(db.range):d.ULS.sendTraceTag(521171802,0,15,"CalcResultsProcessor.applyRecalcResultOnCell: Unable to call notifyEditedCellRecalcComplete as calcManager member is null.")),ja.numberOfUpdatedCells++);else switch(lb.reason){case "Null":ja.numberOfRecalcedCellsWithoutFormattedValue=(null!==(Ka=ja.numberOfRecalcedCellsWithoutFormattedValue)&&void 0!==Ka?Ka:0)+1;break;case "Hashes":ja.numberOfHashFormattedValues=(null!==(ub=ja.numberOfHashFormattedValues)&&void 0!==
ub?ub:0)+1;break;case "Finalize":ja.newNumberFormatterFinalizeFailures=(null!==(Kb=ja.newNumberFormatterFinalizeFailures)&&void 0!==Kb?Kb:0)+1}Object(fa.b)(lb)&&"Null"!==lb.reason&&(ja.numberOfRecalcedCellsWithFormattedValue=(null!==(W=ja.numberOfRecalcedCellsWithFormattedValue)&&void 0!==W?W:0)+1);ja=0===ab?db.cell.userInput:db.formulaBarText;W=Object(fa.c)(lb)?lb.value.text:"";Pa=Object(fa.b)(lb)?lb.reason:"";d.ULS.sendTraceTag(537162180,0,50,`CalcResultProcessor.ApplyRecalcResultOnCell: (${db.range.top}, ${db.range.left}) 2nd pass formatting, success: ${Object(fa.c)(lb)}, reason: ${Pa}, priority: ${ab}, ifmt: ${db.cell.hj}, input: '${ja?
Ma.a.XL(ja):"null"}', prediction: '${W?Ma.a.XL(W):"null"}',`)}C2j(lb){this.eda=Math.max(this.eda-Math.max(lb,1),0)}RPj(lb,db){lb.numberOfNonUpdatedCells=this.ida.length;lb.totalExecutionTime=db;lb.newProcessingTimeLimit=this.eda;lb.lastSetCellInstantaneousOperation=this.lastSetCellInstantaneousOperation}Mnj(lb){lb=Sys.Serialization.JavaScriptSerializer.serialize(lb);d.ULS.sendTraceTag(574993417,0,50,`CalcResultProcessor.ReportRecalcProcessingStatistics:${lb}`)}static $Jh(lb,db){lb=lb.units;var Pa=
db.units;if(lb.length!==Pa.length)return d.ULS.sendTraceTag(537162179,0,15,"CalcResultProcessor.FormattedValueToNumberFormatInformation: can't convert to NumberFormatInformation: units and finalized units don't have the same length!"),null;db=[];let ja=-1;for(let Ka=0;Ka<lb.length;Ka++)switch(lb[Ka].kind){case ra.blank:db.push(...xa.h(" ",Pa[Ka].str.length));break;case ra.string:db.push(lb[Ka].str);break;case ra.BIh:db.push("");ja=Ka;break;case ra.general:db.push(Pa[Ka].str);break;default:d.ULS.sendTraceTag(537162178,
0,15,"CalcResultProcessor.ProcessFormattedValue: unknown FormattedUnitKind!")}if(0>=ja||""===Pa[ja].str)return null;Pa={};Pa.Start=db.slice(0,ja).join("");Pa.Separator=lb[ja].str;Pa.End=db.slice(ja+1,db.length).join("");return Pa}static RQh(lb){return lb&&lb&&lb.Xx?lb.Xx.nE:Z.a.oe}static f1g(lb,db){if(!db)return!1;db=ca.RQh(db);return db===Z.a.oe||db===lb}static doc(lb,db,Pa,ja){var Ka=Pa.rangeDelta.data.value.toString();const ub=V(Pa),Kb=ba(db,Pa);Ka=new ea(ub,Ka,Kb,Pa.priorityGroup);db.cell.doc(Ka,
lb.Ca.Bxa);1===Y(Pa)?ja.numberOfDependentRecalcedCellsInBatch++:ja.numberOfEditedRecalcedCellsInBatch++}}ca.PKe=20;Object(r.a)(ca,"CalcResultProcessor",null,[646,2]);class ka{constructor(lb,db=null,Pa=""){this.success=lb;this.ioc=db;this.reason=Pa}}Object(r.a)(ka,"GetRibbonNumberFormatResult",null,[]);var Ca=a(928);class fb{constructor(lb,db){this.ux=null;this.Ca=lb;this.h3a=db}Gdb(lb,db,Pa,ja,Ka=!1,ub=!1){lb&&(lb.r0(db,Pa,Ka,ub),lb.verticalAlignment=ja)}fMb(lb,db,Pa){this.ux||(this.ux=new Ca.a(this.Ca,
this.h3a));this.ux.fMb(lb,db,Pa)}}Object(r.a)(fb,"FormatCellsActionModelAccessor",null,[645]);var yb=a(214),mb=a(28),nb=a(29),X=a(249),R=a(254),wa=a(282),na=a(66);class Ba{constructor(){this.vmg=this.x6j=!1;this.source=0;this.rwa=this.jjc=!1}}Object(r.a)(Ba,"FormatCellInstantaneousResult",null,[]);class Ra{constructor(lb,db){this.success=lb;this.KA=db}}Object(r.a)(Ra,"FormatStringResult",null,[]);var qa=a(21),La=a(177),Yb=a(1106),mc=a(45),Zb=a(520),qb=a(52),Ha=a(175),Ya=a(267),Gb=a(80),Ja=a(174),
Na=a(61),Qa;(function(lb){lb.InvalidInput="invalid input";lb.UnsupportedZeroResize="resizing to 0 - ignore";lb.UnsupportedSkeletonInView="skeleton in view - ignore";lb.NullSPD="ActiveSheetProcessedData is null";lb.UnsupportedHiddenInRange="hiddens in resizeRanges";lb.UnsupportedMergeCell="There's a merge cell across blocks in resizeRanges"})(Qa||(Qa={}));Object(r.b)("InstantaneousRowColumnResizeFailureReason",Qa);var Oa=a(382),bb=a(563);class Ga{constructor(lb){this.ux=this.calcManager=this.$x=this.OSa=
null;this.Rif=db=>{if(db){const Pa=ia.HelperMethods.nO.hasOwnProperty(db);db=qa.h(this.$).isFontSupported(db);return!Pa&&db}d.ULS.sendTraceTag(512340115,0,15,"FormatCellsAction.isFontFromFontService: fontName cannot be null");return!1};this.LSi=(db,Pa)=>{if(db&&!X.a(db)&&Pa){const ja=!!db&&!!db.RequestTelemetryData;qa.h(this.$).wh.Fla(Pa.toString(),db.StateId,ja?db.RequestTelemetryData.EcsOperationDuration:0,ja?db.RequestTelemetryData.EcsRequestDuration:0,ja?db.RequestTelemetryData.WfeRequestDuration:
0)}};this.$=lb;this.$.da.gb(268,db=>{this.$x=db});this.PJh=new fb(qa.h(this.$).Ca,this.$);this.rha=new ca(this.$,qa.h(this.$),this);N.EwaSettings.dK()?void ua.a.resolve(Fa.b).then(db=>{this.calcManager=db}):this.$.da.gb(266,db=>{this.calcManager=db});this.wb=N.EwaSettings.wb();this.Rl=N.EwaSettings.Rl();this.jNa=N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextOrientationSlice3",!1);this.jl=N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FontServiceIntegration",!1)}get Mua(){return this.PJh}get jB(){return void 0===
this.calcManager||null===this.calcManager?null:this.calcManager.jB}get localeInfo(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.localeInfo}dispose(){h.a.pc([this.OSa,this.rha]);this.$=this.rha=this.OSa=null}BSa(lb,db,Pa,ja=!1,Ka="",ub=0,Kb=null){return this.uJj(lb,db,Pa,ja,ub,Ka,Kb)}CPe(lb,db,Pa,ja,Ka,ub){lb.cell.Xx.rJ|=ja;Ga.p8g(qa.h(this.$),lb,Pa,Ka);this.rha.lastSetCellInstantaneousOperation=db;ub&&(qa.h(this.$).wh.$R(db,na.BasicTelemetryCalculator.HQ),N.EwaSettings.isChangeGateEnabled("OfficeVSO:7198762_AddTelemetryforCalculateDurationBetweenPhases")&&
(1===Pa&&1===ja?qa.h(this.$).wh.$R(db,na.BasicTelemetryCalculator.Dff):1!==Pa&&qa.h(this.$).wh.$R(db,na.BasicTelemetryCalculator.Aod)))}$da(lb,db,Pa,ja=!1,Ka=null,ub=null){ub=ub||lb.ha.qa.selectedRanges;if(!(-1690267012===db&&1<ub.length)){-1690267012===db&&d.ULS.shipAssertTag(537162176,0,1===ub.length,`FormatCellsAction.ShowInstantaneousFormatting: targetRanges.Length = ${ub.length}`);ub=lb.O$("FormatCellsAction.ShowInstantaneousFormatting",ub);try{ub.$$rst();let Kb=!1;for(;ub.$$mn();){let W;const za=
ub.$$cu().vH?lb.HLb(ub.$$cu().range):(W=new l.a,W.add(ub.$$cu()),W);for(let Sa of za)if(qa.h(this.$),!Sa||ub.Gb.contains(Sa.range))if(this.c$f(db,Sa,Pa,ja,Ka,ub.$$cu().vH),Kb||(lb.Ca.dV(),Kb=!0),Ka)break}}finally{ub&&ub.dispose()}}}epb(lb,db,Pa=null){Pa&&(Pa.rwa=!0);Pa=!db.text;const ja=Ma.a.Mkf(db.text);let Ka;const ub=lb.vH?qa.h(this.$).HLb(lb.range):(Ka=new l.a,Ka.add(lb),Ka);for(let Kb of ub)this.FSg(this.$,Kb,db.text,db.horizontalAlignment,db.fontColor,db.hj,lb.cell.hj,Pa,ja,db.valueType,db.COa);
lb.cell.CEc()}O4i(lb,db,Pa,ja,Ka=null){try{const ub=y.D(db);let Kb=y.D(Pa);if(!Oa.a.uxe){if(lb.tb.l7a(ub)||lb.tb.l7a(Kb))return 8;if(N.EwaSettings.isChangeGateEnabled("OfficeVSO:7148128_BlockWrapTextCseForPaste")&&-185374993!==ja&&(lb.tb.Mnf(ub)||lb.tb.Mnf(Kb)))return 18;if(N.EwaSettings.isChangeGateEnabled("OfficeVSO:7327017_BlockCondFormattingForPaste")&&-185374993!==ja&&(lb.tb.uhf(ub)||lb.tb.uhf(Kb)))return 19}if(-185374993!==ja&&this.Rui(lb,ub,Kb))return 9;if(-185374993!==ja&&(lb.tb.c5(Kb)||lb.tb.IBb(ub)))return 10;
if(1804571062!==ja&&lb.tb.b5(Kb))return 11;if(this.lph(Kb))return 12;if(this.Ovi(ub,Kb))return 13;const W=this.$.Jb.Gc("UserAction","PasteInstantaneous");W.start();Zb.a(W);Ka&&qb.b().cC(W.id,Ka.id,"actions","actions");!ub.isSingle&&Kb.isSingle&&(Kb=Ga.expandRange(ub,Kb),lb.ha.updateSelection(Kb,Kb,0));switch(ja){case 237279923:case 808159687:if(!this.f5i(ub,Kb))return 14;this.X4c(lb,ub,Kb,!0,!1);break;case 1804571062:this.X4c(lb,ub,Kb,!0,!1);break;case -185374993:this.X4c(lb,ub,Kb,!1,!0);break;default:return 2}d.ULS.sendTraceTag(537162146,
0,50,"FormatCellsAction.PasteInstantaneous: Complete processing.");return 1}catch(ub){return d.ULS.sendTraceTag(537162145,0,10,`FormatCellsAction.PasteInstantaneous: failed with the following error: ${JSON.stringify(ub)}`),15}}n5g(lb,db){for(const Pa of lb)this.D2c(Pa,!0,db)}D2c(lb,db,Pa=""){if(lb){var ja=qa.h(this.$);if(db){if(db=ja.Wj("FormatCellsAction.ClearRangeInstantaneous",lb),ja=lb.isSingle?null:lb,db.$$mn()&&void 0!==db.$$cu()&&null!==db.$$cu())for(lb=Object(f.a)(new Ya.a,{Text:""}),this.BSa(db.$$cu(),
lb,!1,S.a.lrd(this.$),Pa,void 0,ja);db.$$mn();)void 0!==db.$$cu()&&null!==db.$$cu()&&this.BSa(db.$$cu(),lb,!1,!1,Pa)}else this.$da(ja,-1228228458,{},void 0,void 0,[lb])}else d.ULS.shipAssertTag(537162144,0,!1,"FormatCellsAction.ClearRangeInstantaneous: targetRange shouldn't be null")}Lej(lb,db){if(!db){db=ia.HelperMethods.Kb();var Pa=qa.h(this.$),ja=Pa.O$("FormatCellsAction.ReformatCells",lb);try{ja.$$rst();let Ka=!1;for(;ja.$$mn();){const ub=ja.$$cu().cell;if(0===ub.oC||2===ub.oC)this.updateSpillInformation(ub,
lb),Ka||(Pa.Ca.dV(),Ka=!0)}}finally{ja&&ja.dispose()}d.ULS.sendTraceTag(537162143,0,50,`FormatCellsAction.ReformatCellsAfterGeometryChange: reformatting cells total time: ${ia.HelperMethods.Kb()-db}.`)}}kld(lb,db){if(this.wb){if(lb.formulaBarText)return!Ma.a.equals(db.Text,lb.formulaBarText,!1);let Pa=lb.cell.formattedText;Pa=R.a(Pa,lb.cell.getCellFont());return!gridRenderer.CanvasRendererGlobals.compareFormattedTexts(Pa,db).isEqual}return!Ma.a.equals(db.Text,lb.text,!1)}VJh(lb,db,Pa,ja){if(void 0===
db||null===db)return new Ra(!1,lb);const Ka={};Ka.value=lb;Ka.type=1;db=this.A3a(Ka,db,Pa,ja);return Object(fa.b)(db)?new Ra(!1,lb):new Ra(!0,db.value.text)}vJj(lb,db,Pa,ja){return c(lb,this,db,Pa,ja,!0)}sJj(lb,db,Pa){if(!this.kld(db,Pa))return Object(fa.d)("Skip unchanged cell content");db=db.cell;Pa=this.EZe(Pa.Text,db.hj,db.rBa,db.bia,!0);if(Object(fa.b)(Pa))lb=Pa;else{Pa=Pa.value;var ja=db.hasRichValueIcon?"Unsupported rich value icon":db.rS?"Unsupported wrapped text":db.Gnf||null!=db.lL&&0!==
db.lL?"Unsupported rotated text":!0;!0!==ja?lb=Object(fa.a)(ja):(db.isCellWidthFixed?ja="Skip fixed width cell":(ja=Pa.valueType,ja=0===ja?"Skip empty cell value":2===ja?"Skip string cell value":db.hz&&!db.Hui?"Skip merged cell":db.gAc?"Skip shrunk to fit":Pa.isHashesValue?"Skip hashes cell value":!0),!0!==ja?lb=Object(fa.d)(ja):(Pa=db.R9g(Pa.text),Pa>db.offsetWidth?(db=[db.getRange().clone()],lb=c(lb,this,db,Pa,!1,!1),lb=Object(fa.b)(lb)?lb:Object(fa.d)(Pa)):lb=Object(fa.d)("Column is wide enough")))}return lb}CZe(lb,
db,Pa,ja,Ka){const ub={};ub.value=lb;ub.type=Pa;db=this.A3a(ub,db,ja,Ka);return Object(fa.b)(db)?new Ra(!1,lb):new Ra(!0,db.value.text)}updateSpillInformation(lb,db){const Pa=lb.getRange();let ja=!1;for(const Ka of db)if(Pa.left===Ka.left){ja=!0;break}lb.m_j(ja)}uJj(lb,db,Pa,ja,Ka,ub="",Kb=null){const W=new Ba;W.source=0;W.rwa=!1;lb.cell.qHb=lb.cell.hj;let za=db.Text;const Sa=!za,Wa=Ma.a.Mkf(za);Ma.a.Dq(za)&&(d.ULS.shipAssertTag(537162142,0,!((void 0===za||null===za)&&void 0!==db.TextRuns&&null!==
db.TextRuns),"FormatCellsAction.ShowInstantaneousDataEntryOnCellInternal: Text is null but TextRuns isn't"),db=Object(f.a)(new Ya.a,{Text:""}),za="");lb.cell.userInput=za;if(!this.kld(lb,db))return this.N2g(lb,Ka,Sa,Wa,W);Pa?this.H2g(lb,za,this.$.workbookContext.DefaultHyperlinkStyle,W):this.B2g(lb,db,za,Sa,Wa,ja,W,Kb);this.CPe(lb,ub,Ka,1,W.jjc,W.rwa);return W}N2g(lb,db,Pa,ja,Ka){Ka.vmg=!0;Ka.jjc=!0;Ka.rwa=!1;0===db&&qa.h(this.$).Ca.dV();0===lb.cell.nB&&(Pa?lb.cell.r0(0,!1):ja&&lb.cell.r0(1,!1));
this.g_d(lb.range,"FormatCellsAction.cellUnchangedDataEntryCSE");return Ka}H2g(lb,db,Pa,ja){ja.rwa=!0;lb.insertHyperlink(db,G.a.edd(db),Pa);this.g_d(lb.range,"FormatCellsAction.cellDataEntryCSE")}B2g(lb,db,Pa,ja,Ka,ub,Kb,W=null){Kb.rwa=!1;const za=lb.cell;this.$x||(this.$x=this.$.da.Aa(268));this.OVj(this.$x,za.hj);N.EwaSettings.isChangeGateEnabled("OfficeVSO:7082146_applyNFWhenNotSendingWW")&&ub&&this.igg(this.$x,lb,Pa,W);ja||Ka?this.D2g(lb,ja,Ka,Kb):(ja=this.EZe(Pa,za.hj,za.rBa,za.bia,!1),Object(fa.c)(ja)?
(this.iGj(db.TextRuns,db.Fonts)&&this.F2g(lb,db,ja.value),this.epb(lb,ja.value,Kb),this.g_d(lb.range,"FormatCellsAction.cellDataEntryCSE")):this.L2g(lb,db.Text,Kb),db=Object(fa.c)(ja)?ja.value.text:"",Ka=Object(fa.b)(ja)?ja.reason:"",d.ULS.sendTraceTag(559724065,0,50,`FormatCellsAction.CellDataEntryCSE: (${lb.range.top}, ${lb.range.left}) 1st pass formatting, success: ${Object(fa.c)(ja)}, reason: ${Ka}, ifmt: ${za.hj}, input: '${Ma.a.CZa(za.userInput)}', prediction: '${Ma.a.CZa(db)}',`));za.formulaBarText=
Pa;N.EwaSettings.isChangeGateEnabled("OfficeVSO:7082146_applyNFWhenNotSendingWW")||ub&&this.igg(this.$x,lb,Pa,W);Kb.jjc=!0}D2g(lb,db,Pa,ja){ja.rwa=!0;lb.text="";lb.formulaBarText="";lb.cell.userInput="";this.F1c(lb,null,null,db,Pa)}F2g(lb,db,Pa){db.Text===Pa.text&&2===Pa.valueType&&(lb.cell.formattedText=db)}L2g(lb,db,Pa){Pa&&(Pa.rwa=!0);lb.text=db;lb.formulaBarText=db;this.F1c(lb,1)}F1c(lb,db,Pa=null,ja=!1,Ka=!1,ub=!1){let Kb=lb.nB;Pa=null!=Pa?Pa:lb.verticalAlignment;0===lb.cell.nB&&(null!=db||ja||
Ka||ub)&&(ja?Kb=0:Ka||ub?Kb=1:null!=db&&(Kb=db),this.Mua.Gdb(lb,Kb,!1,Pa,!0))}g_d(lb,db){if(N.EwaSettings.isChangeGateEnabled("OfficeVSO:6487996_CalcNotifiesRecalcComplete")){const Pa=qa.h(this.$),ja=()=>{this.calcManager?this.calcManager.Zxf(lb):d.ULS.sendTraceTag(521172961,0,50,`FormatCellsAction.cellUnchangedDataEntryCSE: Unable to call notifyEditedCellRecalcComplete as calcManager member is null. caller: ${db}, cell ${lb}`);Pa.Vb.$l(ja)};Pa.Vb.Km(ja)}}OVj(lb,db){(null===lb||void 0===lb?0:lb.rya)&&
db>=Ga.iIh&&db>lb.rya.length-1&&(d.ULS.sendTraceTag(537162141,0,50,`FormatCellsAction.TriggerSupportInformationRefresh: The cell has a missing format, ifmt:${db}. Triggering refresh...`),lb.vZe())}igg(lb,db,Pa,ja=null){if(void 0!==lb&&null!==lb)if(this.$x.zod)d.ULS.sendTraceTag(537162140,0,50,"FormatCellsAction.TriggerCalc: in manual mode - not recalcing");else{try{var Ka=Object(bb.a)({W5:266,new:Fa.b,registry:this.$.da,O3:N.EwaSettings.gX})}catch(ub){}Ka&&(this.rha.eda=ca.PKe,lb&&(this.rha.eda=lb.Cff),
Ka.s0g(db,Pa,this.rha.FPf,ja))}}A3a(lb,db,Pa,ja){var Ka=Object(bb.a)({W5:266,new:Fa.b,registry:this.$.da,O3:N.EwaSettings.gX});if(!Ka)return Object(fa.a)("calcManager is null");if(!Ka.jB)return Object(fa.a)("calcManager.NumberFormatter is null");if(!this.$x)return Object(fa.a)("instantaneousManager is null");let ub;if("number"===typeof db||"string"===typeof db){var Kb=Ka.J4a(db);if(!Object(fa.c)(Kb))return Kb;ub=Kb.value}else ub=db;Kb=Ka.jB;const W=P(lb);if(void 0===W||null===W)return Object(fa.a)("cellValue is null");
Ka=excelOnlineCalc.calc.cellValueToReadOper(Ka.config.mathpack,W);if(void 0===Ka||null===Ka)return Object(fa.a)("readOper is null");Ka=Kb.applyFormat(ub,Ka,N.EwaSettings.isChangeGateEnabled("OfficeVSO:6328006_applyFormatDisplaysZeroes"));return excelOnlineCalc.util.isSuccess(Ka)?this.rha.vcd(Kb,Ka.value,lb.type,Pa,ja,"number"===typeof db?db:-1,!1):Object(fa.a)("NumberFormatter.ApplyFormat: "+JSON.stringify(Ka.reason.kind))}EZe(lb,db,Pa,ja,Ka){var ub=Object(bb.a)({W5:266,new:Fa.b,registry:this.$.da,
O3:N.EwaSettings.gX});if(void 0===ub||null===ub)return Object(fa.a)("calcManager is null");if(void 0===ub.jB||null===ub.jB)return Object(fa.a)("calcManager.NumberFormatter is null");if(void 0===this.$x||null===this.$x)return Object(fa.a)("instantaneousManager is null");var Kb=ub.J4a(db);if(!Object(fa.c)(Kb))return Kb;var W=Kb.value;Kb=ub.jB;lb=Kb.parseEdit(lb,W);if(!excelOnlineCalc.util.isSuccess(lb))return Object(fa.a)(`ParseEdit failure: reason=${lb.reason.kind}, features=${lb.reason.features}`);
if(lb.value.kind===u.a.formula)return Object(fa.a)("Main thread - skipping formula edit");ub=excelOnlineCalc.numfmt.applyValueEdit(Kb,ub.localeInfo,W,lb.value);if(!excelOnlineCalc.util.isSuccess(ub))return Object(fa.a)("NumberFormatter.FormatValueEdit: "+JSON.stringify(ub.reason.kind));lb=lb.value;d.ULS.shipAssertTag(537162190,0,lb.kind!==u.a.formula,"CalcInterfaceAdapter.GetCellValueTypeFromParsedEdit: given parsed edit must be a value edit!");lb=excelOnlineCalc.numfmt.getValueEditOperKind(lb);W=
0;switch(lb){case 0:case 128:W=0;break;case 1:W=1;break;case 2:W=2;break;case 4:W=3;break;case 8:W=4;break;case 16:case 32:case 64:case 256:d.ULS.sendTraceTag(537162189,0,15,`CalcInterfaceAdapter.OperKindToCellValueType: can't convert given OperKind ${lb} to a CellValueType`);break;default:d.ULS.shipAssertTag(537162188,0,!1,`CalcInterfaceAdapter.OperKindToCellValueType: Unexpected oper kind ${lb}`)}return this.rha.vcd(Kb,ub.value,W,Pa,ja,"number"===typeof db?db:-1,Ka)}Rui(lb,db,Pa){if(db.width<Pa.width){const ja=
lb.Wj("FormatCellsAction.IsSourceRangeLargerAndWithBorders",new m.Range(db.top,db.left,db.bottom,db.left,!0,!0));for(;ja.$$mn();){let Ka=ja.$$cu();if(Ka&&Ka.pLa())return d.ULS.sendTraceTag(537162139,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0}}if(db.height<Pa.height)for(lb=lb.Wj("FormatCellsAction.IsSourceRangeLargerAndWithBorders2",new m.Range(db.top,db.left,db.top,db.right,!0,!0));lb.$$mn();)if((db=lb.$$cu())&&db.rLa())return d.ULS.sendTraceTag(537162138,
0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0;return!1}X4c(lb,db,Pa,ja,Ka){const ub=db.eS().FirstRow,Kb=db.eS().LastRow;var W=Pa.eS().FirstRow;const za=Pa.eS().LastRow;let Sa=ub;for(;W<=za;W++,Sa++){Sa>Kb&&(Sa=ub);const Wa=db.eS();Wa.FirstRow=Wa.LastRow=Sa;const ab=Pa.eS();ab.FirstRow=ab.LastRow=W;this.qah(lb,z.a.iQ(Wa),z.a.iQ(ab),ja,Ka)}}f5i(lb,db){const Pa=Object(bb.a)({W5:266,new:Fa.b,registry:this.$.da,O3:N.EwaSettings.gX});return void 0!==Pa&&null!==Pa?(Pa.m0g(lb,
db.topLeft,this.rha.FPf),!0):!1}Ovi(lb,db){const Pa=lb.right-lb.left+1;lb=lb.bottom-lb.top+1;const ja=db.right-db.left+1;db=db.bottom-db.top+1;if(ja>Pa&&db>lb){if(!(ja%Pa&&db%lb))return!0}else if(ja===Pa&&db>lb){if(!(db%lb))return!0}else if(ja>Pa&&db===lb&&!(ja%Pa))return!0;return!1}lph(lb){if(N.EwaSettings.ra(101)){lb=qa.h(this.$).W0(lb).gridView.getRangeInformation(lb);for(const db of lb)if(Object(k.a)(w.DynamicArrayRange,db)&&!Object(t.a)(w.DynamicArrayRange,db).W9a)return!0}return!1}HGe(lb,db,
Pa,ja,Ka,ub){for(let Kb of db)Pa&&(this.uah(Kb,Ka),Kb.setCell(!0)),ja&&(ub=this.x$h(Ka,Kb)),ub||(lb.Ca.dV(),ub=!0);return ub}TVh(lb,db,Pa){db=new m.Range(db,Pa,db,Pa,!0,!0);return lb.Pb(db)}qah(lb,db,Pa,ja,Ka){if(Pa){this.OSa&&Pa.equals(this.OSa.range)||(h.a.Ja(this.OSa),this.OSa=lb.Wj("FormatCellsAction.CopyBetweenRows",Pa));Pa=this.OSa;Pa.$$rst();var ub=!1;if(N.EwaSettings.getBooleanFeatureGate(Oa.a.DJe,!1)){var Kb=db.eS().FirstColumn+1,W=db.eS().LastColumn+1;db=db.eS().FirstRow+1;let Sa=Kb;for(;Pa.$$mn();){Sa>
W&&(Sa=Kb);const Wa=this.TVh(lb,db,Sa);Sa+=1;var za=void 0;const ab=Pa.$$cu().vH?lb.HLb(Pa.$$cu().range):(za=new l.a,za.add(Pa.$$cu()),za);Wa&&(ub=this.HGe(lb,ab,ja,Ka,Wa,ub));Gb.lastOrDefault(ab)}}else for(za=lb.Wj("FormatCellsAction.CopyBetweenRows2",db);Pa.$$mn();)za.$$mn()||(za.$$rst(),za.$$mn()),W=za.$$cu(),db=Pa.$$cu().vH?lb.HLb(Pa.$$cu().range):(Kb=new l.a,Kb.add(Pa.$$cu()),Kb),W&&(ub=this.HGe(lb,db,ja,Ka,W,ub)),Gb.lastOrDefault(db)}else d.ULS.sendTraceTag(537162137,0,50,"FormatCellsAction.CopyBetweenRows: targetRange is null")}x$f(){const lb=
nb.a.ed(1,0,0,647,0,104573951,"PivotTableContextMenuOperationFailure");mc.a(this.$).kj(lb)}BGi(lb,db){const Pa={ValidMembers:32},ja=db.NumberFormat;switch(lb){case 1890566896:if(1001===ja||1002===ja||1003===ja){Pa.NumberFormat=14;Pa.NumberFormatOptions={};switch(ja){case 1001:Pa.NumberFormatOptions.TimeType=2;break;case 1002:Pa.NumberFormatOptions.DateType=7;break;case 1003:Pa.NumberFormatOptions.DecimalPlaces=0}Pa.NumberFormatOptions.NumberFormatCategory=this.tSg(ja)}else Pa.NumberFormat=ja;break;
case 1886928607:Pa.NumberFormat=13;break;case -992833457:Pa.NumberFormat=11;break;case 218524921:Pa.NumberFormat=12;break;case 996232352:Pa.NumberFormat=14;Pa.NumberFormatOptions=Object(f.a)(new n.a,{DecimalPlaces:0});Pa.NumberFormatOptions.NumberFormatCategory=6;break;default:return db}return Pa}formatCells(lb,db,Pa,ja=null,Ka=null,ub=null,Kb=null){var W;const za=this.$.Jb.Gc("UserAction","FormatCellsInstantaneous, command = "+qb.b().Cj(lb)),Sa=this.$.Jb.zg("UserAction","FormatCellsInstantaneousFrame");
Sa.start();Zb.a(Sa);var Wa=qb.b().Cj(lb);const ab=this.$,ma=qa.h(ab);var ha=ma.ha.qa,eb=Ka||ha.selectedRanges,ta=xa.g(eb,kb=>kb.Oy);Wa=`${Wa}, cellCount=${ta}`;qa.h(this.$).wh.z0(1,za.id,Wa);eb=y.r(eb,this.$);ha=ha.activeCell;Wa=-168056295===Pa.command;var ya=ta=null;if(Wa){ya=ma.tb.Yo(ha);if(!ya){this.x$f();return}ta=ya.Uca.substring(1,ya.Uca.length-1);ya=ya.ccc();if(!ya){this.x$f();return}ya=ya.Caption}ma.Gg.iM(!1,!0);const sb=y.o(ha,ab),Qb=ab.oa.xa.Wb({Dla:!0,vka:1}),oc=this.BGi(Pa.command,db);
Wa||this.$da(ma,lb,db,!1,ja,Ka);za.stop();qa.h(this.$).wh.$R(za.id,na.BasicTelemetryCalculator.HQ);Pa.Cji=mb.a.Ya.Ub;ja=this.$.Jb.Gc("UserAction","FormatCellsUserAction");Ka=this.jl&&this.Rif(null===(W=null===db||void 0===db?void 0:db.Font)||void 0===W?void 0:W.FontName);this.KCi(lb,Pa.taskId,db,eb,ha,ja.id,Ka);qb.b().cC(za.id,ja.id,"actions","actions");qb.b().cC(Sa.id,ja.id,"actions","actions");ab.userOperationManager.Jc(new U(this,eb,sb,oc,Wa,ta,ya,Qb,ja,za.id,64,ub,Kb),Pa)}D2(lb,db,Pa,ja,Ka,ub,
Kb,W,za,Sa,Wa){const ab=this.$;return(ma,ha,eb)=>{ab.py();ma=[ma,this.LSi];ha=[ha];Sa&&ma.push(Sa);Wa&&ha.push(Wa);return C.l(ab.oa.xa,lb,db,Pa,ja,Ka,ub,!1,wa.b(...ma),wa.a(...ha),eb,za,Kb,W)}}c$f(lb,db,Pa,ja,Ka,ub,Kb=null){if(db&&Pa){var W=Pa.Font,za=Pa.HorizontalAlignment,Sa=Pa.VerticalAlignment;Pa.ValidMembers&2||(za=db.nB);Pa.ValidMembers&1||(Sa=db.verticalAlignment);var Wa=0!==za;Ga.Lli(lb)&&0===za&&(za=this.Q3e(db));var ab=!1;switch(lb){case -394785302:this.Mua.Gdb(db,za,Wa,0);break;case 1041132226:this.Mua.Gdb(db,
za,Wa,1);break;case -571165336:this.Mua.Gdb(db,za,Wa,2);break;case -1150205178:case -1142465846:case -286432209:this.Mua.Gdb(db,za,Wa,Sa,!1,!1);break;case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:this.GEj(this.jNa,db)&&this.Hxj(db,Pa,Wa);break;case 1650812936:this.setFillColor(db,Pa,ub);break;case -287251124:db.bold=W.Bold;break;case -1690267012:qa.h(this.$).ha.qa.Tg&&(W=N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",
!1)?Kb?Kb:qa.h(this.$).ha.qa.ld:qa.h(this.$).ha.qa.ld,this.Mua.fMb(db,Pa,W));break;case 1970784898:Pa=E.a.Wo(db.color,db.backgroundColor);if(yb.a.compare(Pa,yb.a.red)&&(Ma.a.Y4(db.text)||Ma.a.Maf(db.text)))break;Pa=yb.a.aH(W.FontColor);db.color=Ha.e(E.a.RF(Pa));break;case -1925065947:db.italic=W.Italic;break;case -1293291468:db.fontName=W.FontName;this.Rl&&db.b5f(W.FontScheme);break;case 862890474:case 963349338:db.fontSize=W.FontSize;this.$.qf();break;case -1077965542:db.fontSize=W.FontSize;break;
case 1764140053:db.underline=W.Underline;break;case -1685033574:db.doubleUnderline=W.DoubleUnderline;break;case -1590502662:db.fontStrikethrough=W.Strikethrough;break;case -848953656:case 2045211913:ab=db.prb();break;case 2105621672:Pa=Object(t.a)(Yb.a,Ka);if(!Pa)break;W=yb.a.TKh(Pa.color);db.color=Ha.e(E.a.RF(W));this.Yue(db,Pa.moc);break;case -1409276245:this.Yue(db,Pa.NumberFormatOptions.CustomFormatString);break;case 1890566896:this.ESg(db,Pa);break;case -1228228458:db.prb();db.clearFormat();
this.cZc(db,0);ab=!0;break;case -730106152:db.clearFormat();this.cZc(db,0);break;case 932244020:this.Gxj(db,Pa,ub);break;case -1942512156:case -1920201820:this.Fzj(db,Pa)}ja||(ab?db.AJb(!0):db.setCell(!0))}else d.ULS.shipAssertTag(537162135,0,!db,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellToFormat"),d.ULS.shipAssertTag(537162134,0,!Pa,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellFormat")}uah(lb,db){lb&&db?(lb.zrb(db),lb.Y2c(db),this.cZc(lb,db.cell.hj)):d.ULS.sendTraceTag(537162133,
0,10,"FormatCellsAction.CopyFormattingBetweenCells:cellToFormat & sourceCell should not be null")}cZc(lb,db){if(0>db)this.bca({caller:"ApplyNumberFormatIndexOnCell",cell:lb,kind:"failure",reason:"ApplyNumberFormatIndexOnCell: negative format index was supplied"});else{var Pa=this.A3a(lb.Gr,db,lb.cell.rBa,lb.cell.bia);Object(fa.b)(Pa)?this.bca({caller:"ApplyNumberFormatIndexOnCell",cell:lb,kind:"failure",reason:Pa.reason}):(this.epb(lb,Pa.value),this.bca({caller:"ApplyNumberFormatIndexOnCell",cell:lb,
kind:"success",KA:Pa.value,format:db}))}}Yue(lb,db){if(void 0===db||null===db)this.bca({caller:"ApplyNumberFormatStringOnCell",cell:lb,kind:"failure",reason:"ApplyNumberFormatStringOnCell: no format string was supplied"});else{var Pa=this.A3a(lb.Gr,db,lb.cell.rBa,lb.cell.bia);Object(fa.b)(Pa)?this.bca({caller:"ApplyNumberFormatStringOnCell",cell:lb,kind:"failure",reason:Pa.reason}):(this.epb(lb,Pa.value),this.bca({caller:"ApplyNumberFormatStringOnCell",cell:lb,kind:"success",KA:Pa.value,format:db}))}}ESg(lb,
db=null){if(db)if(db=this.n2h(lb,db),db.success){var Pa=this.A3a(lb.Gr,db.ioc,lb.cell.rBa,lb.cell.bia);Object(fa.b)(Pa)?this.bca({caller:"ApplyNumberFormatCategoryOnCell",cell:lb,kind:"failure",reason:Pa.reason,format:db.ioc}):(this.epb(lb,Pa.value),this.bca({caller:"ApplyNumberFormatCategoryOnCell",cell:lb,kind:"success",KA:Pa.value,format:db.ioc}))}else this.bca({caller:"ApplyNumberFormatCategoryOnCell",cell:lb,kind:"failure",reason:db.reason,format:db.ioc});else this.bca({caller:"ApplyNumberFormatCategoryOnCell",
cell:lb,kind:"failure",reason:"ApplyNumberFormatCategoryOnCell: no format was supplied"})}tSg(lb){switch(lb){case 1004:return 1;case 5:return-1;case 1002:return 4;case 6:case 1001:return 5;case 7:case 1003:return 6;case 8:return 7;case 9:return 8;case 10:return 9}return 10<lb?-1:lb}n2h(lb,db){if(!this.$x||!this.localeInfo||!db)return lb=this.$x?this.localeInfo?"cellFormat is null":"localeInfo is null":"instantaneousManager is null",new ka(!1,void 0,"GetRibbonNumberFormat: "+lb);db=db.NumberFormat;
switch(db){case 0:lb=v.sLh;break;case 1:lb=v.uLh;break;case 2:lb=v.qLh;break;case 3:lb=v.oLh;break;case 4:lb=v.xLh;break;case 5:lb=v.tLh;break;case 6:lb=v.zLh;break;case 7:lb=v.vLh;break;case 8:lb=v.rLh;break;case 9:lb=v.wLh;break;case 10:lb=v.yLh;break;case 11:case 12:return this.$x.vZe(),this.jTh(lb,db);case 13:lb=v.l_g;break;case 1006:lb=v.buttonPercentage;break;case 1004:lb=v.keyboardNumber;break;case 1005:lb=v.keyboardCurrency;break;case 1002:lb=v.keyboardDate;break;case 1001:lb=v.keyboardTime;
break;case 1003:lb=v.keyboardPercentage;break;case 14:return lb="GetRibbonNumberFormat: should not be called with NumberFormatDialog!",d.ULS.shipAssertTag(537162132,0,!1,lb),new ka(!1,void 0,lb);default:return lb="GetRibbonNumberFormat: unknown NumberFormatType!",d.ULS.shipAssertTag(537162131,0,!1,lb),new ka(!1,void 0,lb)}return lb?(lb=excelOnlineCalc.numfmt.getRibbonFormat(this.localeInfo,lb))?new ka(!0,lb):new ka(!1,void 0,"GetRibbonNumberFormat: ExcelOnlineCalcService.NumberFormatter.GetRibbonNumberFormat unable to get ribbon format..."):
new ka(!1,void 0,"GetRibbonNumberFormat: unsupported ribbonFormatKind...")}jTh(lb,db){if(!this.calcManager||!this.jB)return db=this.calcManager?"numberFormatter is null":"calcManager is null",new ka(!1,void 0,"GetDecimalChangeNumberFormat: "+db);lb=this.calcManager.J4a(lb.cell.hj);if(!Object(fa.c)(lb))return new ka(!1,void 0,`getDecimalChangeNumberFormat: ${lb.reason}`);db=this.jB.changeFormatDecimals(lb.value,11===db?1:-1);return excelOnlineCalc.util.isSuccess(db)?void 0===db.value||null===db.value?
new ka(!1,void 0,"GetDecimalChangeNumberFormat: successUndefined result"):new ka(!0,db.value):new ka(!1,void 0,"GetDecimalChangeNumberFormat: NumberFormatter.ChangeFormatDecimals failure")}bca(lb){const db=lb.caller,Pa=lb.cell;var ja=lb.format;ja=null==ja?"null":"number"===typeof ja?ja:"string"===typeof ja?Ma.a.CZa(ja):Ma.a.CZa(ja.formatString);const Ka=Ma.a.CZa(Pa.Gr.value)||"null",ub="success"===lb.kind?Ma.a.CZa(lb.KA.text):"null";lb=JSON.stringify({caller:db,"range.top":Pa.range.top,"range.left":Pa.range.left,
result:lb.kind,reason:"success"===lb.kind?"":lb.reason,value:Ka,valueType:Pa.Gr.type,ifmt:ja,prediction:ub});d.ULS.sendTraceTag(537162130,0,50,`FormatCellsAction.LogNumberFormatEdit: ${lb}`)}FSg(lb,db,Pa,ja,Ka,ub,Kb,W=!1,za=!1,Sa=0,Wa=null){const ab=db.cell;ab.oC=Sa;Sa=db.text;Sa!==Pa&&(ab.text=Pa);ab.COa=Wa;La.f(Sa)?db.formulaBarText=Sa:db.formulaBarText="";lb=qa.h(lb).tb.vlf(db.range);this.F1c(db,ja,null,W,za,lb);Ka&&(db.color=Ha.e(E.a.RF(Ka)));db.cell.hj=ub;db.cell.qHb=Kb;db.cell.JAc=ub}KCi(lb,
db,Pa,ja,Ka,ub,Kb){const W={};W.a=this.$.ya.UserSessionId;W.b=db;W.c=ja.Ranges.length;W.d=this.zeh(ja.Ranges);W.e=Ka.toString();W.f=lb;W.h=ub;1890566896===lb?W.g=Pa.NumberFormat.toString():2105621672===lb?W.g=Pa.NumberFormatOptions.NumberFormatCategory.toString():this.jl&&-1293291468===lb&&(W.g=`{ "isNewFont": ${Kb} }`);qb.b().Se(3,W,!0)}zeh(lb){let db=0,Pa=0,ja=0;for(let Ka=0;Ka<lb.length;Ka++){const ub=y.B(lb[Ka]).Oy;db+=ub;ub>ja&&(ja=ub,Pa=Ka)}lb=y.B(lb[Pa]).toString();return"TotalCellCount:"+
db+"; Max range:"+lb+"; MaxRangeSize:"+ja+";"}Gxj(lb,db,Pa){64===(db.ValidMembers&64)&&this.setFillColor(lb,db,Pa);16===(db.ValidMembers&16)&&Ga.gzj(lb,db);128===(db.ValidMembers&128)&&this.Mua.fMb(lb,db,lb.range);if(2===(db.ValidMembers&2)||1===(db.ValidMembers&1)){Pa=db.VerticalAlignment;db=db.HorizontalAlignment;const ja=0!==db;N.EwaSettings.isChangeGateEnabled("OfficeVSO:3603507_calculateHorizontalAlignmentOnToggle")&&!ja&&this.Q3e(lb);this.Mua.Gdb(lb,db,ja,Pa)}}setFillColor(lb,db,Pa){(N.EwaSettings.isChangeGateEnabled("OfficeVSO:3634588_NoFillColorOnConditionalFormattingCell")?
lb.MM:lb.MM&&lb.zyb&&!lb.Cyb&&!lb.Fyb)||(db=-1===db.FillColor?Pa?E.a.RF(yb.a.white):null:E.a.RF(yb.a.aH(db.FillColor)),lb.backgroundColor=db?Ha.e(db):null)}Fzj(lb,db){0!==lb.nB&&2!==lb.nB||lb.r0(1,!1);0<=lb.indentation+db.IndentationIncrease&&(lb.indentation+=db.IndentationIncrease)}GEj(lb,db){return lb&&!(0<db.indentation)}Hxj(lb,db,Pa){const ja=db.TextOrientation;ja!==Z.a.verticalText&&(0>ja||180<ja)&&d.ULS.shipAssertTag(523090050,0,!1,`FormatCellsAction.setCellTextOrientation: invalid value for text orientation in server ${ja}`);
lb.lL=db.TextOrientation;Pa||lb.r0(0<=lb.lL?1:3,!1)}Q3e(lb){lb=this.A3a(lb.Gr,lb.cell.hj,lb.cell.rBa,lb.cell.bia);return Object(fa.b)(lb)?0:null!=lb.value.horizontalAlignment?lb.value.horizontalAlignment:0}VAj(lb,db,Pa){this.ux||(this.ux=new Ca.a(qa.h(this.$).Ca,this.$));this.ux.fMb(lb,db,Pa)}x$h(lb,db){const Pa=new Ya.a;if(lb.cell.formulaBarText&&lb.cell.formulaBarText.startsWith("'"))Pa.Text=lb.cell.formulaBarText;else{let ja=lb.cellValue;ja&&4!==lb.cell.oC||(ja=lb.text);Pa.Text=ja}this.BSa(db,
Pa,!1,S.a.lrd(this.$));return!0}iGj(lb,db){return this.wb&&!!lb&&!!db}static p8g(lb,db,Pa,ja){ja&&db.setCell(!0);0===Pa&&lb.Ca.dV()}static expandRange(lb,db){db=db.clone();db.height<lb.height&&(db.bottom=db.top+lb.height-1);db.width<lb.width&&(db.right=db.left+lb.width-1);return db}static Lli(lb){switch(lb){case -1142465846:case -1150205178:case -286432209:case -571165336:case 1041132226:case -394785302:return!0;default:return!1}}static gzj(lb,db){db=db.Font;var Pa=0!==(db.ValidMembers&16);const ja=
0!==(db.ValidMembers&16),Ka=0!==(db.ValidMembers&16);lb.bold=0!==(db.ValidMembers&4);lb.italic=0!==(db.ValidMembers&8);Pa&&(lb.underline=Pa);ja&&(lb.doubleUnderline=ja);Ka&&(lb.fontStrikethrough=Ka);lb.fontName=db.FontName;lb.fontSize=db.FontSize;Pa=E.a.Wo(lb.color,lb.backgroundColor);yb.a.compare(Pa,yb.a.red)&&(Ma.a.Y4(lb.text)||Ma.a.Maf(lb.text))||(db=yb.a.aH(db.FontColor),lb.color=Ha.e(E.a.RF(db)))}}Ga.iIh=36;Object(r.a)(Ga,"FormatCellsAction",null,[564,2]);class tb extends e.a{constructor(lb){super();
this.$=lb;this.Db()}create(){this.nb(new Ga(this.$))}static ka(lb){lb.da.Ha(18,new tb(lb))}}Object(r.a)(tb,"FormatCellsActionFactory",e.a,[]);a.d(F,"a",function(){return wb});const wb=()=>{b.a.Fa(tb.ka)}},1186:function(r,F,a){var c=a(9);r=a(0);var b=a(226),e=a(1),f=a(15),d=a(202),h=a(81),l=a(37),k=a(48),t=a(44),n=a(649),z=a(28),w=a(120);class m{constructor(){this.startTime=z.a.Ya.Ub;this.wx=new n.a}B2e(){return w.a(z.a.Ya,this.startTime)}}Object(r.a)(m,"OngoingAction",null,[]);class u extends h.a{constructor(bb,
Ga,tb,wb,lb=null){super();this.pPa=this.Oob=null;this.t0c=0;this.Sqc=null;this.jZi=()=>{const db=this.pPa.B2e();f.ULS.sendTraceTag(537153861,0,50,`ActionAggregator<${this.Ala}>.OnRunningLong: Operation running for more than ${db}ms`);this.Sqc=k.a.instance.create(this.l6,Math.max(this.dze-db,0),t.a.jne)};this.l6=()=>{f.ULS.sendTraceTag(537153860,0,50,`ActionAggregator<${this.Ala}>.OnTimeout: Operation running for more than ${this.pPa.B2e()}ms, timing out. Has pending actions: ${this.s6a}`);this.t0c++;
this.t0c>this.cze&&f.ULS.sendTraceTag(537153859,0,50,`ActionAggregator<${this.Ala}>.OnTimeout: passed the allowed bypassed count`);this.pPa.wx.cancel();this.iYe()};this.TH=()=>{this.s6a&&f.ULS.sendTraceTag(537153858,0,50,`ActionAggregator<${this.Ala}>.OnDocumentUnhidden: Start. IsActionOngoing: ${this.aMa}, AggregatedActionParams not null: ${this.s6a}`);this.Hod()};this.nHg=bb;this.oHg=Ga;this.documentVisibilityObserver=tb;this.Ala=wb;this.jL=lb;tb&&this.documentVisibilityObserver.Xra(this.TH);this.s0c=
!!tb&&e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperation",!1);this.cze=e.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLimit",3);Ga=e.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationThresholdInMs",5E3);this.dze=bb.Sed(Ga);bb=e.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLogThresholdInMs",1E3);this.w_g=Math.max(this.dze-Ga,0)+bb}get aMa(){return!!this.pPa}get s6a(){return!!this.Oob}xMf(bb){f.ULS.sendTraceTag(537153864,
0,50,`ActionAggregator<${this.Ala}>.PerformThrottledAction: Start. IsActionOngoing: ${this.aMa}, AggregatedActionParams not null: ${this.s6a}`);this.Oob=this.oHg.yYc(bb,this.Oob);this.Hod()}dispose(){this.documentVisibilityObserver&&this.documentVisibilityObserver.Wza(this.TH);this.LAe();super.dispose()}R5f(bb){this.s0c?(this.pPa=bb?new m:null,bb?this.startTimer():this.LAe()):this.pPa=bb?{}:null}iYe(bb=null){this.s0c&&bb&&bb.cK?f.ULS.sendTraceTag(537153863,0,50,`ActionAggregator<${this.Ala}>.FinishedCallback: timedout, skipping`):
(f.ULS.sendTraceTag(537153862,0,50,`ActionAggregator<${this.Ala}>.FinishedCallback: Start. IsActionOngoing: ${this.aMa}, AggregatedActionParams not null: ${this.s6a}`),this.R5f(!1),this.Hod())}Hod(){if(!this.nNb()){var bb=this.Oob;this.Oob=null;this.R5f(!0);f.ULS.sendTraceTag(537153857,0,50,`ActionAggregator<${this.Ala}>.InternalPerformAction: Calling PerformAction.`);var Ga=this.s0c?this.pPa.wx.token:d.a.none;l.TaskExtensions.za(this.nHg.jGd(bb),()=>{this.iYe(Ga)},Ga,0,this.jL)}}nNb(){return!this.s6a||
this.aMa?!0:this.documentVisibilityObserver&&this.documentVisibilityObserver.Wh?(f.ULS.sendTraceTag(593376846,0,50,`ActionAggregator<${this.Ala}>.ShouldThrottle: Not Calling PerformAction as document is hidden.`),!0):!1}LAe(){this.Sqc&&this.Sqc.cancel()}startTimer(){this.t0c<=this.cze&&(this.Sqc=k.a.instance.create(this.jZi,this.w_g,t.a.jne))}}Object(r.a)(u,"ActionAggregator",h.a,[650,2]);var y=a(27),v=a(86),C=a(110),x=a(14),B=a(46),H=a(38),I=a(19),U=a(5),S=a(131),G=a(13),D=a(21),E=a(55);class N extends H.a{constructor(bb){super();
this.xw=this.firstElement=null;this.yMa=!1;this.Cs=null;this.FEj=y.a.Cf;this.TEf=Ga=>{const tb=Ga.Ea.keyCode;return tb===v.a.Lh?this.ORi():tb===v.a.By&&Ga.Ea.shiftKey?this.qEh(this.firstElement):!1};this.lKf=Ga=>{if(!this.yMa||Ga.Ea.keyCode!==v.a.ZF)return!1;N.wcf();E.Task.delay(1).So(()=>{this.xw.focus();return!0},0,this.la);return!0};this.G1i=()=>{document.activeElement&&document.activeElement.id===this.xw.id||(N.wcf(),E.Task.delay(1).So(()=>{this.xw.focus();return!0},0,this.la))};this.TCf=()=>
{this.cgg(this.xw)};this.SEf=Ga=>{Ga.stopPropagation();Ga.preventDefault();this.yMa&&(this.yMa=!1)};this.$=bb;(bb=this.$.ea.$b)&&f.ULS.sendTraceTag(39350791,0,50,`EmbedViewFocusControl: PermissionSet = ${bb.Zsa}; InWebPart = '${bb.inWebPart?"Classic":"Non Classic"}', InEmbedView = '${bb.inEmbedView?"True (+Modern)":"False (not Modern)"}'`);bb&&(bb.inWebPart||bb.inEmbedView)?f.ULS.sendTraceTag(537153856,0,15,`EwaControl.EmbedViewFocusControl: disable focus grabbing by embedded workbooks and disable some related keyboard navigation. InWebPart = '${bb.inWebPart?
"Classic":"Non Classic"}', InEmbedView = '${bb.inEmbedView?"True (+Modern)":"False (not Modern)"}'`):(this.pdh(),this.peh(),C.KeyInputManager.instance.ta(x.a.Sb,this.$.domElement,this.lKf));this.$.da.Ha(238,this)}wNg(bb){this.addHandler("KBIS",bb)}wkj(bb){this.removeHandler("KBIS",bb)}dispose(){this.firstElement&&B.a.removeHandler(this.firstElement,x.a.focus,this.TCf);this.Cs&&this.Cs.detach("focus");this.xw&&(B.a.removeHandler(this.xw,x.a.focus,this.SEf),B.a.removeHandler(this.xw,x.a.blur,N.onBlur),
C.KeyInputManager.instance.Ba(x.a.Sb,this.xw,this.TEf));C.KeyInputManager.instance.Ba(x.a.Sb,this.$.domElement,this.lKf);this.Cs=this.xw=this.firstElement=this.$=null;super.dispose()}pdh(){this.FEj?(this.firstElement=document.documentElement,this.Cs=S.a.instance.NG(document.parentWindow),this.Cs.ka("focus",this.G1i)):(this.firstElement=N.PHe(),document.body.insertBefore(this.firstElement,document.body.childNodes[0]),B.a.addHandler(this.firstElement,x.a.focus,this.TCf))}peh(){this.xw=N.PHe();this.xw.id=
U.a.jPe;this.xw.setAttribute(U.a.Vu,G.a.instance.ga(862));document.body.appendChild(this.xw);B.a.addHandler(this.xw,x.a.focus,this.SEf);B.a.addHandler(this.xw,x.a.blur,N.onBlur);C.KeyInputManager.instance.ta(x.a.Sb,this.xw,this.TEf)}qEh(bb){this.cgg(bb);return!1}ORi(){this.yMa=!0;D.h(this.$).focus();D.h(this.$).ha.z$e();this.raiseEvent("KBIS");return!0}cgg(bb){this.yMa?this.yMa=!1:(this.yMa=!0,bb&&bb.focus())}static PHe(){const bb=document.createElement("div");bb.tabIndex=0;return bb}static wcf(){document.body.classList.add(I.a.dSe)}static onBlur(){document.body.classList.remove(I.a.dSe)}}
Object(r.a)(N,"EmbedViewFocusControl",H.a,[649,2]);var M=a(4),L=a(1102),aa=a(63),V=a(522),P=a(24),ba=a(41),Y=a(376),Z=a(193),ea=a(284),ra=a(113),O=a(29),da=a(249),xa=a(282),ia=a(60);const Ma=(bb,Ga,tb,wb,lb,db,Pa,ja,Ka,ub,Kb=null)=>{Kb=bb.Na(1,Kb);Kb.selectedRange=Ga;Kb.richValueKeyPath=tb;Kb.singleColumn=wb;Kb.searchForRange=lb;Kb.calculateMajorityDataType=db;return ia.g(bb,"GetRichValueFieldListContextList",Kb,Pa,ja,Ka,ub,4)};var Ta=a(33);class Da extends H.a{constructor(bb,Ga){super();this.PKb=
this.wgd=this.Ywb=this.XO=null;this.uVb=!1;this.s7d=null;this.WId=!1;this.tTi=(tb,wb,lb)=>{f.ULS.sendTraceTag(25264350,0,10,"Call to GetRichValueFieldListContextList failed in: "+lb);this.PKb&&this.PKb.stop();this.XO=null;this.raiseEvent(L.h)};this.uTi=tb=>{da.a(tb)||(this.PKb&&this.PKb.stop(),this.uVb=!1,(this.XO=tb.Result)&&0<this.XO.length&&f.ULS.sendTraceTag(25264351,0,50,`Retrieved ${this.XO.length} rich value field list context for autocomplete`),this.xWa=!0,this.htc())};this.xWa=!1;this.jb=
bb;this.aUb=-1;this.tableManager=Ga;this.WId=e.EwaSettings.isChangeGateEnabled("OfficeVSO:6395797_raiseFieldInfoLoadedEventOnEmptyResults")&&Ta.a.fV(bb)}J_b(bb){this.addHandler(L.a,bb)}Juc(bb){this.removeHandler(L.a,bb)}WMg(bb){this.addHandler(L.h,bb)}dkj(bb){this.removeHandler(L.h,bb)}get W6a(){return this.xWa}get iBi(){return this.uVb}get YZe(){return this.aUb}get f7c(){return this.s7d}get $(){return this.jb}get Pk(){return this.XO}get UUh(){return!!this.Ywb}dispose(){this.jb=null;this.Pcb();super.dispose()}B6i(){var bb=
Array(6);var Ga={};Ga.Name=L.f;bb[0]=Ga;Ga={};Ga.Name=L.c;bb[1]=Ga;Ga={};Ga.Name=L.d;bb[2]=Ga;Ga={};Ga.Name=L.g;bb[3]=Ga;Ga={};Ga.Name=L.e;bb[4]=Ga;Ga={};Ga.Name=L.b;bb[5]=Ga;Ga={ColumnName:"",ColumnIndex:-1};Ga.FieldInfoDataList=bb;bb=[];bb[0]=Ga;this.tRd(bb)}oZ(bb,Ga,tb,wb=null){if(bb){this.g1c();this.$2b();var lb=null,db=!1;if(!wb&&({vab:db,Pk:lb}=this.EWj(bb,Ga,tb)).returnValue)if(this.WId||this.tRd(lb),this.uVb=!0,this.XO=lb,this.WId){if(!db){this.xWa=!0;this.htc();return}}else if(this.XO&&0<
this.XO.length&&(this.xWa=!0,this.htc()),!db)return;this.Vjg(bb,wb,Ga,tb,!1)}}Vjg(bb,Ga,tb,wb,lb){if(this.$.ea.Xb){this.$.Jb&&(this.PKb=this.$.Jb.Gc("WebServiceCall","GetRichValueFieldInfoListContext"));this.Ywb=null;var db=this.$.oa.xa.Wb();this.Ywb=Ma(this.$.oa.xa,bb,Ga,tb,wb,lb,this.uTi,this.tTi,null,db)}else this.XO=null}Pcb(){this.XO=null;this.xWa=!1;this.g1c();this.$2b();this.Ywb=null;this.aUb=-1}g1c(){Da.Vqb(this.Ywb)}$2b(){Da.Vqb(this.wgd)}htc(){this.raiseEvent(L.a)}Np(bb){bb=ba.D(bb);--bb.left;
--bb.right;return this.tableManager.Np(bb)}tKa(bb){bb.FirstColumn=bb.FirstColumn;bb.LastColumn=bb.LastColumn;bb.FirstRow=bb.FirstRow;bb.LastRow=bb.LastRow;this.$2b();this.wgd=null;return Y.a(this.$.userOperationManager,(Ga,tb,wb)=>ea.i(this.$.oa.xa,bb,xa.b(Ga,lb=>{this.DTi(lb)}),xa.a(tb,tb,lb=>{this.CTi(lb)}),wb,null),Ga=>new Z.a(264,0,Ga,80),null)}CTi(bb){bb=ra.a.Pe(bb.data);f.ULS.sendTraceTag(525336847,0,10,`FieldInfoManager.OnGetFullTableRangeFailure - Webservice call failed with Errors: ${O.a.nc(bb)}`)}DTi(bb){if(da.a(bb))-315732528!==
bb.Errors[0].MessageId&&f.ULS.sendTraceTag(525336846,0,10,`FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call failed with Unexpected error : ${O.a.nc(bb.Errors)}`);else if(bb&&bb.Result){bb=bb.Result;var Ga=bb.HasHeaderRow;Ga=new V.AutofilterRange(bb.TableRange.FirstRow+(Ga?1:0)+1,bb.TableRange.FirstColumn+1,bb.TableRange.LastRow+1,bb.TableRange.LastColumn+1,null,null,null,0,Ga);this.aUb=bb.TableRange.FirstColumn;(bb=this.HPf(!1,!0,Ga))||f.ULS.sendTraceTag(525336844,0,50,"FieldInfoManager.OnGetFullTableRangeSuccess - fieldInfoListContextList is null");
this.tRd(bb)}else f.ULS.sendTraceTag(525336845,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call returned no result")}EWj(bb,Ga,tb){let wb,lb;lb=null;wb=!1;if(bb.SheetName!==this.$.ea.na.sheetName)return{returnValue:!1,vab:wb,tKa:!1,Pk:lb};let db;this.aUb=-1;if(tb){db=this.Np(bb);if(!db||!db.dka)return{returnValue:!1,vab:wb,tKa:!1,Pk:lb};var Pa=D.h(this.$).tb.S6e(db);this.s7d=db;if(e.EwaSettings.isChangeGateEnabled("OfficeVSO:5167298_ObtainFullRangeOfTableForPopulatingInsertDataDropdownCorrectly")&&
Pa&&0<Pa.count)return--bb.FirstColumn,--bb.LastColumn,this.wgd=this.tKa(bb),{returnValue:!0,vab:wb,tKa:!0,Pk:lb};db.top+=1;db.right=ba.D(bb).right-1}else db=new V.AutofilterRange(bb.FirstRow+1,bb.FirstColumn+1,bb.LastRow+1,bb.LastColumn+1,null,null,null,0,!1);if(db.top>db.bottom||db.left>db.right)return{returnValue:!0,vab:wb,tKa:!1,Pk:lb};bb=D.h(this.$);var ja=bb.ib.width,Ka=bb.ib.height;Pa=bb.view.visibleArea;ja=new aa.a(Pa.x-ja,Pa.y-Ka,Pa.width+ja,Pa.height+Ka);Ka=bb.xg(db);if(!Pa||!Ka||!bb.mjc(db))return{returnValue:!1,
vab:wb,tKa:!1,Pk:lb};ja.contains(Ka)||(wb=!0);lb=this.HPf(Ga,tb,db);return{returnValue:!0,vab:wb,tKa:!1,Pk:lb}}tRd(bb){bb&&f.ULS.sendTraceTag(25264348,0,50,`Retrieved ${bb.length} rich value field contexts from block cache`);this.uVb=!0;(this.XO=bb)&&0<this.XO.length&&(this.xWa=!0,this.htc())}HPf(bb,Ga,tb){let wb;wb=null;const lb=tb.clone();if(Ga)for(let db=tb.right,Pa=0;db>=tb.left;--db){if(lb.left=db,lb.right=db,Ga=this.Q2e(lb,!0,tb.left)){wb||(wb=[]);wb[Pa]=Ga;if(bb)break;++Pa}}else if(bb=this.Q2e(lb,
!1))wb=[],wb[0]=bb;return wb}Q2e(bb,Ga,tb=0){var wb=null;if(e.EwaSettings.isChangeGateEnabled("OfficeVSO:5723259_StoreRichValueFieldsInDictionary")){var lb=D.h(this.$).tb.q2h(bb);if(lb&&0<lb.count){var db=Array(lb.count);wb=0;for(var Pa of lb.values)lb={},lb.Name=Pa,db[wb]=lb,++wb;Pa="";lb=-1;0<bb.top&&Ga&&(bb=new P.Range(bb.top-1,bb.left,bb.top-1,bb.left,!1,!1),null!=D.h(this.$).Pb(bb)&&null!=D.h(this.$).Pb(bb).originalText&&(Pa=D.h(this.$).Pb(bb).originalText),lb=bb.left-tb);wb={};wb.ColumnName=
Pa;wb.ColumnIndex=lb;wb.FieldInfoDataList=db}}else if((Pa=D.h(this.$).tb.S6e(bb))&&0<Pa.count){db=Array(Pa.count);wb=0;for(lb of Pa)Pa={},Pa.Name=lb,db[wb]=Pa,++wb;Pa="";lb=-1;0<bb.top&&Ga&&(bb=new P.Range(bb.top-1,bb.left,bb.top-1,bb.left,!1,!1),Pa=D.h(this.$).Pb(bb).originalText,lb=bb.left-tb);wb={};wb.ColumnName=Pa;wb.ColumnIndex=lb;wb.FieldInfoDataList=db}return wb}static Vqb(bb){bb&&M.AFrameworkApplication.Bd.Nt(bb.Rs)}}Object(r.a)(Da,"FieldInfoManager",H.a,[346,2]);class fa extends Da{constructor(bb,
Ga,tb,wb){super(bb,Ga);this.q2a=null;this.NCf=()=>{this.Juc(this.NCf);if(this.Pk&&this.Pk.length&&this.contextMenuManager){var lb=this.contextMenuManager.Jfd("autoFilterRichFieldList"),db=window.document.getElementById(this.q2a);lb.w0(null,db,this,null,!0)}};this.stg=tb;this.contextMenuManager=wb}get FG(){return this.stg}dVh(bb,Ga){this.q2a=Ga;f.ULS.sendTraceTag(537153825,0,100,`FilterInfoManager.GetFilterFieldInfoListContextAsync - Retrieving the list of field list context for row, col, row, col (${bb.FirstRow}, ${bb.FirstColumn}, ${bb.LastRow}, ${bb.LastColumn})`);
this.Vjg(bb,null,!0,!1,!0)}}Object(r.a)(fa,"FilterInfoManager",Da,[348,346,2]);var ua=a(856),Fa=a(1114),ca=a(30),ka=a(89),Ca=a(8);class fb{}fb.qyh="ewa-sharedUi-launchButton";fb.tyh="ewa-sharedUi-launchButtonWithText";fb.ryh="ewa-sharedUi-launchButtonClick";fb.uyh="ewa-sharedUi-launchButtonWithTextClick";fb.syh="ewa-sharedUi-launchButtonText";Object(r.a)(fb,"CssClassNames",null,[]);var yb=a(65);a(517);var mb=a(240),nb=a(227);H=a(239);var X=a(287),R=a(74),wa=a(11),na=a(254),Ba=a(34);class Ra extends H.a{constructor(bb,
Ga,tb,wb,lb,db,Pa,ja,Ka){super(document.createElement("div"));this.npf=null;this.vVd=!1;this.htmlSanitizationHelper=this.UOb=this.KSa=null;this.xN=()=>{this.raiseEvent("OnObjectButtonMouseOver")};this.wN=()=>{this.raiseEvent("OnObjectButtonMouseOut")};this.ZKj=()=>{this.vne()};this.fd=ub=>{this.raiseEvent(this.cIb,ub);this.bIb();return!0};this.uRi=ub=>{100<w.a(z.a.Ya,this.npf)&&this.Kkd(new Sys.UI.Point(Math.round(ub.clientX),Math.round(ub.clientY)))};this.sN=ub=>{R.g(ub.Ea,!1);return!1};this.RY=
this.Ae.bIa();this.set_visible(!1);this.Sjc=lb;this.cIb=db;this.Ync=bb;this.e4b=Ga;this.htmlSanitizationHelper=Ka;this.Sjc&&(this.KSa=k.a.instance.create(this.ZKj,3E4,"OnObjectButton.ShyTimerFired",!1,!1));bb&&this.domElement.classList.add(bb);this.YGa=document.createElement("div");this.domElement.appendChild(this.YGa);tb&&this.YGa.classList.add(tb);this.V_d(wb);Pa&&(this.UOb=document.createElement("div"),this.domElement.appendChild(this.UOb),this.UOb.classList.add(ja),this.UOb.innerText=Pa,this.domElement.style.padding=
"3px",mb.a.instance.ta(x.a.pointerDown,this.domElement,this.sN));this.x_a=new X.a(this.domElement,7);nb.a.instance.ta(x.a.click,this.domElement,this.fd);e.EwaSettings.isChangeGateEnabled("OfficeVSO:4996434_AvoidSelectionFromClickInOOUIPadding")&&mb.a.instance.ta(x.a.pointerDown,this.domElement,this.sN);bb=ub=>{R.g(ub)};this.Cc.ka("mouseup",bb);this.Cc.ka("click",bb);this.Cc.ka("dblclick",bb)}m2(bb){this.addHandler(this.cIb,bb)}tda(bb){this.get_events().removeHandler(this.cIb,bb)}PNg(bb){this.addHandler("OnObjectButtonMouseOver",
bb)}Nkj(bb){this.get_events().removeHandler("OnObjectButtonMouseOver",bb)}ONg(bb){this.addHandler("OnObjectButtonMouseOut",bb)}Mkj(bb){this.get_events().removeHandler("OnObjectButtonMouseOut",bb)}V_d(bb){bb&&(e.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&e.EwaSettings.isChangeGateEnabled("OfficeVSO:7144167_OnObjectButton")?this.htmlSanitizationHelper.Rh(this.YGa,bb):this.YGa.innerHTML=bb)}b_j(bb,Ga,tb){e.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&
e.EwaSettings.isChangeGateEnabled("OfficeVSO:7144167_OnObjectButton")?this.htmlSanitizationHelper.KG(this.YGa):this.YGa.innerHTML="";bb?bb.pba(Ga,16,16,this.YGa,16,16,void 0,tb):f.ULS.sendTraceTag(537153824,0,10,"OnObjectButton.UpdateButtonSvgImage: Called without svgIconProvider")}c_j(bb,Ga){bb&&(this.UOb.innerText=bb);this.domElement.title=Ga}dispose(){this.get_isInitialized()&&(this.hide(),this.Cc.DC(),ka.a.pc([this.RY,this.x_a]),nb.a.instance.Ba(x.a.click,this.domElement,this.fd),mb.a.instance.Ba(x.a.pointerDown,
this.domElement,this.sN),this.KSa&&this.KSa.dispose(),super.dispose())}Ncb(){this.e4b&&this.domElement.classList.remove(this.e4b);this.Ync&&this.domElement.classList.add(this.Ync)}bIb(){this.Ync&&this.domElement.classList.remove(this.Ync);this.e4b&&this.domElement.classList.add(this.e4b);this.E2a()}E2a(){this.Sjc&&(this.KSa.cancel(),this.acg(),this.setOpacity(1));this.set_visible(!0)}xp(bb,Ga,tb,wb,lb=!1){bb=Ba.a(wb).mi(bb);Ga=Ba.a(wb).mi(Ga);Ba.a(wb).vyc(this.domElement);this.domElement.style.top=
wa.HelperMethods.sc(Ga);this.domElement.style.left=this.domElement.style.right="";Ga=bb;lb&&(Ga=bb-this.domElement.offsetWidth);na.c(this.domElement.style,tb,wa.HelperMethods.sc(Ga));this.set_visible(!0);this.setOpacity(1);this.Sjc&&(this.vVd=!1,this.RNj(),this.KSa.Yp())}hide(){this.Ncb();this.set_visible(!1);this.Sjc&&(this.acg(),this.KSa.cancel())}d9b(){this.Cc.ka("mouseover",this.xN,!0);this.Cc.ka("mouseout",this.wN,!0)}RNj(){this.RY.Ci("mousemove")||this.RY.ka("mousemove",this.uRi)}acg(){this.RY.Ci("mousemove")&&
this.RY.detach("mousemove")}Kkd(bb){if(this.domElement.parentNode){var Ga=Sys.UI.DomElement.getBounds(this.domElement);const tb=new Sys.UI.Point(Math.round(Ga.x+Ga.width),Math.round(Ga.y+Ga.height));Ga=Math.abs(tb.x-bb.x);bb=Math.abs(tb.y-bb.y);bb=Ga>bb?Ga:bb;this.vVd?this.setOpacity(Ra.z0g(bb)):100>=bb&&this.vne()}}vne(){this.vVd=!0;this.KSa.cancel()}setOpacity(bb){y.a.setOpacity(this.domElement,bb);this.npf=z.a.Ya.Ub}static z0g(bb){return 100>=bb?1:250<=bb?0:.01*(100-(bb-100)/150*100)}}Object(r.a)(Ra,
"OnObjectButton",H.a,[612,185,2]);var qa=a(804);const La=fb.syh;class Yb extends h.a{constructor(bb,Ga,tb,wb,lb,db,Pa,ja,Ka=""){super();this.tka=null;this.$cf=!1;this.htmlSanitizationHelper=this.wnc=this.xnc=null;this.buttons={};this.QQe={};this.$=bb;this.svgIconProvider=Ga;this.NPi=tb;this.Ofc=wb;this.Nfc=lb;this.altText=db;this.cIb=Pa;this.htmlSanitizationHelper=ja;this.buttonText=Ka}get $y(){return Ba.a(this.$).oGa(Ca.a.vXi)}get C3b(){return Ca.a.uXi}get buttonWidth(){return Ba.a(this.$).oGa(Ca.a.wXi)}dispose(){this.eoh();
this.$=null;super.dispose()}getButton(bb,Ga=!0){return this.bva(bb,Ga)}bva(bb,Ga=!0){const tb=bb.toString();tb in this.buttons||this.reh(bb,Ga);return this.buttons[tb]}xp(bb,Ga,tb,wb,lb=!0,db=!1){this.hide();if(this.$.ea.isNamedObjectViewMode&&yb.i(this.$.na)){var Pa=D.h(this.$).MR.domElement;const ja=bb+this.buttonWidth-Pa.scrollWidth;Pa=Ga+this.buttonWidth-Pa.scrollHeight;bb=0<ja?bb-ja:bb;Ga=0<Pa?Ga-Pa:Ga}this.bva(wb,lb).xp(bb,Ga,tb,this.$,db)}hide(){const bb=this.buttons;for(let Ga in bb)bb[Ga].hide()}d9b(bb,
Ga){!this.$cf&&(Ga=this.buttons[Ga.toString()])&&(this.xnc=(tb,wb)=>{bb(wb,!0)},Ga.PNg(this.xnc),this.wnc=(tb,wb)=>{bb(wb,!1)},Ga.ONg(this.wnc),this.$cf=!0,Ga.d9b())}reh(bb,Ga){this.tka=String.format(this.Ofc===I.a.V9b?'<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>':'<img class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1"/>',ca.a.yg(this.Ofc),ca.a.yg(this.Nfc),"{0}");var tb=String.format(this.tka,ca.a.yg(this.altText));Ga=new Ra(""===this.buttonText?
fb.qyh:fb.tyh,""===this.buttonText?fb.ryh:fb.uyh,I.a.Or,tb,Ga,this.cIb,this.buttonText,La,this.htmlSanitizationHelper);tb=(wb,lb)=>{this.NPi(lb,bb)};Ga.m2(tb);this.buttons[bb.toString()]=Ga;this.QQe[bb.toString()]=tb;tb=D.h(this.$).Rf(bb);tb.domElement.insertBefore(Ga.domElement,tb.domElement.firstChild)}eoh(){for(const bb of qa.a(this.buttons)){const Ga=this.buttons[bb];Ga.tda(this.QQe[bb]);ka.a.Ja(Ga);delete this.buttons[bb];this.xnc&&Ga.Nkj(this.xnc);this.wnc&&Ga.Mkj(this.wnc)}}domElement(bb){return this.bva(bb).domElement}E2a(bb){this.bva(bb).E2a()}Sjg(bb,
Ga){this.Ofc=bb;this.Nfc=Ga}nQb(bb,Ga,tb=!0){this.tka=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',ca.a.yg(this.Ofc),ca.a.yg(this.Nfc),"{0}");bb=String.format(this.tka,ca.a.yg(bb));this.bva(Ga,tb).V_d(bb)}jUa(bb,Ga,tb){this.bva(tb,!1).c_j(bb,Ga)}Qjg(){this.tka=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',"{0}",ca.a.yg(this.Nfc),"{1}");const bb=String.format(this.tka,void 0,
ca.a.yg(void 0));this.bva(void 0,!1).V_d(bb)}Rjg(bb,Ga,tb){this.bva(tb,!1).b_j(this.svgIconProvider,bb,Ga)}}Object(r.a)(Yb,"OnObjectLaunchButton",h.a,[597,2]);h=a(96);class mc extends h.a{constructor(bb,Ga){super(bb);this.JDb=null;this.Pnh=()=>{this.display()};this.kfi=Math.max(1,Ga)}dispose(){ka.a.Ja(this.JDb);this.JDb=null;super.dispose()}$Sa(){ka.a.Ja(this.JDb);this.JDb=k.a.instance.create(this.Pnh,this.kfi,t.a.mBi)}fTa(){ka.a.Ja(this.JDb);this.hide()}}Object(r.a)(mc,"LoadingIndicatorBehavior",
h.a,[611,2]);class Zb extends mc{constructor(bb,Ga,tb,wb){super(bb,Ga);this.IDb=null;this.Qvg=tb;this.wci=wb;this.CJg()}dispose(){this.IDb=null;super.dispose()}display(){this.Qvg(this.IDb)}hide(){this.wci(this.IDb)}CJg(){this.IDb=document.createElement("div");this.domElement.appendChild(this.IDb)}}Object(r.a)(Zb,"ShimmerLoadingIndicatorBehavior",mc,[]);var qb=a(72),Ha=a(51),Ya=a(12);class Gb extends mc{constructor(bb,Ga,tb,wb=null,lb=null,db=0){super(bb,Ga);this.iwa=this.TNa=null;this.iwa=tb;this.Tfc=
wb||Ha.a.current.qo(103);this.frf=db;this.k7c=lb;this.BJg()}dispose(){this.TNa=null;super.dispose()}display(){Ya.DOMElementExtensions.setVisible(this.TNa,!0)}hide(){Ya.DOMElementExtensions.setVisible(this.TNa,!1)}BJg(){this.TNa=document.createElement("div");this.TNa.classList.add(qb.a.bxh);const bb=document.createElement("div");bb.classList.add(qb.a.cxh);this.k7c&&""!=this.k7c&&bb.classList.add(this.k7c);var Ga=0===this.frf?"":G.a.instance.ga(this.frf);const tb=String.format('<div class="'+qb.a.dxh+
'">{0}</div>',Ga);this.Tfc?(Ga=`<img src="${this.Tfc}" alt="${Ga}" title="${Ga}"/>`,this.iwa?this.iwa.Rh(bb,Ga+tb):bb.innerHTML=Ga+tb):this.iwa?this.iwa.Rh(bb,tb):bb.innerHTML=tb;this.TNa.appendChild(bb);this.domElement.appendChild(this.TNa)}}Object(r.a)(Gb,"SpinnerLoadingIndicatorBehavior",mc,[]);class Ja{constructor(bb){this.iwa=bb}i6c(bb,Ga,tb){return new ua.a(bb,Ga,tb)}b6b(bb,Ga,tb,wb,lb,db,Pa,ja,Ka,ub){return new Fa.a(bb,Ga,tb,wb,lb,db,Pa,ja,Ka,ub)}Rsb(bb,Ga,tb,wb,lb=0){return new Gb(bb,Ga,this.iwa,
tb,wb,lb)}Uhd(bb){return bb.da.Aa(238)||new N(bb)}e6b(bb,Ga,tb,wb,lb,db,Pa,ja=""){return new Yb(bb,Ga,tb,wb,lb,db,Pa,this.iwa,ja)}K5c(bb,Ga){return new Da(bb,Ga)}kdh(bb,Ga,tb,wb){return new fa(bb,Ga,tb,wb)}p5c(bb,Ga,tb,wb){return new u(bb,Ga,tb,wb)}}Object(r.a)(Ja,"SharedUIControlsFactory",null,[552]);var Na=a(50);class Qa extends b.a{constructor(bb){super();this.$=bb;this.Db()}create(){if(e.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&e.EwaSettings.isChangeGateEnabled("OfficeVSO:7134912_ReduceInnerHTMLUsageSpinnerLoading")){const bb=
Na.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Xa);l.TaskExtensions.za(bb,()=>{e.EwaSettings.cl()?this.nb(this.$.da.Aa(12)||new Ja(bb.result)):this.nb(new Ja(bb.result))},this.la,3)}else e.EwaSettings.cl()?this.nb(this.$.da.Aa(12)||new Ja(null)):this.nb(new Ja(null))}static ka(bb){bb.da.Ha(477,new Qa(bb))}}Object(r.a)(Qa,"SharedUIControlsFactoryServiceFactory",b.a,[]);a.d(F,"a",function(){return Oa});const Oa=()=>{c.a.Fa(Qa.ka)}},1191:function(r,F,a){var c=a(9);r=a(0);var b=a(226),e=a(50),f=a(37),
d=a(1),h=a(825);class l extends b.a{constructor(W){super();this.$=W;this.Db()}create(){const W=e.GetServiceTaskFactory.create(this.$.da,18,this.la,this.Xa),za=e.GetServiceTaskFactory.create(this.$.da,102,this.la,this.Xa);f.TaskExtensions.za(f.TaskExtensions.Fd([W,za],this.la),()=>{this.nb(this.$.da.Aa(296)||this.$.da.Ha(296,new h.BorderFormatManager(this.$,W.result,za.result)))},this.la,3)}static ka(W){d.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")&&W.da.Ha(468,
new l(W))}}Object(r.a)(l,"BorderFormatManagerFactory",b.a,[]);var k=a(709),t=a(15),n=a(268),z=a(174),w=a(841),m=a(27),u=a(40),y=a(30),v=a(97),C=a(264),x=a(356),B=a(353),H=a(99),I=a(192),U=a(8),S;(function(W){W[W.insert=1]="insert";W[W.delete=2]="delete";W[W.rows=4]="rows";W[W.columns=8]="columns";W[W.cellsShiftHorizontal=16]="cellsShiftHorizontal";W[W.cellsShiftVertical=32]="cellsShiftVertical";W[W.insertRows=5]="insertRows";W[W.insertColumns=9]="insertColumns";W[W.insertCellsShiftRight=17]="insertCellsShiftRight";
W[W.insertCellsShiftDown=33]="insertCellsShiftDown";W[W.deleteRows=6]="deleteRows";W[W.deleteColumns=10]="deleteColumns";W[W.deleteCellsShiftLeft=18]="deleteCellsShiftLeft";W[W.deleteCellsShiftUp=34]="deleteCellsShiftUp";W[W.insertRowsBelow=37]="insertRowsBelow"})(S||(S={}));Object(r.b)("InsertDeleteCellFlags",S);var G=a(5),D=a(427),E=a(65),N=a(68);class M{constructor(W){this.insertDeleteMultiRangeParameters=null;this.insertDeleteMultiRangeParameters=W}}Object(r.a)(M,"MacroRecorderRangeInsertedOrDeletedPayload",
null,[162]);var L=a(1100),aa=a(41),V=a(376),P=a(193),ba=a(60),Y=a(284),Z=a(140),ea=a(461),ra=a(117),O=a(51),da=a(205),xa=a(94),ia=a(35),Ma=a(29),Ta=a(249),Da=a(260),fa=a(11),ua=a(189),Fa=a(22),ca=a(282);class ka{constructor(W,za,Sa,Wa,ab=0){this.Ywg=W;this.Zwg=za;this.OEg=Sa;this.iYb=Wa;this.EJh=ab}get TJa(){return this.Ywg}get formattedText(){return this.Zwg}get style(){return this.OEg}get size(){return this.iYb}get kZ(){return this.EJh}static eZg(W,za){return new ka(W,za,null,null,null)}static l0c(W,
za){return new ka(W,null,za,null,null)}static fZg(W,za){return new ka(W,null,null,za,null)}static dZg(W,za,Sa){return new ka(W,null,za,null,Sa)}}Object(r.a)(ka,"CachedPreviewCellGroup",null,[]);var Ca=a(84);b=a(285);var fb=a(101),yb=a(13);class mb extends b.a{constructor(W,za,Sa){super(W);this.el=null;this.B8c=0;this.jji=(Wa,ab)=>{if(0===Wa)t.ULS.sendTraceTag(574993491,0,50,"InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: User pressed Cancel");else{Wa={};var ma="",ha=1035996630;switch(ab.selectedKey){case 0:ma=
1896159024===this.yr?"InsertCellsShiftRight":"DeleteCellsShiftLeft";break;case 1:ma=1896159024===this.yr?"InsertCellsShiftDown":"DeleteCellsShiftUp";break;case 2:1896159024===this.yr?(ma="InsertRows",ha=-1113896058):(ma="DeleteRows",ha=1554436520);break;case 3:1896159024===this.yr?(ma="InsertColumns",ha=1415868706):(ma="DeleteColumns",ha=674605324)}t.ULS.sendTraceTag(574993490,0,50,`InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: Handle RibbonCommand.InsertOrDeleteCells, MenuItemId:${ma}`);
ab=new xa.a(ha,1,2,8,null);Wa[N.a.Kc]=ma;this.$.Ia.Hb(ab,Wa)}};this.yr=za;this.selectedRanges=Sa;this.isRtl=Object(Ca.a)(fb.a,this.$.va.na).displayRtl}get kc(){return"InsertDeleteCellsDialog"}ig(){1896159024===this.yr?(this.el=yb.a.instance.ga(23),this.B8c=0):(this.el=yb.a.instance.ga(22),this.B8c=1);const W=this.selectedRanges[0].XZ&&!this.selectedRanges[0].i5?0:1;this.Ob=1;this.initializeAndShow(this.el,this.jji,{[mb.it]:this.kc,["dialogToDisplay"]:this.B8c,["defaultSelectedKey"]:W,["isRtl"]:this.isRtl})}}
Object(r.a)(mb,"InsertDeleteCellsDialog",b.a,[]);const nb=(W,za,Sa,Wa,ab,ma,ha=null)=>{ha=W.Na(41,ha);ha.insertDeleteMultiRangeParameters=za;return ba.g(W,"InsertDeleteCells",ha,Sa,Wa,ab,ma,0)};class X{constructor(W,za,Sa,Wa){this.targetSheetRange=this.sourceSheetRange=null;this.fillRangeDirection=this.fillRangeType=0;this.sourceSheetRange=W;this.targetSheetRange=za;this.fillRangeType=Sa;this.fillRangeDirection=Wa}}Object(r.a)(X,"MacroRecorderRangeFilledPayload",null,[162]);var R=a(7),wa=a(24);class na{constructor(){this.gRa=
this.SGa=this.JNa=this.OTa=0}}Object(r.a)(na,"RangeBorders",null,[]);class Ba{constructor(){this.scenario=0;this.fQ=null}}Object(r.a)(Ba,"ScenarioInfo",null,[]);var Ra=a(928),qa=a(21),La=a(267),Yb=a(214),mc=a(80),Zb=a(61);class qb{constructor(W,za){this.$=W;this.Nh=za;this.ux=new Ra.a(qa.h(this.$).Ca,this.$);this.wAb=d.EwaSettings.isChangeGateEnabled("OfficeVSO:5607672_MergeCellCseForOutOfViewPortCells");this.yrd=d.EwaSettings.isChangeGateEnabled("OfficeVSO:5658006_MergeCellCSEBugFixesforCellStylesAndRTL");
this.Cic=d.EwaSettings.isChangeGateEnabled("OfficeVSO:5954689_MergeCellCSEUnmergewithMergeCommand");this.mjf=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6013788_MergeCellHighGetRangeNumbersTelemetry");this.Jni=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6100978_MergeCellCSEIsCsePossibleForWrapTextWrongValueForUnmergeCommandFix");this.snf=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1);this.ljc=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6147046_MergeCellCSERangeBorderScenarioFix");
this.pBb=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellMultipleBlocksScenarioCse",!1);this.Dic=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellBorderScenarioCse",!1);this.gri=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6327711_MergeCellMultiBlockUnmergeBitFix");this.Rni=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6350260_MergeCellCSEDataLossScenarioUnmergeConditionFix");this.bhf=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6209366_MergeCellCSECellFormatAssertFix");
this.jjf=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6402649_HiddenCellsAvoidCseFixEnabled");this.zri=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6476102_MergeCellCSEMultiBlockMergeFlagsFix");this.Wwi=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6665369_MergeCellCSEWrapTextFixForUnmergeScenarios")}dispose(){this.$=null}Qni(W,za){return!(void 0===za||null===za)&&!!(za.scenario&16384)&&!this.Sni(W,za)&&this.Vgf(za,W)}K4e(){var W=u.a.Td(),za=qa.h(this.$),Sa=za.ha.qa.selectedRanges;let Wa=0;var ab=
0,ma=Sa.length;const ha=new Ba;if(1<ma)return ha.scenario=4,ha;if(this.jjf&&(ma=za.Mj("MergeCell"),Object(Zb.a)(ma),ma.value.zBb(Sa[0])))return ha.scenario=262144,ha;this.yrd&&qa.h(this.$).rtl&&(Wa|=65536);if(!za.aN(Sa[0]))if(this.wAb)Wa|=32;else return ha.scenario=32,ha;if(za=za.Ca.Cja(Sa[0],this.$.activeItemName)){ha.H_c=za;for(var eb of za)if(ab+=1,1<ab){this.wAb?(Wa|=256,ha.scenario=Wa):ha.scenario=256;if(!this.pBb)return ha;break}}ab=qa.h(this.$).Ca.pja(Sa[0]);if(!ab)return ha.scenario=32768,
ha;eb=ab.length;Sa=Sa[0];za=Sa.bottom-Sa.top+1;ma=Sa.right-Sa.left+1;const ta=new na;for(let ya=0;ya<eb;ya++)if(this.b1h(ab[ya],Sa,ta),Wa=Wa|(void 0!==ab[ya].text&&null!==ab[ya].text&&""!==ab[ya].text?1:0)|(ab[ya].hz?2:0)|(ab[ya].bka?8:0)|(ab[ya].Ayb?16:0)|(ab[ya].RA?64:0)|(ab[ya].MM?128:0),void 0!==ab[ya].text&&null!==ab[ya].text&&""!==ab[ya].text||ab[ya].bka)if(void 0===ha.fQ||null===ha.fQ)ha.fQ=qa.h(this.$).Pb(ab[ya].getRange());else{if(ab[ya].getRange().top<ha.fQ.range.top||ab[ya].getRange().top==
ha.fQ.range.top&&ab[ya].getRange().left<ha.fQ.range.left)ha.fQ=qa.h(this.$).Pb(ab[ya].getRange());Wa|=16384}ta.OTa===ma&&(Wa|=512);ta.SGa===ma&&(Wa|=2048);ta.JNa===za&&(Wa|=4096);ta.gRa===za&&(Wa|=1024);if(0<ta.OTa&&ta.OTa<ma||0<ta.SGa&&ta.SGa<ma||0<ta.JNa&&ta.JNa<za||0<ta.gRa&&ta.gRa<za)Wa|=8192;!d.EwaSettings.isChangeGateEnabled("OfficeVSO:6217608_Add_Entire_Row_Column_Selection_flag")||Sa.right!==Sa.maxColumns&&Sa.bottom!==Sa.maxRows||(Wa|=131072);W=u.a.Td()-W;t.ULS.sendTraceTag(537159424,0,50,
`Execution time of GetMergeCellScenario is : ${W}`);ha.scenario=Wa;return ha}Lvf(W,za){const Sa=W.command;if(void 0===za||null===za)za=this.K4e();if(!this.Vgf(za,Sa))return!1;W=qa.h(this.$).ha.qa.selectedRanges;var Wa=qa.h(this.$).Ca.pja(W[0]);if(!Wa)return!1;if(d.EwaSettings.isChangeGateEnabled("OfficeVSO:5993850_HandleSingleCellMergeScenario")&&1===Wa.length&&!Wa[0].hz)return-167499203===Sa?(Wa[0].r0(2,!0),!0):!1;Wa=qa.h(this.$).ha.qa.es;const ab=this.$.na.sheetName;let ma=!0;switch(Sa){case -167499203:2===
(za.scenario&2)&&this.Cic?this.Zhg(za.scenario,W,Sa):ma=this.oIi(za,W);break;case 1097660126:(za=this.Mvf(za,W))&&0!=za.length||(ma=!1);break;case 155820588:this.Zhg(za.scenario,W,Sa);break;default:return!1}qa.h(this.$).l4(W,Wa,ab,null,W[0],null,null,0,"MergeCellCommandAction");return this.pBb?ma:!0}Vgf(W,za){const Sa=this.Ami(W,za);if(!this.mjf)return Sa;const Wa=qa.h(this.$).ha.qa.selectedRanges[0].RC(!1);t.ULS.sendTraceTag(526149324,0,50,`Merge Cell Command: ${za.toString()}; Scenario Number: ${W.scenario}; IsCSEPossible result: ${Sa}; Range: ${Wa}`);
return Sa}Ami(W,za){if(-255094134===za)return!1;var Sa=W.scenario;if(this.jjf&&262144===Sa||this.yrd&&65536===(Sa&65536))return!1;if(this.rnf(za,W))return Sa=qa.h(this.$).ha.qa.selectedRanges,0===Sa.length?!1:this.bwi(za,W,Sa[0]);this.wAb&&32===(Sa&32)&&(Sa&=-33);if(256==(Sa&256))if(this.yri(W))Sa&=-257;else return!1;return 32768===Sa||4===Sa||128===(Sa&128)||!this.wAb&&32===Sa?!1:-167499203!=za&&1097660126!==za||!this.qpd(W)?void 0!==W.fQ&&null!==W.fQ&&W.fQ.rS?!1:0===Sa?!0:16384===(Sa&16384)?d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",
!1):1!==(Sa&1)&&8!==(Sa&8)||!d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellContentScenarioCse",!1)?!1:!0:this.Dic}Goi(W){return 131072===(W.scenario&131072)?!0:!1}yri(W){if(!this.pBb)return!1;let za="Multi block",Sa=!0;this.qpd(W)&&(za+=" with border",Sa=!1);this.Goi(W)&&(Sa=!1,za+=" with entire row or column selected",16384===(W.scenario&16384)&&(za+=" and a data loss scenario"));Sa||t.ULS.sendTraceTag(523511383,0,50,`CSE for ${za}, is not enabled`);return Sa}qpd(W){return 16===
(W.scenario&16)||this.jld(W.scenario)||this.Dld(W.scenario)||this.uld(W.scenario)||this.Fld(W.scenario)||8192===(W.scenario&8192)?!0:!1}Sni(W,za){return this.Rni?this.rnf(W,za):155820588===W}rnf(W,za){return 155820588===W||(-167499203===W||1097660126===W)&&2===(za.scenario&2)&&this.Cic?!0:!1}awi(W){return this.Fld(W.scenario)||this.uld(W.scenario)||this.jld(W.scenario)||this.Dld(W.scenario)?!0:!1}vbi(W){W=qa.h(this.$).Ca.pja(W);if(!W||0===W.length)return!1;for(let za=0;za<W.length;za++)if(W[za].hz&&
W[za].rS)return!0;return!1}bwi(W,za,Sa){if(1097660126===W&&2===(za.scenario&2))return!1;if(this.Wwi){if(this.vbi(Sa))return!1}else if(this.Jni&&void 0!==za.fQ&&null!==za.fQ&&za.fQ.rS)return!1;this.wAb&&32===(za.scenario&32)&&(za.scenario&=-33);return 32768===za.scenario||4===za.scenario||256===(za.scenario&256)&&this.gri||128===(za.scenario&128)?!1:2===(za.scenario&2)?this.awi(za)?d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1):d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithoutBorderScenariosCse",
!1):!1}b1h(W,za,Sa){const Wa=W.getRange();if(Wa.top===za.top)if(W.rLa)Sa.OTa+=Wa.right-Wa.left+1;else{var ab=this.ux.lQ(Wa,0);if(ab)for(const ha of ab)ha.Uva&&(Sa.OTa+=ha.getRange().right-ha.getRange().left+1)}if(Wa.left===za.left)if(W.pLa)Sa.JNa+=Wa.bottom-Wa.top+1;else if(ab=this.ux.lQ(Wa,2))for(var ma of ab)ma.Yva&&(Sa.JNa+=ma.getRange().bottom-ma.getRange().top+1);if(Wa.bottom===za.bottom)if(W.Uva)Sa.SGa+=Wa.right-Wa.left+1;else if(ma=this.ux.lQ(Wa,1))for(const ha of ma)ha.rLa&&(Sa.SGa+=ha.getRange().right-
ha.getRange().left+1);if(Wa.right===za.right)if(W.Yva)Sa.gRa+=Wa.bottom-Wa.top+1;else if(W=this.ux.lQ(Wa,3))for(const ha of W)ha.pLa&&(Sa.gRa+=ha.getRange().bottom-ha.getRange().top+1)}Rhj(W,za){for(let Sa of za.H_c){za=W.we(Sa.De);za=qa.h(this.$).Ca.pja(za);const Wa=za.length;for(let ab=1;ab<Wa;ab++){const ma=qa.h(this.$).Pb(za[ab].getRange());this.Dic?ma.cell.deleteCellFromModel():(ma.prb(),ma.clearFormat(),ma.cell.Shj());ma.AJb(!0)}}}A2j(W,za){W.backgroundColor=za.backgroundColor;W.color=za.color}ppg(W,
za){return{SpansBlocks:!0,OriginRow:W,OriginColumn:za,IsOrigin:!1,Columns:0,Rows:0,Width:0,Height:0,OriginDeltaX:0,OriginDeltaY:0}}mIg(W,za,Sa,Wa,ab){Sa=W.we(Sa.De);if(!Sa)return t.ULS.sendTraceTag(523547158,0,15,"blockRange(intersection of block's range and the selected range) can't be null as the blocks we are checking are returned as the intersecting blocks"),null;var ma=new wa.Range(W.top,W.left,Sa.top,Sa.left,!1,!1);let ha;Sa.top==W.top?ha=0:(ma.bottom=Sa.top-1,ha=za.vid(ma));Sa.left==W.left?
ma=0:(ma.right=Sa.left-1,ma=za.wid(ma));za=this.ppg(W.top-1,W.left-1);za.OriginDeltaY=ha;za.OriginDeltaX=ma;za.Rows=Sa.bottom-Sa.top;za.Columns=Sa.right-Sa.left;za.Height=ab;za.Width=Wa;Sa.top==W.top&&Sa.left==W.left&&(za.IsOrigin=!0);W=qa.h(this.$).Pb(Sa.topLeft);W.cell.F5f(za);return W}VRd(W,za){let Sa=[];const Wa=qa.h(this.$).Mj("MergeCell");if(!Object(Zb.c)(Wa))return Sa;const ab=Wa.value.vid(W),ma=Wa.value.wid(W);if(za.H_c)for(const ha of za.H_c)if(za=this.mIg(W,Wa.value,ha,ma,ab))Sa.push(za);
else{Sa=[];break}return Sa}f2h(W,za,Sa,Wa){var ab=Sa.bottom-Sa.top,ma=Sa.right-Sa.left;let ha=[];const eb=Wa.scenario;if(256===(eb&256)){if(ha=this.VRd(Sa,Wa),!ha||0==ha.length)return ha}else za.cell.VRd(ab,ma),ha.push(za);ab=this.N2(this.G4(za),!0,0,eb,"merge");if(void 0!==W&&null!==W)for(const ta of ha){ma=W.cell.formattedText;const ya=Object(R.a)(new La.a,{TextRuns:ma.TextRuns,Fonts:ma.Fonts});ya.Text=void 0!==W.cell.originalText&&null!==W.cell.originalText?W.cell.originalText:void 0!==W.cell.userInput&&
null!==W.cell.userInput?W.cell.userInput:ma.Text;ab=this.N2(this.G4(ta),ab,1,eb,"merge");this.Nh.BSa(ta,ya,!1,!0,"MergeCells",1);ab=this.N2(this.G4(ta),ab,2,eb,"merge");this.yrd?ta.zrb(W):this.A2j(ta,W);ab=this.N2(this.G4(ta),ab,3,eb,"merge");ta.cell.sah(W.cell);ab=this.N2(this.G4(ta),ab,4,eb,"merge");ta.cell.CEc(!1);ab=this.N2(this.G4(ta),ab,6,eb,"merge")}this.Rhj(Sa,Wa);this.N2(this.G4(za),ab,5,eb,"merge");return ha}uld(W){return 4096===(W&4096)}Fld(W){return 512===(W&512)}jld(W){return 2048===
(W&2048)}Dld(W){return 1024===(W&1024)}Hbc(W,za){let Sa=null;for(let Wa=0;Wa<W.length;Wa++)if(W[Wa].BorderPosition===za){Sa=W[Wa];break}return Sa}eYh(W,za){this.ljc?(za=this.Hbc(za.cell.DM().Borders,2))&&W.push(za):(za=za.cell.DM().Borders,1<za.length&&(za=[za[1]]),W=[...za,...W]);return W}y5h(W,za){this.ljc?(za=this.Hbc(za.cell.DM().Borders,0))&&W.push(za):(za=za.cell.DM().Borders,1<za.length&&(za=[za[0]]),W=[...za,...W]);return W}WPh(W,za){za=this.ux.lQ(za.cell.getRange(),1);if(!za||0===za.length)return W;
if(this.ljc){if(za=za[0].DM().Borders,za=this.Hbc(za,0))za.BorderPosition=1,W.push(za)}else{let Sa=[];0<za.length&&(Sa=za[0].DM().Borders);Sa[0].BorderPosition=1;W=[...Sa,...W]}return W}r2h(W,za){za=this.ux.lQ(za.cell.getRange(),3);if(!za||0===za.length)return W;if(this.ljc){if(za=za[0].DM().Borders,za=this.Hbc(za,2))za.BorderPosition=3,W.push(za)}else{let Sa=[];0<za.length&&(Sa=za[0].DM().Borders);Sa[0].BorderPosition=3;W=[...Sa,...W]}return W}c1h(W,za,Sa){this.uld(W.scenario)&&(za=this.eYh(za,Sa));
this.Fld(W.scenario)&&(za=this.y5h(za,Sa));this.jld(W.scenario)&&(za=this.WPh(za,Sa));this.Dld(W.scenario)&&(za=this.r2h(za,Sa));return za}mZ(W){if(0===W.length)return null;let za=[0,0,0,0],Sa=[1,1,1,1],Wa=0;W.forEach(function(ma){let ha=ma.BorderPosition;Sa[ha]=ma.BorderLineStyle;let eb=new Yb.a(ma.Color.Red,ma.Color.Green,ma.Color.Blue);za[ha]=eb.dS();Wa|=fa.HelperMethods.f4a(ma.BorderPosition)});W={};W.LineStyle=Sa;W.Color=za;let ab={};ab.BorderFormat=W;ab.Border=Wa;return ab}O3d(W,za,Sa=null){let Wa=
[];Wa=null!==Sa?[...Sa]:this.c1h(za,Wa,W);if(za=this.mZ(Wa))W.cell.gcb(W.cell.getRange()),this.ux.zJb(W.cell.getRange()),this.Nh.$da(qa.h(this.$),-1690267012,za,!1,null,[W.cell.getRange()])}Ksi(W){return 512===(W.scenario&512)||4096===(W.scenario&4096)||1024===(W.scenario&1024)||2048===(W.scenario&2048)?!0:!1}z5h(W){W=this.ux.lQ(W.cell.getRange(),1);return W&&0!==W.length?W[0].rLa?(W=W[0].DM().Borders[0],W.BorderPosition=1,W):null:null}A5h(W){W=this.ux.lQ(W.cell.getRange(),3);return W&&0!==W.length?
W[0].pLa?(W=W[0].DM().Borders[0],W.BorderPosition=3,W):null:null}h$h(W,za,Sa,Wa,ab){za.cell.dkg();if(this.Ksi(W))this.O3d(za,W);else{const ma=8192===(W.scenario&8192),ha=za.cell.getRange();ma&&this.bhf?(za.cell.gcb(),this.ux.zJb(ha)):ab?(ab=[],null!==Sa&&ab.push(Sa),null!==Wa&&ab.push(Wa),0<ab.length?this.O3d(za,W,ab):(za.cell.gcb(),this.ux.zJb(ha))):ma&&!this.bhf&&(za.cell.gcb(),this.ux.zJb(ha))}}zXh(W,za){return null===W||void 0===W?!0:W.cell.getRange().top===za.topLeft.top&&W.cell.getRange().left===
za.topLeft.left&&W.cell.getRange().bottom===za.topLeft.bottom&&W.cell.getRange().right===za.topLeft.right?!0:!1}oIi(W,za){za=this.Mvf(W,za);if(this.pBb&&(!za||0==za.length))return!1;for(let Sa=0;Sa<za.length;Sa++)za[Sa].r0(2,!0),this.N2(this.G4(za[Sa]),!0,8,W.scenario,"merge");return!0}Y0j(W){const za=qa.h(this.$).Ca.Cja(W,this.$.activeItemName);if(za&&mc.Ct(za))for(let Sa of za)Sa.u0d(W,!0)}Mvf(W,za){const Sa=W.fQ,Wa=qa.h(this.$).Pb(za[0]);let ab=null,ma=null;this.Dic&&(ab=this.z5h(Wa),ma=this.A5h(Wa));
const ha=this.f2h(Sa,Wa,za[0],W);if(this.pBb&&(!ha||0==ha.length))return ha;this.zri?this.Y0j(za[0]):qa.h(this.$).Ca.d$(za[0],this.$.activeItemName).u0d(za[0],!0);this.N2(this.G4(Wa),!0,9,W.scenario,"merge");if(this.Dic&&this.qpd(W)){za=this.zXh(Sa,za[0]);for(const eb of ha)this.h$h(W,eb,ab,ma,za)}return ha}rSg(W,za,Sa){if(!(1>W.Borders.length)){var Wa=this.mZ(W.Borders);Sa.forEach(ab=>{ab=qa.h(this.$).Pb(ab.getRange());this.Nh.c$f(-1690267012,ab,Wa,!1,null,!1,za)})}}tYj(W,za,Sa){const Wa=W.length;
for(let ma=0;ma<Wa;ma++){W[ma].cell.CEc();const ha=W[ma].cell.getRange(),eb=qa.h(this.$).Ca.pja(ha),ta=eb.length;if(-167499203===za&&this.Cic){var ab=0;2===W[ma].cell.OJd||1===W[ma].cell.oC?ab=3:2===W[ma].cell.oC&&(ab=1);W[ma].r0(ab,!1)}for(ab=1;ab<ta;ab++)eb[ab].attachCellToModel(),eb[ab].zrb(W[ma]),-167499203===za&&this.Cic&&eb[ab].r0(null,!1);this.snf&&Sa&&this.rSg(Sa[ma],ha,eb)}}c0e(W,za){let Sa=null;for(let Wa=0;Wa<W.length;Wa++)if(W[Wa].BorderPosition===za){Sa=W[Wa];break}return Sa}VPh(W,za){let Sa=
W.cell.DM();W.Uva()&&W.cell.AQa(1);W.Yva()&&W.cell.AQa(3);if((W=this.ux.lQ(za,0))&&W[0].Uva){var Wa=W[0].DM().Borders;Wa=this.c0e(Wa,1);Wa.BorderPosition=0;Sa.Borders.push(Wa);W.forEach(ab=>{ab.AQa(1)})}(za=this.ux.lQ(za,2))&&za[0].Yva&&(W=za[0].DM().Borders,W=this.c0e(W,3),W.BorderPosition=2,Sa.Borders.push(W),za.forEach(ab=>{ab.AQa(3)}));return Sa}Zhg(W,za,Sa){var Wa=qa.h(this.$).Ca.ova(za[0],this.$.activeItemName);const ab=qa.h(this.$).Ca.d$(za[0],this.$.activeItemName),ma=[];if(void 0!==Wa&&null!==
Wa&&(za=qa.h(this.$).Bja(za[0],Wa),void 0!==za&&null!==za)){za=za.$$ge();for(Wa=[];za.$$mn();){var ha=za.$$cu();if(ha.vH){ma.push(ha);this.N2(this.G4(ha),!0,10,W,"unmerge");ha.cell.d5g();const eb=ha.cell.getRange();this.N2(this.G4(ha),!1,11,W,"unmerge");ab.u0d(eb,!1);this.snf&&(ha=this.VPh(ha,eb),Wa.push(ha))}}0<ma.length&&(ab.lf.resetCellLookup(),this.tYj(ma,Sa,Wa))}}N2(W,za,Sa,Wa,ab){if(!this.mjf)return!1;W!==za&&t.ULS.sendTraceTag(526149323,0,50,`Merge Information for resultant cell is unexpectedly changed at step: ${Sa}; Scenario: ${Wa}; Command: ${ab}; Expected: ${za?
"populated":"empty"}; Actual: ${W?"populated":"empty"}`);return W}G4(W){return!!W.cell.cell.Merge}}Object(r.a)(qb,"MergeCellCommandAction",null,[]);var Ha=a(66),Ya=a(177),Gb=a(45),Ja=a(383),Na=a(290),Qa=a(52),Oa=a(73),bb=a(55),Ga=a(1108),tb=a(33),wb=a(345),lb=a(145),db=a(216),Pa=a(4),ja=a(382);class Ka{constructor(W,za,Sa,Wa,ab,ma,ha){this.$=W;this.gridView=za;this.Nh=Sa;this.rB=Wa;this.borderFormatManager=ab;this.moreColorsHelper=ma;this.fontDropdownHelper=ha;this.kC=null;this.P_a=1461300262;this.v5b=
this.lx=this.M_a=this.C9a=this.Rac=null;this.AVi=(eb,ta,ya)=>{const sb=!!eb&&!!eb.RequestTelemetryData;!Ta.a(eb)&&ta&&qa.h(this.$).wh.Fla(ta,eb.StateId,sb?eb.RequestTelemetryData.EcsOperationDuration:0,sb?eb.RequestTelemetryData.EcsRequestDuration:0,sb?eb.RequestTelemetryData.WfeRequestDuration:0);if(d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1)){ta=1;if(33===ya||17===ya||9===ya||5===ya||37===ya)ta=0;this.K0(ta,eb)}};this.jSi=
eb=>{d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1)&&this.K0(3,eb)};this.trb=()=>{this.gridView.Y6a&&(this.copyPasteInfrastructure&&this.copyPasteInfrastructure.Zkj(this.trb),this.gridView.Y6a=!1,this.gridView.Gg.vp(G.a.QU),this.gridView.ha.Y_(this.Pdd),qa.h(this.$).$.qf())};this.Pdd=()=>{var eb=this.Rac;this.Rac=E.d(this.$.va.na);eb===this.Rac&&(this.gridView.ha.Y_(this.Pdd),this.copyPasteInfrastructure&&this.copyPasteInfrastructure.X0c(36,
qa.h(this.$).ha.qa.selectedRanges)?(eb=new xa.a(1804571062,2,2,0,null),this.$.Ia.Hb(eb,{[G.a.skipClipboardAccess]:!0,[G.a.t2c]:!0,[G.a.isFormatPainter]:!0}).continueWith(()=>{this.trb()})):this.gridView.Gg.iM(!1))};this.uc=()=>{this.ZG&&0!==this.ZG.fnc&&t.ULS.sendTraceTag(509690145,0,20,`GridCommandHandler::onWorkbookClosing: Font Usage Telemetry - {"newFontCount":${this.ZG.GAd},"oldFontCount":${this.ZG.YBd},"setFontCount":${this.ZG.DRd},"hoverFontCount":${this.ZG.Gmd},"menuOpenCount":${this.ZG.fnc}}`)};
this.wb=d.EwaSettings.wb();this.mergeCellCommandAction=new qb(this.$,Sa);this.ZC=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);this.Rl=d.EwaSettings.Rl();this.jl=tb.a.jl();this.YA=tb.a.YA(this.$);if(this.Zhc=d.EwaSettings.isChangeGateEnabled("OfficeVSO:7376562_TelemetryForFontUsage"))this.ZG={GAd:0,YBd:0,DRd:0,Gmd:0,fnc:0},this.$.nj(this.uc)}get imf(){return n.a.all(this.gridView.ha.qa.selectedRanges,W=>W.isRow)}get fmf(){return n.a.all(this.gridView.ha.qa.selectedRanges,
W=>W.Rg)}get themesManager(){this.lx||(this.lx=this.$.da.Aa(422));return this.lx}K0(W,za){const Sa=this.$.da.Aa(465);Sa&&Sa.K0(W,za)}xqi(W){return 1896159024===W||-1554384558===W||-1113896058===W||1554436520===W||1415868706===W||674605324===W||1035996630===W}Ivi(W){return 524773427===W||-1649235364===W||1886217042===W||928057943===W}Hc(W,za){const Sa=qa.h(this.$);return 2054778433===za&&W&1&&!d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIQueryTablesRefreshSelectedEnabled",!1)?
!ea.a(this.$).Dlf:600686207===za?!1:this.xqi(za)&&n.a.any(this.gridView.ha.qa.selectedRanges,Wa=>Wa.Rg||Wa.isRow)&&!this.imf&&!this.fmf?!0:d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextOrientationSlice3",!1)&&this.Ivi(za)?Sa.tb.zjf(Sa.ha.qa.activeCell):this.Pjc(W,za)}executeCommand(W,za,Sa){return this.Hb(za,Sa)}wc(W,za,Sa){if(W=1===W)switch(za.command){case 1457172838:case 2036397036:case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:case 1886928607:case -992833457:case 218524921:case 996232352:case -167499203:case -255094134:case -693675336:case 322710748:case 1097660126:case 155820588:case 2007171328:case 1896159024:case -1554384558:case 504848446:case 1504715724:case 1872288872:case 41465729:case -1451655532:case 1972143101:case -475861485:case -978843926:case 2098035706:case -2142700828:case 1405660955:case 1983983164:case 478842689:case -798660877:case -653661711:case 862890474:case 963349338:case 1012765228:case 1597684571:case -1832800737:case -1920201820:case -1942512156:case -600086683:case -208772570:case -987339782:case 748067091:case -381232414:case 1696566924:case 894341014:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:case -1770246794:break;
case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:W=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextOrientationSlice3",!1);break;case -1077965542:case 909774670:case -1904244080:case -1293291468:case 324978188:case -1428968098:case 1970784898:case -803000997:case -128950598:case 1688184685:case 87208751:case -446735083:case 1650812936:case 673562736:case -1690267012:case -236759591:case -1803452024:case -2118943501:case 1890566896:case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:case 886009118:case 165054436:case 1981714220:case -556441918:case 942362098:case 622604322:case 1405456548:case 284490184:case 1256700402:case -1756763834:case -1418159950:W=
!!Sa;break;case 862825906:case 1532790410:case 46555851:case -1522760979:W=!0;break;default:W=!1}return W}Nc(W,za,Sa){switch(za){case "PopulateFontColor":Sa.MenuItems=this.rB.Sbc(1970784898,-803000997,null,null,-128950598,2036397036,1688184685,862825906,Sa.MenuId);break;case "PopulateFillColor":Sa.MenuItems=this.rB.Sbc(1650812936,null,87208751,454361567,673562736,1457172838,-446735083,1532790410,Sa.MenuId);break;case "PopulateBorderColor":Sa.MenuItems=this.rB.Sbc(-236759591,-1803452024,void 0,void 0,
void 0,void 0,void 0,46555851,Sa.MenuId);break;case "PopulateBorderStyle":this.borderFormatManager.C$h(Sa);break;case "PopulateFontDropdown":case "PopulateFontRTFDropdown":if(this.jl&&(this.fontDropdownHelper.hAj(Sa.MenuId),!this.fontDropdownHelper.lpi()))return!1;Sa.MenuItems=this.fontDropdownHelper.C_e(-1293291468,324978188,-1428968098,Sa.MenuId);this.Zhc&&(this.ZG.fnc+=1);break;default:return!1}return!0}Pjc(W,za){const Sa=qa.h(this.$).ha.qa.selectedRanges;return!(new Z.a(this.$.va)).um(W,za,Sa,
this.gridView)}Hb(W,za){var Sa=this.gridView;const Wa=W.command;var ab=f.TaskExtensions.Tj();let ma=!0;switch(Wa){case -1077965542:ma=this.D$e(za,W,!1);break;case 909774670:this.Cqb(Wa);ma=this.D$e(za,W,!0);break;case -1293291468:ma=this.B$e(za,W,!1);break;case 324978188:this.Cqb(Wa);ma=this.B$e(za,W,!0);break;case 862890474:case 963349338:ma=this.T9h(W);break;case -1832800737:ma=this.sec(Wa,za,!1,W);break;case 1970784898:ma=this.sec(Wa,za,!1,W);break;case -803000997:ma=this.sec(Wa,za,!1,W);break;
case -128950598:case 1688184685:this.Cqb(Wa);ma=this.sec(Wa,za,!0,W);break;case 1597684571:ma=this.oyb(Wa,za,!1,W);break;case 87208751:za.Color="-1";za.IntColor=!0;ma=this.oyb(Wa,za,!1,W);break;case -446735083:this.Cqb(Wa);za.Color="-1";za.IntColor=!0;ma=this.oyb(Wa,za,!0,W);break;case 1650812936:ma=this.oyb(Wa,za,!1,W);break;case 673562736:this.Cqb(Wa);ma=this.oyb(Wa,za,!0,W);break;case -1904244080:case -1428968098:case 1457172838:case 2036397036:this.XZf(Wa);break;case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:ma=
this.B9h(Wa,W);break;case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:case 2007171328:ma=this.F8h(Wa,W);break;case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:ma=this.w$h(Wa,W);break;case -1803452024:case -236759591:ma=this.tkd(Wa,za,W);break;case -2118943501:ma=this.borderFormatManager.S8h(za,W);break;case 1012765228:ma=this.borderFormatManager.T$h(za,W);break;case 1256700402:ma=this.borderFormatManager.xkd(W);
break;case -1756763834:ma=this.borderFormatManager.ykd(W);break;case -1418159950:ma=this.borderFormatManager.o$e(W);break;case -1920201820:case -1942512156:ma=this.U9h(Wa,W);break;case -1690267012:case -600086683:case 165054436:case 1981714220:case -556441918:ma=this.borderFormatManager.Z9e(za,W);this.BGh(za);break;case 1890566896:case 1886928607:case -992833457:case 218524921:case 996232352:ma=this.s$h(Wa,za,W);break;case -693675336:case 322710748:break;case 1696566924:ma=this.C9h(W);break;case -167499203:case -255094134:case 1097660126:case 155820588:ab=
this.handleMergeCellsCommand(this.gridView,W);break;case 1896159024:case -1554384558:za=this.gridView.ha.qa.selectedRanges;if(this.CFj(W.command))t.ULS.sendTraceTag(509694159,0,50,"Insert Copied Cells Keyboard Shortcut"),this.copyPasteInfrastructure.jff(null,W),ab=bb.Task.Sa(!0);else if(this.YGj(W,za))t.ULS.sendTraceTag(574993492,0,50,"GridCommandHandler.HandleRibbonCommand: showing InsertDeleteCellsDialog"),(new mb(this.$,Wa,za)).ig(),ma=!0;else if(n.a.any(za,ha=>this.gridView.tb.$M(ha))){Sa="";
ab=1461300262;const ha=-1554384558===Wa&&this.gridView.tb.Lsi(za[0]);za=za[0].height>za[0].width&&!ha;switch(Wa){case 1896159024:Sa=za?"InsertColumnsTable":"InsertRowsTable";ab=za?622604322:942362098;break;case -1554384558:Sa=za?"DeleteColumnsTable":"DeleteRowsTable",ab=za?284490184:1405456548}za=ia.a.aq(Ka.sod,Sa,1);new xa.a(ab,1,2,6,null);ab=this.insertOrDeleteCells(za,W,!0)}else ab=this.insertOrDeleteCells(1896159024===Wa?1:2,W,!1);break;case 942362098:case 622604322:case 1405456548:case 284490184:ab=
this.insertOrDeleteCells(ia.a.aq(Ka.sod,za[N.a.Kc],1),W,!0);this.YA&&(W=qa.h(this.$),db.d(this.$,W.ha.qa.activeCell,Wa,null));break;case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:ab=this.insertOrDeleteCells(ia.a.aq(Ka.sod,za[N.a.Kc],1),W,!1);break;case 504848446:ab=Sa.startEdit(!1,1,za[G.a.event],void 0,void 0,!0);break;case 1504715724:if(qa.h(this.$).ez&&this.borderFormatManager.pU.$A)break;ab=Sa.startEdit(!0,0,za[G.a.event],void 0,void 0,!0);break;case 1872288872:this.trb();
break;case 41465729:ab=this.fill(Sa.ha.qa.ld,null,0,1,W);break;case -1451655532:case 1972143101:ab=this.fillDownAbsoluteValueAndStartEdit(Sa,za[G.a.event],-1451655532===Wa);break;case -475861485:ab=this.fill(Sa.ha.qa.ld,null,Sa.rtl?1:2,1,W);break;case -978843926:ab=this.fill(Sa.ha.qa.ld,null,3,1,W);break;case 2098035706:ab=this.fill(Sa.ha.qa.ld,null,Sa.rtl?2:1,1,W);break;case -2142700828:ab=this.fill(Sa.ha.sourceRange,Sa.ha.qa.ld,Ka.T2e(Sa.ha.qa.ld,Sa.ha.sourceRange),2,W);break;case 1405660955:ab=
this.fill(Sa.ha.sourceRange,Sa.ha.qa.ld,Ka.T2e(Sa.ha.qa.ld,Sa.ha.sourceRange),4,W);break;case 1983983164:ab=this.fill(Sa.ha.qa.ld,null,0,0,W);break;case 478842689:(W=this.$.da.Aa(376))?(W.bbj(),ma=!0):t.ULS.sendTraceTag(537159509,0,15,"gridHighlightBehaviorEventManager is null for TouchAutoFill");break;case -798660877:case -653661711:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:ma=Sa.ha.Hb(null,Wa);break;case -208772570:this.n$h();ma=!0;break;case -987339782:this.$8h();
ma=!0;break;case -1770246794:Sa.ha.a9h();ma=!0;break;case 748067091:case -381232414:this.d9h(Wa);ma=!0;break;case -1522760979:this.gridView.toggleFormulaView();ma=!0;break;case 886009118:ab=this.R9h();break;case 894341014:this.W9h();ma=!0;break;case 862825906:ab=this.S$e(1970784898,W);break;case 1532790410:ab=this.S$e(1650812936,W);break;case 46555851:ab=this.j$h(W);break;default:ma=!1}ma||(ab=ua.a(Wa));return ab}BGh(W){d.EwaSettings.isChangeGateEnabled("OfficeVSO:7480949_SVLogFlightUsage")?["OutsideBorders",
"AllBorders","ThickOutsideBorders"].includes(null===W||void 0===W?void 0:W.MenuItemId)&&(Pa.AFrameworkApplication.Tp("XLS-IntelligentMetadataTableProactiveSuggestions-Treatment;XLS-IntelligentMetadataTableProactiveSuggestions-Control"),d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&this.Sxe(new wb.a(this.gridView.ha.qa.activeRange,E.d(this.$.va.na)))):W&&W.MenuItemId&&["OutsideBorders","AllBorders","ThickOutsideBorders"].includes(W.MenuItemId)&&
d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&this.Sxe(new wb.a(this.gridView.ha.qa.activeRange,E.d(this.$.va.na)))}Sxe(W){f.TaskExtensions.za(e.GetServiceTaskFactory.Oa(this.$.da,426,427,1),za=>{void za.result.VCc(W,"BorderActions")},this.$.la,3)}get copyPasteInfrastructure(){var W;null!==(W=this.v5b)&&void 0!==W?W:this.v5b=this.$.da.Aa(254,!0);this.v5b||t.ULS.sendTraceTag(509682657,0,50,"CopyPasteInfrastructure is null");return this.v5b}CFj(W){var za,
Sa;return ja.a.dyi&&1896159024===W&&(null===(za=this.copyPasteInfrastructure)||void 0===za?void 0:za.rNe())&&(null===(Sa=this.copyPasteInfrastructure)||void 0===Sa?void 0:Sa.pic())}YGj(W,za){const Sa=n.a.all(za,ma=>!this.gridView.tb.$M(ma)),Wa=1<za.length&&!!this.gridView.tb.mjd(za),ab=n.a.all(za,ma=>!this.gridView.tb.b5(ma));za=!n.a.any(za,ma=>ma.isRow||ma.Rg);return 1===W.method&&6===W.Ve&&(Sa||Wa)&&ab&&za}fillDownAbsoluteValueAndStartEdit(W,za,Sa){const Wa=W.ha.qa.activeCell,ab=aa.E(Wa,this.gridView.Cp);
return W.startEdit(!0,0,za).So(()=>{const ma=W.Pb(ab),ha=W.Pb(Wa);if(!ma||!ha)return t.ULS.shipAssertTag(537159507,0,!1,`GridCommandHandler.FillDownAbsoluteValueAndStartEdit Cannot get cells for active cell: ${Wa.toString()} and above cell: ${ab.toString()}`),bb.Task.Sa(!1);this.gridView.Vb.text=Sa?ma.iS:ma.text;this.gridView.Vb.textBox.setCaretPositionToEnd();return bb.Task.Sa(!0)})}insertOrDeleteCells(W,za,Sa){const Wa=z.a.create().toString();var ab=Enum.toString(S,W);this.gridView.wh.z0(17,Wa,
ab);ab=this.gridView.ha.qa.selectedRanges;var ma=this.imf,ha=this.fmf;if(!this.$.Us(null,!1,void 0,za.Ve)&&!ha&&!ma&&5!==W&&9!==W)return bb.Task.Sa(!0);2===W?W=ha?10:ma?6:ab[0].height>ab[0].width?18:34:1===W?W=ha?9:ma?5:ab[0].height>ab[0].width?17:33:18===W&&ma?W=34:34===W&&ha&&(W=18);ab=this.hQg(ab,W);if((10===W||6===W)&&!this.$.Us(ab,!0,1,za.Ve))return bb.Task.Sa(!0);const eb={};eb.InsertDeleteRangeItems=Array(ab.length);eb.SheetName=this.$.na.sheetName;eb.IsTableCommand=Sa;for(Sa=0;Sa<ab.length;Sa++){ma=
ab[Sa];ha={};let Qb,oc;W&4?(ha.FirstRow=ma.top-1,ha.LastRow=U.a.eB,ha.FirstColumn=0,ha.LastColumn=U.a.dy,Qb=ma.bottom-ma.top+1,oc=0,6===W?(ma.Rg||(ha.FirstRow=ma.bottom),Qb=-Qb):lb.b("InsertRowsAbove"),37===W&&(ha.FirstRow=ma.bottom,lb.b("InsertRowsBelow"))):W&8?(ha.FirstRow=0,ha.LastRow=U.a.eB,ha.FirstColumn=ma.left-1,ha.LastColumn=U.a.dy,Qb=0,oc=ma.right-ma.left+1,10===W&&(ma.isRow||(ha.FirstColumn=ma.right),oc=-oc)):W&16?(ha.FirstRow=ma.top-1,ha.LastRow=ma.bottom-1,ha.FirstColumn=ma.left-1,ha.LastColumn=
U.a.dy,Qb=0,oc=ma.right-ma.left+1,18===W&&(ha.FirstColumn=ma.right,oc=-oc)):(ha.FirstRow=ma.top-1,ha.LastRow=U.a.eB,ha.FirstColumn=ma.left-1,ha.LastColumn=ma.right-1,Qb=ma.bottom-ma.top+1,oc=0,34===W&&(ha.FirstRow=ma.bottom,Qb=-Qb));const kb={};kb.InsertDeleteRange=ha;kb.DeltaRow=Qb;kb.DeltaColumn=oc;kb.AdjustedSelectedRange=aa.j(ma);eb.InsertDeleteRangeItems[Sa]=kb}this.gridView.Gg.iM(!1);const ta=d.EwaSettings.isChangeGateEnabled("OfficeVSO:4932761_InsertDeleteCellsDecoupled");eb.IsDecoupleRecalc=
ta;const ya=this.$.oa.xa.Wb(),sb=()=>new M(eb);return V.a(this.$.userOperationManager,(Qb,oc,kb)=>{ta&&!d.EwaSettings.isChangeGateEnabled("OfficeVSO:5316173_RecoverableFromOOM")||this.$.py();return nb(this.$.oa.xa,eb,ca.b(Qb,(jb,Wb)=>{this.AVi(jb,Wb,W)},()=>{this.RVj(W,eb)}),oc,kb,Wa,ya)},Qb=>new P.a(237,0,Qb,void 0,sb),za,d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MoveTaskCompletionToQueueItemLevelByOptingIn",!1))}RVj(W,za){const Sa=this.S4h(W);if(Sa&&1===za.InsertDeleteRangeItems.length){var Wa=
za.InsertDeleteRangeItems[0];1<Wa.DeltaColumn||1<Wa.DeltaRow||this.tvi(Sa)&&f.TaskExtensions.za(e.GetServiceTaskFactory.Oa(this.$.da,426,427,1),ab=>{const ma=new wb.a(aa.B(Wa.AdjustedSelectedRange),E.d(this.$.va.na));void ab.result.VCc(ma,Sa)},this.$.la,3)}}tvi(W){return d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)?"DeleteColumn"===W||"DeleteRow"===W?(Pa.AFrameworkApplication.Tp("XLS-SmartView-DeleteRowColProactiveSuggestions-Treatment;XLS-SmartView-DeleteRowColProactiveSuggestions-Control"),
d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.DeleteRowColProactiveSuggestions",!1)):"InsertColumn"===W||"InsertRow"===W?(Pa.AFrameworkApplication.Tp("XLS-SmartView-InsertRowColProactiveSuggestions-Treatment;XLS-SmartView-InsertRowColProactiveSuggestions-Control"),d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.InsertRowColProactiveSuggestions",!1)):"InsertCellShiftDown"===W||"InsertCellShiftRight"===W?(Pa.AFrameworkApplication.Tp("XLS-SmartView-InsertCellTableProactiveSuggestions-Treatment;XLS-SmartView-InsertCellTableProactiveSuggestions-Control"),
d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.InsertCellTableProactiveSuggestions",!1)):"DeleteCellShiftUp"===W||"DeleteCellShiftLeft"===W?(Pa.AFrameworkApplication.Tp("XLS-SmartView-DeleteCellTableProactiveSuggestions-Treatment;XLS-SmartView-DeleteCellTableProactiveSuggestions-Control"),d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.DeleteCellTableProactiveSuggestions",!1)):!1:(d.EwaSettings.isChangeGateEnabled("OfficeVSO:7480949_SVLogFlightUsage")||
Pa.AFrameworkApplication.Tp("XLS-IntelligentMetadataTableProactiveSuggestions-Treatment;XLS-IntelligentMetadataTableProactiveSuggestions-Control"),!1)}S4h(W){let za;switch(W){case 5:case 37:za="InsertRow";break;case 33:za="InsertCellShiftDown";break;case 9:za="InsertColumn";break;case 17:za="InsertCellShiftRight";break;case 6:za="DeleteRow";break;case 34:za="DeleteCellShiftUp";break;case 10:za="DeleteColumn";break;case 18:za="DeleteCellShiftLeft"}return za}hQg(W,za){return za&32?this.pZa(W,Sa=>Sa.bottom,
Sa=>Sa.top,(Sa,Wa)=>{Sa.bottom=Wa},!1,!0):za&16?this.gridView.rtl?this.pZa(W,Sa=>Sa.left,Sa=>Sa.right,(Sa,Wa)=>{Sa.left=Wa},!1,!1):this.pZa(W,Sa=>Sa.right,Sa=>Sa.left,(Sa,Wa)=>{Sa.right=Wa},!1,!1):za&4?this.pZa(W,Sa=>Sa.bottom,Sa=>Sa.top,(Sa,Wa)=>{Sa.bottom=Wa},!0,!0):za&8?this.gridView.rtl?this.pZa(W,Sa=>Sa.left,Sa=>Sa.right,(Sa,Wa)=>{Sa.left=Wa},!0,!1):this.pZa(W,Sa=>Sa.right,Sa=>Sa.left,(Sa,Wa)=>{Sa.right=Wa},!0,!1):W}pZa(W,za,Sa,Wa,ab,ma){W=aa.d(W);W.sort((ha,eb)=>za(eb)-za(ha));if(ab){ab=[];
ma=ma?U.a.Vg+1:U.a.Ug+1;for(let ha=0;ha<W.length;ha++){const eb=W[ha];Sa(eb)<ma&&(Wa(eb,Math.min(za(eb),ma-1)),ab.push(eb),ma=Sa(eb))}W=ab}return W}fill(W,za,Sa,Wa,ab){const ma=this.$;if(!ma.Us([za],!0))return bb.Task.Sa(!0);const ha=aa.v(W,ma),eb=za?aa.v(za,ma):ha,ta=this.$.oa.xa.Wb(),ya=()=>new X(ha,eb,Wa,Sa);return V.a(this.$.userOperationManager,(sb,Qb,oc)=>{this.$.py();var kb=this.$.oa.xa;sb=ca.b(sb,this.jSi);const jb=kb.Na(9,ta);jb.sourceRange=ha;jb.targetRange=eb;jb.fillDirection=Sa;jb.fillType=
Wa;return ba.g(kb,"FillRange",jb,sb,Qb,oc,null,0)},sb=>new P.a(155,0,sb,void 0,ya),ab)}s$h(W,za,Sa){const Wa={ValidMembers:32};switch(W){case 1890566896:W=parseInt(za[N.a.Kc].toString(),10);if(14===W)return Sa=new xa.a(2105621672,Sa.method,Sa.mode,Sa.Ve,Sa.tabName),za[N.a.Kc]=null,this.$.Ia.Hb(Sa,za),t.ULS.sendTraceTag(537159506,0,50,"GridCommandHandler.HandleNumberFormatCommand: triggered NumberFormatDialog command, with menu item 14."),!0;Wa.NumberFormat=W;break;case 1886928607:Wa.NumberFormat=
13;break;case -992833457:Wa.NumberFormat=11;break;case 218524921:Wa.NumberFormat=12;break;case 996232352:Wa.NumberFormat=1006;break;default:return t.ULS.shipAssertTag(537159505,0,!1,"Unexpected number formatting command "+Qa.b().Cj(Sa.command)),!1}t.ULS.sendTraceTag(537159504,0,50,`GridCommandHandler.HandleNumberFormatCommand: triggered ${Qa.b().Cj(Sa.command)} command, with menu item ${za[N.a.Kc]}.`);this.Nh.formatCells(1890566896,Wa,Sa);this.$.qf();return!0}T9h(W){var za=this.gridView.Pb(this.gridView.ha.qa.activeCell);
if(this.wb&&this.gridView.fb){za=this.gridView.ni.z4a(za?Ya.a(za).Font:null);if(!za)return t.ULS.shipAssertTag(537159503,0,!1,`GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: fontType for range ${this.gridView.ha.qa.activeCell.toString()} is null while editing`),!1;var Sa=za.FontSize}else if(za)Sa=za.fontSize;else return!1;za=W.command;let Wa=0;if(862890474===za)for(;Wa<Ka.RJa.length-1&&Ka.RJa[Wa]<=Sa;)Wa++;else if(963349338===za)for(Wa=Ka.RJa.length-1;0<Wa&&Ka.RJa[Wa]>=Sa;)Wa--;t.ULS.sendTraceTag(537159501,
0,50,`GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: change font from size ${Sa} to size ${Ka.RJa[Wa]}`);if(Sa===Ka.RJa[Wa])return!0;Sa=Ka.Yxc(2);Sa.Font.FontSize=Ka.RJa[Wa];this.wb&&this.gridView.fb?(this.cpb(W,!1,Sa),this.$.qf()):this.Nh.formatCells(za,Sa,W);return!0}D$e(W,za,Sa){W=W[W[w.a.IsFreeForm]?w.a.Value:N.a.Pf].toString();if(!Ka.t7i.test(W))return t.ULS.sendTraceTag(537159499,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command is not a number."),!0;W=parseFloat(W);
if(8>W||72<W)return t.ULS.sendTraceTag(537159497,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command is not within expected limits (8 - 72)."),!0;const Wa=Math.round(2*W)/2,ab=Ka.Yxc(2);ab.Font.FontSize=Wa;this.wb&&this.gridView.fb?(this.cpb(za,Sa,ab,!0),Wa===W||Sa||this.$.qf()):Sa?this.Nh.$da(this.gridView,-1077965542,ab,Sa):(this.Nh.formatCells(-1077965542,ab,za),this.r0a());return!0}B$e(W,za,Sa){var Wa=W[N.a.Pf];let ab;this.jl?this.fontDropdownHelper.tBc&&this.fontDropdownHelper.tBc[Wa]?
ab=Wa:(t.ULS.sendTraceTag(523903201,1,15,`GridCommandHandler.HandleFontFamilyCommand: font in supportedFontFamiliesNew is not found for ${Wa}`),ab=fa.HelperMethods.nO[Wa]):ab=fa.HelperMethods.nO[Wa];let ma=0;this.Rl&&(W=W.MenuItemId,W===Ga.b?(Wa==this.themesManager.PF.Gzd&&(ab=Wa),ma=2):W===Ga.a&&(Wa==this.themesManager.PF.syd&&(ab=Wa),ma=1),t.ULS.sendTraceTag(510247702,1,50,`GridCommandHandler.handleFontFamilyCommand: Font used is theme font: ${0!==ma}`));if(!ab)return!0;Wa=Ka.Yxc(1);Wa.Font.FontName=
ab;this.Rl&&(Wa.Font.FontScheme=ma);this.wb&&this.gridView.fb?(this.cpb(za,Sa,Wa),this.$.qf()):Sa?(this.Nh.$da(this.gridView,-1293291468,Wa,Sa),this.Zhc&&(this.ZG.Gmd+=1)):(this.Nh.formatCells(-1293291468,Wa,za),this.Zhc&&this.Xei(Wa.Font.FontName),this.r0a());return!0}Xei(W){this.ZG.DRd+=1;this.jl&&this.Nh.Rif(W)?this.ZG.GAd+=1:this.ZG.YBd+=1}sec(W,za,Sa,Wa){let ab=-803000997===W||1688184685===W?"black":za.Color;this.moreColorsHelper&&(-1832800737===W?ab=Fa.a.compare(ab,"WindowText",!0)?this.moreColorsHelper.Rbb:
"black":Sa||(this.moreColorsHelper.Rbb=ab,this.moreColorsHelper.jda(za,ab,Wa)));W=Ka.Yxc(32);W.Font.FontColor=da.a.bH(ab,ia.a.lg(za,"IntColor"));this.wb&&this.gridView.fb?this.cpb(Wa,Sa,W,17===Wa.Ve):Sa?this.Nh.$da(this.gridView,1970784898,W,Sa):(this.ZC&&({themeColor:za}=this.getThemeColor(za)).returnValue&&(W.Font.ThemeFontColor=za,W.Font.ColorTypeOption=1),this.Nh.formatCells(1970784898,W,Wa),this.r0a());return!0}d9h(W){var za=(new Date).format(748067091===W?this.$.ya.ShortDateFormat:this.$.ya.ShortTimeFormat);
const Sa=this.gridView.Ql?ra.a(this.gridView.$):this.gridView.Vb;W=Sa.textBox;this.gridView.fb?Sa.insertText(za):(this.gridView.startEdit(!0,0),Sa.text=za,za=za.length,W.Fdb(za),W.caretPosition=za)}n$h(){this.gridView.aN(this.gridView.ha.qa.activeCell)||this.gridView.txc||this.gridView.NMa()||this.gridView.pv(this.gridView.ha.qa.activeCell,3,"GridCommandHandler.HandleMoveViewportToActiveCell")}$8h(){if(!(this.gridView.txc||this.gridView.NMa()||this.gridView.fb&&m.a.isMac)){const W=this.gridView.ha.qa.W3;
this.gridView.qg(aa.v(W,this.$),W,null,null,60,"GridCommandHandler.HandleMoveViewportToActiveCell")}}C9h(W){this.Rac=E.d(this.$.va.na);if(this.gridView.Y6a)return this.gridView.Gg.iM(!1),!!this.copyPasteInfrastructure;if(!this.copyPasteInfrastructure)return t.ULS.sendTraceTag(537159494,0,50,"GridCommandHandler.HandleFormatPainter : copyPasteInfrastructure is null"),!1;this.gridView.ha.q2(this.Pdd);const za=String.format(G.a.Ata,O.a.current.qo(107));this.gridView.Gg.vp(za);W=new xa.a(-911352779,W.method,
W.mode,W.Ve,W.tabName);this.$.Ia.Hb(W,{[G.a.silentClipboardAccessFailures]:!0,[G.a.isFormatPainter]:!0}).continueWith(Sa=>{(6>Sa.status||6===Sa.status&&!Sa.result)&&this.trb()});this.gridView.Y6a=!0;this.copyPasteInfrastructure.iOg(this.trb);return!0}oyb(W,za,Sa,Wa){let ab=87208751===W?"-1":za.Color;this.moreColorsHelper&&(1597684571===W?ab=this.moreColorsHelper.lQa:Sa||(this.moreColorsHelper.lQa=ab===Ka.notSet?Ka.DZd:ab,this.moreColorsHelper.jda(za,ab,Wa)));W={ValidMembers:64};W.FillColor=da.a.bH(ab,
ia.a.lg(za,"IntColor"));Sa?this.Nh.$da(this.gridView,1650812936,W,!0):(this.ZC&&({themeColor:za}=this.getThemeColor(za)).returnValue&&(W.ThemeFillColor=za,W.ColorTypeOption=1),this.Nh.formatCells(1650812936,W,Wa),this.r0a());return!0}W9h(){t.ULS.sendTraceTag(537159493,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Started handling the command");const W=this.$.da.Aa(221);if(W){var za=this.gridView.ni;if(za){var Sa,Wa,ab=({pxf:Sa,uYe:Wa}=W.lji(za.text,za.textBox.caretPosition)).returnValue;
ab?(W.re=!1,za.text=ab,za.textBox.selectRange(Sa,Sa+Wa),t.ULS.sendTraceTag(587534607,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell InsertFormulaArguments executed successfully")):t.ULS.sendTraceTag(537159490,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Can't insert formula arguments with current text and caret position.")}else t.ULS.shipAssertTag(537159491,0,!1,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No editor object")}else t.ULS.sendTraceTag(537159492,
0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No formulaAssistanceControl object")}B9h(W,za){let Sa=0;var Wa=this.gridView;const ab=Ya.a(Wa.Pb(null));this.wb&&Wa.fb&&(ab.Font=Wa.ni.z4a(ab.Font));(Wa=ab.Font)||(Wa={ValidMembers:0});switch(W){case -287251124:Sa|=4;Da.e(Wa,4)?Wa.Bold=!Wa.Bold:Wa.Bold=!0;break;case -1925065947:Sa|=8;Da.e(Wa,8)?Wa.Italic=!Wa.Italic:Wa.Italic=!0;break;case 1764140053:Sa|=16;Da.e(Wa,16)?Wa.Underline=!Wa.Underline:Wa.Underline=!0;break;case -1685033574:Sa|=
64;Da.e(Wa,64)?Wa.DoubleUnderline=!Wa.DoubleUnderline:Wa.DoubleUnderline=!0;break;case -1590502662:Sa|=128,Da.e(Wa,128)?Wa.Strikethrough=!Wa.Strikethrough:Wa.Strikethrough=!0}if(!Sa)return!1;Wa.ValidMembers=Sa;ab.Font=Wa;ab.ValidMembers=16;this.wb&&this.gridView.fb?this.cpb(za,!1,ab):this.Nh.formatCells(W,ab,za);this.$.qf();return!0}F8h(W,za){let Sa=0;const Wa=Ya.a(this.gridView.Pb(null));-571165336===W||1041132226===W||-394785302===W?(Sa|=1,Wa.VerticalAlignment=ia.a.aq(Ka.yZa,W.toString(),2)):Ka.cqi(W)?
(Sa|=2,this.O9h(Wa,W)):-1116189897===W&&(Sa|=8,Wa.Wrap=Wa.ValidMembers&8?!Wa.Wrap:!0);if(!Sa)return!1;Wa.ValidMembers=Sa;this.Nh.formatCells(W,Wa,za);this.$.qf();return!0}O9h(W,za){!d.EwaSettings.isChangeGateEnabled("OfficeVSO:5049785_DisableTextAlignmentCommandFlipInRTL")&&this.$.isChromeRtl&&-1142465846!==za&&(za=-1150205178===za?-286432209:-1150205178);za=ia.a.aq(Ka.yZa,za.toString(),0);W.HorizontalAlignment=za===W.HorizontalAlignment?0:za}BPf(W,za,Sa,Wa){let ab=!1;d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",
!1)&&(ab=this.mergeCellCommandAction.Lvf(za,Sa))&&qa.h(this.$).wh.$R(this.C9a,Ha.BasicTelemetryCalculator.HQ);return this.wub(W,za,!1,ab,ma=>{this.KWi(ma,Sa,za,ab,Wa)})}handleMergeCellsCommand(W,za){this.C9a=z.a.create().toString();let Sa=null;Sa=this.mergeCellCommandAction.K4e();var Wa=D.a(za.command);const ab=this.mergeCellCommandAction.Qni(za.command,Sa);let ma=0;ab?ma=u.a.Td():qa.h(this.$).wh.z0(4,this.C9a,Wa+", Scenario = "+Sa.scenario.toString());Wa=W.ha.qa.selectedRanges;t.ULS.sendTraceTag(537159459,
0,50,`GridCommandHandler.HandleMergeCellsCommand: Merge Command: ${Qa.b().Cj(za.command)}, Number of ranges: ${Wa.length}, Ranges: ${aa.i(Wa,",",this.$,!1)}`);Wa=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1);W.Gg.iM(!1,Wa);if(10===ia.a.aq(Ka.Nvf,za.command.toString(),10))return bb.Task.Sa(!1);const ha=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1);if(Wa&&ha)return ab?(this.I9f(Sa,za,!0,!0,ma),bb.Task.Sa(!0)):
this.BPf(W,za,Sa,!1);let eb=!1;Wa&&(eb=this.mergeCellCommandAction.Lvf(za,Sa))&&qa.h(this.$).wh.$R(this.C9a,Ha.BasicTelemetryCalculator.HQ);return this.wub(W,za,!1,eb,ta=>{this.LWi(ta,za,eb)})}wub(W,za,Sa,Wa,ab=null){const ma=this.$.oa.xa.Wb(),ha=ia.a.aq(Ka.Nvf,za.command.toString(),10),eb=aa.r(W.ha.qa.selectedRanges,W.$),ta=()=>new L.a(ha,eb),ya=sb=>{const Qb=!!sb&&!!sb.RequestTelemetryData;qa.h(this.$).wh.Fla(this.C9a,sb.StateId,Qb?sb.RequestTelemetryData.EcsOperationDuration:0,Qb?sb.RequestTelemetryData.EcsRequestDuration:
0,Qb?sb.RequestTelemetryData.WfeRequestDuration:0)};W=(sb,Qb,oc)=>{this.$.py();sb=ab?ca.b(sb,ab):sb;sb=ca.b(sb,ya);return ba.d(this.$.oa.xa,ha,eb,Sa,sb,Qb,oc,null,ma)};return Wa?V.a(this.$.userOperationManager,W,sb=>new P.a(156,0,sb,64,ta),za):V.a(this.$.userOperationManager,W,sb=>new P.a(156,0,sb,void 0,ta),za)}I9f(W,za,Sa,Wa=!1,ab=0){t.ULS.sendTraceTag(537159457,0,50,`Merge cells with multiple values. isCalledBeforeCSE :- ${Sa}`);var ma=qa.h(this.$).rtl;ma=Ma.a.ed(3,2,0,ma?634:633,0,514846606,"MergeCellsLoseData");
f.TaskExtensions.za(Gb.a(this.$).kj(ma),ha=>{ha=ha.result;if(Wa){const eb=u.a.Td()-ab;t.ULS.sendTraceTag(528779355,0,50,`Time taken to show Dialog in Data Loss Scenario is : ${eb}, and the user action is : ${ha}`)}0===ha?(t.ULS.sendTraceTag(537159456,0,50,"MergeCellsLoseData Dialog: Ok pressed"),Sa?(Wa&&(ha=D.a(za.command),qa.h(this.$).wh.z0(4,this.C9a,ha+", Scenario = "+W.scenario.toString())),this.BPf(qa.h(this.$),za,W,!0)):this.wub(this.gridView,za,!0,!1)):1===ha&&t.ULS.sendTraceTag(537159455,
0,50,"MergeCellsLoseData Dialog: Cancel pressed")},this.$.la,11)}kCi(W,za,Sa,Wa){za!==W&&t.ULS.sendTraceTag(537159454,0,15,`MergeCellsLoseData flag as per client and server does not match. MergeCellsLoseData flag as per client is :- ${za} and as per server is ${W}. The scenario is:- ${Sa}, The CSE is done:- ${Wa}`)}LWi(W,za,Sa){Ta.b(W,514846606)&&(t.ULS.sendTraceTag(537159453,0,50,"Merge cells with multiple values"),Oa.a(this.$).gd.RL(514846606),W=qa.h(this.$).rtl,W=Ma.a.ed(3,2,0,W?634:633,0,514846606,
"MergeCellsLoseData"),f.TaskExtensions.za(Gb.a(this.$).kj(W),Wa=>{Wa=Wa.result;0===Wa?(t.ULS.sendTraceTag(537159452,0,50,"MergeCellsLoseData Dialog: Ok pressed"),this.wub(this.gridView,za,!0,Sa)):1===Wa&&t.ULS.sendTraceTag(537159451,0,50,"MergeCellsLoseData Dialog: Cancel pressed")},this.$.la,11))}KWi(W,za,Sa,Wa,ab){let ma=!1;Ta.b(W,514846606)&&(ma=!0,Oa.a(this.$).gd.RL(514846606),Wa&&ab?window.setTimeout(()=>{this.wub(this.gridView,Sa,!0,!0)},0):this.I9f(za,Sa,!1));this.kCi(ma,ab,za.scenario,Wa)}Cqb(W){if(this.P_a!==
W&&1461300262!==this.P_a){this.XZf(this.P_a);var za=Qa.b().Cj(W);const Sa=Qa.b().Cj(this.P_a);t.ULS.sendTraceTag(537159450,0,50,`GridCommandHandler.CacheFontStyles: Style cached during ${Sa} was restored before caching the style for ${za} command.`)}this.P_a=W;if(this.wb&&this.gridView.fb)this.M_a||(this.M_a=this.gridView.ni.formattedText);else if(!this.kC){this.kC=[];za=this.gridView.O$("GridCommandHandler.CacheFontStyles",this.gridView.ha.qa.selectedRanges);try{for(za.$$rst();za.$$mn();){const Sa=
za.$$cu();if(Sa.cell.hasRichText)this.kC.push(ka.eZg(Sa,Sa.cell.formattedText));else switch(W){case 673562736:case -446735083:this.kC.push(ka.l0c(Sa,Sa.backgroundColor));break;case -128950598:case 1688184685:this.kC.push(ka.l0c(Sa,Sa.color));break;case 909774670:this.kC.push(ka.fZg(Sa,Sa.fontSize));break;case 324978188:this.Rl?this.kC.push(ka.dZg(Sa,Sa.fontName,Sa.kZ)):this.kC.push(ka.l0c(Sa,Sa.fontName))}}}finally{za&&za.dispose()}}}xLj(){return this.wb&&this.gridView.fb?!this.M_a:!this.kC}Fmi(W){return!!this.kC&&
this.kC.length>W&&!!this.kC[W].formattedText}ofd(W){return this.kC[W].style}BQh(W){return this.kC[W].size}AQh(W){return this.kC[W].kZ}XZf(W){if(!this.xLj()){if(this.wb&&this.gridView.fb)this.M_a&&(this.gridView.Vb.formattedText=this.M_a);else{const Sa=this.kC.length;for(let Wa=0;Wa<Sa;Wa++){let ab;var za=this.kC[Wa].TJa.cell.getRange();ab=this.gridView.Pb(za);if(!ab){t.ULS.sendTraceTag(537159441,0,50,`GridCommandHandler.RestoreCachedStyles: Cell is not supposed to be null. Cell range: ${za.RC(!1)}`);
continue}let ma;za=ab.vH?this.gridView.HLb(ab.range):(ma=new I.a,ma.add(ab),ma);for(let ha of za)if(ha.cell.hasRichText&&1457172838!==W)this.Fmi(Wa)&&(ha.cell.formattedText=this.kC[Wa].formattedText);else switch(W){case 1457172838:ha.backgroundColor=this.ofd(Wa);break;case 2036397036:ha.color=this.ofd(Wa);break;case -1904244080:ha.fontSize=this.BQh(Wa);break;case -1428968098:ha.fontName=this.ofd(Wa),this.Rl&&ha.b5f(this.AQh(Wa))}}}this.P_a=1461300262;this.r0a()}}r0a(){this.wb&&this.gridView.fb?this.M_a=
null:this.kC=null}U9h(W,za){const Sa={IndentationIncrease:0};if(-1942512156===W)Sa.IndentationIncrease=1;else if(-1920201820===W)Sa.IndentationIncrease=-1;else return!0;Sa.ValidMembers=256;this.Nh.formatCells(W,Sa,za);return!0}w$h(W,za){var Sa=this.gridView.Pb(null);const Wa=Ya.a(Sa);if(0<Sa.indentation&&-1526602249!==W)return!1;Sa=W;!qa.h(this.$).rtl||-1649235364!==W&&524773427!==W||(Sa=-1649235364===W?524773427:-1649235364);switch(Sa){case -1649235364:Sa=U.a.rotateTextUp45;break;case 524773427:Sa=
U.a.qwc;break;case 1886217042:Sa=U.a.rotateTextUp90;break;case 928057943:Sa=U.a.twc;break;case -1526602249:Sa=U.a.verticalText;break;default:return!1}Wa.ValidMembers=512;const ab=Wa.TextOrientation;Wa.TextOrientation=Sa===ab||ab===U.a.pwc&&Sa===U.a.qwc||ab===U.a.rwc&&Sa===U.a.twc?0:Sa;this.Nh.formatCells(W,Wa,za);return!0}R9h(){const W=qa.h(this.$),za=aa.r(W.ha.qa.selectedRanges,this.$),Sa=aa.o(W.ha.qa.activeCell,this.$);t.ULS.sendTraceTag(42566215,0,50,"GridCommandHandler: HandleIgnoreErrorCommand Invoked.");
return V.a(this.$.userOperationManager,(Wa,ab,ma)=>Y.r(this.$.oa.xa,Sa,za,Wa,ab,ma,null),Wa=>new P.a(201,0,Wa),null)}S$e(W,za){let Sa=null;var Wa=qa.h(this.$).ha.qa.selectedRanges;Wa=this.gridView.O$("MoreColors",Wa,1,!0);try{for(Wa.$$rst();Wa.$$mn();){const ab=Wa.$$cu().cell;if(!ab)continue;let ma=Ka.black;if(1970784898===W)ma=ab.color;else if(1650812936===W){const ha=ab.backgroundColor;ma=Fa.a.compare(ha,Ka.DZd,!0)&&Fa.a.compare(ha,Ka.empty,!0)?ab.backgroundColor:Ka.white}if(!Sa)Sa=ma;else if(Sa!==
ma){Sa=Ka.black;break}}}finally{Wa&&Wa.dispose()}this.wb&&this.gridView.fb&&1970784898===W&&this.gridView.ni.textBox.Jxe();return this.moreColorsHelper.pDb(W,za,Sa)}j$h(W){const za=y.a.R4a(this.borderFormatManager.h3);return this.moreColorsHelper.pDb(-236759591,W,za)}cpb(W,za,Sa,Wa=!1){za?this.gridView.ni.EOf(Sa.Font):(this.BEi(W),Wa?window.requestAnimationFrame(()=>{v.FocusManager.instance().kk(C.AFrame.gaa);this.gridView.ni.DZe(Sa.Font)}):(v.FocusManager.instance().kk(C.AFrame.gaa),this.gridView.ni.DZe(Sa.Font)),
this.r0a())}BEi(W){const za=D.a(W.command);W=x.a[W.Ve]+"_"+B.a[W.method];const Sa=this.gridView.mc.mBe.toString(),Wa=new Map;Wa.set("Command",za);Wa.set("Source",W);Wa.set("Ribbon","React");Wa.set("CellTextRuns",Sa);H.Health.instance.recordKpiUsage(Na.a.SJh,0,Ja.a.C_f,Wa)}tkd(W,za,Sa){W=this.borderFormatManager.tkd(W,za,Sa);this.moreColorsHelper&&this.moreColorsHelper.jda(za,this.borderFormatManager.h3,Sa);return W}getThemeColor(W){let za;za={};let Sa=!1;if((W.SqmControlId||"").includes("ThemeColorPicker")){if(!this.themesManager)return t.ULS.sendTraceTag(537159433,
0,10,"GridCommandHandler.GetThemeColor: Themes Manager is null"),{returnValue:!1,themeColor:za};let Wa;({themeIndex:W,wBa:Wa,returnValue:Sa}=this.themesManager.getThemeColor(W.Color));Sa&&(za.ThemeColorIndex=W,za.ThemeColorRow=Wa)}return{returnValue:Sa,themeColor:za}}static get t7i(){return Ka.$ge||(Ka.$ge=RegExp("^[0-9]+[.]?[0-9]*$"))}static get sod(){return Ka.uae||(Ka.uae={["InsertRows"]:5,["InsertColumns"]:9,["InsertCellsShiftRight"]:17,["InsertCellsShiftDown"]:33,["DeleteRows"]:6,["DeleteColumns"]:10,
["DeleteCellsShiftLeft"]:18,["DeleteCellsShiftUp"]:34,["DeleteRowsTable"]:6,["DeleteColumnsTable"]:10,["InsertRowsTable"]:5,["InsertColumnsTable"]:9,["InsertRowsBelow"]:37})}static get yZa(){return Ka.ohb||(Ka.ohb={["-394785302"]:0,["-571165336"]:2,["1041132226"]:1,["-1150205178"]:1,["-1142465846"]:2,["-286432209"]:3,["2007171328"]:6})}static get Nvf(){return Ka.oee||(Ka.oee={["-167499203"]:2,["-255094134"]:5,["1097660126"]:6,["155820588"]:7})}static cqi(W){return-1150205178===W||-1142465846===W||
-286432209===W||2007171328===W}static Yxc(W){const za={},Sa={};za.ValidMembers=16;za.Font=Sa;Sa.ValidMembers=W;return za}static T2e(W,za){let Sa;Sa=W.top<za.top?3:W.bottom>za.bottom?0:-1;return Sa=W.left<za.left?1:W.right>za.right?2:Sa}}Ka.DZd="transparent";Ka.notSet="-1";Ka.black="#000000";Ka.empty="";Ka.white="#FFFFFF";Ka.uae=null;Ka.ohb=null;Ka.oee=null;Ka.$ge=null;Ka.RJa=[8,9,10,11,12,14,16,18,20,24,26,28,36,48,72];Object(r.a)(Ka,"GridCommandHandler",null,[222]);class ub extends k.a{constructor(W){super(W)}hd(){const W=
e.GetServiceTaskFactory.create(this.$.da,111,this.la,this.Xa),za=e.GetServiceTaskFactory.create(this.$.da,18,this.la,this.Xa),Sa=e.GetServiceTaskFactory.create(this.$.da,397,this.la,this.Xa),Wa=e.GetServiceTaskFactory.Oa(this.$.da,502,503,this.Xa);if(d.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")){const ab=e.GetServiceTaskFactory.Oa(this.$.da,296,468,this.Xa);f.TaskExtensions.za(f.TaskExtensions.Fd([W,za,Sa,ab,Wa],this.la),()=>{this.$c([new Ka(this.$,qa.h(this.$),
za.result,W.result,ab.result,Sa.result,Wa.result)])},this.la,3)}else{const ab=e.GetServiceTaskFactory.create(this.$.da,102,this.la,this.Xa);f.TaskExtensions.za(f.TaskExtensions.Fd([W,za,ab,Sa,Wa],this.la),()=>{this.$c([new Ka(this.$,qa.h(this.$),za.result,W.result,new h.BorderFormatManager(this.$,za.result,ab.result),Sa.result,Wa.result)])},this.la,3)}}static ka(W){k.a.Md(80,new ub(W))}}Object(r.a)(ub,"GridCommandHandlerFactory",k.a,[]);a.d(F,"a",function(){return Kb});const Kb=()=>{c.a.Fa(ub.ka);
c.a.Fa(l.ka)}},1197:function(r,F,a){function c(Ta){return Object(z.c)(Ta)?"cache":"client"===Ta.origin||Ta.cached?"client":"server"}function b({x:Ta,y:Da},fa,ua=document){let Fa=-1,ca=null;void 0!==ua.caretPositionFromPoint?(Ta=ua.caretPositionFromPoint(Ta,Da),null!==Ta&&(Fa=Ta.offset,ca=Ta.offsetNode)):void 0!==ua.caretRangeFromPoint&&(Ta=ua.caretRangeFromPoint(Ta,Da),null!==Ta&&(Fa=Ta.startOffset,ca=Ta.startContainer));return null===ca||-1===Fa?(B.ULS.sendTraceTag(521446491,0,15,"getEditorCaretPositionFromPoint - failed to get relevant range"),
-1):fa.contains(ca)?e(fa,ca,Fa):(B.ULS.sendTraceTag(521446490,0,15,"getEditorCaretPositionFromPoint - relavant node not inside root"),-1)}function e(Ta,Da,fa){if(Ta===Da)return fa;if(Da.textContent!==Da.parentElement.textContent)for(;null!==Da.previousSibling;)Da=Da.previousSibling,fa+=Da.textContent.length,"div"===Da.nodeName.toLowerCase()&&(fa+=1);return e(Ta,Da.parentElement,fa)}function f(Ta,Da){return Ta.text===Da.text&&Ta.start===Da.start&&Ta.length===Da.length}function d(Ta,Da,fa){if(Ta.has(Da))return Ta.get(Da);
fa=fa();Ta.set(Da,fa);return fa}function h(Ta){return JSON.stringify({text:Ta.text,start:Ta.start,length:Ta.length})}function l(Ta){return Object(z.c)(Ta)?"Undefined text":""===Ta?"Empty text":null}var k=a(9);r=a(0);var t=a(226),n=a(161),z=a(740),w=a(21),m=a(11),u=a(22),y=a(13),v=a(220),C=a(34),x=a(33),B=a(15),H=a(1115);class I{constructor(Ta){this.$=Ta;this.rIa=this.etb=null;this.usage={};this.results={};this.performance={};this.Nrc=-1;this.uc=(Da,fa)=>{fa.Bf||fa.lqd||this.$.sendBeaconTraceTag(388818255,
50,!1,this.MYd())};this.editBox=Object(w.h)(this.$).Vb;Ta.nj(this.uc)}static getInstance(Ta){return I.instance||(I.instance=new I(Ta))}set trigger(Ta){this.etb=Ta;this.Nrc=H.a.wYd}set vOd(Ta){this.rIa=Ta}setResult(Ta,Da){if(Object(z.c)(this.etb))B.ULS.sendTraceTag(512258439,0,15,"ValuePreviewTelemetry.setResult - currentTrigger undefined");else{var fa=Da===this.editBox?"cellEditor":"formulaBar",ua=this.etb;Da=this.rIa;var Fa=this.Nrc;Object(z.c)(this.usage[fa])&&(this.usage[fa]={});Object(z.c)(this.usage[fa][ua])&&
(this.usage[fa][ua]={success:0,error:0,unavailable:0});fa=this.usage[fa][ua];switch(Ta.kind){case 1:this.Bej(Ta.text);fa.success++;this.etb=this.rIa=null;this.Nrc=-1;break;case 2:fa.error++;this.etb=null;this.Nrc=-1;break;case 3:fa.unavailable++}this.gw(Da,Fa)}}Bej(Ta){if(!Object(z.c)(this.rIa)){Object(z.c)(this.results[this.rIa.origin])&&(this.results[this.rIa.origin]=[]);var Da=this.results[this.rIa.origin];1E3>Da.length&&Da.push(Ta.length)}}gw(Ta,Da){if(-1!==Da){Ta=c(Ta);this.G5e(`${Ta}_request`).B3(!0,
Da);var fa=this.G5e(`${Ta}_overall`);window.requestAnimationFrame(()=>{fa.B3(!0,Da)})}}G5e(Ta){return this.performance[Ta]=this.performance[Ta]||new H.a(U)}MYd(){const Ta={};Object.keys(this.performance).forEach(Da=>{this.performance[Da].JXe();var fa=this.performance[Da];Ta[Da]={metrics:fa.SV,durations:fa.eub}});return`{"usage":${JSON.stringify(this.usage)},"results":${JSON.stringify(this.results)},"performance":${JSON.stringify(Ta)}}`}}Object(r.a)(I,"ValuePreviewTelemetry",null,[]);const U=[50,80,
100,130,150,170,200];class S{constructor(Ta,Da,fa){this.$=Ta;this.UJa=Da;this.ariaLiveNotifier=fa;this.ygi();this.editBox=Object(w.h)(this.$).Vb;this.xGj=x.a.tH(this.$)}get telemetry(){return I.getInstance(this.$)}get zoomManager(){this.Xme||(this.Xme=Object(C.a)(this.$));return this.Xme}dispose(){this.hide()}show(Ta,Da,fa){const ua=Object.assign(Object.assign({},Da),{qU:Ta,A2d:fa});this.oeb(ua)&&(this.Una(ua)&&this.hide(),this.OG=ua,this.telemetry.setResult(Da,Ta),this.nI(),fa&&this.ndi())}hide(){if(this.OG){var Ta=
this.OG.A2d;this.Dnh();Ta&&this.qij();this.OG=void 0}}oeb(Ta){var Da;(Da=!this.OG)||(Da=this.OG,Da=!(Da.qU===Ta.qU&&Da.kind===Ta.kind&&Da.text===Ta.text&&Da.start===Ta.start&&Da.length===Ta.length&&Da.A2d===Ta.A2d));return Da}Una(Ta){var Da;if(Da=this.OG)Da=this.OG,Da=!(Da.qU===Ta.qU&&Da.start===Ta.start&&Da.length===Ta.length);return Da}ndi(){this.OG.qU.textBox.formatText(this.OG.start,this.OG.length,{background:"rgba(202,234,216,0.6)"})}qij(){const Ta=this.OG.qU;Ta.textBox.formatText(0,Ta.text.length,
{background:!1});this.xGj&&Ta.KD(null)}nI(){var Ta=this.OG.text;switch(this.OG.kind){case 1:case 2:Ta={isLoaded:!0,value:Ta};break;case 3:Ta={isLoaded:!1,value:null};break;default:return}this.G2j();this.UJa.renderValuePreview(this.xs,this.rPb,Ta);this.g5i(Ta)}Dnh(){this.UJa.dismiss(this.xs)}ygi(){this.xs=document.createElement("div");this.rPb=document.createElement("div");this.rPb.style.position="absolute";this.rPb.style.visibility="hidden";this.$.domElement.appendChild(this.rPb)}G2j(){var Ta=this.OG.qU,
Da=this.OG.start;const fa=this.OG.length,ua=u.a.contains(Ta.text.substring(Da,Da+fa),"\n",!0);Ta=excelOnline.utils.getBoundingRectForText(Ta.textBox.Je,Da,ua?Da:Da+fa,!1);Da=new v.a(this.rPb.style);Da.EB.left=this.mAc(Ta.left);Da.EB.top=this.mAc(Ta.top);Da.EB.width=this.mAc(Ta.width);Da.EB.height=this.mAc(Ta.height);Da.s2()}mAc(Ta){var Da=this.OG.qU;Da=Object(z.b)(this.zoomManager)&&Da===this.editBox;return m.HelperMethods.sc(Da?this.zoomManager.mi(Ta):Ta)}g5i({isLoaded:Ta,value:Da}){Ta?this.ariaLiveNotifier.readText(String.format(y.a.instance.ob(179),
Da)):this.ariaLiveNotifier.readText(y.a.instance.ga(865))}}Object(r.a)(S,"FormulaAssistanceValuePreviewControl",null,[2]);var G=a(117);class D{constructor(Ta){this.cache=Ta}clearCache(){this.cache=void 0}}Object(r.a)(D,"Cacheable",null,[]);class E extends D{constructor(Ta,Da){super();this.$=Ta;this.callbacks=Da;this.xCf=(fa,ua)=>{const Fa=this.gridView.ni;if(!(0<(Fa.fb?Fa.textBox.selection:{index:0,length:0}).length))switch(ua.state){case 0:this.onHoverEnter(fa,ua.event);break;case 1:this.onHoverLeave(fa);
break;default:return B.ULS.shipAssertTag(521446489,0,!1,"FormulaAssistanceValuePreviewHandler.onHoverChange unxpected HoverState"),ua}};this.wCf=(fa,ua)=>{const Fa=ua.selection;ua={kind:"selection",text:ua.text,start:Fa.index,length:Fa.length};if(0<Fa.length)this.onSelectionChange(fa,ua);else this.kIf(fa,ua)};this.gridView=Object(w.h)(this.$);this.editBox=this.gridView.mc;this.Aj(this.editBox);this.formulaBar=Object(G.a)(this.$);Object(z.b)(this.formulaBar)?this.Aj(this.formulaBar):Object(G.b)(this.$,
fa=>{this.formulaBar=fa;this.Aj(this.formulaBar);B.ULS.sendTraceTag(509870663,1,50,"FormulaAssistanceValuePreviewHandler: formulaBar async")})}get telemetry(){return I.getInstance(this.$)}dispose(){this.Sj(this.editBox);this.Sj(this.formulaBar)}trigger(){const Ta=this.gridView.ni,Da=Ta.textBox.selection;this.onSelectionChange(Ta,{kind:"shortcut",text:Ta.text,start:Da.index,length:Da.length})}Aj(Ta){Ta.Sqe(this.xCf);Ta.DMg(this.wCf)}Sj(Ta){null===Ta||void 0===Ta?void 0:Ta.yWf(this.xCf);null===Ta||
void 0===Ta?void 0:Ta.Pjj(this.wCf)}onHoverEnter(Ta,Da){Da=new Sys.UI.Point(Da.clientX,Da.clientY);Da=b(Da,Ta.textBox.Je);if(-1!==Da)this.onSelectionChange(Ta,{kind:"hover",text:Ta.text,start:Da,length:0})}onHoverLeave(Ta){this.kIf(Ta)}onSelectionChange(Ta,Da){this.LFj(Da)&&(this.cache=Da,this.callbacks.wEd(Ta,{index:Da.start,length:Da.length}),this.telemetry.trigger=Da.kind)}kIf(Ta,Da){this.HFj(Da)&&(this.clearCache(),this.callbacks.uca(Ta))}LFj(Ta){return!this.cache||!f(this.cache,Ta)}HFj(Ta){return this.cache&&
Ta?"shortcut"!==this.cache.kind||!f(this.cache,Ta):!0}}Object(r.a)(E,"FormulaAssistanceValuePreviewHandler",D,[2]);var N;(function(Ta){Ta[Ta.Failure=0]="Failure";Ta[Ta.Success=1]="Success";Ta[Ta.Error=2]="Error";Ta[Ta.Unavailable=3]="Unavailable"})(N||(N={}));Object(r.b)("ValuePreviewResultKind",N);var M=a(41),L=a(60);class aa{constructor(Ta,Da){this.$=Ta;this.pluginScheduler=Da;this.CR=new P(h);this.r3f=new P(h);this.UZi=(fa,ua)=>Fa=>{if(Object(z.c)(Fa.Result))ua("No result");else if(Fa=JSON.parse(Fa.Result),
Object(z.c)(Fa))ua("Failed to deserialize");else if(1!==Object.keys(Fa).length)ua("Invalid response");else{for(var ca in Fa)var ka=Fa[ca];ca=l(ka);Object(z.b)(ca)?ua(ca):fa(ka)}};this.TZi=fa=>()=>{fa("Request failed")};this.gridView=Object(w.h)(this.$);if(this.Uvb=x.a.fV(this.$))this.formulaAssistanceManager=Ta.da.Aa(464)}get telemetry(){return I.getInstance(this.$)}clearCache(){this.CR.clear();this.r3f.clear()}request(Ta){return Object(n.a)(this,void 0,void 0,function*(){return d(this.CR,Ta,()=>
Object(n.a)(this,void 0,void 0,function*(){const {kind:Da,payload:fa}=yield this.pluginScheduler.getRequester().valuePreview(Ta,this.formulaAssistanceManager?this.formulaAssistanceManager.aIb:0);if(0!==Da)return null;if(Object(z.c)(fa))return{kind:0};this.telemetry.vOd={origin:"client"};switch(fa.kind){case 0:return{kind:0};case 1:case 2:return this.Q4j(fa);case 3:const ua={text:Ta.text,start:fa.start,length:fa.length};return this.CR.has(ua)?(this.telemetry.vOd={origin:"server",cached:!0},yield this.CR.get(ua)):
Object.assign(Object.assign({},fa),{kind:3,next:()=>this.eoj(ua,Ta,fa.text)})}}))})}Q4j(Ta){const Da=l(Ta.text);return Object(z.b)(Da)?(B.ULS.sendTraceTag(509871621,1,15,`FormulaAssistanceValuePreviewRequester.validateClientSuccessResult: formula failure:${Da}, kind:${N[Ta.kind]}`),{kind:0}):Ta}eoj(Ta,Da,fa){return Object(n.a)(this,void 0,void 0,function*(){return d(this.r3f,Ta,()=>{const ua=new Promise(Fa=>Object(n.a)(this,void 0,void 0,function*(){try{const ca=yield this.K_h(fa);this.telemetry.vOd=
{origin:"server"};Fa({kind:1,text:ca,start:Ta.start,length:Ta.length})}catch(ca){B.ULS.sendTraceTag(520495426,1,50,`FormulaAssistanceValuePreviewRequester.requestFromServer: getPartialCalcResults failed, ${ca}`),Fa({kind:0})}}));ua.then(()=>{this.CR.set(Ta,ua);this.CR.set(Da,ua)}).catch(Fa=>{B.ULS.sendTraceTag(520495425,1,15,`FormulaAssistanceValuePreviewRequester.requestFromServer: serverPromise failed, ${Fa}`)});return ua})})}K_h(Ta){return Object(n.a)(this,void 0,void 0,function*(){return new Promise((Da,
fa)=>{const ua={Formula:Ta,PartialFormula:Ta,SourceRange:Object(M.v)(this.gridView.ha.qa.activeCell,this.$)};V(this.$.oa.xa,ua,this.UZi(Da,fa),this.TZi(fa),null,null)})})}}Object(r.a)(aa,"FormulaAssistanceValuePreviewRequester",null,[]);const V=(Ta,Da,fa,ua,Fa,ca,ka=null)=>{ka=Ta.Na(1,ka);ka.getPartialCalcResultsParameters=Da;return Object(L.g)(Ta,"GetPartialCalcResults",ka,fa,ua,Fa,ca,4)};class P{constructor(Ta){this.NYd=Ta;this.map=new Map}has(Ta){Ta=this.NYd(Ta);return this.map.has(Ta)}get(Ta){Ta=
this.NYd(Ta);return this.map.get(Ta)}set(Ta,Da){Ta=this.NYd(Ta);this.map.set(Ta,Da);return this}clear(){this.map.clear()}}Object(r.a)(P,"RequestMap",null,[]);class ba{constructor(Ta,Da,fa,ua){this.$=Ta;this.wEd=(Fa,ca)=>Object(n.a)(this,void 0,void 0,function*(){const ka={text:Fa.text,start:ca.index,length:ca.length};void this.EPf(ka,this.requester.request.bind(this.requester),Fa,0===ka.length)});this.uca=()=>{this.hide()};this.reset=()=>{this.handler.clearCache();this.requester.clearCache();this.hide()};
this.Dw=()=>{this.handler.clearCache();this.requester.clearCache()};this.gridView=Object(w.h)(this.$);this.control=new S(this.$,fa,ua);this.requester=new aa(this.$,Da);this.handler=new E(this.$,{wEd:this.wEd,uca:this.uca});this.Aj()}trigger(){this.handler.trigger()}dispose(){this.Sj();this.handler.dispose();this.control.dispose()}Aj(){this.gridView.Vb.Km(this.reset);this.gridView.ha.Mga(this.reset);this.$.ea.oA(this.Dw)}Sj(){this.gridView.Vb.$l(this.reset);this.gridView.ha.Zma(this.reset);this.$.ea.uB(this.Dw)}EPf(Ta,
Da,fa,ua){return Object(n.a)(this,void 0,void 0,function*(){const Fa=Object.assign(Object.assign({},Ta),{qU:fa,STd:ua});this.pIa=Fa;const ca=yield Da(Ta);Object(z.c)(ca)||this.qti(Fa)&&void this.dai(ca)})}dai(Ta){return Object(n.a)(this,void 0,void 0,function*(){const Da=this.pIa.text,fa=this.pIa.qU,ua=this.pIa.STd;switch(Ta.kind){case 0:this.hide();break;case 1:case 2:this.show(fa,Ta,ua);break;case 3:if(!this.Yvi(Ta))break;this.show(fa,Ta,ua);void this.EPf({text:Da,start:Ta.start,length:Ta.length},
Ta.next,fa,ua);break;default:return Ta}})}show(Ta,Da,fa){this.pIa=void 0;this.xti(Da)&&(this.control.show(Ta,Da,fa),this.$sb=Da)}hide(){this.control.hide();this.$sb=this.pIa=void 0}qti(Ta){var Da;if(Da=this.pIa)Da=this.pIa,Da=Da.text===Ta.text&&Da.start===Ta.start&&Da.length===Ta.length&&Da.qU===Ta.qU&&Da.STd===Ta.STd;return Da}xti(Ta){return Object(z.b)(Ta.text)&&""!==Ta.text}Yvi(Ta){return!this.$sb||this.$sb.start!==Ta.start||this.$sb.length!==Ta.length||3===this.$sb.kind}}Object(r.a)(ba,"FormulaAssistanceValuePreview",
null,[542,2]);var Y=a(50),Z=a(37);class ea extends t.a{constructor(Ta){super();this.$=Ta;this.Db()}static ka(Ta){Ta.da.Ha(497,new ea(Ta))}create(){let Ta=this.$.da.Aa(496);Ta&&this.nb(Ta);const Da=Y.GetServiceTaskFactory.Oa(this.$.da,413,414,this.Xa),fa=Y.GetServiceTaskFactory.Oa(this.$.da,448,449,this.Xa),ua=Y.GetServiceTaskFactory.Oa(this.$.da,19,153,this.Xa),Fa=Y.GetServiceTaskFactory.Oa(this.$.da,211,212,this.Xa);Z.TaskExtensions.za(Z.TaskExtensions.Fd([Da,fa,ua,Fa],this.la),()=>{Ta=this.$.da.Aa(496);
Ta||(Ta=new ba(this.$,Da.result,fa.result,Fa.result),this.$.da.Ha(496,Ta));this.nb(Ta)},this.la,3)}}Object(r.a)(ea,"FormulaAssistanceValuePreviewFactory",t.a,[]);var ra=a(709),O=a(189),da=a(55);class xa{constructor(Ta,Da){this.formulaAssistanceValuePreview=Da;this.gridView=Object(w.h)(Ta)}Hc(){return!1}executeCommand(Ta,Da){Ta=!1;Da=Da.command;switch(Da){case -46938080:this.formulaAssistanceValuePreview.trigger(),Ta=!0}return Ta?da.Task.Sa(!0):O.a(Da)}wc(Ta,Da){return-46938080===Da.command}Nc(){return!1}}
Object(r.a)(xa,"FormulaAssistanceValuePreviewCommandHandler",null,[222]);class ia extends ra.a{constructor(Ta){super(Ta)}hd(){const Ta=Y.GetServiceTaskFactory.Oa(this.$.da,496,497,this.Xa);Z.TaskExtensions.za(Ta,()=>{this.$c([new xa(this.$,Ta.result)])},this.la)}static ka(Ta){ra.a.Md(515,new ia(Ta))}}Object(r.a)(ia,"FormulaAssistanceValuePreviewCommandHandlerFactory",ra.a,[]);a.d(F,"a",function(){return Ma});const Ma=()=>{k.a.Fa(Ta=>{ea.ka(Ta);ia.ka(Ta)})}},1203:function(r,F,a){r=a(0);var c=a(15),
b=a(192),e=a(85),f=a(84),d=a(390),h=a(100),l=a(46);class k{constructor(){this.kda=this.W_e=null}}Object(r.a)(k,"GestureAdapterInfo",null,[]);var t=a(4),n=a(380),z=a(231);class w{constructor(){this.RJc=null}EAi(){if(!this.RJc){var L="hammer.min.js";t.AFrameworkApplication.fa.Gp("IsServerFlavorDebug")&&(L=t.AFrameworkApplication.fa.pa("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");L=t.AFrameworkApplication.$N(String.format("{0}",L),5);L=z.a.create(L,null,null);n.a.yia(L);this.RJc=L.Y8a}return this.RJc}static get instance(){w.La||
(w.La=new w);return w.La}}w.La=null;Object(r.a)(w,"HammerJsDependencyLoader",null,[651]);var m=a(14);const u=(L,aa,V=null)=>{if(void 0===aa||null===aa)throw c.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");let P=null;switch(L){case m.a.pinch:P=new Hammer.Pinch(V);break;case m.a.pan:P=new Hammer.Pan(V)}P&&(P.manager=aa);return P};var y;(function(L){L[L.none=-1]="none";L[L.pinch=0]="pinch";L[L.pan=1]="pan";L[L.swipe=2]="swipe"})(y||(y={}));Object(r.b)("GestureEvent",
y);var v=a(78);class C extends v.a{constructor(L,aa,V,P,ba,Y,Z,ea){super(L,V,P,Y);this.Whb=aa;this.gga=Z;this.qX=ea;this.ixg=ba}get shiftKey(){return this.gga}get ctrlKey(){return this.qX}get clientPoint(){return this.Whb}get Wua(){return this.ixg}static create(L,aa,V,P,ba,Y){if(V.rawEvent)if(Y){var Z=V.rawEvent;Z=new Sys.UI.Point(Z.clientX,Z.clientY)}else Z=v.a.Hwb(V);else Z=new Sys.UI.Point(V.clientX,V.clientY);return new C(L,Z,aa,V,P,ba,V.shiftKey,V.ctrlKey,Y)}}Object(r.a)(C,"GestureEventArgs",
v.a,[]);class x{constructor(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(r.a)(x,"GestureManagerData",null,[]);class B{}B.Pqg=2;B.Qqg=4;B.Rqg=8;B.Sqg=8;Object(r.a)(B,
"HammerConstants",null,[]);var H=a(95),I=a(210),U=a(30),S=a(80);class G extends l.a{constructor(L,aa){super();this.rqa=d.a.JNh;this.mRc=!!window.PointerEvent;this.Ile=window.hasOwnProperty("ontouchstart");this.iWa=this.nlb=null;this.C8=!1;this.QS=new h.a;this.Ilb=new h.a;this.jxg=new b.a;this.Qpa=null;this.nVa=this.FLc=this.j6d=this.AIc=this.gPc=this.die=this.p6d=this.jnb=!1;this.Rkb=-1;this.curRecognizer=this.element=this.handlers=this.session=this.TTc=null;this.Od=H.EventHandlerManager.instance;
this.mRc?(c.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.nlb=Object(e.a)(this,this.hqc,"onPointerEvent"),this.iWa=m.a.LNh):this.Ile?(c.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.nlb=Object(e.a)(this,this.Tya,"onTouchEvent"),this.iWa=m.a.touchEvents):(c.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.nlb=Object(e.a)(this,this.Tpc,"onMouseEvent"),this.iWa=m.a.KNh);this.rh=aa;this.hfa=L;t.AFrameworkApplication.fa&&(this.jnb=t.AFrameworkApplication.fa.pa("UsePointerCaptureIsEnabled"),
this.p6d=t.AFrameworkApplication.fa.pa("ClearCacheOnPrimaryPointerIsEnabled"),this.die=t.AFrameworkApplication.fa.pa("ResetHandledBeforeInputHandlerIsEnabled"),this.gPc=t.AFrameworkApplication.fa.pa("LogCoalescedEventsIsEnabled"),this.AIc=t.AFrameworkApplication.fa.pa("CheckExistenceOfGetCoalescedEventsIsEnabled"),this.j6d=t.AFrameworkApplication.fa.pa("CheckIfHammerExistsAfterDownloadIsEnabled"),this.FLc=t.AFrameworkApplication.fa.pa("HammerJsPerformanceTimersIsEnabled"),this.nVa=this.jnb&&t.AFrameworkApplication.fa.pa("CancelDragFromGestureInputManagerIsEnabled")&&
t.AFrameworkApplication.fa.pa("UseGestureInputManagerPointerCacheIsEnabled"))}lWh(){return this.mRc?0:this.Ile?1:2}rn(L){super.rn(L);this.Od.qka(this.iWa,L,0,this.nlb)}nm(L){super.nm(L);this.Od.CIa(L,this.iWa)}Sfj(L,aa,V=null){t.AFrameworkApplication.Hic()?w.instance.EAi().continueWith(P=>{this.bOj();if(P.Hf||P.kh)c.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",P.status);else{c.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",P.status);if(this.j6d){P=window.Hammer;
if("undefined"===typeof P){c.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.bBc();return}if("undefined"===typeof P.inputHandler){c.ULS.sendTraceTag(590901390,310,10,"Hammer.inputHandler does not exist");this.bBc();return}}if(!L)throw this.bBc(),Error.argumentNull("source element can not be null");P=I.a.vva(L,this.rqa);if(void 0===P||null===P)P=new h.a,I.a.Pdb(L,this.rqa,P),this.Tfj(L);var ba=null;P.hb(y[0])||(ba=Object.assign(new k,{kda:u(y[0],this,null),W_e:aa}),P.add(y[0],ba));
if(void 0!==V&&null!==V)for(let Y=0;Y<V.length;Y++)if(P.hb(y[V[Y]])){const Z=P.ma(y[V[Y]]);ba.kda.recognizeWith(Z.kda)}}this.bBc()}):c.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}bOj(){this.FLc&&(this.rh?this.TTc=this.rh.Gc("Task","RegisterGestureAdapterAfterLoad"):c.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))}bBc(){this.FLc&&(this.TTc?this.TTc.stop():c.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}Tfj(L){this.jxg.add(L);
this.Od.qka(this.iWa,L,0,this.nlb)}recognize(L){var aa=Array(L.pointers.length);for(var V=0;V<L.pointers.length;V++)aa[V]=L.pointers[V].target;V=null;for(this.Qpa=this.FYh(aa);void 0!==this.Qpa&&null!==this.Qpa&&(V=I.a.vva(this.Qpa,this.rqa),void 0===V||null===V);this.Qpa=this.Qpa.parentNode);if(void 0!==V&&null!==V){this.curRecognizer&&this.curRecognizer.state===B.Sqg&&(this.curRecognizer=null);aa=V.keys;for(let P of aa){aa=V.ma(P);void 0!==aa&&null!==aa&&void 0!==aa.kda&&null!==aa.kda&&(void 0===
this.curRecognizer||null===this.curRecognizer||aa.kda===this.curRecognizer||aa.kda.canRecognizeWith(this.curRecognizer))&&aa.kda.recognize(L);const ba=aa.kda.state;this.curRecognizer||B.Pqg!==ba&&B.Qqg!==ba&&B.Rqg!==ba||(this.curRecognizer=aa.kda)}}}emit(L,aa){if("hammer.input"!==L){this.C8=!1;aa=C.create(L,this.Qpa,aa.srcEvent,aa,3,this.mRc);var V=I.a.vva(this.Qpa,this.rqa);if(this.nsi(L))var P=0;else if(this.esi(L))P=1;else if(this.nvi(L))P=2;else{c.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");
return}({value:V}=V.Fc(y[P]));void 0!==V&&null!==V&&((V=V.W_e,V.Jpi())?L.endsWith("start")?this.C8=V.YSi(aa):L.endsWith("end")?(V.WSi(aa),this.C8=!0):L.endsWith("cancel")?(V.VSi(aa),this.C8=!0):L.endsWith("move")&&(this.C8=V.XSi(aa)):c.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",L))}}get(L){return Object(f.a)(Hammer.Recognizer,L)}FYh(L){if(1>L.length)return null;if(1===L.length)return L[0];var aa=L[0],V=!0;for(let P=1;P<L.length;P++){if(!L[P])return null;if(aa!==L[P]){V=
!1;break}}if(V)return aa;aa=this.k0e(L[0]);V=0;for(const P of L){L=this.k0e(P);if(aa.ma(aa.count-1)!==L.ma(L.count-1))return null;for(let ba=aa.count-2,Y=L.count-2;ba>=V&&0<=Y;ba--,Y--)if(aa.ma(ba)!==L.ma(Y)){V=ba+1;break}}return aa.ma(V)}k0e(L){const aa=new b.a;for(;void 0!==L&&null!==L;L=L.parentNode)aa.add(L);return aa}c4e(L){switch(L){case m.a.pf:case m.a.e$:return 1;case m.a.Tf:case m.a.iha:return 2;case m.a.ve:case m.a.UGa:return 4;case m.a.OCc:case m.a.V_c:return 8}return 0}Tya(L,aa,V){L=this.c4e(L);
aa=this.kXh(V);Hammer.inputHandler(this,L,aa);this.C8&&V.preventDefault();return this.C8}xaf(){return 1<this.QS.count}b3b(){c.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.jnb)for(let L of this.QS)this.xVf(L.key);else this.QS=new h.a;this.session=null}SJg(L,aa,V){c.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",L);if(!this.Ilb.hb(L)){try{aa.setPointerCapture(L)}catch(P){c.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",P)}this.Ilb.add(L,
aa)}this.QS.ia(L,V);this.nVa&&1<this.QS.count&&this.hfa&&!this.hfa.Sqb&&(this.hfa.Sqb=!0)}xVf(L){c.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",L);if(this.Ilb.hb(L)){try{this.Ilb.ma(L).releasePointerCapture(L)}catch(aa){c.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",aa)}this.Ilb.remove(L)}else c.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",L);this.QS.remove(L);this.nVa&&1>=this.QS.count&&this.hfa&&this.hfa.Sqb&&
(this.hfa.Sqb=!1)}hqc(L,aa,V){var P=V.rawEvent.pointerType.toString();const ba=V.rawEvent.pointerId.toString();if("touch"!==P)return!1;L=this.c4e(L);if(1!==L&&!this.QS.hb(ba))return!1;this.p6d&&1===L&&V.rawEvent.isPrimary&&this.QS.count&&(c.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.b3b());this.jnb?this.SJg(ba,aa,V):this.QS.ia(ba,V);this.gPc&&2===L&&(!this.AIc||this.AIc&&"function"===typeof V.rawEvent.getCoalescedEvents)&&(aa=V.rawEvent.getCoalescedEvents())&&this.xaf()&&
(this.Rkb=Math.max(this.Rkb,aa.length));this.die&&(this.C8=!1);P=this.jXh(this.QS,V,P);Hammer.inputHandler(this,L,P);if(4===L||8===L)this.jnb?this.xVf(ba):this.QS.remove(ba),this.QS.count||(this.session=null,this.gPc&&-1!==this.Rkb&&(c.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.Rkb),this.Rkb=-1));this.C8&&V.preventDefault();return this.C8}Tpc(){return!1}kXh(L){const aa=new x;var V=L.rawEvent;const P=V.touches;V=V.changedTouches;aa.pointers=Array.clone(P);aa.pointers=
Array.clone(0<P.length?P:V);aa.changedPointers=Array.clone(V);aa.srcEvent=L;aa.pointerType="touch";return aa}jXh(L,aa,V){const P=new x;P.pointers=S.toArray(L.values);P.changedPointers=[aa];P.pointerType=V;P.srcEvent=aa;return P}nsi(L){return U.a.startsWith(L,m.a.pinch)}esi(L){return U.a.startsWith(L,m.a.pan)}nvi(L){return U.a.startsWith(L,m.a.swipe)}}Object(r.a)(G,"GestureInputManager",l.a,[549,550]);var D=a(280),E=a(251);class N{constructor(){this.$a=null;this.dx=!1}get name(){return"Common.App.GestureInputManager"}Bh(L){L.register(G,
"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").qc().yc(()=>new G(D.a.instance,t.AFrameworkApplication.sa.HD));this.$a=L}init(){this.dx||(this.$a.resolve("Common.App.GestureManager.GestureInputManager"),this.dx=!0)}dispose(){}static main(){E.a.instance.ii(new N)}}Object(r.a)(N,"GestureInputManagerPackage",null,[3,4]);a.d(F,"a",function(){return M});const M=()=>{Type.registerNamespace("Common.App.GestureManager");N.main()}},1213:function(r,F,a){var c=a(9);r=a(0);
var b=a(226),e=a(27),f=a(89),d=a(30),h=a(421),l=a(239);class k{}k.Dvh="ewa-dv";k.Evh="ewa-dv-buttonarea";k.Vuh="ewa-dlb";k.CDb="list-table";k.listItem="list-item";k.zDb="list-item-selected";k.DDb="list-table-touch";k.Cvh="ewa-dpb";k.eqh="dv-prompt-title";k.dqh="dv-prompt-message";Object(r.a)(k,"CssClassNames",null,[]);var t=a(31),n=a(747),z=a(19),w=a(49),m=a(432),u=a(68),y=a(7),v=a(15),C=a(157),x=a(837),B=a(37),H=a(13),I=a(21),U=a(267),S=a(71);class G extends C.ErrorDialog{constructor(Ra,qa,La){super(Ra,
G.pQ(qa,Ra,La));this.Uc=()=>{this.setFocus()};I.h(this.$).ha.eC(this.Uc);(Ra=Ra.da.Aa(14).n4a(La))&&Ra.options&1&&v.ULS.sendTraceTag(537163291,0,50,"DataValidationErrorDeprecatedDialog.DataValidationErrorDeprecatedDialogs, Data validation Error opened on a list rule.")}dispose(){I.h(this.$).ha.vB(this.Uc);super.dispose()}setFocus(){switch(this.error.Severity){case 0:var Ra=4;break;case 1:Ra=3;break;case 2:Ra=0;break;default:Ra=this.kM}(Ra=this.getButton(Ra))?Ra.get_element().focus():super.setFocus()}Orb(){const Ra=
I.h(this.$);Ra.fb&&Ra.Vb.endEdit(!1,"DataValidationErrorDeprecatedDialog.CommitAfterClosing",0);4===this.returnValue&&this.wWd(1);if(2===this.returnValue||0===this.returnValue){const qa=Ra.Pb(null);if(qa){Ra.Ca.dV();const La=Object(y.a)(new U.a,{Text:qa.originalText});Ra.setCell(La,qa.range,0,63,null)}this.$.Yc(-798660877,u.a.zb,8,null)}super.Orb()}Gsa(){const Ra=I.h(this.$);Ra.fb&&Ra.Vb.endEdit(!1,"DataValidationErrorDeprecatedDialog.CancelAfterClosing",0);3===this.returnValue&&this.wWd(0);super.Gsa()}wWd(Ra){const qa=
I.h(this.$);B.TaskExtensions.za(qa.startEdit(!1,Ra),()=>{const La=qa.Vb.textBox;La.text&&La.selectRange(0,La.text.length)},this.la,11,S.a.current)}static pQ(Ra,qa,La){La=qa.da.Aa(14).n4a(La);Ra.MessageId=-1083021405;Ra.MessageIdName="DataValidationError";Ra.MessageIdHash=d.a.Yu(Ra.MessageIdName);Ra.Severity=La?La.W$c:1;qa=(null===La||void 0===La?0:La.jJa)?d.a.yg(La.jJa):null;La=(null===La||void 0===La?0:La.error)?d.a.yg(La.error):String.format("<p>{0}</p><p>{1}</p>",H.a.instance.ga(895),H.a.instance.ga(896));
switch(Ra.Severity){case 0:Ra.Appearance=18;break;case 1:Ra.Appearance=12;La+=String.format("<p>{0}</p>",H.a.instance.ga(897));break;default:Ra.Appearance=3}Ra.Caption=qa;Ra.Description=La;Ra.HelpDescription=H.a.instance.ga(1318);Ra.HelpTopicId=x.a.kKe;return Ra}}Object(r.a)(G,"DataValidationErrorDeprecatedDialog",C.ErrorDialog,[]);C=a(285);var D=a(1105),E=a(5),N=a(41),M=a(284),L=a(196),aa=a(51),V=a(29),P=a(249),ba=a(1),Y=a(11),Z=a(282),ea=a(165);class ra extends C.a{constructor(Ra,qa,La){super(Ra);
this.xU=this.wq=null;this.Plf=!1;this.PW=this.Lm=this.Pbf=this.errorMessage=null;this.lKe=Yb=>{const mc=this.$;var Zb=this.Plf;this.hide();const qb=I.h(mc);qb.fb&&qb.Vb.endEdit(!1,"DataValidationErrorDialog.DataValidationErrorDialogHandler",0);1===Yb&&Zb&&B.TaskExtensions.za(qb.startEdit(!1,1),()=>{const Ha=qb.Vb.textBox;Ha.text&&Ha.selectRange(0,Ha.text.length)},this.la,11,S.a.current);if(1===Yb&&!Zb){if(Zb=qb.Pb(null)){qb.Ca.dV();const Ha=Object(y.a)(new U.a,{Text:Zb.cell.userInput});qb.setCell(Ha,
Zb.range,0,63,null)}mc.Yc(-798660877,u.a.zb,8,null)}2===Yb&&B.TaskExtensions.za(qb.startEdit(!1,0),()=>{const Ha=qb.Vb.textBox;Ha.text&&Ha.selectRange(0,Ha.text.length)},this.la,11,S.a.current)};this.tDd=()=>{Y.HelperMethods.LV(this.$.WF,this.error.HelpTopicId,this.$.mS)};this.PUi=()=>{this.gzb();this.$.Yc(802602464,2,8,this.xU)};this.mTi=()=>{v.ULS.sendTraceTag(537163288,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationFailureCallback, failed to get expected results.")};this.nTi=
Yb=>{!Yb||P.a(Yb)?v.ULS.sendTraceTag(537163287,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationSuccessCallback, failed to get expected results."):(Yb=this.z2h(Yb.Result),this.wq.errorInformation=Yb,this.dUa(this.jJa,this.U4a(this.lKe),this.wq))};this.aDd=()=>{this.show(this.mTb)};this.FQe=La;this.sqmManager=ea.a(this.$);this.error=ra.pQ(qa,Ra,La);this.qb.To=this;this.jJa=(this.aw=Ra.da.Aa(14).n4a(this.FQe))&&this.aw.jJa?this.aw.jJa:H.a.instance.ga(1735);this.qyj();this.initializeAndShow(this.jJa,
this.lKe,this.wq)}get kc(){return"DataValidationErrorDialog"}dispose(){this===this.qb.To&&(this.qb.To=null);f.a.Ja(this.Lm);this.Lm=null;super.dispose()}qyj(){var Ra,qa,La;this.aw&&this.aw.options&1?(v.ULS.sendTraceTag(537163289,0,50,"DataValidationErrorDialog.SetDialogProps, Data validation Error opened on a list rule."),this.errorMessage=null!==(Ra=this.aw.error)&&void 0!==Ra?Ra:H.a.instance.ga(1737),this.Pbf=aa.a.current.qo(119)):(this.errorMessage=null!==(La=null===(qa=this.aw)||void 0===qa?void 0:
qa.error)&&void 0!==La?La:H.a.instance.ga(1736),this.eTh(this.FQe));Ra=this.aw?this.aw.W$c:1;this.wq={[ra.it]:this.kc,["errorDescription"]:this.errorMessage,["helpImageUri"]:this.Pbf};switch(Ra){case 0:this.Ob=1;this.tc(1,"Retry");this.wq.dialogIcon=2;this.Plf=!0;break;case 1:this.Ob=4;this.wq.dialogIcon=1;this.wq.additionalInformation=H.a.instance.ga(897);break;default:this.Ob=1,this.wq.dialogIcon=3}this.wq.helpLink={["type"]:"AppLinkProps",[ra.it]:this.error.HelpTopicId,["text"]:H.a.instance.ga(1318),
["handler"]:this.tDd};Ra=V.a.iZc([this.error]);this.xU={[E.a.N$b]:!0,[E.a.ecd]:Ra,[E.a.fcd]:ea.a(this.$).Dub(this.error.MessageIdHash),[E.a.wM]:this.kc,["DismissHandler"]:this.aDd};this.wq.giveFeedbackLink={["type"]:"AppLinkProps",[ra.it]:E.a.ckd,["text"]:H.a.instance.ga(1774),["handler"]:this.PUi}}eTh(Ra){const qa=this.$.oa.xa.Wb();M.g(this.$.oa.xa,N.q(Ra,this.$),Z.b(this.nTi),Z.a(this.mTi),null,qa)}z2h(Ra){let qa;ba.EwaSettings.isChangeGateEnabled("OfficeVSO:7253041_adddatavalidationerrortypetelemetry");
v.ULS.sendTraceTag(509732815,0,50,`DataValidationErrorDialog.getRuleDescriptionString: The data validation error is because of ${D.a[Ra.RuleType].toString()}`);switch(Ra.RuleType){case 1:switch(Ra.ConditionType){case 0:return qa=H.a.instance.ob(108),String.format(qa,Ra.LowerBoundary,Ra.UpperBoundary);case 1:return qa=H.a.instance.ob(109),String.format(qa,Ra.LowerBoundary,Ra.UpperBoundary);case 2:return qa=H.a.instance.ob(110),String.format(qa,Ra.LowerBoundary);case 3:return qa=H.a.instance.ob(111),
String.format(qa,Ra.LowerBoundary);case 4:return qa=H.a.instance.ob(112),String.format(qa,Ra.LowerBoundary);case 5:return qa=H.a.instance.ob(113),String.format(qa,Ra.UpperBoundary);case 6:return qa=H.a.instance.ob(114),String.format(qa,Ra.LowerBoundary);case 7:return qa=H.a.instance.ob(115),String.format(qa,Ra.UpperBoundary);default:return"we couldn't get the details"}case 2:switch(Ra.ConditionType){case 0:return qa=H.a.instance.ob(116),String.format(qa,Ra.LowerBoundary,Ra.UpperBoundary);case 1:return qa=
H.a.instance.ob(117),String.format(qa,Ra.LowerBoundary,Ra.UpperBoundary);case 2:return qa=H.a.instance.ob(118),String.format(qa,Ra.LowerBoundary);case 3:return qa=H.a.instance.ob(119),String.format(qa,Ra.LowerBoundary);case 4:return qa=H.a.instance.ob(120),String.format(qa,Ra.LowerBoundary);case 5:return qa=H.a.instance.ob(121),String.format(qa,Ra.UpperBoundary);case 6:return qa=H.a.instance.ob(122),String.format(qa,Ra.LowerBoundary);case 7:return qa=H.a.instance.ob(123),String.format(qa,Ra.UpperBoundary);
default:return"we couldn't get the details"}case 4:switch(Ra.ConditionType){case 0:return qa=H.a.instance.ob(124),String.format(qa,Ra.LowerBoundary,Ra.UpperBoundary);case 1:return qa=H.a.instance.ob(125),String.format(qa,Ra.LowerBoundary,Ra.UpperBoundary);case 2:return qa=H.a.instance.ob(126),String.format(qa,Ra.LowerBoundary);case 3:return qa=H.a.instance.ob(127),String.format(qa,Ra.LowerBoundary);case 4:return qa=H.a.instance.ob(128),String.format(qa,Ra.LowerBoundary);case 5:return qa=H.a.instance.ob(129),
String.format(qa,Ra.UpperBoundary);case 6:return qa=H.a.instance.ob(130),String.format(qa,Ra.LowerBoundary);case 7:return qa=H.a.instance.ob(131),String.format(qa,Ra.UpperBoundary);default:return"we couldn't get the details"}case 5:switch(Ra.ConditionType){case 0:return qa=H.a.instance.ob(132),String.format(qa,Ra.LowerBoundary,Ra.UpperBoundary);case 1:return qa=H.a.instance.ob(133),String.format(qa,Ra.LowerBoundary,Ra.UpperBoundary);case 2:return qa=H.a.instance.ob(134),String.format(qa,Ra.LowerBoundary);
case 3:return qa=H.a.instance.ob(135),String.format(qa,Ra.LowerBoundary);case 4:return qa=H.a.instance.ob(136),String.format(qa,Ra.LowerBoundary);case 5:return qa=H.a.instance.ob(137),String.format(qa,Ra.UpperBoundary);case 6:return qa=H.a.instance.ob(138),String.format(qa,Ra.LowerBoundary);case 7:return qa=H.a.instance.ob(139),String.format(qa,Ra.UpperBoundary);default:return"we couldn't get the details"}case 6:switch(Ra.ConditionType){case 0:return qa=H.a.instance.ob(140),String.format(qa,Ra.LowerBoundary,
Ra.UpperBoundary);case 1:return qa=H.a.instance.ob(141),String.format(qa,Ra.LowerBoundary,Ra.UpperBoundary);case 2:return qa=H.a.instance.ob(142),String.format(qa,Ra.LowerBoundary);case 3:return qa=H.a.instance.ob(143),String.format(qa,Ra.LowerBoundary);case 4:return qa=H.a.instance.ob(144),String.format(qa,Ra.LowerBoundary);case 5:return qa=H.a.instance.ob(145),String.format(qa,Ra.UpperBoundary);case 6:return qa=H.a.instance.ob(146),String.format(qa,Ra.LowerBoundary);case 7:return qa=H.a.instance.ob(147),
String.format(qa,Ra.UpperBoundary);default:return"we couldn't get the details"}case 3:return qa=H.a.instance.ob(106),String.format(qa,Ra.LowerBoundary);case 7:return qa=H.a.instance.ob(107),String.format(qa,Ra.LowerBoundary);default:return"we couldn't get the details"}}wWd(Ra){const qa=I.h(this.$);B.TaskExtensions.za(qa.startEdit(!1,Ra),()=>{const La=qa.Vb.textBox;La.text&&La.selectRange(0,La.text.length)},this.la,11,S.a.current)}get la(){this.Lm=this.Lm||new L.a;return this.Lm.token}static pQ(Ra,
qa,La){qa=qa.da.Aa(14).n4a(La);Ra.MessageId=-1083021405;Ra.MessageIdName="DataValidationError";Ra.MessageIdHash=d.a.Yu(Ra.MessageIdName);Ra.Severity=qa?qa.W$c:1;Ra.HelpDescription=H.a.instance.ga(1318);Ra.HelpTopicId=x.a.kKe;return Ra}}Object(r.a)(ra,"DataValidationErrorDialog",C.a,[94,95,2,96]);C=a(930);var O=a(388);class da extends C.a{constructor(Ra,qa,La){super(Ra,qa);this.dataValidationControl=La}get DAb(){return Object(h.a)(ra,this.$.qb.$g)}get eK(){return this.dataValidationControl.re}set eK(Ra){this.dataValidationControl.re=
Ra}get a6a(){return!1}get key(){return O.a.F7c}dispose(){this.dataValidationControl=null;super.dispose()}Oh(Ra,qa){this.dataValidationControl.eb=this.eb;const La=Ra.keyCode;return 1461300262!==qa||16!==La&&17!==La&&18!==La?super.Oh(Ra,qa):!1}iCd(){this.eK&&(this.dataValidationControl.eb=this.eb,this.dataValidationControl.show(this.dataValidationControl.ZM,!0,!0,e.a.fp||3===u.a.zb))}$f(){}Ri(){this.dataValidationControl.show(this.dataValidationControl.ZM,!0,!0,e.a.fp||3===u.a.zb)}CId(Ra,qa){return this.dataValidationControl.Oh(qa)}}
Object(r.a)(da,"DataValidationListAutoCompleteBehavior",C.a,[]);var xa=a(268);C=a(856);var ia=a(12),Ma=a(116),Ta=a(22),Da=a(929);class fa extends C.a{constructor(Ra,qa,La,Yb){super(Ra,qa,new Da.a(k.listItem,k.zDb,k.CDb,k.DDb));this.yIa=this.vV=this.Mda=this.ee=this.umb=null;this.QNa=0;this.rHb=[];this.R_j=ba.EwaSettings.isChangeGateEnabled("OfficeVSO:6172276_UpdateDvListHeightUsingItemHeight");this.htmlSanitizationHelper=null;this.BDb=La;this.htmlSanitizationHelper=Yb}get Ej(){return this.umb}set Ej(Ra){this.BBa(this.umb);
if(Ra){this.umb=Ra;this.BDb.innerText="";this.BBa(this.umb);const qa=this.rHb[Ra.rowIndex];this.ee=this.vV[qa];this.yIa&&(this.Mda=this.yIa[qa],v.ULS.shipAssertTag(537163286,0,!this.rHb.length||!!this.Mda,"DataValidationListBox.SelectedRow: Did not find corresponding DataValidationListItem"));this.BDb.innerText=this.ee;this.$wc(Ra)}else this.Mda=this.ee=null}get fb(){return I.h(this.$).fb}get editText(){return I.h(this.$).Vb.text}dispose(){super.dispose();this.BDb=this.umb=null}zea(Ra,qa,La,Yb){if(Ra&&
(!Ra||Ra.length)){this.w7(!1);this.yIa=Ra;this.vV=[];for(var mc=0;mc<Ra.length;mc++)this.vV[mc]=Ra[mc]?Ra[mc].Name:null;mc=`<table class='${this.v5}' aria-live='polite'><tbody>`;var Zb="",qb="";Ra=0;var Ha=I.h(this.$).Pb(null);Yb=this.fb?Yb?Yb.text:this.editText:Ha?Ha.originalText:null;Ha=!Yb;var Ya=0;this.rHb.length=0;var Gb=[],Ja=[],Na=[],Qa=Yb?Yb.split(" "):[""];Yb=Yb.trim();for(let bb=0;bb<this.vV.length;bb++){const Ga=this.vV[bb];var Oa=void 0;const tb=Ga.split(" ");Oa=xa.a.all(Qa,db=>xa.a.any(tb,
Pa=>Ta.a.MF(Pa,db)));const wb=!Ga,lb=Na.includes(Ga);wb||lb||this.fb&&!Oa||(Oa=Ga?d.a.yg(d.a.d$c(Ga)):"",Oa=String.format("<tr>\r\n\t<td class='{0}'>{1}</td>\r\n</tr>",this.uV,Oa),Na.push(Ga),this.fb&&Ta.a.MF(Ga,Yb)?(Zb+=Oa,Gb.push(bb)):(qb+=Oa,Ja.push(bb)),!Ha&&Ta.a.equals(Yb,Ga,!0)&&(Ra=this.fb?Gb.length-1:Ya,Ha=!0),Ya++)}this.QNa=Ya;this.rHb.push(...Gb);this.rHb.push(...Ja);mc+=Zb+qb+"</tbody></table>";ba.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&ba.EwaSettings.isChangeGateEnabled("OfficeVSO:7126089_ReduceInnerHTMLUsageForDataValidationListBox")&&
this.htmlSanitizationHelper?this.htmlSanitizationHelper.Rh(this.Df,mc):this.Df.innerHTML=mc;mc=this.wn=ia.DOMElementExtensions.$j(this.domElement,this.v5);this.dob(mc,qa);this.w7(!0);this.asa(qa,La);this.Ej=0<this.QNa?mc.rows[Ra]:null}}QRa(Ra){var qa=!1;this.fb&&Ra&&(qa=!this.QNa,Ra.endEdit(qa,"DataValidationListBox.SetCellContent",0));if(!qa&&(Ra=I.h(this.$),qa=Ra.Pb(null))){let Yb=null;if(this.Mda&&-1!==this.Mda.SheetId&&-1!==this.Mda.Row&&-1!==this.Mda.Column){var La={};La.SheetName=this.Mda.SheetId.toString();
La.FirstRow=this.Mda.Row;La.FirstColumn=this.Mda.Column;Yb={ParameterType:6};Yb.SourceRange=La}La=Object(y.a)(new U.a,{Text:this.ee});Ra.setCell(La,qa.range,0,63,Yb)}return!0}asa(Ra,qa){const La=Ra?this.vEb:this.KH;Ra=Ra?this.Glc:this.Hlc;0>=this.QNa?this.Df.style.height=Y.HelperMethods.sc(Ra):(this.Df.style.height="auto",this.QNa>La?(ia.DOMElementExtensions.yI(this.Df,this.R_j?Math.floor(Ra*La):Math.floor(this.Df.offsetHeight*La/this.QNa)),this.Df.style.overflowY="auto"):(this.Df.style.height="auto",
this.Df.style.overflowY="hidden"));ia.DOMElementExtensions.Jv(this.Df,qa);ia.DOMElementExtensions.Jv(this.wn,qa-(this.QNa>La?Ma.a.Bu:0))}}Object(r.a)(fa,"DataValidationListBox",C.a,[]);var ua=a(117),Fa=a(254),ca=a(257),ka=a(1114);const Ca=`<p class='${k.eqh}'>\r\n\t<span class='dv-prompt-titletext'>{0}</span>\r\n</p>`,fb=`<p class='${k.dqh}'>\r\n\t<span class='dv-prompt-messagetext'>{0}</span>\r\n</p>`;var yb=z.a.cSe,mb=z.a.cSe,nb=z.a.N5g;class X extends l.a{constructor(Ra,qa){super(document.createElement("div"));
this.A2b=this.wQ=this.YQ=!1;this.Qh=this.Eh=null;this.Vni=ba.EwaSettings.isChangeGateEnabled("OfficeVSO:6172290_DataValidationConditionalHideAll");this.Wni=ba.EwaSettings.isChangeGateEnabled("OfficeVSO:6172279_DataValidationConstButtonWidth");this.upd=this.lsd=this.srd=!1;this.c7b=[];this.htmlSanitizationHelper=null;this.Gh=()=>{this.J9f(!1)};this.YOa=(La,Yb)=>{this.show(this.ZM,!this.re,!0,e.a.fp||3===Yb.vb||3===u.a.zb);this.MCd(null,null)};this.MCd=()=>{this.gridView.setFocus()};this.MLa=()=>{this.eb.textBox.ZE=
!0};this.zt=()=>{this.ikg()};this.onContentReady=()=>{this.J9f(this.re)};this.uc=()=>{this.Yx()};this.Qya=()=>{this.QRa()};this.oCf=()=>{this.ikg()};this.$=Ra;this.gridView=I.h(this.$);this.CI=this.gridView.Vb;this.htmlSanitizationHelper=qa;qa="<div id='dv_reader_description' class='"+t.a.tSe+"' role='alert' aria-live='polite'></div>\r\n<div id='dv_list_button' class='"+k.Evh+" "+z.a.io+"'></div>\r\n<div id='dv_list_box' class='"+k.Vuh+" "+z.a.jo+" "+z.a.io+"'></div>\r\n<div id='dv_prompt_box' class='"+
k.Cvh+" "+z.a.io+"'></div>";this.domElement.className=k.Dvh;ba.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&ba.EwaSettings.isChangeGateEnabled("OfficeVSO:7126086_ReduceInnerHTMLUsageForDataValidationControl")&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.Rh(this.domElement,qa):this.domElement.innerHTML=qa;Fa.d(this.style,this.isGridRtl);this.Df=$get("dv_list_box",this.domElement);this.bW=$get("dv_prompt_box",this.domElement);this.Bsa=$get("dv_list_button",
this.domElement);this.BDb=$get("dv_reader_description",this.domElement);(qa=ua.a(Ra))&&this.c7b.push(new da(Ra,qa,this));this.c7b.push(new da(Ra,this.gridView.Vb,this));this.gridView.ha.yG(this.Gh);this.gridView.Uu(this.onContentReady);this.gridView.mc.BMg(this.oCf);this.$.nj(this.uc);qa=this.gridView.pj;qa.insertBefore(this.domElement,qa.firstChild);this.onContentReady(null,null);Ra.da.Ha(14,this)}get nCb(){return!!(this.$.qd&16)}get Xvi(){return this.re||this.ZM||this.Awa}get re(){return ia.DOMElementExtensions.isVisible(this.Df)}set re(Ra){ia.DOMElementExtensions.setVisible(this.Df,
Ra)}get ZM(){return ia.DOMElementExtensions.isVisible(this.bW)}set ZM(Ra){ia.DOMElementExtensions.setVisible(this.bW,Ra)}get Awa(){return ia.DOMElementExtensions.isVisible(this.Bsa)&&!!this.Eh&&ia.DOMElementExtensions.isVisible(this.Eh.domElement)}set Awa(Ra){ia.DOMElementExtensions.setVisible(this.Bsa,Ra);this.Eh&&ia.DOMElementExtensions.setVisible(this.Eh.domElement,Ra)}get eb(){return this.CI}set eb(Ra){this.CI=Ra}get t5a(){return!!this.activeCell&&this.f9c(this.activeCell.range)}get activeCell(){return this.gridView.Pb(null)}get ibf(){return this.t5a&&
!!this.aw&&!!(this.aw.options&2)&&!!this.aw.prompt}get Gyb(){return this.t5a&&!!this.aw&&!!(this.aw.options&1)}get isGridRtl(){return this.gridView.rtl}get aw(){return this.n4a(this.activeCell.range)}get HOa(){const Ra=this.activeCell;return Ra?this.wva(this.gridView,Ra):null}dispose(){this.$&&(this.nOb(!1),this.gridView.ha.JK(this.Gh),this.gridView.my(this.onContentReady),this.gridView.mc.Ojj(this.oCf),this.$.ol(this.uc));this.zIe(!1);this.AIe(!1);f.a.pc(this.c7b);this.c7b=this.Bsa=this.Df=this.bW=
this.CI=this.gridView=this.$=null;super.dispose()}f9c(Ra){return!!this.n4a(Ra)}Asb(Ra,qa){return ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5879568_ReactDataValidationErrorDialog")?new ra(this.$,Ra,qa):new G(this.$,Ra,qa)}n4a(Ra){Ra=this.gridView.getRangeInformation(Ra);for(let qa=0;qa<Ra.length;qa++){const La=Ra[qa];if(Object(h.a)(m.DataValidationRange,La))return La}return null}bPh(){if(!this.t5a)return"";const Ra=this.ibf?`${this.aw.SPf} ${this.aw.prompt}`:"",qa=this.Gyb?H.a.instance.ga(842):
"";return String.format(H.a.instance.ob(17),Ra,qa)}Oh(Ra){let qa=!1;if(this.re||(-569786022===Ra||541421805===Ra)&&this.Gyb||1872288872===Ra&&this.ZM)switch(Ra){case -569786022:case 541421805:this.show(this.ZM,!this.re,!0,e.a.fp||3===u.a.zb);qa=!0;break;case 1872288872:this.re?(this.show(this.ZM,!1,!0,!1),qa=!0):this.ZM?(this.show(!1,!1,!0,!1),qa=!0):this.eb&&(this.eb.endEdit(!1,"DataValidationControl.HandleKeyDown",0),qa=!0);break;case -798660877:this.Qh.fB(1);qa=!0;break;case 137938150:this.Qh.fB(-1);
qa=!0;break;case 2091832999:this.Qh.fB(this.Qh.KH-1);qa=!0;break;case 742457698:this.Qh.fB(-(this.Qh.KH-1));qa=!0;break;case 125627505:case 267796030:qa=this.QRa()}return qa}show(Ra,qa,La,Yb){this.Yx();if(this.nCb&&this.t5a){var mc=this.HOa;if(mc){if(Ra||qa||La)this.isVisible=!0;Fa.d(this.style,this.isGridRtl);La&&this.Gyb&&(this.AIe(!0),this.$jg(mc,!1));qa&&this.Gyb&&this.CSa(Yb,mc);Ra&&this.ibf&&this.jKj(mc);this.Xvi||(this.isVisible=!1)}}}wva(Ra,qa){if(!qa||!qa.cell.uk)return null;var La=this.gridView.mc.textBox.domElement;
var Yb=0<ia.DOMElementExtensions.getHeight(La)&&0<ia.DOMElementExtensions.getWidth(La)&&0<=La.offsetTop&&0<=La.offsetLeft;if(Yb)La=ia.DOMElementExtensions.wva(La,Ra.pj);else{La=Ra.getCellBounds(qa.cell);var mc=ia.DOMElementExtensions.getBoundingClientRect(Ra.pj);La=new Sys.UI.Bounds(La.x-mc.x,La.y-mc.y,La.width,La.height)}if(La)if(Yb)2<La.height&&2<La.height&&(La.x+=1,La.y+=1,La.height-=2,La.width-=2);else if(Yb=I.h(this.$).LJ(qa.cell))Yb=Yb.width+1,mc=Ta.a.equals(ca.a.Mwb(qa.cell,Ra.rtl),"right",
!0),Ra.rtl&&mc&&(La.x=La.x+La.width-Yb),qa.Iba&&Ra.rtl===mc&&(La.width=Yb);else return null;return La}J9f(Ra){const qa=this.t5a;this.nOb(qa);qa?this.show(!0,Ra,!0,!1):this.Yx()}QRa(){let Ra=!1;this.re&&(Ra=this.Qh.QRa(this.eb),this.show(this.ZM,!1,!0,!1));return Ra}Yx(){this.Vni?(this.re&&(this.re=!1),this.Awa&&(this.Awa=!1),this.ZM&&(this.ZM=!1),this.isVisible&&(this.isVisible=!1)):this.re=this.Awa=this.ZM=this.isVisible=!1;this.srd=this.upd=this.lsd=!1}CSa(Ra,qa){this.Gyb&&!this.aw.yIa?this.Awa&&
this.Eh.disable():(this.zIe(!0),this.Qh.zea(this.aw.yIa,Ra,this.qYh(qa),this.eb),this.TBa(qa,!1))}jKj(Ra){this.aw.prompt&&(this.ZM=!0,this.L1j(this.aw.SPf,this.aw.prompt),this.ukg(Ra,!1))}$jg(Ra,qa){const La=Ra.y;this.Bsa.style.top=Y.HelperMethods.sc(La);Ra=this.isGridRtl?Ra.x-this.Bsa.offsetWidth+1:Ra.x+Ra.width+1;this.Bsa.style.left=Y.HelperMethods.sc(Ra);qa?this.Awa=this.gridView.pkc(new w.a(Ra,La))&&this.upd:this.upd=!0}TBa(Ra,qa){const La=Ra.y+Ra.height;Ra=this.isGridRtl?Ra.x+Ra.width-this.Df.offsetWidth:
Ra.x;this.Df.style.top=Y.HelperMethods.sc(La);this.Df.style.left=Y.HelperMethods.sc(Ra);qa?this.re=this.gridView.pkc(new w.a(Ra,La))&&this.srd:this.srd=!0}ukg(Ra,qa){const La=Ra.y+Ra.height+5;var Yb=this.activeCell;Yb=Yb?Yb.width/2:32;Ra=this.isGridRtl?Ra.x-this.bW.offsetWidth+Yb:Ra.x+Ra.width-Yb;this.bW.style.top=Y.HelperMethods.sc(La);this.bW.style.left=Y.HelperMethods.sc(Ra);qa?this.ZM=this.gridView.pkc(new w.a(Ra,La))&&this.lsd:this.lsd=!0}L1j(Ra,qa){if(qa){var La="";Ra&&(La+=String.format(Ca,
d.a.yg(Ra)));La+=String.format(fb,d.a.yg(qa));ba.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&ba.EwaSettings.isChangeGateEnabled("OfficeVSO:7126087_ReduceInnerHTMLUsageForDataValidationControl2")&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.Rh(this.bW,La):this.bW.innerHTML=La;Ra=ia.DOMElementExtensions.$j(this.bW,"dv-prompt-titletext");if(qa=ia.DOMElementExtensions.$j(this.bW,"dv-prompt-messagetext")){Ra=Ra?parseInt(String(Math.max(Ra.offsetWidth,qa.offsetWidth)),
10):qa.offsetWidth;Ra+=6;ia.DOMElementExtensions.Jv(this.bW,Ra);for(let Yb=0,mc=this.bW.children.length;Yb<mc;Yb++)ia.DOMElementExtensions.Jv(this.bW.children[Yb],Ra)}}}qYh(Ra){return this.Wni?Ra.width+17-2+1:Ra.width+this.Bsa.clientWidth-2+1}AIe(Ra){this.$&&!this.nCb||!Ra?(this.Ncg(!1),f.a.Ja(this.Eh),this.Eh=null):(this.Eh||(this.Eh=new ka.a(this.Bsa,yb,n.a.cia,1,mb,H.a.instance.ga(894),nb,H.a.instance.ga(893),"",-1),this.Ncg(!0)),this.Awa=!0,this.aw.yIa?this.Eh.isEnabled||this.Eh.enable():this.Eh.disable())}zIe(Ra){this.$&&
!this.nCb||!Ra?(this.jTa(!1),f.a.Ja(this.Qh),this.Qh=null):(this.Qh||(this.Qh=new fa(this.$,this.Df,this.BDb,this.htmlSanitizationHelper),this.jTa(!0)),this.re=!0)}jTa(Ra){this.Qh&&(Ra&&!this.YQ?(this.Qh.w9(this.MCd),this.Qh.N_b(this.MLa),this.Qh.zob(this.Qya),this.YQ=!0):!Ra&&this.YQ&&(this.Qh.uda(this.MCd),this.Qh.Ouc(this.MLa),this.Qh.dKb(this.Qya),this.YQ=!1))}nOb(Ra){Ra&&!this.wQ?(this.gridView.view.Ps(this.zt),this.wQ=!0):!Ra&&this.wQ&&(this.gridView.view.Mq(this.zt),this.wQ=!1)}Ncg(Ra){this.Eh&&
(Ra&&!this.A2b?(this.Eh.mXc(this.YOa),this.Eh.xXc(this.YOa),this.Eh.kob(this.MLa),this.A2b=!0):!Ra&&this.A2b&&(this.Eh.QLd(this.YOa),this.Eh.bMd(this.YOa),this.Eh.QJb(this.MLa),this.A2b=!1))}ikg(){if(this.t5a){var Ra=this.HOa;Ra&&(this.$jg(Ra,!0),this.TBa(Ra,!0),this.ukg(Ra,!0))}}}Object(r.a)(X,"DataValidationControl",l.a,[555,2]);var R=a(50),wa=a(55);class na extends b.a{constructor(Ra){super();this.$=Ra;this.Db()}create(){const Ra=ba.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&
ba.EwaSettings.isChangeGateEnabled("OfficeVSO:7126087_ReduceInnerHTMLUsageForDataValidationControl")?R.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Xa):wa.Task.Sa(null);B.TaskExtensions.za(Ra,()=>{this.nb(this.$.da.Aa(14)||new X(this.$,Ra.result))},this.la,3)}}Object(r.a)(na,"DataValidationControlFactory",b.a,[]);a.d(F,"a",function(){return Ba});const Ba=()=>{c.a.Fa(Ra=>{Ra.da.Ha(150,new na(Ra))})}},1239:function(r,F,a){var c=a(9);r=a(0);var b=a(226),e=a(15),f=a(192);const d={selectByArrowKeyCounter:0,
selectByMouseHoverCounter:0,commitByTabKeyCounter:0,commitByEnterKeyCounter:0,commitByMouseClickCounter:0,commitWhileRequestPending:0,dismissSmartSuggestionExplicitlyCounter:0,dismissSmartSuggestionImplicitlyCounter:0},h={formulaAssistanceRequestAttemptedCounter:0,formulaAssistanceRequestOptimizedCounter:0},l={argumentAssistanceCardInitialMode:void 0,argumentAssistanceCollapseCounter:0,argumentAssistanceExpandCounter:0,argumentAssistanceLearnMoreCounter:0,argumentAssistanceDragCounter:0,argumentAssistanceDragTotalCounter:0,
argumentAssistanceMoveCounter:0,argumentAssistanceMoveTotalCounter:0,argumentAssistanceCardIsInitialModeDefault:!1},k={smartSuggestionShownCounter:0,smartSuggestionSelectedCounter:0,smartSuggestionCommittedCounter:0,smartSuggestionKeptCounter:0,isCellContentOnlyEqualDuringEditCounter:0,isCellContentFormulaCounter:0,smartSuggestionWouldSuggestInsidePivotCounter:0},t={parenthesesCouplingCounter:0,formulaHighlightsCounter:0},n={dialogCommitedCounter:0,dialogShownCounter:0,argsDialogOpenedByRibbonCounter:0,
argsDialogOpenedByDialogCounter:0,argsDialogCommitedCounter:0},z={argumentAssistanceFlight:void 0,autoCompleteUIFlight:void 0,smartFormulaBarAutoCompleteFlight:void 0,smartFormulaBarAutoCompletePluginFlight:void 0,anyPluginInitialized:void 0,formulaAssistanceRedesignFlight:void 0,NewInsertFunctionDialogFlight:void 0,smartFormulaSuggestionsFeatureEnabled:void 0,parenthesesCouplingFlight:void 0,coloredReferencesFlight:void 0,uILocale:void 0,dataLocale:void 0,country:void 0};var w;(function(M){M.RenderDown=
"rd";M.RenderUp="ru";M.Expand="e";M.Collapse="c";M.Drag="d";M.Move="m";M.GiveFeedback="gf";M.InitialModeExpanded="ie";M.InitialModeCollapsed="ic";M.LearnMore="lm"})(w||(w={}));Object(r.b)("argumentAssistanceUsageActions",w);var m=a(59),u=a(1115),y=a(1),v=a(22),C=a(39),x=a(21),B=a(100),H;(function(M){M[M.function=3]="function";M[M.namedRange=100]="namedRange";M[M.tableHeader=101]="tableHeader";M[M.letVariable=102]="letVariable";M[M.richEntity=103]="richEntity";M[M.lambda=104]="lambda";M[M.customFunction=
105]="customFunction";M[M.table=106]="table";M[M.tableSpecialStructRef=107]="tableSpecialStructRef";M[M.richEntityEmptyCellRef=108]="richEntityEmptyCellRef";M[M.rangeRef=109]="rangeRef"})(H||(H={}));Object(r.b)("CompletionItemKind",H);var I=a(33),U=a(857),S=a(966);const G={["argumentAssistanceOverall"]:[50,80,100,130,150,170,200],["autoCompleteOverall"]:[50,80,100,130,150,170,200],["autoCompleteOverallSimpleAndSmart"]:[50,80,100,130,150,170,200],["autoCompleteOverallSmartOnly"]:[50,80,100,130,150,
170,200],["autoCompleteOverallSimpleOnly"]:[50,80,100,130,150,170,200],["tryUpdateHighlightsFromCellContentEditor"]:[50,80,100,130,150,170,200]};class D{constructor(M){this.$=M;this.FH=null;this.jDb=-1;this.mlc=null;this.olc=0;this.mP=Object.assign({},l);this.$G=Object.assign({},k);this.dJ=Object.assign({},d);this.Spb=Object.assign({},h);this.Xac=Object.assign({},t);this.QR=Object.assign({},z);this.Tpb={};this.K3a=Object.assign(Object.assign({},n),{isReactDialog:I.a.zkf()});this.opb=[];this.BGa=y.EwaSettings.isChangeGateEnabled("OfficeVSO:7376612_argumentAssistanceOrderedActionsTelemetry");
this.iIa={};this.$f=(L,aa)=>{null!=this.FH&&(1==Math.abs(this.jDb-this.$.ea.se)&&(L=this.$.va.na.sheetId,aa.Rrb&&aa.Yj.equals(this.FH.Yj)&&this.mlc===L&&this.FH.s3b!==aa.s3b&&this.olc++),1<=Math.abs(this.jDb-this.$.ea.se)&&(this.FH=null,this.jDb=-1,this.mlc=null));y.EwaSettings.isChangeGateEnabled("OfficeVSO:7477085_logAutocompleteDataOnEditEnd")&&0<Object.keys(this.iIa).length&&(e.ULS.sendTraceTag(509658956,0,50,`FormulaAssistanceTelemetryManager.onEditEnded: current edit's completion items data: ${JSON.stringify(this.iIa)}`),
this.iIa={})};this.uc=(L,aa)=>{aa.Bf||aa.lqd||(this.OBj(),this.YBj(),this.$.sendBeaconTraceTag(88392384,50,!1,"{0}",this.getJsonForLogging()))};this.Gab=new B.a;M.nj(this.uc);x.h(this.$).ni.Km(this.$f)}dispose(){this.$&&x.h(this.$).ni.$l(this.$f)}ED(M){M.forEach(L=>{this.Gab.hb(L)||this.Gab.ia(L,new u.a(G[L]));this.Gab.ma(L).aTa()})}gw(M,L=!0){M.forEach(aa=>{this.Gab.hb(aa)&&this.Gab.ma(aa).B3(L)})}M3f(M){this.YI(0===M?"ie":"ic")}nxj(M){this.YI(M?"ie":"ic")}L3f(){this.mP.argumentAssistanceCardIsInitialModeDefault=
!0}iua(M){window.requestAnimationFrame(()=>{this.gw([M])})}ZXf(M){M.forEach(L=>{L=H[L.kind];this.Amg(L);this.Tpb[L].shownCounter++;y.EwaSettings.isChangeGateEnabled("OfficeVSO:7477085_logAutocompleteDataOnEditEnd")&&this.iIa[L].shownCounter++})}YXf(M){M=H[M];this.Amg(M);this.Tpb[M].committedCounter++;y.EwaSettings.isChangeGateEnabled("OfficeVSO:7477085_logAutocompleteDataOnEditEnd")&&this.iIa[M].committedCounter++}YI(M){if(this.BGa){const L=this.opb.length;0===L||this.opb[L-1][0]!==M?this.opb.push([M,
1]):this.opb[L-1][1]++}else switch(M){case "e":this.mP.argumentAssistanceExpandCounter++;break;case "c":this.mP.argumentAssistanceCollapseCounter++;break;case "d":this.mP.argumentAssistanceDragCounter++;break;case "m":this.mP.argumentAssistanceMoveCounter++;break;case "lm":this.mP.argumentAssistanceLearnMoreCounter++;break;case "ie":this.mP.argumentAssistanceCardInitialMode="Expanded";break;case "ic":this.mP.argumentAssistanceCardInitialMode="Collapsed"}}getJsonForLogging(){return"{"+this.nM("SessionDetails",
this.QR)+","+this.nM("ArgumentAssistanceUsage",this.mP)+","+this.nM("argumentAssistanceOrderedActions",this.opb)+","+this.nM("FormulaSuggestionsUsage",this.$G)+","+this.nM("FunctionDialogUsage",this.K3a)+","+this.nM("AutocompleteCardInteraction",this.dJ)+","+this.nM("AutocompleteRenderOptimization",this.Spb)+","+this.nM("AutocompleteUsageByKind",this.Tpb)+","+this.nM("FormulaHighlightsUsage",this.Xac)+","+this.f3h()+"}"}YBj(){this.$G.smartSuggestionKeptCounter=this.$G.smartSuggestionCommittedCounter-
this.olc;for(let M=0;M<this.$G.smartSuggestionKeptCounter;M++)Object(U.a)(S.b)}OBj(){this.QR.argumentAssistanceFlight=this.lva("Microsoft.Office.ExcelOnline.","ArgumentAssistancePlugin");this.QR.autoCompleteUIFlight=this.lva("Microsoft.Office.Excel.","AutoCompleteNewUI");this.QR.smartFormulaBarAutoCompleteFlight=this.lva("Microsoft.Office.Excel.","SmartFormulaBarAutocompleteFeatureIsEnabled");this.QR.smartFormulaBarAutoCompletePluginFlight=this.lva("Microsoft.Office.Excel.","SmartFormulaBarAutocompleteIsEnabled");
this.QR.formulaAssistanceRedesignFlight=this.lva("Microsoft.Office.Excel.","FormulaAssistanceRedesign");this.QR.NewInsertFunctionDialogFlight=this.lva("Microsoft.Office.Excel.","NewInsertFunctionDialog");this.QR.coloredReferencesFlight=this.lva("Microsoft.Office.Excel.","ColoredReferences");this.QR.parenthesesCouplingFlight=this.lva("Microsoft.Office.Excel.","ParenthesesCoupling");this.QR.smartFormulaSuggestionsFeatureEnabled=I.a.BMa(this.$);this.QR.uILocale=this.$.XTa;this.QR.dataLocale=this.$.dataCultureTag;
this.QR.country=JSON.parse(this.$.ya.SessionStartInfoJson).LocationCountry}f3h(){const M=new f.a;for(let L of this.Gab)L.value.JXe(),M.add(`"${L.key}":${m.a.Dc(L.value.SV)}`);return`"PerfMeasurements": {${M.toArray().join(",")}}`}lva(M,L){return v.a.contains(this.$.ya.FlightHolder.FlightId,L,!0)?y.EwaSettings.getBooleanFeatureGate(M+L,!1)?"T":"C":"None"}nM(M,L){return`"${M.toString()}":${C.c(L)}`}Amg(M){this.Tpb[M]||(this.Tpb[M]={shownCounter:0,committedCounter:0});y.EwaSettings.isChangeGateEnabled("OfficeVSO:7477085_logAutocompleteDataOnEditEnd")&&
!this.iIa[M]&&(this.iIa[M]={shownCounter:0,committedCounter:0})}}Object(r.a)(D,"FormulaAssistanceTelemetryManager",null,[544]);class E extends b.a{constructor(M){super();this.$=M;this.Db()}static ka(M){M.da.Ha(492,new E(M))}create(){var M;this.nb(null!==(M=this.$.da.Aa(491))&&void 0!==M?M:this.$.da.Ha(491,new D(this.$)))}}Object(r.a)(E,"FormulaAssistanceTelemetryManagerFactory",b.a,[]);a.d(F,"a",function(){return N});const N=()=>{c.a.Fa(M=>{E.ka(M)})}},1243:function(r,F,a){a.r(F);r=a(0);var c=a(15),
b=a(280),e=a(95),f=a(40),d=a(268),h=a(548),l=a(4),k=a(84),t=a(421),n=a(734),z=a(8),w=a(31),m=a(19),u=a(63),y=a(5),v=a(801),C=a(1068),x=a(855),B=a(13),H=a(33);class I{constructor(Ha,Ya,Gb,Ja,Na,Qa,Oa,bb){this.$=Ya;this.Va=Gb;this.ql=Ja;this.selectedRanges=Na;this.grid=Qa;this.uy=bb;this.z4=Oa;this.Sga=d.a.all(Na,Ga=>Ga.isRow);this.dsa=d.a.all(Na,Ga=>Ga.Rg);this.oFb=d.a.all(Na,Ga=>!Ga.isRow&&!Ga.Rg);Ya=Qa.tb.mjd(Na);this.Gsb=!!Ya;this.SXf=!!Ya&&Ya.hasActiveFilter;this.menuSection=Gb.Ec();Ha.rc.push(this.menuSection);
this.qba=this.Sga||this.dsa?this.menuSection:Gb.Ec();this.Ita=this.Sga||this.dsa?this.menuSection:Gb.Ec()}yed(){this.pMh();this.SLh();const Ha=this.uy.Njc(this.selectedRanges,this.grid);this.menuSection.buttons.push(this.Va.pb(Ha?149:148))}vMh(){let Ha=0;this.Gsb?this.z4.um(942362098)?Ha=this.uy.um(this.ql,942362098,this.selectedRanges,this.grid)?161:169:this.SXf&&(Ha=this.uy.um(this.ql,-1113896058,this.selectedRanges,this.grid)?177:181):this.z4.um(-1113896058)&&(Ha=this.Sga?this.uy.um(this.ql,-1113896058,
this.selectedRanges,this.grid)?49:116:this.uy.um(this.ql,-1113896058,this.selectedRanges,this.grid)?177:181);0!==Ha&&this.qba.buttons.push(this.Va.pb(Ha))}uMh(){let Ha;!this.Gsb&&this.z4.um(-1113896058)&&(Ha=this.Sga?this.uy.um(this.ql,-1113896058,this.selectedRanges,this.grid)?295:296:this.uy.um(this.ql,-1113896058,this.selectedRanges,this.grid)?297:298,this.qba.buttons.push(this.Va.pb(Ha)))}qMh(){let Ha=0;this.Gsb?this.z4.um(622604322)&&(Ha=this.grid.rtl?this.uy.um(this.ql,622604322,this.selectedRanges,
this.grid)?191:192:this.uy.um(this.ql,622604322,this.selectedRanges,this.grid)?162:170):this.z4.um(1415868706)&&(Ha=this.dsa?this.uy.um(this.ql,1415868706,this.selectedRanges,this.grid)?50:117:this.uy.um(this.ql,1415868706,this.selectedRanges,this.grid)?178:182);0!==Ha&&this.qba.buttons.push(this.Va.pb(Ha))}oMh(){this.z4.um(1035996630)&&(this.uy.um(this.ql,1035996630,this.selectedRanges,this.grid)?(this.qba.buttons.push(this.Va.pb(this.grid.rtl?187:165)),this.qba.buttons.push(this.Va.pb(166))):(this.qba.buttons.push(this.Va.pb(this.grid.rtl?
188:173)),this.qba.buttons.push(this.Va.pb(174))))}pMh(){const {GridContextMenu:Ha}=a(1243);let Ya=null;this.oFb&&(Ya=this.Va.$v("ContextMenu.InsertCells",null,B.a.instance.ga(344),1896159024),Ya.menu.rc.push(this.qba));Ha.rMh(this.qba,this.Va,this.$);this.vMh();l.AFrameworkApplication.Tp("XLS-InsertRowsBelowExperiment-Treatment;XLS-InsertRowsBelowExperiment-Control");H.a.ird()&&this.uMh();this.qMh();this.oMh();Ya&&0<this.qba.buttons.length&&this.menuSection.buttons.push(Ya)}ULh(){let Ha=0;this.Gsb?
this.z4.um(1405456548)?Ha=this.uy.um(this.ql,1405456548,this.selectedRanges,this.grid)?163:171:this.SXf&&(Ha=this.uy.um(this.ql,1554436520,this.selectedRanges,this.grid)?179:183):this.z4.um(1554436520)&&(Ha=this.Sga?this.uy.um(this.ql,1554436520,this.selectedRanges,this.grid)?51:118:this.uy.um(this.ql,1554436520,this.selectedRanges,this.grid)?179:183);0!==Ha&&this.Ita.buttons.push(this.Va.pb(Ha))}TLh(){let Ha=0;this.Gsb?this.z4.um(284490184)&&(Ha=this.uy.um(this.ql,284490184,this.selectedRanges,this.grid)?
164:172):this.z4.um(674605324)&&(Ha=this.dsa?this.uy.um(this.ql,674605324,this.selectedRanges,this.grid)?52:119:this.uy.um(this.ql,674605324,this.selectedRanges,this.grid)?180:184);0!==Ha&&this.Ita.buttons.push(this.Va.pb(Ha))}RLh(){this.z4.um(1035996630)&&(this.uy.um(this.ql,1035996630,this.selectedRanges,this.grid)?(this.Ita.buttons.push(this.Va.pb(this.grid.rtl?189:167)),this.Ita.buttons.push(this.Va.pb(168))):(this.Ita.buttons.push(this.Va.pb(this.grid.rtl?190:175)),this.Ita.buttons.push(this.Va.pb(176))))}SLh(){let Ha=
null;this.oFb&&(Ha=this.Va.$v("ContextMenu.DeleteCells",null,B.a.instance.ga(408),-1554384558),Ha.menu.rc.push(this.Ita));this.ULh();this.TLh();this.RLh();Ha&&0<this.Ita.buttons.length&&this.menuSection.buttons.push(Ha)}}Object(r.a)(I,"CellsContextMenuGenerator",null,[]);var U=a(784);class S{constructor(Ha){this.ranges=null;this.ranges=Ha}}Object(r.a)(S,"MacroRecorderRangeHyperlinkRemovedPayload",null,[162]);var G=a(526),D=a(24),E=a(103),N=a(68),M=a(77),L=a(41),aa=a(193),V=a(60),P=a(610),ba=a(140),
Y=a(37),Z=a(461),ea=a(557),ra=a(1),O=a(189),da=a(21),xa=a(377),ia=a(34),Ma=a(50),Ta=a(216),Da=a(22),fa=a(30),ua=a(1093),Fa=a(926),ca=a(127),ka=a(376),Ca=a(284),fb=a(167),yb=a(157),mb=a(347),nb=a(94),X=a(29),R=a(249),wa=a(282),na=a(128),Ba=a(782),Ra=a(783),qa=a(115),La=a(39),Yb=a(55),mc;(function(Ha){Ha[Ha.none=0]="none";Ha[Ha.once=1]="once";Ha[Ha.twice=2]="twice"})(mc||(mc={}));Object(r.b)("ToggleState",mc);class Zb{constructor(Ha,Ya,Gb,Ja){this.aZc=this.Efb=this.Gfb=0;this.$=Ha;this.gridView=da.h(this.$);
this.namedSheetViewPublic=Ya;this.Nh=Gb;this.instantaneousSupportInformationManager=Ja;this.QMa=Ba.a.jpd()}Doh(){var Ha=this.JU();Ha={["CommandValueId"]:La.c(Ha)};const Ya=new nb.a(-2058042992,2,this.$.xc,19,null);c.ULS.sendTraceTag(527500302,0,50,"GridContextMenuFilter::DoClearFilter GridContextMenu ClearFilter command executed");return this.$.Ia.Hb(Ya,Ha)}Uoh(){const Ha=new nb.a(644342024,2,this.$.xc,19,null);c.ULS.sendTraceTag(527500301,0,50,"GridContextMenuFilter::DoReapplyFilter GridContextMenu ReapplyFilter command executed");
return this.$.Ia.Hb(Ha)}Ioh(){const Ha=this.gridView.ha.qa.activeCell,Ya=this.$.da.Aa(66).Dg,Gb=this.$.da.Aa(66).swb(Ha);return Ya||Gb?this.Koh(Ya,Gb,Ha):this.Joh(Ha)}Koh(Ha,Ya,Gb){if(this.w3g(Ha,Ya,Gb))return c.ULS.sendTraceTag(527500300,0,50,"GridContextMenuFilter::DoFilterByValue Header/Total error dialog raised for FilterByValue in Table"),Yb.Task.Sa(!1);if(null!=Ha&&Ha.hasAutoFilter||null!=Ya&&Ya.Csa.every(Ja=>0!=Ja.length))return this.Gfb=mc.none,this.ZYc();this.Gfb=mc.once;return this.w8b(mc.once)}Joh(Ha){var Ya=
L.v(this.gridView.ha.qa.ld,this.$);Ya=this.gridView.$.va.getItemByName(Ya.SheetName);const Gb=L.D(Ya.v0);if(this.v3g(Gb,Ha))return c.ULS.sendTraceTag(527500299,0,50,"GridContextMenuFilter::DoFilterByValue Header/EmptyRange error dialog raised for FilterByValue in Sheet"),Yb.Task.Sa(!1);if(Ya.hasAutoFilter){if(Gb&&Gb.contains(this.gridView.ha.qa.activeCell))return this.Gfb=mc.none,this.ZYc();this.Gfb=mc.twice;return this.w8b(mc.twice)}this.Gfb=mc.once;return this.w8b(mc.once)}w8b(Ha){const Ya=L.v(this.gridView.ha.qa.ld,
this.$);if(!Ya)return Yb.Task.Sa(!1);this.Efb||(this.Efb=Date.now());const Gb=new nb.a(368460465,2,this.$.xc,19,null),Ja=this.$.oa.xa.Wb(),Na=()=>new ua.a(Ya),Qa=Oa=>{R.a(Oa)?c.ULS.sendTraceTag(527500297,0,50,"GridContextMenuFilter::ToggleFilter service call failed with errors : {}"):(c.ULS.sendTraceTag(527500298,0,50,"GridContextMenuFilter::ToggleFilter service call succeeded"),Ha===mc.twice?this.w8b(mc.once):this.ZYc())};return ka.a(this.$.userOperationManager,(Oa,bb,Ga)=>Ca.B(this.$.oa.xa,Ya,wa.b(Oa,
Qa),bb,Ga,null,Ja),Oa=>new aa.a(516,0,Oa,64,Na),Gb)}w3g(Ha,Ya,Gb){return null!=Ha&&fb.d(Ha)&&Gb.top===Ha.usedRange.top||null!=Ya&&Ya.dka&&Gb.top===Ya.top?(this.itc(this.$,222),!0):null!=Ha&&fb.g(Ha)&&Gb.top===Ha.usedRange.bottom?(this.itc(this.$,223),!0):!1}v3g(Ha,Ya){if(Ha&&Ha.contains(Ya)&&Ya.top===Ha.top||!Ha&&this.y2g(Ya.top,Ya.left))return this.itc(this.$,224),!0;Ha=new D.Range(Ya.top,Ya.left,Ya.top+1,Ya.left+1,!1,!1);return this.gridView.tb.cxa(Ha)?(this.itc(this.$,225),!0):!1}itc(Ha,Ya){Ya=
X.a.ed(1,1,750,Ya,0,147079615,"ContextMenuFilterByCellValueError");ra.EwaSettings.mz()?new mb.a(Ha,Ya):(Ha=new yb.ErrorDialog(Ha,Ya),Ha.initialize(),Ha.kg())}ZYc(){this.aZc=Date.now();const Ha=this.E6h();if(!Ha)return c.ULS.sendTraceTag(527500296,0,50,"GridContextMenuFilter::ApplyFilterByValue . CellValue returned is null"),Yb.Task.Sa(!1);const Ya=this.JU(),Gb={FirstRow:0};Gb.FirstColumn=Ya.Column;Gb.SheetName=Ya.SheetName;na.b(this.$).rd(ca.a.Nzf,this.sm(),void 0,!0);const Ja=this.w5c(Ya,Gb),Na=
Oa=>{c.ULS.sendTraceTag(527500295,0,50,`GridContextMenuFilter::ApplyFilterByValue Perf Telemetry : ${JSON.stringify({["ToggleFilterOperationCount"]:this.Gfb,["ApplyFilterTime"]:this.aZc?Date.now()-this.aZc:-1,["ToggleAndApplyFilterTime"]:this.Efb?Date.now()-this.Efb:-1,["FilterByValueType"]:Ya.AutoFilterType})}`);this.Efb&&(this.Efb=0);if(Ba.a.zzc(Oa)){const bb=Ba.a.Bbc(Oa);this.QMa?Ba.a.NQa(Ra.a.filterByCellValue,bb.MessageIdName,qa.a.JGa,!0,Ba.a.isSessionEndingError(bb.MessageId)):c.ULS.sendTraceTag(527500294,
0,10,`GridContextMenuFilter::ApplyFilterByValue failed with FilterException -${bb.MessageIdName}`)}R.a(Oa)?(Oa=X.a.nc(Oa.Errors),c.ULS.sendTraceTag(527500292,0,50,`GridContextMenuFilter::ApplyFilterByValue service call failed with errors : ${Oa}`)):(c.ULS.sendTraceTag(527500293,0,50,"GridContextMenuFilter::ApplyFilterByValue service call succeeded"),na.b(this.$).rd(ca.a.tDf,this.sm(),void 0,!0),Oa={},Oa.FirstRow=this.fVh(),Oa.FirstColumn=Ya.Column,-1!==Oa.FirstRow&&(Oa=L.C(Oa),this.gS(Oa)))},Qa=new aa.a(208,
0,(Oa,bb,Ga)=>V.a(this.$.oa.xa,Ja,Ha,wa.b(Oa,Na),bb,Ga,null,null),6,()=>new Fa.a(Ha,Ja));this.namedSheetViewPublic?this.namedSheetViewPublic.DSa().continueWith(Oa=>{Oa.result&&this.$.userOperationManager.Jc(Qa,null)}):this.$.userOperationManager.Jc(Qa,null);return Yb.Task.Sa(!0)}gS(Ha){H.a.Yka(this.$)&&Y.TaskExtensions.za(Ma.GetServiceTaskFactory.Oa(this.$.da,430,431,1),Ya=>{Ya.result.vea(Ha);c.ULS.sendTraceTag(527500291,306,50,"GridContextMenuFilter:TriggerPivotTableHandRaise Trigger hand raise from context menu filterByValue.")},
this.$.la,3)}sm(){return{["Location"]:"contextMenu"}}JU(){var Ha=0,Ya=this.gridView.ha.qa.activeCell;var Gb=this.$.da.Aa(66).Dg;const Ja=this.$.da.Aa(66).swb(Ya);if(Gb){var Na="Table";Ha=Gb.objectId}else Ja?(Na="Table",Ha=Ja.id):Na="Sheet";Gb=Ya.left;Ya={};Ya.AutoFilterType=Na;Ya.Column=Gb;Ya.Id=Ha;Na={};this.$.ak(Na);Na.FirstRow=0;Na.FirstColumn=Ya.Column;Ha=this.$.ea.isNamedObjectViewMode;Ya.NamedObjectView=Ha;Ya.SheetName=Ha?Na.NamedObjectName:Na.SheetName;Ya.ItemListOptions=null;return Ya}y2g(Ha,
Ya){Ha=D.Range.Mc(Ha,Ya);return this.gridView.Ca.d$(Ha,this.$.na.name)&&(Ha=this.gridView.Ca.IKa(Ha))&&Ha.autoFilterMenu?!0:!1}E6h(){var Ha=null;const Ya=this.gridView.Pb(this.gridView.ha.qa.activeCell);if(!Ya)return null;const Gb=Ya.cell.JAc;let Ja;({category:Ja}=this.instantaneousSupportInformationManager.NBa(Gb,!1));if(1===Ya.Gr.type)if(3===Ja){if(!Ya.cell.COa)return c.ULS.sendTraceTag(527500290,0,15,`GridContextMenuFilter::GetValueForFilter() for category : ${Ja}. NumFmt is null. `),null;Ha=(Ya.cell.COa.Start+
Ya.cell.COa.End).trim()}else if(!Ja&&(Da.a.W0a(Ya.Gr.value,"E")||Da.a.W0a(Ya.originalText,"E"))){Ha=this.Nh.CZe(Ya.Gr.value,Gb,1,Number.POSITIVE_INFINITY,Ya.cell.bia);if(!Ha.success)return c.ULS.sendTraceTag(527500289,0,50,`GridContextMenuFilter::GetValueForFilter() for category : ${Ja}. Failed to acquire formatted value`),null;Ha=Ha.KA}Ha||(Ha=Ya.originalText);return fa.a.dCe(Ha)?["[Blanks]"]:["i"+Ha.trim()]}fVh(){const Ha=this.gridView.ha.qa.activeCell;var Ya=this.$.da.Aa(66).Dg;const Gb=this.$.da.Aa(66).swb(Ha);
if(Ya)return Ya.usedRange.top;if(null!=Gb)return Gb.top;Ya=this.$.va.getItemByName(this.$.na.sheetName);return(Ya=L.D(Ya.v0))&&Ya.contains(Ha)?Ya.top:-1}w5c(Ha,Ya){const Gb={};Gb.Location=Ya;Gb.FieldId=Ha.Id.toString();Gb.DataSourceIndex=-1;Gb.FilterType=Ha.AutoFilterType;Gb.AnchorType=0;Gb.ChartId=null;Gb.AnchorValue1=-1;Gb.AnchorValue2=-1;Gb.Property=Ha.RichProperty;return Gb}}Object(r.a)(Zb,"GridContextMenuFilter",null,[]);a.d(F,"GridContextMenu",function(){return qb});class qb extends n.a{constructor(Ha,
Ya,Gb,Ja){super(Ha,"PopulateGridContextMenu",1247109494,-2064931494,qb.n8h,!0,!1,qb.bLb,Ya,Gb,!0,Ja);this.bkc=this.expandCollapse=this.refresh=this.bZ=this.dwa=this.XAa=!1;this.nIe=!0;this.grid=da.h(Ha);this.$mc=!0;if(this.whc=ra.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GridContextMenuFilterByValue",!1)){const Na=Ma.GetServiceTaskFactory.Oa(this.$.da,309,310,3),Qa=Ma.GetServiceTaskFactory.create(this.$.da,18,this.la,3);Y.TaskExtensions.za(Y.TaskExtensions.Fd([Na,Qa],this.la),()=>
{this.$.da.gb(268,Oa=>{this.h5a=new Zb(Ha,Na.result,Qa.result,Oa)})},this.la,3)}}get Hw(){return"PopulateGridContextMenu"}get tB(){return y.a.NRf}dispose(){super.dispose();this.grid=null}Hc(Ha,Ya){Ha=!this.Gsd(Ha,Ya);if(!Ha)switch(Ya){case -1977666927:Ha=null==this.h5a||this.fFj();break;case 1549396389:Ha=null==this.h5a||!this.Mmi();break;case 2045563128:case 1803952894:Ha=null==this.h5a||!this.$.isEditMode&&!this.Nmi();break;case -425234874:Ha=this.jFj()}return Ha}Gsd(Ha,Ya){const Gb=this.grid.ha.qa.selectedRanges;
return(new ba.a(this.$.va)).um(Ha,Ya,Gb,this.grid)}executeCommand(Ha,Ya,Gb){const Ja=Ya.command;Ha=null;switch(Ja){case -1396319072:if(Ya=this.grid.Pb(null))b.a.instance.f1c(!0),e.EventHandlerManager.instance.Idd(),qb.a2i(Ya);break;case -1253126584:this.removeHyperlinksFromRange(this.grid.ha.qa.selectedRanges,Ya);break;case 324156914:Ha=this.grid.startEdit(!1,1);break;case 1441131127:this.showGridContextMenu(Gb);break;case -1977666927:Ha=this.h5a.Doh();break;case 1549396389:Ha=this.h5a.Uoh();break;
case 1803952894:Ha=this.h5a.Ioh();break;default:Ha=O.a(Ja)}return Ha||Y.TaskExtensions.Yaa()}wc(Ha,Ya,Gb){Ha=!1;switch(Ya.command){case -1396319072:case -1253126584:case 324156914:case -1977666927:case 1549396389:case 1803952894:Ha=!0;break;case 1441131127:Ha=!!Gb}return Ha}FY(Ha=!1){let Ya=!1,Gb=!1,Ja=0;ra.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(Ja=f.a.Td());const Na=this.Va.uq(this.menuId);var Qa=this.grid.ha.qa;const Oa=Qa.Tg,bb=Oa&&Qa.ld.Rg,
Ga=Oa&&Qa.ld.isRow;Qa=Qa.selectedRanges;const tb=d.a.all(Qa,Pa=>Pa.Rg),wb=d.a.all(Qa,Pa=>Pa.isRow),lb=L.O(Qa),db=L.P(Qa);this.elf(bb,Ga)?(Ya=!0,this.YMh(Na)):this.$.isEditMode?xa.a(this.$)?this.ZMh(Na,bb,Ga):(this.VLh(Na,!(Ga||bb||!this.bkc)),this.sMh(Na,Qa,Ha),this.hMh(Na,tb,wb,lb,db),this.O_e(Na,Oa,bb,Ga),this.qNh(Na),this.t_e(Na,bb,Ga),this.OMh(Na,Oa,bb,Ga,Qa),this.YLh(Na),this.WLh(Na,Qa),this.AMh(Na),this.lNh(Na,Oa),ra.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImmersiveReader",
!1)&&this.mMh(Na)):(Gb=!0,xa.a(this.$)?this.J_e(Na):this.GNh(Na,Oa,bb,Ga,Qa));ra.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(Ha=f.a.Td()-Ja,c.ULS.sendTraceTag(537167046,0,50,`GridContextMenu::CreateMenuModel, ExecutionTimeTotal: ${Ha}, isPivotMenu: ${Ya}, isViewMenu: ${Gb}, firstTimeEntry: ${this.nIe}`));this.nIe=!1;return Na}xKa(Ha){const Ya=[];if(xa.a(this.$))return Ya;if(3===Ha){Ha=this.grid.ha.qa;const Ja=Ha.Tg,Na=Ja&&Ha.ld.Rg,Qa=Ja&&Ha.ld.isRow;
let Oa=!1;var Gb=!1;let bb=!1;this.$.isMobileMode&&(Gb=Ha.selectedRanges,Oa=L.O(Gb),Gb=L.P(Gb));if(Ja){const Ga=da.f(this.grid);Ga&&Ga.range.contains(Ha.ld)&&this.iV(Ga)&&(bb=!0)}this.$.isEditMode?this.elf(Na,Qa)?Ya.push(...[x.a.LMf,x.a.NMf]):Na||Qa?(Ya.push(x.a.clipboard),Qa?Ya.push(x.a.rrj):Na&&Ya.push(x.a.R6g)):(Ya.push(...[x.a.edit,x.a.clipboard]),bb?Ya.push(x.a.hyperlink):Ya.push(x.a.color),Ja&&Ya.push(x.a.WUg)):(Ya.push(x.a.copy),bb&&Ya.push(x.a.openHyperlink),!Qa||this.$.isMobileMode&&Gb?!Na||
this.$.isMobileMode&&Oa||Ya.push(x.a.N5j):Ya.push(x.a.O5j));Ya.push(x.a.e8h)}else 2===Ha&&Ya.push(x.a.hBe);return Ya}elf(Ha,Ya){return(this.XAa||this.dwa||this.bZ||this.refresh||this.expandCollapse)&&!(Ha||Ya)}showGridContextMenu(Ha){this.expandCollapse=this.refresh=this.bZ=this.dwa=this.XAa=!1;var Ya=this.$,Gb=Z.a(Ya).MKa(),Ja=this.grid.ha.qa;const Na=Ja.Tg;var Qa=Na&&Ja.ld.Rg;Ja=Na&&Ja.ld.isRow;if(Gb&&!Qa&&!Ja){Qa=ea.a(Ya);if(null===Qa||void 0===Qa?0:Qa.KTd)this.XAa=Qa=E.f(Ya.dg),this.dwa=!Qa;Qa=
Ya.$b;this.bZ=Gb.supportsBIExplore&&!!v.a(Ya)&&Qa.t2(32768);Qa.allowInteractivity&&(Ya=this.grid.Pb(null),(null===Ya||void 0===Ya?0:Ya.cell)&&(Ya.cell.V0c||Ya.cell.V8f)&&(this.expandCollapse=!0),Qa.allowManualDataRefresh&&(this.refresh=!0))}Ya=null;Gb=1;Qa=Object(k.a)(h.a,Ha.eventArgs);Ha=Object(k.a)(C.a,Ha.creationParams);Ja=this.iSh();Ha?(Ya=Ha.clientPoint,Gb=Ha.inputMethod):Qa&&1!==Qa.vb?(Ya=new Sys.UI.Point(Qa.clientPoint.x,Qa.clientPoint.y),Gb=Qa.vb):Ja&&(Ya=new Sys.UI.Point(Ja.x+(this.$.isChromeRtl?
0:Ja.width),Ja.y+Ja.height));N.a.zb=Gb;this.bkc=3===Gb;Ha=w.a.Zub;this.xp(Ya,!Qa||Qa.Ea.target.className!==Ha,Gb)}removeHyperlinksFromRange(Ha,Ya){if(!ra.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.Us(Ha,!0)){var Gb=L.r(Ha,this.$),Ja=this.$.oa.xa.Wb();this.$.userOperationManager.Jc(new aa.a(125,0,(Na,Qa,Oa)=>{this.$.py();return V.b(this.$.oa.xa,Gb,"","",!0,!1,127,Na,Qa,Oa,null,Ja)},void 0,()=>new S(Gb)),Ya);this.grid.Gg.iM(!1)}}iSh(){var Ha=
this.grid.Pb(null);if((null===Ha||void 0===Ha?0:Ha.cell.uk)&&this.jkf(Ha))return this.grid.getCellBounds(Ha.cell);Ha=this.grid.ha.qa.activeCell;return(Ha=this.jac(new D.Range(Ha.top,Ha.left,z.a.Vg,Ha.left,!1,!1),2,!0)||this.jac(new D.Range(1,Ha.left,Ha.top,Ha.left,!1,!1),2,!1)||this.jac(new D.Range(Ha.top,Ha.right,Ha.top,z.a.Ug,!1,!1),1,!0)||this.jac(new D.Range(Ha.top,1,Ha.top,Ha.right,!1,!1),1,!1)||null)&&Ha.uk?this.grid.getCellBounds(Ha):Sys.UI.DomElement.getBounds(this.grid.Zva.jc)}jkf(Ha){var Ya=
this.grid.rtl,Gb=this.$.isChromeRtl;Ha=Ha.cell;var Ja=da.h(this.$).LJ(Ha);return Ja?(Ja=Ja.topLeft,Ya=Ja.x+=Ya===Gb?Ha.offsetWidth:0,Gb=Ja.y+=Ha.offsetHeight,this.grid.view.visibleArea.contains(new u.a(Ya,Gb,0,0))):!1}jac(Ha,Ya,Gb){Ha=this.grid.Wj("GridContextMenu.FindFirstCellInViewportArea",Ha,Ya,Gb);try{for(Ha.$$rst();Ha.$$mn();){const Ja=Ha.$$cu();if(Ja&&this.jkf(Ja))return Ja.cell}}finally{Ha&&Ha.dispose()}return null}YMh(Ha){const Ya=this.Va,Gb=Ya.Ec();this.refresh&&Gb.buttons.push(Ya.pb(100));
this.bZ&&Gb.buttons.push(Ya.pb(99));this.XAa?Gb.buttons.push(Ya.pb(59)):this.dwa&&Gb.buttons.push(Ya.pb(58));if(this.expandCollapse){let Ja;Ja=Ya.$v("ContextMenu.PivotExpandCollapse",null,B.a.instance.ga(1166),589118293);const Na=Ya.Ec();Na.buttons.push(Ya.pb(243));Na.buttons.push(Ya.pb(244));Na.buttons.push(Ya.pb(245));Na.buttons.push(Ya.pb(246));Ja.menu.rc.push(Na);Ja&&0<Na.buttons.length&&Gb.buttons.push(Ja)}Ha.rc.push(Gb)}O_e(Ha,Ya,Gb,Ja){if(Ya&&!Gb&&!Ja){Ya=this.Va.Ec();this.whc&&!this.$.fK&&
this.Ced(Ya);this.Ked(Ya);this.uNh(Ya);if(ra.EwaSettings.ra(417)&&da.h(this.$).ha.qa.bK()&&da.h(this.$).ha.qa.h5)switch(ra.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:Ya.buttons.push(this.Va.pb(237));break;case 2:Ya.buttons.push(this.Va.pb(238));break;default:Ya.buttons.push(this.Va.pb(236))}Ha.rc.push(Ya)}}Ked(Ha){if(this.$.$b.allowSorting&&(!this.$.isMobileMode||(new ba.a(this.$.va)).Pd(2048))){var Ya=this.Va.Ec();Ya.buttons.push(this.Va.pb(223));
Ya.buttons.push(this.Va.pb(224));Ya.buttons.push(this.Va.pb(292));Ya.buttons.push(this.Va.pb(293));Ya.buttons.push(this.Va.pb(294));this.$.isMobileMode||Ya.buttons.push(this.Va.pb(225));var Gb=this.Va.$v("ContextMenu.sort",null,B.a.instance.ga(226),-864298118);Gb.menu.rc.push(Ya);Ha.buttons.push(Gb)}}Ced(Ha){const Ya=this.Va.$v("ContextMenu.filter",null,B.a.instance.ga(1969),2045563128),Gb=this.Va.Ec();var Ja=this.IWh();const Na=this.Va.pb(234);Na.label=Ja;Gb.buttons.push(Na);Gb.buttons.push(this.Va.pb(235));
Ja=this.Va.Ec();Ja.buttons.push(this.Va.pb(233));Ya.menu.rc.push(Gb);Ya.menu.rc.push(Ja);Ha.buttons.push(Ya)}uNh(Ha){if(da.h(this.$).ha.qa.bK()){const Ya=this.Va.Ec();Ya.buttons.push(this.Va.pb(232));Ya.buttons.push(this.Va.pb(285));Ya.buttons.push(this.Va.pb(286));const Gb=this.Va.$v("ContextMenu.table",null,B.a.instance.ga(1968),-697806646);Gb.menu.rc.push(Ya);Ha.buttons.push(Gb)}}E_e(Ha,Ya,Gb,Ja,Na){if(Ya){const Oa=L.K(Na);var Qa=da.f(this.grid);if(Qa&&!Gb&&!Ja){Gb=new ba.a(this.$.va);if(Qa.range.contains(Oa)&&
this.iV(Qa)){(Ya=!Qa.Oka&&!Gb.Ph)&&this.$.isEditMode&&Ha.buttons.push(this.Va.pb(45));Qa.bba&&Ha.buttons.push(this.Va.pb(53));Ya&&this.$.isEditMode&&Ha.buttons.push(this.Va.pb(47));return}!Qa.Oka&&this.$.isEditMode&&(Qa=Gb.Pd(128),Ha.buttons.push(this.Va.pb(Qa?46:121)))}}this.lcj(Na)&&Ha.buttons.push(this.Va.pb(48));(Qa=this.$.va.na)&&Qa.Zd&&(Qa=Qa.Zd.kz||Qa.Zd.hK,!Ya||this.$.fK||!ra.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||!U.g(this.$)||this.$.ea.isNamedObjectViewMode||
this.$.isMobileMode||Qa||(Ya=L.K(Na),this.kcj(Ya)?Ha.buttons.push(this.Va.pb(276)):Ya.Rg||Ya.isRow||Ha.buttons.push(this.Va.pb(275))))}lcj(Ha){for(const Ya of Ha){Ha=this.grid.getRangeInformation(Ya);for(let Gb=0;Gb<Ha.length;Gb++)if(Object(t.a)(G.HyperlinkRange,Ha[Gb])){const Ja=this.grid.Pb(Ha[Gb]);if(Ja&&this.iV(Ja)&&!Ja.Oka)return!0}}return!1}kcj(Ha){if(da.h(this.$).ha.qa.bK()){const Ya=da.h(this.$).tb.Dh(Ha);if(Ya&&Ya.usedRange.equals(Ha))return!0}return!1}t_e(Ha,Ya,Gb){var Ja,Na;if(1===da.h(this.$).ha.Ke&&
!Ya&&!Gb){Ya=xa.a(this.$);Gb=this.Va;var Qa=Gb.Ec(),Oa=this.$.da.Aa(65);(null===(Ja=null===Oa||void 0===Oa?void 0:Oa.Rm)||void 0===Ja?0:Ja.WE)&&!Ya&&Qa.buttons.push(Gb.pb(227));Oa&&Oa.isCommentOperationEnabled(3)&&Qa.buttons.push(Gb.pb(221));(null===(Na=null===Oa||void 0===Oa?void 0:Oa.Rm)||void 0===Na?0:Na.yld)&&!Ya&&Qa.buttons.push(Gb.pb(228));(null===Oa||void 0===Oa?0:Oa.hasCommentAtActiveCell)?Oa.sC.isResolved||Qa.buttons.push(Gb.pb(159)):Oa&&Oa.hasCommentAtActiveCell||(Oa&&Oa.Rm&&Oa.Rm.WE?Ya||
(Qa.buttons.push(Gb.pb(229)),Qa.buttons.push(Gb.pb(230))):(Qa.buttons.push(Gb.pb(160)),Ya||Qa.buttons.push(Gb.pb(226))));Ha.rc.push(Qa)}}qNh(Ha){if(ra.EwaSettings.ra(127)){const Ya=this.Va,Gb=Ya.Ec();Gb.buttons.push(Ya.pb(250));Ha.rc.push(Gb)}}sMh(Ha,Ya,Gb){if(!Gb){Gb=this.$.Ia.eH();var Ja=new ba.a(this.$.va),Na=new P.a(Gb,Ya,this.grid);(new I(Ha,this.$,this.Va,Gb,Ya,this.grid,Na,Ja)).yed()}}hMh(Ha,Ya,Gb,Ja,Na){const Qa=(new ba.a(this.$.va)).Pd(8),Oa=this.Va,bb=Oa.Ec();Ya&&bb.buttons.push(Oa.pb(Qa?
152:153));Gb&&bb.buttons.push(Oa.pb(Qa?150:151));Ya&&(Ja||bb.buttons.push(Oa.pb(Qa?109:155)),bb.buttons.push(Oa.pb(Qa?111:157)));Gb&&(Na||bb.buttons.push(Oa.pb(Qa?108:154)),bb.buttons.push(Oa.pb(Qa?110:156)));Ha.rc.push(bb)}VLh(Ha,Ya){const Gb=this.Va,Ja=Gb.Ec();Ha.rc.push(Ja);Ya&&Ja.buttons.push(Gb.pb(102));Ja.buttons.push(Gb.pb(42));Ja.buttons.push(Gb.pb(43));Ya=this.VMh(Gb);Ha.rc.push(Ya)}VMh(Ha){const Ya=Ha.Ec();Ya.title=B.a.instance.ga(1146);Ya.V$f=!1;Ya.U$f=!1;Ya.dfg=!1;let Gb=5;const Ja=H.a.iud(this.$);
Ja&&(Gb=6);Ha=Ha.zC("PasteOptionsGallery",Gb,"Size24by24",Ya.title);Ya.buttons.push(Ha);Ha.Zt("ContextMenu.Paste",237279923,"QueryAdvancedPasteContextMenuGalleryIcon",1147,void 0,"Paste_24",1,m.a.Qzh);Ha.Zt("ContextMenu.PasteValues",-185374993,"QueryAdvancedPasteContextMenuGalleryIcon",1148,void 0,"PasteValues_24",1,m.a.Vzh);Ha.Zt("ContextMenu.PasteFormulas",1766348718,"QueryAdvancedPasteContextMenuGalleryIcon",1149,void 0,"PasteFormulas_24",1,m.a.Szh);Ha.Zt("ContextMenu.PasteTranspose",-958589048,
"QueryAdvancedPasteContextMenuGalleryIcon",1150,void 0,"PasteTranspose_24",1,m.a.Uzh);Ha.Zt("ContextMenu.PasteFormatting",1804571062,"QueryAdvancedPasteContextMenuGalleryIcon",1151,void 0,"PasteFormatting_24",1,m.a.Rzh);Ja&&Ha.Zt("ContextMenu.PasteLink",42074747,"QueryAdvancedPasteContextMenuGalleryIcon",1152,void 0,"PasteLink_24",1,m.a.Tzh);return Ya}GNh(Ha,Ya,Gb,Ja,Na){var Qa;const Oa=this.Va;var bb=Oa.Ec();bb.buttons.push(Oa.pb(43));Ha.rc.push(bb);this.whc&&!this.$.fK&&(bb=this.Va.Ec(),this.Ced(bb),
Ha.rc.push(bb));ra.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInReadOnlyEditMode",!1)&&this.$.ea.$b.isMobileMode&&this.$.ea.$b.isReadOnlyEditMode&&!this.$.ya.IsMeetingLiveSession||(bb=this.Va.Ec(),this.Ked(bb),Ha.rc.push(bb),c.ULS.sendTraceTag(537167045,0,50,"GridContextMenu::GenerateViewMenuSection, Remove the sort options from right contextual menu in mobile, readonlyeditmode and non-meeting scenario"));bb=this.$.da.Aa(65);if(null===(Qa=null===bb||void 0===bb?void 0:bb.Rm)||
void 0===Qa?0:Qa.WE)Qa=this.Va.Ec(),Qa.buttons.push(Oa.pb(229)),Ha.rc.push(Qa);Qa=this.Va.Ec();this.E_e(Qa,Ya,Gb,Ja,Na);Ha.rc.push(Qa);l.AFrameworkApplication.isMobileMode&&!M.a(this.$.ya,29)&&(Ya=Oa.Ec(),Ya.buttons.push(Oa.pb(272)),Ha.rc.push(Ya))}OMh(Ha,Ya,Gb,Ja,Na){const Qa=this.Va.Ec();H.a.Mqd(this.$)?this.bMh(Qa):this.PMh(Qa);this.E_e(Qa,Ya,Gb,Ja,Na);0<Qa.buttons.length&&Ha.rc.push(Qa)}PMh(Ha){Ha.buttons.push(this.Va.pb(135))}bMh(Ha){Ha.buttons.push(this.Va.pb(300))}mMh(Ha){const Ya=this.Va.Ec();
Ya.buttons.push(this.Va.pb(185));Ha.rc.push(Ya)}lNh(Ha,Ya){ra.EwaSettings.ra(418)&&Ya&&(Ya=this.Va.Ec(),Ya.buttons.push(this.Va.pb(262)),Ha.rc.push(Ya))}AMh(Ha){var Ya=this.grid.ha.qa.selectedRanges;if(Ya&&Ya.length){var Gb=!1;for(var Ja=0;Ja<Ya.length;Ja++)if(this.grid.tb.hxa(Ya[Ja])){Gb=!0;break}if(Gb){Gb=!1;for(Ja=0;Ja<Ya.length;Ja++){var Na=this.grid.tb.Y_h(Ya[Ja]);if(null!=Na&&null!=Na[0]){for(var Qa=0;Qa<Na.length;Qa++)if(this.grid.tb.hxa(Na[Qa])){Gb=!0;break}if(Gb)break}}Qa=this.Va;Ja=Qa.Ec();
Na=Qa.Ec();var Oa=1===Ya.length&&(Ya[0].isSingle||this.grid.tb.eNa(Ya[0])),bb=!1,Ga=!1,tb=!1,wb=!1;for(let lb=0;lb<Ya.length&&!(bb&&tb&&Ga&&wb);lb++)!bb&&this.grid.tb.Kri(Ya[lb])&&(bb=!0),!tb&&this.grid.tb.Zjf(Ya[lb],!1)&&(tb=!0),!Ga&&this.grid.tb.ojc(Ya[lb])&&(Ga=!0),!wb&&this.grid.tb.chf(Ya[lb])&&(wb=!0);ra.EwaSettings.ra(102)&&Oa&&!this.grid.tb.iAb(Ya[0])&&(wb?Ja.buttons.push(Qa.pb(217)):Ja.buttons.push(Qa.pb(216)));wb=bb;wb=!(new ba.a(this.$.va)).Ph&&wb;tb&&!Gb&&(ra.EwaSettings.ra(123)&&E.l(this.$.dg)&&
(ra.EwaSettings.isChangeGateEnabled("OfficeVSO:5695344_showRefreshSettingsOnProtectedSheet")?Na.buttons.push(Qa.pb(220)):Na.buttons.push(Qa.pb(wb?220:271)),Ga&&Na.buttons.push(Qa.pb(wb?218:269)),Oa&&(this.grid.tb.ojc(Ya[0])||this.grid.tb.iAb(Ya[0]))&&Na.buttons.push(Qa.pb(wb?219:270))),Na.buttons.push(Qa.pb(wb?215:268)));0<Na.buttons.length&&(Ya=Qa.$v(bb?"ContexMenu.LinkedEntitiesFlyOut_EnabledContents":"ContexMenu.LinkedEntitiesFlyOut_DisabledContents",null,B.a.instance.ga(1782),798637440),Ya.menu.rc.push(Na),
Ja.buttons.push(Ya));0<Ja.buttons.length&&Ha.rc.push(Ja)}}}WLh(Ha,Ya){this.grid.tb.mif(Ya)&&(Ya=this.Va.Ec(),this.grid.ha.qa.Hba()?(Ya.buttons.push(this.Va.pb(241)),Ya.buttons.push(this.Va.pb(239))):Ya.buttons.push(this.Va.pb(240)),Ha.rc.push(Ya))}iV(Ha){return Ha.cell.hasHyperlink}J_e(Ha){this.$Mh(Ha);var Ya=this.Va.Ec();this.Ked(Ya);Ha.rc.push(Ya);this.whc&&(Ya=this.Va.Ec(),this.Ced(Ya),Ha.rc.push(Ya))}ZMh(Ha,Ya,Gb){this.J_e(Ha);this.t_e(Ha,Ya,Gb)}$Mh(Ha){if(this.grid.ha.qa.Tg&&!this.grid.ib.fj){var Ya=
this.Va,Gb=Ya.Ec();ia.a(this.$).kUd()?Gb.buttons.push(Ya.pb(265)):Gb.buttons.push(Ya.pb(264));Ha.rc.push(Gb)}}static a2i(Ha){const Ya=Ha.EKa(qb.Omd);Ya&&Ya.Eod&qb.Omd&&Ha.invoke(qb.Omd,null)}static rMh(Ha,Ya,Gb){(Gb=Gb.da.Aa(254))?(Gb.pic()&&Gb.opf()&&Ha.buttons.push(Ya.pb(212)),Gb.pic()&&Gb.$kc()&&Ha.buttons.push(Ya.pb(213))):c.ULS.sendTraceTag(537167044,0,50,"GridContextMenu::GenerateInsertCopiedCutCellsConextMenu, CopyPasteInfrastructure is not ready.")}fFj(){const Ha=this.$.da.Aa(66).Dg,Ya=this.grid.ha.qa.activeCell;
return null!=Ha&&!Ha.hasActiveFilter||Ta.c(this.$,Ya)||!this.Omi(Ya)}Omi(Ha){const Ya=Ha.left;var Gb=this.Ddc();if(null!=Gb&&null!=Gb.$$b&&Gb.$$b.includes(Ya-1))return!0;Gb=this.vdc();return null!=Gb&&L.D(Gb).contains(Ha)&&null!=Gb.FilteredColumns&&Gb.FilteredColumns.includes(Ya-1)?!0:!1}Mmi(){var Ha=this.$.da.Aa(66).Dg;const Ya=this.Ddc();if(null!=Ha)return Ha.hasAutoFilter&&Ha.hasActiveFilter;if(null!=Ya)return null!=Ya.$$b&&0<Ya.$$b.length;Ha=this.vdc();return null!=Ha&&null!=Ha.FilteredColumns&&
0<Ha.FilteredColumns.length}Nmi(){var Ha=this.$.da.Aa(66).Dg;const Ya=this.Ddc();if(null!=Ha&&Ha.hasAutoFilter||null!=Ya&&Ya.Csa.every(Gb=>0!=Gb.length))return!0;Ha=L.D(this.vdc());return null!=Ha&&Ha.contains(this.grid.ha.qa.activeCell)?!0:!1}Ddc(){const Ha=this.$.da.Aa(66);Ha.Np(this.grid.ha.qa.activeCell);return Ha.swb(this.grid.ha.qa.activeCell)}vdc(){return this.$.va.getItemByName(this.$.na.sheetName).v0}IWh(){var Ha=this.grid.ha.qa.activeCell,Ya=0,Gb=!1,Ja=this.$.da.Aa(66),Na=this.Ddc();Ja=
Ja.Dg;null!=Ja?(Ya=Ja.usedRange.top,Gb=!0):null!=Na?(Ya=Na.top,Gb=!0):(Na=this.vdc(),null!=Na&&L.D(Na).contains(Ha)&&(Ya=Na.FirstRow+1,Gb=!0));return Gb?(Ha=Ha.left,Ya=D.Range.Mc(Ya,Ha),Ya=this.grid.Pb(Ya),Gb="",null!=Ya&&(Gb=Ya.text),this.$Xg(Gb,Ha)):B.a.instance.ga(219)}$Xg(Ha,Ya){null==Ha||Da.a.lh(Ha.trim())?Ha=String.format(B.a.instance.ob(157),D.Range.BP(Ya)):Ha.length>qb.B3d?(Ha=Ha.substring(0,qb.B3d),Ha=String.format(B.a.instance.ob(155),Ha)):Ha=String.format(B.a.instance.ob(156),Ha);return Ha}jFj(){const Ha=
this.grid.ha.qa.selectedRanges;if(!Ha||!Ha.length)return!0;for(let Ya=0;Ya<Ha.length;Ya++)if(!this.grid.tb.cxa(Ha[Ya]))return!1;return!0}}qb.bLb="GridContextMenuRootName";qb.n8h=y.a.aGe;qb.Omd=192;qb.B3d=26;Object(r.a)(qb,"GridContextMenu",n.a,[])},1244:function(r,F,a){a.r(F);r=a(0);var c=a(15),b=a(89),e=a(1111),f=a(8),d=a(786);class h{}h.qXd="suggested_cells_list_box";Object(r.a)(h,"CssElementIds",null,[]);var l=a(5),k=a(1112);class t{constructor(Y,Z){this.rtg=Y;this.qtg=Z}get Z9(){return this.rtg}get VZc(){return this.qtg}}
Object(r.a)(t,"CellAutoCompleteItem",null,[647]);var n=a(4),z=a(84),w=a(930),m=a(388),u=a(41),y=a(1),v=a(22),C=a(21);class x extends w.a{constructor(Y,Z,ea){super(Y,Z);this.oSb=null;this.Ukc=0;this.F0=this.O8a=null;this.a6=(ra,O)=>{if(ra=this.cellAutoCompleteControl.items)if(1===ra.length&&this.cellAutoCompleteControl.q1a.length<ra[0].Z9.length&&this.cellAutoCompleteControl.gwa&&v.a.MF(ra[0].Z9,this.cellAutoCompleteControl.q1a)&&(O.newValue=ra[0].Z9),this.eb&&y.EwaSettings.ra(128)){let da=-1;1<ra.length?
da=this.cellAutoCompleteControl.Adc(this.eb.text,!0):1===ra.length&&(this.cellAutoCompleteControl.gwa||this.cellAutoCompleteControl.ufc)&&(da=0);if(0<=da&&ra.length>da&&ra[da].VZc){const xa=u.C(ra[da].VZc);xa&&C.h(this.$).tb.hxa(xa)&&(O.ahf=!0,O.cBe=ra[da].VZc)}}};this.XGb=()=>{this.cellAutoCompleteControl.gwa=!1};this.eb.UYa(this.a6);if(this.mAb=y.EwaSettings.cl())this.oSb=ea;this.F0=this.Ae.ie(this.eb.textBox.domElement);this.F0.ka("mousedown",this.XGb)}get DAb(){return!1}get eK(){return this.cellAutoCompleteControl.re}set eK(Y){this.cellAutoCompleteControl.re=
Y}get a6a(){return!1}get key(){return m.a.H1c}get cellAutoCompleteControl(){if(this.mAb)return this.oSb;const {CellAutoCompleteControl:Y}=a(1244);return this.oSb||(this.oSb=Object(z.a)(Y,this.$.da.Aa(1)))}dispose(){this.eb.RJb(this.a6);super.dispose()}wY(Y){Y&&!this.cellAutoCompleteControl.re||super.wY(Y)}Oh(Y,Z){this.cellAutoCompleteControl.eb=this.eb;this.Ukc=Y.keyCode;if(this.eb.fb){const ea=this.eb.text;v.a.equals(this.O8a,ea,!1)||(this.O8a=ea)}else this.O8a=null;if(237279923===Z)return this.cellAutoCompleteControl.re=
!1;y.EwaSettings.ra(128)&&17===this.Ukc&&this.cellAutoCompleteControl.gwa&&(this.cellAutoCompleteControl.ufc=!0);return super.Oh(Y,Z)}iCd(){var Y;if(!y.EwaSettings.isChangeGateEnabled("OfficeVSO:5172529_CheckForShuttingDownInAutocompletionTimedCallback")||!n.AFrameworkApplication.rg)if(this.cellAutoCompleteControl.eb=this.eb,this.cellAutoCompleteControl.gwa=!1,this.eb.fb){const Z=!v.a.equals(this.O8a,this.eb.text,!0),ea=this.eb.jqd;ea||!Z&&229!==this.Ukc?ea&&(this.cellAutoCompleteControl.re&&(this.cellAutoCompleteControl.re=
!1),null===(Y=this.cellAutoCompleteControl.ONa)||void 0===Y?void 0:Y.cancel()):this.cellAutoCompleteControl.KTg(this.Ukc)}else this.O8a=null}Ri(){}$f(){this.eK=!1;this.cellAutoCompleteControl.set_visible(!1);this.O8a=null;this.cellAutoCompleteControl.gwa=!1;this.cellAutoCompleteControl.ufc=!1;this.cellAutoCompleteControl.ONa&&this.cellAutoCompleteControl.ONa.cancel()}CId(Y,Z){return this.cellAutoCompleteControl.Oh(Y,Z)}}Object(r.a)(x,"CellAutoCompleteListAutoCompleteBehavior",w.a,[]);var B=a(30);
w=a(1113);var H=a(12),I=a(11),U=a(116);class S extends w.a{constructor(Y,Z,ea,ra){super(Y,Z);this.htmlSanitizationHelper=this.sra=this.cellAutoCompleteControl=null;this.htmlSanitizationHelper=ea;if(this.mAb=y.EwaSettings.cl())this.cellAutoCompleteControl=ra;this.Vo=[]}get Ej(){return this.sra}set Ej(Y){this.BBa(this.Ej);this.sra=Y;const Z=this.BBa(this.Ej);this.ee=Y?Z.innerText:null;this.$wc(Y)}get re(){return super.re}set re(Y){super.re=Y;Y||(this.Ej=null)}get MTa(){return null}get HGa(){return this.mAb?
this.cellAutoCompleteControl:this.cellAutoCompleteControl||(this.cellAutoCompleteControl=this.$.da.Aa(1))}dispose(){super.dispose();this.sra=null}ABc(Y){this.w7(!1);if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&y.EwaSettings.isChangeGateEnabled("OfficeVSO:7253099_CellAutoCompleteListBox_InnerHtml_CleanUp")){var Z=document.createElement("table");Z.classList.add(this.v5);Z.vTg=l.a.DGa;var ea=document.createElement("tbody");for(let ra=0,O=this.Vo.length;ra<O;ra++){const da=
document.createElement("tr"),xa=document.createElement("td");xa.classList.add(this.uV);const ia=document.createElement("span");ia.classList.add(S.l3b);ia.setAttribute(l.a.HYc,Y[this.Vo[ra]].Z9);ia.innerText=Y[this.Vo[ra]].Z9;xa.appendChild(ia);da.appendChild(xa);ea.appendChild(da)}Z.appendChild(ea);this.htmlSanitizationHelper.KG(this.Df);this.Df.appendChild(Z)}else{Z=`<table class='${this.v5}' aria-live='polite'><tbody>`;for(let ra=0,O=this.Vo.length;ra<O;ra++)ea=B.a.yg(Y[this.Vo[ra]].Z9),ea=String.format("<tr><td class='{0}'><span class='{1}' {2}='{3}'>{4}</span></td></tr>",
this.uV,S.l3b,l.a.HYc,ea,B.a.d$c(ea)),Z+=ea;Z+="</tbody></table>";this.Df.innerHTML=Z}this.wn=H.DOMElementExtensions.$j(this.domElement,this.v5);this.w7(!0);this.asa()}IJa(Y,Z){if(Y&&Y.length){var ea=[];if(Z)for(let ra=0,O=Y.length;ra<O;ra++)v.a.MF(Y[ra].Z9,Z)&&ea.push(ra);this.Vo=ea;this.ABc(Y)}else this.re=!1,this.sra=null}gya(){}h0g(Y,Z,ea){let ra=Math.min(Y,Math.max(200,ea));Z&&Y<ea&&(ra+=U.a.Bu);H.DOMElementExtensions.Jv(this.Df,ra);Z&&(ra-=U.a.Bu);return ra}asa(){super.asa();var Y=H.DOMElementExtensions.$j(this.get_element(),
this.v5),Z=this.Vo.length>this.KH,ea=C.h(this.$);if(ea=ea.Pb(ea.ha.qa.activeCell))for(Y=this.h0g(Y.offsetWidth,Z,ea.width),Z=this.Df.getElementsByClassName(S.l3b),ea=0;ea<Z.length;ea++)Z[ea].style.maxWidth=I.HelperMethods.sc(Y);else c.ULS.sendTraceTag(537167964,0,15,"CellAutoCompleteListBox.AdjustHeightAndWidth: Can't retrive FormattedCell of the Current Active Cell.")}onItemClick(Y){if(Y=super.onItemClick(Y)){const Z=C.h(this.$);Z.Fo(!1);Z.focus()}return Y}}S.l3b=d.a.jzh;Object(r.a)(S,"CellAutoCompleteListBox",
w.a,[]);var G=a(24),D=a(65),E=a(117),N=a(163),M=a(44),L=a(35),aa=a(254),V=a(19);a.d(F,"CellAutoCompleteControl",function(){return ba});const P=`<div id='${h.qXd}' class='${d.a.O9b} ${V.a.jo}' ></div>`;class ba extends e.a{constructor(Y,Z,ea){super(Y);this.jDa=null;this.G1c=[];this.F7d=null;this.ufc=this.gwa=!1;this.vde=this.hq=null;this.bOe=()=>{this.sY.IJa(this.items,this.jDa);this.raiseEvent("ACLBUpdated",new k.a(this.items.length));this.show()};this.tableManager=Z;this.domElement.className=d.a.bRe;
y.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&y.EwaSettings.isChangeGateEnabled("OfficeVSO:7141407_FilterDialog_InnerHtml_CleanUp")?(Z=document.createElement("div"),Z.classList.add(d.a.O9b),Z.classList.add(V.a.jo),Z.id=h.qXd,this.domElement.appendChild(Z)):this.domElement.innerHTML=P;H.DOMElementExtensions.setVisible(this.domElement,!1);aa.d(this.style,this.$.isChromeRtl);this.Jif=y.EwaSettings.cl();this.bBe=$get(h.qXd,this.domElement);this.sY=new S(this.$,this.bBe,
ea,this);this.jTa(!0);this.$.domElement.appendChild(this.domElement);this.Hpb(Y,E.a(Y));this.Hpb(Y,C.h(Y).Vb);this.Jif||this.$.da.Ha(1,this);this.Tmi=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeHandleKeyDownConditionOrder",!1)}S_b(Y){this.addHandler("ACLBUpdated",Y)}Ruc(Y){this.removeHandler("ACLBUpdated",Y)}p2(Y){this.addHandler("ACLBSelectionChanged",Y)}wda(Y){this.removeHandler("ACLBSelectionChanged",Y)}rNg(Y){this.addHandler("ACLBMatchedItem",Y)}rkj(Y){this.removeHandler("ACLBMatchedItem",
Y)}get au(){return this.sY}get q1a(){return this.jDa}get ee(){return this.sY.ee}get items(){return this.hq}get ONa(){return this.vde}get activeCell(){return C.h(this.$).ha.qa.activeCell}get dataValidationControl(){return this.F7d||(this.F7d=this.$.da.Aa(14))}mcg(Y){for(let Z=0;Z<Y.length;Z++){const ea=Y.charCodeAt(Z);if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?v.a.isLetter(ea):v.a.qrd(ea))return!0}return!1}Uwa(){return!this.items}dispose(){if(this.$){this.jTa(!1);
const Y=C.h(this.$);Y&&Y.view.Mq(this.tpc)}b.a.pc([this.sY,this.ONa]);b.a.pc(this.G1c);this.G1c=this.bBe=this.sY=this.eb=null;super.dispose()}Oh(Y,Z){let ea=!1;if(this.IFj())switch(Z){case -798660877:if(1===this.items.length&&this.ee)break;this.au.fB(1);this.raiseEvent("ACLBSelectionChanged",new k.a(this.items.length,this.Adc(this.ee),this.ee));ea=this.Ny(!1);break;case 137938150:if(1===this.items.length&&this.ee)break;this.au.fB(-1);this.raiseEvent("ACLBSelectionChanged",new k.a(this.items.length,
this.Adc(this.ee),this.ee));ea=this.Ny(!1);break;case 2091832999:this.au.fB(this.KH-1);ea=this.Ny(!1);break;case 742457698:this.au.fB(-(this.KH-1));ea=this.Ny(!1);break;case 125627505:this.eb.textBox.caretPosition=this.eb.text.length;this.re=!1;ea=!0;break;case 267796030:this.Ny(!0);break;default:ea=super.Oh(Y,Z)}return ea}show(){this.items&&this.items.length&&(this.sY.Ej=this.ee?this.au.wn.rows[this.Adc(this.ee)]:null,this.re=0<this.sY.Vo.length,this.TBa(!0),this.sY.gya())}KTg(Y){const Z=!!this.eb&&
!D.f(this.$.na);this.ufc=this.gwa=!1;this.eb&&!this.eb.fb?this.set_visible(!1):Z&&!this.pjh(this.activeCell)&&this.xJj(Y)}pjh(Y){return!!this.dataValidationControl&&this.dataValidationControl.f9c(Y)}Ny(Y){if(!this.eb||!this.re)return!1;const Z=this.jDa;if(this.ee){var ea=H.DOMElementExtensions.lZ(H.DOMElementExtensions.$j(this.sY.Ej,S.l3b),l.a.HYc,"");const ra=ea.substring(Z.length,ea.length);Y?this.eb.text=ea:this.eb.insertTextAt(ra,Z.length,this.eb.text.length)}ea=C.h(this.$);ea.Ql&&(ea=ea.Vb,ea.text=
this.eb.text,ea.setCaretPosition(this.eb.textBox.caretPosition));Y?this.re=!1:this.eb.textBox.selectRange(Z.length,this.eb.text.length);return!0}Adc(Y,Z=!1){if(!this.sY.wn)return-1;const ea=this.sY.wn.children[0],ra=ea.children.length;let O;for(let da=0;da<ra;++da)if(O=ea.children[da],v.a.equals(O.innerText.trim(),Y,Z))return da;return-1}yIg(Y,Z,ea,ra,O,da,xa){const ia=ea.originalText.replace(ba.Nxf,String.fromCharCode(32)),Ma=new G.Range(Y.top-1,Y.left,Y.bottom-1,Y.right,!1,!1),Ta=xa?xa.Np(ea.range):
null;(!ea.vH||ea.range.left===Y.left)&&1<ia.length&&!ra.hb(ia.toUpperCase())&&v.a.MF(ia,Z)&&!v.a.equals(ia,Z,!0)&&!ba.rYe(Z)&&this.mcg(ia)&&(!O&&!Ta||!O&&Ta.equals(xa.Np(Ma))||O&&ea.range.zd(da)&&ea.range.top!==da.top)&&(Y=ea.formulaBarText,v.a.equals(Y,ea.text,!1)||!Y)&&(Y={},Y.FirstRow=ea.range.top-1,Y.FirstColumn=ea.range.left-1,ea=new t(ia,Y),ra.add(ia.toUpperCase(),ea))}xJj(Y){this.hq=this.z4h();this.ONa&&this.ONa.cancel();0<this.eb.text.length&&0!==Y?this.items&&((1<this.items.length||this.re)&&
this.Rph(),8!==Y&&127!==Y&&46!==Y&&(1===this.items.length?this.lnd(!1):this.sY.Ej&&this.Ny(!1))):this.re=!1}Rph(){this.re?this.bOe():this.vde=N.AsyncMethodContext.vq(this.bOe,500,M.a.w2g,this.ONa)}lnd(Y){c.ULS.shipAssertTag(537167966,0,!this.Uwa()&&1===this.items.length,"Invalid Items");let Z=this.items[0].Z9,ea=this.eb.text,ra=Z.substring(ea.length,Z.length);if(Y&&!ra.length)this.eb.text=Z;else if(!Y&&0<ra.length)this.eb.appendText(ra),this.eb.textBox.selectRange(ea.length,this.eb.text.length);else return;
this.raiseEvent("ACLBMatchedItem",new k.a(this.items.length,0,Z));this.gwa=!0}z4h(){this.hq=null;const Y=new L.a(!1);var Z=this.activeCell;this.jDa=this.eb.text.replace(ba.Nxf,String.fromCharCode(32));const ea=this.tableManager.Np(Z),ra=Z.zd(ea);if(ba.rYe(this.jDa)||!this.mcg(this.jDa))return this.items;const O=new G.Range(1,Z.left,Z.top-1,Z.left,!1,!1);var da=new G.Range(Z.top+1,Z.left,f.a.Vg,Z.left,!1,!1);let xa;const ia=C.h(this.$);da=ia.Wj("CellAutoCompleteControl.GetSuggestedCells",da);try{const Ma=
ia.Wj("CellAutoCompleteControl.GetSuggestedCells2",O);try{for(const Ta of[Ma,da])for(;Ta.$$mn();)xa=Ta.$$cu(),this.yIg(Z,this.jDa,xa,Y,ra,ea,this.tableManager)}finally{Ma&&Ma.dispose()}}finally{da&&da.dispose()}this.hq=Array(Y.values.length);for(Z=0;Z<this.items.length;Z++)this.items[Z]=Y.values[Z];this.items.sort((Ma,Ta)=>Ma.Z9.localeCompare(Ta.Z9));return this.items}Hpb(Y,Z){Y&&Z&&this.G1c.push(new x(Y,Z,this.Jif?this:void 0))}IFj(){return this.Tmi?this.q1a&&!this.Uwa()&&this.re?this.get_visible():
!1:this.q1a&&!this.Uwa()&&this.get_visible()&&this.re}static get Nxf(){return ba.ffe||(ba.ffe=new RegExp(String.fromCharCode(160),"g"))}static rYe(Y){Y=0<Y.length?Y.charCodeAt(0):-1;return 35===Y||61===Y||43===Y||45===Y||64===Y}}ba.ffe=null;Object(r.a)(ba,"CellAutoCompleteControl",e.a,[556,557,558,2])},1250:function(r,F,a){r=a(0);var c=a(567),b=a(562),e=a(559),f=a(1021);class d{Yfh(H,I){if(H&&!(1>H.length)&&I){var U=Object.assign(new e.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.tdh(H,U.ControlList);
I.push(U)}}tdh(H,I){const U=Object.assign(new c.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new b.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(I,U);I=Object.assign(new e.a,{Title:"",ControlList:[]});Array.add(U.Menu.MenuSectionList,I);this.Efh(H,I.ControlList)}Efh(H,I){for(let U=0;U<H.length;U++){const S=Object.assign(new f.a,{ExternalId:String.format("CoauthorPersona_{0}",U),Command:"336231556",
DisplayName:H[U].userName,LabelText:H[U].userName,ImageBackColor:H[U].color,PersonaId:H[U].email,IsAnonymous:H[U].isAnonymous});Array.add(I,S)}}}Object(r.a)(d,"PresenceContextMenuSectionBuilder",null,[581]);var h=a(85),l=a(4),k=a(178),t=a(561),n=a(109),z=a(135),w=a(89),m=a(83),u=a(108),y=a(25);class v{constructor(H,I,U,S){this.F5d=this.d1=this.Ki=this.UD=this.d8=null;this.gYb=H;this.ZDg=S;this.gYb.hMa&&(this.Ki=new n.a(3,2,5E3,Object(h.a)(this,this.NUg,"authenticationCheckTask"),2),l.AFrameworkApplication.ji.fg(this.Ki),
this.Ag(I,U));this.gYb.iob(()=>{this.Uzf()});this.gYb.SYa(()=>{this.Vzf()})}get businessBar(){return this.d1||(this.d1=m.a.instance.mg("CommonUI.IBusinessBar"))}get Pye(){return this.F5d||(this.F5d=m.a.instance.mg("CommonUI.IBusinessBarEntryFactory"))}Ag(H,I){const U=l.AFrameworkApplication.rb;U.Oe(y.a.authenticationLost,u.a.frame,H,96);U.Oe(y.a.Awe,u.a.frame,I,96);U.Nb(y.a.JAe,u.a.frame,k.ActionManager.$8c);U.Nb(y.a.KAe,u.a.frame,k.ActionManager.$8c);U.Nb(y.a.Cvd,u.a.frame,k.ActionManager.$8c)}Uzf(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);
l.AFrameworkApplication.rb.processAction(y.a.authenticationLost,2)}Vzf(){this.sRj();l.AFrameworkApplication.rb.processAction(y.a.Awe,2)}NUg(){this.gYb.authenticationCheck()}sRj(){this.UD&&(this.UD.hide(),this.UD.dispose(),this.UD=null);this.d8&&this.businessBar&&(l.AFrameworkApplication.rg||this.businessBar.removeEntry(this.d8),this.d8.dispose(),this.d8=null)}showDialog(H){w.a.Ja(this.UD);this.UD=new z.StandardDialog;this.ZDg||(this.UD.pt=!1,this.UD.Ob=0);this.UD.tc(1,CommonUIStrings.l_SignIn);this.UD.YR(CommonUIStrings.l_DefaultDialogTitle,
H,Object(h.a)(this,this.iu,"dialogHandler"))}iu(H){1===H?(t.a.v6(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),l.AFrameworkApplication.rb.processAction(y.a.Cvd,2)):(this.xUd(),l.AFrameworkApplication.rb.processAction(y.a.KAe,2))}xUd(){this.businessBar&&this.Pye&&(this.d8=this.Pye.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.d8.closeable=!0,this.d8.addButton(CommonUIStrings.l_SignIn,v.f_g,""),this.d8.w$=Object(h.a)(this,
this.i_g,"businessBarEntryCloseHandler"),this.businessBar.gE(this.d8,!1))}i_g(){this.qnh();l.AFrameworkApplication.rb.processAction(y.a.JAe,2)}qnh(){this.Ki&&(l.AFrameworkApplication.ji.Uo(this.Ki),this.Ki=null)}dispose(){this.Ki=this.UD=this.d8=null}static f_g(){t.a.v6();l.AFrameworkApplication.rb.processAction(y.a.Cvd,2)}}Object(r.a)(v,"SignOutResponseUI",null,[2]);var C=a(251);class x{get name(){return"Common.App.UI"}Bh(H){H.register(d,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").qc()}init(){}dispose(){w.a.Ja(x.P1);
x.P1=null}static main(){C.a.instance.ii(new x)}}x.P1=null;Object(r.a)(x,"CommonAppUIPackage",null,[3,4]);a.d(F,"a",function(){return B});const B=()=>{Type.registerNamespace("CAUI");x.main()}},1251:function(r,F,a){r=a(0);var c=a(55),b=a(226),e=a(1244),f=a(50),d=a(37),h=a(1),l=a(712);class k extends b.a{constructor(y){super();this.$=y;this.Db()}create(){const y=this.$.da,v=f.GetServiceTaskFactory.create(y,134,this.la,this.Xa),C=f.GetServiceTaskFactory.Oa(y,213,214,this.Xa),x=h.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&
h.EwaSettings.isChangeGateEnabled("OfficeVSO:7253099_CellAutoCompleteListBox_InnerHtml_CleanUp")?f.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Xa):c.Task.Sa(null);d.TaskExtensions.za(d.TaskExtensions.Fd([v,C,x],this.la),()=>{if(h.EwaSettings.cl())this.nb(Object(l.a)(this.$.da,1,()=>{const B=new e.CellAutoCompleteControl(this.$,v.result,x.result);C.result.ka(B);return B}));else{let B=y.Aa(1);B||(B=new e.CellAutoCompleteControl(this.$,v.result,x.result),C.result.ka(B));this.nb(B)}},this.la,3)}static ka(y){y.da.Ha(151,
new k(y))}}Object(r.a)(k,"CellAutoCompleteControlFactory",b.a,[]);var t=a(15),n=a(13);class z{constructor(y,v){this.c_a=null;this.WGf=(C,x)=>{1<x.length&&(C=n.a.instance.ga(857),this.ariaLiveNotifier.cSf(C,x.length))};this.XGf=(C,x)=>{t.ULS.shipAssertTag(537167961,0,0<=x.selectedIndex&&0<=x.length&&x.selectedIndex<x.length,"Invalid ListEventArgs: SelectedIndex/Length");t.ULS.shipAssertTag(537167960,0,!!x.GF,"ListEventArgs: SelectedValue should not be null");this.ariaLiveNotifier.rdj(x.GF,x.selectedIndex+
1,x.length)};this.YGf=(C,x)=>{this.ariaLiveNotifier.gQa(x.GF)};this.ariaLiveNotifier=y;h.EwaSettings.cl()||v.Ha(213,this)}dispose(){this.C_d();this.c_a=null}ka(y){y&&(this.c_a=y,y.S_b(this.WGf),y.p2(this.XGf),y.rNg(this.YGf))}C_d(){this.c_a&&(this.c_a.Ruc(this.WGf),this.c_a.wda(this.XGf),this.c_a.rkj(this.YGf))}}Object(r.a)(z,"CellAutoCompleteReadoutHandler",null,[563,2]);class w extends b.a{constructor(y){super();this.$=y;this.Db()}create(){const y=this.$.da;d.TaskExtensions.za(f.GetServiceTaskFactory.Oa(y,
211,212,this.Xa),v=>{if(h.EwaSettings.cl())this.nb(Object(l.a)(y,213,()=>new z(v.result,y)));else{const C=y.Aa(213)||new z(v.result,y);this.nb(C)}},this.la,3)}static ka(y){y.da.Ha(214,new w(y))}}Object(r.a)(w,"CellAutoCompleteReadoutHandlerFactory",b.a,[]);var m=a(9);a.d(F,"a",function(){return u});const u=()=>{m.a.Fa(k.ka);m.a.Fa(w.ka)}},1252:function(r,F,a){var c=a(9);r=a(0);var b=a(237),e=a(226),f=a(50),d=a(37),h=a(1),l=a(15),k=a(89),t=a(4),n=a(81),z=a(8),w=a(24),m=a(65),u=a(41),y=a(140),v=a(48),
C=a(44),x=a(12),B=a(13),H=a(21),I=a(27),U=a(19),S=a(51);class G extends n.a{constructor(aa,V,P,ba){super();this.isMac=I.a.isMac;this.Hwa=!1;this.$=aa;this.ariaLiveNotifier=ba;this.co=P.e6b(aa,null,V,U.a.UTe,S.a.qe(9),B.a.instance.ga(1739),"PulloutPointerDown")}Zig(aa){this.Hwa!==aa&&(this.hide(),(this.Hwa=aa)?this.co.Sjg(U.a.WAh,S.a.qe(3)):this.co.Sjg(U.a.UTe,S.a.qe(9)))}get $y(){return this.co.$y}get buttonWidth(){return this.co.buttonWidth}dispose(){this.co.dispose();this.$=null;super.dispose()}domElement(aa){return this.co.domElement(aa)}getButton(aa){return this.co.getButton(aa,
!1)}nQb(aa,V){this.co.nQb(aa,V,!1)}VAa(aa,V){const P=H.h(this.$),ba=P.ib.Ai(aa);this.co.nQb(this.Hwa?B.a.instance.ga(1741):V?B.a.instance.ga(1739):B.a.instance.ga(1740),ba);V=this.isMac?V?B.a.instance.ga(1744):B.a.instance.ga(1745):V?B.a.instance.ga(1742):B.a.instance.ga(1743);var Y=P.xg(aa,ba);aa=P.Rf(ba).zn;if(Y&&0<=Y.x&&0<=Y.y){const Z=Y.bottomRight.x+this.$y;Y=Y.topLeft.y-this.$y-this.buttonWidth;if(Y<aa.topLeft.y+this.$y){if(P.ib.EBa){this.hide();return}Y=aa.topLeft.y+this.$y}this.xp(Z,Y,P.rtl,
ba);this.ariaLiveNotifier.gQa(V)}else this.hide()}xp(aa,V,P,ba){this.co.xp(aa,V,P,ba,!1)}hide(){this.co.hide()}}Object(r.a)(G,"PulloutLaunchButton",n.a,[]);var D=a(33),E=a(22);class N extends n.a{constructor(aa,V,P,ba,Y){super();this.QXa=this.iQc=this.exc=this.LFa=this.HR=this.BO=null;this.whe=0;this.TDb=this.AAb=this.ZGc=!1;this.Xg=()=>{this.xwa&&(this.gridView?1===this.gridView.ha.Ke?(this.gridView.ha.qa.activeCell.equals(this.LFa)||this.eN||this.Yx(),this.Cpb.Yp()):this.Yx():l.ULS.shipAssertTag(537154141,
0,!1,"GridView is null during selection"))};this.Ri=()=>{this.Yx()};this.dd=()=>{this.KW()};this.uc=()=>{this.Yx()};this.fd=()=>{this.showCallout()};this.Eya=()=>{if(this.Og.Pk&&this.Og.Pk.length)if(this.q0c)this.Og.iBi||(this.ZGc=this.Og.Pk[0].BlockingDataForExpand),this.Og.UUh&&l.ULS.sendTraceTag(537154140,0,50,"User clicked pullout launch button before fieldInfo web service returned"),this.whe=this.Og.f7c&&this.Og.YZe<this.Og.f7c.left-1?this.Og.f7c.left-1-this.Og.YZe:-1,this.showCallout();else if(this.gridView.ha.qa.Tg){var Z=
this.gridView.ha.qa.activeCell;if(Z&&this.HR){var ea=this.tableManager.Np(Z);this.YNc=!!ea;const ra=this.gridView.ha.qa.ld;ea=this.eN&&this.HR.zd(ea);const O=this.mkd&&!this.eN&&ra.equals(this.selectedRange);ea||O?(l.ULS.sendTraceTag(39662912,0,50,"Field TableWidget shown on grid"),this.R$b=!0,h.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&!this.eN&&this.tableManager.Kja(Z)?l.ULS.shipAssertTag(537154139,0,!1,"PulloutManager:OnFieldInfoListContextLoaded fetch rich fields for a cell on PivotTable range"):
(h.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?this.eN?this.xh.VAa(this.HR,this.eN):this.xh.VAa(ra,this.eN):this.xh.VAa(this.HR,this.eN),this.Mvc())):l.ULS.shipAssertTag(537154138,0,!1,"PulloutManager:OnFieldInfoListContextLoaded FAILURE")}}};this.wj=()=>{this.r7a()&&this.xh.hide();1===this.gridView.ha.Ke&&this.KW()};this.jR=()=>{const Z=this.gridView.ha.Ke;this.gridView.ha.qa.activeCell&&1===Z&&this.KW()};this.zt=()=>{if(h.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds"))if(this.eN){if(this.HR&&
this.LFa){var Z=this.tableManager.Np(this.LFa);Z&&1<Z.bottom-Z.top&&(--Z.bottom,this.gridView.Eba(Z)&&this.Cpb.Yp())}}else this.gridView.ha.qa.Tg&&this.gridView.Eba(this.gridView.ha.qa.ld)&&this.Cpb.Yp();else this.HR&&this.LFa&&this.eN&&(Z=this.tableManager.Np(this.LFa))&&1<Z.bottom-Z.top&&(--Z.bottom,this.gridView.Eba(Z)&&this.Cpb.Yp())};this.KW=()=>{if(this.$&&this.gridView){if(this.R$b&&this.eN){const Z=this.gridView.ha.qa.activeCell;this.HR=this.$Xe();const ea=!!this.exc&&this.exc.contains(Z);
if(this.HR&&(Z.equals(this.LFa)||ea)){this.xh.VAa(this.HR,this.eN);return}}this.R$b=!1;(this.HR=this.$Xe())&&this.Sla&&this.gridView&&this.gridView.Ca.Ur(this.Sla)?(this.q0c=!1,this.oZ()):(this.Og.g1c(),this.Og.$2b());this.R$b||this.xh.hide()}};this.$=aa;this.tableManager=P;this.contextMenuManager=ba;this.xh=new G(aa,this.fd,V,Y);this.Og=V.K5c(aa,P);this.R$b=this.q0c=!1;this.mkd=h.EwaSettings.ra(128);this.YNc=!0;this.cEa=!1;this.gridView=H.h(this.$);this.gridView.Vb.xl(this.Ri);this.gridView.Uu(this.jR);
this.$.Lk(this.dd);this.$.nj(this.uc);this.$.dC(this.wj);this.gridView.view.Ps(this.zt);this.gridView.ha.rT(this.Xg);this.Cpb=v.a.instance.create(this.KW,250,C.a.F$i);l.ULS.sendTraceTag(537154143,0,50,"Feature TableWidget enabled");this.Og.J_b(this.Eya);D.a.BAb()&&(this.AAb=!0);this.KW();aa.da.Ha(261,this)}get jc(){return this.xh.domElement(1)}get Sla(){return this.iQc}get selectedRange(){return this.QXa}get eN(){return this.YNc}get Hwa(){return this.cEa}get ZPf(){return this.whe}get oDb(){const aa=
this.xh.domElement(this.Gea);return aa?x.DOMElementExtensions.isVisible(aa):!1}get xwa(){return this.$.isEditMode&&h.EwaSettings.ra(128)?!(new y.a(this.$.va)).Ph:!1}get SPg(){return this.ZGc}get Gea(){return this.Sla?this.gridView.ib.Ai(this.BO):1}dispose(){this.gridView&&(this.gridView.ha.AR(this.Xg),this.gridView.view.Mq(this.zt),this.gridView.Vb&&this.gridView.Vb.nl(this.Ri));if(this.$){const aa=this.$;aa.pl(this.dd);aa.ol(this.uc);aa.zF(this.wj);H.h(aa).my(this.jR)}this.Og&&this.Og.Juc(this.Eya);
k.a.Ja(this.xh);this.Og=this.$=this.gridView=this.Cpb=this.xh=null;super.dispose()}Yx(){this.xh.hide()}Dda(){this.xh?this.xh.getButton(this.Gea).Ncb():l.ULS.sendTraceTag(537154142,0,15,"PulloutManager.ResetButtonAppearance: launchButton is null.")}Woj(){this.HR=null}rPf(){this.xh&&this.xh.hide()}B6h(){if(!this.mkd||1!==this.selectedRange.width)return null;const aa=this.selectedRange.clone();for(;this.gridView.Eba(aa);){aa.left+=1;aa.right+=1;if(!this.gridView.Rf(this.gridView.ib.Ai(aa)).hi.we(aa))break;
if(!this.gridView.Ca.Ur(aa))continue;const V=this.gridView.Wj("PulloutManager.GetValidatedRangeToFill",aa,2);try{if(N.E4j(V))return aa}finally{V&&V.dispose()}}return null}Mvc(){this.Og.Pcb()}showCallout(){this.xwa&&(this.Og.W6a?(this.xh.getButton(this.Gea).bIb(),h.EwaSettings.cl()?d.TaskExtensions.za(f.GetServiceTaskFactory.Oa(this.$.da,8,9,0),aa=>{this.w9f(aa.result)},this.$.la,3):this.w9f(this.contextMenuManager)):(this.q0c=!0,this.oZ()))}w9f(aa){aa.Jfd("tableFieldList").w0(null,this.xh.domElement(this.Gea),
this.Og,null,!0);this.Mvc()}$Xe(){if(!this.xwa||!this.gridView||this.gridView.ha.Ra.dc||!this.gridView.ha.qa.Tg)return null;var aa=this.gridView.ha.qa.activeCell,V=H.h(this.$).ib.Ai(aa);if(!aa)return null;this.LFa=aa.clone();var P=this.tableManager.Np(aa);this.YNc=!!P;if(this.eN){this.xh.nQb(B.a.instance.ga(1739),V);this.BO=N.lmg(P);if(!this.BO)return null;aa=!1;V=({mY:aa}=this.tableManager.NGe(P,this.gridView)).returnValue||aa;this.ZGc=aa;if(V)return this.exc=new w.Range(P.top,P.left,P.bottom,P.right,
!1,!1),this.iQc=new w.Range(this.BO.top,this.BO.right+1,this.BO.top,this.BO.right+1,!1,!1),this.AAb&&(this.cEa=!1,this.xh.Zig(this.cEa)),this.BO}else if(this.mkd){this.QXa=this.gridView.ha.qa.ld.clone();P=this.selectedRange.isSingle&&H.h(this.$).tb.Ohf(this.selectedRange);const ba=H.h(this.$).tb.hxa(this.selectedRange);this.AAb&&(this.cEa=P&&!ba);this.xh.nQb(this.cEa?B.a.instance.ga(1741):B.a.instance.ga(1740),V);P&&!ba&&!this.TDb&&h.EwaSettings.isChangeGateEnabled("OfficeVSO:6253558_DatePulloutExperimentTrigger")&&
E.a.equals(t.AFrameworkApplication.uiCulture,"en-us",!0)&&(t.AFrameworkApplication.Tp("XLS-DateSuggestionV2-Treatment;XLS-DateSuggestionV2-Control"),this.TDb=!0);this.BO=N.lmg(this.selectedRange);if(!(this.AAb&&P||ba)||!this.BO||!this.selectedRange||h.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&this.tableManager.Kja(this.selectedRange))return null;this.iQc=this.B6h();if((h.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?
this.gridView.Eba(this.selectedRange):this.gridView.Eba(this.BO))&&this.Sla)return this.AAb&&this.xh.Zig(this.cEa),this.exc=this.BO,l.ULS.sendTraceTag(537154137,0,50,`PulloutManager:FindSelection, NextRange, ${this.Sla?this.Sla.toString():"null"}, RightColumnHeader, ${this.BO?this.BO.toString():"null"}, ActiveCell, ${aa?aa.toString():"null"}`),this.BO}return null}oZ(){this.eN?this.Og.oZ(u.v(this.Sla,this.$),!1,!0):this.cEa?this.Og.B6i():h.EwaSettings.ra(128)&&this.Og.oZ(u.v(this.selectedRange,this.$),
!0,!1)}r7a(){return this.$.ea.isNamedObjectViewMode&&m.f(this.$.na)}static E4j(aa){for(;aa.$$mn();)if(aa.$$cu().text||aa.$$cu().vH||aa.$$cu().Wh||aa.Nm.cbf)return!1;return!0}static lmg(aa){return aa.right===z.a.Ug?null:new w.Range(aa.top,aa.right,aa.top,aa.right,!1,!1)}}Object(r.a)(N,"PulloutManager",n.a,[546,2]);class M extends e.a{constructor(aa){super();this.$=aa;this.Db()}create(){c.a.Fa(aa=>{const V=f.GetServiceTaskFactory.Oa(aa.da,12,477,this.Xa),P=f.GetServiceTaskFactory.Oa(aa.da,66,134,this.Xa),
ba=f.GetServiceTaskFactory.Oa(aa.da,211,212,this.Xa);let Y=b.a.Sa(null);const Z=!h.EwaSettings.cl();Z&&(Y=f.GetServiceTaskFactory.Oa(aa.da,8,9,this.Xa));d.TaskExtensions.za(d.TaskExtensions.Fd([V,P,Y,ba],aa.la),()=>{Z?this.nb(this.$.da.Aa(261)||new N(this.$,V.result,P.result,Y.result,ba.result)):this.nb(this.$.da.Aa(261)||new N(this.$,V.result,P.result,null,ba.result))},aa.la)})}static ka(aa){aa.da.Ha(262,new M(aa))}}Object(r.a)(M,"PulloutManagerFactory",e.a,[]);a.d(F,"a",function(){return L});const L=
()=>{c.a.Fa(aa=>{aa.ra(128)&&M.ka(aa)})}},1261:function(r,F,a){r=a(0);var c=a(192);class b{qQj(w,m){w.set_visible(!1);m.set_visible(!0)}}Object(r.a)(b,"DefaultTabSwitchBehaviour",null,[380]);class e{}e.eRj="TabsContainer";e.NQj="TabTitlesContainer";e.LQj="TabTitle";e.MQj="TabTitleText";e.QXd="TabTitleActive";Object(r.a)(e,"MultitabControlStyles",null,[]);var f=a(85),d=a(46),h=a(86),l=a(88),k=a(57);class t{constructor(w,m,u){this.pk=w;this.Bp=m;this.IIc=u;this.wfa=document.createElement("a");k.a.iyc(this.wfa,
this.Bp);Sys.UI.DomElement.addCssClass(this.wfa,e.MQj);Sys.UI.DomElement.addCssClass(this.pk,e.LQj);this.pk.appendChild(this.wfa);this.wfa.tabIndex=0;this.JDc();d.a.addHandler(this.pk,"click",this.IIc);d.a.addHandler(this.pk,"keyup",Object(f.a)(this,this.U$a,"onTitleKeyUp"))}get jc(){return this.pk}get title(){return this.Bp}get isActive(){return Sys.UI.DomElement.containsCssClass(this.pk,e.QXd)}set isActive(w){this.setActive(w)}dispose(){d.a.removeHandler(this.pk,"keyup",Object(f.a)(this,this.U$a,
"onTitleKeyUp"));d.a.removeHandler(this.pk,"click",this.IIc);this.pk=this.wfa=null}setActive(w){w?Sys.UI.DomElement.addCssClass(this.pk,e.QXd):Sys.UI.DomElement.removeCssClass(this.pk,e.QXd);this.wfa&&this.wfa.setAttribute(l.a.U9,w)}U$a(w){w.keyCode!==h.a.Lh&&w.keyCode!==h.a.Kea||this.IIc(w)}JDc(){this.pk.setAttribute(l.a.Cd,l.a.sq);this.wfa.setAttribute(l.a.Vu,this.Bp);this.wfa.setAttribute(l.a.Cd,l.a.upb)}}Object(r.a)(t,"TabTitleControl",null,[2]);var n=a(40);a.d(F,"a",function(){return z});class z{constructor(w,
m=null,u=null){this.Smb=this.$mb=null;this.$0=-1;this.pk=w;this.mga=m||new c.a;this.YEg=u||new b;this.nFa=new c.a;w=0;for(let y of this.mga)this.aud(this.$0)||(this.$0=w),m=w++,this.nFa.add(new t(document.createElement("li"),y.title,this.fdh(m)))}get EBc(){return this.mga.count}get activeTab(){return this.$0}set activeTab(w){this.tdg(w)}get jc(){return this.pk}get visible(){return n.a.isVisible(this.pk)}set visible(w){this.pk.style.visibility=w?"visible":"hidden"}mXf(){this.$mb=document.createElement("ul");
this.$mb.className=e.NQj;this.Smb=document.createElement("div");this.Smb.className=e.eRj;for(let w=0;w<this.EBc;++w){const m=this.mga.ma(w),u=this.nFa.ma(w);m.set_visible(!1);u.isActive=!1;const y=document.createElement("div");m.render(y);this.Smb.appendChild(y);this.$mb.appendChild(u.jc)}this.jc.appendChild(this.$mb);this.jc.appendChild(this.Smb);this.aud(this.$0)&&(this.nFa.ma(this.$0).isActive=!0,this.mga.ma(this.$0).set_visible(!0))}dispose(){for(let w=0;w<this.EBc;++w)this.mga.ma(w).dispose(),
this.nFa.ma(w).dispose();this.nFa=this.mga=this.pk=this.Smb=this.$mb=null}setFocus(){this.mga.ma(this.$0).setFocus()}aud(w){return 0<=w&&w<this.EBc}tdg(w){this.$0!==w&&this.aud(w)&&(this.YEg.qQj(this.mga.ma(this.$0),this.mga.ma(w)),this.nFa.ma(this.$0).isActive=!1,this.nFa.ma(w).isActive=!0,this.$0=w,this.setFocus())}fdh(w){return()=>{this.tdg(w)}}}Object(r.a)(z,"MultitabControl",null,[371,2])},1274:function(r,F,a){var c=a(9);r=a(0);var b=a(7),e=a(226),f=a(50),d=a(37),h=a(1);class l{constructor(){this.isFeedbackAllowed=
!1;this.zoomLevel=0}}Object(r.a)(l,"FormulaAssistanceUIContext",null,[]);var k=a(204),t=a(187),n=a(105);class z extends e.a{constructor(m){super();this.Etj="formulaAssistance";this.$=m;this.Db()}create(){let m=this.$.da.Aa(448);if(m)this.nb(m);else{var u=h.EwaSettings.isChangeGateEnabled("OfficeVSO:7457857_DynamicScriptLoaderNewService")?k.c(t.a.resolve(n.e,{Tl:this.Xa})):f.GetServiceTaskFactory.Oa(this.$.da,283,284,this.Xa);d.TaskExtensions.za(u,()=>{d.TaskExtensions.za(k.c(u.result.Hl.loadScript(this.Etj)),
()=>{m=this.$.da.Aa(448);if(!m){const y=Object(b.a)(new l,{isFeedbackAllowed:this.$.isFeedbackEnabled});m=this.$.da.Ha(448,formulaAssistance.FormulaAssistanceUIFactoryGlobal.create(y));this.$.XBe(()=>{const v={};v.isFeedbackAllowed=this.$.isFeedbackEnabled;m.updateContext(v)})}this.nb(m)},this.$.la,3)},this.$.la,3)}}static ka(m){m.da.Ha(449,new z(m))}}Object(r.a)(z,"FormulaAssistanceUIControlFactory",e.a,[]);a.d(F,"a",function(){return w});const w=()=>{c.a.Fa(m=>{z.ka(m)})}},1275:function(r,F,a){var c=
a(9);r=a(0);var b=a(55),e=a(226),f=a(50),d=a(37),h=a(21),l=a(15),k=a(31),t=a(195),n=a(24),z=a(65),w=a(1),m=a(1109),u=a(11),y=a(159),v=a(14),C=a(181),x=a(227),B=a(152),H=a(64),I=a(90);class U{constructor(D,E,N){this.FNa=1;this.o9=[];this.active=!1;this.htmlSanitizationHelper=null;this.cBb=!1;this.onPointerDown=M=>{B.a.slim(M.Ea.rawEvent);return!1};this.Ew=()=>{const M=this.gridView.Djd();if(!(0>=M||M===this.FNa||this.gridView.Cr)){var L=!1,aa=[],V=[];for(var P=this.o9.length-1;0<=P;P--){var ba=this.o9[P];
if(this.Cjd(ba)>M||ba.bottom<M)aa.push(ba),this.o9.splice(P,1),L=!0}for(P=this.tableManager.rangeList.length-1;0<=P;P--){ba=this.tableManager.rangeList[P];const Y=this.Cjd(ba);Y<=M&&ba.bottom>=M&&!(Y<=this.FNa&&ba.bottom>=this.FNa)&&ba.dka&&(V.push(ba),L=!0)}if(L){ba=this.gridView.nrc;for(let Y of ba)for(let Z of Y)for(let ea of Z)this.cBb?this.$3g(ea,aa,V):this.a4g(ea,aa,V,L)}else l.ULS.sendTraceTag(537157657,0,50,"HeaderSnappingFeature:OnVisibleAreaChanged: detected an opportunity for bailing out");
this.FNa=M}};this.fEf=(M,L)=>{L.isRow||L.ZXc(this.Sec)};this.gEf=(M,L)=>{L.isRow||(this.tableManager.rangeList.length||this.deactivate(),L.zMd(this.Sec))};this.Sec=(M,L)=>{if(this.Pd())this.activate();else if(M=this.active,this.deactivate(),!M){l.ULS.sendTraceTag(537157652,0,50,"HeaderSnappingFeature:HeaderBlockOnUpdatedBlock: detected an opportunity for bailing out");return}(L=L.Nn)&&this.Kag(L.q4,L)};this.QGf=(M,L)=>{!this.gridView.Cr&&(this.Pd()?this.activate():(M=this.active,this.deactivate(),
M||l.ULS.sendTraceTag(537157651,0,50,"HeaderSnappingFeature:OnRangeListUpdated: detected an opportunity for bailing out")),L=L.Nn)&&(M=m.a(L.q4),this.Kag(M,L)&&L.IRd(M))};this.Ud=()=>{this.gridView.ib.o4?this.deactivate():this.activate()};this.tableManager=D;this.gridView=E;this.$=E.$;this.htmlSanitizationHelper=N;D.JXc(this.QGf);E.$Mg(this.fEf);E.aNg(this.gEf);this.$.va.Vf(this.Ud);this.$.yb.Vf(this.Ud);this.Xue(M=>{M.ZXc(this.Sec)});this.cBb=this.gridView.uba;this.Pd()&&(this.activate(),this.Ew(this,
null));this.$.da.Ha(68,this)}dispose(){this.deactivate();this.gridView&&(this.tableManager.nMd(this.QGf),this.gridView.fkj(this.fEf),this.gridView.gkj(this.gEf),this.$.va.sg(this.Ud),this.$.yb.sg(this.Ud),this.Xue(D=>{D.zMd(this.Sec)}));this.gridView=this.tableManager=this.o9=null}zCc(D,E,N){if(!z.b(this.$.na)||this.$.ea.isNamedObjectViewMode||this.gridView.ib.EBa)return!0;const M=N.N8e();var L=M.length;if(M[L-1]<D.left)return!1;var aa=u.HelperMethods.Xu(new t.a(M),0,L,D.left,u.HelperMethods.sz);
if(0>aa)return!1;const V=D.KYd,P=D.ZUg;L=Math.min(V.length+aa,L);let ba=0;for(;aa<L;aa++){const Y=M[aa];E?(N.updateCellText(aa,V[ba]),N.activateCellAutoFilter(aa,P[ba]),this.fpe(D,ba,Y)):(N.updateCellText(aa,n.Range.BP(Y)),N.deactivateCellAutoFilter(aa),this.cOe(Y));E&&N.tzj();ba++}N.Vm("HeaderSnappingFeature::toggleHeaderSnapping");D.bBa=E;return!0}ACc(D,E,N,M){if(!z.b(this.$.na)||this.$.ea.isNamedObjectViewMode||this.gridView.ib.EBa)return!0;if(!N.length)return!1;var L=M.length;if(M[L-1]<D.left)return!1;
var aa=u.HelperMethods.Xu(new t.a(M),0,L,D.left,u.HelperMethods.sz);if(0>aa)return!1;const V=D.KYd,P=!!D.Csa&&0<D.Csa.length,ba=!!D.menuModel&&0<D.menuModel.length;for(let ea=aa,ra=0,O=Math.min(V.length+aa,L);ea<O;ea++,ra++)if(L=N[ea]){var Y=null;(aa=L.getElementsByClassName(k.a.jbd))&&(Y=aa[0]);if(Y&&Y.innerText){if(aa=L.getElementsByClassName(k.a.Gse))for(var Z=aa.length-1;0<=Z;Z--)L.removeChild(aa[Z]);aa=M[ea];E?(Y.innerText=V[ra],L.classList.add(k.a.oVe),P&&D.Csa[ra]&&(Y=document.createElement("div"),
w.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&w.EwaSettings.isChangeGateEnabled("OfficeVSO:7126100_ReduceInnerHTMLUsageForHeaderSnappingFeature")&&this.htmlSanitizationHelper?(this.htmlSanitizationHelper.Rh(Y,D.Csa[ra]),Z=D.Csa[ra].split(H.a.ARg),l.ULS.shipAssertTag(509678873,0,3===Z.length,"HeaderSnappingFeature.toggleHeaderSnappingHtml: buttonHtml doesn't contain command data for ShowAutoFilterMenu"),Z=I.a.kf(Z[1]),this.BIg(Y.firstChild,Z),y.a.instance.ta(v.a.pf,Y.firstChild,
this.onPointerDown),C.a.instance.ta(v.a.lp,Y.firstChild,this.onPointerDown)):Y.innerHTML=D.Csa[ra],ba&&D.menuModel[ra]&&this.fpe(D,ra,aa),L.appendChild(Y.firstChild))):(L.classList.remove(k.a.oVe),Y.textContent=n.Range.BP(aa),this.cOe(aa))}}D.bBa=E;return!0}BIg(D,E){x.a.instance.ta(v.a.click,D,N=>{E&&B.a.hrc(N.Ea.rawEvent,966232027,E,this.$.get_id());return!0})}fpe(D,E,N){this.$.da.gb(8,M=>{M.Z$b.XUi(D,E,N)})}cOe(D){this.$.da.gb(8,E=>{E.Z$b.YUi(D)})}a4g(D,E,N,M){const L=D.qt,aa=m.a(D.q4);let V;for(let P=
E.length-1;0<=P;P--)V=E[P],this.ACc(V,!1,aa,L)&&E.splice(P,1);for(E=N.length-1;0<=E;E--)V=N[E],this.ACc(V,!0,aa,L)&&this.o9.push(V);M&&D.IRd(aa)}$3g(D,E,N){if(D.c1g()){for(var M=E.length-1;0<=M;M--)this.zCc(E[M],!1,D)&&E.splice(M,1);for(E=N.length-1;0<=E;E--)M=N[E],this.zCc(M,!0,D)&&this.o9.push(M)}}Kag(D,E){const N=this.cBb?E.N8e():E.qt;var M=N[0];const L=N[N.length-1],aa=this.$5h(M,L);let V=!1;for(let P=this.o9.length-1;0<=P;P--){const ba=this.o9[P];L>=ba.left&&M<=ba.right&&(this.cBb?this.zCc(ba,
!1,E):this.ACc(ba,!1,D,N),this.o9.splice(P,1),V=!0)}for(let P=0,ba=aa.length;P<ba;P++)if(M=aa[P],this.cBb?this.zCc(M,!0,E):this.ACc(M,!0,D,N))this.o9.push(aa[P]),V=!0;return V}activate(){this.Pd()&&!this.active&&(this.gridView.view.Ps(this.Ew),this.active=!0)}deactivate(){this.active&&(this.gridView.view.Mq(this.Ew),this.active=!1)}Pd(){return z.b(this.$.na)&&!this.$.ea.isNamedObjectViewMode&&0>=this.gridView.ib.GO&&0<this.tableManager.rangeList.length}Xue(D){const E=this.gridView.nrc;for(let N of E)for(let M of N)for(let L of M)D(L)}$5h(D,
E){const N=[];if(!this.active)return N;this.FNa=this.gridView.Djd();for(let M=this.tableManager.rangeList.length-1;0<=M;M--){const L=this.tableManager.rangeList[M];L.bottom>=this.FNa&&this.Cjd(L)<=this.FNa&&L.left>=D&&L.right<=E&&L.dka&&N.push(L)}return N}Cjd(D){const E=this.gridView.tb.Dh(D);return E&&this.tableManager.ejf(D,E.usedRange.topLeft)?D.top+1:D.top}}Object(r.a)(U,"HeaderSnappingFeature",null,[2]);class S extends e.a{constructor(D){super();this.$=D;this.Db()}create(){const D=f.GetServiceTaskFactory.create(this.$.da,
134,this.la,this.Xa),E=w.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&w.EwaSettings.isChangeGateEnabled("OfficeVSO:7126100_ReduceInnerHTMLUsageForHeaderSnappingFeature")?f.GetServiceTaskFactory.Oa(this.$.da,498,499,this.Xa):b.Task.Sa(null);d.TaskExtensions.za(d.TaskExtensions.Fd([E],this.la),()=>{d.TaskExtensions.za(d.TaskExtensions.Fd([D],this.la),()=>{this.nb(this.$.da.Aa(68)||new U(D.result,h.h(this.$),E.result))},this.la,11)},this.la,3)}static ka(D){D.da.Ha(67,new S(D))}}
Object(r.a)(S,"HeaderSnappingFactory",e.a,[]);a.d(F,"a",function(){return G});const G=()=>{c.a.Fa(S.ka)}},1299:function(r,F,a){var c=a(9);r=a(0);var b=a(15),e=a(892),f=a(27),d=a(202),h=a(226),l=a(230),k=a(1),t=a(52),n=a(55),z=a(204),w=a(33),m=a(187),u=a(105);class y extends h.a{constructor(C){super();this.$=C;this.g6b=null;this.Db()}create(){b.ULS.sendTraceTag(537154643,0,50,"PluginSchedulerFactory.Create: Loading scheduler slice");e.a.then(this.Mfh(),C=>{this.nb(C)})}Mfh(){if(this.g6b)return this.g6b;
const C=l.a.m1a(t.b(),d.a.none,"LoadResource","x10Scheduler loading");if(k.EwaSettings.isChangeGateEnabled("OfficeVSO:5789323_disableSchedulerForIE")&&f.a.sw){const x=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance();this.$.da.Ha(413,x);C.setResult(x);return this.g6b=C.task}(k.EwaSettings.dK()?x=>m.a.resolve(u.b,{Tl:this.Xa}).then(B=>setTimeout(()=>x(B),0)):x=>this.$.da.gb(266,x))(()=>{this.FAi(x=>{const B=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance();x=z.b(n.Task.Sa(x.Hl));Promise.all([excelOnlineCalc.x10.ensureGroupAttached(x,
0),w.a.Lpb(this.$)?excelOnlineCalc.x10.ensureGroupAttached(x,2):0]).then(H=>H.some(I=>0<I)).then(H=>{this.$.da.Ha(413,B);C.setResult(B);k.EwaSettings.isChangeGateEnabled("OfficeVSO:7445021_LogAnyPluginInitialized")&&this.$.da.gb(491,I=>{I.QR.anyPluginInitialized=H})})})});return this.g6b=C.task}FAi(C){k.EwaSettings.isChangeGateEnabled("OfficeVSO:7457857_DynamicScriptLoaderNewService")?void m.a.resolve(u.e,{Tl:this.Xa}).then(x=>C(x)):this.$.da.gb(283,C)}static ka(C){C.da.Ha(414,new y(C))}}Object(r.a)(y,
"PluginSchedulerFactory",h.a,[]);a.d(F,"a",function(){return v});const v=()=>{c.a.Fa(C=>{y.ka(C)})}},1300:function(r,F,a){var c=a(9);r=a(0);var b=a(226),e=a(712),f=a(50),d=a(37),h=a(187),l=a(1),k=a(105);class t extends b.a{constructor(z){super();this.$=z;this.Db()}static ka(z){z.da.Ha(521,new t(z))}create(){const z=()=>excelOnlineCalc.FormulaAuthoringHelperSingletonGlobal.instance();l.EwaSettings.dK()?void h.a.resolve(k.g).then(()=>{this.nb(z())}):d.TaskExtensions.za(f.GetServiceTaskFactory.Oa(this.$.da,
266,265,0),()=>{this.nb(Object(e.a)(this.$.da,520,z))},this.$.la,3)}}Object(r.a)(t,"FormulaAuthoringHelperFactory",b.a,[]);a.d(F,"a",function(){return n});const n=()=>{c.a.Fa(z=>{t.ka(z)})}},1464:function(r,F,a){a.r(F);var c={};a.r(c);a.d(c,"AutoSumCommandHandler",function(){return L});var b=a(1099),e=a(0),f=a(709),d=a(161),h=a(15),l=a(182),k=a(60);const t=(Ob,Kc,Ac,Yc,td,$d)=>{if(Kc){const be=Ob.textBox;Ob.fb||Ob.startEdit(Kc,!0);Ob.ksd=!0;Ob.text=Ac;be.caretPosition=td;td<$d&&(Yc&&Ob.dBa(),be.selectRange(0,
$d+1),be.selectRange(td,$d))}};var n=a(68);class z{constructor(Ob,Kc){this.sharedSheetRange=null;this.type=0;this.sharedSheetRange=Ob;this.type=Kc}V4a(){return this.sharedSheetRange}}Object(e.a)(z,"MacroRecorderAutoSumPayload",null,[162]);var w=a(41),m=a(376),u=a(193),y=a(50),v=a(37),C=a(157),x=a(347),B=a(29),H=a(1),I=a(189),U=a(282),S=a(21),G=a(129),D=a(566),E=a(55),N=a(105),M=a(187);let L=class extends l.a{constructor(Ob){super();this.wOi=Kc=>{const Ac=S.h(this.$);if(Kc=Kc.Result){let Yc=w.D(Kc.NewSelection),
td=w.D(Kc.NewActiveCell);if(Yc&&td)if(!Kc.Committed&&Kc.AutoSumFormula){const $d=Ac.Pb(td);$d&&(Ac.ha.updateSelection(Yc,td,60),Yc=td=w.D(Kc.MarkedArea),Ac.AJ=2,t(Ac.mc,$d,Kc.AutoSumFormula,!!Yc,Kc.FormulaMarkStart,Kc.FormulaMarkEnd),Yc&&td&&Ac.ha.updateSelection(Yc,td,0),Ac.mc.ksd=!1,v.TaskExtensions.za(y.GetServiceTaskFactory.create(this.$.da,153,this.la,0),be=>{be.result.eJa(null)},this.la,3))}else Ac.ha.updateSelection(Yc,td,60)}};this.$=Ob}Hc(){return!1}executeCommand(Ob,Kc,Ac){Ob=Kc.command;
switch(Ob){case 1220954656:case 505713221:Kc=this.eNe(0,Kc);break;case -1537138325:Kc=this.eNe(parseInt(Ac[n.a.Kc].toString(),10),Kc);break;default:Kc=I.a(Ob)}return Kc}wc(Ob,Kc){if(Ob=1===Ob)switch(Kc.command){case 1220954656:case 505713221:case -1537138325:break;default:Ob=!1}return Ob}Nc(){return!1}eNe(Ob,Kc){const Ac=S.h(this.$);Ac.Gg.iM(!1);if(!S.h(this.$).ha.qa.Tg)return Kc=S.h(this.$).ha.qa.gD,h.ULS.sendTraceTag(537170308,0,50,`AutoSumCommandHandler.DoAutoSum: Unhandled AutoSum of type ${Ob} due to discontinuous selection. Number of selected ranges is ${Kc}`),
this.kza(),E.Task.Sa(!1);const Yc=Ac.VE();if(!Yc)return null;const td=w.v(Ac.ha.qa.ld,this.$),$d=w.o(Ac.ha.qa.activeCell,this.$),be=w.o(Yc,this.$),ke=this.$.oa.xa.Wb(),Pe=()=>new z(td,Ob);return this.$.Us(Ac.ha.qa.selectedRanges,!0)?m.a(this.$.userOperationManager,(Dd,ge,ne)=>{var ce=this.$.oa.xa;Dd=U.b(Dd,this.wOi);const we=ce.Na(9,ke);we.selectedRange=td;we.activeCell=$d;we.autoSumType=Ob;we.topLeftCell=be;return k.g(ce,"AutoSum",we,Dd,ge,ne,Ob,0)},Dd=>new u.a(502,0,Dd,64,Pe),Kc):E.Task.Sa(!1)}kza(){D.a(G.a.discontinuousSelectionBlocking,
["OtherICE"],!0,!0,!1,!1,null);var Ob=B.a.ed(1,1,750,2191,0,371863010,"DiscontinuousSelectionBlocking");H.EwaSettings.mz()?new x.a(this.$,Ob):(Ob=new C.ErrorDialog(this.$,Ob),Ob.initialize(),Ob.kg())}};L=Object(d.b)([Object(M.d)(N.a),Object(d.c)(0,Object(N.f)())],L);Object(e.a)(L,"AutoSumCommandHandler",l.a,[222]);class aa extends f.a{constructor(Ob){super(Ob)}hd(){this.$c([new L(this.$)])}static ka(Ob){f.a.Md(96,new aa(Ob))}}Object(e.a)(aa,"AutoSumCommandHandlerFactory",f.a,[]);var V=a(9);String(c);
window.___1676210801599_closurehack=c;var P=a(174),ba=a(268),Y=a(38),Z=a(323),ea=a(1100),ra=a(249),O=a(66);class da extends Y.a{constructor(Ob,Kc,Ac){super();this.HPi=(Yc,td)=>{if(!ra.a(Yc)&&td){const $d=!!Yc&&!!Yc.RequestTelemetryData;S.h(this.$).wh.Fla(td.toString(),Yc.StateId,$d?Yc.RequestTelemetryData.EcsOperationDuration:0,$d?Yc.RequestTelemetryData.EcsRequestDuration:0,$d?Yc.RequestTelemetryData.WfeRequestDuration:0)}};this.$=Ob;this.tableManager=Kc;this.Nh=Ac}cMg(Ob){this.addHandler("ekcvc",
Ob)}qjj(Ob){this.removeHandler("ekcvc",Ob)}Hc(){return!1}executeCommand(Ob,Kc){Ob=Kc.command;switch(Ob){case -730106152:Kc=this.ukd(Kc,3);break;case -1228228458:Kc=this.ukd(Kc,4);break;case -848953656:case 2045211913:if(this.ysi()){Kc=E.Task.Sa(!0);break}Kc=this.ukd(Kc,1);break;default:Kc=I.a(Ob)}return Kc}wc(Ob,Kc){if(Ob=1===Ob)switch(Kc.command){case -730106152:case -1228228458:case -848953656:case 2045211913:break;default:Ob=!1}return Ob}Nc(){return!1}ukd(Ob,Kc){const Ac=S.h(this.$),Yc=Ac.ha.qa.selectedRanges,
td=Ob.command,$d=P.a.create().toString();if(!this.$.Us(Yc,!0)&&-730106152!==td)return E.Task.Sa(!0);const be=w.r(Yc,this.$);this.tJj(td,Ac,Yc,$d);H.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&this.Oaj();const ke=this.$.oa.xa.Wb({Dla:!0,vka:1}),Pe=()=>new ea.a(Kc,be);return m.a(this.$.userOperationManager,(Dd,ge,ne)=>{this.$.py();return k.d(this.$.oa.xa,Kc,be,!1,U.b(Dd,this.HPi),ge,ne,$d,ke)},Dd=>new u.a(508,0,Dd,67,Pe),Ob)}tJj(Ob,Kc,Ac,Yc){if(-848953656!==
Ob&&2045211913!==Ob&&-730106152!==Ob&&-1228228458!==Ob)h.ULS.sendTraceTag(537167938,0,10,`ClearCommandHandler.ShowInstantaneousClear: Unexpected command ${Ob}.`);else if(!ba.a.any(Ac,$d=>0<Kc.getRangeInformation($d).length)){var td=ba.a.any(Ac,$d=>this.tableManager.ytd($d));if(-730106152!==Ob&&-1228228458!==Ob||!td)this.sNj(Kc,Ob,Yc,Ac),-730106152!==Ob&&-1228228458!==Ob||this.Nh.$da(Kc,-730106152,{}),-1228228458!==Ob&&2045211913!==Ob&&-848953656!==Ob||this.Nh.n5g(Ac,Yc),Kc.wh.$R(Yc,O.BasicTelemetryCalculator.HQ)}}sNj(Ob,
Kc,Ac,Yc){let td="";switch(Kc){case -1228228458:td="ClearAll";break;case 2045211913:case -848953656:td="ClearContent";break;case -730106152:td="ClearFormat";break;default:h.ULS.sendTraceTag(537167937,0,15,`ClearCommandHandler.StampTimeWithCompatibleDescription: Unexpected command ${Kc}.`)}Kc=Yc.length;Yc=w.b(Yc);Ob.wh.z0(15,Ac,td+(", ranges to clear: "+Kc+", cells to clear: "+Yc))}Oaj(){this.raiseEvent("ekcvc",new Z.a)}ysi(){if(S.h(this.$).ez){const Ob=this.$.da.Aa(296);return!!Ob&&Ob.pU.$A}return!1}}
Object(e.a)(da,"ClearCommandHandler",Y.a,[222,562]);class xa extends f.a{constructor(Ob){super(Ob)}hd(){const Ob=y.GetServiceTaskFactory.create(this.$.da,134,this.la,this.Xa),Kc=y.GetServiceTaskFactory.create(this.$.da,18,this.la,this.Xa);v.TaskExtensions.za(v.TaskExtensions.Fd([Ob,Kc],this.la),()=>{const Ac=new da(this.$,Ob.result,Kc.result);this.$c([Ac]);this.$.da.Ha(313,Ac)},this.la,3)}static ka(Ob){f.a.Md(101,new xa(Ob))}}Object(e.a)(xa,"ClearCommandHandlerFactory",f.a,[]);var ia=a(1250),Ma=a(1101),
Ta=a(1163),Da=a(1103),fa=a(1104),ua=a(1174),Fa=a(89),ca=a(226),ka=a(4),Ca=a(108),fb=a(46),yb=a(11),mb=a(85),nb=a(150);class X{}X.HTML='<div id="WACDialogRow" class="WACDialogRow">\r\n\t\t\t\t\t<div id="WACDialogIconPanel" class="WACDialogIconPanel"></div>\r\n\t\t\t\t\t<div id="WACDialogTextPanel" class="WACDialogTextPanel" style="padding-right: 30px;">\r\n\t\t\t\t\t\t<div id="WACDialogErrorMessage"></div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorReportMessage"> </div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorTextPrompt" ></div> \r\n\t\t\t\t\t\t<textarea id="WACDialogInput" class="WACDialogInput" rows="5" style="margin-bottom: 10px; margin-top: 9px; overflow: auto;" maxlength="256"></textarea>\r\n\t\t\t\t\t\t<div id = "WACDialogSendFileCheckboxContainer" class="WACDialogRow" >\r\n\t\t\t\t\t\t<input type="checkbox" id="WACDialogSendFileCheckbox">\r\n\t\t\t\t\t\t<span id="WACDialogSendFileCheckboxText">text</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<a id="WACDialogPrivacyText"> </a> \r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>';
Object(e.a)(X,"FileUploadDialogHTML",null,[]);var R=a(156),wa=a(25);class na extends nb.a{constructor(Ob){super(!1,!1,na.Iu);this.Yxd=!1;this.quf=!0;this.ztf=0;this.Ob=1;this.tc(1,CommonUIStrings.l_Send);this.tc(0,CommonUIStrings.l_NoThanks);this.og=X.HTML;this.stf=Ob;this.pe=na.G_g}kj(Ob,Kc,Ac,Yc=!1,td=!0){this.Yxd=Yc;this.DIj(Kc);this.ztf=Ob;td&&ka.AFrameworkApplication.CF(Ob)}DIj(Ob){if(na.Iu)this.lKj(Ob);else{var Kc={};Kc[na.C_g]=Ob;Kc[na.I_g]=CommonUIStrings.l_SendFileErrorReportMessage;Kc[na.J_g]=
CommonUIStrings.l_SendFileErrorReportTextCaption;Kc[na.C0c]="";Kc[na.F_g]=CommonUIStrings.l_UserReportLinkText;Kc[na.F2b]=!0;this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,Object(mb.a)(this,this.Jzi,"legacyDialogHandler"),Kc);this.EW(na.O_g)}}lKj(Ob){Ob={["id"]:this.pe,["bodyControls"]:{["reportErrorCheckboxProps"]:this.Yxd?{["label"]:CommonUIStrings.l_UserReportLinkText}:null,["textAreaProps"]:this.quf?{}:null,["privacyStatementLinkProps"]:{["text"]:CommonUIStrings.l_PrivacyStatement,
["handler"]:{["href"]:ka.AFrameworkApplication.Kma,["target"]:"_blank"}}},["errorMessage"]:Ob,["errorReportMessage"]:CommonUIStrings.l_SendFileErrorReportMessage,["errorTextPrompt"]:CommonUIStrings.l_SendFileErrorReportTextCaption};this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,Object(mb.a)(this,this.uJd,"reactDialogHandler"),Ob)}z$a(){if(!na.Iu){var Ob=document.getElementById(na.L_g);Ob&&(Ob.className=na.K_g,Ob.appendChild(R.createClusteredImage(32,32,na.H_g,null,!0,CommonUIStrings.l_DialogError)));
if(Ob=document.getElementById(na.M_g))Ob.innerText=CommonUIStrings.l_PrivacyStatement,Ob.href=ka.AFrameworkApplication.Kma,fb.a.addHandler(Ob,"click",Object(mb.a)(this,this.gYi,"onPrivacyClickHandler"));this.quf||(Ob=document.getElementById(na.C0c))&&Ob.parentNode&&Ob.parentNode.removeChild(Ob);this.Yxd||(Ob=document.getElementById(na.E_g))&&Ob.parentNode&&Ob.parentNode.removeChild(Ob)}}CD(){na.Iu||(super.CD(),document.getElementById(this.Fh("WACDialogPanel")).style.width=String.format("{0}px",400))}Jzi(Ob,
Kc){const Ac=Kc[na.C0c]||"";let Yc=!0;void 0!==Kc[na.F2b]&&null!==Kc[na.F2b]&&(Yc=Kc[na.F2b]);this.iu(Ob,Ac,Yc)}uJd(Ob,Kc){this.iu(Ob,Kc.text||"",Kc.reportErrorChecked)}iu(Ob,Kc,Ac){this.stf&&(Ac&&h.ULS.sendTraceTag(5768786,306,50,"Error Report sent for errorCode:{0}",this.ztf),this.stf(Ob,Kc,Ac))}gYi(Ob){ka.AFrameworkApplication.rb.Vd(wa.a.CIb,2,Ob)}get qY(){return!1}static get Iu(){return ka.AFrameworkApplication.sa.Qa.tv&&ka.AFrameworkApplication.sa.Qa.$si}}na.C_g="WACDialogErrorMessage";na.I_g=
"WACDialogErrorReportMessage";na.J_g="WACDialogErrorTextPrompt";na.C0c="WACDialogInput";na.M_g="WACDialogPrivacyText";na.L_g="WACDialogIconPanel";na.H_g="CancelRequest_32x32x32";na.K_g="WACDialogIcon";na.O_g="WACDialogTextPanel";na.F2b="WACDialogSendFileCheckbox";na.E_g="WACDialogSendFileCheckboxContainer";na.F_g="WACDialogSendFileCheckboxText";na.G_g="FileUploadErrorDialog";Object(e.a)(na,"FileUploadErrorDialog",nb.a,[]);class Ba extends Y.a{constructor(Ob){super();this.KOf=0;this.UG=null;this.jij=
Kc=>{this.Ajj(Kc)};this.D6g=(Kc,Ac)=>{if(1===Kc&&this.UG.FileCollectionErrorStateId){Kc=this.$.oa.xa;var Yc=this.UG.MessageId,td=this.UG.OriginalEcsServerId,$d=this.UG.FileCollectionErrorStateId;const be=Kc.Na(0);be.errorMessageId=Yc;be.ecsServerId=td;be.fileCollectionErrorStateId=$d;be.userComment=Ac;Kc.S0c("CollectFile",be,null,null,null,null,0)}this.raiseEvent("fileCollectionComplete",null,this)};this.$=Ob}nMg(Ob){this.addHandler("fileCollectionComplete",Ob)}Ajj(Ob){this.removeHandler("fileCollectionComplete",
Ob)}C6g(Ob,Kc,Ac){this.KOf=Kc;this.UG=Ob;this.nMg(Ac);ka.AFrameworkApplication.Kma=this.$.workbookContext.FullDocumentInfo.PrivacyUrl;Ob=new na(this.D6g);ka.AFrameworkApplication.rb.Nb(wa.a.CIb,Ca.a.frame,Ba.t9i);Ob.kj(0,"",null,!1,!1)}static t9i(Ob,Kc,Ac,Yc,td){fb.a.du(td);ka.AFrameworkApplication.Kma&&yb.HelperMethods.gf(ka.AFrameworkApplication.Kma,void 0,void 0,"FileCollectionOperation.PrivacyUrl");return 32}}Object(e.a)(Ba,"FileCollectionOperation",Y.a,[565,2]);class Ra extends ca.a{constructor(Ob){super();
this.NTb=null;this.$=Ob;this.Db()}get OFh(){return this.NTb||(this.NTb=new Ba(this.$))}create(){v.TaskExtensions.za(y.GetServiceTaskFactory.create(this.$.da,155,this.la,this.Xa),()=>{this.nb(this.OFh)},this.la,3)}dispose(){Fa.a.Ja(this.NTb);this.NTb=null;super.dispose()}static ka(Ob){Ob.da.Ha(125,new Ra(Ob))}}Object(e.a)(Ra,"FileCollectionCommandHandlerFactory",ca.a,[]);var qa=a(1177),La=a(1107),Yb=a(1274),mc=a(7),Zb=a(653);class qb{}Object(e.a)(qb,"FreezePanesCommandParameters",null,[]);var Ha=a(8),
Ya=a(188),Gb=a(24),Ja=a(392),Na=a(28),Qa=a(272),Oa=a(274),bb=a(116);const Ga=(Ob,Kc,Ac,Yc,td,$d,be=null)=>{be=Ob.Na(9,be);be.freezeSettings=Kc;return k.g(Ob,"FreezeOrUnfreezePanes",be,Ac,Yc,td,$d,0)};class tb{constructor(Ob){this.freezeOptions=null;this.freezeOptions=Ob}getSheetName(){return this.freezeOptions.SheetName}}Object(e.a)(tb,"MacroRecorderSheetPaneFrozenPayload",null,[162]);var wb=a(45);class lb{constructor(Ob,Kc){this.$ac=this.xId=null;this.lDf=()=>{H.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnfreezeViewportAdjustLocation",
!1)||this.Ovc();if(this.$ac){const Ac=Qa.a(Na.a.Ya.ue,this.$ac);h.ULS.sendTraceTag(570949840,5,50,`FreezePanesCommandHandler.OnFreezePanesUpdateCompleted: duration of FreezePane from operation until allBlockUpdated: ${Ac}`);this.$ac=null}this.SKf()};this.$=Ob;this.gridView=S.h(Ob);this.bD=Kc.Rsb(this.$.domElement,500,null,null);this.hLa=this.gLa=-1}Hc(Ob,Kc){let Ac=!1;switch(Kc){case 1844679312:Ac=1!==Ob&&!this.gridView.ib.o4}return Ac}executeCommand(Ob,Kc){Ob=this.gridView.ib;const Ac=this.gridView.Tjd();
ka.AFrameworkApplication.sa.Qa.vw&&this.$.WZ&&(1844679312===Kc.command||340334732===Kc.command||-806625837===Kc.command)&&Zb.ShyRibbon.fJ(1,2);switch(Kc.command){case 1844679312:return this.setFreezePanes(Kc,Ac,Ob.fj);case 340334732:return Ob.rac?E.Task.Sa(!1):this.lzj(Kc,Ac);case -806625837:return Ob.EBa?E.Task.Sa(!1):this.mzj(Kc,Ac)}return E.Task.Sa(!1)}wc(Ob,Kc){Ob=!1;switch(Kc.command){case 1844679312:case 340334732:case -806625837:case 1745254833:Ob=!0}return Ob}Nc(){return!1}setFreezePanes(Ob,
Kc,Ac){if(Ac)return this.xxc(Ob,!1,0,0,0,0,Kc,null);var Yc=this.gridView.ha.qa;Ac=Yc.activeCell.clone();Yc=Yc.activeRange;Yc.Rg&&(h.ULS.sendTraceTag(537159585,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a column. updating firstUnfreezeCell.Top (${Ac.top}) and firstUnfreezeCell.Bottom (${Ac.bottom}) to equal topLeftRange.Top (${Kc.top})`),Ac.top=Ac.bottom=Kc.top);Yc.isRow&&(h.ULS.sendTraceTag(537159584,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a row. updating firstUnfreezeCell.Left (${Ac.left}) and firstUnfreezeCell.Right (${Ac.right}) to equal topLeftRange.Left (${Kc.left})`),
Ac.left=Ac.right=Kc.left);Ac.top===Kc.top&&Ac.left===Kc.left&&(Ac=Gb.Range.Mc(Ac.top+1,Ac.left));Yc=Ac.top-1;const td=Ac.left-1,$d=Yc-(Kc.top-1),be=td-(Kc.left-1);return this.T4j(Ac,$d,be)?this.xxc(Ob,!0,Yc,td,$d,be,Kc,Ac):(this.$.qf(),this.SKf(),E.Task.Sa(!0))}lzj(Ob,Kc){return this.xxc(Ob,!0,0,Kc.left,0,1,Kc,null)}mzj(Ob,Kc){return this.xxc(Ob,!0,Kc.top,0,1,0,Kc,null)}T4j(Ob,Kc,Ac){const Yc=this.gridView.xg(Ob),td=this.gridView.view.visibleArea;return!Yc||td.topLeft.y>Yc.bottomRight.y||td.topLeft.x>
Yc.bottomRight.x||td.bottomRight.y<Yc.bottomRight.y||td.bottomRight.x<Yc.bottomRight.x?(h.ULS.sendTraceTag(537159583,0,50,`FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create freeze pane when active cell not in view, range=${Ob}, rangeViewportArea=${Yc?Yc.toString():"null"}, visibleArea=${td.toString()}`),Ob=B.a.ed(1,0,26,1490,0,2105967339,"FreezePaneSelectionNotInViewErr"),H.EwaSettings.mz()?new x.a(this.$,Ob):(Ob=new C.ErrorDialog(this.$,Ob),Ob.initialize(),Ob.kg()),!1):0>=
Kc&&0>=Ac?(h.ULS.sendTraceTag(537159582,0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create empty freeze pane"),Ob=S.h(this.$).rtl?1492:1491,Kc=S.h(this.$).rtl?-2131054257:-1953454131,Ob=B.a.ed(1,0,26,Ob,0,Kc,"FreezePaneA1SelectedErr"),H.EwaSettings.mz()?new x.a(this.$,Ob):(Ob=new C.ErrorDialog(this.$,Ob),Ob.initialize(),Ob.kg()),!1):!0}xxc(Ob,Kc,Ac,Yc,td,$d,be,ke){this.xId=wb.a(this.$).u9(5,"SendFreezePanesRequest","SendFreezePanesRequest");this.gridView.oT(this.lDf);this.bD.$Sa();
this.gridView.WNj(Kc?"":"UnsetFreezePane");this.JBj(Ob,Kc,this.gridView.ib);const Pe=Object(mc.a)(new qb,{SheetName:this.$.na.name,Freeze:Kc,FrozenRows:td,FrozenColumns:$d,FirstRow:Ac,FirstColumn:Yc});h.ULS.sendTraceTag(573101852,0,50,`FreezePanesCommandHandler.SendFreezePanesRequest: Freeze=${Kc}, FrozenRows=${td}, FrozenColumns=${$d}, FirstRow=${Ac}, FirstColumn=${Yc} `);const Dd=()=>new tb(Pe);this.$ac=Na.a.Ya.ue;return m.a(this.$.userOperationManager,(ge,ne,ce)=>{if(H.EwaSettings.ra(59)){var we=
window.performance;we.clearMarks();we.mark("FreezePanes request sent")}(we=this.gridView.Cp)?(we=this.Pth(Pe,we,be,ke),this.pVj(we)):this.$.py();return Ga(this.$.oa.xa,Pe,ge,ne,ce,Kc)},ge=>new u.a(151,0,ge,void 0,Dd),Ob)}Pth(Ob,Kc,Ac,Yc){h.ULS.shipAssertTag(537159580,1,!!Kc,"FreezePaneCommandHandler.EstimatePaneViewDataOnPaneRequest: called with null Sheet Processed Data");if(!Ob.Freeze)return null;const td=Oa.a();td.State=1;td.IsEstimated=!0;let $d=!1,be=!1;const ke=Kc.mQ(Gb.Range.Mc(Ac.top,Ac.left));
let Pe=Ob.FrozenRows;var Dd=Ob.FrozenColumns;1!==Ob.FrozenRows||Ob.FrozenColumns?Ob.FrozenRows||1!==Ob.FrozenColumns?(Dd=Kc.mQ(Gb.Range.Mc(Ob.FirstRow+1,Ob.FirstColumn+1)),Kc=Kc.mQ(Gb.Range.Mc(Ac.top,Ac.left)),td.Width=Dd.oj-ke.oj,td.Height=Dd.Dj-ke.Dj,0<Ob.FrozenRows&&(td.AbsoluteTop=Dd.Dj,be=!0),0<Ob.FrozenColumns&&(td.AbsoluteLeft=Dd.oj,$d=!0),Pe=Dd.TK-Kc.TK,Dd=Dd.jJ-Kc.jJ):(td.Width=Kc.wid(Ya.a.Mc(Ac.top,Ac.left)),Yc=Gb.Range.Mc(Ac.top,Ac.left+1),td.AbsoluteLeft=ke.oj+td.Width,$d=!0):(td.Height=
Kc.vid(Ya.a.Mc(Ac.top,Ac.left)),Yc=Gb.Range.Mc(Ac.top+1,Ac.left),td.AbsoluteTop=ke.Dj+td.Height,be=!0);be&&(td.FirstFrozenRow=Ac.top,td.FirstScrollableRow=Yc.top);$d&&(td.FirstFrozenColumn=Ac.left,td.FirstScrollableColumn=Yc.left);td.VisibleRows=Pe;td.VisibleColumns=Dd;return td}pVj(Ob){E.Task.delay(this.$.ya.GetRangeContentPrefetchDelayInMs).continueWith(()=>{this.$.na&&this.$.ea&&(this.$.ea.YW(Ha.a.oe,"FreezePaneCommandHandler.TriggerDelayActiveItemPaneChange"),Ja.b(this.$.na,Ob,-1,void 0,!0))})}JBj(Ob,
Kc,Ac){if(!H.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnfreezeViewportAdjustLocation",!1))switch(Ob.command){case 1844679312:if(Kc||-1===this.gLa&&-1===this.hLa)this.gLa=Ac.px-Ac.width+this.gridView.scrollLeft,this.hLa=Ac.qx-Ac.height+this.gridView.scrollTop;break;case 340334732:if(Kc||-1===this.gLa)this.gLa=Ac.px-Ac.width+this.gridView.scrollLeft;break;case -806625837:if(Kc||-1===this.hLa)this.hLa=Ac.qx-Ac.height+this.gridView.scrollTop}}Ovc(){const Ob=this.gridView.ib;0<Ob.width?
this.gridView.scrollLeft=bb.a.o2b(this.gridView.domElement,S.h(this.$).rtl,0):-1!==this.gLa&&(this.gridView.scrollLeft=this.gLa,this.gLa=-1);0<Ob.height?this.gridView.scrollTop=0:-1!==this.hLa&&(this.gridView.scrollTop=this.hLa,this.hLa=-1)}SKf(){this.bD.fTa();Fa.a.Ja(this.xId);this.xId=null;this.gridView.QN(this.lDf)}}Object(e.a)(lb,"FreezePanesCommandHandler",null,[222]);class db extends f.a{constructor(Ob){super(Ob)}hd(){v.TaskExtensions.za(y.GetServiceTaskFactory.Oa(this.$.da,12,477,this.Xa),
Ob=>{this.$c([new lb(this.$,Ob.result)])},this.$.la)}static ka(Ob){Ob.da.Ha(116,new db(Ob))}}Object(e.a)(db,"FreezePanesCommandHandlerFactory",f.a,[]);var Pa=a(1191),ja=a(27),Ka=a(562),ub=a(559),Kb=a(30),W=a(1015),za=a(1108);a(315);var Sa=a(13),Wa=a(33);class ab{constructor(Ob,Kc){this.$=Ob;this.fontServiceManager=Kc;this.menuId=this.r0c=this.nO=this.Lua=null;this.Cdd=0;this.TIi="+mn-lt";this.UFi="+mj-lt";this.KSi=()=>{this.z4f()};this.cYi=Ac=>{this.ilf=!0;this.$.Vx(Yc=>{Yc.NPa("FontName_New")});
h.ULS.sendTraceTag(520710160,1,15,`PreviewFont Status is ${Ac}`)};this.wmi=!!String.fromCodePoint&&!ja.a.sv&&!!window.gridRenderer&&gridRenderer.CanvasRendererGlobals.isFontLoadApiSupported();this.ilf=!1;this.Rl=H.EwaSettings.Rl();this.gridView=S.h(this.$);(this.jl=Wa.a.jl())&&this.fontServiceManager&&(this.fontServiceManager.Xhc?this.z4f():this.fontServiceManager.nre(this.KSi))}get themesManager(){this.lx||(this.lx=this.$.da.Aa(422));return this.lx}z4f(){this.nO=this.fontServiceManager.tBc;this.Lua=
this.fontServiceManager.DJh;this.Cdd=2}get tBc(){return this.nO}C_e(Ob,Kc,Ac,Yc=null){const td=Object.assign(new Ka.a,{Id:"FontDropdownMenu"});td.MenuSectionList=[];if(this.Rl&&this.themesManager){this.themesManager.P$b(Yc);if((null==this.themesManager.PF||this.themesManager.Etd)&&!H.EwaSettings.isChangeGateEnabled("OfficeVSO:7395874_UnblockFontMenuOpen"))return td;Yc=Object.assign(new ub.a,{ControlsId:"ThemeFontsMenuSectionControl",Title:Sa.a.instance.ga(1336),ControlList:this.f5h(Ob,Kc,Ac)});td.MenuSectionList.push(Yc)}Yc=
Object.assign(new ub.a,{ControlsId:"FontsMenuSectionControl"});if(this.Rl||this.jl)Yc.Title=Sa.a.instance.ga(1337);Yc.ControlList=this.HVh(Ob,Kc,Ac);td.MenuSectionList.push(Yc);return td}f5h(Ob,Kc,Ac){var Yc;const td=[];var $d=this.gridView.ha.Ra.dc;$d=5===(null===(Yc=null===$d||void 0===$d?void 0:$d.floatingObject)||void 0===Yc?void 0:Yc.type);let be,ke;this.themesManager.PF?(be=this.themesManager.PF.Gzd,ke=this.themesManager.PF.syd):h.ULS.sendTraceTag(520710165,1,15,"ThemeFonts are Null");(Yc=this.pJe(ke,
1,$d,Ob,Kc,Ac))&&td.push(Yc);(Ob=this.pJe(be,2,$d,Ob,Kc,Ac))&&td.push(Ob);return td}pJe(Ob,Kc,Ac,Yc,td,$d){var be=2===Kc?this.TIi:this.UFi;let ke;if(Ob)Ac=Ac?be:Kb.a.We(Ob),be=Kb.a.We(yb.HelperMethods.Hdc(Ob,Kc)),ke=Kb.a.We(Ob);else{if(!H.EwaSettings.isChangeGateEnabled("OfficeVSO:7395874_UnblockFontMenuOpen"))return null;Ac=Ac?be:void 0;be=Kb.a.We(String.fromCodePoint(0));ke="msofp"}return Object.assign(new W.a,{MenuItemId:2===Kc?za.b:za.a,CommandValueId:Ac,LabelText:be,LabelCss:String.format("font-size:12pt;font-family:{0};",
ke),Styles:ab.Dxb(ke),AriaLabel:be,Alt:be,Command:Yc.toString(),CommandPreviewId:td.toString(),CommandRevertId:$d.toString(),Disabled:!Ob})}HVh(Ob,Kc,Ac){if(this.r0c)return this.r0c.P7c;let Yc;const td=yb.HelperMethods.gR(()=>{const $d=this.wmi&&!this.ilf;let be=!1;this.Lua||(this.Ref(),be=!0,H.EwaSettings.isChangeGateEnabled("OfficeVSO:7477088_FontServiceRetryAndLogs")&&h.ULS.sendTraceTag(509654348,1,15,"FontDropdownHelper.getFontButtonsForMenuSection: fontCodepointMap is Null. Initialize with old Font Dictionary."));
Yc=this.QHe(Ob,Kc,Ac,this.Lua,$d,be);Yc.pzc&&!be&&(h.ULS.sendTraceTag(520710162,1,15,"FontDropdownHelper.getFontButtonsForMenuSection: ddEntries is Null. Fallback to old Font Dictionary."),this.Ref(),Yc=this.QHe(Ob,Kc,Ac,this.Lua,$d,Yc.pzc));this.jl&&!Yc.pzc&&(this.r0c=Yc);$d&&gridRenderer.CanvasRendererGlobals.loadPreviewFont(this.cYi)});10<td&&h.ULS.sendTraceTag(512340117,1,50,`FontDropdownHelper.getFontButtonsForMenuSection: Duration for getFontButtonsForMenuSection, duration=${td}`);return Yc.P7c}QHe(Ob,
Kc,Ac,Yc,td,$d){const be=[];let ke;const Pe=this.jl&&!$d;ke=Pe?"msofpNew":"msofp";for(let we in Yc){var Dd=we,ge=Yc[we],ne=Kb.a.We(Dd),ce=void 0;if(Pe)if(ce=this.nO?this.nO[Dd]:null)ce=Kb.a.We(ce);else return h.ULS.sendTraceTag(520710161,1,15,`FontDropdownHelper.getFontButtonsForMenuSection: localizedFontName in supportedFontFamiliesNew is not found for ${Dd}`),{pzc:!0,P7c:[]};else ce=Kb.a.We(yb.HelperMethods.nO[Dd]);Dd=Kb.a.We(Dd);td||(ge=0);ne=Object.assign(new W.a,{MenuItemId:ne,CommandValueId:ne,
LabelText:td&&0<ge?Kb.a.We(String.fromCodePoint(ge)):ce,LabelCss:String.format("font-size:12pt;font-family:{0};",td&&0<ge?ke:Dd),Styles:ab.Dxb(td&&0<ge?ke:Dd),AriaLabel:ce,Alt:ce,Command:Ob.toString(),CommandPreviewId:Kc.toString(),CommandRevertId:Ac.toString()});be.push(ne)}return{pzc:$d,P7c:be}}hAj(Ob){this.menuId=Ob}lpi(){return 2!==this.Cdd&&3!==this.Cdd?!1:!0}Ref(){this.Lua={["Angsana New"]:983046,["Arial Black"]:983051,["Arial"]:983050,["Batang"]:983061,["Book Antiqua"]:983077,["Browallia New"]:983082,
["Calibri"]:983085,["Cambria"]:983089,["Candara"]:983091,["Century"]:983095,["Comic Sans MS"]:983100,["Consolas"]:983101,["Constantia"]:983102,["Corbel"]:983106,["Cordia New"]:983107,["Courier New"]:983109,["DilleniaUPC"]:983121,["Dotum"]:983123,["FangSong"]:983138,["Garamond"]:983154,["Georgia"]:983156,["Gulim"]:983182,["GungSuh"]:983186,["KaiTi"]:983222,["JasmineUPC"]:983218,["Malgun Gothic"]:983258,["Mangal"]:983262,["Meiryo"]:983264,["Microsoft JhengHei"]:983272,["Microsoft YaHei"]:983284,["MingLiU"]:983292,
["MingLiU_HKSCS"]:983296,["MS Gothic"]:983245,["MS Mincho"]:983247,["MS PGothic"]:983249,["MS PMincho"]:983251,["PMingliU"]:983322,["PMingLiU-ExtB"]:983324,["SimHei"]:983382,["SimSun"]:983384,["SimSun-ExtB"]:983386,["Source Sans Pro"]:983396,["Tahoma"]:983405,["THSarabunPSK"]:983404,["Times New Roman"]:983415,["Trebuchet MS"]:983419,["Verdana"]:983443,["Yu Gothic"]:983464,["Yu Mincho"]:983474}}static Dxb(Ob){const Kc={};Kc["font-family"]=Ob;Kc["font-size"]="12pt";Ob={};Ob.optionText=Kc;return Ob}}
Object(e.a)(ab,"FontDropdownHelper",null,[561]);var ma=a(712);class ha extends ca.a{constructor(Ob){super();this.$=Ob;this.Db()}create(){H.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FontServiceIntegration",!1)?this.$.da.gb(504,Ob=>{this.nb(Object(ma.a)(this.$.da,502,()=>new ab(this.$,Ob)))}):this.nb(Object(ma.a)(this.$.da,502,()=>new ab(this.$,null)))}static ka(Ob){Ob.da.Ha(503,new ha(Ob))}}Object(e.a)(ha,"FontDropdownHelperFactory",ca.a,[]);var eb=a(1275),ta=a(1110),ya=a(1251),sb=
a(1213),Qb=a(1161),oc=a(1186),kb=a(1299),jb=a(1252),Wb=a(1239);class wc{constructor(Ob){this.$=Ob}Hc(){return!1}executeCommand(Ob,Kc){Ob=!1;Kc=Kc.command;switch(Kc){case 1910465940:Ob=!0}return Ob?E.Task.Sa(!0):I.a(Kc)}wc(Ob,Kc){switch(Kc.command){case 1910465940:return!0;default:return!1}}Nc(){return!1}}Object(e.a)(wc,"NameManagerCommandHandler",null,[222]);class Jc extends f.a{constructor(Ob){super(Ob)}hd(){this.$c([new wc(this.$)])}static ka(Ob){f.a.Md(493,new Jc(Ob))}}Object(e.a)(Jc,"NameManagerCommandHandlerFactory",
f.a,[]);var zc=a(1197),gd=a(1203),Va=a(1300),Eb=a(135);class hc extends Eb.StandardDialog{constructor(){super();this.iu=()=>{this.hide()}}showDialog(Ob,Kc){try{this.pe="OfficePyBlockPythonEditDialog",this.Ob=0,this.show({["type"]:"StandardDialogProps",["id"]:this.pe,["headerText"]:Ob,["resultHandler"]:this.iu,["titleText"]:Kc})}catch(Ac){this.lGc(Ob,Kc)}}lGc(Ob){const Kc=new nb.a(!1,!1,!1);Kc.Ob=0;Kc.pe="OfficePyBlockPythonEditLegacyDialog";Kc.initializeAndShow(Ob,this.wqg,null)}wqg(){this.hide()}}
Object(e.a)(hc,"OfficePyBlockPythonEditDialog",Eb.StandardDialog,[]);class Ab{constructor(Ob){this.$=Ob}Hc(){return!1}executeCommand(Ob,Kc){Ob=!1;Kc=Kc.command;switch(Kc){case 883532127:(new hc).showDialog("Python is not supported in Excel for the web","Excel for the web does not support calculating or interacting with Python formulas. To use Python formulas, open this file with the desktop app for Windows."),Ob=!0}return Ob?E.Task.Sa(!0):I.a(Kc)}wc(Ob,Kc){switch(Kc.command){case 883532127:return H.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OfficePyUX",
!1);default:return!1}}Nc(){return!1}}Object(e.a)(Ab,"OfficePyUXCommandHandler",null,[222]);class Bb extends f.a{constructor(Ob){super(Ob)}hd(){this.$c([new Ab(this.$)])}static ka(Ob){f.a.Md(532,new Bb(Ob))}}Object(e.a)(Bb,"OfficePyUXCommandHandlerFactory",f.a,[]);class ec{constructor(Ob,Kc){this.$=Ob;this.properties=Kc}static getInstance(Ob,Kc){return this.La||(this.La=new this(Ob,Kc))}static iBb(){return!!this.La}t9f(){he.ucc(this.$,this.properties).Tzc(2,null)}dispose(){ec.La=null}wz(){this.dispose()}Nya(){}zwb(){return{}}}
Object(e.a)(ec,"AlignmentTaskPaneManager",null,[2]);var Qd=a(176),dc=a(1346);class dd{constructor(Ob,Kc){this.$=Kc;this.Odd=Ob}showTaskPane(Ob,Kc){void Qd.UISurfaces.dj().then(Ac=>{Ac.showTaskPane("FormatCellsTaskPane",this.gu(Ob,Kc));return null})}updateTaskPane(Ob,Kc){void Qd.UISurfaces.dj().then(Ac=>{Ac.updateTaskPane("FormatCellsTaskPane",this.gu(Ob,Kc));return null})}hideTaskPane(){void Qd.UISurfaces.dj().then(Ob=>{Ob.hideTaskPane("FormatCellsTaskPane",2);return null})}close(){throw Error("Method not implemented.");
}selectTaskPane(){throw Error("Method not implemented.");}gu(Ob,Kc){Ob={type:"FormatCellsTaskPaneProps",activePage:Ob,callbacks:this.Odd.zwb(),viewModelData:Kc};return Object.assign(new dc.a,{contentProps:Ob,actionButtonProps:0!==Ob.activePage&&{label:"Back",icon:"CommonControlArrowLeftUseWithBorder_24",onExecute:()=>{this.updateTaskPane(0,null)}},onHide:()=>{this.Odd.Nya()},onClose:()=>{this.Odd.wz()},width:320})}}Object(e.a)(dd,"FormatCellsTaskPane",null,[322]);var jd;(function(Ob){Ob[Ob.noFormat=
-1]="noFormat";Ob[Ob.general=0]="general";Ob[Ob.number=1]="number";Ob[Ob.currency=2]="currency";Ob[Ob.accounting=3]="accounting";Ob[Ob.date=4]="date";Ob[Ob.time=5]="time";Ob[Ob.percentage=6]="percentage";Ob[Ob.fraction=7]="fraction";Ob[Ob.scientific=8]="scientific";Ob[Ob.text=9]="text";Ob[Ob.special=10]="special";Ob[Ob.custom=11]="custom";Ob[Ob.maxCategory=12]="maxCategory"})(jd||(jd={}));Object(e.b)("NumberFormatCategory",jd);var md=a(785),vd=a(1116),wd=a(1313);class Pd{constructor(){this.negativeCurrencyTypes=
this.negativeNumberTypes=this.categoryDescriptionStrings=this.categories=null;this.decimalPlaces=this.currentCategory=0;this.isComma=!1}}Object(e.a)(Pd,"NumberFormatModel",null,[]);class ic{constructor(){this.alignmentModel=this.numberFormatModel=null}}Object(e.a)(ic,"FormatCellsViewModel",null,[]);class cd{constructor(Ob,Kc){this.e1b=!1;this.Ysb=null;this.categoryDescriptionStrings=[Sa.a.instance.ga(484),Sa.a.instance.ga(485),Sa.a.instance.ga(486),Sa.a.instance.ga(487),Sa.a.instance.ga(488),Sa.a.instance.ga(489),
Sa.a.instance.ga(490),Sa.a.instance.ga(491),Sa.a.instance.ga(492),Sa.a.instance.ga(493),Sa.a.instance.ga(494),Sa.a.instance.Ta(746)];this.Lya=()=>{let Ac=new ic,Yc=new Pd;Yc.categories=this.numberFormatViewModel.gk.Categories;Yc.categoryDescriptionStrings=this.categoryDescriptionStrings;Yc.negativeNumberTypes=this.numberFormatViewModel.gk.NegativeNumberTypes;Yc.negativeCurrencyTypes=this.numberFormatViewModel.gk.NegativeCurrencyTypes;let td=this.numberFormatViewModel.yxb();this.Ysb=td;Yc.currentCategory=
td.NumberFormatCategory;Yc.decimalPlaces=td.DecimalPlaces;Yc.isComma=td.IsComma;Ac.numberFormatModel=Yc;he.ucc(this.$,this.properties).Tzc(1,Ac)};this.Kya=()=>{};this.$=Ob;this.properties=Kc}static getInstance(Ob,Kc){return this.La||(this.La=new this(Ob,Kc))}static iBb(){return!!this.La}o$f(Ob){this.properties=Ob;he.ucc(this.$,this.properties).Tzc(1,null);this.pgc(!0)}dispose(){this.vig();cd.La=null}zwb(){return{onCategoryChange:Ob=>{this.Ysb.NumberFormatCategory=jd[Ob.toLowerCase()];this.pgc()},
onThousandSeparatorChanged:Ob=>{this.Ysb.IsComma=Ob;this.pgc()},onDecimalPlacesChanged:Ob=>{this.Ysb.DecimalPlaces=Ob;this.pgc()}}}wz(){this.dispose()}Nya(){this.vig()}pgc(Ob){let Kc=null;if(this.activeCell=this.sbc())n.a.Kc in this.properties&&this.properties[n.a.Kc]&&(Kc=parseInt(this.properties[n.a.Kc].toString(),10)),this.numberFormatViewModel?(this.e1b||this.Xtc(),Kc||Ob?this.Nqf(Kc):this.numberFormatViewModel.Bub(this.activeCell,this.Ysb)):this.ffh(Kc)}ffh(Ob){const Kc=y.GetServiceTaskFactory.create(this.$.da,
18,this.$.la,0);v.TaskExtensions.za(Kc,()=>{this.numberFormatViewModel=new vd.a(this.$,Kc.result,new wd.a(this.$));this.e1b||this.Xtc();this.numberFormatViewModel.bOd();this.Nqf(Ob)},this.$.la,3)}Xtc(){this.e1b=!0;this.numberFormatViewModel.bZa(this.Lya);this.numberFormatViewModel.yXc(this.Kya)}Nqf(Ob){Ob=Object(mc.a)(new md.a,{Caller:3,NumberFormatCategory:null!==Ob&&void 0!==Ob?Ob:-1});this.numberFormatViewModel.Bub(this.activeCell,Ob)}sbc(){let Ob;const Kc=S.h(this.$).ha.qa.activeCell;Kc&&(Ob=
w.o(Kc,this.$));return Ob}vig(){this.e1b=!1;this.numberFormatViewModel&&(this.numberFormatViewModel.vcb(this.Lya),this.numberFormatViewModel.eMd(this.Kya))}}Object(e.a)(cd,"NumberFormatTaskPaneManager",null,[2]);class Hd extends Y.a{constructor(Ob,Kc){super();this.activePage=0;this.Btd=!1;this.VZh=()=>1===this.activePage?he.zxb(this.$,this.properties).zwb():null;this.BOh=()=>2===this.activePage?he.nwb(this.$,this.properties).zwb():null;this.$=Ob;this.properties=Kc;this.Qac=new dd(this,Ob);this.$H()}static getInstance(Ob,
Kc){return this.La||(this.La=new this(Ob,Kc))}Tzc(Ob,Kc){this.Btd?this.Qac.updateTaskPane(Ob,Kc):(this.Qac.showTaskPane(Ob,Kc),this.Btd=!0);this.activePage=Ob}Nya(){cd.iBb&&he.zxb(this.$,this.properties).Nya();ec.iBb&&he.nwb(this.$,this.properties).Nya()}wz(){cd.iBb()&&he.zxb(this.$,this.properties).wz();ec.iBb()&&he.nwb(this.$,this.properties).wz();this.dispose()}dispose(){this.$=null;this.p_d();this.Qac.hideTaskPane();this.Qac=null;this.Btd=!1;this.properties=null;Hd.La=null}$H(){}p_d(){}zwb(){return{onItemClick:Ob=>
{switch(Ob){case 1:he.zxb(this.$,this.properties).o$f(this.properties);break;case 2:he.nwb(this.$,this.properties).t9f()}},numberFormatCallbacks:this.VZh(),alignmentCallbacks:this.BOh()}}}Object(e.a)(Hd,"FormatCellsTaskPaneManager",Y.a,[]);class he{constructor(){}static ucc(Ob,Kc){return Hd.getInstance(Ob,Kc)}static zxb(Ob,Kc){return cd.getInstance(Ob,Kc)}static nwb(Ob,Kc){return ec.getInstance(Ob,Kc)}}Object(e.a)(he,"FormatCellsTaskPaneHelper",null,[]);class Lb{constructor(Ob){this.$=Ob}Hc(){return!1}executeCommand(Ob,
Kc,Ac){Ob=!1;Kc=Kc.command;switch(Kc){case 2055979337:he.ucc(this.$,Ac).Tzc(0,null);Ob=!0;break;case -395879625:he.zxb(this.$,Ac).o$f(Ac);Ob=!0;break;case -2019948858:he.nwb(this.$,Ac).t9f(),Ob=!0}return Ob?E.Task.Sa(!0):I.a(Kc)}wc(Ob,Kc){switch(Kc.command){case 2055979337:case -395879625:case -2019948858:return!0;default:return!1}}Nc(){return!1}}Object(e.a)(Lb,"FormatCellsCommandHandler",null,[222]);class Ic extends f.a{constructor(Ob){super(Ob)}hd(){this.$c([new Lb(this.$)])}static ka(Ob){f.a.Md(533,
new Ic(Ob))}}Object(e.a)(Ic,"FormatCellsCommandHandlerFactory",f.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.AutoComplete");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.ContextMenu");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidation");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidationEdit");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.FormulaAssistance");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SharedUIControlsFactory");
Type.registerNamespace("_Ewa");Object(b.a)();(()=>{V.a.Fa(Ob=>{H.EwaSettings.isChangeGateEnabled("OfficeVSO:7505051_MoveBatchHandlerToNewServices")||aa.ka(Ob)})})();V.a.Fa(xa.ka);Object(ia.a)();Object(Ma.a)();Object(Ta.a)();Object(Da.a)();Object(fa.a)();Object(ua.a)();V.a.Fa(Ra.ka);Object(qa.a)();Object(La.a)();Object(Yb.a)();(()=>{V.a.Fa(Ob=>{db.ka(Ob)})})();Object(Pa.a)();Object(eb.a)();Object(ta.a)();Object(ya.a)();Object(sb.a)();Object(Qb.a)();Object(oc.a)();Object(kb.a)();Object(jb.a)();Object(gd.a)();
Object(Wb.a)();Object(zc.a)();Object(Va.a)();(()=>{V.a.Fa(Ob=>{Bb.ka(Ob)})})();(()=>{V.a.Fa(Ob=>{Jc.ka(Ob)})})();(()=>{V.a.Fa(Ob=>{ha.ka(Ob)})})();(()=>{V.a.Fa(Ob=>{Ic.ka(Ob)})})()},734:function(r,F,a){a.d(F,"a",function(){return M});r=a(0);var c=a(7),b=a(15),e=a(562),f=a(89),d=a(559),h=a(379),l=a(583),k=a(567),t=a(111),n=a(268),z=a(83),w=a(421),m=a(1424);F=a(81);var u=a(19),y=a(5),v=a(784),C=a(68),x=a(41),B=a(56),H=a(140),I=a(117),U=a(1),S=a(11),G=a(22),D=a(13),E=a(21),N=a(34);class M extends F.a{constructor(L,
aa,V,P,ba,Y,Z,ea,ra,O,da,xa){super();this.$mc=!1;this.uIc=this.hLc=this.contextMenuController=null;this.Jqd=!1;this.mwc=this.Ptb=null;this.GC=()=>{this.contextMenuController?this.contextMenuController.GC():b.ULS.sendTraceTag(537167068,0,10,"ContextMenuBase.DismissFloatie: the context menu controller is null when attempintg to dismiss floatie on KeyDown.");this.mig()};this.jb=L;this.Ivf=ba;this.kSc=O;this.jNf=Y;this.populateOnlyOnce=Z;this.mbi=da;this.XTf(xa)}get contextMenuRoot(){return this.mwc}get $(){return this.jb}get Va(){return this.kSc}get menuId(){return this.$.Bb+
this.Ivf}get Wvb(){this.hLc||(this.hLc=I.a(this.$));return this.hLc}get arb(){this.uIc||(this.uIc=E.h(this.$).Vb);return this.uIc}Hc(L,aa){L=!0;switch(aa){case 1651433993:case 1675506831:case 966232027:L=this.Pd(4096)||this.Pd(2048);break;case 2045563128:L=this.Pd(4096);break;case 912277356:case 2123758504:case -1793121409:case 1378457149:L=this.Pd(8192)}return!L}Nc(L,aa,V){V.IsShadowMenuOpen||v.i(this.$,v.d);L=!1;aa===this.Hw&&(V.IsShadowMenuOpen||v.i(this.$,v.a),aa=Object(c.a)(new e.a,{ExternalId:"ContextMenu",
UpdateDynamically:!0,MenuSectionList:[]}),this.GGd(aa,V.IsShadowMenuOpen),V.MenuItems=aa,V.IsShadowMenuOpen||v.i(this.$,v.c),L=!0);L&&this.$mc&&S.HelperMethods.p2b&&!V.IsShadowMenuOpen&&v.k(this.$);return L}GGd(L,aa){(aa=this.FY(aa))?(this.fdf(aa),L.MenuSectionList.push(...aa.oE().MenuSectionList),this.iKg(L)):b.ULS.sendTraceTag(537167105,0,10,"ContextMenuBase.PopulateContextMenuProps: CreateRibbonMenu() returned null instead of RibbonMenu instance")}FY(){b.ULS.sendTraceTag(537167104,0,10,"ContextMenuBase.CreateRibbonMenu: This method should not be called if the menu is not ready for React!");
return null}w0(L,aa,V,P,ba){L=Sys.UI.DomElement.getBounds(aa);aa=new Sys.UI.Point(L.x,L.y+L.height);this.$.isChromeRtl&&(aa.x+=L.width);this.xp(aa,ba)}xp(L,aa,V=0){aa&&(L=N.a(this.$).Mja(L));aa=!0;if(this.mbi){let P;3===V?(P=this.xKa(3))&&0<P.length?(aa=!1,this.showFloatie(P,new Sys.UI.Bounds(L.x,L.y,0,0),V)):b.ULS.sendTraceTag(537167075,0,10,`ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the touch floatie groups. Context menu ID: ${this.menuId}`):
2===V&&this.$.isEditMode&&((P=this.xKa(2))&&0<P.length?P[0]!==M.LYe?(aa=!1,this.IUd(P,new Sys.UI.Bounds(L.x,L.y,0,0),V)):b.ULS.sendTraceTag(537167074,0,50,`ContextMenuBase.ShowAt: The context menu does not support floatie. Context menu ID: ${this.menuId}`):b.ULS.sendTraceTag(537167073,0,10,`ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the mouse floatie groups. Context menu ID: ${this.menuId}`))}aa&&this.showContextMenu(new Sys.UI.Bounds(L.x,L.y,
0,0),V)}xKa(){return null}lid(L,aa=null){let V="";3===L?V="touch":2===L&&(V="mouse");return{["IsEditMode"]:this.$.isEditMode,["IsSLR"]:!!B.a.pg&&B.a.pg.gK,["IsReactMLR"]:!!B.a.pg&&B.a.pg.lV,["IsNov"]:this.$.ea.isNamedObjectViewMode,["InputType"]:V,["FloatieGroups"]:JSON.stringify(aa)}}showContextMenu(L,aa=0){const V=this.lid(aa);b.ULS.sendTraceTag(595359709,0,50,`ContextMenuBase.ShowContextMenu: rendering a context menu with given arguments: ${JSON.stringify(V)}`);this.contextMenuController?this.tB!==
y.a.vJd&&this.tB!==y.a.wJd||0===aa?this.contextMenuController.HUd(this.tB,L,C.a.zb):this.contextMenuController.HUd(this.tB,L,aa):b.ULS.sendTraceTag(537167072,0,10,"ContextMenuBase.ShowContextMenu: the context menu controller is null when attempintg to show context menu.")}showFloatie(L,aa,V){const P=this.lid(V,L);b.ULS.sendTraceTag(595359710,0,50,`ContextMenuBase.ShowFloatie: rendering a floatie with given arguments: ${JSON.stringify(P)}`);this.contextMenuController?(this.eUf(),this.contextMenuController.Rzc(L,
aa,V)):(L=JSON.stringify(L),b.ULS.sendTraceTag(537167071,0,10,`ContextMenuBase.ShowFloatie: the context menu controller is null when attempting to show the floatie with floatieGroups ${L}.`))}IUd(L,aa,V){var P=this.lid(V,L);P=JSON.stringify(P);b.ULS.sendTraceTag(537167070,0,50,`ContextMenuBase.ShowContextMenuWithFloatie: rendering a floatie with given arguments: ${P}`);this.contextMenuController?(this.eUf(),this.contextMenuController.GUd(L,aa,V,this.tB)):b.ULS.sendTraceTag(587335491,0,10,"ContextMenuBase.ShowContextMenuWithFloatie: the context menu controller is null when attempintg to show floatie with ContextMenu.")}XTf(L){this.contextMenuController=
L}dispose(){this.$&&this.$.Ia.hcb(this);this.jb=null;this.mig();this.mwc&&(f.a.Ja(this.mwc),this.mwc=null);super.dispose()}YLh(L){var aa=this.$.da.Aa(204);aa&&(aa=aa.GMh(this.Ivf))&&L.rc.push(aa)}Pd(L){return(new H.a(this.$.va)).Pd(L)}fdf(L){for(const aa of L.rc)if(Object(w.a)(288,aa)){L=aa;L.title&&(L.title=M.kf(L.title));for(const V of L.buttons)Object(w.a)(307,V)?(L=V,L.label=M.kf(L.label),L.TR(M.kf(L.alt))):Object(w.a)(326,V)&&this.fdf(V.menu)}}Fvf(L,aa=!1){const V=[];for(const P of L)V.push(this.MP(P,
aa));return V}MP(L){const aa=[];for(const V of L.MenuItems)switch(V.Type){case 3:aa.push(this.Vbh(V));break;case 2:aa.push(this.Ghh(V));break;case 1:aa.push(this.udh(V))}return Object(c.a)(new d.a,{ControlList:aa,Title:L.Title,DisplayMode:"Menu16",MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0})}Eed(L,aa){aa=[this.Ptb,L.RibbonCommand.toString(),aa?this.F3e(aa):this.F3e(L.Label),L.Disabled?L.Disabled.toString():"False"];let V=L.CommandData;V=G.a.hashCode(V).toString();
aa.push(V,L.Identifier.toString());aa=aa.join("_");L.IsChecked&&(aa+="_Checked");return aa}HMh(L){const aa=[this.Ptb,G.a.hashCode(L.Title).toString()];for(const V of L.MenuItems)aa.push(V.RibbonCommand.toString());return aa.join("_")}B_e(L){var aa=L.Label;aa=G.a.hashCode(aa).toString();aa=[this.Ptb,aa];U.EwaSettings.isChangeGateEnabled("OfficeVSO:5139850_FixPivotFilterMenuDuplicatingIdenticalFields")&&L.Id&&aa.push(G.a.hashCode(L.Id).toString());aa=aa.join("_");L.IsChecked&&(aa+="_Checked");return aa}Vbh(L){let aa,
V,P;({label:V,ILa:P,yr:aa}=this.lbc(L,!1));const ba=this.Eed(L,V);return Object(c.a)(new h.a,{Command:L.Disabled?(-251203935).toString():aa.toString(),ExternalId:ba,Id:ba,Image16by16Class:P,LabelText:V||L.Label,MenuItemId:L.CommandData,CommandValueId:L.CommandData})}Ghh(L){let aa,V,P;({label:V,ILa:P,yr:aa}=this.lbc(L,L.IsChecked));const ba=this.Eed(L,V);return Object(c.a)(new l.a,{Command:L.Disabled?(-251203935).toString():aa.toString(),ExternalId:ba,Id:ba,Image16by16Class:P,LabelText:V||L.Label,
MenuItemId:L.CommandData,CommandValueId:L.CommandData,IsChecked:L.IsChecked})}udh(L){let aa;var V;({label:aa,ILa:V}=this.K_e(L));const P=Object(c.a)(new e.a,{MenuSectionList:[],UpdateDynamically:!0});P.MenuSectionList.push(...this.Fvf(L.SubMenu.Sections,!0));const ba=this.B_e(L);L=aa||L.Label;return Object(c.a)(new k.a,{ExternalId:ba,Id:ba,LabelText:L,PopulateOnlyOnce:!1,Menu:P,Image16by16Class:V,ImageIsVisible:!!V})}K_e(L){let aa,V;({label:L,ILa:aa,yr:V}=this.lbc(L,!0));return{label:L,ILa:aa,yr:V}}lbc(L,
aa){let V;switch(L.Identifier){case 26:V=912804500;aa=u.a.YUe;L=D.a.instance.ga(1950);break;case 3:V=-1902148570;aa=aa?u.a.saa:null;L=D.a.instance.ga(1910);break;case 4:V=-1902148570;aa=aa?u.a.saa:null;L=D.a.instance.ga(1911);break;case 5:V=-1902148570;aa=aa?u.a.saa:null;L=null;break;case 1:V=-1677817820;aa=u.a.$9b;L=D.a.instance.ga(232);break;case 2:V=-1649376918;aa=L.IsChecked?u.a.sua:null;L=D.a.instance.ga(2121);break;case 23:V=1701016594;aa=L.IsChecked?u.a.sua:null;L=D.a.instance.ga(2121);break;
case 6:V=-87741481;aa=null;L=D.a.instance.ga(2122);break;case 7:V=1948650742;aa=u.a.ITe;L=D.a.instance.ga(1948);break;case 8:V=1933713114;aa=u.a.HTe;L=D.a.instance.ga(1949);break;case 14:V=504133448;aa=u.a.oJa;L=D.a.instance.ga(144);break;case 30:V=504133448;aa=u.a.oJa;L=D.a.instance.Ta(744);break;case 32:V=504133448;aa=u.a.oJa;L=D.a.instance.ga(148);break;case 34:V=504133448;aa=u.a.oJa;L=D.a.instance.ga(150);break;case 27:V=1701016594;aa=aa?u.a.b$b:u.a.oJa;L=D.a.instance.ga(144);break;case 15:V=
-798968736;aa=u.a.pJa;L=D.a.instance.ga(146);break;case 31:V=-798968736;aa=u.a.pJa;L=D.a.instance.Ta(745);break;case 33:V=-798968736;aa=u.a.pJa;L=D.a.instance.ga(149);break;case 35:V=-798968736;aa=u.a.pJa;L=D.a.instance.ga(151);break;case 28:V=1701016594;aa=aa?u.a.c$b:u.a.pJa;L=D.a.instance.ga(146);break;case 21:V=-2058042992;aa=u.a.V2a;L=null;break;case 29:V=1701016594;aa=u.a.V2a;L=null;break;case 9:V=1701016594;L=aa=null;break;case 11:V=-1494291901;L=aa=null;break;case 25:V=-1045020714;aa=L.IsChecked?
u.a.sua:null;L=null;break;case 13:V=1701016594;aa=L.IsChecked?u.a.sua:null;L=D.a.instance.ga(153);break;case 16:V=1701016594;aa=u.a.T9b;L=D.a.instance.ga(1081);break;case 17:V=1701016594;aa=u.a.U2a;L=null;break;case 18:V=1701016594;aa=u.a.T2a;L=null;break;case 19:V=1701016594;aa=u.a.U9b;L=D.a.instance.ga(1086);break;case 20:V=1701016594;aa=u.a.Gad;L=D.a.instance.ga(1087);break;case 24:V=1675506831;L=aa=null;break;case 22:V=L.RibbonCommand;aa=L.IsChecked?u.a.saa:null;L=null;break;case 36:V=1461300262;
aa=null;L=D.a.instance.ga(152);break;case 38:V=L.RibbonCommand;aa=u.a.Wad;L=D.a.instance.ga(1821);break;default:b.ULS.shipAssertTag(537167069,0,!1,`Unable to map menu item: ${JSON.stringify(L)}`),V=1461300262,L=aa=null}return{label:L,ILa:aa,yr:V}}F3e(L){return G.a.hashCode(L+S.HelperMethods.Ywj).toString()}iKg(L){if(!this.$.ea.amIAlone){var aa=this.$.da.Aa(25);if(aa&&!t.a.isEmpty(aa.Toa)&&(aa=aa.Q6h(),!n.a.lh(aa))){var V=[];z.a.instance.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder").Yfh(aa,
V);L.MenuSectionList.push(...V)}}}eUf(){this.Jqd||(this.Wvb&&this.Wvb.Q_b(this.GC),this.arb&&this.arb.Q_b(this.GC),this.Jqd=!!this.Wvb||!!this.arb)}mig(){this.Wvb&&this.Wvb.Quc(this.GC);this.arb&&this.arb.Quc(this.GC);this.Jqd=!1}static Opd(L,aa){aa=x.C(aa);L=E.h(L).Ca.IKa(aa);return!(null===L||void 0===L||!L.uk)}static Kfd(L,aa,V){aa=x.C(aa);var P=E.h(L).Ca.IKa(aa);aa=E.h(L).getCellBounds(P);const ba=P.$Ug;P=P.YUg;let Y=aa.x+ba.x;aa=aa.y+ba.y;V&&U.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled")&&
(E.h(L).rtl||(Y+=P),aa-=P);return new Sys.UI.Point(Y,aa)}static UDh(L){try{Object(m.a)(L.CommandValueId)}catch(aa){}}static kf(L){const aa=M.d2a.parseFromString(L,"text/html");return aa?aa.body.innerText:(b.ULS.sendTraceTag(537167066,0,15,"Not able to decode htmlFormattedText"),L)}}M.d2a=new DOMParser;M.LYe="Unsupported";Object(r.a)(M,"ContextMenuBase",F.a,[222,327,2])},784:function(r,F,a){a.d(F,"j",function(){return"ContextMenuPerf.A"});a.d(F,"b",function(){return"ContextMenuPerf.B"});a.d(F,"d",
function(){return"ContextMenuPerf.C1"});a.d(F,"a",function(){return"ContextMenuPerf.C2"});a.d(F,"c",function(){return"ContextMenuPerf.D"});a.d(F,"e",function(){return t});a.d(F,"f",function(){return w});a.d(F,"h",function(){return m});a.d(F,"i",function(){return u});a.d(F,"k",function(){return y});a.d(F,"g",function(){return C});var c=a(15),b=a(322),e=a(8),f=a(63),d=a(24),h=a(11),l=a(21),k=a(1);const t=(x,B)=>{var H=x.Pb(null);if((null===H||void 0===H?0:H.cell.uk)&&n(H,x,B))return x.getCellBounds(H.cell);
H=x.ha.qa.activeCell;return(B=z(new d.Range(H.top,H.left,e.a.Vg,H.left,!1,!1),2,!0,x,B)||z(new d.Range(1,H.left,H.top,H.left,!1,!1),2,!1,x,B)||z(new d.Range(H.top,H.right,H.top,e.a.Ug,!1,!1),1,!0,x,B)||z(new d.Range(H.top,1,H.top,H.right,!1,!1),1,!1,x,B)||null)&&B.uk?x.getCellBounds(B):Sys.UI.DomElement.getBounds(x.Zva.jc)},n=(x,B,H)=>{var I=B.rtl,U=H.isChromeRtl;x=x.cell;return(H=l.h(H).LJ(x))?(H=H.topLeft,I=H.x+=I===U?x.offsetWidth:0,U=H.y+=x.offsetHeight,B.view.visibleArea.contains(new f.a(I,U,
0,0))):!1},z=(x,B,H,I,U)=>{x=I.Wj("ContextMenuHelper.FindFirstCellInViewportArea",x,B,H);try{for(x.$$rst();x.$$mn();){const S=x.$$cu();if(S&&n(S,I,U))return S.cell}}finally{x&&x.dispose()}return null},w=x=>x.tb.b5(x.ha.qa.activeCell),m=x=>{x=l.h(x).ha.qa;return x.Tg&&(x.ld.isRow||x.ld.Rg)},u=(x,B)=>{h.HelperMethods.X_c&&window.performance.mark(B)},y=()=>{if(b.a.kqb){const x=v("OnContextMenuHandling","ContextMenuPerf.A","ContextMenuPerf.B"),B=v("PrepInfraWork","ContextMenuPerf.B","ContextMenuPerf.C1"),
H=v("EWAPopulation","ContextMenuPerf.C2","ContextMenuPerf.D");c.ULS.sendTraceTag(537167064,0,50,`ContextMenuHelper.ReportPerformanceIfSupported: OnContextMenuHandling=[${x}], PrepInfraWork=[${B}], EWAPopulation =[${H}]`)}},v=(x,B,H)=>{window.performance.measure(x,B,H);B=window.performance.getEntriesByName(x);B.length||c.ULS.sendTraceTag(537167063,0,10,`ContextMenuHelper.MeasureTime: measure name [${x}] returned no measures.`);return B[B.length-1]?B[B.length-1].duration:-1},C=x=>k.EwaSettings.isChangeGateEnabled("OfficeVSO:7214067_CheckShareModeCapability")?
x.qd&33554432?!0:!1:!0},786:function(r,F,a){a.d(F,"a",function(){return c});r=a(0);class c{}c.bRe="ewa-ac";c.huh="ewa-ac-param";c.pSe="ewa-function-help-link";c.O9b="ewa-lb";c.kSe="ewa-fb-refactor";c.listItem="list-item";c.zDb="list-item-selected";c.DDb="list-table-touch";c.CDb="list-table";c.jzh="ewa-suggested-cell-name";c.Q6g="columnName-header";c.mTe="ewa-tt";c.Iwh="ewa-function-link-container";c.qSe="ewa-function-udf-name";c.rtl="rtl";Object(r.a)(c,"CssClassNames",null,[])},825:function(r,F,a){a.r(F);
r=a(0);var c=a(15),b=a(843),e=a(739),f=a(5),d=a(68),h=a(51),l=a(205),k=a(35),t=a(1),n=a(13);class z{constructor(L,aa,V,P,ba,Y,Z,ea){this.Gtg=L;this.Htg=aa;this.Ftg=V;this.xga=P;this.LEg=ba;this.aBg=Y;this.Bkb=Z;this.bAg=ea}get Uxe(){return this.Gtg}get g2b(){return this.Htg}get Txe(){return this.Ftg}get width(){return this.xga}get mPj(){return this.LEg}get RMi(){return this.aBg}get lineHeight(){return this.Bkb}get fAi(){return this.bAg}static OXg(){return new z("BorderStyleSolidLine",1962,1,"1","",
1,8,0)}static KXg(){return new z("BorderStyleDashedLine",1963,3,"1","5,3",1,8,0)}static LXg(){return new z("BorderStyleDottedLine",1964,4,"1","1,1",1,8,0)}static NXg(){return new z("BorderStyleMediumLine",1965,2,"2","",1,8,0)}static PXg(){return new z("BorderStyleThickLine",1966,5,"3","",1,8,0)}static MXg(){return new z("BorderStyleDoubleLine",1967,6,"1","",2,8,3)}}Object(r.a)(z,"BorderLineStyleProperties",null,[]);class w{constructor(){this.iconName=this.title=this.key=null}}Object(r.a)(w,"BorderLineStyleProps",
null,[]);class m{constructor(L){L.pUf()}getBorderLineStyleProps(){const L=a(825).BorderFormatManager.u_a,aa=Array(Object.keys(L).length);let V=0;for(let Y in L){var P=Y,ba=L[Y];aa[V]=new w;aa[V].key=P;P=ba;aa[V].title=n.a.instance.ga(P.g2b);aa[V].iconName=P.Uxe;V++}return aa}}Object(r.a)(m,"BorderMenuController",null,[640]);var u=a(268),y=a(86),v=a(240),C=a(14),x=a(110),B=a(24),H=a(48),I=a(44),U=a(214),S=a(11),G=a(21),D=a(34),E=a(41);class N{constructor(L,aa){this.uIb=this.ribbonCommandInfo=this.cellFormat=
this.Mr=this.Cb=this.ha=null;this.Ztc=!1;this.HOf=this.TLa=this.SHd=this.$$d=this.rza=this.Hma=null;this.i2b=this.$ta=this.NOf=0;this.borderStyle=this.v_a=this.borderColor=null;this.$A=!1;this.L6b=this.bbb=null;this.a0=()=>{if(!this.$A||G.h(this.$).ez)this.$A=!1,G.h(this.$).ez=!1,this.$ta=0,G.h(this.$).Gg.vp(f.a.QU),1===this.$.Ia.eH()&&(G.h(this.$).l4(t.EwaSettings.isChangeGateEnabled("OfficeVSO:6713439_FixCloneRangeArray")?E.d(this.SHd):u.a.clone(this.SHd),this.NOf,this.$.na?this.$.na.sheetName:
null,null,this.HOf.clone(),null,null,0,"DrawBorderBehavior.ResetBehavior",!0),G.h(this.$).FSa(!0)),this.Iv(),this.z_d(),this.Sj(),this.Ztc=!1,this.rza=this.Hma=null,this.Mr&&(this.Mr.cancel(),this.Mr.dispose()),c.ULS.sendTraceTag(537159516,0,50,"DrawBorderBehavior.ResetBehavior : Ending ResetBehavior ")};this.onPointerDown=V=>{try{if(V=this.me(V),G.h(this.$).ez=!0,this.Hma={},this.rza={},this.bbb=null,this.oqb(this.i2b),2===V.vb){const P=G.h(this.$).ha.Xp(V.clientPoint,V.Mb,5,void 0,void 0,!1);P&&
(this.L6b=this.TLa=P,this.Dfj())}}catch(P){G.h(this.$).ez=!1}return!0};this.Ti=V=>{try{V=this.me(V);const P=G.h(this.$).ha.Xp(V.clientPoint,V.Mb,5,void 0,void 0,!1),ba=G.h(this.$).Ca.Ur(P);if(!this.uIb||ba&&(ba.CQ!==this.uIb.CQ||ba.BQ!==this.uIb.BQ))if(this.$A=!0,this.uIb=ba,P){let Y=new B.Range(this.TLa.top,this.TLa.left,this.TLa.top,this.TLa.left,!0,!1);Y.union(P);Y=G.h(this.$).ha.a1h(Y);this.n2b(P);this.VZf(this.bbb,Y);if(this.bottomRightCorner(Y.bottom,Y.right))return c.ULS.sendTraceTag(537159515,
0,15,"DrawBorderBehavior.OnPointerMove - Bottom-right corner of sheet reached, cannot expand further."),!1;const Z=new B.Range(Y.top,Y.left,Y.bottom+1,Y.right+1,!0,!1),ea=G.h(this.$).O$("DrawBorderBehavior.OnPointerMove",[Z]);if(this.Hma&&this.rza)for(;ea.$$mn();){const ra=ea.$$cu(),O=ra.cell.getRange().toString();O in this.Hma&&1!==this.$ta||(this.Hma[O]=ra,this.rza[O]=ra.cell.DM())}this.bbb=Z;this.L6b=Y;G.h(this.$).l4([Y],0,this.$.na.sheetName,null,Y.topLeft,null,null,0,"DrawBorderBehavior.OnPointerMove",
!0);this.Nh.$da(G.h(this.$),-1690267012,this.cellFormat,!0,null,[Y])}return!0}catch(P){return G.h(this.$).ez=!1}};this.Wg=V=>{V=this.me(V);(V=G.h(this.$).ha.Xp(V.clientPoint,V.Mb,5,void 0,void 0,!1))?this.$A&&(this.n2b(V),this.TLa.union(V),3===this.$ta?this.oqb(0):this.oqb(this.i2b),G.h(this.$).l4([this.TLa],0,this.$.na.sheetName,null,null,null,null,0,"DrawBorderBehavior.OnPointerUp1",!0),this.Nh.formatCells(-1690267012,this.cellFormat,this.ribbonCommandInfo)):(3===this.$ta?this.oqb(0):this.oqb(this.i2b),
G.h(this.$).l4([this.L6b],0,this.$.na.sheetName,null,null,null,null,0,"DrawBorderBehavior.OnPointerUp2",!0),this.Nh.formatCells(-1690267012,this.cellFormat,this.ribbonCommandInfo));this.$A=!1;this.z_d();this.rza=this.Hma=null;return!0};this.onKeyDown=V=>{V=this.me(V);if(this.$A||[17,16,18,20].includes(V.Ea.keyCode))return!0;this.a0();return!1};this.onKeyUp=V=>{V=this.me(V);if(V.Ea.keyCode===y.a.ZF&&this.$A)return this.$A=!1,this.VZf(this.bbb,this.L6b,!0),this.z_d(),!0;if(this.$A||V.Ea.keyCode===y.a.Uoa||
V.Ea.keyCode===y.a.rGc||V.Ea.keyCode===y.a.qGc||[17,16,18,20,37,39,38,40,33,34,9,13].includes(V.Ea.keyCode)||V.Ea.keyCode===y.a.$3d||V.Ea.keyCode===y.a.W3d||V.Ea.keyCode===y.a.S3d)return!0;this.a0();return!1};this.iR=(V,P)=>{G.h(this.$).ez&&!this.lei.includes(P.Sd.command)&&(V=JSON.stringify(P.Sd),c.ULS.sendTraceTag(537159512,0,50,`DrawBorderBehavior.OnCommandExecutionStarting : Command Triggered : ${V} `),this.a0())};this.$=L;this.Nh=aa}get lei(){return this.$$d||(this.$$d=[1256700402,-1756763834,
-1418159950,-236759591,-2118943501,1981159862,395594266,-1502853784,-111689794,-1059615499,-1027730316,-1104934572,1872288872,2045211913,1504715724,46555851,-70383382,-28797232])}uHg(L){c.ULS.sendTraceTag(537159517,0,50,"DrawBorderBehavior.ActivateBehavior : Starting ActivateBehavior ");this.ha=G.h(this.$).ha;this.Cb=G.h(this.$).Cb;this.ribbonCommandInfo=L;this.SHd=t.EwaSettings.isChangeGateEnabled("OfficeVSO:6713439_FixCloneRangeArray")?E.d(this.ha.qa.selectedRanges):u.a.clone(this.ha.qa.selectedRanges);
this.NOf=this.ha.qa.es;this.HOf=this.ha.qa.activeCell.clone();this.Cb&&this.Cb.amd();this.Et();this.Aj()}dispose(){this.a0();this.uIb=this.ribbonCommandInfo=this.cellFormat=null}oqb(L){var {BorderFormatManager:aa}=a(825);this.cellFormat={};const V={};this.borderColor=this.borderColor||aa.V7c;var P=l.a.bH(this.borderColor,!1);V.Color=[P,P,P,P];t.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&this.v_a&&(V.ThemeBorderColor=[this.v_a,this.v_a,this.v_a,this.v_a],V.ColorTypeOption=
1);P=a(825).BorderFormatManager.u_a;this.borderStyle=this.borderStyle||aa.borderStyleSolidLine;aa=P[this.borderStyle].Txe;V.LineStyle=[aa,aa,aa,aa];this.cellFormat.BorderFormat=V;this.cellFormat.ValidMembers=128;this.cellFormat.Border=L}Et(){for(const L of G.h(this.$).yn)v.a.instance.ta(C.a.pointerDown,L.domElement,this.onPointerDown);x.KeyInputManager.instance.ta(C.a.Sb,document.documentElement,this.onKeyDown);x.KeyInputManager.instance.ta(C.a.Ld,document.documentElement,this.onKeyUp)}Dfj(){for(const L of G.h(this.$).yn)v.a.instance.ta(C.a.yj,
L.domElement,this.Ti),v.a.instance.ta(C.a.Kf,L.domElement,this.Wg);v.a.instance.ta(C.a.Kf,document.documentElement,this.Wg);v.a.instance.ta(C.a.qB,document.documentElement,this.Wg);this.Ztc=!0}Iv(){try{for(const L of G.h(this.$).yn)v.a.instance.Ba(C.a.pointerDown,L.domElement,this.onPointerDown);x.KeyInputManager.instance.Ba(C.a.Sb,document.documentElement,this.onKeyDown);x.KeyInputManager.instance.Ba(C.a.Ld,document.documentElement,this.onKeyUp)}catch(L){G.h(this.$).ez=!1,c.ULS.sendTraceTag(537159514,
0,10,`DrawBorderBehavior.UnregisterHandlers: Unregistering of Handlers failed with Exception ${L}`)}}z_d(){if(this.Ztc)try{this.Ztc=!1;for(const L of G.h(this.$).yn)v.a.instance.Ba(C.a.yj,L.domElement,this.Ti),v.a.instance.Ba(C.a.Kf,L.domElement,this.Wg);v.a.instance.Ba(C.a.Kf,document.documentElement,this.Wg);v.a.instance.Ba(C.a.qB,document.documentElement,this.Wg)}catch(L){G.h(this.$).ez=!1,c.ULS.sendTraceTag(537159513,0,10,`DrawBehavior.UnregisterDrawHandlersForMouse: Unregistering of Handlers failed with Exception ${L}`)}}Aj(){this.$.va.Vf(this.a0);
G.h(this.$).Vb.xl(this.a0);G.h(this.$).jE(this.a0);this.$.Ia.YFa(this.iR)}Sj(){this.$.va.sg(this.a0);G.h(this.$).Vb.nl(this.a0);G.h(this.$).AF(this.a0);this.$.Ia.Vza(this.iR)}VZf(L,aa,V=!1){if(L&&this.Hma&&this.rza)for(L=G.h(this.$).O$("DrawBorderBehavior.ApplyBordersOnPreviewCells",[L]);L.$$mn();){var P=L.$$cu().cell.getRange();if(V||!aa.contains(P)||1===this.$ta){P=P.toString();const ba=k.a.Fc(this.Hma,P);if(ba){const Y=k.a.Fc(this.rza,P);this.setBorders(ba,Y);delete this.Hma[P];delete this.rza[P]}}}}setBorders(L,
aa){var V=L.cell;const P=V.getRange();V.gcb();P.right!==this.bbb.right&&(V=new B.Range(P.top,P.left-1,P.bottom,P.left-1,!0,!1),G.h(this.$).Ca.Ur(V).AQa(3));P.bottom!==this.bbb.bottom&&(V=new B.Range(P.top-1,P.left,P.top-1,P.right,!0,!1),G.h(this.$).Ca.Ur(V).AQa(1));if(null===aa||void 0===aa?0:aa.Borders.length){V={};let Z=0;const ea=Array(4),ra=Array(4);for(var ba=0;4>ba;ba++)ea[ba]=1,ra[ba]=0;for(var Y of aa.Borders)aa=Y.BorderPosition,ea[aa]=Y.BorderLineStyle,ba=new U.a(Y.Color.Red,Y.Color.Green,
Y.Color.Blue),ra[aa]=ba.dS(),Z|=S.HelperMethods.f4a(Y.BorderPosition);V.LineStyle=ea;V.Color=ra;Y={};Y.BorderFormat=V;Y.Border=Z;this.Nh.VAj(L,Y,P)}}n2b(L){const aa=new B.Range(Math.max(1,L.top-1),Math.max(1,L.left-1),L.bottom+1,L.right+1,!1,!1);G.h(this.$).aN(aa)||this.Mr&&this.Mr.gp||(this.Mr=H.a.instance.create(()=>{G.h(this.$).pv(aa,60,"DrawBorderBehavior.BringRangeIntoView")},40,I.a.Mph))}bottomRightCorner(L,aa){return 1048576<=L||16384<=aa?!0:!1}me(L){return D.a(this.$).me(L)}}Object(r.a)(N,
"DrawBorderBehavior",null,[2]);a.d(F,"BorderFormatManager",function(){return M});class M{constructor(L,aa,V){this.aSb=null;this.wF={};this.RSb=this.lx=null;c.ULS.sendTraceTag(537159566,0,50,"BorderFormatManager: Request new instance");this.$=L;this.m7d=M.V7c;this.n7d=M.borderStyleSolidLine;this.Nh=aa;this.Va=V;t.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")||this.$.da.Ha(296,this);this.pU=new N(this.$,this.Nh);this.ZC=t.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",
!1);c.ULS.sendTraceTag(537159565,0,50,"BorderFormatManager: register BorderFormatManager with ServiceName 296")}get gIa(){return this.n7d}get h3(){return this.m7d}get uta(){return this.RSb}get themesManager(){this.lx||(this.lx=this.$.da.Aa(422));return this.lx}Z9e(L,aa){c.ULS.sendTraceTag(537159564,0,50,`HandleBorderCommand : Begin handling, Command being executed: ${aa.command.toString()}`);const V={},P={};var ba=l.a.bH(this.h3,!1);P.Color=[ba,ba,ba,ba];this.ZC&&this.uta&&(P.ThemeBorderColor=[this.uta,
this.uta,this.uta,this.uta],P.ColorTypeOption=1);L=-600086683===aa.command?"OutsideBorders":L[d.a.Kc];P.LineStyle=k.a.Fc(M.PNf,L);P.LineStyle?c.ULS.sendTraceTag(537159562,0,50,`RibbonCommand.Border is using the BorderFormat information, the predefined borderStyle requested is ${L}`):(ba=M.u_a[this.gIa].Txe,P.LineStyle=[ba,ba,ba,ba],c.ULS.sendTraceTag(537159563,0,50,`RibbonCommand.Border is using the BorderFormat information, the custom borderStyle requested is ${this.gIa}`));ba=k.a.aq(M.NWg,L,0);
c.ULS.sendTraceTag(40732555,0,50,`RibbonCommand.Border is using the BorderFormat information, the border type requested is ${L}, the border color selected is ${this.h3}`);V.BorderFormat=P;4!==ba&&8!==ba||!this.$.na.displayRtl||(ba=4===ba?8:4);V.ValidMembers=128;V.Border=ba;this.Nh.formatCells(-1690267012,V,aa);c.ULS.sendTraceTag(537159561,0,50,`HandleBorderCommand : Successfully handled, Command executed: ${aa.command.toString()}`);return!0}tkd(L,aa,V){c.ULS.sendTraceTag(537159560,0,50,`RibbonCommand:${L.toString()} is being executed, the previous border color is ${this.h3}`);
if(this.ZC){if((aa.SqmControlId||"").includes("ThemeColorPicker")){let P,ba;({themeIndex:P,wBa:ba}=this.themesManager.getThemeColor(aa.Color)).returnValue?(this.RSb={},this.uta.ThemeColorIndex=P,this.uta.ThemeColorRow=ba):this.RSb=null}else this.RSb=null;this.pU.v_a=this.uta}this.m7d=-1803452024===L?M.V7c:aa.Color;this.pU.borderColor=this.h3;this.vPe(V);this.$.qf();c.ULS.sendTraceTag(40944211,0,50,`RibbonCommand:${L.toString()} is being executed, the updated border color is ${this.h3}`);return!0}C$h(L){c.ULS.sendTraceTag(537159559,
0,50,"RibbonPopulateCommand.PopulateBorderStyle command Invoked");const aa=this.Va.uq();var V=this.Va.Ec();aa.rc.push(V);const P=this.Va.zC("StyleDashGallery",1,"Size120by20");V.buttons.push(P);V=M.u_a;for(let ba in V){const Y=ba,Z=V[ba],ea=n.a.instance.ga(Z.g2b);P.Zt(Y,-2118943501,"QueryBorderStyle",Z.g2b,Y,Y,void 0,void 0,ea)}c.ULS.sendTraceTag(537159557,0,50,"RibbonPopulateCommand, Invoke BuildMenuProps");L.MenuItems=aa.oE();c.ULS.sendTraceTag(537159556,0,50,"RibbonPopulateCommand handled")}S8h(L,
aa){c.ULS.sendTraceTag(537159555,0,50,`RibbonCommand.BorderStyle: Begin handling, Current Border Style is ${this.gIa}`);L=L[d.a.Kc];if(M.owi(L))this.n7d=L,c.ULS.sendTraceTag(537159554,0,50,`RibbonCommand.BorderStyle: Updated Border Style is ${this.gIa}`);else return c.ULS.sendTraceTag(537159553,0,15,`RibbonCommand.BorderStyle: Invalid Border Style encountered, Requested Border Style : ${L}`),!0;this.pU.borderStyle=this.gIa;this.vPe(aa);this.$.qf();c.ULS.sendTraceTag(40944220,0,50,`RibbonCommand.BorderStyle: Successfully handled Current Border Style is ${this.gIa}`);
return!0}xkd(L){c.ULS.sendTraceTag(537159552,0,50,`HandleDrawBorderCommand : Begin handling, Command being executed: ${L.command.toString()}`);this.PVc(L,64,this.h3,109,1);return!0}ykd(L){c.ULS.sendTraceTag(537159523,0,50,`HandleDrawBorderGridCommand : Begin handling, Command being executed: ${L.command.toString()}`);this.PVc(L,112,this.h3,110,2);return!0}o$e(L){c.ULS.sendTraceTag(537159522,0,50,`HandleEraseBorderCommand : Begin handling, Command being executed: ${L.command.toString()}`);this.PVc(L,
112,"white",111,3);return!0}I$h(L){this.wzj(this.PWg,L,L.MenuItemId?L.MenuItemId:M.borderStyleSolidLine)}wzj(L,aa,V){V in L?(L=L[V],c.ULS.sendTraceTag(537159521,0,50,`HandleQueryBorderStyleCommand:SetIcon command ${V}`),this.yzj(aa,L)):c.ULS.sendTraceTag(537159520,0,15,`HandleQueryBorderStyleCommand: cannot find dashes '${V}' in BorderLineStyleButtons dictionary`)}T$h(L,aa){const V=L[d.a.Kc];return"DrawBorder"===V?this.xkd(aa):"DrawBorderGrid"===V?this.ykd(aa):"EraseBorder"===V?this.o$e(aa):this.Z9e(L,
aa)}pUf(){this.aSb||this.QXg()}UPh(){return new m(this)}get PWg(){this.pUf();return this.aSb}QXg(){this.aSb={};let L=0;const aa=M.u_a;for(let V in aa){const P=aa[V],ba=P.Uxe;n.a.instance.ga(P.g2b);this.aSb[ba]=ba;this.$bb(ba,()=>appChrome.buildBorderStyleIconNew(P.mPj,P.width,P.RMi,P.lineHeight,P.fAi));L++}}$bb(L,aa){if(!(L in this.wF)){const V={};aa=aa();V[L]=aa;appChrome.api.registerIconProvider(()=>V);this.wF[L]=!0}return L}yzj(L,aa){L.MenuItemId&&(L[b.a.On]=L.MenuItemId===this.gIa,L[e.a.Icon]=
aa)}PVc(L,aa,V,P,ba){c.ULS.sendTraceTag(537159519,0,50,"BorderFormatManager.ActivateDrawBorderBehavior : Starting ActivateDrawBorderBehavior ");this.H3g(L,ba)?(c.ULS.sendTraceTag(537159518,0,50,"BorderFormatManager.CheckDrawBorderBehaviorTriggered : Toggled Ribbon menu button "),this.pU.a0()):(G.h(this.$).ez&&this.pU.a0(),h.a.current&&(P=String.format(f.a.Ata,h.a.current.qo(P)),G.h(this.$).Gg.vp(P)),this.pU.i2b=aa,this.pU.borderColor=V,G.h(this.$).ez=!0,this.pU.uHg(L),this.pU.$ta=ba)}vPe(L){if(L)switch(this.pU.$ta){case 2:this.ykd(L);
break;default:this.xkd(L)}}H3g(L,aa){return this.pU.$ta===aa&&-236759591!==L.command&&-2118943501!==L.command?!0:!1}static get u_a(){return M.y5d||(M.y5d={["BorderStyleSolidLine"]:z.OXg(),["BorderStyleDashedLine"]:z.KXg(),["BorderStyleDottedLine"]:z.LXg(),["BorderStyleMediumLine"]:z.NXg(),["BorderStyleThickLine"]:z.PXg(),["BorderStyleDoubleLine"]:z.MXg()})}static get NWg(){return M.x5d||(M.x5d={["NoBorder"]:0,["BottomBorder"]:1,["TopBorder"]:2,["LeftBorder"]:4,["RightBorder"]:8,["OutsideBorders"]:64,
["AllBorders"]:112,["ThickOutsideBorders"]:64,["InsideBorders"]:48,["InsideHorizontalBorders"]:16,["InsideVerticalBorders"]:32,["BottomDoubleBorder"]:1,["ThickBottomBorder"]:1,["TopBottomBorder"]:3,["TopThickBottomBorder"]:3,["TopDoubleBottomBorder"]:3})}static get PNf(){return M.che||(M.che={["ThickOutsideBorders"]:[2,2,2,2],["BottomDoubleBorder"]:[1,6,1,1],["ThickBottomBorder"]:[1,2,1,1],["TopBottomBorder"]:M.pkh,["TopThickBottomBorder"]:[1,2,1,1],["TopDoubleBottomBorder"]:[1,6,1,1]})}static owi(L){return L?
L in M.PNf||L in M.u_a:!1}}M.x5d=null;M.y5d=null;M.che=null;M.V7c="black";M.borderStyleSolidLine="BorderStyleSolidLine";M.pkh=[1,1,1,1];Object(r.a)(M,"BorderFormatManager",null,[566])},855:function(r,F,a){a.d(F,"a",function(){return c});r=a(0);class c{}c.edit="Edit";c.clipboard="Clipboard";c.copy="Copy";c.color="Color";c.WUg="AutoFill";c.rrj="RowOperations";c.R6g="ColumnOperations";c.O5j="ViewModeRowOperations";c.N5j="ViewModeColumnOperations";c.hyperlink="Hyperlink";c.openHyperlink="OpenHyperlink";
c.EDj="ShapeStyle";c.JIh="FloatingObjectClipboard";c.LMf="PivotTableCopyDelete";c.NMf="PivotTableFieldListActions";c.hBe="CellFloatie";c.ADj="ShapeFloatie";c.contextMenu="ContextMenu";c.e8h="GridContextMenu";c.J5i="PivotTableContextMenu";c.KIh="FloatingObjectContextMenu";c.M2g="CellRTEFloatie";c.q7f="ShapeRTEFloatie";Object(r.a)(c,"FloatieGroupIdentifiers",null,[])},856:function(r,F,a){a.d(F,"a",function(){return k});r=a(0);var c=a(89),b=a(227),e=a(14),f=a(240);F=a(239);var d=a(12),h=a(74),l=a(21);
class k extends F.a{constructor(t,n,z){super(n);this.Ilc=this.YQ=!1;this.wn=this._selectedRowListBox=this.NNa=null;this.EEf=w=>this.onItemClick(w);this.FDd=w=>{h.g(w.Ea);this.raiseEvent(k.e5a);this.raiseEvent(k.dRd);return!0};this.onScroll=w=>{h.g(w);this.ZId();this.raiseEvent(k.e5a)};this.onBlur=w=>{h.g(w);this.ZId()};this.onPointerDown=()=>{this.ZId();this.raiseEvent(k.e5a);this.raiseEvent(k.gza);return!1};this.qGb=w=>{const m=w.Ea;if(m.button===Sys.UI.MouseButton.leftButton||m.button===Sys.UI.MouseButton.rightButton||
m.type.includes("touch"))this.Ej=this.Obc(m),this.onPointerDown(w);this.raiseEvent(k.rud);return!1};this.jb=t;this.yDb=z;this.iBa(!0)}w9(t){this.get_events().addHandler(k.e5a,t)}uda(t){this.get_events().removeHandler(k.e5a,t)}N_b(t){this.get_events().addHandler(k.Vmd,t)}Ouc(t){this.get_events().removeHandler(k.Vmd,t)}zob(t){this.get_events().addHandler(k.dRd,t)}dKb(t){this.get_events().removeHandler(k.dRd,t)}wob(t){this.get_events().addHandler(k.gza,t)}aKb(t){this.get_events().removeHandler(k.gza,
t)}wXc(t){this.get_events().addHandler(k.rud,t)}aMd(t){this.get_events().removeHandler(k.rud,t)}get Ej(){return this._selectedRowListBox}set Ej(t){this.BBa(this._selectedRowListBox);t?(this._selectedRowListBox=t,this.BBa(this._selectedRowListBox),this.$wc(t)):this._selectedRowListBox=null}get uV(){return this.yDb.ListCellClass}get v5(){return this.yDb.ListTableClass}get KH(){return 8}get vEb(){return 5}get Hlc(){return 24}get Glc(){return 35}get Df(){return this.domElement}get $(){return this.jb}dispose(){this.w7(!1);
this.iBa(!1);c.a.pc([this.NNa]);this.NNa=null;super.dispose()}Obc(t){return d.DOMElementExtensions.Bgd(t.target,"tr",!0)}fB(t){if(t){if(!this.Ej){var n=this.wn;if(!n||!n.rows.length)return;this.Ej=n.rows[0];0<t?t--:t++}n=this.Ej;for(let z=0,w=Math.abs(t);z<w;z++)if(0>t){if(!n.previousSibling)break;n=n.previousSibling}else{if(!n.nextSibling)break;n=n.nextSibling}n&&(this.Ej=n)}}dob(t,n){d.DOMElementExtensions.toggleCssClass(t,this.yDb.ListTableClassInTouch,n)}w7(t){const n=this.wn;n&&(t&&!this.Ilc?
(b.a.instance.ta(e.a.click,n,this.EEf),b.a.instance.ta(e.a.tk,n,this.FDd),f.a.instance.ta(e.a.pointerDown,n,this.qGb),this.Ilc=!0):this.Ilc&&(b.a.instance.Ba(e.a.click,n,this.EEf),b.a.instance.Ba(e.a.tk,n,this.FDd),f.a.instance.Ba(e.a.pointerDown,n,this.qGb),this.Ilc=!1))}BBa(t){let n=null;t&&(n=d.DOMElementExtensions.$j(t,this.yDb.ListCellClass))&&n.classList.toggle(this.yDb.ListCellSelectedClass);return n}iBa(t){this.Df&&(t&&!this.YQ?(this.NNa=this.Ae.ie(this.Df),this.NNa.ka("scroll",this.onScroll),
this.NNa.ka("blur",this.onBlur),f.a.instance.ta(e.a.pointerDown,this.domElement,this.onPointerDown),this.YQ=!0):this.YQ&&(c.a.Ja(this.NNa),this.NNa=null,f.a.instance.Ba(e.a.pointerDown,this.domElement,this.onPointerDown),this.YQ=!1))}onItemClick(t){return this.FDd(t)}$wc(t){if(t){var n=t.offsetTop,z=this.Df.scrollTop;n<z?this.W1f(!0):n+t.offsetHeight>z+this.Df.clientHeight&&this.W1f(!1)}}W1f(t){this.Df.scrollTop=t?this.Ej.offsetTop:this.Ej.offsetTop+this.Ej.offsetHeight-this.Df.clientHeight}ZId(){l.h(this.$).fb&&
this.raiseEvent(k.Vmd)}}k.e5a="GotFocus";k.Vmd="IgnoreBlur";k.dRd="SetCell";k.gza="PointerDown";k.rud="ItemPointerDown";Object(r.a)(k,"ListBox",F.a,[614,2])},927:function(r,F,a){a.d(F,"a",function(){return b});r=a(0);var c=a(22);class b{compare(e,f){return c.a.compare(e,f,!0)}}Object(r.a)(b,"IgnoreCaseComparer",null,[363])},928:function(r,F,a){a.d(F,"a",function(){return f});r=a(0);var c=a(24),b=a(11),e=a(177);class f{constructor(d,h){this.Ca=d;this.h3a=h}fMb(d,h,l){const k=h.Border;h=h.BorderFormat;
let t=0,n=!1;if(0===k)d.cell.gcb(),this.zJb(d.cell.getRange());else{for(let z=0;3>=z;z++)f.PEj(d,l,z,k)&&(t|=b.HelperMethods.f4a(z),this.U_d(d.cell.getRange(),z,h),n=!0);b.HelperMethods.MQ(k,16)&&!e.c(d,0,l)&&(t|=2,this.U_d(d.cell.getRange(),0,h),n=!0);b.HelperMethods.MQ(k,32)&&!e.c(d,2,l)&&(t|=4,this.U_d(d.cell.getRange(),2,h),n=!0);n&&(l=d.cell.Xx.De,b.HelperMethods.MQ(t,2)&&this.H8f(d,l,0)&&(t&=-3),b.HelperMethods.MQ(t,1)&&this.G8f(d,l,1)&&(t&=-2),b.HelperMethods.MQ(t,4)&&this.H8f(d,l,2)&&(t&=
-5),b.HelperMethods.MQ(t,8)&&this.G8f(d,l,3)&&(t&=-9),d.cell.setBorders(h,t,!1))}}lQ(d,h){d=f.d0e(d,h);return d.nz?(d=this.Ca.pja(d))&&d.length?d:null:null}zJb(d){for(let l=0;3>=l;l++){var h=f.d0e(d,l);if(!h.nz)continue;h=this.Ca.pja(h);if(!h||!h.length)continue;const k=f.A5e(l);for(let t=0;t<h.length;t++)h[t].AQa(k)}}U_d(d,h,l){if(d=this.lQ(d,h)){var k=f.A5e(h),t=b.HelperMethods.f4a(k);for(let n=0;n<d.length;n++){const z=d[n];this.tmi(z,k)&&f.setBorders(z,l,t,h,k)}}}tmi(d,h){const l=d.Xx.De;var k=
d.getRange();k=this.lQ(k,h);let t=!1,n=!1,z=!1,w=!1;k&&(t=f.k7a(k,!0),n=f.k7a(k,!1),w=f.zrd(k),z=1===k.length?!0:!1);switch(h){case 0:return f.Gli(d,l,w,n,z);case 1:return f.Dli(d,l,w,t,z);case 2:return f.Eli(d,l,w,t,z);case 3:return f.Fli(d,l,w,n,z)}return!1}H8f(d,h,l){if(!d.cell.hz)return!1;const k=d.range,t=this.lQ(k,l),n=e.c(d,l,h);let z=!1;h=0===l?k.top<h.top:k.left<h.left;!f.qBb(d.cell)&&t&&1!==t.length&&(z=(0===l?f.k7a(t,!0):f.k7a(t,!1))?!1:!0);return!n&&z||h?!0:!1}G8f(d,h,l){const k=d.cell,
t=this.lQ(k.getRange(),l);d=e.c(d,l,h);h=!1;if(t){const z=f.k7a(t,!0);var n=f.k7a(t,!1);const w=z&&!n;n=n&&!z;1!==l||f.sCb(k)?3!==l||f.fBb(k)||f.WEj(k,t,n,w)&&(h=!0):f.VEj(k,t,z,n)&&(h=!0)}return!d&&h||f.qBb(k)?!0:!1}static JXg(d,h,l){const k={};k.LineStyle=Array(4);k.LineStyle[l]=d.LineStyle[h];k.Color=Array(4);k.Color[l]=d.Color[h];return k}static Sgf(d,h,l,k,t){return b.HelperMethods.MQ(d,t)&&e.c(h,l,k)}static PEj(d,h,l,k){return f.Sgf(k,d,l,h,b.HelperMethods.f4a(l))||f.Sgf(k,d,l,h,64)||112===
k}static setBorders(d,h,l,k,t){h=f.JXg(h,k,t);d.setBorders(h,l,!1)}static d0e(d,h){switch(h){case 0:return new c.Range(d.top-1,d.left,d.top-1,d.right,!1,!1);case 2:return new c.Range(d.top,d.left-1,d.bottom,d.left-1,!1,!1);case 1:return new c.Range(d.bottom+1,d.left,d.bottom+1,d.right,!1,!1);case 3:return new c.Range(d.top,d.right+1,d.bottom,d.right+1,!1,!1)}return d}static A5e(d){switch(d){case 0:return 1;case 2:return 3;case 1:return 0;default:return 2}}static k7a(d,h){for(let l=0;l<d.length;l++){const k=
d[l];if(k.hz)return h?f.fBb(k):f.sCb(k)}return!1}static qBb(d){const h=d.Xx.De,l=d.getRange();return d.hz&&(l.top<h.top||l.bottom>h.bottom||l.left<h.left||l.right>h.right)?!0:!1}static zrd(d){for(let h=0;h<d.length;h++)if(f.qBb(d[h]))return!0;return!1}static VEj(d,h,l,k){if(!d.hz){if(!l||f.zrd(h))return!0}else if(f.fBb(d)&&(1===h.length&&f.ZSg(d,h[0])||!l))return!0;return k}static WEj(d,h,l,k){if(!d.hz){if(!l||f.zrd(h))return!0}else if(f.sCb(d)&&(1===h.length&&f.$Sg(d,h[0])||!l))return!0;return d.Iba||
k}static Gli(d,h,l,k,t){const n=d.getRange();return f.fBb(d)?f.qBb(d)||t:h.top===n.top||!k||l}static Dli(d,h,l,k,t){const n=d.getRange();return f.fBb(d)?h.bottom===n.bottom&&t:k&&!l||h.bottom===n.bottom}static Eli(d,h,l,k,t){const n=d.getRange();return f.sCb(d)?f.qBb(d)||t:h.left===n.left||!k||l}static Fli(d,h,l,k,t){const n=d.getRange();return d.Iba?!1:f.sCb(d)?h.right===n.right&&t:k&&!l||h.right===n.right}static fBb(d){return 0<d.getRange().right-d.getRange().left}static sCb(d){return 0<d.getRange().bottom-
d.getRange().top}static $Sg(d,h){d=d.getRange();h=h.getRange();return d.top===h.top&&d.bottom===h.bottom}static ZSg(d,h){d=d.getRange();h=h.getRange();return d.left===h.left&&d.right===h.right}}Object(r.a)(f,"BorderModelAccessorHelper",null,[])},930:function(r,F,a){a.d(F,"a",function(){return d});r=a(0);var c=a(89);F=a(96);var b=a(48),e=a(44),f=a(74);class d extends F.a{constructor(h,l){super(l.textBox.domElement);this.WZc=null;this.tOi=()=>{this.iCd()};this.rCf=(k,t)=>{this.$f(k,t)};this.vCf=(k,
t)=>{this.Ri(k,t)};this.jb=h;this.CI=l;l.v2&&(l.v2.add(this),l.xl(this.vCf),l.Km(this.rCf))}get $(){return this.jb}get eb(){return this.CI}dispose(){const h=this.CI;if(null===h||void 0===h?0:h.v2)h.v2.remove(this),h.nl(this.vCf),h.$l(this.rCf);c.a.Ja(this.WZc);this.CI=null;super.dispose()}Oh(h,l){switch(l){case -1470715894:case -1231471547:this.wY(!1);break;default:if(this.CId(h,l))return f.g(h),!0;d.Eri(l)||this.wY(!1)}return!1}wY(){c.a.Ja(this.WZc);this.WZc=b.a.instance.create(this.tOi,10,e.a.mAi)}Ri(){this.wY(!1)}static Eri(h){switch(h){case 137938150:case -798660877:case 742457698:case 2091832999:return!0}return!1}}
Object(r.a)(d,"ListAutoCompleteBehavior",F.a,[613,2])},966:function(r,F,a){function c(d,h,l){return{name:d,dataType:1,value:h,classification:l?l:4}}a.d(F,"a",function(){return b});a.d(F,"c",function(){return e});a.d(F,"b",function(){return f});r=[{name:"featureNameField",dataType:0,value:"FormulaSmartSuggestions",classification:4},{name:"ver",dataType:0,value:"1.0.0",classification:4}];F={dataCategories:2,samplingPolicy:1,diagnosticLevel:100};const b={eventName:"Office.Excel.FormulaSmartSuggestions.Seen",
eventFlags:F,dataFields:[...r,c("isFeatureSeen",!0)]},e={eventName:"Office.Excel.FormulaSmartSuggestions.Tried",eventFlags:F,dataFields:[...r,c("isFeatureTried",!0)]},f={eventName:"Office.Excel.FormulaSmartSuggestions.Succeeded",eventFlags:F,dataFields:[...r,c("isFeatureSucceeded",!0)]}}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.kpae.js.map/ae293ac65dd4075678fbadf1a55ebae8/EwaDSEsNext.kpae.js.map